{"id":783360,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODMzNjA=","url":"https://hackerone.com/reports/783360","title":"Open memory dump method leaking customer information ,secret keys , password , source code \u0026 admin accounts","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-01-25T21:57:38.304Z","submitted_at":"2020-01-25T21:57:38.304Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"homains","url":"/homains","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-31T08:11:14.686Z","bug_reporter_agreed_on_going_public_at":"2020-01-30T11:51:37.726Z","team_member_agreed_on_going_public_at":"2020-01-31T08:11:14.608Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nStripo uses Spring boot for the backend API development , and misconfigured the application to open actuator APIs to the public.\n\nThis issue is found in 3 domains , don't know if I need to publish 3 reports for that, or just one report , but the domains are :\nhttps://my.stripo.email/cabinet/stripeapi/actuator\nhttps://plugins.stripo.email/actuator\nhttps://plugin.stripo.email/actuator\n\nit might be available in other micro services as well\n\n\n\n## Steps To Reproduce:\n\n  1. Go to the following URL : https://my.stripo.email/cabinet/stripeapi/actuator/heapdump\n  1. This url will download the heap dump of the server \n  1. using a memory analyzer such as Eclipse memory analyzer or VisualVM open the downloaded file\n  1. By searching inside the file you can find all the secrets , credentials , urls , JWT tokens \u0026 JWT secret keys, which can be used and generate any JWT token and takeover any account on the system.\n  1. Attached some examples of what can be found and used by this vulnerability, and you can imagine any bad scenario, and this issue can be used to take over/down Stripo\n\n## Supporting Material/References:\nPlease find more information about actuator on the following URL:\nhttps://docs.spring.io/spring-boot/docs/current-SNAPSHOT/actuator-api/html/#heapdump\n\n\nExample of open functionalities:\n████\n\nAdmin Credentials:\n███\n\nOther User's information:\n█████████\n\nBilling Service Credentials:\n████\n\nConfig Server Credentials:\n███████\n\n## Impact\n\nThis vulnerability allows any attacker to perform many severe attacks such as :\n\n- Upgrade accounts without payments.\n- Get logged in customer information and get access to the session \u0026 JWT tokes to take over accounts\n- PII Data leaking \n- Accessing all credentials from the application properties such as , admin credentials, swagger credentials , billing credentials .\n- Get database credentials\n- Server Environment variable\n- Server config Properties.\n- Payments manipulations and money stealing\n- and more","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eStripo uses Spring boot for the backend API development , and misconfigured the application to open actuator APIs to the public.\u003c/p\u003e\n\n\u003cp\u003eThis issue is found in 3 domains , don\u0026#39;t know if I need to publish 3 reports for that, or just one report , but the domains are :\u003cbr\u003e\n\u003ca title=\"https://my.stripo.email/cabinet/stripeapi/actuator\" href=\"/redirect?url=https%3A%2F%2Fmy.stripo.email%2Fcabinet%2Fstripeapi%2Factuator\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.stripo.email/cabinet/stripeapi/actuator\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://plugins.stripo.email/actuator\" href=\"/redirect?url=https%3A%2F%2Fplugins.stripo.email%2Factuator\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plugins.stripo.email/actuator\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://plugin.stripo.email/actuator\" href=\"/redirect?url=https%3A%2F%2Fplugin.stripo.email%2Factuator\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plugin.stripo.email/actuator\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eit might be available in other micro services as well\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to the following URL : \u003ca title=\"https://my.stripo.email/cabinet/stripeapi/actuator/heapdump\" href=\"/redirect?url=https%3A%2F%2Fmy.stripo.email%2Fcabinet%2Fstripeapi%2Factuator%2Fheapdump\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.stripo.email/cabinet/stripeapi/actuator/heapdump\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eThis url will download the heap dump of the server \u003c/li\u003e\n\u003cli\u003eusing a memory analyzer such as Eclipse memory analyzer or VisualVM open the downloaded file\u003c/li\u003e\n\u003cli\u003eBy searching inside the file you can find all the secrets , credentials , urls , JWT tokens \u0026amp; JWT secret keys, which can be used and generate any JWT token and takeover any account on the system.\u003c/li\u003e\n\u003cli\u003eAttached some examples of what can be found and used by this vulnerability, and you can imagine any bad scenario, and this issue can be used to take over/down Stripo\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003ePlease find more information about actuator on the following URL:\u003cbr\u003e\n\u003ca title=\"https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/actuator-api/html/#heapdump\" href=\"/redirect?url=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Fdocs%2Fcurrent-SNAPSHOT%2Factuator-api%2Fhtml%2F%23heapdump\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.spring.io/spring-boot/docs/current-SNAPSHOT/actuator-api/html/#heapdump\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eExample of open functionalities:\u003cbr\u003e\n████\u003c/p\u003e\n\n\u003cp\u003eAdmin Credentials:\u003cbr\u003e\n███\u003c/p\u003e\n\n\u003cp\u003eOther User\u0026#39;s information:\u003cbr\u003e\n█████████\u003c/p\u003e\n\n\u003cp\u003eBilling Service Credentials:\u003cbr\u003e\n████\u003c/p\u003e\n\n\u003cp\u003eConfig Server Credentials:\u003cbr\u003e\n███████\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability allows any attacker to perform many severe attacks such as :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUpgrade accounts without payments.\u003c/li\u003e\n\u003cli\u003eGet logged in customer information and get access to the session \u0026amp; JWT tokes to take over accounts\u003c/li\u003e\n\u003cli\u003ePII Data leaking \u003c/li\u003e\n\u003cli\u003eAccessing all credentials from the application properties such as , admin credentials, swagger credentials , billing credentials .\u003c/li\u003e\n\u003cli\u003eGet database credentials\u003c/li\u003e\n\u003cli\u003eServer Environment variable\u003c/li\u003e\n\u003cli\u003eServer config Properties.\u003c/li\u003e\n\u003cli\u003ePayments manipulations and money stealing\u003c/li\u003e\n\u003cli\u003eand more\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":137,"name":"Exposed Dangerous Method or Function"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":147,"voters":["checkm50","pudsec","sultancad","skarsom","a_d_a_m","discodamone","pirateducky","alesandroortiz","mik317","kapkan","and 137 more..."],"severity":{"rating":"critical","score":10.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"low"}},"structured_scope":{"databaseId":38702,"asset_type":"URL","asset_identifier":"my.stripo.email","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6872264,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-25T21:58:18.693Z","updated_at":"2020-01-25T21:58:18.693Z","additional_data":{"old_title":"Open memory dump method leaking customer information ,secret keys , password \u0026 source code and admin accounts","new_title":"Open memory dump method leaking customer information ,secret keys , password , source code \u0026 admin accounts"},"actor":{"username":"homains","cleared":false,"url":"/homains","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6881453,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @homains \n\nThanks a lot for this report and your contribution. I have created the task for the team to solve this asap.\n\nRegards,\nStripo Dev Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/homains\"\u003e@homains\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks a lot for this report and your contribution. I have created the task for the team to solve this asap.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nStripo Dev Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-27T15:58:20.984Z","updated_at":"2020-01-27T15:58:20.984Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6895093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@artem_nefedov,\n\nPlease let me know if the app team needs any help with any recommendations , I can help in that \n\nThanks","markdown_message":"\u003cp\u003e\u003ca href=\"/artem_nefedov\"\u003e@artem_nefedov\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if the app team needs any help with any recommendations , I can help in that \u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-28T21:01:20.589Z","updated_at":"2020-01-28T21:01:20.589Z","actor":{"username":"homains","cleared":false,"url":"/homains","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6898188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@homains the team and DevOps updated secret key and changed passwords. What else would you recommend as the best mitigation?","markdown_message":"\u003cp\u003e\u003ca href=\"/homains\"\u003e@homains\u003c/a\u003e the team and DevOps updated secret key and changed passwords. What else would you recommend as the best mitigation?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-29T09:31:35.018Z","updated_at":"2020-01-29T09:31:35.018Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6899805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@artem_nefedov , \nThat's right , and also you need to disable all the Actuator endpoints.","markdown_message":"\u003cp\u003e\u003ca href=\"/artem_nefedov\"\u003e@artem_nefedov\u003c/a\u003e , \u003cbr\u003e\nThat\u0026#39;s right , and also you need to disable all the Actuator endpoints.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-29T14:35:17.486Z","updated_at":"2020-01-29T14:35:17.486Z","actor":{"username":"homains","cleared":false,"url":"/homains","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6919519,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@homains \n\nThank you a lot for finding this vulnerability. We appreciate any future help from your side!","markdown_message":"\u003cp\u003e\u003ca href=\"/homains\"\u003e@homains\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you a lot for finding this vulnerability. We appreciate any future help from your side!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T11:49:57.743Z","updated_at":"2020-01-30T11:49:57.743Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"homains","url":"/homains"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6919546,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-30T11:51:37.746Z","updated_at":"2020-01-30T11:51:37.746Z","first_to_agree":true,"actor":{"username":"homains","cleared":false,"url":"/homains","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6919887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@artem_nefedov ,\nnp at all , would you please allow me to disclose the report ?\n\nThanks\n@Homains","markdown_message":"\u003cp\u003e\u003ca href=\"/artem_nefedov\"\u003e@artem_nefedov\u003c/a\u003e ,\u003cbr\u003e\nnp at all , would you please allow me to disclose the report ?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\n\u003ca href=\"/homains\"\u003e@Homains\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T12:46:23.244Z","updated_at":"2020-01-30T12:46:23.244Z","actor":{"username":"homains","cleared":false,"url":"/homains","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gvzNbeoxzZMqck7eubjSyfm3/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6926537,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@homains \nThanks a lot for your contribution! We'll be happy to get more reports from you.","markdown_message":"\u003cp\u003e\u003ca href=\"/homains\"\u003e@homains\u003c/a\u003e \u003cbr\u003e\nThanks a lot for your contribution! We\u0026#39;ll be happy to get more reports from you.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T08:11:14.624Z","updated_at":"2020-01-31T08:11:14.624Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6926538,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T08:11:14.701Z","updated_at":"2020-01-31T08:11:14.701Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}