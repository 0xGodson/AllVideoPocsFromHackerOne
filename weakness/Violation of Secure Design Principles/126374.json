{"id":126374,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjYzNzQ=","url":"https://hackerone.com/reports/126374","title":"Uploading Plain Text to uber-documents.s3.amazonaws.com Through the Driver Document Upload Page","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-27T20:24:29.640Z","submitted_at":"2016-03-27T20:24:29.640Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T22:17:31.291Z","bug_reporter_agreed_on_going_public_at":"2016-03-28T15:31:51.887Z","team_member_agreed_on_going_public_at":"2016-06-13T22:17:31.172Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, \n\nWhen a new driver is registering on Uber, they have to upload a variety of files (proof of insurance, ID, etc). When these files are being uploaded, Uber.com only checks whether the files have the correct extension. This means that one can upload a plain text file with a ```.png``` extension and it will be rendered as plain text when viewed in Internet Explorer. \n\nAt first I was attempting to get js execution with this (similar to how I did #126197), but that is not possible. When the file extension (```.png``` in our case) and the MIME type (```image/png```) match, Internet Explorer will not render it as HTML, it is only willing to render it as plain text. This still opens up a possibility of a fishing attach by doing something like this: \n\n```\nhttps://uber-documents.s3.amazonaws.com/f7e83fb2-a309-4845-a038-8cb3846a0f0d.png?Signature=eQwYlK31HVRqaHN%2FdvaImVEDQuI%3D\u0026Expires=1459110446\u0026AWSAccessKeyId=AKIAIQSUTKT5KJFDBULQ\n```\n\nWhile this is not as bad as JS execution, I believe that this still qualifies as a vulnerability. In all other image upload forms (e.g. profile picture upload), Uber carefully checks that the image is valid before accepting it and hosting it. In this case, Uber fails to do so. \n\nThanks,\nDavid Dworken","vulnerability_information_html":"\u003cp\u003eHi, \u003c/p\u003e\n\n\u003cp\u003eWhen a new driver is registering on Uber, they have to upload a variety of files (proof of insurance, ID, etc). When these files are being uploaded, Uber.com only checks whether the files have the correct extension. This means that one can upload a plain text file with a \u003ccode\u003e.png\u003c/code\u003e extension and it will be rendered as plain text when viewed in Internet Explorer. \u003c/p\u003e\n\n\u003cp\u003eAt first I was attempting to get js execution with this (similar to how I did \u003ca href=\"/reports/126197\"\u003e#126197\u003c/a\u003e), but that is not possible. When the file extension (\u003ccode\u003e.png\u003c/code\u003e in our case) and the MIME type (\u003ccode\u003eimage/png\u003c/code\u003e) match, Internet Explorer will not render it as HTML, it is only willing to render it as plain text. This still opens up a possibility of a fishing attach by doing something like this: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://uber-documents.s3.amazonaws.com/f7e83fb2-a309-4845-a038-8cb3846a0f0d.png?Signature=eQwYlK31HVRqaHN%2FdvaImVEDQuI%3D\u0026amp;Expires=1459110446\u0026amp;AWSAccessKeyId=AKIAIQSUTKT5KJFDBULQ\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhile this is not as bad as JS execution, I believe that this still qualifies as a vulnerability. In all other image upload forms (e.g. profile picture upload), Uber carefully checks that the image is valid before accepting it and hosting it. In this case, Uber fails to do so. \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-27T15:31:52.286Z","allow_singular_disclosure_after":-147444670.08321992,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":873453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have attached an example image that will trigger this in Internet Explorer. \n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eI have attached an example image that will trigger this in Internet Explorer. \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-27T20:25:02.442Z","updated_at":"2016-03-27T20:25:02.442Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":81608,"filename":"notAnImage.png","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/608/01fb74cd2c2ad76915f3216c646a8a3f46b0c667/notAnImage.png?response-content-disposition=attachment%3B%20filename%3D%22notAnImage.png%22%3B%20filename%2A%3DUTF-8%27%27notAnImage.png\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042302Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=4f893d50e327abd7ef1a4b6a520088b9d68f552fc9e5b7e97712392ec6a3b756"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":873957,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for your report.\n\nThis seems like it falls squarely under the \"content injection issues\" rubric from our program scope, which lists it as not eligible. That's in its current form. Obviously if you're able to get XSS here, it might be much more interesting depending on what origin it executes in. For now we're going to close this out due to scope. If you do figure out a way to move from content injection/phishing to something more dangerous, please do let us know.\n\nThanks and we hope you'll continue to report security-related issues you find to us!\n","markdown_message":"\u003cp\u003eThanks for your report.\u003c/p\u003e\n\n\u003cp\u003eThis seems like it falls squarely under the \u0026quot;content injection issues\u0026quot; rubric from our program scope, which lists it as not eligible. That\u0026#39;s in its current form. Obviously if you\u0026#39;re able to get XSS here, it might be much more interesting depending on what origin it executes in. For now we\u0026#39;re going to close this out due to scope. If you do figure out a way to move from content injection/phishing to something more dangerous, please do let us know.\u003c/p\u003e\n\n\u003cp\u003eThanks and we hope you\u0026#39;ll continue to report security-related issues you find to us!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T07:52:38.915Z","updated_at":"2016-03-28T07:52:38.915Z","actor":{"username":"bugtriage-david","cleared":false,"url":"/bugtriage-david","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":874479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fun fact, we can also upload gifs (and they'll run in any browser!). See ```runningGif.mp4```. \n\nUltimately there is no way to get anything newer than IE8 to interpret this as HTML so let's go ahead and publicly disclose this. ","markdown_message":"\u003cp\u003eFun fact, we can also upload gifs (and they\u0026#39;ll run in any browser!). See \u003ccode\u003erunningGif.mp4\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eUltimately there is no way to get anything newer than IE8 to interpret this as HTML so let\u0026#39;s go ahead and publicly disclose this. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T15:31:45.394Z","updated_at":"2016-03-28T15:31:45.394Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":81720,"filename":"runningGif.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/720/85a1cc8a2136a775940c85c872a7eb83a898a9f0/runningGif.mp4?response-content-disposition=attachment%3B%20filename%3D%22runningGif.mp4%22%3B%20filename%2A%3DUTF-8%27%27runningGif.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042302Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=eb825f6db842702d1ca23f3f2eaa8a9e102bb0dc6fe4e42fa301e99a81a245b8"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":874480,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-28T15:31:51.912Z","updated_at":"2016-03-28T15:31:51.912Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we please disclose this?\n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eCan we please disclose this?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T00:24:23.659Z","updated_at":"2016-04-26T00:24:23.659Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953293,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we please disclose this?\n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eCan we please disclose this?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T14:36:51.942Z","updated_at":"2016-05-12T14:36:51.942Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012069,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@ddworken sorry for the wait, disclosing this now!","markdown_message":"\u003cp\u003e\u003ca href=\"/ddworken\"\u003e@ddworken\u003c/a\u003e sorry for the wait, disclosing this now!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-13T22:17:31.235Z","updated_at":"2016-06-13T22:17:31.235Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012070,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T22:17:31.312Z","updated_at":"2016-06-13T22:17:31.312Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}