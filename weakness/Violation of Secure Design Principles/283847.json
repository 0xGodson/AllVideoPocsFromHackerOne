{"id":283847,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM4NDc=","url":"https://hackerone.com/reports/283847","title":"GraphQL sessions aren't immediately invalidated when user password is changed","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-10-28T21:59:08.330Z","submitted_at":"2017-10-28T21:59:08.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bigbug","url":"/bigbug","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-30T22:28:39.938Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-11-30T22:28:17.269Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nWhile changing password, once user clicks on \"Change password\" button after giving necessary values, on https://hackerone.com/settings/pass/edit, the session expires and the user is redirected to https://hackerone.com/users/sign_in for logging in again with the updated/changed password. A graphql mutation is used to change password. But, it is observed that the user can still change password with same graphql token and same session id, used in previous graphql request **even after signing out**. Inshort graphql token nor host session expires. \n \n**Description:**\n\nSorry if I categorized this into wrong weakness category. Also apologize for the complicated title.\n\nWhen clicking on \"change password\" after supplying values for  current password, password and confirm password, user is directed to sign_in page to log in again with changed password. \n\nThe password change takes place through graphql mutation request that contains graphql token and session id. \n\nIt was observed that after capturing the above request with the help of a web debugging tool (charles proxy), the above request could be replayed with same graphql token  **x-auth-token** and host session **__Host-session**, with appropriate password values after sign out and the password is changed.\n\nInshort **A user can change password even after he/she is signed out or session expires, without having to login again, with the help of previously captured graphql request.**\n\n**Impact**\n\nAn attacker could simply change the password again by capturing previous request. As the change can be done even after sign out or expired session, it is more severe.\n\n**Remedy**\n\nMust enforce graphql token expiration. Also check for host_sesssion cookie value.\n\n### Steps To Reproduce\n\n1. Login to the account and navigate to https://hackerone.com/settings/pass/edit to change password.\n2. Input necessary values and click \"Change password\" button. Capture the request using a proxy.\n    (User is now logged out and redirected to sign_in page)\n3. Repeat the previous \"graphql mutation\" request using proxy with changed password. Password is\n     changed again without having to login.  \n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eWhile changing password, once user clicks on \u0026quot;Change password\u0026quot; button after giving necessary values, on \u003ca title=\"https://hackerone.com/settings/pass/edit\" href=\"https://hackerone.com/settings/pass/edit\"\u003ehttps://hackerone.com/settings/pass/edit\u003c/a\u003e, the session expires and the user is redirected to \u003ca title=\"https://hackerone.com/users/sign_in\" href=\"https://hackerone.com/users/sign_in\"\u003ehttps://hackerone.com/users/sign_in\u003c/a\u003e for logging in again with the updated/changed password. A graphql mutation is used to change password. But, it is observed that the user can still change password with same graphql token and same session id, used in previous graphql request \u003cstrong\u003eeven after signing out\u003c/strong\u003e. Inshort graphql token nor host session expires. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eSorry if I categorized this into wrong weakness category. Also apologize for the complicated title.\u003c/p\u003e\n\n\u003cp\u003eWhen clicking on \u0026quot;change password\u0026quot; after supplying values for  current password, password and confirm password, user is directed to sign_in page to log in again with changed password. \u003c/p\u003e\n\n\u003cp\u003eThe password change takes place through graphql mutation request that contains graphql token and session id. \u003c/p\u003e\n\n\u003cp\u003eIt was observed that after capturing the above request with the help of a web debugging tool (charles proxy), the above request could be replayed with same graphql token  \u003cstrong\u003ex-auth-token\u003c/strong\u003e and host session \u003cstrong\u003e__Host-session\u003c/strong\u003e, with appropriate password values after sign out and the password is changed.\u003c/p\u003e\n\n\u003cp\u003eInshort \u003cstrong\u003eA user can change password even after he/she is signed out or session expires, without having to login again, with the help of previously captured graphql request.\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAn attacker could simply change the password again by capturing previous request. As the change can be done even after sign out or expired session, it is more severe.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRemedy\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eMust enforce graphql token expiration. Also check for host_sesssion cookie value.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to the account and navigate to \u003ca title=\"https://hackerone.com/settings/pass/edit\" href=\"https://hackerone.com/settings/pass/edit\"\u003ehttps://hackerone.com/settings/pass/edit\u003c/a\u003e to change password.\u003c/li\u003e\n\u003cli\u003eInput necessary values and click \u0026quot;Change password\u0026quot; button. Capture the request using a proxy.\n(User is now logged out and redirected to sign_in page)\u003c/li\u003e\n\u003cli\u003eRepeat the previous \u0026quot;graphql mutation\u0026quot; request using proxy with changed password. Password is\n changed again without having to login.\u003cbr\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-30T22:28:17.598Z","allow_singular_disclosure_after":-94546511.81346245,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","lordjerry0x01","t-4-y-m","cr4xerbik4sh","japz","sumit7","dyabla","seven6"],"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2110689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**An important update**\n\nThis seems to be true for querying profile value as well  as well. The below  graphql query is fired when \"update profile\" is clicked at https://hackerone.com/settings/profile/edit without changing current profile values.\n\n\u003equery Profile_settings_MeRelayQL (......)\n\u003e \"variables\" : {\n\u003e                             .....\n\u003e                            }\n\n\nThis returns current_user profile information. It was observed that even this can be repeated after password change without login. This does not need password as changing/querying profile values do not require a password. \n\n\n**Steps**\n1. I again changed the password and captured the graphql request for the same. (User is signed out)\n2. Created above graphql query to query current profile with same  x-auth-token and  __Host-session values as      \"change password graphql mutation request\". It worked and returned user info even after sign out.  \n\nNormally this would return \"You need to sign_in message\".\n\n**Possible reason**\n\nAfter changing password, the session is not properly expired, and still allows changes. \nThe problem seem to be connected with \"Change password sign_out\" event.  ","markdown_message":"\u003cp\u003e\u003cstrong\u003eAn important update\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis seems to be true for querying profile value as well  as well. The below  graphql query is fired when \u0026quot;update profile\u0026quot; is clicked at \u003ca title=\"https://hackerone.com/settings/profile/edit\" href=\"https://hackerone.com/settings/profile/edit\"\u003ehttps://hackerone.com/settings/profile/edit\u003c/a\u003e without changing current profile values.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003equery Profile_settings_MeRelayQL (......)\u003cbr\u003e\n\u0026quot;variables\u0026quot; : {\u003cbr\u003e\n                            .....\u003cbr\u003e\n                           }\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis returns current_user profile information. It was observed that even this can be repeated after password change without login. This does not need password as changing/querying profile values do not require a password. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eI again changed the password and captured the graphql request for the same. (User is signed out)\u003c/li\u003e\n\u003cli\u003eCreated above graphql query to query current profile with same  x-auth-token and  __Host-session values as      \u0026quot;change password graphql mutation request\u0026quot;. It worked and returned user info even after sign out.\u003cbr\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNormally this would return \u0026quot;You need to sign_in message\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePossible reason\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter changing password, the session is not properly expired, and still allows changes. \u003cbr\u003e\nThe problem seem to be connected with \u0026quot;Change password sign_out\u0026quot; event.  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-28T22:37:39.796Z","updated_at":"2017-10-28T22:44:24.090Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2110703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Update**\n\nThis seem to work with all graphql queries that follows a change password sign out event.\n The problem lies with session not being terminated properly after a password change.  ","markdown_message":"\u003cp\u003e\u003cstrong\u003eUpdate\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis seem to work with all graphql queries that follows a change password sign out event.\u003cbr\u003e\n The problem lies with session not being terminated properly after a password change.  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-28T22:52:36.226Z","updated_at":"2017-10-28T22:52:36.226Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2112946,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would request you to excuse me for the title. This seems to be an issue with the session expiration. Please verify.\nThank you","markdown_message":"\u003cp\u003eI would request you to excuse me for the title. This seems to be an issue with the session expiration. Please verify.\u003cbr\u003e\nThank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-30T13:47:59.095Z","updated_at":"2017-10-30T13:47:59.095Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2114235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me clear things up if there is any confusion. \n\nAt the time of testing I changed the password and after being signed out, I replayed the graphql query to change password and observed that updation still works after signout. And so the complicated title. At first, I thought that this was limited to just password change.  \n\nBut later, on investigating further it was clear that, **any graphql request after a password change was working even after signout.**  \n\nThus the problem is that the session is not expired, when the user is redirected to sign_in page after password change. And requests after can make changes although user seems to be signed out. \n\nHence I would like to clear that this report addresses an issue of session not being terminated properly , after password change. The issue  possibly exists only in the sign out action, after password change. Because after a normal sign_out, the requests seem to return \"invalid_credentials\" response.\n\nJust wanted to sum things up to avoid any confusion if exists. Hope this helps. \nThank you.","markdown_message":"\u003cp\u003eLet me clear things up if there is any confusion. \u003c/p\u003e\n\n\u003cp\u003eAt the time of testing I changed the password and after being signed out, I replayed the graphql query to change password and observed that updation still works after signout. And so the complicated title. At first, I thought that this was limited to just password change.  \u003c/p\u003e\n\n\u003cp\u003eBut later, on investigating further it was clear that, \u003cstrong\u003eany graphql request after a password change was working even after signout.\u003c/strong\u003e  \u003c/p\u003e\n\n\u003cp\u003eThus the problem is that the session is not expired, when the user is redirected to sign_in page after password change. And requests after can make changes although user seems to be signed out. \u003c/p\u003e\n\n\u003cp\u003eHence I would like to clear that this report addresses an issue of session not being terminated properly , after password change. The issue  possibly exists only in the sign out action, after password change. Because after a normal sign_out, the requests seem to return \u0026quot;invalid_credentials\u0026quot; response.\u003c/p\u003e\n\n\u003cp\u003eJust wanted to sum things up to avoid any confusion if exists. Hope this helps. \u003cbr\u003e\nThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-30T17:58:06.191Z","updated_at":"2017-10-30T17:58:06.191Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2118014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates team?","markdown_message":"\u003cp\u003eAny updates team?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-31T16:41:32.530Z","updated_at":"2017-10-31T16:41:32.530Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119659,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @bigbug  - I don't quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request? ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e  - I don\u0026#39;t quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-31T22:28:46.715Z","updated_at":"2017-10-31T22:28:46.715Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119966,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @coffeecup,\n\n**As mentioned above the actual bug/ issue I want to report here is the session termination issue.** \n\nI know the title is a bit confusing here. This is because the bug was revealed to me while trying to change the password. At the time of reporting this, I thought that this is just limited to repeating password change requests, and so decided to report with this title. \n\nBut the actual big here is that although you are redirected to sign-in page after a password change, you can still query and make changes to the account with graphql requests. **This shows a broken session termination**\n\nPlease Note - Changing of password is just another possibility. The real fact is that any graphql request (query or mutation) is still valid and can still make changes in the account. \n\n**I would like to end this saying that this is a case of session termination issue, that happens after a password change.**\n\nI will be happy to provide detail POC or any further information on the same. Just wanted to clarify we are on the same track first.\n\nThank you","markdown_message":"\u003cp\u003eHello \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAs mentioned above the actual bug/ issue I want to report here is the session termination issue.\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eI know the title is a bit confusing here. This is because the bug was revealed to me while trying to change the password. At the time of reporting this, I thought that this is just limited to repeating password change requests, and so decided to report with this title. \u003c/p\u003e\n\n\u003cp\u003eBut the actual big here is that although you are redirected to sign-in page after a password change, you can still query and make changes to the account with graphql requests. \u003cstrong\u003eThis shows a broken session termination\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease Note - Changing of password is just another possibility. The real fact is that any graphql request (query or mutation) is still valid and can still make changes in the account. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eI would like to end this saying that this is a case of session termination issue, that happens after a password change.\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI will be happy to provide detail POC or any further information on the same. Just wanted to clarify we are on the same track first.\u003c/p\u003e\n\n\u003cp\u003eThank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-01T02:21:59.348Z","updated_at":"2017-11-01T02:25:14.475Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2120004,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me answer your above query \n\u003eHi @bigbug - I don't quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request\n\nThis report is  actually inspired by the new OWASP testing guide v4 , focussing on **Testing for logout functionality (OTG-SESS-006)** at https://www.owasp.org/index.php/Testing_for_logout_functionality_(OTG-SESS-006)\n\nI would request you to scroll to the **Testing for server-side session termination** section. This is what I want to highlight. \n\n**Scenario**\n\nImagine a scenario where the user after changing password is redirected to sign-in page, assuming that he/she is logged out.But actually the session tokens are still alive at the server. The session tokens in our case **_Host-session** is not expired yet actually.\n\nThe risk is in an environment that caches or stores requests or responses especially for testing purposes. As the session tokens are not expired on the server, the requests can still be replayed. eg Cookie replay attacks - https://www.vanstechelman.eu/content/cookie-replay-attacks-in-aspnet-when-using-forms-authentication\n\nA proxy was used here to demonstrate the risk of the same. \n\n**Mitigation**\n\nSession tokens at server-side should be terminated as well. ","markdown_message":"\u003cp\u003eLet me answer your above query \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e - I don\u0026#39;t quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis report is  actually inspired by the new OWASP testing guide v4 , focussing on \u003cstrong\u003eTesting for logout functionality (OTG-SESS-006)\u003c/strong\u003e at \u003ca title=\"https://www.owasp.org/index.php/Testing_for_logout_functionality_(OTG-SESS-006)\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTesting_for_logout_functionality_%28OTG-SESS-006%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Testing_for_logout_functionality_(OTG-SESS-006)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI would request you to scroll to the \u003cstrong\u003eTesting for server-side session termination\u003c/strong\u003e section. This is what I want to highlight. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eScenario\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eImagine a scenario where the user after changing password is redirected to sign-in page, assuming that he/she is logged out.But actually the session tokens are still alive at the server. The session tokens in our case \u003cstrong\u003e_Host-session\u003c/strong\u003e is not expired yet actually.\u003c/p\u003e\n\n\u003cp\u003eThe risk is in an environment that caches or stores requests or responses especially for testing purposes. As the session tokens are not expired on the server, the requests can still be replayed. eg Cookie replay attacks - \u003ca title=\"https://www.vanstechelman.eu/content/cookie-replay-attacks-in-aspnet-when-using-forms-authentication\" href=\"/redirect?url=https%3A%2F%2Fwww.vanstechelman.eu%2Fcontent%2Fcookie-replay-attacks-in-aspnet-when-using-forms-authentication\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.vanstechelman.eu/content/cookie-replay-attacks-in-aspnet-when-using-forms-authentication\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eA proxy was used here to demonstrate the risk of the same. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eSession tokens at server-side should be terminated as well. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-01T02:59:35.724Z","updated_at":"2017-11-01T03:02:26.613Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2120045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nTo my surprise I found this report #353 (https://hackerone.com/reports/353).\n\nThis report was submitted to hackerone and was closed after resolved with a bounty.\n\nThis is exactly what we have here too. But the bug is not resolved fully. The issue seems to be with  password change action.\n\nI request you to please look into this.\n\nThank you for your patience @coffeecup. ","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eTo my surprise I found this report \u003ca href=\"/reports/353\"\u003e#353\u003c/a\u003e (\u003ca title=\"https://hackerone.com/reports/353\" href=\"https://hackerone.com/reports/353\"\u003ehttps://hackerone.com/reports/353\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eThis report was submitted to hackerone and was closed after resolved with a bounty.\u003c/p\u003e\n\n\u003cp\u003eThis is exactly what we have here too. But the bug is not resolved fully. The issue seems to be with  password change action.\u003c/p\u003e\n\n\u003cp\u003eI request you to please look into this.\u003c/p\u003e\n\n\u003cp\u003eThank you for your patience \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-01T03:56:25.944Z","updated_at":"2017-11-01T03:59:27.681Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2125158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup any updates on this? ","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e any updates on this? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-02T14:12:01.723Z","updated_at":"2017-11-02T14:12:01.723Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132822,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @bigbug - Could you provide me with a step by step PoC demonstrating this vulnerability? I'm getting kind of confused over your report since it seems like the first issue you reported doesn't seem to valid anymore:\n\n\u003e As mentioned above the actual bug/ issue I want to report here is the session termination issue.\n\nCould you list step by step instructions on how I can reproduce this? It would be much appreciated, thanks! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e - Could you provide me with a step by step PoC demonstrating this vulnerability? I\u0026#39;m getting kind of confused over your report since it seems like the first issue you reported doesn\u0026#39;t seem to valid anymore:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAs mentioned above the actual bug/ issue I want to report here is the session termination issue.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCould you list step by step instructions on how I can reproduce this? It would be much appreciated, thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-03T18:59:58.423Z","updated_at":"2017-11-03T18:59:58.423Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132900,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@coffeecup Below are steps you requested\n\n**Steps**\n\n1. Fire up a web debugging proxy to capture requests. Start capture.\n2. Login to account. Navigate to https://hackerone.com/settings/profile/edit. Check for POST request to https://hackerone.com/graphql. (any graphql request will work.)\n3. Navigate to https://hackerone.com/settings/pass/edit. Input values (current password, new password and confirm password). Click \"Change password\" button.\n(User is now signed out and redirected to sign_in page)  \n\n4. Now repeat any graphql request previously captured in step 2. Any graphql request will work. This will return correct data even after logout. Normally it would return \"invalid credentials\" response\n\n**Note**\n\nRepetition of request returns proper response although user was signed out. In order to reproduce this clearly, You can try graphql query that queries users profile or the password change mutation request itself to see correct response and account modifications respectively\n\nHope this helps @coffeecup ","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e Below are steps you requested\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFire up a web debugging proxy to capture requests. Start capture.\u003c/li\u003e\n\u003cli\u003eLogin to account. Navigate to \u003ca title=\"https://hackerone.com/settings/profile/edit\" href=\"https://hackerone.com/settings/profile/edit\"\u003ehttps://hackerone.com/settings/profile/edit\u003c/a\u003e. Check for POST request to \u003ca title=\"https://hackerone.com/graphql\" href=\"https://hackerone.com/graphql\"\u003ehttps://hackerone.com/graphql\u003c/a\u003e. (any graphql request will work.)\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNavigate to \u003ca title=\"https://hackerone.com/settings/pass/edit\" href=\"https://hackerone.com/settings/pass/edit\"\u003ehttps://hackerone.com/settings/pass/edit\u003c/a\u003e. Input values (current password, new password and confirm password). Click \u0026quot;Change password\u0026quot; button.\u003cbr\u003e\n(User is now signed out and redirected to sign_in page)  \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNow repeat any graphql request previously captured in step 2. Any graphql request will work. This will return correct data even after logout. Normally it would return \u0026quot;invalid credentials\u0026quot; response\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eRepetition of request returns proper response although user was signed out. In order to reproduce this clearly, You can try graphql query that queries users profile or the password change mutation request itself to see correct response and account modifications respectively\u003c/p\u003e\n\n\u003cp\u003eHope this helps \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-03T19:25:44.545Z","updated_at":"2017-11-03T19:25:44.545Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nLet me also add that the issue is due to improper session termination **after password change**\n\nAnd also it works only with **graphql requests both (query and mutation)**\n\nHope this helps","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eLet me also add that the issue is due to improper session termination \u003cstrong\u003eafter password change\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd also it works only with \u003cstrong\u003egraphql requests both (query and mutation)\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eHope this helps\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-03T19:33:36.624Z","updated_at":"2017-11-03T19:33:36.624Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2133156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nHope the steps were clear enough to reproduce the issue.\n\nI would request you to change the title of this report to avoid confusion to something relevant relating to session termination after a password change, once it is verified. Thank you ","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eHope the steps were clear enough to reproduce the issue.\u003c/p\u003e\n\n\u003cp\u003eI would request you to change the title of this report to avoid confusion to something relevant relating to session termination after a password change, once it is verified. Thank you \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-03T20:52:02.749Z","updated_at":"2017-11-03T20:52:02.749Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2134147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @coffeecup \n\nI am attaching a POC video demonstrating the steps. \n\nI created a test account for this video.\n\nHope this helps! Thank you","markdown_message":"\u003cp\u003eHello \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI am attaching a POC video demonstrating the steps. \u003c/p\u003e\n\n\u003cp\u003eI created a test account for this video.\u003c/p\u003e\n\n\u003cp\u003eHope this helps! Thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-04T12:03:58.660Z","updated_at":"2017-11-04T12:10:44.280Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":236485,"filename":"h1_graphql_repeat.compressed.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/236/485/e78850a1a731bf14f20fb3f5a4c02e6d7bd583a7/h1_graphql_repeat.compressed.mp4?response-content-disposition=attachment%3B%20filename%3D%22h1_graphql_repeat.compressed.mp4%22%3B%20filename%2A%3DUTF-8%27%27h1_graphql_repeat.compressed.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052329Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=48af7dc9b7f9815cb3846b6ca1a8e0a25eb9a23bf403d27ad46b389d1b47ae41"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2137311,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @coffeecup any updates?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-06T16:13:17.937Z","updated_at":"2017-11-06T16:13:17.937Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2141319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup Anything on the review of this report?","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e Anything on the review of this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-07T20:28:30.623Z","updated_at":"2017-11-07T20:28:30.623Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigbug - I'm looking into this now, thanks for the additional information. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e - I\u0026#39;m looking into this now, thanks for the additional information. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-08T17:12:40.768Z","updated_at":"2017-11-08T17:12:40.768Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143890,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We believe this may be a valid issue, so I'm going to mark this as `Triaged` for now as we continue to investigate. Thanks for your patience as we look into this further. I'll update you when we have additional information to share. ","markdown_message":"\u003cp\u003eWe believe this may be a valid issue, so I\u0026#39;m going to mark this as \u003ccode\u003eTriaged\u003c/code\u003e for now as we continue to investigate. Thanks for your patience as we look into this further. I\u0026#39;ll update you when we have additional information to share. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-08T19:31:22.842Z","updated_at":"2017-11-08T19:31:22.842Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nThank you for the quick response. Will surely wait for further updates. Thanks again!","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for the quick response. Will surely wait for further updates. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-08T19:41:45.227Z","updated_at":"2017-11-08T19:41:45.227Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161108,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @bigbug - \n\nThanks for reporting this to us. We've determined that the token expires after a certain amount of time (I think after 10/20 minutes). With this in mind, and also keeping in mind that an attacker would need MiTM access to the victim's computer or browsing history in order to exploit this, we won't be issuing a fix right away nor tracking this as a security issue. With that said, I'll be closing this as `Informative`. Please continue to send us bug reports, we look forward to more reports from you in the future. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e - \u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this to us. We\u0026#39;ve determined that the token expires after a certain amount of time (I think after 10/20 minutes). With this in mind, and also keeping in mind that an attacker would need MiTM access to the victim\u0026#39;s computer or browsing history in order to exploit this, we won\u0026#39;t be issuing a fix right away nor tracking this as a security issue. With that said, I\u0026#39;ll be closing this as \u003ccode\u003eInformative\u003c/code\u003e. Please continue to send us bug reports, we look forward to more reports from you in the future. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-15T23:16:16.304Z","updated_at":"2017-11-15T23:16:16.304Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161416,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup Thank you for confirming that. Is this eligible for public disclosure?","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e Thank you for confirming that. Is this eligible for public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-16T03:19:25.417Z","updated_at":"2017-11-16T03:19:25.417Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup If possible could you also look into report #273651? I think it needs some serious attention.\n\nThank you","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e If possible could you also look into report \u003ca href=\"/reports/273651\"\u003e#273651\u003c/a\u003e? I think it needs some serious attention.\u003c/p\u003e\n\n\u003cp\u003eThank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-16T03:26:17.212Z","updated_at":"2017-11-16T03:26:17.212Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166182,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T19:39:19.056Z","updated_at":"2017-11-17T19:39:19.056Z","first_to_agree":true,"actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this? If yes I would like you to change the title to something relevant. Thank you","markdown_message":"\u003cp\u003eCan we disclose this? If yes I would like you to change the title to something relevant. Thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T19:44:18.355Z","updated_at":"2017-11-17T19:44:18.355Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166383,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T21:12:34.388Z","updated_at":"2017-11-17T21:12:34.388Z","additional_data":{"old_title":"Change password after signout, without login, by repeating graphql mutation request. ","new_title":"GraphQL sessions aren't immediately invalided when user password is changed"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T21:12:57.125Z","updated_at":"2017-11-17T21:12:57.125Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166386,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T21:12:57.391Z","updated_at":"2017-11-17T21:12:57.391Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166387,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T21:13:35.490Z","updated_at":"2017-11-17T21:13:35.490Z","additional_data":{"old_title":"GraphQL sessions aren't immediately invalided when user password is changed","new_title":"GraphQL sessions aren't immediately invalidated when user password is changed"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Thank you for the apt title. ","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e Thank you for the apt title. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T21:20:11.300Z","updated_at":"2017-11-17T21:20:11.300Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181232,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2017-11-24T20:14:24.576Z","updated_at":"2017-11-24T20:14:24.576Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"aorta","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181249,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2017-11-24T20:43:20.925Z","updated_at":"2017-11-24T20:43:20.925Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"aorta","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2188762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems there was a fix from your end on this. Now on repeating the request immediately, it returns `invalid credentials`. Could you provide updates on this? Was this report reviewed again?","markdown_message":"\u003cp\u003eIt seems there was a fix from your end on this. Now on repeating the request immediately, it returns \u003ccode\u003einvalid credentials\u003c/code\u003e. Could you provide updates on this? Was this report reviewed again?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T14:02:19.278Z","updated_at":"2017-11-29T14:02:19.278Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2189852,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Could you please provide some information on this?","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e Could you please provide some information on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T21:26:12.161Z","updated_at":"2017-11-29T21:26:12.161Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2190156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bigbug Sure, no problem! We did make some changes to other related sign out inconsistencies, but we still don't invalidate a signed out GraphQL session, because there is no session. We did proactively ensure that other places where we intentionally kill the user's session that we invalidate a GraphQL session that does exist. Though this may slow down an attacker, they can still infinitely use the signed out GraphQL session to workaround our proactive changes. Our protection, which was already in place, is rate limiting.","markdown_message":"\u003cp\u003e\u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e Sure, no problem! We did make some changes to other related sign out inconsistencies, but we still don\u0026#39;t invalidate a signed out GraphQL session, because there is no session. We did proactively ensure that other places where we intentionally kill the user\u0026#39;s session that we invalidate a GraphQL session that does exist. Though this may slow down an attacker, they can still infinitely use the signed out GraphQL session to workaround our proactive changes. Our protection, which was already in place, is rate limiting.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T23:55:20.707Z","updated_at":"2017-11-29T23:55:20.707Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2190389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert So cant this be considered a fix to issue that I have reported? Because the `user session` was not invalidated too at the time of reporting this. I had mentioned regarding `_Host-session` expiration as a fix.\n\nnow you have terminated user sessions too which wouldn't normally. \nSo i consider it a fix from your end that relates to user sessions. \n\nAnd the token expiration is actually of the user session ie `_Host-session` and not graphql token that causes the issue. I feel this is resolved. \n\nAccording to me this is a fix I was expecting. ","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e So cant this be considered a fix to issue that I have reported? Because the \u003ccode\u003euser session\u003c/code\u003e was not invalidated too at the time of reporting this. I had mentioned regarding \u003ccode\u003e_Host-session\u003c/code\u003e expiration as a fix.\u003c/p\u003e\n\n\u003cp\u003enow you have terminated user sessions too which wouldn\u0026#39;t normally. \u003cbr\u003e\nSo i consider it a fix from your end that relates to user sessions. \u003c/p\u003e\n\n\u003cp\u003eAnd the token expiration is actually of the user session ie \u003ccode\u003e_Host-session\u003c/code\u003e and not graphql token that causes the issue. I feel this is resolved. \u003c/p\u003e\n\n\u003cp\u003eAccording to me this is a fix I was expecting. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-30T04:26:21.301Z","updated_at":"2017-11-30T04:26:21.301Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2192297,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T22:25:32.399Z","updated_at":"2017-11-30T22:25:32.399Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192299,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @bigbug - marking this as resolved. The initial behavior you reported to us was changed as a side-effect of a code refactor. I wanted to reiterate that the exploit window of the initial vulnerability was limited to 5 minutes after signing out, because then the tokens expire. This is why we marked it as informative. However, since the behavior was changed to close to your report, we're closing this as resolved. This report is not eligible for a bounty due to the lack of exploitability. Good luck and happy hacking!\n\nJobert","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bigbug\"\u003e@bigbug\u003c/a\u003e - marking this as resolved. The initial behavior you reported to us was changed as a side-effect of a code refactor. I wanted to reiterate that the exploit window of the initial vulnerability was limited to 5 minutes after signing out, because then the tokens expire. This is why we marked it as informative. However, since the behavior was changed to close to your report, we\u0026#39;re closing this as resolved. This report is not eligible for a bounty due to the lack of exploitability. Good luck and happy hacking!\u003c/p\u003e\n\n\u003cp\u003eJobert\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-30T22:27:56.867Z","updated_at":"2017-11-30T22:27:56.867Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"bigbug","url":"/bigbug"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192300,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T22:28:06.634Z","updated_at":"2017-11-30T22:28:06.634Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192301,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T22:28:17.304Z","updated_at":"2017-11-30T22:28:17.304Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192302,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T22:28:39.701Z","updated_at":"2017-11-30T22:28:39.701Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}