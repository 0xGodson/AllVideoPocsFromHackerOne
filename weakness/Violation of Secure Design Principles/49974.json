{"id":49974,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTk3NA==","url":"https://hackerone.com/reports/49974","title":"The csrf token remains same after user logs in","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-04T05:38:37.035Z","submitted_at":"2015-03-04T05:38:37.035Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"crab","url":"/crab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-26T20:47:27.692Z","bug_reporter_agreed_on_going_public_at":"2015-10-27T20:47:24.253Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"As the CSRF token doesn't change after login. Any other user that uses the same workstation is vulnerable. A safer way would be to use dynamic CSRF token or just change the token after login, so attacker doesnt get hold of this. \r\n\r\nDetails of the attacks scenario in a shared workstation environment\r\n\r\n1. The attacker simply copies the authenticity token. This token is the only protection against the CSRF attack.\r\n\r\n2. Any other user that uses the workstation after that is vulnerable to CSRF. The attacker simply needs to craft a link with the required GET or POST method as he already have the CSRF token and send it to the victim via email, chat etc.\r\n\r\n3. The attacker can trick the victim in doing anything he wants without the user being aware of it.\r\n\r\nIn the most basic sense the attacker has an authenticity token of another user which he shouldn't have had in the first place.","vulnerability_information_html":"\u003cp\u003eAs the CSRF token doesn\u0026#39;t change after login. Any other user that uses the same workstation is vulnerable. A safer way would be to use dynamic CSRF token or just change the token after login, so attacker doesnt get hold of this. \u003c/p\u003e\n\n\u003cp\u003eDetails of the attacks scenario in a shared workstation environment\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eThe attacker simply copies the authenticity token. This token is the only protection against the CSRF attack.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAny other user that uses the workstation after that is vulnerable to CSRF. The attacker simply needs to craft a link with the required GET or POST method as he already have the CSRF token and send it to the victim via email, chat etc.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe attacker can trick the victim in doing anything he wants without the user being aware of it.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn the most basic sense the attacker has an authenticity token of another user which he shouldn\u0026#39;t have had in the first place.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-26T20:47:24.362Z","allow_singular_disclosure_after":-160651317.5400245,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","i_am-secret-_-not-a-man"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":346054,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-04T18:25:28.158Z","updated_at":"2015-03-04T18:25:28.158Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":351114,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any Update?\n\nThanks\nSparsh","markdown_message":"\u003cp\u003eAny Update?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nSparsh\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-11T14:40:17.803Z","updated_at":"2015-03-11T14:40:17.803Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe this is fixed now. Can you check it out?","markdown_message":"\u003cp\u003eI believe this is fixed now. Can you check it out?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-11T19:18:33.261Z","updated_at":"2015-03-11T19:18:33.261Z","actor":{"username":"yodasan","cleared":false,"url":"/yodasan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/641/60460404e2104de1afef63d4ebddac286f8cae45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":351547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes it is fixed now. \n\nThanks \nSparsh","markdown_message":"\u003cp\u003eYes it is fixed now. \u003c/p\u003e\n\n\u003cp\u003eThanks \u003cbr\u003e\nSparsh\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-11T20:54:08.860Z","updated_at":"2015-03-11T20:54:08.860Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is this eligible for a bounty? ","markdown_message":"\u003cp\u003eIs this eligible for a bounty? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T11:49:41.840Z","updated_at":"2015-03-12T11:49:41.840Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352298,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-12T17:30:37.751Z","updated_at":"2015-03-12T17:30:37.751Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"crab","url":"/crab"},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":352303,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\nThanks again!","markdown_message":"\u003cp\u003eThank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\u003cbr\u003e\nThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T17:31:26.741Z","updated_at":"2015-03-12T17:31:26.741Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"crab","url":"/crab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":352675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What attacks fall under direct exploitation? Its a CSRF issue that can be used for CSRF attack.\n\nThanks\nSparsh","markdown_message":"\u003cp\u003eWhat attacks fall under direct exploitation? Its a CSRF issue that can be used for CSRF attack.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nSparsh\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T21:13:04.771Z","updated_at":"2015-03-12T21:13:04.771Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But this issue was just one of several attacks required to compromise an account. You'd need physical access to their machine in order to get their CSRF token in the first place. Then, you'd need to socially engineer them to get them to click an attacker-controlled link to pull off the CSRF attack. \n\nAn example of a direct attack would be e.g. an un-encrypted communication that leaked a session ID, or a missing function-level access check. \n\nDoes this make sense?","markdown_message":"\u003cp\u003eBut this issue was just one of several attacks required to compromise an account. You\u0026#39;d need physical access to their machine in order to get their CSRF token in the first place. Then, you\u0026#39;d need to socially engineer them to get them to click an attacker-controlled link to pull off the CSRF attack. \u003c/p\u003e\n\n\u003cp\u003eAn example of a direct attack would be e.g. an un-encrypted communication that leaked a session ID, or a missing function-level access check. \u003c/p\u003e\n\n\u003cp\u003eDoes this make sense?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T21:35:19.948Z","updated_at":"2015-03-12T21:35:19.948Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":352741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Very well, by direct exploitation you mean without user involvement. Thanks for the bounty.\n\nSparsh","markdown_message":"\u003cp\u003eVery well, by direct exploitation you mean without user involvement. Thanks for the bounty.\u003c/p\u003e\n\n\u003cp\u003eSparsh\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T21:47:33.805Z","updated_at":"2015-03-12T21:50:50.603Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":634605,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-27T20:47:24.285Z","updated_at":"2015-10-27T20:47:24.285Z","first_to_agree":true,"actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":700327,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-26T20:47:27.755Z","updated_at":"2015-11-26T20:47:27.755Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}