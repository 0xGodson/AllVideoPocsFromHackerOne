{"id":3227,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjI3","url":"https://hackerone.com/reports/3227","title":"Control Characters Not Stripped From Username on Signup","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-03-04T21:46:39.784Z","submitted_at":"2014-03-04T21:46:39.784Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"wkcaj","url":"/wkcaj","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/XUpxaSL8CCPX7zi8e1nDHH1q/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-03-11T20:33:27.097Z","bug_reporter_agreed_on_going_public_at":"2014-03-11T20:33:26.906Z","team_member_agreed_on_going_public_at":"2014-03-11T05:14:21.317Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey,\r\n\r\nTo be honest, I'm not sure if there is any *real* security implications of this bug, but it's (IMO) something which should be fixed at some point (since it'll be pretty easy).\r\n\r\nOn signup, the username you chose has to be alphanumeric. If you submit someone else's username, followed by a null-byte (`%00`), you'll get an error indicating that the username has been taken (expected behaviour). Same with `%20`. However, if you submit the username followed by a control character, such as a new line (`%0a`), the request will go through and you'll be signed up.\r\n\r\nThere are a couple of consequences of this. The first is that your profile can't be viewed (which also means you can't update your own settings!). You'll get a 404.\r\n\r\nThe second is that any bug reports you submit will look like another user submitted them. Again, not that big of a deal.\r\n\r\n### Proof-of-Concept\r\n1. Browse to https://hackerone.com/users/sign_up\r\n2. Enter any details, make sure your username is followed by `%0a` (use Burp to append it)\r\n3. Confirm your email, then login\r\n4. Click your profile picture in the top right\r\n5. You'll get a 404\r\n\r\nIf you need anymore information just shout,\r\nCheers,\r\nJack","vulnerability_information_html":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eTo be honest, I\u0026#39;m not sure if there is any \u003cem\u003ereal\u003c/em\u003e security implications of this bug, but it\u0026#39;s (IMO) something which should be fixed at some point (since it\u0026#39;ll be pretty easy).\u003c/p\u003e\n\n\u003cp\u003eOn signup, the username you chose has to be alphanumeric. If you submit someone else\u0026#39;s username, followed by a null-byte (\u003ccode\u003e%00\u003c/code\u003e), you\u0026#39;ll get an error indicating that the username has been taken (expected behaviour). Same with \u003ccode\u003e%20\u003c/code\u003e. However, if you submit the username followed by a control character, such as a new line (\u003ccode\u003e%0a\u003c/code\u003e), the request will go through and you\u0026#39;ll be signed up.\u003c/p\u003e\n\n\u003cp\u003eThere are a couple of consequences of this. The first is that your profile can\u0026#39;t be viewed (which also means you can\u0026#39;t update your own settings!). You\u0026#39;ll get a 404.\u003c/p\u003e\n\n\u003cp\u003eThe second is that any bug reports you submit will look like another user submitted them. Again, not that big of a deal.\u003c/p\u003e\n\n\u003ch3 id=\"proof-of-concept\"\u003eProof-of-Concept\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eBrowse to \u003ca title=\"https://hackerone.com/users/sign_up\" href=\"https://hackerone.com/users/sign_up\"\u003ehttps://hackerone.com/users/sign_up\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter any details, make sure your username is followed by \u003ccode\u003e%0a\u003c/code\u003e (use Burp to append it)\u003c/li\u003e\n\u003cli\u003eConfirm your email, then login\u003c/li\u003e\n\u003cli\u003eClick your profile picture in the top right\u003c/li\u003e\n\u003cli\u003eYou\u0026#39;ll get a 404\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIf you need anymore information just shout,\u003cbr\u003e\nCheers,\u003cbr\u003e\nJack\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-04-10T04:12:54.814Z","allow_singular_disclosure_after":-212116934.2789816,"singular_disclosure_allowed":true,"vote_count":7,"voters":["sw33tlie","japz","cryptographer","spetr0x","hdarji","dyabla","12345abcd"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":13022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The only other scenario I can think of where this could be used in is when you assign a bug to another user. Not sure how it works (since I only have access to the reporter side of the site), but if it shows a list of all users on the site, a team member might accidentally chose the wrong person.\n\nJack","markdown_message":"\u003cp\u003eThe only other scenario I can think of where this could be used in is when you assign a bug to another user. Not sure how it works (since I only have access to the reporter side of the site), but if it shows a list of all users on the site, a team member might accidentally chose the wrong person.\u003c/p\u003e\n\n\u003cp\u003eJack\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-04T21:48:49.148Z","updated_at":"2014-03-04T21:48:49.148Z","actor":{"username":"wkcaj","cleared":false,"url":"/wkcaj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XUpxaSL8CCPX7zi8e1nDHH1q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13170,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hah, nice find! Can't think of too many severe security implications but this is clowny. We'll get it fixed.","markdown_message":"\u003cp\u003eHah, nice find! Can\u0026#39;t think of too many severe security implications but this is clowny. We\u0026#39;ll get it fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-05T03:59:12.466Z","updated_at":"2014-03-05T03:59:12.466Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, cheers for getting back to me.\n\nJack","markdown_message":"\u003cp\u003eAwesome, cheers for getting back to me.\u003c/p\u003e\n\n\u003cp\u003eJack\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-06T11:30:49.574Z","updated_at":"2014-03-06T11:30:49.574Z","actor":{"username":"wkcaj","cleared":false,"url":"/wkcaj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XUpxaSL8CCPX7zi8e1nDHH1q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":15163,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey Jack - sorry for the delay, we've rolled out the fix for this. ","markdown_message":"\u003cp\u003eHey Jack - sorry for the delay, we\u0026#39;ve rolled out the fix for this. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-11T05:12:54.973Z","updated_at":"2014-03-11T05:12:54.973Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"wkcaj","url":"/wkcaj"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":15164,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-11T05:14:21.332Z","updated_at":"2014-03-11T05:14:21.332Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":15165,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're not aware of any immediate security implications, but there's a good chance this might have introduced further unexpected behavior in the future. Thanks for sending it in!","markdown_message":"\u003cp\u003eWe\u0026#39;re not aware of any immediate security implications, but there\u0026#39;s a good chance this might have introduced further unexpected behavior in the future. Thanks for sending it in!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-11T05:14:36.339Z","updated_at":"2014-03-11T05:14:36.339Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"wkcaj","url":"/wkcaj"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":15625,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome, cheers for the bounty, and glad to see it patched!","markdown_message":"\u003cp\u003eAwesome, cheers for the bounty, and glad to see it patched!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-11T20:33:26.920Z","updated_at":"2014-03-11T20:33:26.920Z","actor":{"username":"wkcaj","cleared":false,"url":"/wkcaj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XUpxaSL8CCPX7zi8e1nDHH1q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":15626,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-11T20:33:27.123Z","updated_at":"2014-03-11T20:33:27.123Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}