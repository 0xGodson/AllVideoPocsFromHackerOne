{"id":266454,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjY0NTQ=","url":"https://hackerone.com/reports/266454","title":"IDNs displayed in unicode","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-09-06T20:31:00.724Z","submitted_at":"2017-09-06T20:31:00.724Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hk755a","url":"/hk755a","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3152,"url":"https://hackerone.com/quora","handle":"quora","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Quora","twitter_handle":"quora","website":"http://www.quora.com","about":"A place to share knowledge and better understand the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-25T23:25:36.372Z","bug_reporter_agreed_on_going_public_at":"2017-10-16T15:00:08.042Z","team_member_agreed_on_going_public_at":"2017-10-25T23:25:36.321Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Quora,\n\nPlease refer https://en.wikipedia.org/wiki/Internationalized_domain_name to know more about IDNs.\n\nThe IDN (Internationalized Domain Name) : http://ebаy.com/\nis a homograph for the latin ebay.com. if you click that first link, you might think that you are going to ebay.com but in fact, you are going to a homograph url http://xn--eby-7cd.com/\n\nWhen an IDN is posted on Quora it displays it in Unicode. It would be safer to represent the Punycode version of the URL so that it would be apparent to the users that something wierd is going on. i.e show http://xn--quor-3ld.com/ instead of http://quorα.com\n\nI have tried this on Quora Android Application and Web browser on my android phone. The screenshot has been attached.\n\nA bad guy can exploit this vulnerability by putting up a spoof site behind one of these IDN links,posting the link anywhere on quora  and the user or the quora moderator/admin opens and carelessly enters his credentials there. \n\nQuora being a social networking site involves a lot of user conversation. Such an attack may affect a lot of users at once having a high impact and loss.\n\n\nSTEPS TO REPRODUCE:\n\n1.) Copy and paste the links in the PAYLOAD.txt file attached here.\n2.) Paste it anywhere. Most probably in the answers section.\n3.) Open Quora app or open Quora.com on phone and see the link. \n\n\nFacebook,hackerone,crowdcurity,Yelp and many major sites have implemented code to block such attacks.They show the punycode version of the IDN url.","vulnerability_information_html":"\u003cp\u003eHello Quora,\u003c/p\u003e\n\n\u003cp\u003ePlease refer \u003ca title=\"https://en.wikipedia.org/wiki/Internationalized_domain_name\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FInternationalized_domain_name\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Internationalized_domain_name\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to know more about IDNs.\u003c/p\u003e\n\n\u003cp\u003eThe IDN (Internationalized Domain Name) : \u003ca title=\"http://xn--eby-7cd.com/\" href=\"/redirect?url=http%3A%2F%2Fxn--eby-7cd.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://xn--eby-7cd.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nis a homograph for the latin ebay.com. if you click that first link, you might think that you are going to ebay.com but in fact, you are going to a homograph url \u003ca title=\"http://xn--eby-7cd.com/\" href=\"/redirect?url=http%3A%2F%2Fxn--eby-7cd.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://xn--eby-7cd.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen an IDN is posted on Quora it displays it in Unicode. It would be safer to represent the Punycode version of the URL so that it would be apparent to the users that something wierd is going on. i.e show \u003ca title=\"http://xn--quor-3ld.com/\" href=\"/redirect?url=http%3A%2F%2Fxn--quor-3ld.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://xn--quor-3ld.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e instead of \u003ca title=\"http://xn--quor-3ld.com\" href=\"/redirect?url=http%3A%2F%2Fxn--quor-3ld.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://xn--quor-3ld.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI have tried this on Quora Android Application and Web browser on my android phone. The screenshot has been attached.\u003c/p\u003e\n\n\u003cp\u003eA bad guy can exploit this vulnerability by putting up a spoof site behind one of these IDN links,posting the link anywhere on quora  and the user or the quora moderator/admin opens and carelessly enters his credentials there. \u003c/p\u003e\n\n\u003cp\u003eQuora being a social networking site involves a lot of user conversation. Such an attack may affect a lot of users at once having a high impact and loss.\u003c/p\u003e\n\n\u003cp\u003eSTEPS TO REPRODUCE:\u003c/p\u003e\n\n\u003cp\u003e1.) Copy and paste the links in the PAYLOAD.txt file attached here.\u003cbr\u003e\n2.) Paste it anywhere. Most probably in the answers section.\u003cbr\u003e\n3.) Open Quora app or open Quora.com on phone and see the link. \u003c/p\u003e\n\n\u003cp\u003eFacebook,hackerone,crowdcurity,Yelp and many major sites have implemented code to block such attacks.They show the punycode version of the IDN url.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":218855,"file_name":"PAYLOAD.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/855/6f1b9095f6df6e05e915f736770b68a605b7c290/PAYLOAD.txt?response-content-disposition=attachment%3B%20filename%3D%22PAYLOAD.txt%22%3B%20filename%2A%3DUTF-8%27%27PAYLOAD.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051725Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=0a263abc556de892d43329a4fa58a6b5947e93929ce992b18c33be9fc636ac65","file_size":72,"type":"text/plain"},{"id":218856,"file_name":"QUORA_ANDROID_APP_IDN_POC.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/856/808faa1859fc55dac7d247e99da7471c31352a64/QUORA_ANDROID_APP_IDN_POC.png?response-content-disposition=attachment%3B%20filename%3D%22QUORA_ANDROID_APP_IDN_POC.png%22%3B%20filename%2A%3DUTF-8%27%27QUORA_ANDROID_APP_IDN_POC.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051725Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=d2c5c485adf0fa333adfc6cf60a3d3db375c098bb986f51282aca4ddc2cc1c3b","file_size":115290,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["trabajoduro","manassarkar","dhaidhaiseenemein"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2026846,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there!\nAny updates on this? Its been quite a long time for just the first response! \n\nThanks \n\n","markdown_message":"\u003cp\u003eHello there!\u003cbr\u003e\nAny updates on this? Its been quite a long time for just the first response! \u003c/p\u003e\n\n\u003cp\u003eThanks \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-27T08:55:51.676Z","updated_at":"2017-09-27T08:55:51.676Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2036318,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A simple first response would be highly appreciable, Quora.\n\nThank You","markdown_message":"\u003cp\u003eA simple first response would be highly appreciable, Quora.\u003c/p\u003e\n\n\u003cp\u003eThank You\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-01T09:00:00.873Z","updated_at":"2017-10-01T09:00:00.873Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2060059,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hello @hk755a,\nThank you for your report. This were a tradeoff between security and user friendliness made by our product team long time ago that we might reconsider in the future. \nAs a security team we agree that this is a good practice and we're pushing for this changes. I'm going to close this as informative for now, however your reports help us to push into that direction. Thank you.\n\nAndrey.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/hk755a\"\u003e@hk755a\u003c/a\u003e,\u003cbr\u003e\nThank you for your report. This were a tradeoff between security and user friendliness made by our product team long time ago that we might reconsider in the future. \u003cbr\u003e\nAs a security team we agree that this is a good practice and we\u0026#39;re pushing for this changes. I\u0026#39;m going to close this as informative for now, however your reports help us to push into that direction. Thank you.\u003c/p\u003e\n\n\u003cp\u003eAndrey.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-11T21:22:02.610Z","updated_at":"2017-10-11T21:22:02.610Z","actor":{"username":"kur","cleared":false,"url":"/kur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2060523,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kur \nI want you to reconsider this report on the note that Quora being a social networking site that has its user base of some of the most renowned people of the world, demands to be taking security on higher priority than user friendliness. \n\nAttacks like this has always helped malicious users to target high profile users for their malicious intents .\n\n\nI request you to resolve this as soon as possible. ","markdown_message":"\u003cp\u003e\u003ca href=\"/kur\"\u003e@kur\u003c/a\u003e \u003cbr\u003e\nI want you to reconsider this report on the note that Quora being a social networking site that has its user base of some of the most renowned people of the world, demands to be taking security on higher priority than user friendliness. \u003c/p\u003e\n\n\u003cp\u003eAttacks like this has always helped malicious users to target high profile users for their malicious intents .\u003c/p\u003e\n\n\u003cp\u003eI request you to resolve this as soon as possible. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-12T01:56:31.575Z","updated_at":"2017-10-12T01:56:31.575Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2069204,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-16T15:00:08.067Z","updated_at":"2017-10-16T15:00:08.067Z","first_to_agree":true,"actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2100926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nAny Plans for resolving the issue? or may be public disclosure?","markdown_message":"\u003cp\u003eHey!\u003c/p\u003e\n\n\u003cp\u003eAny Plans for resolving the issue? or may be public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-25T06:13:15.575Z","updated_at":"2017-10-25T06:13:15.575Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2103487,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-25T23:25:36.341Z","updated_at":"2017-10-25T23:25:36.341Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2103488,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-25T23:25:36.387Z","updated_at":"2017-10-25T23:25:36.387Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}