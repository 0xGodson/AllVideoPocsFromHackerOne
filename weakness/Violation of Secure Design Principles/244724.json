{"id":244724,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ3MjQ=","url":"https://hackerone.com/reports/244724","title":"Unsafe Inline and Eval CSP Usage","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-06-30T11:51:04.742Z","submitted_at":"2017-06-30T11:51:04.742Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mr_r3boot","url":"/mr_r3boot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-24T15:23:12.178Z","bug_reporter_agreed_on_going_public_at":"2017-07-24T15:23:12.093Z","team_member_agreed_on_going_public_at":"2017-07-24T03:36:17.238Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team, The HTTP header of the wakatime.com website includes an unsafe CSP parameter for \"script-src\".\n\n#Impact:\nHowever, the \"script-src\" parameter is set to \"unsafe-inline\" or \"unsafe-eval\", which allows injection of user passed values, which in result can be misused for Cross-Site Scripting attacks. As a best practice, this value should not be included as a \"script-src\" parameter, if possible.\n\n#PoC:\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 30 Jun 2017 11:48:48 GMT\nContent-Type: application/json\nContent-Length: 2242\nConnection: close\nSet-Cookie: csrftoken=7032d6127e4e2a5fd4f74e2abbed3301403b0034; Expires=Fri, 07-Jul-2017 11:48:48 GMT; Max-Age=604800; Secure; Path=/\nVary: Cookie\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-XSS-Protection: 1; mode=block\nX-Frame-Options: SAMEORIGIN\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' data: https://*.stripe.com https://*.braintreegateway.com https://api.github.com https://*.olark.com https://wakatime.disqus.com https://*.disquscdn.com https://analytics.twitter.com https://platform.twitter.com https://static.ads-twitter.com/ https://www.google-analytics.com https://heapanalytics.com https://*.heapanalytics.com https://connect.facebook.net https://load.sumome.com https://sumome-140a.kxcdn.com; img-src 'self' data: https://ssl.google-analytics.com https://s-static.ak.facebook.com https://syndication.twitter.com https://sumome.com https://sumome-140a.kxcdn.com https://checkout.paypal.com https://bitbucket.org https://avatar-cdn.atlassian.com assets-cdn.github.com www.google-analytics.com https://*.braintreegateway.com heapanalytics.com https://analytics.twitter.com t.co *.twimg.com *.facebook.com *.olark.com *.disqus.com *.disquscdn.com *.githubusercontent.com *.gravatar.com *.wp.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://*.olark.com https://sumome-140a.kxcdn.com *.disquscdn.com; media-src https://*.olark.com https://*.amazonaws.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://*.stripe.com https://www.facebook.com https://s-static.ak.facebook.com https://staticxx.facebook.com https://*.twitter.com https://*.olark.com https://disqus.com www.youtube.com player.vimeo.com checkout.paypal.com; object-src 'self'; connect-src 'self' api.github.com www.google-analytics.com heapanalytics.com https://sumome.com *.olark.com https://avatar-cdn.atlassian.com https://secure.gravatar.com *.disqus.com;\n```\n\nAs can be seen, \"unsafe-inline\" and \"unsafe-eval\" is included in in the list of \"script-src\" parameters. \nThis does not result in an immediate threat, but should be excluded, if possible, as a best practice. For further information, see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src\n\nLet me know if any further info is required.\n\nRegards,\nMr.R3boot.","vulnerability_information_html":"\u003cp\u003eHi Team, The HTTP header of the wakatime.com website includes an unsafe CSP parameter for \u0026quot;script-src\u0026quot;.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact:\u003c/h1\u003e\n\n\u003cp\u003eHowever, the \u0026quot;script-src\u0026quot; parameter is set to \u0026quot;unsafe-inline\u0026quot; or \u0026quot;unsafe-eval\u0026quot;, which allows injection of user passed values, which in result can be misused for Cross-Site Scripting attacks. As a best practice, this value should not be included as a \u0026quot;script-src\u0026quot; parameter, if possible.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC:\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 30 Jun 2017 11:48:48 GMT\nContent-Type: application/json\nContent-Length: 2242\nConnection: close\nSet-Cookie: csrftoken=7032d6127e4e2a5fd4f74e2abbed3301403b0034; Expires=Fri, 07-Jul-2017 11:48:48 GMT; Max-Age=604800; Secure; Path=/\nVary: Cookie\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-XSS-Protection: 1; mode=block\nX-Frame-Options: SAMEORIGIN\nContent-Security-Policy: default-src \u0026#39;self\u0026#39;; script-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39; \u0026#39;unsafe-eval\u0026#39; data: https://*.stripe.com https://*.braintreegateway.com https://api.github.com https://*.olark.com https://wakatime.disqus.com https://*.disquscdn.com https://analytics.twitter.com https://platform.twitter.com https://static.ads-twitter.com/ https://www.google-analytics.com https://heapanalytics.com https://*.heapanalytics.com https://connect.facebook.net https://load.sumome.com https://sumome-140a.kxcdn.com; img-src \u0026#39;self\u0026#39; data: https://ssl.google-analytics.com https://s-static.ak.facebook.com https://syndication.twitter.com https://sumome.com https://sumome-140a.kxcdn.com https://checkout.paypal.com https://bitbucket.org https://avatar-cdn.atlassian.com assets-cdn.github.com www.google-analytics.com https://*.braintreegateway.com heapanalytics.com https://analytics.twitter.com t.co *.twimg.com *.facebook.com *.olark.com *.disqus.com *.disquscdn.com *.githubusercontent.com *.gravatar.com *.wp.com; style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39; https://fonts.googleapis.com https://*.olark.com https://sumome-140a.kxcdn.com *.disquscdn.com; media-src https://*.olark.com https://*.amazonaws.com; font-src \u0026#39;self\u0026#39; https://fonts.gstatic.com; frame-src \u0026#39;self\u0026#39; https://*.stripe.com https://www.facebook.com https://s-static.ak.facebook.com https://staticxx.facebook.com https://*.twitter.com https://*.olark.com https://disqus.com www.youtube.com player.vimeo.com checkout.paypal.com; object-src \u0026#39;self\u0026#39;; connect-src \u0026#39;self\u0026#39; api.github.com www.google-analytics.com heapanalytics.com https://sumome.com *.olark.com https://avatar-cdn.atlassian.com https://secure.gravatar.com *.disqus.com;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs can be seen, \u0026quot;unsafe-inline\u0026quot; and \u0026quot;unsafe-eval\u0026quot; is included in in the list of \u0026quot;script-src\u0026quot; parameters. \u003cbr\u003e\nThis does not result in an immediate threat, but should be excluded, if possible, as a best practice. For further information, see \u003ca title=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FContent-Security-Policy%2Fscript-src\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know if any further info is required.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nMr.R3boot.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-23T03:36:17.290Z","allow_singular_disclosure_after":-105759203.8132741,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","r3y","mr_r3boot","thejaguar"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1796079,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is to allow \"bootstrapping\" or passing data to JavaScript from HTML pages. It's a dangerous setting, so I'll fix it soon by passing data to JavaScript in the DOM instead of creating JavaScript variables from HTML.\n\nThank you for finding and reporting this!","markdown_message":"\u003cp\u003eThis is to allow \u0026quot;bootstrapping\u0026quot; or passing data to JavaScript from HTML pages. It\u0026#39;s a dangerous setting, so I\u0026#39;ll fix it soon by passing data to JavaScript in the DOM instead of creating JavaScript variables from HTML.\u003c/p\u003e\n\n\u003cp\u003eThank you for finding and reporting this!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-01T05:35:50.698Z","updated_at":"2017-07-01T05:35:50.698Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1817471,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please fix this.","markdown_message":"\u003cp\u003ePlease fix this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-09T02:48:05.507Z","updated_at":"2017-07-09T02:48:05.507Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1817474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will, please be patient.","markdown_message":"\u003cp\u003eWe will, please be patient.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-09T02:59:09.521Z","updated_at":"2017-07-09T02:59:17.083Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1861438,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've removed `unsafe-inline` from our CSP header, marking this resolved. Thanks for reporting this!\n\nNote: We left `unsafe-eval` and will not be removing that config since many dependencies require evaluating javascript.","markdown_message":"\u003cp\u003eWe\u0026#39;ve removed \u003ccode\u003eunsafe-inline\u003c/code\u003e from our CSP header, marking this resolved. Thanks for reporting this!\u003c/p\u003e\n\n\u003cp\u003eNote: We left \u003ccode\u003eunsafe-eval\u003c/code\u003e and will not be removing that config since many dependencies require evaluating javascript.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T03:01:42.287Z","updated_at":"2017-07-24T03:01:42.287Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mr_r3boot","url":"/mr_r3boot"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1861462,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the code used to bootstrap JavaScript variables so we could remove `unsafe-inline`:\nhttps://gist.github.com/alanhamlett/e4e710b038255809dcae5e565e31d70d","markdown_message":"\u003cp\u003eHere\u0026#39;s the code used to bootstrap JavaScript variables so we could remove \u003ccode\u003eunsafe-inline\u003c/code\u003e:\u003cbr\u003e\n\u003ca title=\"https://gist.github.com/alanhamlett/e4e710b038255809dcae5e565e31d70d\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2Falanhamlett%2Fe4e710b038255809dcae5e565e31d70d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/alanhamlett/e4e710b038255809dcae5e565e31d70d\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T03:36:05.570Z","updated_at":"2017-07-24T03:36:05.570Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1861463,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-24T03:36:17.258Z","updated_at":"2017-07-24T03:36:17.258Z","first_to_agree":true,"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1861493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just wanna know any Hoody/Swag from your side..?","markdown_message":"\u003cp\u003eJust wanna know any Hoody/Swag from your side..?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T04:08:11.363Z","updated_at":"2017-07-24T04:08:11.363Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1862762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can email security@, but normally we give swag for Critical or High reports.","markdown_message":"\u003cp\u003eYou can email security@, but normally we give swag for Critical or High reports.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T14:35:58.771Z","updated_at":"2017-07-24T14:35:58.771Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1862956,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks :) Mailed just now.","markdown_message":"\u003cp\u003eThanks :) Mailed just now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T15:22:16.615Z","updated_at":"2017-07-24T15:22:16.615Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1862961,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosing now.","markdown_message":"\u003cp\u003eDisclosing now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-24T15:23:12.128Z","updated_at":"2017-07-24T15:23:12.128Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1862962,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-24T15:23:12.201Z","updated_at":"2017-07-24T15:23:12.201Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}