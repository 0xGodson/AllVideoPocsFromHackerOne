{"id":108692,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg2OTI=","url":"https://hackerone.com/reports/108692","title":"Mixed Active Scripting Issue on stats.owncloud.org","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-06T05:31:33.422Z","submitted_at":"2016-01-06T05:31:33.422Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ishahriyar","url":"/ishahriyar","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-02-06T16:11:39.771Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-01-07T16:11:21.543Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\n\nI have come across with a HTTPS security issue - compromises HTTPS security by loading images from non secure source in stats.owncloud.org\nVulnerability Type: Mixed Active Scripting Issue\n\nDescription:\nMixed Active Content is content that has access to and can affect all or parts of the Document Object Model (DOM) of an HTTPS page. This type of mixed content can alter the behavior of an HTTPS page and potentially steal sensitive data from the user. Hence, in addition to the risks for Mixed Passive Content, Mixed Active Content is also exposed to a number of additional attack vectors.\nA MITM attacker can intercept requests for HTTP active content. The attacker can then re-write the response to include malicious JavaScript /fonts code. Malicious script can steal the user’s credentials, acquire sensitive data about the user, or attempt to install malware on the user’s system (by leveraging vulnerable plugins the user has installed, for example).\n\nCriticality level: Medium\n\nCriticality level justification:\nData which is transmitted in this link could be read by An attacker who is in Same network in some cases this could help to steal information.\n\nSteps:\n1) Visit link https://stats.owncloud.org\n2) Press F12 to open Developers tool in Google Chrome OR IE OR in Firefox browser and observe console. You will come across security error - \"A Secure Hypertext Transfer Protocol (HTTPS) page has content from a non-secure source.\n\nMixed content security error messages: : Firefox= 'Loading mixed (insecure) display content \"http://stats.owncloud.org/misc/user/logo.png'\n. This content should also be served over HTTPS.\n\nScenario:\nThere are 3 easy steps to attack the user through a mixed content vulnerability…\n1) Set-up a Man-in-the-Middle attack. These are most easily done on public networks such as those in coffee shops or airports.\n2) Use a mixed content vulnerability to inject a malicious javascript file. Malicious code will run in an HTTPS website that the user browsers to. The key point is that the HTTPS site has a mixed content vulnerability on it, which means that it executes content downloaded over HTTP. This is where the Man-in-the-Middle attack and Mixed Content vulnerability combine into a dangerous scenario.\n“If some attacker is able to either tamper with Javascript or stylesheet files he can effectively also tamper with the other content on your page (e.g. by modifying the DOM ). So it’s either all or nothing. Either all of your elements are served using SSL, then you are secure. Or you load some Javascript or stylesheet files from a plain HTTP connection, then you aren’t secure anymore.”\n3) Steal the user’s identity (or do other bad things).\n\nSolution ::\nMake sure all content in the page including images, js, fonts are from HTTPS sources.\n\nReference : http://msdn.microsoft.com/en-us/library/ie/dn423949(v=vs.85).aspx\nVideo :: http://www.youtube.com/watch?v=zEV3HOuM_Vw\n\nThanks.\n","vulnerability_information_html":"\u003cp\u003eI have come across with a HTTPS security issue - compromises HTTPS security by loading images from non secure source in stats.owncloud.org\u003cbr\u003e\nVulnerability Type: Mixed Active Scripting Issue\u003c/p\u003e\n\n\u003cp\u003eDescription:\u003cbr\u003e\nMixed Active Content is content that has access to and can affect all or parts of the Document Object Model (DOM) of an HTTPS page. This type of mixed content can alter the behavior of an HTTPS page and potentially steal sensitive data from the user. Hence, in addition to the risks for Mixed Passive Content, Mixed Active Content is also exposed to a number of additional attack vectors.\u003cbr\u003e\nA MITM attacker can intercept requests for HTTP active content. The attacker can then re-write the response to include malicious JavaScript /fonts code. Malicious script can steal the user’s credentials, acquire sensitive data about the user, or attempt to install malware on the user’s system (by leveraging vulnerable plugins the user has installed, for example).\u003c/p\u003e\n\n\u003cp\u003eCriticality level: Medium\u003c/p\u003e\n\n\u003cp\u003eCriticality level justification:\u003cbr\u003e\nData which is transmitted in this link could be read by An attacker who is in Same network in some cases this could help to steal information.\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003cbr\u003e\n1) Visit link \u003ca title=\"https://stats.owncloud.org\" href=\"/redirect?url=https%3A%2F%2Fstats.owncloud.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stats.owncloud.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) Press F12 to open Developers tool in Google Chrome OR IE OR in Firefox browser and observe console. You will come across security error - \u0026quot;A Secure Hypertext Transfer Protocol (HTTPS) page has content from a non-secure source.\u003c/p\u003e\n\n\u003cp\u003eMixed content security error messages: : Firefox= \u0026#39;Loading mixed (insecure) display content \u0026quot;\u003ca title=\"http://stats.owncloud.org/misc/user/logo.png\" href=\"/redirect?url=http%3A%2F%2Fstats.owncloud.org%2Fmisc%2Fuser%2Flogo.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://stats.owncloud.org/misc/user/logo.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026#39;\u003cbr\u003e\n. This content should also be served over HTTPS.\u003c/p\u003e\n\n\u003cp\u003eScenario:\u003cbr\u003e\nThere are 3 easy steps to attack the user through a mixed content vulnerability…\u003cbr\u003e\n1) Set-up a Man-in-the-Middle attack. These are most easily done on public networks such as those in coffee shops or airports.\u003cbr\u003e\n2) Use a mixed content vulnerability to inject a malicious javascript file. Malicious code will run in an HTTPS website that the user browsers to. The key point is that the HTTPS site has a mixed content vulnerability on it, which means that it executes content downloaded over HTTP. This is where the Man-in-the-Middle attack and Mixed Content vulnerability combine into a dangerous scenario.\u003cbr\u003e\n“If some attacker is able to either tamper with Javascript or stylesheet files he can effectively also tamper with the other content on your page (e.g. by modifying the DOM ). So it’s either all or nothing. Either all of your elements are served using SSL, then you are secure. Or you load some Javascript or stylesheet files from a plain HTTP connection, then you aren’t secure anymore.”\u003cbr\u003e\n3) Steal the user’s identity (or do other bad things).\u003c/p\u003e\n\n\u003cp\u003eSolution ::\u003cbr\u003e\nMake sure all content in the page including images, js, fonts are from HTTPS sources.\u003c/p\u003e\n\n\u003cp\u003eReference : \u003ca title=\"http://msdn.microsoft.com/en-us/library/ie/dn423949(v=vs.85).aspx\" href=\"/redirect?url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fie%2Fdn423949%28v%3Dvs.85%29.aspx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://msdn.microsoft.com/en-us/library/ie/dn423949(v=vs.85).aspx\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVideo :: \u003ca title=\"http://www.youtube.com/watch?v=zEV3HOuM_Vw\" href=\"/redirect?url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DzEV3HOuM_Vw\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.youtube.com/watch?v=zEV3HOuM_Vw\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":68059,"file_name":"Screenshot_4.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/068/059/0f5dbfde29e389fd03cec2b176f9d2500231296f/Screenshot_4.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_4.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_4.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041519Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=e7cb1c5b32a6cbcc68a8053a0542631e2c38ac01e74a1ea1f96546372df2f43d","file_size":50921,"type":"image/png"}],"allow_singular_disclosure_at":"2016-02-06T16:11:21.887Z","allow_singular_disclosure_after":-154440237.8690282,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":743702,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-01-06T05:31:33.913Z","updated_at":"2016-01-06T05:31:33.913Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":744054,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. I'll triage this to the system owner.","markdown_message":"\u003cp\u003eThanks a lot for your report. I\u0026#39;ll triage this to the system owner.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T10:53:21.926Z","updated_at":"2016-01-06T10:53:21.926Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":746226,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report. This has meanwhile been fixed.","markdown_message":"\u003cp\u003eThanks a lot for your report. This has meanwhile been fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-07T16:11:11.044Z","updated_at":"2016-01-07T16:11:11.044Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ishahriyar","url":"/ishahriyar"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":746227,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-07T16:11:17.385Z","updated_at":"2016-01-07T16:11:17.385Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":746228,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-07T16:11:21.822Z","updated_at":"2016-01-07T16:11:21.822Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":787601,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-06T16:11:39.796Z","updated_at":"2016-02-06T16:11:39.796Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}