{"id":139099,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkwOTk=","url":"https://hackerone.com/reports/139099","title":"Lack of account link warning enables dropbox hijacking","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-16T11:30:42.184Z","submitted_at":"2016-05-16T11:30:42.184Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-27T12:21:56.002Z","bug_reporter_agreed_on_going_public_at":"2016-05-28T12:21:52.431Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When I install dropbox on linux via the CLI, I get given a URL containing a token:\nhttps://www.dropbox.com/cli_link_nonce?nonce=blah\n\nI can give this token to another user and pretend it's a link to a dropbox file. If they aren't logged in when they click it, they will land on the login page. If they log in, my server will instantly be linked to their dropbox account, giving me read/write access all their files. This attack involves a little user interaction but I think faced with a login page on the real dropbox.com, most users will log in. Please review the attached screenshot to see what I mean.\n\nThe account linking page that is displayed to users who are already logged in also fails to give an adequate warning, but I think less people would fall for this.","vulnerability_information_html":"\u003cp\u003eWhen I install dropbox on linux via the CLI, I get given a URL containing a token:\u003cbr\u003e\n\u003ca title=\"https://www.dropbox.com/cli_link_nonce?nonce=blah\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fcli_link_nonce%3Fnonce%3Dblah\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/cli_link_nonce?nonce=blah\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI can give this token to another user and pretend it\u0026#39;s a link to a dropbox file. If they aren\u0026#39;t logged in when they click it, they will land on the login page. If they log in, my server will instantly be linked to their dropbox account, giving me read/write access all their files. This attack involves a little user interaction but I think faced with a login page on the real dropbox.com, most users will log in. Please review the attached screenshot to see what I mean.\u003c/p\u003e\n\n\u003cp\u003eThe account linking page that is displayed to users who are already logged in also fails to give an adequate warning, but I think less people would fall for this.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94074,"file_name":"Screen_Shot_2016-05-16_at_12.15.50.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/074/0078a52604d131e334ef8b4f0b2d3ecf75b3c490/Screen_Shot_2016-05-16_at_12.15.50.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-16_at_12.15.50.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-16_at_12.15.50.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042733Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=40160288a74886322bf293e121a1508e8f013a5808244db556fedbd78b56203d","file_size":133912,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-27T12:21:52.540Z","allow_singular_disclosure_after":-142185941.26993978,"singular_disclosure_allowed":true,"vote_count":8,"voters":["albinowax","dejavuln","paresh_parmar","spetr0x","akash_9021","clarckowen_","dyabla","pei"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":958977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To effectively target users who are currently logged in, I can first sign them out via CSRF: https://www.dropbox.com/logout","markdown_message":"\u003cp\u003eTo effectively target users who are currently logged in, I can first sign them out via CSRF: \u003ca title=\"https://www.dropbox.com/logout\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Flogout\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/logout\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T12:27:04.907Z","updated_at":"2016-05-16T12:27:04.907Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":959540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks! what sort of warning do you think we should provide that will be clearer?","markdown_message":"\u003cp\u003ethanks! what sort of warning do you think we should provide that will be clearer?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T17:22:43.195Z","updated_at":"2016-05-16T17:22:43.195Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":959624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think for many people logging in is a reflexive action, so changing the text on the login page itself wouldn't achieve very much. If a user is unauthenticated, after getting them to log in you could redirect them to the \"Would you like to connect\"...[confirm/cancel] account linking page. \n\nThe wording on the account linking page could be changed to something like \"Are you trying to connect your DropBox account to a new computer? If you didn't request this, please click cancel.\" \n\nA more extreme version would be \"Please re-enter your password to confirm you wish to connect your DropBox account to a new computer\"","markdown_message":"\u003cp\u003eI think for many people logging in is a reflexive action, so changing the text on the login page itself wouldn\u0026#39;t achieve very much. If a user is unauthenticated, after getting them to log in you could redirect them to the \u0026quot;Would you like to connect\u0026quot;...[confirm/cancel] account linking page. \u003c/p\u003e\n\n\u003cp\u003eThe wording on the account linking page could be changed to something like \u0026quot;Are you trying to connect your DropBox account to a new computer? If you didn\u0026#39;t request this, please click cancel.\u0026quot; \u003c/p\u003e\n\n\u003cp\u003eA more extreme version would be \u0026quot;Please re-enter your password to confirm you wish to connect your DropBox account to a new computer\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T18:12:58.804Z","updated_at":"2016-05-16T18:12:58.804Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":960637,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"still triaging.","markdown_message":"\u003cp\u003estill triaging.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T06:22:12.298Z","updated_at":"2016-05-17T06:22:12.298Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":967876,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have updated the warning text. thanks!","markdown_message":"\u003cp\u003eWe have updated the warning text. thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-21T19:00:58.591Z","updated_at":"2016-05-21T19:00:58.591Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":967877,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-21T19:01:06.534Z","updated_at":"2016-05-21T19:01:06.534Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":988970,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-28T12:21:52.480Z","updated_at":"2016-05-28T12:21:52.480Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could we publicly disclose this?","markdown_message":"\u003cp\u003eCould we publicly disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-14T13:28:17.394Z","updated_at":"2016-06-14T13:28:17.394Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you don't mind, we prefer you don't since it is a lot more work and interruption for us.","markdown_message":"\u003cp\u003eIf you don\u0026#39;t mind, we prefer you don\u0026#39;t since it is a lot more work and interruption for us.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T15:46:07.739Z","updated_at":"2016-06-15T15:46:07.739Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ping @albinowax if you really want disclosure, let me know.","markdown_message":"\u003cp\u003eping \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e if you really want disclosure, let me know.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:10:39.959Z","updated_at":"2016-06-20T15:10:39.959Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The context is that I'm writing a blog post reviewing all the bug bounty programs I've used, and I think it would be helpful for readers if they could view the full details of this report. It isn't critical to the overall post though.","markdown_message":"\u003cp\u003eThe context is that I\u0026#39;m writing a blog post reviewing all the bug bounty programs I\u0026#39;ve used, and I think it would be helpful for readers if they could view the full details of this report. It isn\u0026#39;t critical to the overall post though.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:32:40.321Z","updated_at":"2016-06-20T15:32:40.321Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024735,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To be honest, I think we will likely want to summarize the post and not disclosure the full post. I am sorry and it is really unfortunate; but previous experience tells us that honest interactions between researchers and teams are misconstrued by the wrong people :(","markdown_message":"\u003cp\u003eTo be honest, I think we will likely want to summarize the post and not disclosure the full post. I am sorry and it is really unfortunate; but previous experience tells us that honest interactions between researchers and teams are misconstrued by the wrong people :(\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:46:35.993Z","updated_at":"2016-06-20T15:46:35.993Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"also, I would love to read the post once its out: please do share it :)","markdown_message":"\u003cp\u003ealso, I would love to read the post once its out: please do share it :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:46:57.889Z","updated_at":"2016-06-20T15:46:57.889Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1040564,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T12:21:56.056Z","updated_at":"2016-06-27T12:21:56.056Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}