{"id":166849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY4NDk=","url":"https://hackerone.com/reports/166849","title":"IDOR(indirect object references) on add friend,complement and send message ","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-09-08T14:14:07.347Z","submitted_at":"2016-09-08T14:14:07.347Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"w3b7ricks73r","url":"/w3b7ricks73r","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":545,"url":"https://hackerone.com/yelp","handle":"yelp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Yelp","twitter_handle":"","website":"https://www.yelp.com","about":"Connecting people to great local businesses in communities around the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-09T20:15:26.577Z","bug_reporter_agreed_on_going_public_at":"2016-09-09T18:41:50.836Z","team_member_agreed_on_going_public_at":"2017-11-09T20:15:26.400Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi security ,\n\nDescription:\nI found user id in encrypted form from there profile url \nhttps://www.yelp.com/user_details?userid=\u003cuser id's\u003e\n\non intercepting request of add friend, complement and send message i can identify user id ..\nwhen i change identified user ID to other user's ID then request of add friend is send to other user without any token and secession validation .. scenario for the complement and send message is same.\n\nImpact:\n-\u003ean attacker can add the authenticated user to his account or any others accounts ..\n-\u003ecan send message to any one by user's account \n-\u003ecan complement on other users by victim user \n\nMore information about this issue is available here:\n\nhttps://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References\nhttps://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_(OTG-AUTHZ-004)\n\nReproduction Steps:- for add friend \n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on add friend on user one \n4.\u003eintercepting request \n5.\u003eidentify user id and change it to second user's id on each request \n6.\u003eclick on send\n7.\u003eintercept request and change user id \n8.\u003echeck the screen with the message od request is send to second user \n(request is send to another user)\n\nReproduction Steps:- for complement\n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on complement of user one\n4.\u003eintercepting request \n5.\u003eidentify user id and change it to other user's id on each request \n6.\u003etype the complement\n7.\u003eintercept request and change user id \n8.\u003echeck the screen with message that complement is send to second user\n(complement is send to second user)\n\nReproduction Steps:- for send message \n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on send message of user one \n4.\u003eintercepting request \n5.\u003eidentify user id and change it to other user's id on each request \n6.\u003etype the message \n7.\u003eintercept request and change user id \n8.\u003echeck the screen with message that complement is send to second user\n(message is send to second user)\n\nPlease Find the video POC from the links\n\nhttps://mega.nz/#!FR5CxSrD!wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\n\nhttps://mega.nz/#!UQBBWY7C!85q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\n\n\nRegards \nAaysha Khilji\n\n\n\n\n    ","vulnerability_information_html":"\u003cp\u003eHi security ,\u003c/p\u003e\n\n\u003cp\u003eDescription:\u003cbr\u003e\nI found user id in encrypted form from there profile url \u003cbr\u003e\n\u003ca title=\"https://www.yelp.com/user_details?userid=\" href=\"/redirect?url=https%3A%2F%2Fwww.yelp.com%2Fuser_details%3Fuserid%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.yelp.com/user_details?userid=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;user id\u0026#39;s\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eon intercepting request of add friend, complement and send message i can identify user id ..\u003cbr\u003e\nwhen i change identified user ID to other user\u0026#39;s ID then request of add friend is send to other user without any token and secession validation .. scenario for the complement and send message is same.\u003c/p\u003e\n\n\u003cp\u003eImpact:\u003cbr\u003e\n-\u0026gt;an attacker can add the authenticated user to his account or any others accounts ..\u003cbr\u003e\n-\u0026gt;can send message to any one by user\u0026#39;s account \u003cbr\u003e\n-\u0026gt;can complement on other users by victim user \u003c/p\u003e\n\n\u003cp\u003eMore information about this issue is available here:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTop_10_2013-A4-Insecure_Direct_Object_References\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_(OTG-AUTHZ-004)\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTesting_for_Insecure_Direct_Object_References_%28OTG-AUTHZ-004%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_(OTG-AUTHZ-004)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eReproduction Steps:- for add friend \u003cbr\u003e\n1.\u0026gt;login to your test account \u003cbr\u003e\n2.\u0026gt;visit any two user\u0026#39;s profile \u003cbr\u003e\n3.\u0026gt;click on add friend on user one \u003cbr\u003e\n4.\u0026gt;intercepting request \u003cbr\u003e\n5.\u0026gt;identify user id and change it to second user\u0026#39;s id on each request \u003cbr\u003e\n6.\u0026gt;click on send\u003cbr\u003e\n7.\u0026gt;intercept request and change user id \u003cbr\u003e\n8.\u0026gt;check the screen with the message od request is send to second user \u003cbr\u003e\n(request is send to another user)\u003c/p\u003e\n\n\u003cp\u003eReproduction Steps:- for complement\u003cbr\u003e\n1.\u0026gt;login to your test account \u003cbr\u003e\n2.\u0026gt;visit any two user\u0026#39;s profile \u003cbr\u003e\n3.\u0026gt;click on complement of user one\u003cbr\u003e\n4.\u0026gt;intercepting request \u003cbr\u003e\n5.\u0026gt;identify user id and change it to other user\u0026#39;s id on each request \u003cbr\u003e\n6.\u0026gt;type the complement\u003cbr\u003e\n7.\u0026gt;intercept request and change user id \u003cbr\u003e\n8.\u0026gt;check the screen with message that complement is send to second user\u003cbr\u003e\n(complement is send to second user)\u003c/p\u003e\n\n\u003cp\u003eReproduction Steps:- for send message \u003cbr\u003e\n1.\u0026gt;login to your test account \u003cbr\u003e\n2.\u0026gt;visit any two user\u0026#39;s profile \u003cbr\u003e\n3.\u0026gt;click on send message of user one \u003cbr\u003e\n4.\u0026gt;intercepting request \u003cbr\u003e\n5.\u0026gt;identify user id and change it to other user\u0026#39;s id on each request \u003cbr\u003e\n6.\u0026gt;type the message \u003cbr\u003e\n7.\u0026gt;intercept request and change user id \u003cbr\u003e\n8.\u0026gt;check the screen with message that complement is send to second user\u003cbr\u003e\n(message is send to second user)\u003c/p\u003e\n\n\u003cp\u003ePlease Find the video POC from the links\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://mega.nz/#!FR5CxSrD!wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\" href=\"/redirect?url=https%3A%2F%2Fmega.nz%2F%23%21FR5CxSrD%21wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mega.nz/#!FR5CxSrD!wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://mega.nz/#!UQBBWY7C!85q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\" href=\"/redirect?url=https%3A%2F%2Fmega.nz%2F%23%21UQBBWY7C%2185q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mega.nz/#!UQBBWY7C!85q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards \u003cbr\u003e\nAaysha Khilji\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["khokho1986","b4155f7c29acd42c27d007a"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1182330,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting your report to us! We just launched our public bug-bounty program on HackerOne. Please expect a response within a week.\n\n- The Yelp Security Team\n","markdown_message":"\u003cp\u003eThanks for submitting your report to us! We just launched our public bug-bounty program on HackerOne. Please expect a response within a week.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe Yelp Security Team\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":true,"created_at":"2016-09-08T14:14:07.575Z","updated_at":"2016-09-08T14:14:07.575Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1183533,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @w3b7ricks73r,\n\nTo add another friend on Yelp, instead of intercepting the request and change the user_id in the request, there's a better way to do that- you could just go to the second user's profile page and click \"Add friend\". Same applies to compliment and messaging.\n\nThis is working as intended and there are no security implications.\n\nBest, \nThe Yelp Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/w3b7ricks73r\"\u003e@w3b7ricks73r\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eTo add another friend on Yelp, instead of intercepting the request and change the user_id in the request, there\u0026#39;s a better way to do that- you could just go to the second user\u0026#39;s profile page and click \u0026quot;Add friend\u0026quot;. Same applies to compliment and messaging.\u003c/p\u003e\n\n\u003cp\u003eThis is working as intended and there are no security implications.\u003c/p\u003e\n\n\u003cp\u003eBest, \u003cbr\u003e\nThe Yelp Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T00:44:24.356Z","updated_at":"2016-09-09T00:44:24.356Z","actor":{"username":"luqipan","cleared":false,"url":"/luqipan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1185211,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @luqipan.\nyes! user can do that directly....\n    but what if an attacker wants to add (receive message or complement ) user to his account then he can do this very easily by changing the user id into the request  ..\nThanks \nAaysha Khilji","markdown_message":"\u003cp\u003eHi \u003ca href=\"/luqipan\"\u003e@luqipan\u003c/a\u003e.\u003cbr\u003e\nyes! user can do that directly....\u003cbr\u003e\n    but what if an attacker wants to add (receive message or complement ) user to his account then he can do this very easily by changing the user id into the request  ..\u003cbr\u003e\nThanks \u003cbr\u003e\nAaysha Khilji\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T18:41:50.862Z","updated_at":"2016-09-09T18:41:50.862Z","first_to_agree":true,"actor":{"username":"w3b7ricks73r","cleared":false,"url":"/w3b7ricks73r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147278,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-09T20:15:26.462Z","updated_at":"2017-11-09T20:15:26.462Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147279,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-09T20:15:26.620Z","updated_at":"2017-11-09T20:15:26.620Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}