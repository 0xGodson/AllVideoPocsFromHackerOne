{"id":163067,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjMwNjc=","url":"https://hackerone.com/reports/163067","title":"Stealing users password (Limited Scenario)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-24T13:53:40.337Z","submitted_at":"2016-08-24T13:53:40.337Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-29T20:13:31.430Z","bug_reporter_agreed_on_going_public_at":"2016-09-22T20:27:16.903Z","team_member_agreed_on_going_public_at":"2016-09-29T20:13:31.301Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Hello Team,__\n\n####Description :\n\u003e This is report is about an interesting scenario where an user's password can be steal while password reset process due to wired user controlled redirection take place after password reset process.\n\nBy accepting the fact that URL redirect is not in scope for uber but this one is interesting on reset page that something need to look.\n\n\n####Step To Reproduce : \n+ Go [Here](https://login.uber.com/forgot-password?source=auth\u0026next_url=data:text/html;base64,PGlmcmFtZSBzcmM9aHR0cDovL2dvby5nbC92TkE3RHYgaGVpZ2h0PTEwMCUgd2lkdGg9MTAwJSBmcmFtZWJvcmRlcj0wPjwvaWZyYW1lPg==)\n+ Where __`next_url`__ is user controlled on password reset page __`https://login.uber.com/forgot-password?source=auth\u0026next_url=user_controlled_url`__ . \n+ Request password reset token for your account !\n+ Get the reset link and change the password and will be redirected to supplied `next_url` url.\n+ Where an well crafted form will ask to confirm your password !\n+ And this is how someone can steal the password of someone !\n\n####Impact :\n\u003ethough impact is not very direct here , but still critical enough if any attacker succeeded to exploit this \u0026 that will allow him to access victim account , so this should be fixed !  \n\n####Video POC (Tested in Mozilla) : https://dl.dropboxusercontent.com/u/62765113/ShareX/16/2016-08-24_19-18-20.mp4\n\n####Possible Fix :\n+ `next_url` should not be reflect after password reset also should not be user controlled .\n\nPlease let me know if any more info needed !\n\n-------------\n**Regards**\n*Geekboy !*","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eHello Team,\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch4 id=\"description\"\u003eDescription :\u003c/h4\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis is report is about an interesting scenario where an user\u0026#39;s password can be steal while password reset process due to wired user controlled redirection take place after password reset process.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eBy accepting the fact that URL redirect is not in scope for uber but this one is interesting on reset page that something need to look.\u003c/p\u003e\n\n\u003ch4 id=\"step-to-reproduce\"\u003eStep To Reproduce :\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eGo \u003ca href=\"/redirect?url=https%3A%2F%2Flogin.uber.com%2Fforgot-password%3Fsource%3Dauth%26next_url%3Ddata%3Atext%2Fhtml%253Bbase64%2CPGlmcmFtZSBzcmM9aHR0cDovL2dvby5nbC92TkE3RHYgaGVpZ2h0PTEwMCUgd2lkdGg9MTAwJSBmcmFtZWJvcmRlcj0wPjwvaWZyYW1lPg%3D%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eWhere \u003cstrong\u003e\u003ccode\u003enext_url\u003c/code\u003e\u003c/strong\u003e is user controlled on password reset page \u003cstrong\u003e\u003ccode\u003ehttps://login.uber.com/forgot-password?source=auth\u0026amp;next_url=user_controlled_url\u003c/code\u003e\u003c/strong\u003e . \u003c/li\u003e\n\u003cli\u003eRequest password reset token for your account !\u003c/li\u003e\n\u003cli\u003eGet the reset link and change the password and will be redirected to supplied \u003ccode\u003enext_url\u003c/code\u003e url.\u003c/li\u003e\n\u003cli\u003eWhere an well crafted form will ask to confirm your password !\u003c/li\u003e\n\u003cli\u003eAnd this is how someone can steal the password of someone !\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"impact\"\u003eImpact :\u003c/h4\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ethough impact is not very direct here , but still critical enough if any attacker succeeded to exploit this \u0026amp; that will allow him to access victim account , so this should be fixed !  \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4 id=\"video-poc-tested-in-mozilla-https-dl-dropboxusercontent-com-u-62765113-sharex-16-2016-08-24_19-18-20-mp4\"\u003eVideo POC (Tested in Mozilla) : \u003ca title=\"https://dl.dropboxusercontent.com/u/62765113/ShareX/16/2016-08-24_19-18-20.mp4\" href=\"/redirect?url=https%3A%2F%2Fdl.dropboxusercontent.com%2Fu%2F62765113%2FShareX%2F16%2F2016-08-24_19-18-20.mp4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dl.dropboxusercontent.com/u/62765113/ShareX/16/2016-08-24_19-18-20.mp4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/h4\u003e\n\n\u003ch4 id=\"possible-fix\"\u003ePossible Fix :\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003enext_url\u003c/code\u003e should not be reflect after password reset also should not be user controlled .\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlease let me know if any more info needed !\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cstrong\u003eRegards\u003c/strong\u003e\u003cbr\u003e\n\u003cem\u003eGeekboy !\u003c/em\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":33,"voters":["bogdantcaciuc","spam404","sameerphad72","parth","geekboy","mdv","0xdeadpool","bugdiscloseguys","dreadpiraterobertt","gamliel","and 23 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1152162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy,\n\nThanks so much for the report and participation in our bug bounty program! We're looking into this now and will update ASAP as we have more details.\n\nThanks,\nRob","markdown_message":"\u003cp\u003e\u003ca href=\"/geekboy\"\u003e@geekboy\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks so much for the report and participation in our bug bounty program! We\u0026#39;re looking into this now and will update ASAP as we have more details.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nRob\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-24T17:43:49.542Z","updated_at":"2016-08-24T17:43:49.542Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152934,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T23:38:36.772Z","updated_at":"2016-08-24T23:38:36.772Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1187866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"do we have any update for this ?","markdown_message":"\u003cp\u003edo we have any update for this ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T04:51:58.205Z","updated_at":"2016-09-12T04:51:58.205Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189072,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @geekboy, thanks for checking in, we're currently working on this internally and will update you as soon as it gets fixed.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/geekboy\"\u003e@geekboy\u003c/a\u003e, thanks for checking in, we\u0026#39;re currently working on this internally and will update you as soon as it gets fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T17:15:27.516Z","updated_at":"2016-09-12T17:15:27.516Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1210123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Team, \n\ni can see some fix is implemented here, now that URL giving following error : \n\n`````\n{\"error\":\"Invalid next_url\"}\n`````","markdown_message":"\u003cp\u003eHello Team, \u003c/p\u003e\n\n\u003cp\u003ei can see some fix is implemented here, now that URL giving following error : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;error\u0026quot;:\u0026quot;Invalid next_url\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-09-22T03:08:44.891Z","updated_at":"2016-09-22T03:09:26.351Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210929,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @geekboy, I believe this issue has been fixed so I am closing this report as `Resolved`. Please take a moment to confirm and let us know if you do not agree. We have meetings every few weeks to discuss `Resolved` reports and we will follow up after the next one to determine if this submission was eligible under our bug bounty program. Thank you!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/geekboy\"\u003e@geekboy\u003c/a\u003e, I believe this issue has been fixed so I am closing this report as \u003ccode\u003eResolved\u003c/code\u003e. Please take a moment to confirm and let us know if you do not agree. We have meetings every few weeks to discuss \u003ccode\u003eResolved\u003c/code\u003e reports and we will follow up after the next one to determine if this submission was eligible under our bug bounty program. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-22T15:32:08.062Z","updated_at":"2016-09-22T15:32:08.062Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1211587,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure np in that, can we do now ? ","markdown_message":"\u003cp\u003eSure np in that, can we do now ? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-22T20:27:16.945Z","updated_at":"2016-09-22T20:27:16.945Z","first_to_agree":true,"actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1216965,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy the team will discuss this in next bounty payout meeting and get back to you.","markdown_message":"\u003cp\u003e\u003ca href=\"/geekboy\"\u003e@geekboy\u003c/a\u003e the team will discuss this in next bounty payout meeting and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-26T19:25:07.516Z","updated_at":"2016-09-26T19:25:07.516Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1220020,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report, @geekboy! We appreciate the submission, and wish you the best of luck in your future bug hunting. ","markdown_message":"\u003cp\u003eThanks for the report, \u003ca href=\"/geekboy\"\u003e@geekboy\u003c/a\u003e! We appreciate the submission, and wish you the best of luck in your future bug hunting. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-27T20:15:52.736Z","updated_at":"2016-09-27T20:15:52.736Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"geekboy","url":"/geekboy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1220052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thing, Thank u for the surprised bounty though :)","markdown_message":"\u003cp\u003eSure thing, Thank u for the surprised bounty though :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-27T20:32:54.421Z","updated_at":"2016-09-27T20:33:07.571Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1220844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can we go public now if okay ? and will request for full disclosure if we doing as m going to blog about this interesting n rare issue :) \n\nThanks !","markdown_message":"\u003cp\u003ecan we go public now if okay ? and will request for full disclosure if we doing as m going to blog about this interesting n rare issue :) \u003c/p\u003e\n\n\u003cp\u003eThanks !\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-28T10:22:33.553Z","updated_at":"2016-09-28T10:24:19.298Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224437,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T20:13:31.361Z","updated_at":"2016-09-29T20:13:31.361Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224438,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T20:13:31.465Z","updated_at":"2016-09-29T20:13:31.465Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2703,"category":"team","content":"The Forgot Password page accepts a next_url URL parameter when it's loaded.  Due to the fact that this is user-controllable and permits any url, it is possible for an attacker to perform a convincing phishing attack, designed to steal an Uber user's credentials, by getting a victim to reset their password via a custom Forgot Password link.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe Forgot Password page accepts a next_url URL parameter when it\u0026#39;s loaded.  Due to the fact that this is user-controllable and permits any url, it is possible for an attacker to perform a convincing phishing attack, designed to steal an Uber user\u0026#39;s credentials, by getting a victim to reset their password via a custom Forgot Password link.\u003c/p\u003e\n"},{"id":2726,"category":"researcher","content":"Hey all :)\n\nhere is blog for the same : http://www.geekboy.ninja/blog/uber-exploiting-stored-url-redirect-in-password-reset-token","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eHey all :)\u003c/p\u003e\n\n\u003cp\u003ehere is blog for the same : \u003ca title=\"http://www.geekboy.ninja/blog/uber-exploiting-stored-url-redirect-in-password-reset-token\" href=\"/redirect?url=http%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fuber-exploiting-stored-url-redirect-in-password-reset-token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.geekboy.ninja/blog/uber-exploiting-stored-url-redirect-in-password-reset-token\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}