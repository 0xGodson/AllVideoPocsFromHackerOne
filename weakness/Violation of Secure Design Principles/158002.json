{"id":158002,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTgwMDI=","url":"https://hackerone.com/reports/158002","title":"Missing rel=noreferrer tag allows link in list to change url of currently open tab","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-09T22:40:36.532Z","submitted_at":"2016-08-09T22:40:36.532Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-12T19:59:15.545Z","bug_reporter_agreed_on_going_public_at":"2016-08-15T23:26:35.782Z","team_member_agreed_on_going_public_at":"2016-09-12T19:59:15.469Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nWhen adding links to lists, there is no rel=noreferrer tag present, allowing a linked page to change the url of the currently open tab. This can open the doors for phishing attacks, as users trust the tab that contained instacart.\n\nAs an example, see my list at https://inst.cr/t/1QmLPG. Clicking the link, which opens in a new tab, will change the url of the currently open tab to http://example.com.\n\nThank you for your time, and please let me know if you have any questions.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eWhen adding links to lists, there is no rel=noreferrer tag present, allowing a linked page to change the url of the currently open tab. This can open the doors for phishing attacks, as users trust the tab that contained instacart.\u003c/p\u003e\n\n\u003cp\u003eAs an example, see my list at \u003ca title=\"https://inst.cr/t/1QmLPG\" href=\"/redirect?url=https%3A%2F%2Finst.cr%2Ft%2F1QmLPG\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://inst.cr/t/1QmLPG\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Clicking the link, which opens in a new tab, will change the url of the currently open tab to \u003ca title=\"http://example.com\" href=\"/redirect?url=http%3A%2F%2Fexample.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time, and please let me know if you have any questions.\u003c/p\u003e\n","bounty_amount":"75.0","formatted_bounty":"$75","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-14T23:26:35.873Z","allow_singular_disclosure_after":-135320952.40636718,"singular_disclosure_allowed":true,"vote_count":4,"voters":["cablej","eveeez","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1119791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cablej, thanks for your report. I am unable to reproduce as you describe. We already add rel=\"nofollow noopener\" which protects against this vulnerability. Please provide any additional details otherwise I can close this report.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e, thanks for your report. I am unable to reproduce as you describe. We already add rel=\u0026quot;nofollow noopener\u0026quot; which protects against this vulnerability. Please provide any additional details otherwise I can close this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T17:10:02.082Z","updated_at":"2016-08-11T17:10:02.082Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please see the (unlisted) video POC here: https://youtu.be/wc0FQQ8OFy8. This vulnerability is not reproducible in Chrome, which may be why you are unable to reproduce, but does work in Firefox and Safari. In the video, you can see that adding 'noreferrer' prevents the page from being changed.\n\nMy bad for not specifying the browsers.","markdown_message":"\u003cp\u003ePlease see the (unlisted) video POC here: \u003ca title=\"https://youtu.be/wc0FQQ8OFy8\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2Fwc0FQQ8OFy8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/wc0FQQ8OFy8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This vulnerability is not reproducible in Chrome, which may be why you are unable to reproduce, but does work in Firefox and Safari. In the video, you can see that adding \u0026#39;noreferrer\u0026#39; prevents the page from being changed.\u003c/p\u003e\n\n\u003cp\u003eMy bad for not specifying the browsers.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T20:43:49.581Z","updated_at":"2016-08-11T20:43:49.581Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128077,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-15T21:29:59.411Z","updated_at":"2016-08-15T21:29:59.411Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128269,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @cablej. This should be resolved now, thanks for the report!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e. This should be resolved now, thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-15T23:06:11.862Z","updated_at":"2016-08-15T23:06:11.862Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128270,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-15T23:06:26.385Z","updated_at":"2016-08-15T23:06:26.385Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"75.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"cablej","url":"/cablej"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, I can verify that this has been fixed. Thanks for the reward!","markdown_message":"\u003cp\u003eGreat, I can verify that this has been fixed. Thanks for the reward!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-15T23:26:20.461Z","updated_at":"2016-08-15T23:26:20.461Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128285,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-15T23:26:35.807Z","updated_at":"2016-08-15T23:26:35.807Z","first_to_agree":true,"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189467,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T19:59:15.503Z","updated_at":"2016-09-12T19:59:15.503Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1189468,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T19:59:15.579Z","updated_at":"2016-09-12T19:59:15.579Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}