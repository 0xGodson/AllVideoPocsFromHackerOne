{"id":140377,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDAzNzc=","url":"https://hackerone.com/reports/140377","title":"don't store CSRF tokens in cookies","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2016-05-22T21:17:47.463Z","submitted_at":"2016-05-22T21:17:47.463Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0x0ameer","url":"/0x0ameer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/821/9eaa6f40fc91ab202b19ea5cb064b0807786e24c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-16T15:25:14.224Z","bug_reporter_agreed_on_going_public_at":"2016-06-16T15:25:14.068Z","team_member_agreed_on_going_public_at":"2016-06-15T16:48:53.110Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Your web application generates CSRF token values inside cookies\nwhich is not a best practice for web applications as revelation of cookies can reveal CSRF Tokens as well.\nAuthenticity tokens should be kept separate from cookies and should be isolated to change operations in the account only.\n\nMore description:\nThis report tells that the CSRF tokens are present inside of the cookies value which is not a best practice and if the cookie is intercepted and compromised than the CSRF token will also be vulnerable.\n\nThis is the Captured request of edit Statement HTTP ,In this request you can see CSRF token is generating in cookies named as csrf_token\n\nPOST /~[MY USER ID]/statement.json HTTP/1.1\nHost: gratipay.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:46.0) Gecko/20100101 Firefox/46.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-CSRF-Token: y44PyqG67bRQljEA5mLK1bez4hgZ8XSD\nX-Requested-With: XMLHttpRequest\nReferer: https://gratipay.com/~ameerassadi4/\nContent-Length: 24\nCookie: csrf_token=y44PyqG67bRQljEA5mLK1bez4hgZ8XSD; suppress-welcome=; session=aa5c93be733b4aae8370af6a3fae2be3\nConnection: close\n\nlang=en\u0026content=sssssssd\n\ni have also added a PoC picture in attachments,\n\nCheers,\nAmeer Assadi\nwww.Ameeras.me / www.Geekurity.com","vulnerability_information_html":"\u003cp\u003eYour web application generates CSRF token values inside cookies\u003cbr\u003e\nwhich is not a best practice for web applications as revelation of cookies can reveal CSRF Tokens as well.\u003cbr\u003e\nAuthenticity tokens should be kept separate from cookies and should be isolated to change operations in the account only.\u003c/p\u003e\n\n\u003cp\u003eMore description:\u003cbr\u003e\nThis report tells that the CSRF tokens are present inside of the cookies value which is not a best practice and if the cookie is intercepted and compromised than the CSRF token will also be vulnerable.\u003c/p\u003e\n\n\u003cp\u003eThis is the Captured request of edit Statement HTTP ,In this request you can see CSRF token is generating in cookies named as csrf_token\u003c/p\u003e\n\n\u003cp\u003ePOST /~[MY USER ID]/statement.json HTTP/1.1\u003cbr\u003e\nHost: gratipay.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:46.0) Gecko/20100101 Firefox/46.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nX-CSRF-Token: y44PyqG67bRQljEA5mLK1bez4hgZ8XSD\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://gratipay.com/~ameerassadi4/\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2F~ameerassadi4%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/~ameerassadi4/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 24\u003cbr\u003e\nCookie: csrf_token=y44PyqG67bRQljEA5mLK1bez4hgZ8XSD; suppress-welcome=; session=aa5c93be733b4aae8370af6a3fae2be3\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003elang=en\u0026amp;content=sssssssd\u003c/p\u003e\n\n\u003cp\u003ei have also added a PoC picture in attachments,\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nAmeer Assadi\u003cbr\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.ameeras.me\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.Ameeras.me\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e / \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.geekurity.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.Geekurity.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":95222,"file_name":"notsafe.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/095/222/8c8c8deaba0d130a8e145cb226af9697be4610af/notsafe.png?response-content-disposition=attachment%3B%20filename%3D%22notsafe.png%22%3B%20filename%2A%3DUTF-8%27%27notsafe.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZT5T356C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBcsqzm4YMyykC8pKAfuq22D6bSOUdyHaa8fIa4mUQhAAiEAiwPORMjouAw3a3uzUTZC%2BINQcpZp97MOQsVELFW4zLYqtAMIUBABGgwwMTM2MTkyNzQ4NDkiDKDiVMmiMU9V%2FMrmWyqRA4sIGIrOpHyvVZfmW2jMtAM8T%2B3ge7R5BW4DZ%2F780qW3KhtUb%2BlN4eJRg5WRaAT1yVb84a%2FkYNxsJD%2FuSvAe1wqOnVhU6s2QkIgwao%2BmXWZI5Gv75IeDf5AKwwqIEXhO%2BTfJ7qch1s5pk6yRn5dlzyaRdvpwfit2B%2BnXtVL4Ks0Z%2BsF2L1Sb9lQIKC%2FyiIIKOMM1XnEe09NuSw7Xf8Y6UOJpBJj7jLlVUmTMlaXhg0X5owu1jllReuJ1Ofketv8kjZlScgELVQhqeic8VvMdQFPk7uIxbwdUxI2D8U0mLOURF82HqwOSOvz3AjdFiUL5rInys31EjL5eLGhJJbviiWW1U6yAdtVgX5Dl9fG5sndUapgZ6tOzi5c%2FKiIqcs6TFB7V%2Ba94pbfE0ADF3Y25zJTundlOhWYZvSXJ2UVXh75JBOJYxsTgwZ5UgbsU6QjjUdK4ipM4ELoinryh%2FjoKyVb8ZjECBbMYtE22GC3vCLw7DmthiFcvoOPlRvKlah04sJNQ7b9KklIYWOG8BUX0xWhiMIC6qf8FOusB8i%2B4NEipXflNQqWCERI653SNHefieJr6qXk8vUjlyfvLnR2tXIQ%2FWyHufZZf0Rg4hKv79dttIkGWWsjFWimwSTHN9mTNskp6X9ZC4gvqOEnXuOZx%2Bxs2%2BUbYrNxuALH8x%2F%2FpM%2Fh0c4yBQF6OpSWOrWsdl5H%2BUIYyT8bSyRmCqToj58jXSS6GdhErBYuWCR9lbvOawRSwbxWyEGwvrNZPVRFC6gFj0nD1QwcZcdcCocD0zhQwtFu6F4LHGlpDLS8voy4%2BpFMo9RuKO1foe47wef9OHTulwBbLQCigHgaQeH2Lh7CupMWFI4rneA%3D%3D\u0026X-Amz-Signature=7c078c5ed33adbf2ec9b710ceae6fa94455b09b0f64c01d6cc099921b168e75c","file_size":19268,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["spetr0x","dyabla"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":970519,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @ameer0x0a ,\n\nThank you for bringing this to our attention.\n\nWhile this may be a good practice to not send anti csrf tokens in cookie, we choose to stay with the current configuration. Closing this as informative so you don't lose points.\n\nPlease feel free to comment if you think i misread it.\n\nLooking forward for future submissions from your side.\n\nRegards,\nHammad","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ameer0x0a\"\u003e@ameer0x0a\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this to our attention.\u003c/p\u003e\n\n\u003cp\u003eWhile this may be a good practice to not send anti csrf tokens in cookie, we choose to stay with the current configuration. Closing this as informative so you don\u0026#39;t lose points.\u003c/p\u003e\n\n\u003cp\u003ePlease feel free to comment if you think i misread it.\u003c/p\u003e\n\n\u003cp\u003eLooking forward for future submissions from your side.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nHammad\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-23T18:05:16.867Z","updated_at":"2016-05-23T18:05:16.867Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015381,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T16:48:47.562Z","updated_at":"2016-06-15T16:48:47.562Z","additional_data":{"old_title":"CSRF Token in cookies","new_title":"don't store CSRF tokens in cookies"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015382,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T16:48:53.162Z","updated_at":"2016-06-15T16:48:53.162Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015481,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537 can i know why you want to publicly disclose this informative report?","markdown_message":"\u003cp\u003e\u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e can i know why you want to publicly disclose this informative report?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T17:18:34.014Z","updated_at":"2016-06-15T17:18:34.014Z","actor":{"username":"0x0ameer","cleared":false,"url":"/0x0ameer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/821/9eaa6f40fc91ab202b19ea5cb064b0807786e24c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015527,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ameer0x0a As an open company, our policy (documented in our [program description](https://hackerone.com/gratipay)) is to publicly disclose all resolved and informative issues, in the interest of openness and transparency for our customers.","markdown_message":"\u003cp\u003e\u003ca href=\"/ameer0x0a\"\u003e@ameer0x0a\u003c/a\u003e As an open company, our policy (documented in our \u003ca href=\"https://hackerone.com/gratipay\"\u003eprogram description\u003c/a\u003e) is to publicly disclose all resolved and informative issues, in the interest of openness and transparency for our customers.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T17:33:37.919Z","updated_at":"2016-06-15T17:33:37.919Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1017442,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-16T15:25:14.125Z","updated_at":"2016-06-16T15:25:14.125Z","actor":{"username":"0x0ameer","cleared":false,"url":"/0x0ameer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/821/9eaa6f40fc91ab202b19ea5cb064b0807786e24c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1017443,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-16T15:25:14.250Z","updated_at":"2016-06-16T15:25:14.250Z","actor":{"username":"0x0ameer","cleared":false,"url":"/0x0ameer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/821/9eaa6f40fc91ab202b19ea5cb064b0807786e24c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340077,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-04T18:34:50.182Z","updated_at":"2016-12-04T18:34:50.182Z","additional_data":{"old_severity":null,"new_severity":"None","old_severity_id":null,"new_severity_id":11537},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}