{"id":207170,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDcxNzA=","url":"https://hackerone.com/reports/207170","title":"Stealing xoxs-tokens using weak postMessage / call-popup redirect to current team domain","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-02-17T16:58:06.882Z","submitted_at":"2017-02-17T16:58:06.882Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-28T23:05:26.832Z","bug_reporter_agreed_on_going_public_at":"2017-02-21T23:38:30.650Z","team_member_agreed_on_going_public_at":"2017-02-28T23:05:26.777Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-23T23:38:30.701Z","allow_singular_disclosure_after":-118905420.60643663,"singular_disclosure_allowed":true,"vote_count":114,"voters":["durg78","delimitry","arneswinnen","sp1d3rs","derision","ziot","cdl","fritzo","gabicosta","jobert","and 104 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1491669,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T17:33:05.393Z","updated_at":"2017-02-17T17:33:05.393Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1491828,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T19:05:03.830Z","updated_at":"2017-02-17T19:05:03.830Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1491841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T19:10:36.105Z","updated_at":"2017-02-17T19:10:36.105Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492237,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T22:36:57.363Z","updated_at":"2017-02-17T22:36:57.363Z","actor":{"username":"zpritchard","cleared":false,"url":"/zpritchard","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/103/278/c1f4a3f1b0e40b14e642e61df7935d8b221a33c4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T22:40:50.298Z","updated_at":"2017-02-17T22:40:50.298Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T23:27:46.263Z","updated_at":"2017-02-17T23:27:46.263Z","actor":{"username":"zpritchard","cleared":false,"url":"/zpritchard","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/103/278/c1f4a3f1b0e40b14e642e61df7935d8b221a33c4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1498066,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-21T23:35:01.233Z","updated_at":"2017-02-21T23:35:01.233Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1498069,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-21T23:37:16.413Z","updated_at":"2017-02-21T23:37:16.413Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1498075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-21T23:38:30.670Z","updated_at":"2017-02-21T23:38:30.670Z","first_to_agree":true,"actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1512214,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-28T23:05:26.800Z","updated_at":"2017-02-28T23:05:26.800Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1512215,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-28T23:05:26.851Z","updated_at":"2017-02-28T23:05:26.851Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517094,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T09:48:54.057Z","updated_at":"2017-03-03T09:49:45.653Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T18:18:33.222Z","updated_at":"2017-03-03T18:18:33.222Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1518007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T18:41:06.336Z","updated_at":"2017-03-03T18:41:06.336Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1518240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T21:05:44.367Z","updated_at":"2017-03-03T21:05:44.367Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739033,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:18:51.924Z","updated_at":"2018-11-30T14:18:51.924Z","additional_data":{"report_retest_user_id":51},"actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"emitrani","genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739034,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:18:53.277Z","updated_at":"2018-11-30T14:18:53.277Z","additional_data":{"report_retest_user_id":52},"actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"nahamsec","genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739035,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:18:54.102Z","updated_at":"2018-11-30T14:18:54.102Z","additional_data":{"report_retest_user_id":53},"actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"rhynorater","genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739036,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:18:54.689Z","updated_at":"2018-11-30T14:18:54.689Z","additional_data":{"report_retest_user_id":54},"actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"wang_johnny","genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739064,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:23:07.801Z","updated_at":"2018-11-30T14:23:07.801Z","additional_data":{"report_retest_user_id":53},"actor":{"username":"rhynorater","cleared":true,"url":"/rhynorater","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UBVBBEU7D2PJtynWGRFj7sMX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739257,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:40:05.229Z","updated_at":"2018-11-30T14:40:05.229Z","additional_data":{"report_retest_user_id":51},"actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739258,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:40:06.140Z","updated_at":"2018-11-30T14:40:06.140Z","additional_data":{"report_retest_user_id":52},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3740006,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T17:34:32.613Z","updated_at":"2018-11-30T17:34:32.613Z","additional_data":{"report_retest_user_id":54},"actor":{"username":"wang_johnny","cleared":true,"url":"/wang_johnny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3466,"category":"team","content":"@fransrosen discovered a vulnerability which would allow an attacker running a malicious site to steal XOXS tokens. We resolved the postMessage and call-popup redirect issues, and performed a thorough investigation to confirm that this had never been exploited. Thanks @fransrosen for an interesting finding!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e discovered a vulnerability which would allow an attacker running a malicious site to steal XOXS tokens. We resolved the postMessage and call-popup redirect issues, and performed a thorough investigation to confirm that this had never been exploited. Thanks \u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e for an interesting finding!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}