{"id":678050,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzgwNTA=","url":"https://hackerone.com/reports/678050","title":"Invalidate session after password reset","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-08-21T04:31:06.982Z","submitted_at":"2019-08-21T04:31:06.982Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nikhil786","url":"/nikhil786","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-05T08:37:11.687Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-06T08:37:10.547Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Website doesn't invalidate session after the password is reset which can enable attacker to continue using the compromised session.\n\nSteps:\n1) Open same accounts in two different browsers\n2) Change password in one browser and you will see that another browser still validate the session after password change (even after refresh the page ).\n\nRecommendation:\n\nAs per OWASP, it is recommended to terminate all the active sessions when a password is changed and force the user to re-login.\n\n## Impact\n\nLogging in with the new password doesn't invalidate the older session either: I could browse Liberapay using two sessions (in two different browsers) which were initiated using two different passwords.","vulnerability_information_html":"\u003cp\u003eWebsite doesn\u0026#39;t invalidate session after the password is reset which can enable attacker to continue using the compromised session.\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003cbr\u003e\n1) Open same accounts in two different browsers\u003cbr\u003e\n2) Change password in one browser and you will see that another browser still validate the session after password change (even after refresh the page ).\u003c/p\u003e\n\n\u003cp\u003eRecommendation:\u003c/p\u003e\n\n\u003cp\u003eAs per OWASP, it is recommended to terminate all the active sessions when a password is changed and force the user to re-login.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eLogging in with the new password doesn\u0026#39;t invalidate the older session either: I could browse Liberapay using two sessions (in two different browsers) which were initiated using two different passwords.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":560803,"file_name":"Screencast_Wednesday_21_August_2019_09_54_51__IST.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fdSkWrdAfj2UNu4hwdzs4s6p?response-content-disposition=attachment%3B%20filename%3D%22Screencast_Wednesday_21_August_2019_09_54_51__IST.webm%22%3B%20filename%2A%3DUTF-8%27%27Screencast_Wednesday_21_August_2019_09_54_51__IST.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063712Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=a6e1f1a6e4ec2ef56a6a23915dcfde316582b9ffecc2a662f1f58c86f64c67b3","file_size":2489371,"type":"video/webm"}],"allow_singular_disclosure_at":"2019-11-05T08:37:10.652Z","allow_singular_disclosure_after":-36280802.15739707,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sameerphad72","realtess","mightyowl"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5623952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! We have received your report and a security analyst will respond shortly.","markdown_message":"\u003cp\u003eThank you for your submission! We have received your report and a security analyst will respond shortly.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-08-21T07:50:38.200Z","updated_at":"2019-08-21T07:50:38.200Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5624078,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"It's true that we don't invalidate sessions when the password is changed, however I'm not convinced that we should. I'll think about it.","markdown_message":"\u003cp\u003eIt\u0026#39;s true that we don\u0026#39;t invalidate sessions when the password is changed, however I\u0026#39;m not convinced that we should. I\u0026#39;ll think about it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-21T08:10:59.672Z","updated_at":"2019-08-21T08:10:59.672Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5628187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hlo Sir \nIf the user login his account at some different person computer and forgot to logout . The person in which system user has login can do anything in his account because the old session of user at that person system is not gonna to expire if user might changes his password.","markdown_message":"\u003cp\u003eHlo Sir \u003cbr\u003e\nIf the user login his account at some different person computer and forgot to logout . The person in which system user has login can do anything in his account because the old session of user at that person system is not gonna to expire if user might changes his password.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-21T14:08:22.323Z","updated_at":"2019-08-21T14:08:22.323Z","actor":{"username":"nikhil786","cleared":false,"url":"/nikhil786","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5633570,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Two Hackerone Reports for your Reference sir :-\n\nhttps://hackerone.com/reports/15785\nhttps://hackerone.com/reports/15852","markdown_message":"\u003cp\u003eTwo Hackerone Reports for your Reference sir :-\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://hackerone.com/reports/15785\" href=\"https://hackerone.com/reports/15785\"\u003ehttps://hackerone.com/reports/15785\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/15852\" href=\"https://hackerone.com/reports/15852\"\u003ehttps://hackerone.com/reports/15852\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T03:36:59.363Z","updated_at":"2019-08-22T03:36:59.363Z","actor":{"username":"nikhil786","cleared":false,"url":"/nikhil786","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5753225,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-07T11:29:43.511Z","updated_at":"2019-09-07T11:29:43.511Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":511040},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5906850,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-27T17:59:07.129Z","updated_at":"2019-09-27T17:59:07.129Z","actor":{"username":"gameov3r","cleared":false,"url":"/gameov3r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5906903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess it makes sense to invalidate sessions obtained from a password that has become invalid. It can be helpful in countering an account takeover, but only if the attacker doesn't change the password first.\n\nWe've received multiple duplicates of this report recently, so I'm going to try to fix this soon.","markdown_message":"\u003cp\u003eI guess it makes sense to invalidate sessions obtained from a password that has become invalid. It can be helpful in countering an account takeover, but only if the attacker doesn\u0026#39;t change the password first.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve received multiple duplicates of this report recently, so I\u0026#39;m going to try to fix this soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-27T18:08:13.273Z","updated_at":"2019-09-27T18:08:13.273Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5963857,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-05T07:09:11.245Z","updated_at":"2019-10-05T07:09:11.245Z","additional_data":{"duplicate_report_id":707900},"actor":{"username":"ashh-10","cleared":false,"url":"/ashh-10","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9XEu8EbYb4P3komPfh64XZLM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5968184,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed in \u003chttps://github.com/liberapay/liberapay.com/pull/1593\u003e.","markdown_message":"\u003cp\u003eFixed in \u003ca title=\"https://github.com/liberapay/liberapay.com/pull/1593\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fpull%2F1593\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/liberapay/liberapay.com/pull/1593\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-06T08:36:39.103Z","updated_at":"2019-10-06T08:36:39.103Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nikhil786","url":"/nikhil786"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5968218,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-06T08:36:49.740Z","updated_at":"2019-10-06T08:36:49.740Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5968221,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-06T08:37:10.582Z","updated_at":"2019-10-06T08:37:10.582Z","first_to_agree":true,"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5970744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"close ok","markdown_message":"\u003cp\u003eclose ok\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-06T16:43:08.668Z","updated_at":"2019-10-06T16:43:08.668Z","actor":{"username":"ashh-10","cleared":false,"url":"/ashh-10","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9XEu8EbYb4P3komPfh64XZLM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6219020,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-05T08:37:12.003Z","updated_at":"2019-11-05T08:37:12.003Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}