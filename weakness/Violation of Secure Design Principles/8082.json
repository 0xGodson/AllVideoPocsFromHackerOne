{"id":8082,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDgy","url":"https://hackerone.com/reports/8082","title":"Password Reset Bug","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-18T22:41:09.474Z","submitted_at":"2014-04-18T22:41:09.474Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"christypriory","url":"/christypriory","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/688/b5a892017de169cb1fd497e47225e9c112aa767f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-09-25T22:34:35.437Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-08-26T22:34:32.041Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Possible account takeover using the forgot password link even after the email address and password changed.\r\n\r\nSteps to Reproduce\r\n===================================\r\n\r\nCreate an account in hackerone E.g john@example.com\r\nAfter account verification logout from the account\r\nReset the password for john@example.com where we get the password reset link but do not use this link.\r\n\r\nNow login again and change the email from john@exmaple.com to teena@example.com .\r\n\r\nA verification email will be sent to teena. After successful verification we can logout.\r\n\r\nNow this hackerone.com account belongs to teena@example.com and now teena can change the password.\r\n\r\nBut at this point ( after password change ) all the password reset links generated before should no longer be valid but in hackerone its still valid\r\n\r\nNow we can try using the forgot password reset link which we have kept in john@exmaple.com and see if we can take over the account.","vulnerability_information_html":"\u003cp\u003ePossible account takeover using the forgot password link even after the email address and password changed.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h1\u003e\n\n\u003cp\u003eCreate an account in hackerone E.g \u003ca title=\"john@example.com\" href=\"mailto:john@example.com\" rel=\"nofollow noopener noreferrer\"\u003ejohn@example.com\u003c/a\u003e\u003cbr\u003e\nAfter account verification logout from the account\u003cbr\u003e\nReset the password for \u003ca title=\"john@example.com\" href=\"mailto:john@example.com\" rel=\"nofollow noopener noreferrer\"\u003ejohn@example.com\u003c/a\u003e where we get the password reset link but do not use this link.\u003c/p\u003e\n\n\u003cp\u003eNow login again and change the email from \u003ca title=\"john@exmaple.com\" href=\"mailto:john@exmaple.com\" rel=\"nofollow noopener noreferrer\"\u003ejohn@exmaple.com\u003c/a\u003e to \u003ca title=\"teena@example.com\" href=\"mailto:teena@example.com\" rel=\"nofollow noopener noreferrer\"\u003eteena@example.com\u003c/a\u003e .\u003c/p\u003e\n\n\u003cp\u003eA verification email will be sent to teena. After successful verification we can logout.\u003c/p\u003e\n\n\u003cp\u003eNow this hackerone.com account belongs to \u003ca title=\"teena@example.com\" href=\"mailto:teena@example.com\" rel=\"nofollow noopener noreferrer\"\u003eteena@example.com\u003c/a\u003e and now teena can change the password.\u003c/p\u003e\n\n\u003cp\u003eBut at this point ( after password change ) all the password reset links generated before should no longer be valid but in hackerone its still valid\u003c/p\u003e\n\n\u003cp\u003eNow we can try using the forgot password reset link which we have kept in \u003ca title=\"john@exmaple.com\" href=\"mailto:john@exmaple.com\" rel=\"nofollow noopener noreferrer\"\u003ejohn@exmaple.com\u003c/a\u003e and see if we can take over the account.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-25T22:34:32.206Z","allow_singular_disclosure_after":-197540510.96392468,"singular_disclosure_allowed":true,"vote_count":2,"voters":["dyabla","prasanthpro"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":33420,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey @christypriory. This might be a common practice among big sites, but it gains extremely minor security improvement when compared to the efforts of implementing something like this.\n\n\u003e But at this point ( after password change ) all the password reset links generated before should no longer be valid but in hackerone its still valid\n\nThis is not entirely true. Password reset links do actually expire, but not on a password change or email change, like you suggest to implement. They expire when they are used, but more importantly, there's a time aspect involved. This time aspect really limits the time window in which you could potentially mount such an attack. \n\nSorry, but we don't consider this a realistic scenario. Thanks for passing this by us though!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/christypriory\"\u003e@christypriory\u003c/a\u003e. This might be a common practice among big sites, but it gains extremely minor security improvement when compared to the efforts of implementing something like this.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eBut at this point ( after password change ) all the password reset links generated before should no longer be valid but in hackerone its still valid\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is not entirely true. Password reset links do actually expire, but not on a password change or email change, like you suggest to implement. They expire when they are used, but more importantly, there\u0026#39;s a time aspect involved. This time aspect really limits the time window in which you could potentially mount such an attack. \u003c/p\u003e\n\n\u003cp\u003eSorry, but we don\u0026#39;t consider this a realistic scenario. Thanks for passing this by us though!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-20T13:41:36.306Z","updated_at":"2014-04-20T13:41:42.566Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":34791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But i guess we fix the password reset links working after a successful email change ","markdown_message":"\u003cp\u003eBut i guess we fix the password reset links working after a successful email change \u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-21T18:03:28.369Z","updated_at":"2014-04-21T18:03:28.369Z","actor":{"username":"christypriory","cleared":false,"url":"/christypriory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/688/b5a892017de169cb1fd497e47225e9c112aa767f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":34931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because tokens are only valid for a very, very limited time, we just don't consider this a security vulnerability.","markdown_message":"\u003cp\u003eBecause tokens are only valid for a very, very limited time, we just don\u0026#39;t consider this a security vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-21T19:28:00.577Z","updated_at":"2014-04-21T19:28:00.577Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87233,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-10T19:37:41.765Z","updated_at":"2014-07-10T19:37:41.765Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87234,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @christypriory - we decided to fix this because of a report sent in by another researcher via #17383 (will be public soon). We dropped the ball and did not connect the dots that you actually reported this issue first. Sorry!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/christypriory\"\u003e@christypriory\u003c/a\u003e - we decided to fix this because of a report sent in by another researcher via \u003ca href=\"/reports/17383\"\u003e#17383\u003c/a\u003e (will be public soon). We dropped the ball and did not connect the dots that you actually reported this issue first. Sorry!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-10T19:38:04.419Z","updated_at":"2014-07-10T19:38:04.419Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"christypriory","url":"/christypriory"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87236,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-10T19:38:15.300Z","updated_at":"2014-07-10T19:38:41.329Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"christypriory","url":"/christypriory"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you :)","markdown_message":"\u003cp\u003eThank you :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-10T19:43:47.097Z","updated_at":"2014-07-10T19:43:47.097Z","actor":{"username":"christypriory","cleared":false,"url":"/christypriory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/688/b5a892017de169cb1fd497e47225e9c112aa767f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":115907,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-26T22:34:32.055Z","updated_at":"2014-08-26T22:34:32.055Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":132228,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-25T22:34:35.453Z","updated_at":"2014-09-25T22:34:35.453Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}