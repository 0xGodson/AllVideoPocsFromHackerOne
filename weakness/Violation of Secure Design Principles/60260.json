{"id":60260,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MDI2MA==","url":"https://hackerone.com/reports/60260","title":"Misconfigured SPF Record Flag","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-05-08T21:51:16.563Z","submitted_at":"2015-05-08T21:51:16.563Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1566,"url":"https://hackerone.com/udemy","handle":"udemy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Udemy","twitter_handle":"","website":"http://udemy.com","about":"We’re the world’s online learning marketplace, with courses in everything from programming to yoga to photography."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-22T23:57:14.979Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-06-16T23:20:12.579Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team , \r\n\r\n####Description : \r\nthis report is about misconfigured spf record flag , which can be use to abuse the organization by posing the identity , which allowing to fake mailing on behalf of respected organization .\r\n\r\n####About the Issue : \r\nas i seen the __SPF__  and __TXT__ record for the __Udemy.com__ which is : \r\n````\r\nv=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com ~all \r\n``````\r\nas u can see the symbol at last which Tilde (__~all__) is the issue , which should be replace by Hyphen (__-all__) symbol . \r\n\r\nso valid record will be look like : \r\n````\r\nv=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com -all \r\n```\r\n\r\n####Whats the issue : \r\nas u can see in the article  difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. \r\nin current SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending .\r\n\r\n\r\n####Attack Scenario :\r\nan attacker will send phishing mail or anything malicious mail to the victim via mail : __security@Udemy.com__ , even if the victim is aware of phishing attack , he will check the Origin email which will be __security@Udemy.com__ , so he will be sure that its not fake mail and get trapped by attacker !  \r\n\r\nThis can be done using any php mailer tool like this , \r\n````\r\n\u003c?php\r\n$to = \"VICTIM@example.com\";\r\n$subject = \"Password Change\";\r\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\r\n$headers = \"From: security@Udemy.com\";\r\nmail($to,$subject,$txt,$headers);\r\n?\u003e\r\n````\r\n\r\n__u can check your SPF record form here : http://www.kitterman.com/spf/validate.html__ !\r\n\r\n####Reference : https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\r\nhave a look on the __digitalocean__ article for the better understanding !\r\n\r\nPlease let me know if any more info needed !\r\n\r\n__Thank You\r\nGeekboy :)__\r\n","vulnerability_information_html":"\u003cp\u003eHello Team , \u003c/p\u003e\n\n\u003ch4 id=\"description\"\u003eDescription :\u003c/h4\u003e\n\n\u003cp\u003ethis report is about misconfigured spf record flag , which can be use to abuse the organization by posing the identity , which allowing to fake mailing on behalf of respected organization .\u003c/p\u003e\n\n\u003ch4 id=\"about-the-issue\"\u003eAbout the Issue :\u003c/h4\u003e\n\n\u003cp\u003eas i seen the \u003cstrong\u003eSPF\u003c/strong\u003e  and \u003cstrong\u003eTXT\u003c/strong\u003e record for the \u003cstrong\u003eUdemy.com\u003c/strong\u003e which is : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ev=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com ~all \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eas u can see the symbol at last which Tilde (\u003cstrong\u003e~all\u003c/strong\u003e) is the issue , which should be replace by Hyphen (\u003cstrong\u003e-all\u003c/strong\u003e) symbol . \u003c/p\u003e\n\n\u003cp\u003eso valid record will be look like : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ev=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com -all \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"whats-the-issue\"\u003eWhats the issue :\u003c/h4\u003e\n\n\u003cp\u003eas u can see in the article  difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. \u003cbr\u003e\nin current SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending .\u003c/p\u003e\n\n\u003ch4 id=\"attack-scenario\"\u003eAttack Scenario :\u003c/h4\u003e\n\n\u003cp\u003ean attacker will send phishing mail or anything malicious mail to the victim via mail : \u003cstrong\u003e\u003ca title=\"security@Udemy.com\" href=\"mailto:security@Udemy.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@Udemy.com\u003c/a\u003e\u003c/strong\u003e , even if the victim is aware of phishing attack , he will check the Origin email which will be \u003cstrong\u003e\u003ca title=\"security@Udemy.com\" href=\"mailto:security@Udemy.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@Udemy.com\u003c/a\u003e\u003c/strong\u003e , so he will be sure that its not fake mail and get trapped by attacker !  \u003c/p\u003e\n\n\u003cp\u003eThis can be done using any php mailer tool like this , \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;VICTIM@example.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Password Change\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Change your password by visiting here - [VIRUS LINK HERE]l\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;From: security@Udemy.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eu can check your SPF record form here : \u003ca title=\"http://www.kitterman.com/spf/validate.html\" href=\"/redirect?url=http%3A%2F%2Fwww.kitterman.com%2Fspf%2Fvalidate.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.kitterman.com/spf/validate.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e !\u003c/p\u003e\n\n\u003ch4 id=\"reference-https-www-digitalocean-com-community-tutorials-how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\"\u003eReference : \u003ca title=\"https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/h4\u003e\n\n\u003cp\u003ehave a look on the \u003cstrong\u003edigitalocean\u003c/strong\u003e article for the better understanding !\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if any more info needed !\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eThank You\u003cbr\u003e\nGeekboy :)\u003c/strong\u003e\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-16T23:20:13.054Z","allow_singular_disclosure_after":-172134569.85856313,"singular_disclosure_allowed":true,"vote_count":1,"voters":["biswajit_"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":413421,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We have considered the ~all vs -all, and have determined that the increase in security is outweighed with the additional deliverability problems switching would cause. You will see that google.com also uses the ~all.","markdown_message":"\u003cp\u003eWe have considered the ~all vs -all, and have determined that the increase in security is outweighed with the additional deliverability problems switching would cause. You will see that google.com also uses the ~all.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-16T20:09:16.758Z","updated_at":"2015-05-16T20:09:16.758Z","actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474730,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T23:20:12.656Z","updated_at":"2015-06-16T23:20:12.656Z","first_to_agree":true,"actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":808206,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-22T23:57:14.783Z","updated_at":"2016-02-22T23:57:14.783Z","actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}