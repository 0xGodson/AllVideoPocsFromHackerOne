{"id":126377,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjYzNzc=","url":"https://hackerone.com/reports/126377","title":"Changing Driver Passwords With Only an Authenticated Session (no password, no email)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-27T20:40:16.011Z","submitted_at":"2016-03-27T20:40:16.011Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T22:21:38.390Z","bug_reporter_agreed_on_going_public_at":"2016-03-28T14:01:35.919Z","team_member_agreed_on_going_public_at":"2016-06-13T22:21:38.271Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible to completely take over a driver's account with only an authenticated session. If a driver is logged on and wants to change their password, they will be asked for their current password (```changePassword.png```), but when they want to change their email, they are not asked for their current password (```changeEmail.png```).  Once a driver's email has been changed, it is trivial to reset their password through the password reset page (which only requires access to the driver's email account). \n\nSo the steps to take over a driver's account from an authenticated session are: \n\n1. Change the driver's email to something that is attacker controlled\n2. Log out\n3. Use the forgot your password page to have a reset link sent to the attacker controlled email\n4. Use the link to reset the driver's password\n\nIn order to fix this, you have to add password authentication for changing the email associated with the account (or do what you do for riders and not allow changing the email). \n\nThanks,\nDavid Dworken","vulnerability_information_html":"\u003cp\u003eIt is possible to completely take over a driver\u0026#39;s account with only an authenticated session. If a driver is logged on and wants to change their password, they will be asked for their current password (\u003ccode\u003echangePassword.png\u003c/code\u003e), but when they want to change their email, they are not asked for their current password (\u003ccode\u003echangeEmail.png\u003c/code\u003e).  Once a driver\u0026#39;s email has been changed, it is trivial to reset their password through the password reset page (which only requires access to the driver\u0026#39;s email account). \u003c/p\u003e\n\n\u003cp\u003eSo the steps to take over a driver\u0026#39;s account from an authenticated session are: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eChange the driver\u0026#39;s email to something that is attacker controlled\u003c/li\u003e\n\u003cli\u003eLog out\u003c/li\u003e\n\u003cli\u003eUse the forgot your password page to have a reset link sent to the attacker controlled email\u003c/li\u003e\n\u003cli\u003eUse the link to reset the driver\u0026#39;s password\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn order to fix this, you have to add password authentication for changing the email associated with the account (or do what you do for riders and not allow changing the email). \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":81609,"file_name":"changePassword.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/609/c21b0832dc27d1f8d8f1702b308deb21dd2d2001/changePassword.png?response-content-disposition=attachment%3B%20filename%3D%22changePassword.png%22%3B%20filename%2A%3DUTF-8%27%27changePassword.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042303Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=4648e901321a44adf158f2836269d308cfafdd5cd65df3f27309889d5b86ac7a","file_size":20581,"type":"image/png"},{"id":81611,"file_name":"changeEmail.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/611/c659b269192aa6d46c47dd83c74d5cee34663723/changeEmail.png?response-content-disposition=attachment%3B%20filename%3D%22changeEmail.png%22%3B%20filename%2A%3DUTF-8%27%27changeEmail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042303Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=0b2045714499c96117e5e7389dcf0df802f2cfef3b0674fbffb691f2e5d3ea41","file_size":30803,"type":"image/png"}],"allow_singular_disclosure_at":"2016-04-27T14:01:36.340Z","allow_singular_disclosure_after":-147450087.5249176,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":873958,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for your report.\n\nWhile different methods of reauth may be something we consider in the future, \"best practice\" suggestions like this one are not eligible for our bug bounty program. Please see full program rules here: https://hackerone.com/uber\n\nThanks and we hope you'll continue to report security-related issues you find to us!","markdown_message":"\u003cp\u003eThanks for your report.\u003c/p\u003e\n\n\u003cp\u003eWhile different methods of reauth may be something we consider in the future, \u0026quot;best practice\u0026quot; suggestions like this one are not eligible for our bug bounty program. Please see full program rules here: \u003ca title=\"https://hackerone.com/uber\" href=\"https://hackerone.com/uber\"\u003ehttps://hackerone.com/uber\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks and we hope you\u0026#39;ll continue to report security-related issues you find to us!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T07:53:54.918Z","updated_at":"2016-03-28T07:53:54.918Z","actor":{"username":"bugtriage-david","cleared":false,"url":"/bugtriage-david","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":874366,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi David, \n\nThank you for the prompt reply. I'm not sure that this qualifies as a best practice but that is fine. \n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eHi David, \u003c/p\u003e\n\n\u003cp\u003eThank you for the prompt reply. I\u0026#39;m not sure that this qualifies as a best practice but that is fine. \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T14:01:35.942Z","updated_at":"2016-03-28T14:01:35.942Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we please disclose this?\n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eCan we please disclose this?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T14:37:16.500Z","updated_at":"2016-05-12T14:37:16.500Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @ddworken, this is a best practice we are revamping across the organization. As you can probably see many of these endpoints no longer exist since we revamped the entire Partner's website. Thanks for the report, pushing it into public disclosure now.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ddworken\"\u003e@ddworken\u003c/a\u003e, this is a best practice we are revamping across the organization. As you can probably see many of these endpoints no longer exist since we revamped the entire Partner\u0026#39;s website. Thanks for the report, pushing it into public disclosure now.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-13T22:21:38.297Z","updated_at":"2016-06-13T22:21:38.297Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012076,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T22:21:38.416Z","updated_at":"2016-06-13T22:21:38.416Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}