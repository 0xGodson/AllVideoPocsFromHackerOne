{"id":230674,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzA2NzQ=","url":"https://hackerone.com/reports/230674","title":"No rate limiting at POST /2/2017-05-22/send_identifier_token","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-22T13:22:18.102Z","submitted_at":"2017-05-22T13:22:18.102Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20680,"url":"https://hackerone.com/cuvva","handle":"cuvva","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/020/680/510f447a02a22a3c6de0625ba1a99aa362a3a806_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/680/510f447a02a22a3c6de0625ba1a99aa362a3a806_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cuvva","twitter_handle":"cuvva","website":"https://cuvva.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-01T21:27:49.530Z","bug_reporter_agreed_on_going_public_at":"2017-06-01T21:27:49.462Z","team_member_agreed_on_going_public_at":"2017-05-27T16:06:54.591Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"SUMMARY\n----------\nHello, while testing your api I have noticed that the request at `POST /2/2017-05-22/send_identifier_token` does not have any rate limiting (made about 60-70 requests) and this actually sens an SMS when the type is `mobile_phone`.\n\nI agree, this is not a very big issue, but all endpoints that could be used as spam (and I see you try to respect a lot of guidelines) should have rate limiting. Especially when __there is no way to stop the spam and the spam is on the telephone, not email__\n\nPOC\n-------\n```\nPOST /2/2017-05-22/send_identifier_token HTTP/1.1\nHost: service-auth.prod.ext.cuvva.co\nConnection: close\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nContent-type: application/json\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.8,de;q=0.6\nContent-Length: 116\n\n{\n\t\"client_id\": \"06c92f2c-8bbb-403c-9ee7-3b3b8eb0b30f\",\n\t\"type\": \"mobile_phone\",\n\t\"value\": \"+XXXXXXXXXXX\"\n}\n```\n\nReplace XXXXXX with a phone number (ex with public sms recieve service : +491628974982).\n\nThere is also no validation of the telephone against the email or with any other tokens, so any phone number can be spammed.\n\nSUGGESTED FIX\n-------------\n1. Apply rate limiting\n2. (more complicated) Add some sort of : \"To stop recieving SMS messages reply STOP\"\n\nScreenshot attached where you can see the spam directly on my phone.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSUMMARY\u003c/h2\u003e\n\n\u003cp\u003eHello, while testing your api I have noticed that the request at \u003ccode\u003ePOST /2/2017-05-22/send_identifier_token\u003c/code\u003e does not have any rate limiting (made about 60-70 requests) and this actually sens an SMS when the type is \u003ccode\u003emobile_phone\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eI agree, this is not a very big issue, but all endpoints that could be used as spam (and I see you try to respect a lot of guidelines) should have rate limiting. Especially when \u003cstrong\u003ethere is no way to stop the spam and the spam is on the telephone, not email\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /2/2017-05-22/send_identifier_token HTTP/1.1\nHost: service-auth.prod.ext.cuvva.co\nConnection: close\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nContent-type: application/json\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.8,de;q=0.6\nContent-Length: 116\n\n{\n    \u0026quot;client_id\u0026quot;: \u0026quot;06c92f2c-8bbb-403c-9ee7-3b3b8eb0b30f\u0026quot;,\n    \u0026quot;type\u0026quot;: \u0026quot;mobile_phone\u0026quot;,\n    \u0026quot;value\u0026quot;: \u0026quot;+XXXXXXXXXXX\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReplace XXXXXX with a phone number (ex with public sms recieve service : +491628974982).\u003c/p\u003e\n\n\u003cp\u003eThere is also no validation of the telephone against the email or with any other tokens, so any phone number can be spammed.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSUGGESTED FIX\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eApply rate limiting\u003c/li\u003e\n\u003cli\u003e(more complicated) Add some sort of : \u0026quot;To stop recieving SMS messages reply STOP\u0026quot;\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eScreenshot attached where you can see the spam directly on my phone.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":187024,"file_name":"Screenshot_2017-05-22-15-14-25.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/187/024/be91bacba548229dae706827edfa0c3989b03807/Screenshot_2017-05-22-15-14-25.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2017-05-22-15-14-25.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2017-05-22-15-14-25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050453Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=eeba906092d7866a753d9b0a0e8d9b31ab9f55b780af4ef9f5af775c28ed8090","file_size":331572,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-26T16:06:54.672Z","allow_singular_disclosure_after":-110725078.7311821,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","japz","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1691420,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for this report.\n\nAgreed, this is a known issue and should be resolved. We will add some rate limiting in place.\n\nIt is also worth noting that replying STOP should actually work already I think - this is built into Twilio.","markdown_message":"\u003cp\u003eThanks for this report.\u003c/p\u003e\n\n\u003cp\u003eAgreed, this is a known issue and should be resolved. We will add some rate limiting in place.\u003c/p\u003e\n\n\u003cp\u003eIt is also worth noting that replying STOP should actually work already I think - this is built into Twilio.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-22T13:24:43.210Z","updated_at":"2017-05-22T13:24:43.210Z","actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1691421,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-22T13:24:48.504Z","updated_at":"2017-05-22T13:24:48.504Z","actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1691427,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-22T13:26:15.933Z","updated_at":"2017-05-22T13:26:15.933Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":43863,"new_severity_id":43865},"actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1697053,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T07:06:32.529Z","updated_at":"2017-05-24T07:06:32.529Z","additional_data":{"duplicate_report_id":231361},"actor":{"username":"jaypatel","cleared":true,"url":"/jaypatel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/831/c3d0972be06406b82a1a2206880c4ad1197e573c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1705276,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've resolved this now. The initial rate limiting we've set up is pretty aggressive, and fairly basic, but we'll adapt it gradually over time.","markdown_message":"\u003cp\u003eWe\u0026#39;ve resolved this now. The initial rate limiting we\u0026#39;ve set up is pretty aggressive, and fairly basic, but we\u0026#39;ll adapt it gradually over time.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T16:03:28.769Z","updated_at":"2017-05-27T16:03:28.769Z","actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1705279,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Please send your name, mailing address and t-shirt size to █████████ :)","markdown_message":"\u003cp\u003ePlease send your name, mailing address and t-shirt size to █████████ :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T16:03:56.984Z","updated_at":"2017-06-01T21:01:30.945Z","actor":{"url":"/cuvva","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/680/510f447a02a22a3c6de0625ba1a99aa362a3a806_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cuvva"}},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1705280,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Please accept the disclosure once confirmed :)","markdown_message":"\u003cp\u003ePlease accept the disclosure once confirmed :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T16:06:54.642Z","updated_at":"2017-05-27T16:06:54.642Z","first_to_agree":true,"actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1708657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @billinghamj . I will come back to you early next week and retest because I am in holiday now.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/billinghamj\"\u003e@billinghamj\u003c/a\u003e . I will come back to you early next week and retest because I am in holiday now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-30T06:35:02.138Z","updated_at":"2017-05-30T06:35:02.138Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1723058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@billinghamj All ok now. Also, thanks for the swag. \n\nBefore disclosing. Are you sure you want your email in clear?","markdown_message":"\u003cp\u003e\u003ca href=\"/billinghamj\"\u003e@billinghamj\u003c/a\u003e All ok now. Also, thanks for the swag. \u003c/p\u003e\n\n\u003cp\u003eBefore disclosing. Are you sure you want your email in clear?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-01T20:27:20.111Z","updated_at":"2017-06-01T20:27:20.111Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1723193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Now redacted :)","markdown_message":"\u003cp\u003eNow redacted :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-01T21:01:41.494Z","updated_at":"2017-06-01T21:01:41.494Z","actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1723299,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-01T21:27:49.494Z","updated_at":"2017-06-01T21:27:49.494Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1723300,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-01T21:27:49.543Z","updated_at":"2017-06-01T21:27:49.543Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Swag has been sent - should get to you within a week or so :)","markdown_message":"\u003cp\u003eSwag has been sent - should get to you within a week or so :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-02T14:48:54.179Z","updated_at":"2017-06-02T14:48:54.179Z","actor":{"username":"billinghamj","cleared":false,"url":"/billinghamj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/165/186/034f08715c1ce1349f811a9e4475c577c70c930b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1725662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! ","markdown_message":"\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-02T16:48:10.848Z","updated_at":"2017-06-02T16:48:10.848Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cuvva","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}