{"id":801973,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDE5NzM=","url":"https://hackerone.com/reports/801973","title":"Email notification about login email changed is not received when using verified linked email address","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2020-02-21T18:05:35.585Z","submitted_at":"2020-02-21T18:05:35.585Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shaileshpratapwar","url":"/shaileshpratapwar","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-03-25T11:01:46.760Z","bug_reporter_agreed_on_going_public_at":"2020-03-15T19:02:24.915Z","team_member_agreed_on_going_public_at":"2020-03-25T11:01:46.689Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nIn https://gitlab.com/profile, user can update the email id to use for login to gitlab account using field \"Email\".\nUsually, when this login email id is updated, there will be 2 email sent on previous email Id with subjects as. \nEmail 1 - Email Changed:- This tell that login email has been changed to new email.\nEmail 2 - Confirmation instructions :- This has a confirmation link to confirm the email id.\n\nHowever, when we change this login email ID to one of the email ID which is already linked in our gitlab account under https://gitlab.com/profile/emails, then none of the above 2 emails are sent to previous email ID.\n\nI understand that as linked email ID are already verified, so no need to send the 2nd email i.e. Confirmation Instruction but the first email i.e. \"Email Changed\" should be sent to previous email ID stating that your login email has been changed to new one.\n\n### Steps to reproduce\n1. User logs in to gitlab.com using his email ID ( ex. user-one@gmail.com)\n2. Now, on https://gitlab.com/profile, user updates the login email id (\"Email\" field having \"We also use email for avatar detection if no avatar is uploaded\" written below it) to another email id (ex. user-two@gmail.com)\n3. Now, an email will go to user-one@gmail.com informing that email change action is being done. This is as expected. (Email subject : \"Email Changed\")\n4. Now, broken scenarios is as follows :\n5. On https://gitlab.com/profile/emails, user adds new email address (ex. user-three@gmail.com).\n6. user-one@gmail.com will receive email to confirm the newly added email by clicking on confirmation link received in new email.\n7. So, one new email id i.e. user-three@gmail.com will be seen as verified under https://gitlab.com/profile/emails,\n8. Now if we try to update login email id on https://gitlab.com/profile (as in step 2 above) to user-three@gmail.com, no email with subject as \"Email Changed\" will be received on user-one@gmail.com.\n\n\n### Impact\n\n1. Account primary owner will not be aware of the fact that owner has been changed to some other email id. Although, new email is verified, \"Email Changed\" email will be expected by account primary owner as this happens usually (as happened in step 3 in steps above). So, consistency is not maintained in informing new changes to account primary owner.\n\n### What is the expected *correct* behavior?\n\nI think there should be consistency in informing these critical account changes to account owner. \"Email Changed\" email is received by owner when unverified email is added. Similar should happen for verified email as body of this email is playing important role here to inform account owner of what changes happened.\n\n### Output of checks\nThis bug happens on GitLab.com\n\n#### Results of GitLab environment info\nThis bug happens on GitLab.com\n\nAttached are the POC screenshots.\nPlease let me know if you need a video POC.\n\n## Impact\n\nAccount owner will not be aware that login email id for the gitlab account has been changed to one of the linked email id.","vulnerability_information_html":"\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eIn \u003ca title=\"https://gitlab.com/profile\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, user can update the email id to use for login to gitlab account using field \u0026quot;Email\u0026quot;.\u003cbr\u003e\nUsually, when this login email id is updated, there will be 2 email sent on previous email Id with subjects as. \u003cbr\u003e\nEmail 1 - Email Changed:- This tell that login email has been changed to new email.\u003cbr\u003e\nEmail 2 - Confirmation instructions :- This has a confirmation link to confirm the email id.\u003c/p\u003e\n\n\u003cp\u003eHowever, when we change this login email ID to one of the email ID which is already linked in our gitlab account under \u003ca title=\"https://gitlab.com/profile/emails\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile%2Femails\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile/emails\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, then none of the above 2 emails are sent to previous email ID.\u003c/p\u003e\n\n\u003cp\u003eI understand that as linked email ID are already verified, so no need to send the 2nd email i.e. Confirmation Instruction but the first email i.e. \u0026quot;Email Changed\u0026quot; should be sent to previous email ID stating that your login email has been changed to new one.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eUser logs in to gitlab.com using his email ID ( ex. \u003ca title=\"user-one@gmail.com\" href=\"mailto:user-one@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-one@gmail.com\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eNow, on \u003ca title=\"https://gitlab.com/profile\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, user updates the login email id (\u0026quot;Email\u0026quot; field having \u0026quot;We also use email for avatar detection if no avatar is uploaded\u0026quot; written below it) to another email id (ex. \u003ca title=\"user-two@gmail.com\" href=\"mailto:user-two@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-two@gmail.com\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eNow, an email will go to \u003ca title=\"user-one@gmail.com\" href=\"mailto:user-one@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-one@gmail.com\u003c/a\u003e informing that email change action is being done. This is as expected. (Email subject : \u0026quot;Email Changed\u0026quot;)\u003c/li\u003e\n\u003cli\u003eNow, broken scenarios is as follows :\u003c/li\u003e\n\u003cli\u003eOn \u003ca title=\"https://gitlab.com/profile/emails\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile%2Femails\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile/emails\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, user adds new email address (ex. \u003ca title=\"user-three@gmail.com\" href=\"mailto:user-three@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-three@gmail.com\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003e\n\u003ca title=\"user-one@gmail.com\" href=\"mailto:user-one@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-one@gmail.com\u003c/a\u003e will receive email to confirm the newly added email by clicking on confirmation link received in new email.\u003c/li\u003e\n\u003cli\u003eSo, one new email id i.e. \u003ca title=\"user-three@gmail.com\" href=\"mailto:user-three@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-three@gmail.com\u003c/a\u003e will be seen as verified under \u003ca title=\"https://gitlab.com/profile/emails\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile%2Femails\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile/emails\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e,\u003c/li\u003e\n\u003cli\u003eNow if we try to update login email id on \u003ca title=\"https://gitlab.com/profile\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (as in step 2 above) to \u003ca title=\"user-three@gmail.com\" href=\"mailto:user-three@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-three@gmail.com\u003c/a\u003e, no email with subject as \u0026quot;Email Changed\u0026quot; will be received on \u003ca title=\"user-one@gmail.com\" href=\"mailto:user-one@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser-one@gmail.com\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eAccount primary owner will not be aware of the fact that owner has been changed to some other email id. Although, new email is verified, \u0026quot;Email Changed\u0026quot; email will be expected by account primary owner as this happens usually (as happened in step 3 in steps above). So, consistency is not maintained in informing new changes to account primary owner.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eI think there should be consistency in informing these critical account changes to account owner. \u0026quot;Email Changed\u0026quot; email is received by owner when unverified email is added. Similar should happen for verified email as body of this email is playing important role here to inform account owner of what changes happened.\u003c/p\u003e\n\n\u003ch3 id=\"output-of-checks\"\u003eOutput of checks\u003c/h3\u003e\n\n\u003cp\u003eThis bug happens on GitLab.com\u003c/p\u003e\n\n\u003ch4 id=\"results-of-gitlab-environment-info\"\u003eResults of GitLab environment info\u003c/h4\u003e\n\n\u003cp\u003eThis bug happens on GitLab.com\u003c/p\u003e\n\n\u003cp\u003eAttached are the POC screenshots.\u003cbr\u003e\nPlease let me know if you need a video POC.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAccount owner will not be aware that login email id for the gitlab account has been changed to one of the linked email id.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":724475,"file_name":"Primary_email_is_changed_to_linked_email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RsxrrzYyEQMyDVNzdaqU3UnB?response-content-disposition=attachment%3B%20filename%3D%22Primary_email_is_changed_to_linked_email.png%22%3B%20filename%2A%3DUTF-8%27%27Primary_email_is_changed_to_linked_email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065529Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=bc86f869c5609bada7cfedd7c902c2fee49f82de65cb3a6c7878760d3780f973","file_size":72441,"type":"image/png"},{"id":724476,"file_name":"Example_of_Verified_Linked_Email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CiyPW3BAidBQT1Mni6TwpGrr?response-content-disposition=attachment%3B%20filename%3D%22Example_of_Verified_Linked_Email.png%22%3B%20filename%2A%3DUTF-8%27%27Example_of_Verified_Linked_Email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065529Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=d0de2841ffec90a55e9a71771cd7b363a50088661a1e5d322437912bec9764f2","file_size":71754,"type":"image/png"},{"id":724477,"file_name":"Expected_Email_Changed_Email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pHVvUfqDm99Dd5FhM8Lem5dw?response-content-disposition=attachment%3B%20filename%3D%22Expected_Email_Changed_Email.png%22%3B%20filename%2A%3DUTF-8%27%27Expected_Email_Changed_Email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065529Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=f552c4f8a5c0d5699f732f353f657346e6e77e5ab6540d6cd621b35c7764de83","file_size":64761,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["electro-pacman","tzaddiq"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7117150,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @shaileshpratapwar,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/shaileshpratapwar\"\u003e@shaileshpratapwar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 10 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-02-21T22:05:54.860Z","updated_at":"2020-02-21T22:05:54.860Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7134134,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @shaileshpratapwar,\n\nThank you for this report.\nDo you have any attack scenario in mind where this could be used maliciously ?\nIn your description\n* `user-one` explicitly adds `user-three`\n* then confirms this action by clicking on the email he receives in `user-one` mailbox\n* finally changes deliberately his primary email from `user-one` to `user-three`.\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/shaileshpratapwar\"\u003e@shaileshpratapwar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report.\u003cbr\u003e\nDo you have any attack scenario in mind where this could be used maliciously ?\u003cbr\u003e\nIn your description\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003euser-one\u003c/code\u003e explicitly adds \u003ccode\u003euser-three\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003ethen confirms this action by clicking on the email he receives in \u003ccode\u003euser-one\u003c/code\u003e mailbox\u003c/li\u003e\n\u003cli\u003efinally changes deliberately his primary email from \u003ccode\u003euser-one\u003c/code\u003e to \u003ccode\u003euser-three\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-24T10:30:07.613Z","updated_at":"2020-02-24T10:30:07.613Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7140400,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jmatos_bgtvf ,\nThank you for your reply.\n\nBelow is my impact analysis :-\n1. If there happens any CSRF on https://gitlab.com/profile, then it would lead to user account takeover and Primary owner will miss the \"Email Changed\" security notification. But I checked, there is no CSRF issue exist. But if it happen in future, it would be a risk.\n2. As per the gitlab documentation, https://docs.gitlab.com/ee/user/profile/notifications.html#notification-events , the \"Email Changed\" notification is received always. However, with scenario depicted in report, notification is not received. \n3. The documentation does not say the Email Changed notification will not be received in this special case. So, user will be in a state that he would receive the notification always. \n4. Important : After we add any linked email on https://gitlab.com/profile/emails, the primary owner do not receive any notification email. Only the newly added email will get confirmation instruction to confirm the email.\nAnd considering the special case mentioned in this bug report, \"Email Changed\" email will also not be received by primary owner. So, this means primary owner will not get any kind of notification for adding new email and making it primary owner.\n\nIn short, this happens to be a gap in properly notifying the user about the email change which seems to be critical notification and needs a fix (Either in documentation specifying the special case Or in code so as to receive the notification always as the documentation says).\n\nThank you. \n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmatos_bgtvf\"\u003e@jmatos_bgtvf\u003c/a\u003e ,\u003cbr\u003e\nThank you for your reply.\u003c/p\u003e\n\n\u003cp\u003eBelow is my impact analysis :-\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIf there happens any CSRF on \u003ca title=\"https://gitlab.com/profile\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, then it would lead to user account takeover and Primary owner will miss the \u0026quot;Email Changed\u0026quot; security notification. But I checked, there is no CSRF issue exist. But if it happen in future, it would be a risk.\u003c/li\u003e\n\u003cli\u003eAs per the gitlab documentation, \u003ca title=\"https://docs.gitlab.com/ee/user/profile/notifications.html#notification-events\" href=\"/redirect?url=https%3A%2F%2Fdocs.gitlab.com%2Fee%2Fuser%2Fprofile%2Fnotifications.html%23notification-events\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.gitlab.com/ee/user/profile/notifications.html#notification-events\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e , the \u0026quot;Email Changed\u0026quot; notification is received always. However, with scenario depicted in report, notification is not received. \u003c/li\u003e\n\u003cli\u003eThe documentation does not say the Email Changed notification will not be received in this special case. So, user will be in a state that he would receive the notification always. \u003c/li\u003e\n\u003cli\u003eImportant : After we add any linked email on \u003ca title=\"https://gitlab.com/profile/emails\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fprofile%2Femails\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/profile/emails\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the primary owner do not receive any notification email. Only the newly added email will get confirmation instruction to confirm the email.\nAnd considering the special case mentioned in this bug report, \u0026quot;Email Changed\u0026quot; email will also not be received by primary owner. So, this means primary owner will not get any kind of notification for adding new email and making it primary owner.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn short, this happens to be a gap in properly notifying the user about the email change which seems to be critical notification and needs a fix (Either in documentation specifying the special case Or in code so as to receive the notification always as the documentation says).\u003c/p\u003e\n\n\u003cp\u003eThank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T02:48:59.544Z","updated_at":"2020-02-25T02:48:59.544Z","actor":{"username":"shaileshpratapwar","cleared":false,"url":"/shaileshpratapwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7143155,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @shaileshpratapwar,\n\nThank you for this analysis.\n\nAs no exploitable scenario has been identified, we plan to consider this report as `Informative` and import it as a bug with no current security impact (process documented in the Disclosure section of https://hackerone.com/gitlab).\nHence we are updating the Severity to None.\n\nDo not hesitate to come back to us should we have misunderstood something.\nWe also offer you the possibility to self-close this report within the next 3 days.\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/shaileshpratapwar\"\u003e@shaileshpratapwar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this analysis.\u003c/p\u003e\n\n\u003cp\u003eAs no exploitable scenario has been identified, we plan to consider this report as \u003ccode\u003eInformative\u003c/code\u003e and import it as a bug with no current security impact (process documented in the Disclosure section of \u003ca title=\"https://hackerone.com/gitlab\" href=\"https://hackerone.com/gitlab\"\u003ehttps://hackerone.com/gitlab\u003c/a\u003e).\u003cbr\u003e\nHence we are updating the Severity to None.\u003c/p\u003e\n\n\u003cp\u003eDo not hesitate to come back to us should we have misunderstood something.\u003cbr\u003e\nWe also offer you the possibility to self-close this report within the next 3 days.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T09:28:16.785Z","updated_at":"2020-02-25T09:28:16.785Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7143157,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-25T09:28:23.293Z","updated_at":"2020-02-25T09:28:23.293Z","additional_data":{"old_severity":"Low (3.3)","new_severity":"None","old_severity_id":640111,"new_severity_id":642614},"actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7144796,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Thank you.","markdown_message":"\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T10:39:30.471Z","updated_at":"2020-02-25T10:39:30.471Z","actor":{"username":"shaileshpratapwar","cleared":false,"url":"/shaileshpratapwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7153976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @shaileshpratapwar,\n\nThank you for closing the report.\nFor transparency, here is the link to the public bug report: https://gitlab.com/gitlab-org/gitlab/issues/208130\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/shaileshpratapwar\"\u003e@shaileshpratapwar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for closing the report.\u003cbr\u003e\nFor transparency, here is the link to the public bug report: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/issues/208130\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fissues%2F208130\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/issues/208130\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-26T10:09:20.540Z","updated_at":"2020-02-26T10:09:20.540Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7255284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jmatos_bgtvf \nSorry to buzz again but I noticed the \"Email Changed\" email is considered as a security email in the documentation link above.\nIts also written that it is \"sent always\". But still this bug is not marked as a security bug.\nCould you please reconsider and tell if this can be taken as a security bug ?\n\nThanks\nShailesh","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmatos_bgtvf\"\u003e@jmatos_bgtvf\u003c/a\u003e \u003cbr\u003e\nSorry to buzz again but I noticed the \u0026quot;Email Changed\u0026quot; email is considered as a security email in the documentation link above.\u003cbr\u003e\nIts also written that it is \u0026quot;sent always\u0026quot;. But still this bug is not marked as a security bug.\u003cbr\u003e\nCould you please reconsider and tell if this can be taken as a security bug ?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nShailesh\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-08T10:01:55.781Z","updated_at":"2020-03-08T10:01:55.781Z","actor":{"username":"shaileshpratapwar","cleared":false,"url":"/shaileshpratapwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7323092,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-15T19:02:24.943Z","updated_at":"2020-03-15T19:02:24.943Z","first_to_agree":true,"actor":{"username":"shaileshpratapwar","cleared":false,"url":"/shaileshpratapwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7330272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @shaileshpratapwar,\n\nAfter review, this is still considered a security enhancement and not a vulnerability. Following our process documented at https://about.gitlab.com/handbook/engineering/security/#feature,  the public issue https://gitlab.com/gitlab-org/gitlab/issues/208130 now has the  feature label.\n\nBest regards,\nGitlab Security Team.\n\nNB: As the issue is public, disclosure of this report is not needed.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/shaileshpratapwar\"\u003e@shaileshpratapwar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAfter review, this is still considered a security enhancement and not a vulnerability. Following our process documented at \u003ca title=\"https://about.gitlab.com/handbook/engineering/security/#feature\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2Fhandbook%2Fengineering%2Fsecurity%2F%23feature\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/handbook/engineering/security/#feature\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e,  the public issue \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/issues/208130\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fissues%2F208130\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/issues/208130\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e now has the  feature label.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitlab Security Team.\u003c/p\u003e\n\n\u003cp\u003eNB: As the issue is public, disclosure of this report is not needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-16T14:35:05.063Z","updated_at":"2020-03-16T14:35:05.063Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7425075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Without disclosure how this report will appear in Hacktivity feed ? Could you please tell if there is a problem with disclosing this report ?","markdown_message":"\u003cp\u003eWithout disclosure how this report will appear in Hacktivity feed ? Could you please tell if there is a problem with disclosing this report ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-25T02:50:25.109Z","updated_at":"2020-03-25T02:50:25.109Z","actor":{"username":"shaileshpratapwar","cleared":false,"url":"/shaileshpratapwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QKrhVLZcYnidFgL9Nxhi9rYM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7429127,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-25T11:01:46.710Z","updated_at":"2020-03-25T11:01:46.710Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7429128,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-25T11:01:46.780Z","updated_at":"2020-03-25T11:01:46.780Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}