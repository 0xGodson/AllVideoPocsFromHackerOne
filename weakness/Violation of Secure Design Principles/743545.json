{"id":743545,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDM1NDU=","url":"https://hackerone.com/reports/743545","title":"Bruteforce password recovery code","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-11-21T17:54:12.936Z","submitted_at":"2019-11-21T17:54:12.936Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0x3c3e","url":"/0x3c3e","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21554,"url":"https://hackerone.com/bumble","handle":"bumble","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Bumble","twitter_handle":"","website":"https://bumble.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-18T17:45:58.360Z","bug_reporter_agreed_on_going_public_at":"2019-12-19T17:45:53.024Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nIt's possible to bruteforce recovery code from SMS as iOS application doesn't have limits for incorrect inputs. I have tried 50+ different combinations until I reached code from SMS.\n\n## Steps To Reproduce\n1. Click \"Use another option\" on application startup view\n1. Enter your phone number\n1. Click \"Forgotten number\"\n1. Click \"OK\" on pop-up window\n1. Bruteforce 4 digits code \n\n## PoC video\nhttps://youtu.be/QV80pD0wZsE\n\n## Mitigation\n1. Limit quantity of attempts to enter recovery code\n1. Don't store recovery code on target device to compare it with user's input\n\n## Details\nDevices: Iphone SE (13.2), Iphone 6s (12.4)\nApp: Bumble (5.140.0)\n\n## Impact\n\nAccount takeover.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eIt\u0026#39;s possible to bruteforce recovery code from SMS as iOS application doesn\u0026#39;t have limits for incorrect inputs. I have tried 50+ different combinations until I reached code from SMS.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eClick \u0026quot;Use another option\u0026quot; on application startup view\u003c/li\u003e\n\u003cli\u003eEnter your phone number\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Forgotten number\u0026quot;\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;OK\u0026quot; on pop-up window\u003c/li\u003e\n\u003cli\u003eBruteforce 4 digits code \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"poc-video\"\u003ePoC video\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://youtu.be/QV80pD0wZsE\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FQV80pD0wZsE\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/QV80pD0wZsE\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLimit quantity of attempts to enter recovery code\u003c/li\u003e\n\u003cli\u003eDon\u0026#39;t store recovery code on target device to compare it with user\u0026#39;s input\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"details\"\u003eDetails\u003c/h2\u003e\n\n\u003cp\u003eDevices: Iphone SE (13.2), Iphone 6s (12.4)\u003cbr\u003e\nApp: Bumble (5.140.0)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAccount takeover.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-01-18T17:45:53.069Z","allow_singular_disclosure_after":-29854763.557030298,"singular_disclosure_allowed":true,"vote_count":250,"voters":["djurado","a_d_a_m","friyin","0x3c3e","teuvokas","mik317","sameerphad72","prophet","0xelkomy","parzel","and 240 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6370978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Instead of \"Forgotten number\" it should be \"Forgotten password\".","markdown_message":"\u003cp\u003eInstead of \u0026quot;Forgotten number\u0026quot; it should be \u0026quot;Forgotten password\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-21T18:08:41.456Z","updated_at":"2019-11-21T18:08:41.456Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6371920,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's odd, but seems like I can't reproduce even with 50+ recovery combinations right now on another phone number. On my main phone number Bumble returns \"Server overloaded, please try again in 5 minutes\". ","markdown_message":"\u003cp\u003eThat\u0026#39;s odd, but seems like I can\u0026#39;t reproduce even with 50+ recovery combinations right now on another phone number. On my main phone number Bumble returns \u0026quot;Server overloaded, please try again in 5 minutes\u0026quot;. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-21T19:47:03.857Z","updated_at":"2019-11-21T19:55:12.144Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6381620,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Today I was able to send 100+ different combinations until correct OTP code, I guess that crucial part is delays between sending OTP codes, seems like if I send OTP codes too fast Bumble blocks my attempts.\n\nI will check web version of recovery option (to implement PoC with a full bruteforce) as I wasn't able to SSL unpin Bumble iOS app.","markdown_message":"\u003cp\u003eToday I was able to send 100+ different combinations until correct OTP code, I guess that crucial part is delays between sending OTP codes, seems like if I send OTP codes too fast Bumble blocks my attempts.\u003c/p\u003e\n\n\u003cp\u003eI will check web version of recovery option (to implement PoC with a full bruteforce) as I wasn\u0026#39;t able to SSL unpin Bumble iOS app.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-22T16:31:19.258Z","updated_at":"2019-11-22T16:31:19.258Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6389858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"New details:\n1. OTP recovery code from SMS is available even after 8+ hours\n1. \"Server overloaded, please try again in 5 minutes\" limit message which appears after 5 attempts to receive OTP code and change password is possible to bypass by changing IP address\n1. Measures on web version of Bumble to prevent bruteforce of recovery code are odd, as it's feasible to solve captchas","markdown_message":"\u003cp\u003eNew details:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOTP recovery code from SMS is available even after 8+ hours\u003c/li\u003e\n\u003cli\u003e\u0026quot;Server overloaded, please try again in 5 minutes\u0026quot; limit message which appears after 5 attempts to receive OTP code and change password is possible to bypass by changing IP address\u003c/li\u003e\n\u003cli\u003eMeasures on web version of Bumble to prevent bruteforce of recovery code are odd, as it\u0026#39;s feasible to solve captchas\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2019-11-24T11:16:28.872Z","updated_at":"2019-11-24T11:16:28.872Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6391643,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have wrote a script using https://autotouch.net/ framework —https://gist.github.com/0x3c3e/9a462a83ef228efb18183d389354af12 (should work on Iphone 6s and on same screen resolutions).\nSeems like it's possible to bruteforce up to 100 combinations on already registered account when phone number was used as registration method.\nIn contrast, to register account with a new phone number iOS app requires to enter captcha after 3 incorrect OTP codes.\n","markdown_message":"\u003cp\u003eI have wrote a script using \u003ca title=\"https://autotouch.net/\" href=\"/redirect?url=https%3A%2F%2Fautotouch.net%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://autotouch.net/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e framework —\u003ca title=\"https://gist.github.com/0x3c3e/9a462a83ef228efb18183d389354af12\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2F0x3c3e%2F9a462a83ef228efb18183d389354af12\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/0x3c3e/9a462a83ef228efb18183d389354af12\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (should work on Iphone 6s and on same screen resolutions).\u003cbr\u003e\nSeems like it\u0026#39;s possible to bruteforce up to 100 combinations on already registered account when phone number was used as registration method.\u003cbr\u003e\nIn contrast, to register account with a new phone number iOS app requires to enter captcha after 3 incorrect OTP codes.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-24T22:21:35.329Z","updated_at":"2019-11-24T22:22:57.589Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6396367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have found a new detail, after threshold in 100 attempts it's possible to try more combinations, but an attacker should take a break and wait about an hour. So here are steps of the attack:\n1. Find already registered user in Bumble by mobile phone number\n1. Use [script] to try up to 100 combinations\n1. Wait about an hour (plus optional to change IP)\n1. Repeat from step 2. until OTP is reached\n\nThe attack assumes that OTP code is the same and available even after 8+ hours, I will try to check it shortly.\n\n[script]: https://hackerone.com/redirect?signature=7e625ab388f00f745ebf330425d74b359edc852c\u0026url=https%3A%2F%2Fgist.github.com%2F0x3c3e%2F9a462a83ef228efb18183d389354af12","markdown_message":"\u003cp\u003eI have found a new detail, after threshold in 100 attempts it\u0026#39;s possible to try more combinations, but an attacker should take a break and wait about an hour. So here are steps of the attack:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFind already registered user in Bumble by mobile phone number\u003c/li\u003e\n\u003cli\u003eUse \u003ca href=\"https://hackerone.com/redirect?signature=7e625ab388f00f745ebf330425d74b359edc852c\u0026amp;url=https%3A%2F%2Fgist.github.com%2F0x3c3e%2F9a462a83ef228efb18183d389354af12\"\u003escript\u003c/a\u003e to try up to 100 combinations\u003c/li\u003e\n\u003cli\u003eWait about an hour (plus optional to change IP)\u003c/li\u003e\n\u003cli\u003eRepeat from step 2. until OTP is reached\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe attack assumes that OTP code is the same and available even after 8+ hours, I will try to check it shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T11:14:07.179Z","updated_at":"2019-11-25T11:14:16.392Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6398236,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi.\nWe are on this and I'll be back with updates later.\nThank you for the report!","markdown_message":"\u003cp\u003eHi.\u003cbr\u003e\nWe are on this and I\u0026#39;ll be back with updates later.\u003cbr\u003e\nThank you for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T12:49:05.663Z","updated_at":"2019-11-25T12:49:05.663Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6399513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Currently I was able to try 180 different combinations until correct OTP code, even without waiting an hour, I just changed IP address using VPN (after 90 combinations), from USA to UK. I guess, using this technique it's possible to try every combinations.","markdown_message":"\u003cp\u003eCurrently I was able to try 180 different combinations until correct OTP code, even without waiting an hour, I just changed IP address using VPN (after 90 combinations), from USA to UK. I guess, using this technique it\u0026#39;s possible to try every combinations.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T14:49:47.386Z","updated_at":"2019-11-25T14:52:19.101Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6590047,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey.\nThis should be fixed now. Could you confirm, please?\nThank you for the report! ","markdown_message":"\u003cp\u003eHey.\u003cbr\u003e\nThis should be fixed now. Could you confirm, please?\u003cbr\u003e\nThank you for the report! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-19T16:01:45.662Z","updated_at":"2019-12-19T16:01:45.662Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Bumble"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"bumble","collaborator":{"username":"0x3c3e","url":"/0x3c3e"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6590050,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-19T16:01:58.503Z","updated_at":"2019-12-19T16:01:58.503Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0x3c3e","url":"/0x3c3e"},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6590111,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, @uyga and thank you for the bounty. But could you check new my comments on https://hackerone.com/reports/746186? I think it's a valid report.","markdown_message":"\u003cp\u003eHi, \u003ca href=\"/uyga\"\u003e@uyga\u003c/a\u003e and thank you for the bounty. But could you check new my comments on \u003ca title=\"https://hackerone.com/reports/746186\" href=\"https://hackerone.com/reports/746186\"\u003ehttps://hackerone.com/reports/746186\u003c/a\u003e? I think it\u0026#39;s a valid report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-19T16:10:46.720Z","updated_at":"2019-12-19T16:10:46.720Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6590854,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Seems fixed for me, Bumble implemented captcha checks after several incorrect inputs.\nPlease publicly disclose the report as I decided to disclose all my submissions on Hackerone.","markdown_message":"\u003cp\u003eSeems fixed for me, Bumble implemented captcha checks after several incorrect inputs.\u003cbr\u003e\nPlease publicly disclose the report as I decided to disclose all my submissions on Hackerone.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-19T17:45:53.045Z","updated_at":"2019-12-19T17:45:53.045Z","first_to_agree":true,"actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6808006,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-18T17:45:58.383Z","updated_at":"2020-01-18T17:45:58.383Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Bumble"}},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}