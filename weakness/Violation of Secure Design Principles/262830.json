{"id":262830,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjI4MzA=","url":"https://hackerone.com/reports/262830","title":"Rate-limit protection get executed in the last stage of the registration process, allowing enumeration of existing account.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-08-24T03:32:33.601Z","submitted_at":"2017-08-24T03:32:33.601Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-03T04:47:17.572Z","bug_reporter_agreed_on_going_public_at":"2018-04-10T01:14:04.563Z","team_member_agreed_on_going_public_at":"2018-05-03T04:47:17.434Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary:\n======\nThis may be low risk impact but I need to suggest on improvement on your existing rate-limit protection on the registration page, It is an easy workaround and make the current protection more secure.\n\nDescription:\n========\nUnikrn increases the registration security by requiring user to enter a secured password and providing a rate limit on registration, after several attempt the server denies over-registration by returning \"Suspicious Activity - Multiple Accounts Detected. Please contact support at support@unikrn.com with further questions\". However the rate limit get executed in the last stage of the registration process, still allows the attacker to enumerate account on this page. \n\nSteps To Reproduce:\n==============\n1. Go to https://unikrn.com/ and click \"Sign up\"\n2. Fill in the registration form\n3. Upon submitting the form, use proxy (burp) to intercept the connection and send to repeater\n\nAfter the research - except the normal successfully registration, we can categorize the server responses into 3 cases (in the following log from burp repeater):\n\nRequest/Response Case 1 - Existing email with secured password, the server returns message \"Email address already registered\":\n\n[REQUEST]:\nPOST /apiv1/register HTTP/1.1\nHost: unikrn.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nReferer: https://unikrn.com/\nContent-Type: application/json\nApplication-Version: v3.8.5-28-g570b4be\nContent-Length: 161\nCookie: [Long Cookie CUT]\nConnection: close\n\n{\"email_address\":\"hackerone1@gmail.com\",\"day\":\"1\",\"month\":\"1\",\"year\":\"1999\",\"state\":null,\"password\":\"a12345678\",\"password_confirm\":\"a12345678\",\"session_id\":null}\n\n[RESPONSE]:\nHTTP/1.1 200 OK\nDate: Thu, 24 Aug 2017 02:38:22 GMT\nContent-Type: application/json\nConnection: close\nAccess-Control-Max-Age: 86400\nCache-Control: no-store, no-cache, must-revalidate\nCI: M-production C-1 V-1.2.0\nContent-Security-Policy: default-src 'none'; frame-ancestors 'none'\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nSet-Cookie: CW=ghocb7rti601hf8k9valkk6r0mq2fua2; expires=Sun, 03-Sep-2017 02:38:22 GMT; Max-Age=864000; path=/; domain=.unikrn.com; secure; HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nVary: Accept-Encoding\nVary: Origin\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3932ef5ab9ab3198-SIN\nContent-Length: 174\n\n{\"error\":true,\"success\":false,\"msg\":\"Email address already registered.\",\"msg_trans\":\"Email address already registered.\",\"data\":null,\"code\":124,\"flds\":null,\"flds_errors\":null}\n\nRequest/Response Case 2 - Non-Existence email with secured password - after several attempts the server block the registration by sending the message \"Suspicious Activity - Multiple Accounts Detected. Please contact support at support@unikrn.com with further questions\".\n\n[REQUEST - header omitted]:\n\n{\"email_address\":\"hackerone9@gmail.com\",\"day\":\"1\",\"month\":\"1\",\"year\":\"1999\",\"state\":null,\"password\":\"a12345678\",\"password_confirm\":\"a12345678\",\"session_id\":null}\n\n[RESPONSE - header omitted]:\n\n{\"success\": false, \"error\": true, \"msg\": \"Suspicious Activity - Multiple Accounts Detected. Please contact support at support@unikrn.com with further questions.\", \"msg_trans\": \"Suspicious Activity - Multiple Accounts Detected. Please contact support at support@unikrn.com with further questions.\", \"code\": 0, \"flds\": null, \"data\": null}\n\nRequest/Response Case 3 - Non Existence with unsecured password - the server returns a message \"Password must be at least 8 characters long and contain one capital letter and one number\".\n\n[REQUEST - header omitted]\n\n{\"email_address\":\"hackerone9@gmail.com\",\"day\":\"1\",\"month\":\"1\",\"year\":\"1999\",\"state\":null,\"password\":\"12345678\",\"password_confirm\":\"12345678\",\"session_id\":null}\n\n[RESPONSE - header omitted]:\n\n{\"error\":true,\"success\":false,\"msg\":\"password_invalid\",\"msg_trans\":\"Password must be at least 8 characters long and contain one capital letter and one number.\",\"data\":null,\"code\":0,\"flds\":null,\"flds_errors\":null}\n\nAnalyze the registration process:\n=====================\nAs we can see from the server response, if we provide existing email the server responses \"Case 1\", if we provide non-existence email the server responses \"Case 2\" and \"Case 3\" just by the secured password condition: if we enter secured password Case 2 will be returned, else returns Case 3. From this we can analyze the registration process as:\n1. The user fill in the form and send data to the server\n2. The server receives request from the client and do the following task in order:\n- Check if email provided already in the database, if true -\u003e return Case 1 and end the process. (Impact: user enumeration)\n- Check if password provided are secured (one char+numbers = 8 chars min), if false -\u003e return Case 3 and end the process. (Impact: user enumeration)\n- [Rate-limit protection] Check if the attempt count reach limit, if true -\u003e return Case 2 and end the process. (Impact: user enumeration)\n- If the above test pass, register the new user and return successful page.\n\nRecommendation:\n============\nthe rate-limit protection must be place on the first stage of processing, this is to disable user enumeration attack:\n1. The user fill in the form and send data to the server\n2. The server receives request from the client and do the following task in order:\n- [Rate-limit protection] Check if the attempt count reach limit, if true -\u003e return Case 2 and end the process. (No user enumeration impact: not knowing whether the email are existing or not)\n- Check if email provided already in the database, if true -\u003e return Case 1 and end the process. \n- Check if password provided are secured (one char+numbers = 8 chars min), if false -\u003e return Case 3 and end the process. (Impact: user enumeration)\n- If the above test pass, register the new user and return successful page.\n\nOptional improvement:\n===============\n- There is no CSRF token / Captcha in the registration page, this make the enumeration process even easier.\n\nAs I say this may be low risk, but the fix is easy and increase more security on the existing protection scheme.\n\nRegards,\nTolo","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary:\u003c/h1\u003e\n\n\u003cp\u003eThis may be low risk impact but I need to suggest on improvement on your existing rate-limit protection on the registration page, It is an easy workaround and make the current protection more secure.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription:\u003c/h1\u003e\n\n\u003cp\u003eUnikrn increases the registration security by requiring user to enter a secured password and providing a rate limit on registration, after several attempt the server denies over-registration by returning \u0026quot;Suspicious Activity - Multiple Accounts Detected. Please contact support at \u003ca title=\"support@unikrn.com\" href=\"mailto:support@unikrn.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@unikrn.com\u003c/a\u003e with further questions\u0026quot;. However the rate limit get executed in the last stage of the registration process, still allows the attacker to enumerate account on this page. \u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://unikrn.com/\" href=\"/redirect?url=https%3A%2F%2Funikrn.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unikrn.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and click \u0026quot;Sign up\u0026quot;\u003c/li\u003e\n\u003cli\u003eFill in the registration form\u003c/li\u003e\n\u003cli\u003eUpon submitting the form, use proxy (burp) to intercept the connection and send to repeater\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAfter the research - except the normal successfully registration, we can categorize the server responses into 3 cases (in the following log from burp repeater):\u003c/p\u003e\n\n\u003cp\u003eRequest/Response Case 1 - Existing email with secured password, the server returns message \u0026quot;Email address already registered\u0026quot;:\u003c/p\u003e\n\n\u003cp\u003e[REQUEST]:\u003cbr\u003e\nPOST /apiv1/register HTTP/1.1\u003cbr\u003e\nHost: unikrn.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0\u003cbr\u003e\nAccept: application/json, text/plain, \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nReferer: \u003ca title=\"https://unikrn.com/\" href=\"/redirect?url=https%3A%2F%2Funikrn.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unikrn.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/json\u003cbr\u003e\nApplication-Version: v3.8.5-28-g570b4be\u003cbr\u003e\nContent-Length: 161\u003cbr\u003e\nCookie: [Long Cookie CUT]\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;email_address\u0026quot;:\u0026quot;\u003ca title=\"hackerone1@gmail.com\" href=\"mailto:hackerone1@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ehackerone1@gmail.com\u003c/a\u003e\u0026quot;,\u0026quot;day\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;month\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;1999\u0026quot;,\u0026quot;state\u0026quot;:null,\u0026quot;password\u0026quot;:\u0026quot;a12345678\u0026quot;,\u0026quot;password_confirm\u0026quot;:\u0026quot;a12345678\u0026quot;,\u0026quot;session_id\u0026quot;:null}\u003c/p\u003e\n\n\u003cp\u003e[RESPONSE]:\u003cbr\u003e\nHTTP/1.1 200 OK\u003cbr\u003e\nDate: Thu, 24 Aug 2017 02:38:22 GMT\u003cbr\u003e\nContent-Type: application/json\u003cbr\u003e\nConnection: close\u003cbr\u003e\nAccess-Control-Max-Age: 86400\u003cbr\u003e\nCache-Control: no-store, no-cache, must-revalidate\u003cbr\u003e\nCI: M-production C-1 V-1.2.0\u003cbr\u003e\nContent-Security-Policy: default-src \u0026#39;none\u0026#39;; frame-ancestors \u0026#39;none\u0026#39;\u003cbr\u003e\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\u003cbr\u003e\nPragma: no-cache\u003cbr\u003e\nSet-Cookie: CW=ghocb7rti601hf8k9valkk6r0mq2fua2; expires=Sun, 03-Sep-2017 02:38:22 GMT; Max-Age=864000; path=/; domain=.unikrn.com; secure; HttpOnly\u003cbr\u003e\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\u003cbr\u003e\nVary: Accept-Encoding\u003cbr\u003e\nVary: Origin\u003cbr\u003e\nX-XSS-Protection: 1; mode=block\u003cbr\u003e\nServer: cloudflare-nginx\u003cbr\u003e\nCF-RAY: 3932ef5ab9ab3198-SIN\u003cbr\u003e\nContent-Length: 174\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;error\u0026quot;:true,\u0026quot;success\u0026quot;:false,\u0026quot;msg\u0026quot;:\u0026quot;Email address already registered.\u0026quot;,\u0026quot;msg_trans\u0026quot;:\u0026quot;Email address already registered.\u0026quot;,\u0026quot;data\u0026quot;:null,\u0026quot;code\u0026quot;:124,\u0026quot;flds\u0026quot;:null,\u0026quot;flds_errors\u0026quot;:null}\u003c/p\u003e\n\n\u003cp\u003eRequest/Response Case 2 - Non-Existence email with secured password - after several attempts the server block the registration by sending the message \u0026quot;Suspicious Activity - Multiple Accounts Detected. Please contact support at \u003ca title=\"support@unikrn.com\" href=\"mailto:support@unikrn.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@unikrn.com\u003c/a\u003e with further questions\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003e[REQUEST - header omitted]:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;email_address\u0026quot;:\u0026quot;\u003ca title=\"hackerone9@gmail.com\" href=\"mailto:hackerone9@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ehackerone9@gmail.com\u003c/a\u003e\u0026quot;,\u0026quot;day\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;month\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;1999\u0026quot;,\u0026quot;state\u0026quot;:null,\u0026quot;password\u0026quot;:\u0026quot;a12345678\u0026quot;,\u0026quot;password_confirm\u0026quot;:\u0026quot;a12345678\u0026quot;,\u0026quot;session_id\u0026quot;:null}\u003c/p\u003e\n\n\u003cp\u003e[RESPONSE - header omitted]:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: true, \u0026quot;msg\u0026quot;: \u0026quot;Suspicious Activity - Multiple Accounts Detected. Please contact support at \u003ca title=\"support@unikrn.com\" href=\"mailto:support@unikrn.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@unikrn.com\u003c/a\u003e with further questions.\u0026quot;, \u0026quot;msg_trans\u0026quot;: \u0026quot;Suspicious Activity - Multiple Accounts Detected. Please contact support at \u003ca title=\"support@unikrn.com\" href=\"mailto:support@unikrn.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@unikrn.com\u003c/a\u003e with further questions.\u0026quot;, \u0026quot;code\u0026quot;: 0, \u0026quot;flds\u0026quot;: null, \u0026quot;data\u0026quot;: null}\u003c/p\u003e\n\n\u003cp\u003eRequest/Response Case 3 - Non Existence with unsecured password - the server returns a message \u0026quot;Password must be at least 8 characters long and contain one capital letter and one number\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003e[REQUEST - header omitted]\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;email_address\u0026quot;:\u0026quot;\u003ca title=\"hackerone9@gmail.com\" href=\"mailto:hackerone9@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ehackerone9@gmail.com\u003c/a\u003e\u0026quot;,\u0026quot;day\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;month\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;1999\u0026quot;,\u0026quot;state\u0026quot;:null,\u0026quot;password\u0026quot;:\u0026quot;12345678\u0026quot;,\u0026quot;password_confirm\u0026quot;:\u0026quot;12345678\u0026quot;,\u0026quot;session_id\u0026quot;:null}\u003c/p\u003e\n\n\u003cp\u003e[RESPONSE - header omitted]:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;error\u0026quot;:true,\u0026quot;success\u0026quot;:false,\u0026quot;msg\u0026quot;:\u0026quot;password_invalid\u0026quot;,\u0026quot;msg_trans\u0026quot;:\u0026quot;Password must be at least 8 characters long and contain one capital letter and one number.\u0026quot;,\u0026quot;data\u0026quot;:null,\u0026quot;code\u0026quot;:0,\u0026quot;flds\u0026quot;:null,\u0026quot;flds_errors\u0026quot;:null}\u003c/p\u003e\n\n\u003ch1 id=\"analyze-the-registration-process\"\u003eAnalyze the registration process:\u003c/h1\u003e\n\n\u003cp\u003eAs we can see from the server response, if we provide existing email the server responses \u0026quot;Case 1\u0026quot;, if we provide non-existence email the server responses \u0026quot;Case 2\u0026quot; and \u0026quot;Case 3\u0026quot; just by the secured password condition: if we enter secured password Case 2 will be returned, else returns Case 3. From this we can analyze the registration process as:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe user fill in the form and send data to the server\u003c/li\u003e\n\u003cli\u003eThe server receives request from the client and do the following task in order:\u003c/li\u003e\n\u003cli\u003eCheck if email provided already in the database, if true -\u0026gt; return Case 1 and end the process. (Impact: user enumeration)\u003c/li\u003e\n\u003cli\u003eCheck if password provided are secured (one char+numbers = 8 chars min), if false -\u0026gt; return Case 3 and end the process. (Impact: user enumeration)\u003c/li\u003e\n\u003cli\u003e[Rate-limit protection] Check if the attempt count reach limit, if true -\u0026gt; return Case 2 and end the process. (Impact: user enumeration)\u003c/li\u003e\n\u003cli\u003eIf the above test pass, register the new user and return successful page.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"recommendation\"\u003eRecommendation:\u003c/h1\u003e\n\n\u003cp\u003ethe rate-limit protection must be place on the first stage of processing, this is to disable user enumeration attack:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe user fill in the form and send data to the server\u003c/li\u003e\n\u003cli\u003eThe server receives request from the client and do the following task in order:\u003c/li\u003e\n\u003cli\u003e[Rate-limit protection] Check if the attempt count reach limit, if true -\u0026gt; return Case 2 and end the process. (No user enumeration impact: not knowing whether the email are existing or not)\u003c/li\u003e\n\u003cli\u003eCheck if email provided already in the database, if true -\u0026gt; return Case 1 and end the process. \u003c/li\u003e\n\u003cli\u003eCheck if password provided are secured (one char+numbers = 8 chars min), if false -\u0026gt; return Case 3 and end the process. (Impact: user enumeration)\u003c/li\u003e\n\u003cli\u003eIf the above test pass, register the new user and return successful page.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"optional-improvement\"\u003eOptional improvement:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eThere is no CSRF token / Captcha in the registration page, this make the enumeration process even easier.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAs I say this may be low risk, but the fix is easy and increase more security on the existing protection scheme.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nTolo\u003c/p\u003e\n","bounty_amount":"30.0","formatted_bounty":"$30","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-10T01:14:04.645Z","allow_singular_disclosure_after":-83304096.8853468,"singular_disclosure_allowed":true,"vote_count":5,"voters":["tolo7010","eveeez","apapedulimu","an0nym0us","albatraoz"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":453,"asset_type":"URL","asset_identifier":"unikrn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1950863,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-24T03:33:01.917Z","updated_at":"2017-08-24T03:33:01.917Z","additional_data":{"old_title":"Rate-limit protection get executed in the last stage of the registration process, allows enumerating of existing account.","new_title":"Rate-limit protection get executed in the last stage of the registration process, allowing enumeration of existing account."},"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1954371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any updates?","markdown_message":"\u003cp\u003eany updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-25T13:02:58.966Z","updated_at":"2017-08-25T13:02:58.966Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1954774,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thx, there is an open ticket about rate limit improvements, this is one part where they are needed. We will work on this over the next weeks.","markdown_message":"\u003cp\u003eThx, there is an open ticket about rate limit improvements, this is one part where they are needed. We will work on this over the next weeks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-25T15:04:14.684Z","updated_at":"2017-08-25T15:04:14.684Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1958783,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Similar rate-limit protection get executed in the last stage (Optional Improvement):\n=====================================================\n\nNote: This is optional improvement as this may be a best practice than a vulnerabilty.\n\nHi @decrypted ,\nThe \"invite friend\" button does also have rate-limit protection execute later:\n- After several attempt to send invitation, the server response:\n\n{\"error\":true,\"success\":false,\"msg\":\"try_again_later\",\"msg_trans\":\"try_again_later\",\"data\":null,\"code\":135,\"flds\":null,\"flds_errors\":null}\n\n- this indicates the rate-limit, the request message JSON contains session_id:\n\n{\"email\":\"aa@a.com\",\"session_id\":\"291cn7m3l57pjdcslk53vdivk91uaei3\"}\n\n- if we change session_id to an invalid one, we got message:\n\n{\"error\":true,\"success\":false,\"msg\":\"missing_user\",\"msg_trans\":\"missing_user\",\"data\":null,\"code\":130,\"flds\":null,\"flds_errors\":null}\n\n- this indicates that the session_id check before rate-limit protection, as currently this is not possible to brute-force session_id, this may be a best practice - the server may consume less processing cost by moving rate-limit protection at the first stage.\n\nStep to Reproduce:\n=============\n1. Login to the site.\n2. Go to https://unikrn.com/profile#overview\n3. In the \"earn more unikoins\" section, fill in the invite email and use burp proxy to intercept while clicking the invite button.\n4. Send to the repeater to inspect the request/response.\n\nRegards,\nTolo","markdown_message":"\u003ch1 id=\"similar-rate-limit-protection-get-executed-in-the-last-stage-optional-improvement\"\u003eSimilar rate-limit protection get executed in the last stage (Optional Improvement):\u003c/h1\u003e\n\n\u003cp\u003eNote: This is optional improvement as this may be a best practice than a vulnerabilty.\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/decrypted\"\u003e@decrypted\u003c/a\u003e ,\u003cbr\u003e\nThe \u0026quot;invite friend\u0026quot; button does also have rate-limit protection execute later:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAfter several attempt to send invitation, the server response:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e{\u0026quot;error\u0026quot;:true,\u0026quot;success\u0026quot;:false,\u0026quot;msg\u0026quot;:\u0026quot;try_again_later\u0026quot;,\u0026quot;msg_trans\u0026quot;:\u0026quot;try_again_later\u0026quot;,\u0026quot;data\u0026quot;:null,\u0026quot;code\u0026quot;:135,\u0026quot;flds\u0026quot;:null,\u0026quot;flds_errors\u0026quot;:null}\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ethis indicates the rate-limit, the request message JSON contains session_id:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e{\u0026quot;email\u0026quot;:\u0026quot;\u003ca title=\"aa@a.com\" href=\"mailto:aa@a.com\" rel=\"nofollow noopener noreferrer\"\u003eaa@a.com\u003c/a\u003e\u0026quot;,\u0026quot;session_id\u0026quot;:\u0026quot;291cn7m3l57pjdcslk53vdivk91uaei3\u0026quot;}\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eif we change session_id to an invalid one, we got message:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e{\u0026quot;error\u0026quot;:true,\u0026quot;success\u0026quot;:false,\u0026quot;msg\u0026quot;:\u0026quot;missing_user\u0026quot;,\u0026quot;msg_trans\u0026quot;:\u0026quot;missing_user\u0026quot;,\u0026quot;data\u0026quot;:null,\u0026quot;code\u0026quot;:130,\u0026quot;flds\u0026quot;:null,\u0026quot;flds_errors\u0026quot;:null}\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ethis indicates that the session_id check before rate-limit protection, as currently this is not possible to brute-force session_id, this may be a best practice - the server may consume less processing cost by moving rate-limit protection at the first stage.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"step-to-reproduce\"\u003eStep to Reproduce:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to the site.\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://unikrn.com/profile#overview\" href=\"/redirect?url=https%3A%2F%2Funikrn.com%2Fprofile%23overview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unikrn.com/profile#overview\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eIn the \u0026quot;earn more unikoins\u0026quot; section, fill in the invite email and use burp proxy to intercept while clicking the invite button.\u003c/li\u003e\n\u003cli\u003eSend to the repeater to inspect the request/response.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nTolo\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T02:41:34.349Z","updated_at":"2017-08-28T02:41:34.349Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1970361,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"\u003ethis indicates that the session_id check before rate-limit protection, as currently this is not possible to brute-force session_id, this may be a best practice - the server may consume less processing cost by moving rate-limit protection at the first stage.\n\nnot sure i follow - so the login check happens before everything. thats bad?\n\nps: kinda love how thorough your reports are. Lots of text still easy to follow.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003ethis indicates that the session_id check before rate-limit protection, as currently this is not possible to brute-force session_id, this may be a best practice - the server may consume less processing cost by moving rate-limit protection at the first stage.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003enot sure i follow - so the login check happens before everything. thats bad?\u003c/p\u003e\n\n\u003cp\u003eps: kinda love how thorough your reports are. Lots of text still easy to follow.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-01T06:39:58.723Z","updated_at":"2017-09-01T06:39:58.723Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1970421,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The rate-limit applies for the invitation but not for the login check, in this case the session ID is not bruteforcable - there is no vulnerability.\n\nIn the performance, the server has to query the database 2 times - one for checking the session and other for checking the rate-limit. If you switch the step, asumming you do rate-limit per IP -the server may only do one query.\n\nThis is optional as there is no security issues","markdown_message":"\u003cp\u003eThe rate-limit applies for the invitation but not for the login check, in this case the session ID is not bruteforcable - there is no vulnerability.\u003c/p\u003e\n\n\u003cp\u003eIn the performance, the server has to query the database 2 times - one for checking the session and other for checking the rate-limit. If you switch the step, asumming you do rate-limit per IP -the server may only do one query.\u003c/p\u003e\n\n\u003cp\u003eThis is optional as there is no security issues\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-01T07:32:35.607Z","updated_at":"2017-09-01T07:32:35.607Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2002083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@decrypted  any updates?\n\nRegards.","markdown_message":"\u003cp\u003e\u003ca href=\"/decrypted\"\u003e@decrypted\u003c/a\u003e  any updates?\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-17T13:08:22.314Z","updated_at":"2017-09-17T13:08:22.314Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2035031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if any updates available, thanks.\n\nRegards.","markdown_message":"\u003cp\u003ePlease let me know if any updates available, thanks.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-30T03:00:50.349Z","updated_at":"2017-09-30T03:00:50.349Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2051750,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any updates on this report? thanks.","markdown_message":"\u003cp\u003eany updates on this report? thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-08T09:41:34.530Z","updated_at":"2017-10-08T09:41:34.530Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2094447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"are there any updates available?\n\nRegards.","markdown_message":"\u003cp\u003eare there any updates available?\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-23T10:33:06.382Z","updated_at":"2017-10-23T10:33:06.382Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2162255,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-16T12:50:04.563Z","updated_at":"2017-11-16T12:50:04.563Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2162258,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"setting award - but we will work on this more general later still","markdown_message":"\u003cp\u003esetting award - but we will work on this more general later still\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-16T12:50:38.784Z","updated_at":"2017-11-16T12:50:38.784Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Unikrn"}},"bounty_amount":"30.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2162262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the bounty!\n\nRegards,","markdown_message":"\u003cp\u003ethanks for the bounty!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-16T12:52:55.253Z","updated_at":"2017-11-16T12:52:55.253Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2491665,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-14T12:42:41.176Z","updated_at":"2018-03-14T12:42:41.176Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2584415,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-10T01:14:04.604Z","updated_at":"2018-04-10T01:14:04.604Z","first_to_agree":true,"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2694431,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again!","markdown_message":"\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-03T04:47:17.495Z","updated_at":"2018-05-03T04:47:17.495Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2694432,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-03T04:47:17.614Z","updated_at":"2018-05-03T04:47:17.614Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}