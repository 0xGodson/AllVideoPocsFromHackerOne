{"id":59666,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTY2Ng==","url":"https://hackerone.com/reports/59666","title":"Unsafe usage of Host HTTP header in Concrete5 version 5.7.3.1","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-05-05T09:26:07.592Z","submitted_at":"2015-05-05T09:26:07.592Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"egix","url":"/egix","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-01-11T21:59:17.230Z","bug_reporter_agreed_on_going_public_at":"2016-05-27T18:28:57.545Z","team_member_agreed_on_going_public_at":"2018-01-11T21:59:17.144Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Concrete5 is affected by a design issue related to the Host HTTP header. Such header is being used to define the base URL for the application. Since the Host header can be arbitrarily manipulated by an attacker, this can have some security impacts.","vulnerability_information_html":"\u003cp\u003eConcrete5 is affected by a design issue related to the Host HTTP header. Such header is being used to define the base URL for the application. Since the Host header can be arbitrarily manipulated by an attacker, this can have some security impacts.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":36779,"file_name":"Concrete5-Host-Header.pdf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/036/779/2d35cf194f6a80513a8d3fe4a00086acff422ab9/Concrete5-Host-Header.pdf?response-content-disposition=attachment%3B%20filename%3D%22Concrete5-Host-Header.pdf%22%3B%20filename%2A%3DUTF-8%27%27Concrete5-Host-Header.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062927Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=c9696c23be015f34b48467d68f4444755f6ff83019b591e4ba47c55cb456affe","file_size":357888,"type":"application/pdf"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["kunal94"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":402294,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report, this seems valid.","markdown_message":"\u003cp\u003eThanks for your report, this seems valid.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-05T15:26:15.825Z","updated_at":"2015-05-05T15:26:15.825Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":640056,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This was resolved in the url resolver change. A site may now provide the canonical url host through their dashboard.","markdown_message":"\u003cp\u003eThis was resolved in the url resolver change. A site may now provide the canonical url host through their dashboard.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-31T20:16:36.943Z","updated_at":"2015-10-31T20:16:36.943Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"egix","url":"/egix"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":641898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"AFAICS by default the \"Canonical URL\" option is empty, and in these cases Concrete5 still uses the Host HTTP header to dynamically generate URLs within the web pages (tested on a fresh install of Concrete5 cloned from the official GitHub repository, version 5.7.5.3a1).\n\nThis means that a Concrete5 website is still vulnerable to this issue by default, and the user has to edit the \"Canonical URL\" option in order to prevent exploitation of this vulnerability.","markdown_message":"\u003cp\u003eAFAICS by default the \u0026quot;Canonical URL\u0026quot; option is empty, and in these cases Concrete5 still uses the Host HTTP header to dynamically generate URLs within the web pages (tested on a fresh install of Concrete5 cloned from the official GitHub repository, version 5.7.5.3a1).\u003c/p\u003e\n\n\u003cp\u003eThis means that a Concrete5 website is still vulnerable to this issue by default, and the user has to edit the \u0026quot;Canonical URL\u0026quot; option in order to prevent exploitation of this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T23:11:40.700Z","updated_at":"2015-11-02T23:11:40.700Z","actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":641945,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"[This code](https://github.com/concrete5/concrete5/blob/develop/web/concrete/src/Url/Resolver/CanonicalUrlResolver.php#L37-L46) adds the host and the scheme to the canonical url from the request if none is provided. We may be able to just remove this else statement and be done with it.\n\nI'm not sure if we can incorporate this backwards incompatible change in a minor or patch version release, I'll have to discuss this with some colleagues and get back to you.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fblob%2Fdevelop%2Fweb%2Fconcrete%2Fsrc%2FUrl%2FResolver%2FCanonicalUrlResolver.php%23L37-L46\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eThis code\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e adds the host and the scheme to the canonical url from the request if none is provided. We may be able to just remove this else statement and be done with it.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m not sure if we can incorporate this backwards incompatible change in a minor or patch version release, I\u0026#39;ll have to discuss this with some colleagues and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T23:52:56.708Z","updated_at":"2015-11-02T23:52:56.708Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":726376,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I'm going to leave this as informative. A user should secure this by configuring their webserver and concrete5 appropriately.","markdown_message":"\u003cp\u003eI\u0026#39;m going to leave this as informative. A user should secure this by configuring their webserver and concrete5 appropriately.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-18T23:20:14.231Z","updated_at":"2015-12-18T23:20:14.231Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":987821,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T18:28:57.565Z","updated_at":"2016-05-27T18:28:57.565Z","first_to_agree":true,"actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2279090,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T21:59:17.179Z","updated_at":"2018-01-11T21:59:17.179Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2279091,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T21:59:17.263Z","updated_at":"2018-01-11T21:59:17.263Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}