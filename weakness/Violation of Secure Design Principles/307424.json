{"id":307424,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDc0MjQ=","url":"https://hackerone.com/reports/307424","title":"While adding a payment method - Notification email not sent to newly added email ID as well as there is no verification for new email id (Paypal)","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2018-01-20T10:08:59.519Z","submitted_at":"2018-01-20T10:08:59.519Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"us111","url":"/us111","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-01-23T19:32:54.459Z","bug_reporter_agreed_on_going_public_at":"2018-01-20T18:32:30.280Z","team_member_agreed_on_going_public_at":"2018-01-23T19:32:54.344Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description:**\nAs you know hackerone allows us to add payout method. On selecting paypal we are asked to add paypal email id. On saving new email id. A hackerone account holder (i.e account from which payout method was changed) gets a notification email  saying that \"The payout method was changed form current_user@testmail.com\" to \"New_user@testmail.com\"\n\nNote: This message comes when user has checked the box for making this email id as default else a simple notification email is triggered saying a new payment method has recently added to your account.\n\nThis is the expected behavior and very correct.\n\nBut the issue is a user whose email id has been added is not notified, according to me this is not the correct flow. Even a user should be notified that this email id has been added for paypal by xyz person. So all further payments will receive to this email id.\n\nAccording to me the idle behaviour should be like whenever a user enters a new email address a verification code should be sent to that email address and after verifying only that email should be allowed. This is what i think and i believe.\n\nNow a question arises why anyone will enter any other person email address because its all about money.\n\nBut the answer is you never know what an attacker might be thinking. There may be n number of reasons doing this below are few\n\n1. On receiving bounty end user will be confused from where did this amount got deposited i never reported any vulnerability nor i have account on hackerone then y money got deposited to my account and may be he can lodge a complaint.\n\n2. Purposely deposit money money to make him pay more tax (i don't know abt other countries but in country like INDIA if money is coming from additional resource then Accountants asks for all proofs from where did money came and we need to show all of them and based on that we pay yearly taxes)\n\n### Steps To Reproduce\n\n1. Login into your hackerone account\n2. Goto Settings -\u003e Payment Methods -\u003e click on add payment method\n3. Add another email id for which you have access ( so that you can check for any notification emails) \n4.Save\n\nYou will notice notification emails are only triggered to your registered hackerone account and no notification email is sent to newly added account.\n\n### Optional: Your Environment (Browser version, Device, etc)\n Works in all browsers \n\n### Optional: Supporting Material/References (Screenshots)\n\n I have there is no need for any screenshots above steps are sufficient to reproduce it.\n\nNote: This mentioned issue is not a hack but it is a good practise and adding a verification for new email id would be defence in depth.\n\n## Impact\n\nAs mentioned above an attacker can use this in any way. We cannot guess what an attacker might think.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nAs you know hackerone allows us to add payout method. On selecting paypal we are asked to add paypal email id. On saving new email id. A hackerone account holder (i.e account from which payout method was changed) gets a notification email  saying that \u0026quot;The payout method was changed form \u003ca title=\"current_user@testmail.com\" href=\"mailto:current_user@testmail.com\" rel=\"nofollow noopener noreferrer\"\u003ecurrent_user@testmail.com\u003c/a\u003e\u0026quot; to \u0026quot;\u003ca title=\"New_user@testmail.com\" href=\"mailto:New_user@testmail.com\" rel=\"nofollow noopener noreferrer\"\u003eNew_user@testmail.com\u003c/a\u003e\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eNote: This message comes when user has checked the box for making this email id as default else a simple notification email is triggered saying a new payment method has recently added to your account.\u003c/p\u003e\n\n\u003cp\u003eThis is the expected behavior and very correct.\u003c/p\u003e\n\n\u003cp\u003eBut the issue is a user whose email id has been added is not notified, according to me this is not the correct flow. Even a user should be notified that this email id has been added for paypal by xyz person. So all further payments will receive to this email id.\u003c/p\u003e\n\n\u003cp\u003eAccording to me the idle behaviour should be like whenever a user enters a new email address a verification code should be sent to that email address and after verifying only that email should be allowed. This is what i think and i believe.\u003c/p\u003e\n\n\u003cp\u003eNow a question arises why anyone will enter any other person email address because its all about money.\u003c/p\u003e\n\n\u003cp\u003eBut the answer is you never know what an attacker might be thinking. There may be n number of reasons doing this below are few\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eOn receiving bounty end user will be confused from where did this amount got deposited i never reported any vulnerability nor i have account on hackerone then y money got deposited to my account and may be he can lodge a complaint.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ePurposely deposit money money to make him pay more tax (i don\u0026#39;t know abt other countries but in country like INDIA if money is coming from additional resource then Accountants asks for all proofs from where did money came and we need to show all of them and based on that we pay yearly taxes)\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin into your hackerone account\u003c/li\u003e\n\u003cli\u003eGoto Settings -\u0026gt; Payment Methods -\u0026gt; click on add payment method\u003c/li\u003e\n\u003cli\u003eAdd another email id for which you have access ( so that you can check for any notification emails) \n4.Save\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou will notice notification emails are only triggered to your registered hackerone account and no notification email is sent to newly added account.\u003c/p\u003e\n\n\u003ch3 id=\"optional-your-environment-browser-version-device-etc\"\u003eOptional: Your Environment (Browser version, Device, etc)\u003c/h3\u003e\n\n\u003cp\u003eWorks in all browsers \u003c/p\u003e\n\n\u003ch3 id=\"optional-supporting-material-references-screenshots\"\u003eOptional: Supporting Material/References (Screenshots)\u003c/h3\u003e\n\n\u003cp\u003eI have there is no need for any screenshots above steps are sufficient to reproduce it.\u003c/p\u003e\n\n\u003cp\u003eNote: This mentioned issue is not a hack but it is a good practise and adding a verification for new email id would be defence in depth.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAs mentioned above an attacker can use this in any way. We cannot guess what an attacker might think.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["bl4de","khizer47","cr4xerbik4sh","a8eight","dyabla","thetroubledone","benurr-sa23","dave89"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2303599,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi,\n\nThank you for your submission. At this time we have determined that the current behavior doesn't represent an immediate risk due to its low impact. We appreciate the suggestion, but it will not be eligible under our bug bounty program. Please continue to send us bug reports.\n\nRegards.\n@joystick","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. At this time we have determined that the current behavior doesn\u0026#39;t represent an immediate risk due to its low impact. We appreciate the suggestion, but it will not be eligible under our bug bounty program. Please continue to send us bug reports.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003cbr\u003e\n\u003ca href=\"/joystick\"\u003e@joystick\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T14:19:33.489Z","updated_at":"2018-01-20T14:19:33.489Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2303636,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i hope if hackerone decide to fix this then it will be considered for a bounty..thanks","markdown_message":"\u003cp\u003ei hope if hackerone decide to fix this then it will be considered for a bounty..thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T14:50:08.496Z","updated_at":"2018-01-20T14:54:08.318Z","actor":{"username":"us111","cleared":false,"url":"/us111","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2303659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we have public disclosure for this..??","markdown_message":"\u003cp\u003eCan we have public disclosure for this..??\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T14:54:29.231Z","updated_at":"2018-01-20T14:54:29.231Z","actor":{"username":"us111","cleared":false,"url":"/us111","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2303901,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If you believe this is not an issue that you would like to fix then i request you to disclose it publically else patch it.","markdown_message":"\u003cp\u003eIf you believe this is not an issue that you would like to fix then i request you to disclose it publically else patch it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T18:32:30.313Z","updated_at":"2018-01-20T18:32:30.313Z","first_to_agree":true,"actor":{"username":"us111","cleared":false,"url":"/us111","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306098,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on public disclosure..??","markdown_message":"\u003cp\u003eAny update on public disclosure..??\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T09:57:24.507Z","updated_at":"2018-01-22T09:57:24.507Z","actor":{"username":"us111","cleared":false,"url":"/us111","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2308189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @us111 - I'm curious why you'd want to be public. In which world would the person receiving the money need a heads up that his email address is now used to pay out bounties? I actually think @joystick was rather kind by closing this as Informative because in my opinion this is not a security risk at all. Can you elaborate?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/us111\"\u003e@us111\u003c/a\u003e - I\u0026#39;m curious why you\u0026#39;d want to be public. In which world would the person receiving the money need a heads up that his email address is now used to pay out bounties? I actually think \u003ca href=\"/joystick\"\u003e@joystick\u003c/a\u003e was rather kind by closing this as Informative because in my opinion this is not a security risk at all. Can you elaborate?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T20:47:34.204Z","updated_at":"2018-01-22T20:47:34.204Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2311268,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert - Reading your response i am confident that you have interpreted this report in an incorrect way. So i request you to read above report once again please. \n\nSince you are looking into this report i will again try to explain once again.\n\nHere me as an attacker is able to add anyone's email id in payout method (paypal) irrespective of victim is a hackerone registered member or not .\n\nFor example on selecting payment method as paypal i can add new email id as Victim@gmail.com but here victim is aware that i have set his email id for receiving payment.\n\nHere at 1st point hackerone is directly allowing to add any email id without verifying nor hackerone is notifying that person via email.\n\nNow lets see impact\n\n@jobert here we are doing a setting change which has something to do with money and whenever there is some change related to payments both accounts should be notified.\n\nIf me as an attacker wants some legal action or penalty for Victim@gmail.com i can set payment method to his email id. As already stated in countries like india income tax laws has become very strict, if a person does not show his total income while paying taxes their is a huge penalty.\n\nSo this is how i think notifying a newly added email id (for payment method) is must. I believe whatever i have said is correct and valid.  I hope you will read both (my initial submission and this revert) once again.\n\n@jobert now regarding public disclosure: If you think this is not a valid point and you are not going to fix then why not to disclose it because according to me its valid. If you allow me i will tweet about it and ask people opinion on this. \n\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e - Reading your response i am confident that you have interpreted this report in an incorrect way. So i request you to read above report once again please. \u003c/p\u003e\n\n\u003cp\u003eSince you are looking into this report i will again try to explain once again.\u003c/p\u003e\n\n\u003cp\u003eHere me as an attacker is able to add anyone\u0026#39;s email id in payout method (paypal) irrespective of victim is a hackerone registered member or not .\u003c/p\u003e\n\n\u003cp\u003eFor example on selecting payment method as paypal i can add new email id as \u003ca title=\"Victim@gmail.com\" href=\"mailto:Victim@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eVictim@gmail.com\u003c/a\u003e but here victim is aware that i have set his email id for receiving payment.\u003c/p\u003e\n\n\u003cp\u003eHere at 1st point hackerone is directly allowing to add any email id without verifying nor hackerone is notifying that person via email.\u003c/p\u003e\n\n\u003cp\u003eNow lets see impact\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e here we are doing a setting change which has something to do with money and whenever there is some change related to payments both accounts should be notified.\u003c/p\u003e\n\n\u003cp\u003eIf me as an attacker wants some legal action or penalty for \u003ca title=\"Victim@gmail.com\" href=\"mailto:Victim@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eVictim@gmail.com\u003c/a\u003e i can set payment method to his email id. As already stated in countries like india income tax laws has become very strict, if a person does not show his total income while paying taxes their is a huge penalty.\u003c/p\u003e\n\n\u003cp\u003eSo this is how i think notifying a newly added email id (for payment method) is must. I believe whatever i have said is correct and valid.  I hope you will read both (my initial submission and this revert) once again.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e now regarding public disclosure: If you think this is not a valid point and you are not going to fix then why not to disclose it because according to me its valid. If you allow me i will tweet about it and ask people opinion on this. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T19:27:56.830Z","updated_at":"2018-01-23T19:27:56.830Z","actor":{"username":"us111","cleared":false,"url":"/us111","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2311279,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@us111 I understand your report, but I still disagree. PayPal will notify the user when they've received money, so I don't think your concerns are valid. If what you say is true, an attacker would be able to send money to a random person in India right now and it would get them in trouble. Someone doesn't need HackerOne to do that. I'm happy to disclose this. Happy hacking!","markdown_message":"\u003cp\u003e\u003ca href=\"/us111\"\u003e@us111\u003c/a\u003e I understand your report, but I still disagree. PayPal will notify the user when they\u0026#39;ve received money, so I don\u0026#39;t think your concerns are valid. If what you say is true, an attacker would be able to send money to a random person in India right now and it would get them in trouble. Someone doesn\u0026#39;t need HackerOne to do that. I\u0026#39;m happy to disclose this. Happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T19:32:48.279Z","updated_at":"2018-01-23T19:32:48.279Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2311281,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-23T19:32:54.380Z","updated_at":"2018-01-23T19:32:54.380Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2311282,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-23T19:32:54.506Z","updated_at":"2018-01-23T19:32:54.506Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}