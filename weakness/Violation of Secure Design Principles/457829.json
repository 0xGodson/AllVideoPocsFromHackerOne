{"id":457829,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTc4Mjk=","url":"https://hackerone.com/reports/457829","title":"SPF Records (SMTP protection not used)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-07T06:51:28.898Z","submitted_at":"2018-12-07T06:51:28.898Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shantanu_kul","url":"/shantanu_kul","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22750,"url":"https://hackerone.com/mycrypto","handle":"mycrypto","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"MyCrypto","twitter_handle":"mycrypto","website":"https://mycrypto.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-12-17T22:02:19.091Z","bug_reporter_agreed_on_going_public_at":"2018-12-17T22:02:19.030Z","team_member_agreed_on_going_public_at":"2018-12-10T16:22:25.077Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello MyCrypto Team ,\n\nI am checking your website and found something is missing in SPF record.I don't find you have applied strict SMTP policy to stop spoofed email sending from your domain.\n\nI would like to recommend you to read the following article :\n\nhttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\n\nProblem description :\n\nThe above article strictly guide us about difference between soft mail and fail. MyCrypto should use fail because Soft mail allows anyone to send spoofed emails from your domains.\n\nIn your SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using ~ , you should use -\n\nFIX :\n\nYour SPF record : v=spf1 include:_spf.google.com ~all \n\nIt should be : v=spf1 include:_spf.google.com -all \n\nBest Regards ,\n\nShantanu\n\n## Impact\n\nAn attacker can send a Fake email from support@mycrypto.com saying that Please change your password, The victim is aware or not of phishing attacks, But when he sees that the mail originated from support@mycrypto.com , then he can blindly believe on it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his PayPal id and password (SESSION COOKIE). \nLater results are more harmful.\n\n\u003c?php\n$to = \"VICTIM@example.com\";\n$subject = \"Password Change\";\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\n$headers = \"From: support@mycrypto.com\";\nmail($to,$subject,$txt,$headers);\n?\u003e","vulnerability_information_html":"\u003cp\u003eHello MyCrypto Team ,\u003c/p\u003e\n\n\u003cp\u003eI am checking your website and found something is missing in SPF record.I don\u0026#39;t find you have applied strict SMTP policy to stop spoofed email sending from your domain.\u003c/p\u003e\n\n\u003cp\u003eI would like to recommend you to read the following article :\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eProblem description :\u003c/p\u003e\n\n\u003cp\u003eThe above article strictly guide us about difference between soft mail and fail. MyCrypto should use fail because Soft mail allows anyone to send spoofed emails from your domains.\u003c/p\u003e\n\n\u003cp\u003eIn your SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using ~ , you should use -\u003c/p\u003e\n\n\u003cp\u003eFIX :\u003c/p\u003e\n\n\u003cp\u003eYour SPF record : v=spf1 include:_spf.google.com ~all \u003c/p\u003e\n\n\u003cp\u003eIt should be : v=spf1 include:_spf.google.com -all \u003c/p\u003e\n\n\u003cp\u003eBest Regards ,\u003c/p\u003e\n\n\u003cp\u003eShantanu\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can send a Fake email from \u003ca title=\"support@mycrypto.com\" href=\"mailto:support@mycrypto.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@mycrypto.com\u003c/a\u003e saying that Please change your password, The victim is aware or not of phishing attacks, But when he sees that the mail originated from \u003ca title=\"support@mycrypto.com\" href=\"mailto:support@mycrypto.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@mycrypto.com\u003c/a\u003e , then he can blindly believe on it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his PayPal id and password (SESSION COOKIE). \u003cbr\u003e\nLater results are more harmful.\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;?php\u003cbr\u003e\n$to = \u0026quot;\u003ca title=\"VICTIM@example.com\" href=\"mailto:VICTIM@example.com\" rel=\"nofollow noopener noreferrer\"\u003eVICTIM@example.com\u003c/a\u003e\u0026quot;;\u003cbr\u003e\n$subject = \u0026quot;Password Change\u0026quot;;\u003cbr\u003e\n$txt = \u0026quot;Change your password by visiting here - [VIRUS LINK HERE]l\u0026quot;;\u003cbr\u003e\n$headers = \u0026quot;From: \u003ca title=\"support@mycrypto.com\" href=\"mailto:support@mycrypto.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@mycrypto.com\u003c/a\u003e\u0026quot;;\u003cbr\u003e\nmail($to,$subject,$txt,$headers);\u003cbr\u003e\n?\u0026gt;\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["sameerphad72","mygf","barsainya","cryptographer","securityb0y","shantanu_kul","reppie","saurabhmeher"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6528,"asset_type":"URL","asset_identifier":"www.mycrypto.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3782831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One Typing mistake in Impact :\n\nClicking on the link takes him to a website where certain JavaScript is executed which steals his \"MyCrypto \" id and password (SESSION COOKIE). ","markdown_message":"\u003cp\u003eOne Typing mistake in Impact :\u003c/p\u003e\n\n\u003cp\u003eClicking on the link takes him to a website where certain JavaScript is executed which steals his \u0026quot;MyCrypto \u0026quot; id and password (SESSION COOKIE). \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-07T08:04:52.779Z","updated_at":"2018-12-07T08:04:52.779Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3785581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Shankul,\n\nWe're looking into this, thanks for your report! You should hear back from us by the end-of-day.\n\nMichael Hahn","markdown_message":"\u003cp\u003eHey Shankul,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re looking into this, thanks for your report! You should hear back from us by the end-of-day.\u003c/p\u003e\n\n\u003cp\u003eMichael Hahn\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-07T13:12:12.585Z","updated_at":"2018-12-07T13:12:12.585Z","actor":{"username":"blurpesec","cleared":false,"url":"/blurpesec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3787637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.!","markdown_message":"\u003cp\u003eThank you.!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-07T19:24:17.843Z","updated_at":"2018-12-07T19:24:17.843Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3791403,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey Shankul, thanks again for the heads up. Would you be willing to verify that this has been triaged?","markdown_message":"\u003cp\u003eHey Shankul, thanks again for the heads up. Would you be willing to verify that this has been triaged?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-08T21:38:26.139Z","updated_at":"2018-12-08T21:38:26.139Z","actor":{"username":"blurpesec","cleared":false,"url":"/blurpesec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3791832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey ,\nIt looks like this is fixed now.\n\nv=spf1 include:_spf.google.com -all  \n\nGreat!!!","markdown_message":"\u003cp\u003eHey ,\u003cbr\u003e\nIt looks like this is fixed now.\u003c/p\u003e\n\n\u003cp\u003ev=spf1 include:_spf.google.com -all  \u003c/p\u003e\n\n\u003cp\u003eGreat!!!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-09T03:57:11.200Z","updated_at":"2018-12-09T03:57:11.200Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3791866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is this eligible for any bounty?","markdown_message":"\u003cp\u003eIs this eligible for any bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-09T04:37:42.718Z","updated_at":"2018-12-09T04:37:42.718Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3798583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we have update on this?","markdown_message":"\u003cp\u003eCan we have update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-10T14:49:40.419Z","updated_at":"2018-12-10T14:49:40.419Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3798962,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey again Shankul. Sorry, this is not eligible for a bounty at this time. Would you like us to publicly disclose this?","markdown_message":"\u003cp\u003eHey again Shankul. Sorry, this is not eligible for a bounty at this time. Would you like us to publicly disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-10T15:57:13.050Z","updated_at":"2018-12-10T15:57:13.050Z","actor":{"username":"blurpesec","cleared":false,"url":"/blurpesec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"shantanu_kul","url":"/shantanu_kul"},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3798978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok.please go forward and disclose the report.","markdown_message":"\u003cp\u003eOk.please go forward and disclose the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-10T16:00:10.083Z","updated_at":"2018-12-10T16:00:10.083Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3799245,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-10T16:22:25.131Z","updated_at":"2018-12-10T16:22:25.131Z","first_to_agree":true,"actor":{"username":"blurpesec","cleared":false,"url":"/blurpesec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3842781,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-17T22:02:19.055Z","updated_at":"2018-12-17T22:02:19.055Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3842782,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-17T22:02:19.113Z","updated_at":"2018-12-17T22:02:19.113Z","actor":{"username":"shantanu_kul","cleared":false,"url":"/shantanu_kul","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/140/527c0927483543c5007c9befb4bc62c9b12f91a5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}