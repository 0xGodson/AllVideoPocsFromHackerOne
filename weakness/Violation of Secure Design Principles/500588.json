{"id":500588,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDA1ODg=","url":"https://hackerone.com/reports/500588","title":"Security headers missed on https://acme-validation.jamieweb.net/","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-02-24T21:33:45.456Z","submitted_at":"2019-02-24T21:33:45.456Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mik317","url":"/mik317","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24397,"url":"https://hackerone.com/jamieweb","handle":"jamieweb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"JamieWeb","twitter_handle":"jamieweb","website":"https://www.jamieweb.net","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-03-28T00:51:43.017Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-02-26T00:51:36.346Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi JamieWeb team,\nthe `https://acme-validation.jamieweb.net/` domain doesn't present some important security headers.\nThe `X-DNS-Prefetch-Control` header isn't specified with value `off`, so is enabled b default on modern web browsers, and can lead to `information disclosure` ((https://security.stackexchange.com/questions/121796/what-security-implications-does-dns-prefetching-have). \nAdditionally, the `X-Download-Options` isn't present, while a good security implication would be `noopen` (here is explained why is important in certain circumstances: https://github.com/Fyrd/caniuse/issues/3388). \nFinally, the `Public-Key-Pins header` isn't present. It is very helpful because tells to the web browser to associate a public key with a certain web server to prevent `MITM attacks` using `rogue and forged X.509 certificates`. This protects users in case a certificate authority is compromised. Is useful also for the validation of the `SSL` certificate.\n\n## Steps To Reproduce:\n  1. Add a `X-DNS-Prefetch-Control: off` header\n  1. Add a `X-Download-Options: noopen` header\n  1. Add a `Public-Key-Pins` header (for calculate its value follow the https://scotthelme.co.uk/hpkp-http-public-key-pinning/ article)\n\nIf you don't consider this a valid issue, let me know it and I'l autoclose by myself as N/A :)\n\n## Impact\n\nSome security headers missed can lead to prevention of certain attacks that can be exploited using reflected attacks in the local network either in remote contexts.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHi JamieWeb team,\u003cbr\u003e\nthe \u003ccode\u003ehttps://acme-validation.jamieweb.net/\u003c/code\u003e domain doesn\u0026#39;t present some important security headers.\u003cbr\u003e\nThe \u003ccode\u003eX-DNS-Prefetch-Control\u003c/code\u003e header isn\u0026#39;t specified with value \u003ccode\u003eoff\u003c/code\u003e, so is enabled b default on modern web browsers, and can lead to \u003ccode\u003einformation disclosure\u003c/code\u003e ((\u003ca title=\"https://security.stackexchange.com/questions/121796/what-security-implications-does-dns-prefetching-have\" href=\"/redirect?url=https%3A%2F%2Fsecurity.stackexchange.com%2Fquestions%2F121796%2Fwhat-security-implications-does-dns-prefetching-have\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security.stackexchange.com/questions/121796/what-security-implications-does-dns-prefetching-have\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). \u003cbr\u003e\nAdditionally, the \u003ccode\u003eX-Download-Options\u003c/code\u003e isn\u0026#39;t present, while a good security implication would be \u003ccode\u003enoopen\u003c/code\u003e (here is explained why is important in certain circumstances: \u003ca title=\"https://github.com/Fyrd/caniuse/issues/3388\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFyrd%2Fcaniuse%2Fissues%2F3388\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/Fyrd/caniuse/issues/3388\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). \u003cbr\u003e\nFinally, the \u003ccode\u003ePublic-Key-Pins header\u003c/code\u003e isn\u0026#39;t present. It is very helpful because tells to the web browser to associate a public key with a certain web server to prevent \u003ccode\u003eMITM attacks\u003c/code\u003e using \u003ccode\u003erogue and forged X.509 certificates\u003c/code\u003e. This protects users in case a certificate authority is compromised. Is useful also for the validation of the \u003ccode\u003eSSL\u003c/code\u003e certificate.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAdd a \u003ccode\u003eX-DNS-Prefetch-Control: off\u003c/code\u003e header\u003c/li\u003e\n\u003cli\u003eAdd a \u003ccode\u003eX-Download-Options: noopen\u003c/code\u003e header\u003c/li\u003e\n\u003cli\u003eAdd a \u003ccode\u003ePublic-Key-Pins\u003c/code\u003e header (for calculate its value follow the \u003ca title=\"https://scotthelme.co.uk/hpkp-http-public-key-pinning/\" href=\"/redirect?url=https%3A%2F%2Fscotthelme.co.uk%2Fhpkp-http-public-key-pinning%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scotthelme.co.uk/hpkp-http-public-key-pinning/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e article)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIf you don\u0026#39;t consider this a valid issue, let me know it and I\u0026#39;l autoclose by myself as N/A :)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSome security headers missed can lead to prevention of certain attacks that can be exploited using reflected attacks in the local network either in remote contexts.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-03-28T00:51:36.412Z","allow_singular_disclosure_after":-55487876.707274154,"singular_disclosure_allowed":true,"vote_count":46,"voters":["reigertje","bl4de","mygf","an0nym0us","khizer47","cr4xerbik4sh","cryptographer","rubnogueira","omemishra","7azimo","and 36 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":21499,"asset_type":"URL","asset_identifier":"acme-validation.jamieweb.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4202538,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @mik317,\n\nThanks for your report.\n\nGood spot here - I'm going to add 'X-DNS-Prefetch-Control: off' to all responses and test it in my staging environment. Then hopefully it will be pushed out to the public site either tonight or later in the week.\n\nPublic-Key-Pins is a deprecated header and also quite risky to implement, so I'm going to leave it out. X-Download-Options also seems to be applicable only to older IE versions, so I will also leave it out, however I do have it noted as one to keep an eye on, as there does seem to be an ongoing feature request for this to be implemented in Edge. With Edge soon to be switching to Chromium as the engine though, this may mean that the feature request won't be fulfilled.\n\nI will resolve this report once I have implemented the changes on the live website.\n\nThanks,\nJamie","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mik317\"\u003e@mik317\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report.\u003c/p\u003e\n\n\u003cp\u003eGood spot here - I\u0026#39;m going to add \u0026#39;X-DNS-Prefetch-Control: off\u0026#39; to all responses and test it in my staging environment. Then hopefully it will be pushed out to the public site either tonight or later in the week.\u003c/p\u003e\n\n\u003cp\u003ePublic-Key-Pins is a deprecated header and also quite risky to implement, so I\u0026#39;m going to leave it out. X-Download-Options also seems to be applicable only to older IE versions, so I will also leave it out, however I do have it noted as one to keep an eye on, as there does seem to be an ongoing feature request for this to be implemented in Edge. With Edge soon to be switching to Chromium as the engine though, this may mean that the feature request won\u0026#39;t be fulfilled.\u003c/p\u003e\n\n\u003cp\u003eI will resolve this report once I have implemented the changes on the live website.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJamie\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-24T22:06:40.831Z","updated_at":"2019-02-24T22:06:40.831Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4202806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Change has been implemented in staging - deployment to production is planned for Monday night/Tuesday morning GMT.","markdown_message":"\u003cp\u003eChange has been implemented in staging - deployment to production is planned for Monday night/Tuesday morning GMT.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-25T00:35:22.838Z","updated_at":"2019-02-25T00:35:22.838Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4205255,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jamieonubuntu ,\nthank you so much :).\n\nI'm going to report the same issue also for the  other websites:)\nBest, Mik","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jamieonubuntu\"\u003e@jamieonubuntu\u003c/a\u003e ,\u003cbr\u003e\nthank you so much :).\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to report the same issue also for the  other websites:)\u003cbr\u003e\nBest, Mik\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-25T11:38:30.858Z","updated_at":"2019-02-25T11:38:30.858Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4212178,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @mik317,\n\nI have now implemented the X-DNS-Prefetch-Control header on all of my live sites.\n\nThanks again for your help,\nJamie","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mik317\"\u003e@mik317\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI have now implemented the X-DNS-Prefetch-Control header on all of my live sites.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your help,\u003cbr\u003e\nJamie\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-26T00:50:50.716Z","updated_at":"2019-02-26T00:50:50.716Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mik317","url":"/mik317"},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4212181,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-26T00:51:36.377Z","updated_at":"2019-02-26T00:51:36.377Z","first_to_agree":true,"actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4333791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jamieonubuntu ,\nbefore report another invalid header, can I know if you're interested in `X-Permitted-Cross-Domain-Policies` ? \nIf yes, let me know it and I'll open another report :)\n\nBest, Mik","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jamieonubuntu\"\u003e@jamieonubuntu\u003c/a\u003e ,\u003cbr\u003e\nbefore report another invalid header, can I know if you\u0026#39;re interested in \u003ccode\u003eX-Permitted-Cross-Domain-Policies\u003c/code\u003e ? \u003cbr\u003e\nIf yes, let me know it and I\u0026#39;ll open another report :)\u003c/p\u003e\n\n\u003cp\u003eBest, Mik\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T19:28:50.710Z","updated_at":"2019-03-15T19:28:50.710Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4338104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mik317,\n\nIf you have an attack scenario for the lack of that header, please feel free to report it.\n\nMy current thoughts are that any attack would be limited to edge-case information disclosure. For example, a site running a malicious Flash file may be able to determine that somebody had previously visited my site (and maybe even which pages by querying the local cache?), however this header may not even protect against that.\n\nHowever, if somebody wants to use an old built-in PDF reader or other plugin to access my site, they are welcome to do that, so I'd prefer not to unnecessarily restrict access unless there is a security reason to do so.\n\nAlso, in 2019 there would be easier ways to carry out that attack, for example some malicious JavaScript could probably determine based on response times whether my site was in the local DNS cache, or perhaps even by making some requests to try to see whether there are cached Strict-Transport-Security and Expect-CT policies, indicating that the site has been visited previously.\n\nThanks for your help,\nJamie","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mik317\"\u003e@mik317\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIf you have an attack scenario for the lack of that header, please feel free to report it.\u003c/p\u003e\n\n\u003cp\u003eMy current thoughts are that any attack would be limited to edge-case information disclosure. For example, a site running a malicious Flash file may be able to determine that somebody had previously visited my site (and maybe even which pages by querying the local cache?), however this header may not even protect against that.\u003c/p\u003e\n\n\u003cp\u003eHowever, if somebody wants to use an old built-in PDF reader or other plugin to access my site, they are welcome to do that, so I\u0026#39;d prefer not to unnecessarily restrict access unless there is a security reason to do so.\u003c/p\u003e\n\n\u003cp\u003eAlso, in 2019 there would be easier ways to carry out that attack, for example some malicious JavaScript could probably determine based on response times whether my site was in the local DNS cache, or perhaps even by making some requests to try to see whether there are cached Strict-Transport-Security and Expect-CT policies, indicating that the site has been visited previously.\u003c/p\u003e\n\n\u003cp\u003eThanks for your help,\u003cbr\u003e\nJamie\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T21:34:55.675Z","updated_at":"2019-03-16T21:34:55.675Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4338121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank for the response full of informations :)\n\nBest, Mik","markdown_message":"\u003cp\u003eThank for the response full of informations :)\u003c/p\u003e\n\n\u003cp\u003eBest, Mik\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T21:44:46.600Z","updated_at":"2019-03-16T21:44:46.600Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4407310,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-28T00:51:43.054Z","updated_at":"2019-03-28T00:51:43.054Z","actor":{"url":"/jamieweb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"JamieWeb"}},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14348,"category":"team","content":"The reporter identified that the X-DNS-Prefetch-Control, X-Download-Options and Public-Key-Pins headers were missing.\n\nX-Download-Options and Public-Key-Pins are deprecated/of limited use, so these have not been implemented. However, the X-DNS-Prefetch-Control header has now been implemented on all of my live sites in order to avoid the risk of information disclosure via this feature.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe reporter identified that the X-DNS-Prefetch-Control, X-Download-Options and Public-Key-Pins headers were missing.\u003c/p\u003e\n\n\u003cp\u003eX-Download-Options and Public-Key-Pins are deprecated/of limited use, so these have not been implemented. However, the X-DNS-Prefetch-Control header has now been implemented on all of my live sites in order to avoid the risk of information disclosure via this feature.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}