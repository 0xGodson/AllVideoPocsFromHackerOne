{"id":244432,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ0MzI=","url":"https://hackerone.com/reports/244432","title":"Missing SPF Flags","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-06-29T16:12:28.128Z","submitted_at":"2017-06-29T16:12:28.128Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mr_r3boot","url":"/mr_r3boot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-01T21:45:07.656Z","bug_reporter_agreed_on_going_public_at":"2017-06-30T09:47:42.615Z","team_member_agreed_on_going_public_at":"2017-07-01T21:45:07.607Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I am just looking at your SPF records then found following. SPF Records missing safe check which can allow me to send mail and phish easily any victim.\n\n#PoC:\n```\n\u003c?php\n$to = \"VICTIM@example.com\";\n$subject = \"Password Change\";\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\n$headers = \"From: support@wakatime.com\";\nmail($to,$subject,$txt,$headers);\n?\u003e\n```\nThe TXT records found for your domain are:\nv=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com ~all \n\nChecking to see if there is a valid SPF record. \n\nFound v=spf1 record for wakatime.com: \n\u003ev=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com ~all \n\n#Fix:\n\u003ev=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com -all \n\nYou can check yourself here http://www.kitterman.com/getspf2.py\nYou can refer this https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\n\nLet me know if any further info is required.\n\nRegards,\nMr_R3boot.","vulnerability_information_html":"\u003cp\u003eI am just looking at your SPF records then found following. SPF Records missing safe check which can allow me to send mail and phish easily any victim.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC:\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;VICTIM@example.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Password Change\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Change your password by visiting here - [VIRUS LINK HERE]l\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;From: support@wakatime.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe TXT records found for your domain are:\u003cbr\u003e\nv=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com ~all \u003c/p\u003e\n\n\u003cp\u003eChecking to see if there is a valid SPF record. \u003c/p\u003e\n\n\u003cp\u003eFound v=spf1 record for wakatime.com: \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ev=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com ~all \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1 id=\"fix\"\u003eFix:\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ev=spf1 include:_spf.google.com include:mailgun.org include:spf.sendinblue.com -all \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou can check yourself here \u003ca title=\"http://www.kitterman.com/getspf2.py\" href=\"/redirect?url=http%3A%2F%2Fwww.kitterman.com%2Fgetspf2.py\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.kitterman.com/getspf2.py\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nYou can refer this \u003ca title=\"https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know if any further info is required.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nMr_R3boot.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-30T09:47:42.661Z","allow_singular_disclosure_after":-107810497.80948116,"singular_disclosure_allowed":true,"vote_count":10,"voters":["mygf","gamliel","eveeez","r3y","mr_r3boot","zerotoone","silv3rpoision","japz","cool_hunter","b73772bded7541989b54f6a"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1793631,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-30T08:10:34.668Z","updated_at":"2017-06-30T08:10:34.668Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":54795,"new_severity_id":54943},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1793633,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T08:10:43.267Z","updated_at":"2017-06-30T08:10:43.267Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mr_r3boot","url":"/mr_r3boot"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1793707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome quick patch. Loved working with your team. Please look at #244424 also a simple patch is needed.","markdown_message":"\u003cp\u003eAwesome quick patch. Loved working with your team. Please look at \u003ca href=\"/reports/244424\"\u003e#244424\u003c/a\u003e also a simple patch is needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T09:24:06.535Z","updated_at":"2017-06-30T09:24:06.535Z","actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1793734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If you don't mind..","markdown_message":"\u003cp\u003eIf you don\u0026#39;t mind..\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T09:47:42.635Z","updated_at":"2017-06-30T09:47:42.635Z","first_to_agree":true,"actor":{"username":"mr_r3boot","cleared":false,"url":"/mr_r3boot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1796893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Follow up: We also added a DMARC TXT record to our DNS so email servers will reject any incoming mail from `*.wakatime.com` which fails SPF or DKIM checks:\n\n```\nv=DMARC1; p=reject; sp=reject; adkim=r; aspf=r; rua=mailto:dmarc@wakatime.com!10m; ruf=mailto:dmarc@wakatime.com!10m; rf=afrf; pct=100; ri=86400\n```","markdown_message":"\u003cp\u003eFollow up: We also added a DMARC TXT record to our DNS so email servers will reject any incoming mail from \u003ccode\u003e*.wakatime.com\u003c/code\u003e which fails SPF or DKIM checks:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ev=DMARC1; p=reject; sp=reject; adkim=r; aspf=r; rua=mailto:dmarc@wakatime.com!10m; ruf=mailto:dmarc@wakatime.com!10m; rf=afrf; pct=100; ri=86400\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-07-01T21:44:24.642Z","updated_at":"2017-07-01T21:44:58.506Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1796894,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-01T21:45:07.630Z","updated_at":"2017-07-01T21:45:07.630Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1796895,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-01T21:45:07.674Z","updated_at":"2017-07-01T21:45:07.674Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1796897,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-01T21:45:22.154Z","updated_at":"2017-07-01T21:45:22.154Z","actor":{"url":"/wakatime","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WakaTime"}},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}