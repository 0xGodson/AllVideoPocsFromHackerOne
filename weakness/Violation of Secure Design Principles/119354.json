{"id":119354,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTkzNTQ=","url":"https://hackerone.com/reports/119354","title":"Race Conditions Exist When Accepting Invitations","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-29T01:19:47.888Z","submitted_at":"2016-02-29T01:19:47.888Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-26T02:27:42.008Z","bug_reporter_agreed_on_going_public_at":"2016-04-26T02:27:41.918Z","team_member_agreed_on_going_public_at":"2016-04-25T02:12:54.833Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nFurther to my last two comments on report #118312 and realizing that tokens are being stored in the DB, I realized there is probably a race condition vulnerability which allows invitation tokens to be consumed at least twice depending on the server/database response time.\n\nI tested it tonight and was able to authenticate two accounts on one invite for my test company, test22 simply by clicking the accept button quickly in two separate browsers with two separately logged in users. I've attached screenshots of the two confirmation emails back to the administrator -- they both show the same receipt time... I know this doesn't prove the race condition so if required, I can try and duplicate it in a video if required. It only took two attempts. I was hoping you might be able to see something in the server logs - it happened at 7:58pm EST\n\nI know this isn't necessarily a huge vulnerability in and of itself but I was thinking, a) an invitation should only be able to be accepted once and b) if I'm right with #118312 and the invitation tokens are vulnerable to a timing attack (which looks more likely given the race condition here), an attacker could accept one multiple times and the confusion for the administrator could give the attacker more time to browse reports...\n\nThoughts?","vulnerability_information_html":"\u003cp\u003eHi All,\u003cbr\u003e\nFurther to my last two comments on report \u003ca href=\"/reports/118312\"\u003e#118312\u003c/a\u003e and realizing that tokens are being stored in the DB, I realized there is probably a race condition vulnerability which allows invitation tokens to be consumed at least twice depending on the server/database response time.\u003c/p\u003e\n\n\u003cp\u003eI tested it tonight and was able to authenticate two accounts on one invite for my test company, test22 simply by clicking the accept button quickly in two separate browsers with two separately logged in users. I\u0026#39;ve attached screenshots of the two confirmation emails back to the administrator -- they both show the same receipt time... I know this doesn\u0026#39;t prove the race condition so if required, I can try and duplicate it in a video if required. It only took two attempts. I was hoping you might be able to see something in the server logs - it happened at 7:58pm EST\u003c/p\u003e\n\n\u003cp\u003eI know this isn\u0026#39;t necessarily a huge vulnerability in and of itself but I was thinking, a) an invitation should only be able to be accepted once and b) if I\u0026#39;m right with \u003ca href=\"/reports/118312\"\u003e#118312\u003c/a\u003e and the invitation tokens are vulnerable to a timing attack (which looks more likely given the race condition here), an attacker could accept one multiple times and the confusion for the administrator could give the attacker more time to browse reports...\u003c/p\u003e\n\n\u003cp\u003eThoughts?\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":75798,"file_name":"invite_accepted_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/075/798/e62b4e6e4ce85cc4fa13b9d66103095553834c93/invite_accepted_2.png?response-content-disposition=attachment%3B%20filename%3D%22invite_accepted_2.png%22%3B%20filename%2A%3DUTF-8%27%27invite_accepted_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041955Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=fcc06dc7331ca812c56c94582778552074ed8b8b6521ffe60ec474abcbe58d55","file_size":27749,"type":"image/png"},{"id":75799,"file_name":"invite_accepted_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/075/799/0acf6c7a5e42dee3428db967716b3feb110360c8/invite_accepted_1.png?response-content-disposition=attachment%3B%20filename%3D%22invite_accepted_1.png%22%3B%20filename%2A%3DUTF-8%27%27invite_accepted_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041955Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=beb0187f635c73724d35c080cb0c26fb2647274c0ed3d7d662ab4767c1f981d2","file_size":37643,"type":"image/png"}],"allow_singular_disclosure_at":"2016-05-25T02:12:54.941Z","allow_singular_disclosure_after":-145073220.83754465,"singular_disclosure_allowed":true,"vote_count":4,"voters":["its_afolic","666reda","klau5","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":816668,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. It's possible you might receive two emails, but you can only enter a team once. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.","markdown_message":"\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. It\u0026#39;s possible you might receive two emails, but you can only enter a team once. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T08:53:51.481Z","updated_at":"2016-02-29T08:53:51.481Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816674,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Sorry, misinterpreted your report. I'll try to reproduce this. It still might be not a valid issue, but I'll try to get back to you.","markdown_message":"\u003cp\u003eSorry, misinterpreted your report. I\u0026#39;ll try to reproduce this. It still might be not a valid issue, but I\u0026#39;ll try to get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T08:58:09.346Z","updated_at":"2016-02-29T08:58:09.346Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816698,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I tried to reproduce this multiple times but haven't been able to trigger any race condition. I even captured two requests which I send at the exact same time, but no gold. Could you try to provide a video?","markdown_message":"\u003cp\u003eI tried to reproduce this multiple times but haven\u0026#39;t been able to trigger any race condition. I even captured two requests which I send at the exact same time, but no gold. Could you try to provide a video?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T09:29:16.744Z","updated_at":"2016-02-29T09:29:16.744Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816834,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sorry for not being clear in the initial report. I couldn't attach the video given the resolution and uploading to youtube didn't work so its here: [redacted] - was able to get it on the first try creating the screen capture. Sorry for the huge resolution - wanted to capture everything on the screen. Please disregard the photo of my wife and daughter, didn't realize the background had rotated.\n\nYou'll see three browser windows, on the left i log in with two different accounts. On the right is the actual administrator account. initially you'll see there is only the admin and demo researcher on the team. Then I accept the one invitation twice in quick succession with the two windows on the left. After which, there are 4 members on the team.","markdown_message":"\u003cp\u003eSorry for not being clear in the initial report. I couldn\u0026#39;t attach the video given the resolution and uploading to youtube didn\u0026#39;t work so its here: [redacted] - was able to get it on the first try creating the screen capture. Sorry for the huge resolution - wanted to capture everything on the screen. Please disregard the photo of my wife and daughter, didn\u0026#39;t realize the background had rotated.\u003c/p\u003e\n\n\u003cp\u003eYou\u0026#39;ll see three browser windows, on the left i log in with two different accounts. On the right is the actual administrator account. initially you\u0026#39;ll see there is only the admin and demo researcher on the team. Then I accept the one invitation twice in quick succession with the two windows on the left. After which, there are 4 members on the team.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T10:59:59.368Z","updated_at":"2016-04-25T11:25:03.798Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816859,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Redid the resolution and attached it.","markdown_message":"\u003cp\u003eRedid the resolution and attached it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T11:16:33.440Z","updated_at":"2016-02-29T11:16:51.972Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem, your family seems lovely! I'm still not able to reproduce this, so I'd like to propose the following:\n\n1. I will create a sandboxed team and will invite `yaworsk` to.\n2. If you manage to join the sandboxed team with two accounts (verifying your POC), I will triage it and someone will investigate this.\n\nDoes that sound good? Please reply if it does and I will invite you.","markdown_message":"\u003cp\u003eNo problem, your family seems lovely! I\u0026#39;m still not able to reproduce this, so I\u0026#39;d like to propose the following:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eI will create a sandboxed team and will invite \u003ccode\u003eyaworsk\u003c/code\u003e to.\u003c/li\u003e\n\u003cli\u003eIf you manage to join the sandboxed team with two accounts (verifying your POC), I will triage it and someone will investigate this.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eDoes that sound good? Please reply if it does and I will invite you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T11:18:41.404Z","updated_at":"2016-02-29T11:18:41.404Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":":) thanks.\n\nThe only challenge is race conditions can be tricky. Obviously can't guarantee it in one shot but you saw it was doable. Just don't want to walk away from the issue if I can't get it with the one invite from you. But happy to try ","markdown_message":"\u003cp\u003e:) thanks.\u003c/p\u003e\n\n\u003cp\u003eThe only challenge is race conditions can be tricky. Obviously can\u0026#39;t guarantee it in one shot but you saw it was doable. Just don\u0026#39;t want to walk away from the issue if I can\u0026#39;t get it with the one invite from you. But happy to try \u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T11:21:13.938Z","updated_at":"2016-02-29T11:21:13.938Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you send it now, Ill try right away","markdown_message":"\u003cp\u003eIf you send it now, Ill try right away\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T11:22:13.083Z","updated_at":"2016-02-29T11:22:13.083Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also - it can be verified on the code level. Youll see that the process begins with a lookup, verifies the tokens, updates the user/group, then deletes the token from the db. That may be a better way to confirm - it's the process of the lookup, processing, delete that causes this - if the processing is delayed, both requests are received and the select statement for the token returns true on both...\n\nMake sense? I think that is the better way to approach it, from the code given the video poc","markdown_message":"\u003cp\u003eAlso - it can be verified on the code level. Youll see that the process begins with a lookup, verifies the tokens, updates the user/group, then deletes the token from the db. That may be a better way to confirm - it\u0026#39;s the process of the lookup, processing, delete that causes this - if the processing is delayed, both requests are received and the select statement for the token returns true on both...\u003c/p\u003e\n\n\u003cp\u003eMake sense? I think that is the better way to approach it, from the code given the video poc\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T11:25:25.699Z","updated_at":"2016-02-29T11:25:53.513Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816992,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Let's try to get the invite working. No problem if it doesn't work the first time, I can always invite you again. Sorry if this was is a bit cumbersome, but I cannot reproduce this myself.","markdown_message":"\u003cp\u003eLet\u0026#39;s try to get the invite working. No problem if it doesn\u0026#39;t work the first time, I can always invite you again. Sorry if this was is a bit cumbersome, but I cannot reproduce this myself.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T13:23:08.608Z","updated_at":"2016-02-29T13:23:08.608Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":817041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, no worries on the process, just didn't want it to be one strike and you're out - my hand would be shaking too much.\n\nI'll do it tonight - sorry for the delay. In the mean time, is it possible for you/someone to take a quick glance at the code and confirm if the process I think you follow is correct? Nothing in depth, just the controller to see if it is:\n\n- sql lookup token\n- process\n- SQL delete token\n\nThanks! Talk soon.","markdown_message":"\u003cp\u003eGreat, no worries on the process, just didn\u0026#39;t want it to be one strike and you\u0026#39;re out - my hand would be shaking too much.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll do it tonight - sorry for the delay. In the mean time, is it possible for you/someone to take a quick glance at the code and confirm if the process I think you follow is correct? Nothing in depth, just the controller to see if it is:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003esql lookup token\u003c/li\u003e\n\u003cli\u003eprocess\u003c/li\u003e\n\u003cli\u003eSQL delete token\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks! Talk soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T13:58:37.117Z","updated_at":"2016-02-29T13:58:37.117Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":817988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ha! Success - got it! :)\n\nPracticed 4 times before to make sure it would work... got 3 out of 4 practices.","markdown_message":"\u003cp\u003eHa! Success - got it! :)\u003c/p\u003e\n\n\u003cp\u003ePracticed 4 times before to make sure it would work... got 3 out of 4 practices.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T00:46:27.615Z","updated_at":"2016-03-01T00:46:27.615Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818325,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice, thanks for verifying it. We'll be in touch shortly!","markdown_message":"\u003cp\u003eNice, thanks for verifying it. We\u0026#39;ll be in touch shortly!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T07:57:08.144Z","updated_at":"2016-03-01T07:57:08.144Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":819115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yaworsk \n\nWe released a fix for this issue to production. Can you confirm it is not possible anymore to use an invite twice?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yaworsk\"\u003e@yaworsk\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eWe released a fix for this issue to production. Can you confirm it is not possible anymore to use an invite twice?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T17:01:04.501Z","updated_at":"2016-03-01T17:01:04.501Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":819256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tomdev, did a couple quick tests and haven't been successful in accepting an invite twice since the fix but would like to test on my home network tonight which is quieter / more reliable if that's ok.  Could be moot point depending on how the code was updated but I dont think you'll share that right? :)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e, did a couple quick tests and haven\u0026#39;t been successful in accepting an invite twice since the fix but would like to test on my home network tonight which is quieter / more reliable if that\u0026#39;s ok.  Could be moot point depending on how the code was updated but I dont think you\u0026#39;ll share that right? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T17:56:03.846Z","updated_at":"2016-03-01T17:58:04.283Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":819793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tomdev, I tried 5 or 6 times at home and wasn't able to get two accounts registered, looks good.  Would be interested to know how it was fixed.\npete","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e, I tried 5 or 6 times at home and wasn\u0026#39;t able to get two accounts registered, looks good.  Would be interested to know how it was fixed.\u003cbr\u003e\npete\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T22:09:23.774Z","updated_at":"2016-03-01T22:09:23.774Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820373,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Great that it's fixed now @yaworsk, thanks for your help. Please be patient as we're still discussing the impact of your report.","markdown_message":"\u003cp\u003eGreat that it\u0026#39;s fixed now \u003ca href=\"/yaworsk\"\u003e@yaworsk\u003c/a\u003e, thanks for your help. Please be patient as we\u0026#39;re still discussing the impact of your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-02T09:11:57.033Z","updated_at":"2016-03-02T09:11:57.033Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820499,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jens, no problem. As I mentioned previously, I know this may appear harmless on the face of it, accept and invitation once or twice, you have access regardless.\n\nHowever, I think the security issue here is the relation to #119988 - in the event of a successful attack there, using the race conditions here could create confusion for a victim in a situation where every second counts. Not only does the attacker gain at least a few more seconds at minimum, the victim would have to remove two accounts and there's a chance that might be missed.\n\nLooking forward to your thoughts.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jens\"\u003e@jens\u003c/a\u003e, no problem. As I mentioned previously, I know this may appear harmless on the face of it, accept and invitation once or twice, you have access regardless.\u003c/p\u003e\n\n\u003cp\u003eHowever, I think the security issue here is the relation to \u003ca href=\"/reports/119988\"\u003e#119988\u003c/a\u003e - in the event of a successful attack there, using the race conditions here could create confusion for a victim in a situation where every second counts. Not only does the attacker gain at least a few more seconds at minimum, the victim would have to remove two accounts and there\u0026#39;s a chance that might be missed.\u003c/p\u003e\n\n\u003cp\u003eLooking forward to your thoughts.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-02T10:47:31.523Z","updated_at":"2016-03-02T10:47:31.523Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832059,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Thanks again for the find @yaworsk. We've spent some time discussing your report and concluded the impact is minimal as you need to know the secret token of an invitation in order for an attacker to fully take advantage of the race condition. Because of this we think this report isn't eligible for a monetary reward, but we do like to send you some HackerOne swag to thank you for your great POC and help in the process of fixing it.","markdown_message":"\u003cp\u003eThanks again for the find \u003ca href=\"/yaworsk\"\u003e@yaworsk\u003c/a\u003e. We\u0026#39;ve spent some time discussing your report and concluded the impact is minimal as you need to know the secret token of an invitation in order for an attacker to fully take advantage of the race condition. Because of this we think this report isn\u0026#39;t eligible for a monetary reward, but we do like to send you some HackerOne swag to thank you for your great POC and help in the process of fixing it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-09T22:54:45.645Z","updated_at":"2016-03-09T22:54:45.645Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832060,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-09T22:55:55.931Z","updated_at":"2016-03-09T22:55:55.931Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":832396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert, no worries - knew it was a stretch when I reported it, good to see it addressed though.\n\nAnd thank you - swag would be awesome, I really appreciate that!!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e, no worries - knew it was a stretch when I reported it, good to see it addressed though.\u003c/p\u003e\n\n\u003cp\u003eAnd thank you - swag would be awesome, I really appreciate that!!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-10T03:22:47.679Z","updated_at":"2016-03-10T03:22:47.679Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":925386,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-25T02:12:54.859Z","updated_at":"2016-04-25T02:12:54.859Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":925923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reed, happy to disclose - can we just remove the mp4 attachment?\n\nAnd Jens image attachment - has two personal email addresses...","markdown_message":"\u003cp\u003eHi \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e, happy to disclose - can we just remove the mp4 attachment?\u003c/p\u003e\n\n\u003cp\u003eAnd Jens image attachment - has two personal email addresses...\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-25T10:55:37.740Z","updated_at":"2016-04-25T10:57:01.831Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":925960,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I removed the attachments that disclosed personal information.\n\nP.S. The issue you reported was resolved by locking the invitation row in the database when accepting.","markdown_message":"\u003cp\u003eI removed the attachments that disclosed personal information.\u003c/p\u003e\n\n\u003cp\u003eP.S. The issue you reported was resolved by locking the invitation row in the database when accepting.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-25T11:32:05.146Z","updated_at":"2016-04-25T11:32:05.146Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":927574,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @tomdev ","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T02:27:41.946Z","updated_at":"2016-04-26T02:27:41.946Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927575,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-26T02:27:42.029Z","updated_at":"2016-04-26T02:27:42.029Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}