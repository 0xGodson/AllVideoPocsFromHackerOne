{"id":3722,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzIy","url":"https://hackerone.com/reports/3722","title":"User impersonation is possible with incoming webhooks","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-03-11T17:34:58.308Z","submitted_at":"2014-03-11T17:34:58.308Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pwndizzle","url":"/pwndizzle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/515/6f6658d6d69ce1b41f7c77b77ec83c5fdd4f08cf_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-04-10T20:53:37.570Z","bug_reporter_agreed_on_going_public_at":"2014-03-16T08:31:05.772Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Using the incoming webhook service it is possible to send messages to the team from an arbitrary username. A malicious user could modify the image of the webhook service to match an existing user and then send a message with the username of an existing user. Other users would not be able to tell the difference between messages from the real user and a spoofed message unless they actually examined the user/bot.\r\n\r\nExample request:\r\n\r\nPOST /services/hooks/incoming-webhook?token=G98rIOYar6DPwDINWFcBnEXT HTTP/1.1\r\nHost: mailinator.slack.com\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nContent-Length: 87\r\nConnection: keep-alive\r\n\r\npayload={\"channel\": \"#general\", \"username\": \"TARGET\", \"text\": \"I'm a spoofed message!\"}\r\n\r\n\r\nThe incoming webhook should not accept username as a parameter, this should be static and stored server-side. At very least a server-side check should verify that the username parameter does not match an existing username.","vulnerability_information_html":"\u003cp\u003eUsing the incoming webhook service it is possible to send messages to the team from an arbitrary username. A malicious user could modify the image of the webhook service to match an existing user and then send a message with the username of an existing user. Other users would not be able to tell the difference between messages from the real user and a spoofed message unless they actually examined the user/bot.\u003c/p\u003e\n\n\u003cp\u003eExample request:\u003c/p\u003e\n\n\u003cp\u003ePOST /services/hooks/incoming-webhook?token=G98rIOYar6DPwDINWFcBnEXT HTTP/1.1\u003cbr\u003e\nHost: mailinator.slack.com\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nContent-Length: 87\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003epayload={\u0026quot;channel\u0026quot;: \u0026quot;#general\u0026quot;, \u0026quot;username\u0026quot;: \u0026quot;TARGET\u0026quot;, \u0026quot;text\u0026quot;: \u0026quot;I\u0026#39;m a spoofed message!\u0026quot;}\u003c/p\u003e\n\n\u003cp\u003eThe incoming webhook should not accept username as a parameter, this should be static and stored server-side. At very least a server-side check should verify that the username parameter does not match an existing username.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-04-10T19:53:28.572Z","allow_singular_disclosure_after":-212061109.16329885,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":15659,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"No, this is a feature of the product.\n\nIf you want try and to impersonate your coworkers, that's your own issue.","markdown_message":"\u003cp\u003eNo, this is a feature of the product.\u003c/p\u003e\n\n\u003cp\u003eIf you want try and to impersonate your coworkers, that\u0026#39;s your own issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-11T20:53:28.837Z","updated_at":"2014-03-11T20:53:28.837Z","actor":{"username":"iamcal","cleared":false,"url":"/iamcal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/138/0e164dd6477c48d57f2f5a1c56756f7ec98229cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":16042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What if an external attacker compromises one of your users and sends a spoofed message from your CEO with a malicious link/attachment? There would be all kinds of trouble.","markdown_message":"\u003cp\u003eWhat if an external attacker compromises one of your users and sends a spoofed message from your CEO with a malicious link/attachment? There would be all kinds of trouble.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-12T17:42:52.979Z","updated_at":"2014-03-12T17:42:52.979Z","actor":{"username":"pwndizzle","cleared":false,"url":"/pwndizzle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/515/6f6658d6d69ce1b41f7c77b77ec83c5fdd4f08cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":17132,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-16T08:31:05.788Z","updated_at":"2014-03-16T08:31:05.788Z","actor":{"username":"pwndizzle","cleared":false,"url":"/pwndizzle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/515/6f6658d6d69ce1b41f7c77b77ec83c5fdd4f08cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":28088,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-10T20:53:37.624Z","updated_at":"2014-04-10T20:53:37.624Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}