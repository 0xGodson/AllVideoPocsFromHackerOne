{"id":340012,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDAwMTI=","url":"https://hackerone.com/reports/340012","title":"Buffer out of bound read in miniupnpc xml parser ","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-04-18T09:32:51.100Z","submitted_at":"2018-04-18T09:32:51.100Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yukichen","url":"/yukichen","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-25T05:49:15.662Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-04-25T05:27:06.891Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nThis is a buffer oob read vulnerability in miniupnpc when parsing xml response. This vulnerability could result in denial of service attack in monero client to in local area Network.\n\n**Description:** \n\nIn miniupnpc, file \"Minixml.c\":\n\nThe funnction parseelt:\n\nstatic void parseelt(struct xmlparser * p)\n{\n...\n\t\t\t\tif(memcmp(p-\u003exml, \"\u003c![CDATA[\", 9) == 0)\t\t// (1)  Failed to do bound check prior to \"memcmp\" here\n\t\t\t\t{\n\t\t\t\t\t/* CDATA handling */\n\t\t\t\t\tp-\u003exml += 9;\n\t\t\t\t\tdata = p-\u003exml;\n\t\t\t\t\ti = 0;\n\t\t\t\t\twhile(memcmp(p-\u003exml, \"]]\u003e\", 3) != 0)\n...\n}\n\nHere it tries to match the CDATA section in the xml file using memcmp. However, it does not check whether it has already reached the end of the xml buffer. By sending a specially crafted xml response, we can make it read out of bounds of the xml buffer, which may crash the client.\n\n\n## Releases Affected:\n\nIt affects all monero clients which use miniupnpc.\n\nI have tested with the Windows, 64-bit (Command-Line Tools Only), version 0.12.0.0 Lithium Luna, downloaded from:   https://getmonero.org/downloads/\n\nThe environment I used to test was Windows 10 64-bits.\n\n\n## Steps To Reproduce:\n\nStep  1. Enable page heap for monerod.exe:\n\nThe page heap on windows helps to crash the program at the first place when memory corruption issue (buffer overrun, uaf...) happens, similar to tools like valgrind, ASAN. \n\nSee:\nhttps://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/gflags-and-pageheap\n\n\n1.1 Install WinDbg to get gflags\nInstall the Debugging tools for windows, which contains the gflags.exe tool.\n\n1.2 Enable page heap for monerod.exe\nExecute the following command:\n\"c:\\Program Files\\Debugging Tools for Windows (x64)\\gflags.exe\" /i monerod.exe +hpa\n\n\nStep 2. Start the malicious upnp server:\n\npython poc.py --listen 127.0.0.1:65000 --target havoc\n\n\nStep3. Start monerod:\n\nmonerod.exe --test-drop-download\n\n\nStep 4. Wait for monerod crash\n\nThe crash stack trace:\n\n\n(5c10.56c0): Access violation - code c0000005 (!!! second chance !!!)\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Users\\test\\Desktop\\monero\\monero-win-x64-v0.12.0.0\\monero-v0.12.0.0\\monerod.exe - \nmonerod+0x448737:\n00000000`01768737 4c3908          cmp     qword ptr [rax],r9 ds:00000000`200b0fff=????????????????\n0:000\u003e k\nChild-SP          RetAddr           Call Site\n00000000`0294d5f0 00000000`01767edb monerod+0x448737\n00000000`0294d660 00000000`01970b5b monerod+0x447edb\n00000000`0294d7a0 00000000`019792ff monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x1addb\n00000000`0294e6b0 00000000`01987503 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x2357f\n00000000`0294e960 00000000`01986aa2 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x31783\n00000000`0294ead0 00000000`01331c96 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x30d22\n00000000`0294eca0 00000000`01336735 monerod+0x11c96\n00000000`0294ede0 00000000`017fdb73 monerod+0x16735\n00000000`0294ee70 00000000`01ab0f0b monerod+0x4ddb73\n00000000`0294f000 00000000`013213c7 monerod!ZNK5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEE16save_object_dataERNS1_14basic_oarchiveEPKv+0x112c1b\n00000000`0294f860 00000000`013214fb monerod+0x13c7\n00000000`0294f930 00007ffa`6b921fe4 monerod+0x14fb\n00000000`0294f960 00007ffa`6d7bf061 KERNEL32!BaseThreadInitThunk+0x14\n00000000`0294f990 00000000`00000000 ntdll!RtlUserThreadStart+0x21\n\n\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nA malicious attacker may crash the monero clients within the same local network area.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is a buffer oob read vulnerability in miniupnpc when parsing xml response. This vulnerability could result in denial of service attack in monero client to in local area Network.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eIn miniupnpc, file \u0026quot;Minixml.c\u0026quot;:\u003c/p\u003e\n\n\u003cp\u003eThe funnction parseelt:\u003c/p\u003e\n\n\u003cp\u003estatic void parseelt(struct xmlparser * p)\u003cbr\u003e\n{\u003cbr\u003e\n...\u003cbr\u003e\n                if(memcmp(p-\u0026gt;xml, \u0026quot;\u0026lt;![CDATA[\u0026quot;, 9) == 0)     // (1)  Failed to do bound check prior to \u0026quot;memcmp\u0026quot; here\u003cbr\u003e\n                {\u003cbr\u003e\n                    /* CDATA handling */\u003cbr\u003e\n                    p-\u0026gt;xml += 9;\u003cbr\u003e\n                    data = p-\u0026gt;xml;\u003cbr\u003e\n                    i = 0;\u003cbr\u003e\n                    while(memcmp(p-\u0026gt;xml, \u0026quot;]]\u0026gt;\u0026quot;, 3) != 0)\u003cbr\u003e\n...\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003cp\u003eHere it tries to match the CDATA section in the xml file using memcmp. However, it does not check whether it has already reached the end of the xml buffer. By sending a specially crafted xml response, we can make it read out of bounds of the xml buffer, which may crash the client.\u003c/p\u003e\n\n\u003ch2 id=\"releases-affected\"\u003eReleases Affected:\u003c/h2\u003e\n\n\u003cp\u003eIt affects all monero clients which use miniupnpc.\u003c/p\u003e\n\n\u003cp\u003eI have tested with the Windows, 64-bit (Command-Line Tools Only), version 0.12.0.0 Lithium Luna, downloaded from:   \u003ca title=\"https://getmonero.org/downloads/\" href=\"/redirect?url=https%3A%2F%2Fgetmonero.org%2Fdownloads%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://getmonero.org/downloads/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe environment I used to test was Windows 10 64-bits.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eStep  1. Enable page heap for monerod.exe:\u003c/p\u003e\n\n\u003cp\u003eThe page heap on windows helps to crash the program at the first place when memory corruption issue (buffer overrun, uaf...) happens, similar to tools like valgrind, ASAN. \u003c/p\u003e\n\n\u003cp\u003eSee:\u003cbr\u003e\n\u003ca title=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/gflags-and-pageheap\" href=\"/redirect?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows-hardware%2Fdrivers%2Fdebugger%2Fgflags-and-pageheap\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/gflags-and-pageheap\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e1.1 Install WinDbg to get gflags\u003cbr\u003e\nInstall the Debugging tools for windows, which contains the gflags.exe tool.\u003c/p\u003e\n\n\u003cp\u003e1.2 Enable page heap for monerod.exe\u003cbr\u003e\nExecute the following command:\u003cbr\u003e\n\u0026quot;c:\\Program Files\\Debugging Tools for Windows (x64)\\gflags.exe\u0026quot; /i monerod.exe +hpa\u003c/p\u003e\n\n\u003cp\u003eStep 2. Start the malicious upnp server:\u003c/p\u003e\n\n\u003cp\u003epython poc.py --listen 127.0.0.1:65000 --target havoc\u003c/p\u003e\n\n\u003cp\u003eStep3. Start monerod:\u003c/p\u003e\n\n\u003cp\u003emonerod.exe --test-drop-download\u003c/p\u003e\n\n\u003cp\u003eStep 4. Wait for monerod crash\u003c/p\u003e\n\n\u003cp\u003eThe crash stack trace:\u003c/p\u003e\n\n\u003cp\u003e(5c10.56c0): Access violation - code c0000005 (!!! second chance !!!)\u003cbr\u003e\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Users\\test\\Desktop\\monero\\monero-win-x64-v0.12.0.0\\monero-v0.12.0.0\\monerod.exe - \u003cbr\u003e\nmonerod+0x448737:\u003cbr\u003e\n00000000\u003ccode\u003e01768737 4c3908          cmp     qword ptr [rax],r9 ds:00000000\u003c/code\u003e200b0fff=????????????????\u003cbr\u003e\n0:000\u0026gt; k\u003cbr\u003e\nChild-SP          RetAddr           Call Site\u003cbr\u003e\n00000000\u003ccode\u003e0294d5f0 00000000\u003c/code\u003e01767edb monerod+0x448737\u003cbr\u003e\n00000000\u003ccode\u003e0294d660 00000000\u003c/code\u003e01970b5b monerod+0x447edb\u003cbr\u003e\n00000000\u003ccode\u003e0294d7a0 00000000\u003c/code\u003e019792ff monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x1addb\u003cbr\u003e\n00000000\u003ccode\u003e0294e6b0 00000000\u003c/code\u003e01987503 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x2357f\u003cbr\u003e\n00000000\u003ccode\u003e0294e960 00000000\u003c/code\u003e01986aa2 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x31783\u003cbr\u003e\n00000000\u003ccode\u003e0294ead0 00000000\u003c/code\u003e01331c96 monerod!ZN5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEEC2Ev+0x30d22\u003cbr\u003e\n00000000\u003ccode\u003e0294eca0 00000000\u003c/code\u003e01336735 monerod+0x11c96\u003cbr\u003e\n00000000\u003ccode\u003e0294ede0 00000000\u003c/code\u003e017fdb73 monerod+0x16735\u003cbr\u003e\n00000000\u003ccode\u003e0294ee70 00000000\u003c/code\u003e01ab0f0b monerod+0x4ddb73\u003cbr\u003e\n00000000\u003ccode\u003e0294f000 00000000\u003c/code\u003e013213c7 monerod!ZNK5boost7archive6detail11oserializerINS0_24portable_binary_oarchiveEN8nodetool26anchor_peerlist_entry_baseIN4epee9net_utils15network_addressEEEE16save_object_dataERNS1_14basic_oarchiveEPKv+0x112c1b\u003cbr\u003e\n00000000\u003ccode\u003e0294f860 00000000\u003c/code\u003e013214fb monerod+0x13c7\u003cbr\u003e\n00000000\u003ccode\u003e0294f930 00007ffa\u003c/code\u003e6b921fe4 monerod+0x14fb\u003cbr\u003e\n00000000\u003ccode\u003e0294f960 00007ffa\u003c/code\u003e6d7bf061 KERNEL32!BaseThreadInitThunk+0x14\u003cbr\u003e\n00000000\u003ccode\u003e0294f990 00000000\u003c/code\u003e00000000 ntdll!RtlUserThreadStart+0x21\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA malicious attacker may crash the monero clients within the same local network area.\u003c/p\u003e\n","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":288194,"file_name":"monerod_crash.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/194/e2864bdd5576623ec39b263e76e17b6311ccb7e0/monerod_crash.png?response-content-disposition=attachment%3B%20filename%3D%22monerod_crash.png%22%3B%20filename%2A%3DUTF-8%27%27monerod_crash.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053846Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=75d364871bafee9584da28dd56e751f9902720c0b3b677516cd6670a967bcfd9","file_size":398079,"type":"image/png"},{"id":288195,"file_name":"poc.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/195/0e68d8d4c216219130ffd30c1a242ad982b1db54/poc.py?response-content-disposition=attachment%3B%20filename%3D%22poc.py%22%3B%20filename%2A%3DUTF-8%27%27poc.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053846Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=2e113f256e5bde9aade393af9d3d88e9d06987a8fbb745c8628081a5376fdd60","file_size":11869,"type":"text/x-python"}],"allow_singular_disclosure_at":"2018-05-25T05:27:06.981Z","allow_singular_disclosure_after":-81994299.27046193,"singular_disclosure_allowed":true,"vote_count":13,"voters":["spam404","mik317","mygf","eveeez","geeknik","r3y","apapedulimu","japz","test0401","297724804","and 3 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2630759,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @yukichen, thank you for the report.\n\nMonero is using the latest release of miniupnp. The issue you are describing is 100% an upstream issue, not a monero code issue, and was resolved in https://github.com/miniupnp/miniupnp/commit/a0573e251817ec090a8c9f9f41b56d720c835a6c. I don't know why miniupnp hasn't done a point release as a result.\n\nWe can remedy this issue trivially by proceeding as planned: submodule'ing miniupnp. This was meant to be done sooner than later but there are only so many hands on deck. We will have to pull against their master branch to get the patch (which is less than ideal - but c'est la vie).\n\nIf you would like to receive bounty, paste an XMR address into this ticket. The address can be one-time/temporary address if needed.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yukichen\"\u003e@yukichen\u003c/a\u003e, thank you for the report.\u003c/p\u003e\n\n\u003cp\u003eMonero is using the latest release of miniupnp. The issue you are describing is 100% an upstream issue, not a monero code issue, and was resolved in \u003ca title=\"https://github.com/miniupnp/miniupnp/commit/a0573e251817ec090a8c9f9f41b56d720c835a6c\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2Fa0573e251817ec090a8c9f9f41b56d720c835a6c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/miniupnp/miniupnp/commit/a0573e251817ec090a8c9f9f41b56d720c835a6c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I don\u0026#39;t know why miniupnp hasn\u0026#39;t done a point release as a result.\u003c/p\u003e\n\n\u003cp\u003eWe can remedy this issue trivially by proceeding as planned: submodule\u0026#39;ing miniupnp. This was meant to be done sooner than later but there are only so many hands on deck. We will have to pull against their master branch to get the patch (which is less than ideal - but c\u0026#39;est la vie).\u003c/p\u003e\n\n\u003cp\u003eIf you would like to receive bounty, paste an XMR address into this ticket. The address can be one-time/temporary address if needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-18T23:21:20.071Z","updated_at":"2018-04-18T23:21:20.071Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2633613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @anonimal ,\n\nThank you for pointing out this miniunpc patch.\n\nI did not notice that patch, I just checkout their latest code and found this bug, it's wired the patch was not merged into the latest code...\n\nMy monero wallet address is:\n43tvvwbyVKJ3roqAZjVNW8NtnF1yd9QdxL6NGDsN1oC2KLc9biBgTBuJRiaQ5tDuZfPYgeRJYrU7APcoa8ZUkcz13Z1UCeo\n\nAlso one more question, if I have other miniupnp bugs, are they still qualified for this bounty program?\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for pointing out this miniunpc patch.\u003c/p\u003e\n\n\u003cp\u003eI did not notice that patch, I just checkout their latest code and found this bug, it\u0026#39;s wired the patch was not merged into the latest code...\u003c/p\u003e\n\n\u003cp\u003eMy monero wallet address is:\u003cbr\u003e\n43tvvwbyVKJ3roqAZjVNW8NtnF1yd9QdxL6NGDsN1oC2KLc9biBgTBuJRiaQ5tDuZfPYgeRJYrU7APcoa8ZUkcz13Z1UCeo\u003c/p\u003e\n\n\u003cp\u003eAlso one more question, if I have other miniupnp bugs, are they still qualified for this bounty program?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-19T03:06:19.369Z","updated_at":"2018-04-19T03:06:19.369Z","actor":{"username":"yukichen","cleared":false,"url":"/yukichen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2635383,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eAlso one more question, if I have other miniupnp bugs, are they still qualified for this bounty program?\n\nFirst, check if the miniupnp repo has already patched the bugs. Secondly, check if they have a bug bounty program or a responsible disclosure process in place - and then proceed through them as appropriate. Unfortunately, no: miniupnp bugs do not qualify for the Monero Project bounty program.\n\nWe'll send bounty for this issue (#340012) soon.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eAlso one more question, if I have other miniupnp bugs, are they still qualified for this bounty program?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eFirst, check if the miniupnp repo has already patched the bugs. Secondly, check if they have a bug bounty program or a responsible disclosure process in place - and then proceed through them as appropriate. Unfortunately, no: miniupnp bugs do not qualify for the Monero Project bounty program.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll send bounty for this issue (#340012) soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-19T05:20:37.476Z","updated_at":"2018-04-19T05:20:37.476Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2662059,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sent 3 XMR: \u003c52f4b7ba5ad05d8ff37a4edd6a99dfed1978524158168ebf56c7365a9d5ae086\u003e","markdown_message":"\u003cp\u003eSent 3 XMR: \u0026lt;52f4b7ba5ad05d8ff37a4edd6a99dfed1978524158168ebf56c7365a9d5ae086\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-25T02:24:57.877Z","updated_at":"2018-04-25T02:24:57.877Z","actor":{"username":"luigi1111w","cleared":false,"url":"/luigi1111w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2662158,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-25T05:24:36.775Z","updated_at":"2018-04-25T05:24:36.775Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"reporter":{"username":"yukichen","url":"/yukichen"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2662159,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://github.com/monero-project/monero/pull/3668\nhttps://github.com/monero-project/monero/pull/3670\nhttps://github.com/monero-project/monero/pull/3692","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/monero-project/monero/pull/3668\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F3668\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/3668\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/monero-project/monero/pull/3670\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F3670\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/3670\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/monero-project/monero/pull/3692\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F3692\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/3692\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-25T05:26:55.496Z","updated_at":"2018-04-25T05:26:55.496Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yukichen","url":"/yukichen"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2662160,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-25T05:27:06.926Z","updated_at":"2018-04-25T05:27:06.926Z","first_to_agree":true,"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2662187,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-25T05:49:15.596Z","updated_at":"2018-04-25T05:49:15.596Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2665890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty reward  :)","markdown_message":"\u003cp\u003eThank you for the bounty reward  :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-26T04:35:24.719Z","updated_at":"2018-04-26T04:35:24.719Z","actor":{"username":"yukichen","cleared":false,"url":"/yukichen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}