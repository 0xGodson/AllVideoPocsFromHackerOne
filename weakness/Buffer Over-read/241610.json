{"id":241610,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDE2MTA=","url":"https://hackerone.com/reports/241610","title":"ap_find_token() Buffer Overread","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-06-20T08:36:29.423Z","submitted_at":"2017-06-20T08:36:29.423Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"javier_sensepost","url":"/javier_sensepost","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":26,"url":"https://hackerone.com/ibb-apache","handle":"ibb-apache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Apache httpd (IBB)","twitter_handle":"","website":"http://apache.org/security","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-7668"],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-10T12:55:58.516Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-07-11T12:55:43.851Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Versions Affected:\nhttpd 2.2.32\nhttpd 2.4.24 (unreleased)\nhttpd 2.4.25\n\nDescription:\nThe HTTP strict parsing changes added in 2.2.32 and 2.4.24 introduced a\nbug in token list parsing, which allows ap_find_token() to search past\nthe end of its input string. By maliciously crafting a sequence of\nrequest headers, an attacker may be able to cause a segmentation fault,\nor to force ap_find_token() to return an incorrect value.\n\nMitigation:\n2.2.32 users should either apply the patch available at\nhttps://www.apache.org/dist/httpd/patches/apply_to_2.2.32/CVE-2017-7668.patch\nor upgrade in the future to 2.2.33, which is currently unreleased.\n\n2.4.25 users should upgrade to 2.4.26.\n\nYou can contact me on javijmor@gmail.com or javier@sensepost.com\n\nI would like to donate the bug bounty's money (if any) to charity and preferably do it in behalf of my company, SensePost..","vulnerability_information_html":"\u003cp\u003eVersions Affected:\u003cbr\u003e\nhttpd 2.2.32\u003cbr\u003e\nhttpd 2.4.24 (unreleased)\u003cbr\u003e\nhttpd 2.4.25\u003c/p\u003e\n\n\u003cp\u003eDescription:\u003cbr\u003e\nThe HTTP strict parsing changes added in 2.2.32 and 2.4.24 introduced a\u003cbr\u003e\nbug in token list parsing, which allows ap_find_token() to search past\u003cbr\u003e\nthe end of its input string. By maliciously crafting a sequence of\u003cbr\u003e\nrequest headers, an attacker may be able to cause a segmentation fault,\u003cbr\u003e\nor to force ap_find_token() to return an incorrect value.\u003c/p\u003e\n\n\u003cp\u003eMitigation:\u003cbr\u003e\n2.2.32 users should either apply the patch available at\u003cbr\u003e\n\u003ca title=\"https://www.apache.org/dist/httpd/patches/apply_to_2.2.32/CVE-2017-7668.patch\" href=\"/redirect?url=https%3A%2F%2Fwww.apache.org%2Fdist%2Fhttpd%2Fpatches%2Fapply_to_2.2.32%2FCVE-2017-7668.patch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.apache.org/dist/httpd/patches/apply_to_2.2.32/CVE-2017-7668.patch\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nor upgrade in the future to 2.2.33, which is currently unreleased.\u003c/p\u003e\n\n\u003cp\u003e2.4.25 users should upgrade to 2.4.26.\u003c/p\u003e\n\n\u003cp\u003eYou can contact me on \u003ca title=\"javijmor@gmail.com\" href=\"mailto:javijmor@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ejavijmor@gmail.com\u003c/a\u003e or \u003ca title=\"javier@sensepost.com\" href=\"mailto:javier@sensepost.com\" rel=\"nofollow noopener noreferrer\"\u003ejavier@sensepost.com\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI would like to donate the bug bounty\u0026#39;s money (if any) to charity and preferably do it in behalf of my company, SensePost..\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-10T12:55:43.879Z","allow_singular_disclosure_after":-106848752.3734451,"singular_disclosure_allowed":true,"vote_count":22,"voters":["xixabangm4","yumi","003random","quanyang","cuso4","edoverflow","akaash_pantherdefence","eveeez","ro_","paulos_","and 12 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1824550,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T12:54:27.305Z","updated_at":"2017-07-11T12:54:27.305Z","cve_ids":["CVE-2017-7668"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1824555,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T12:55:21.743Z","updated_at":"2017-07-11T12:55:21.743Z","additional_data":{"old_title":"Apache httdp CVE-2017-7668 Buffer-over-read","new_title":"ap_find_token() Buffer Overread"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1824556,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T12:55:31.960Z","updated_at":"2017-07-11T12:55:31.960Z","actor":{"url":"/ibb-apache","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Apache httpd (IBB)"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-apache","collaborator":{"username":"javier_sensepost","url":"/javier_sensepost"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1824557,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T12:55:38.709Z","updated_at":"2017-07-11T12:55:38.709Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"javier_sensepost","url":"/javier_sensepost"},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1824560,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T12:55:43.865Z","updated_at":"2017-07-11T12:55:43.865Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1919186,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-10T12:55:58.542Z","updated_at":"2017-08-10T12:55:58.542Z","actor":{"url":"/ibb-apache","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Apache httpd (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4779,"category":"team","content":"The HTTP strict parsing changes added in 2.2.32 and 2.4.24 introduced a bug in token list parsing, which allows ap_find_token() to search past the end of its input string. By maliciously crafting a sequence of request headers, an attacker may be able to cause a segmentation fault, or to force ap_find_token() to return an incorrect value.\n\nAcknowledgements: We would like to thank Javier Jiménez (javijmor@gmail.com) for reporting this issue.\n\nReported to security team: 6th May 2017\nIssue public: 19th June 2017\nUpdate Released: 19th June 2017\nAffects: 2.4.25, 2.2.32","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe HTTP strict parsing changes added in 2.2.32 and 2.4.24 introduced a bug in token list parsing, which allows ap_find_token() to search past the end of its input string. By maliciously crafting a sequence of request headers, an attacker may be able to cause a segmentation fault, or to force ap_find_token() to return an incorrect value.\u003c/p\u003e\n\n\u003cp\u003eAcknowledgements: We would like to thank Javier Jiménez (\u003ca title=\"javijmor@gmail.com\" href=\"mailto:javijmor@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ejavijmor@gmail.com\u003c/a\u003e) for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eReported to security team: 6th May 2017\u003cbr\u003e\nIssue public: 19th June 2017\u003cbr\u003e\nUpdate Released: 19th June 2017\u003cbr\u003e\nAffects: 2.4.25, 2.2.32\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}