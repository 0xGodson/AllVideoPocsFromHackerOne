{"id":268808,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjg4MDg=","url":"https://hackerone.com/reports/268808","title":"CVE-2017-13038 The PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-15T23:47:18.968Z","submitted_at":"2017-09-15T23:47:18.968Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21653,"url":"https://hackerone.com/ibb-data","handle":"ibb-data","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Data Processing (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-13038"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-08T20:32:23.099Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:23:17.342Z","team_member_agreed_on_going_public_at":"2019-10-08T20:32:22.979Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Reported to the devs on 11 June 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/7335163a6ef82d46ff18f3e6099a157747241629\n\n`The PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().`\n\n```\n./tcpdump -nr test003\nreading from file test003, link-type PPP_ETHER (PPPoE)\n=================================================================\n==20519==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5d006f8 at pc 0x082c8c68 bp 0xbf80a208 sp 0xbf80a1fc\nREAD of size 2 at 0xb5d006f8 thread T0\n    #0 0x82c8c67 in EXTRACT_16BITS /root/tcpdump-4.9.0/./extract.h:151:20\n    #1 0x82c8c67 in handle_mlppp /root/tcpdump-4.9.0/./print-ppp.c:814\n    #2 0x82c8c67 in handle_ppp /root/tcpdump-4.9.0/./print-ppp.c:1462\n    #3 0x82c1f87 in ppp_print /root/tcpdump-4.9.0/./print-ppp.c:1566:2\n    #4 0x82cb232 in pppoe_print /root/tcpdump-4.9.0/./print-pppoe.c:195:26\n    #5 0x82ca729 in pppoe_if_print /root/tcpdump-4.9.0/./print-pppoe.c:90:10\n    #6 0x8172ac8 in pretty_print_packet /root/tcpdump-4.9.0/./print.c:339:18\n    #7 0x8160678 in print_packet /root/tcpdump-4.9.0/./tcpdump.c:2501:2\n    #8 0x843e96b in pcap_offline_read /root/libpcap-1.8.1/./savefile.c:527:4\n    #9 0x835973c in pcap_loop /root/libpcap-1.8.1/./pcap.c:890:8\n    #10 0x815bd9c in main /root/tcpdump-4.9.0/./tcpdump.c:2004:12\n    #11 0xb752f275 in __libc_start_main /build/glibc-4LXvX6/glibc-2.24/csu/../csu/libc-start.c:291\n    #12 0x8064dc7 in _start (/root/tcpdump-4.9.0/tcpdump+0x8064dc7)\n\n0xb5d006f9 is located 0 bytes to the right of 9-byte region [0xb5d006f0,0xb5d006f9)\nallocated by thread T0 here:\n    #0 0x811e994 in malloc (/root/tcpdump-4.9.0/tcpdump+0x811e994)\n    #1 0x843fcdc in pcap_check_header /root/libpcap-1.8.1/./sf-pcap.c:401:14\n    #2 0x843dc55 in pcap_fopen_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:400:7\n    #3 0x843da38 in pcap_open_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump-4.9.0/./extract.h:151:20 in EXTRACT_16BITS\n```","vulnerability_information_html":"\u003cp\u003eReported to the devs on 11 June 2017.\u003cbr\u003e\nTcpdump 4.9.2 released on 8 September 2017.\u003cbr\u003e\nPatch: \u003ca title=\"https://github.com/the-tcpdump-group/tcpdump/commit/7335163a6ef82d46ff18f3e6099a157747241629\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthe-tcpdump-group%2Ftcpdump%2Fcommit%2F7335163a6ef82d46ff18f3e6099a157747241629\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/the-tcpdump-group/tcpdump/commit/7335163a6ef82d46ff18f3e6099a157747241629\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eThe PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e./tcpdump -nr test003\nreading from file test003, link-type PPP_ETHER (PPPoE)\n=================================================================\n==20519==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5d006f8 at pc 0x082c8c68 bp 0xbf80a208 sp 0xbf80a1fc\nREAD of size 2 at 0xb5d006f8 thread T0\n    #0 0x82c8c67 in EXTRACT_16BITS /root/tcpdump-4.9.0/./extract.h:151:20\n    #1 0x82c8c67 in handle_mlppp /root/tcpdump-4.9.0/./print-ppp.c:814\n    #2 0x82c8c67 in handle_ppp /root/tcpdump-4.9.0/./print-ppp.c:1462\n    #3 0x82c1f87 in ppp_print /root/tcpdump-4.9.0/./print-ppp.c:1566:2\n    #4 0x82cb232 in pppoe_print /root/tcpdump-4.9.0/./print-pppoe.c:195:26\n    #5 0x82ca729 in pppoe_if_print /root/tcpdump-4.9.0/./print-pppoe.c:90:10\n    #6 0x8172ac8 in pretty_print_packet /root/tcpdump-4.9.0/./print.c:339:18\n    #7 0x8160678 in print_packet /root/tcpdump-4.9.0/./tcpdump.c:2501:2\n    #8 0x843e96b in pcap_offline_read /root/libpcap-1.8.1/./savefile.c:527:4\n    #9 0x835973c in pcap_loop /root/libpcap-1.8.1/./pcap.c:890:8\n    #10 0x815bd9c in main /root/tcpdump-4.9.0/./tcpdump.c:2004:12\n    #11 0xb752f275 in __libc_start_main /build/glibc-4LXvX6/glibc-2.24/csu/../csu/libc-start.c:291\n    #12 0x8064dc7 in _start (/root/tcpdump-4.9.0/tcpdump+0x8064dc7)\n\n0xb5d006f9 is located 0 bytes to the right of 9-byte region [0xb5d006f0,0xb5d006f9)\nallocated by thread T0 here:\n    #0 0x811e994 in malloc (/root/tcpdump-4.9.0/tcpdump+0x811e994)\n    #1 0x843fcdc in pcap_check_header /root/libpcap-1.8.1/./sf-pcap.c:401:14\n    #2 0x843dc55 in pcap_fopen_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:400:7\n    #3 0x843da38 in pcap_open_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump-4.9.0/./extract.h:151:20 in EXTRACT_16BITS\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-03T16:23:17.405Z","allow_singular_disclosure_after":-36420900.24608655,"singular_disclosure_allowed":true,"vote_count":3,"voters":["geeknik","japz","kishoretrommer"],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2041368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.","markdown_message":"\u003cp\u003eThis vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T16:57:23.106Z","updated_at":"2017-10-03T16:57:23.106Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216208,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:19:14.307Z","updated_at":"2017-12-12T06:19:14.307Z","additional_data":{"old_team":"The Internet","new_team":"Data Processing (IBB)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216431,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:33.522Z","updated_at":"2017-12-12T06:40:33.522Z","cve_ids":["CVE-2017-13038"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216432,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:41.724Z","updated_at":"2017-12-12T06:40:41.724Z","additional_data":{"old_severity":"High","new_severity":"High (7.3)","old_severity_id":75592,"new_severity_id":101068},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216434,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:47.715Z","updated_at":"2017-12-12T06:40:47.715Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-data","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216435,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:54.857Z","updated_at":"2017-12-12T06:40:54.857Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960681,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:23:17.362Z","updated_at":"2019-10-04T16:23:17.362Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989666,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:23.004Z","updated_at":"2019-10-08T20:32:23.004Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989667,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:23.123Z","updated_at":"2019-10-08T20:32:23.123Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}