{"id":684603,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODQ2MDM=","url":"https://hackerone.com/reports/684603","title":"Heap buffer overflow in TFTP when using small blksize","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-08-29T15:52:19.164Z","submitted_at":"2019-08-29T15:52:19.164Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thomas_v","url":"/thomas_v","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5482"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-14T15:17:25.890Z","bug_reporter_agreed_on_going_public_at":"2020-11-14T15:17:25.833Z","team_member_agreed_on_going_public_at":"2020-11-05T08:37:40.983Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nWith a TFTP server that does not send OACK, but instead starts anyway with first block with 512 bytes block size, the curl library fails to assume default 512 bytes blocks. Instead it detects EOF and does not return an error code. Consequence is a truncated file that is 512 bytes without any error code.\n\nMy understanding is that from the RFC, a TFTP server might ignore blksize request and anyway send the default 512 bytes block size data.\n\nUnless an OACK is received we should assume 512 block size, whether or not a particular blocksize was requested.\n\nThis was introduced by security fix of CVE-2019-5436:\n257600341 tftp: use the current blksize for recvfrom()\n\n## Potential Fix\nWe could revert 2576003415625d7b5f0e390902f8097830b82275 and instead malloc the receive buffer for at least 512 bytes, or for the requested blksize if it is bigger. That would address the issue being reported and also the CVE-2019-5436.\n\n## Steps To Reproduce:\n  1. Use a TFTP server that does not send OACK in response of a particular blksize request, but instead sends directly the first block, of default size (512B).\n  2. Run curl asking for a \u003e512 bytes block size like:\n    curl --tftp-blksize 8192 tftp://9.1.9.1/data.bin --output data.bin\n  3. echo $? is 0 and file size is 512 bytes\n\n## Comment\nNot too sure about the Weakness identification and/or Severity, reporting it here since it was introduced by a CVE fix.\n\n## Impact\n\nFile truncation without 'curl' returning any error code.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eWith a TFTP server that does not send OACK, but instead starts anyway with first block with 512 bytes block size, the curl library fails to assume default 512 bytes blocks. Instead it detects EOF and does not return an error code. Consequence is a truncated file that is 512 bytes without any error code.\u003c/p\u003e\n\n\u003cp\u003eMy understanding is that from the RFC, a TFTP server might ignore blksize request and anyway send the default 512 bytes block size data.\u003c/p\u003e\n\n\u003cp\u003eUnless an OACK is received we should assume 512 block size, whether or not a particular blocksize was requested.\u003c/p\u003e\n\n\u003cp\u003eThis was introduced by security fix of CVE-2019-5436:\u003cbr\u003e\n257600341 tftp: use the current blksize for recvfrom()\u003c/p\u003e\n\n\u003ch2 id=\"potential-fix\"\u003ePotential Fix\u003c/h2\u003e\n\n\u003cp\u003eWe could revert 2576003415625d7b5f0e390902f8097830b82275 and instead malloc the receive buffer for at least 512 bytes, or for the requested blksize if it is bigger. That would address the issue being reported and also the CVE-2019-5436.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eUse a TFTP server that does not send OACK in response of a particular blksize request, but instead sends directly the first block, of default size (512B).\u003c/li\u003e\n\u003cli\u003eRun curl asking for a \u0026gt;512 bytes block size like:\ncurl --tftp-blksize 8192 tftp://9.1.9.1/data.bin --output data.bin\u003c/li\u003e\n\u003cli\u003eecho $? is 0 and file size is 512 bytes\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"comment\"\u003eComment\u003c/h2\u003e\n\n\u003cp\u003eNot too sure about the Weakness identification and/or Severity, reporting it here since it was introduced by a CVE fix.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eFile truncation without \u0026#39;curl\u0026#39; returning any error code.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-05T08:37:41.082Z","allow_singular_disclosure_after":-2066412.638335152,"singular_disclosure_allowed":true,"vote_count":11,"voters":["sameerphad72","yusuf_furkan","cryptographer","kokil6594","ranking622","mudassiraijaz_18","arrow777","neupanedev1999","abowalid","chad0e","and 1 more..."],"severity":{"rating":"medium","score":5.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5692212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. will investigate. ","markdown_message":"\u003cp\u003eThanks. will investigate. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T16:04:00.753Z","updated_at":"2019-08-29T16:04:00.753Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5692724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't see a security issue here. A bug certainly, but TFTP is not a secure protocol to begin with and the impact here is \"just\" a premature end of transfer. I propose we handle this in the normal public bug tracker, ideally as a pull request from @thomas_v, if you're up for it!\n\nI'll of course give time for others to chime in and comment if you think otherwise before I act further on this report.","markdown_message":"\u003cp\u003eI don\u0026#39;t see a security issue here. A bug certainly, but TFTP is not a secure protocol to begin with and the impact here is \u0026quot;just\u0026quot; a premature end of transfer. I propose we handle this in the normal public bug tracker, ideally as a pull request from \u003ca href=\"/thomas_v\"\u003e@thomas_v\u003c/a\u003e, if you\u0026#39;re up for it!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll of course give time for others to chime in and comment if you think otherwise before I act further on this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T17:13:22.736Z","updated_at":"2019-08-29T17:13:22.736Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5696202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another related issue, I also noticed that trying the command below with a TFTP server that does not send OACK, returns either a corrupted file with a halved size, or does not return waiting for more data, depending on whether or not the last data sent contained more or less than 256 bytes. libcurl is assuming 256 bytes blocks, even when receiving blocks of 512 bytes of data.\n\ncurl --tftp-blksize 256 tftp://9.1.9.1/data.bin --output data.bin","markdown_message":"\u003cp\u003eAnother related issue, I also noticed that trying the command below with a TFTP server that does not send OACK, returns either a corrupted file with a halved size, or does not return waiting for more data, depending on whether or not the last data sent contained more or less than 256 bytes. libcurl is assuming 256 bytes blocks, even when receiving blocks of 512 bytes of data.\u003c/p\u003e\n\n\u003cp\u003ecurl --tftp-blksize 256 tftp://9.1.9.1/data.bin --output data.bin\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T08:17:28.732Z","updated_at":"2019-08-30T08:17:28.732Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5701445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually I think there is a low-impact CWE-122: Heap-based Buffer Overflow.\n\nFor TFTP upload with long enough filename and small enough blocksize we end up doing recfrom() with read size bigger than the actually allocated buffer. See log.txt attached.","markdown_message":"\u003cp\u003eActually I think there is a low-impact CWE-122: Heap-based Buffer Overflow.\u003c/p\u003e\n\n\u003cp\u003eFor TFTP upload with long enough filename and small enough blocksize we end up doing recfrom() with read size bigger than the actually allocated buffer. See log.txt attached.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T22:17:09.925Z","updated_at":"2019-08-30T22:17:09.925Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":570823,"filename":"logs.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YXfFJmFS7fk5joazRQX9JQCD?response-content-disposition=attachment%3B%20filename%3D%22logs.txt%22%3B%20filename%2A%3DUTF-8%27%27logs.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063753Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=505314840d9fa17f5d3412d542c087a5cef140d2836497db1c126d41fbfd0432"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5701534,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But this is now an upload which seems like a totally separate issue, isn't it?","markdown_message":"\u003cp\u003eBut this is now an upload which seems like a totally separate issue, isn\u0026#39;t it?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T22:41:22.648Z","updated_at":"2019-08-30T22:41:22.648Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5702533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agree, but when I revert above mentioned 2576003415625d7b5f0e390902f8097830b82275, I don't get the overflow.\nDo you want me to create a separate report with the logs.txt?","markdown_message":"\u003cp\u003eAgree, but when I revert above mentioned 2576003415625d7b5f0e390902f8097830b82275, I don\u0026#39;t get the overflow.\u003cbr\u003e\nDo you want me to create a separate report with the logs.txt?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T08:14:03.690Z","updated_at":"2019-08-31T08:14:03.690Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5703371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We can also rename this single issue to be about the upload problem specifically, which seems to be the one with a potential security angle and take the download bugs to the public bug tracker - possibly just hold on until we get a grip about the upload thing so that we don't unnecessary leak security problem details.","markdown_message":"\u003cp\u003eWe can also rename this single issue to be about the upload problem specifically, which seems to be the one with a potential security angle and take the download bugs to the public bug tracker - possibly just hold on until we get a grip about the upload thing so that we don\u0026#39;t unnecessary leak security problem details.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T08:47:15.404Z","updated_at":"2019-08-31T08:47:15.404Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5703430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"btw @thomas_v, do you have a proposed fix for the upload problem? Does it perhaps also fix the download issues?","markdown_message":"\u003cp\u003ebtw \u003ca href=\"/thomas_v\"\u003e@thomas_v\u003c/a\u003e, do you have a proposed fix for the upload problem? Does it perhaps also fix the download issues?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T08:49:42.044Z","updated_at":"2019-08-31T08:49:42.044Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5703971,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's a curl test case 'test336' attached in an attempt to reproduce this issue - but failing to do so. When I try to just increase the file name length used in it, I just make it trigger the file name check in curl and it refuses to perform. @thomas_v, can you see what needs to be done to this test case to make it trigger this issue? Does the server need to do something special?","markdown_message":"\u003cp\u003eHere\u0026#39;s a curl test case \u0026#39;test336\u0026#39; attached in an attempt to reproduce this issue - but failing to do so. When I try to just increase the file name length used in it, I just make it trigger the file name check in curl and it refuses to perform. \u003ca href=\"/thomas_v\"\u003e@thomas_v\u003c/a\u003e, can you see what needs to be done to this test case to make it trigger this issue? Does the server need to do something special?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T09:09:30.222Z","updated_at":"2019-08-31T09:09:30.222Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":571110,"filename":"test336","type":"application/octet-stream","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/43N8wKoxag4J1A3rbMidMDXW?response-content-disposition=attachment%3B%20filename%3D%22test336%22%3B%20filename%2A%3DUTF-8%27%27test336\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063754Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=2b5b6904e25513a60c13d9b567209b3bce3be08b775cd3f5e62d50cd57724eca"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5705110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was not able to edit the original report, are you able to do so? I am using tftp-hpa-5.2 as a TFTP server with defaults.\n\nAbout the security issue: spacket/rpacket are allocated of blksize (44B). Also, we fail to error when buffer is too small for adding TFTP options. We end up not sending the 'blocksize' request in the options. Everything is corrupted, 'tsize' has value '44'... The server then responds with OACK that does not contain any blksize, since it was not requested, then 'tftp_parse_option_ack()' resets blksize to 512B and we end up doing recvfrom() with a size bigger than what was allocated. I think that this issue will be there on download also.\n\nEventually the suggested patch in the report will also fix that buffer overflow.\n\nAttached are two tested patches. One for the security fix and the other one for the tftp parsing options, so that we don't end up sending corrupted options.","markdown_message":"\u003cp\u003eI was not able to edit the original report, are you able to do so? I am using tftp-hpa-5.2 as a TFTP server with defaults.\u003c/p\u003e\n\n\u003cp\u003eAbout the security issue: spacket/rpacket are allocated of blksize (44B). Also, we fail to error when buffer is too small for adding TFTP options. We end up not sending the \u0026#39;blocksize\u0026#39; request in the options. Everything is corrupted, \u0026#39;tsize\u0026#39; has value \u0026#39;44\u0026#39;... The server then responds with OACK that does not contain any blksize, since it was not requested, then \u0026#39;tftp_parse_option_ack()\u0026#39; resets blksize to 512B and we end up doing recvfrom() with a size bigger than what was allocated. I think that this issue will be there on download also.\u003c/p\u003e\n\n\u003cp\u003eEventually the suggested patch in the report will also fix that buffer overflow.\u003c/p\u003e\n\n\u003cp\u003eAttached are two tested patches. One for the security fix and the other one for the tftp parsing options, so that we don\u0026#39;t end up sending corrupted options.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T16:00:33.397Z","updated_at":"2019-08-31T16:00:33.397Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":571341,"filename":"0002-tftp-Alloc-maximum-blksize-and-use-default-unless-OA.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CC8yuC3ekREjDbzRF9DowKa3?response-content-disposition=attachment%3B%20filename%3D%220002-tftp-Alloc-maximum-blksize-and-use-default-unless-OA.patch%22%3B%20filename%2A%3DUTF-8%27%270002-tftp-Alloc-maximum-blksize-and-use-default-unless-OA.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063754Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=3acd6b86adc21bc0d096655ce4c0e770ad75b8cefe0e58ca8043ad322c8ef7fc"},{"id":571340,"filename":"0001-tftp-return-error-when-packet-is-too-small-for-optio.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PtYvDzfVqADrKbQVg4UKumdp?response-content-disposition=attachment%3B%20filename%3D%220001-tftp-return-error-when-packet-is-too-small-for-optio.patch%22%3B%20filename%2A%3DUTF-8%27%270001-tftp-return-error-when-packet-is-too-small-for-optio.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063754Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=d1aa64648cffb13fa6fd576b46dae6b8f84e50f29ac293cda365ffbea7b7030d"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5705157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The attack would be from server PoV, when seeing smaller than 512B blksize requests from client, respond with an OACK without blksize. The server would be able to trigger write after the malloced 'rpacket.data'.","markdown_message":"\u003cp\u003eThe attack would be from server PoV, when seeing smaller than 512B blksize requests from client, respond with an OACK without blksize. The server would be able to trigger write after the malloced \u0026#39;rpacket.data\u0026#39;.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-31T16:16:58.846Z","updated_at":"2019-08-31T16:16:58.846Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5709986,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-02T07:16:49.879Z","updated_at":"2019-09-02T07:16:49.879Z","additional_data":{"old_title":"With TFTP blksize requests \u003e 512, when OACK is not sent, libcurl detects EOF instead assuming 512 bytes block size","new_title":"Heap buffer overflow in TFTP when uploading using small blksize"},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5710045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!\n\nI'm still curious why the test command line doesn't crash the curl test I wrote up. I'd sleep better if we could make sure we can first repro the problem against the curl test suite server, then apply the fix and see that it doesn't trigger anymore - in the test case. Can you give it a look and see if you can understand it? If you build the curl test suite, all you need to do is copy my attached file to tests/data and then you can run test case 336.\n\nSince blksize 44 seems to be a too small value to be sensible, maybe we should also just bump the minimum allowed size to make it more practical and less likely to let the user shoot itself in the foot? Maybe bump that to 128? I doubt there is any real-world use case where people actually need or use that small blocks anyway.","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m still curious why the test command line doesn\u0026#39;t crash the curl test I wrote up. I\u0026#39;d sleep better if we could make sure we can first repro the problem against the curl test suite server, then apply the fix and see that it doesn\u0026#39;t trigger anymore - in the test case. Can you give it a look and see if you can understand it? If you build the curl test suite, all you need to do is copy my attached file to tests/data and then you can run test case 336.\u003c/p\u003e\n\n\u003cp\u003eSince blksize 44 seems to be a too small value to be sensible, maybe we should also just bump the minimum allowed size to make it more practical and less likely to let the user shoot itself in the foot? Maybe bump that to 128? I doubt there is any real-world use case where people actually need or use that small blocks anyway.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T07:24:58.141Z","updated_at":"2019-09-02T07:24:58.141Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5710726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that the heap buffer overflow issue in the title is not upload specific. When using a blksize \u003c512, either for upload or download, if the server responds with a OACK without any 'blksize', we end up doing the buffer overflow anyway. This issue is independent from the tftp option parsing issue, hence separate patch provided.\n\nNow I happen to have triggered the OACK response without blksize in it, incidentally, through the tftp option writing bug.\n\nTo repro exactly the tftp option and the overflow bugs, you can use exact filename length and blksize value that I provided. blksize big enough to pass filename check, and small enough to cause tftp option truncation. With tftp-hpa-5.2 it is known to reproduce. The file length is had used is 1kB.\n\nAlso growing the minimal block size could make sense, but it will not fix the heap buffer overflow or the tfp option writing at all. imho, we should better add proper length checks first.\n\nFor the unit test, it seems that the test tftpd server is not sending OACK, so the buffer overflow will not reproduce. For the tftp-option, it also seems that the infra is anyway sending first packet with filename as 'verfiedserver' and a block size of 512B, so it will not reproduce too.","markdown_message":"\u003cp\u003ePlease note that the heap buffer overflow issue in the title is not upload specific. When using a blksize \u0026lt;512, either for upload or download, if the server responds with a OACK without any \u0026#39;blksize\u0026#39;, we end up doing the buffer overflow anyway. This issue is independent from the tftp option parsing issue, hence separate patch provided.\u003c/p\u003e\n\n\u003cp\u003eNow I happen to have triggered the OACK response without blksize in it, incidentally, through the tftp option writing bug.\u003c/p\u003e\n\n\u003cp\u003eTo repro exactly the tftp option and the overflow bugs, you can use exact filename length and blksize value that I provided. blksize big enough to pass filename check, and small enough to cause tftp option truncation. With tftp-hpa-5.2 it is known to reproduce. The file length is had used is 1kB.\u003c/p\u003e\n\n\u003cp\u003eAlso growing the minimal block size could make sense, but it will not fix the heap buffer overflow or the tfp option writing at all. imho, we should better add proper length checks first.\u003c/p\u003e\n\n\u003cp\u003eFor the unit test, it seems that the test tftpd server is not sending OACK, so the buffer overflow will not reproduce. For the tftp-option, it also seems that the infra is anyway sending first packet with filename as \u0026#39;verfiedserver\u0026#39; and a block size of 512B, so it will not reproduce too.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T08:51:20.799Z","updated_at":"2019-09-02T08:51:20.799Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5711559,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-02T11:02:57.767Z","updated_at":"2019-09-02T11:02:57.767Z","additional_data":{"old_title":"Heap buffer overflow in TFTP when uploading using small blksize","new_title":"Heap buffer overflow in TFTP when using small blksize"},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5711757,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-02T11:51:10.327Z","updated_at":"2019-09-02T11:51:10.327Z","additional_data":{"old_severity":"Medium (6.3)","new_severity":"Medium (5.2)","old_severity_id":504934,"new_severity_id":506722},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5711775,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-02T11:53:44.952Z","updated_at":"2019-09-02T11:53:44.952Z","additional_data":{"added_weaknesses":[{"id":5,"name":"Heap Overflow"}],"removed_weaknesses":[{"id":65,"name":"Business Logic Errors"}]},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5711779,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-02T11:54:45.612Z","updated_at":"2019-09-02T11:54:45.612Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5711809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would like us to proceed like this and I hope you're ok with it @thomas_v:\n\n1. Write up an advisory the describes the problem accurately (I'll post a first draft within a few days)\n2. Request a CVE for it\n3. Schedule for this to be announced and the fix to be released in the upcoming 7.66.0 release on September 11.\n\nWe will also reward the reporter (@thomas_v) for this issue according to the rules of the curl bug bounty. We will discuss it among ourselves and come back with more details on that within shortly.","markdown_message":"\u003cp\u003eI would like us to proceed like this and I hope you\u0026#39;re ok with it \u003ca href=\"/thomas_v\"\u003e@thomas_v\u003c/a\u003e:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWrite up an advisory the describes the problem accurately (I\u0026#39;ll post a first draft within a few days)\u003c/li\u003e\n\u003cli\u003eRequest a CVE for it\u003c/li\u003e\n\u003cli\u003eSchedule for this to be announced and the fix to be released in the upcoming 7.66.0 release on September 11.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWe will also reward the reporter (@thomas_v) for this issue according to the rules of the curl bug bounty. We will discuss it among ourselves and come back with more details on that within shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T12:00:24.608Z","updated_at":"2019-09-02T12:00:24.608Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5712370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"First take at an advisory for this issue.\n\n(The CVE name is temporary and there's no actual link to the patch yet)\n\nIf you have edits; spell them out, do them as diffs or post a new version of the entire thing and I'll merge them into my local copy.","markdown_message":"\u003cp\u003eFirst take at an advisory for this issue.\u003c/p\u003e\n\n\u003cp\u003e(The CVE name is temporary and there\u0026#39;s no actual link to the patch yet)\u003c/p\u003e\n\n\u003cp\u003eIf you have edits; spell them out, do them as diffs or post a new version of the entire thing and I\u0026#39;ll merge them into my local copy.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T13:22:03.502Z","updated_at":"2019-09-02T13:22:03.502Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":572787,"filename":"CVE-2019-AAAA.md","type":"text/markdown","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/SkfL9zjMx1HJETc7VbNXCemL?response-content-disposition=attachment%3B%20filename%3D%22CVE-2019-AAAA.md%22%3B%20filename%2A%3DUTF-8%27%27CVE-2019-AAAA.md\u0026response-content-type=text%2Fmarkdown\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063754Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=8826a3e0281880ff0d06db39131ae5c040fefd706fd9be73e560bdd2915ca9ff"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5712813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I updated the advisory with couple of precisions. In particular, the issue will be triggered with an OACK _without_ a BLKSIZE information it it. Also the previous fix is not a regression.\n\nFeel free to re-edit if needed. Attached is the result of the update.\n","markdown_message":"\u003cp\u003eI updated the advisory with couple of precisions. In particular, the issue will be triggered with an OACK \u003cu\u003ewithout\u003c/u\u003e a BLKSIZE information it it. Also the previous fix is not a regression.\u003c/p\u003e\n\n\u003cp\u003eFeel free to re-edit if needed. Attached is the result of the update.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T14:44:31.320Z","updated_at":"2019-09-02T14:44:31.320Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":572833,"filename":"CVE-2019-AAAA.02.md.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/F6tn5Usoup7hQrFmKc4MEYQM?response-content-disposition=attachment%3B%20filename%3D%22CVE-2019-AAAA.02.md.txt%22%3B%20filename%2A%3DUTF-8%27%27CVE-2019-AAAA.02.md.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063754Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=ce5137337a33af9cb8be90e83c7280267f2f8e975dfd41af2c2fb6f06cb9bba2"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5715476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-03T06:37:04.333Z","updated_at":"2019-09-03T06:37:04.333Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5715697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've submitted a request for a CVE.","markdown_message":"\u003cp\u003eI\u0026#39;ve submitted a request for a CVE.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-03T07:27:00.756Z","updated_at":"2019-09-03T07:27:00.756Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5734663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE-2019-5482","markdown_message":"\u003cp\u003eCVE-2019-5482\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-05T05:30:01.945Z","updated_at":"2019-09-05T05:30:01.945Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5734665,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-05T05:30:30.027Z","updated_at":"2019-09-05T05:30:30.027Z","cve_ids":["CVE-2019-5482"],"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5734715,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks. We've decided to reward this report the same amount as the previously detected and very similar TFTP problem, but add a little extra to increase the levels somewhat. That makes a 250 USD reward.","markdown_message":"\u003cp\u003eThanks. We\u0026#39;ve decided to reward this report the same amount as the previously detected and very similar TFTP problem, but add a little extra to increase the levels somewhat. That makes a 250 USD reward.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-05T05:55:12.600Z","updated_at":"2019-09-05T05:55:12.600Z","actor":{"url":"/curl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"curl"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"curl","collaborator":{"username":"thomas_v","url":"/thomas_v"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5737251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Much appreciated, thank you!","markdown_message":"\u003cp\u003eMuch appreciated, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-05T10:21:05.931Z","updated_at":"2019-09-05T10:21:05.931Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5779759,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-11T12:58:24.079Z","updated_at":"2019-09-11T12:58:24.079Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"thomas_v","url":"/thomas_v"},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9730814,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-05T08:37:41.006Z","updated_at":"2020-11-05T08:37:41.006Z","first_to_agree":true,"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9823301,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-14T15:17:25.857Z","updated_at":"2020-11-14T15:17:25.857Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9823302,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-14T15:17:25.918Z","updated_at":"2020-11-14T15:17:25.918Z","actor":{"username":"thomas_v","cleared":false,"url":"/thomas_v","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}