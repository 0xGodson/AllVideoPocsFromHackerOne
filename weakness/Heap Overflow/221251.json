{"id":221251,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEyNTE=","url":"https://hackerone.com/reports/221251","title":"heap-buffer-overflow (read outside of buffer) in mrb_vm_exec()","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-04-15T18:08:56.021Z","submitted_at":"2017-04-15T18:08:56.021Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-09T12:43:39.447Z","bug_reporter_agreed_on_going_public_at":"2017-05-09T02:45:30.738Z","team_member_agreed_on_going_public_at":"2017-05-09T12:43:39.389Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Triggered in `3231219` (14 April 2017). Compiled with afl-gcc + asan.\n\n`./mirb \u003c test000`\n\n```\n==10555==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200001c920 at pc 0x52be2c bp 0x7ffe6751ada0 sp 0x7ffe6751ad98\nREAD of size 16 at 0x60200001c920 thread T0\n    #0 0x52be2b in mrb_vm_exec /root/mruby/src/vm.c:1556\n    #1 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #2 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #3 0x53260f in ecall /root/mruby/src/vm.c:320\n    #4 0x4fd59f in mrb_vm_exec /root/mruby/src/vm.c:1716\n    #5 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #6 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #7 0x53260f in ecall /root/mruby/src/vm.c:320\n    #8 0x508b65 in mrb_vm_exec /root/mruby/src/vm.c:1170\n    #9 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #10 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #11 0x53260f in ecall /root/mruby/src/vm.c:320\n    #12 0x508b65 in mrb_vm_exec /root/mruby/src/vm.c:1170\n    #13 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #14 0x40781f in main /root/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n    #15 0x7f93c4ea5b44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b44)\n    #16 0x40a71c (/root/mruby/bin/mirb+0x40a71c)\n\n0x60200001c920 is located 0 bytes to the right of 16-byte region [0x60200001c910,0x60200001c920)\nallocated by thread T0 here:\n    #0 0x7f93c55849f6 in __interceptor_realloc (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x549f6)\n    #1 0x421a2e in mrb_realloc_simple /root/mruby/src/gc.c:202\n    #2 0x421a2e in mrb_realloc /root/mruby/src/gc.c:216\n    #3 0x421a2e in mrb_malloc /root/mruby/src/gc.c:237\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/mruby/src/vm.c:1556 mrb_vm_exec\n```","vulnerability_information_html":"\u003cp\u003eTriggered in \u003ccode\u003e3231219\u003c/code\u003e (14 April 2017). Compiled with afl-gcc + asan.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e./mirb \u0026lt; test000\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e==10555==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200001c920 at pc 0x52be2c bp 0x7ffe6751ada0 sp 0x7ffe6751ad98\nREAD of size 16 at 0x60200001c920 thread T0\n    #0 0x52be2b in mrb_vm_exec /root/mruby/src/vm.c:1556\n    #1 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #2 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #3 0x53260f in ecall /root/mruby/src/vm.c:320\n    #4 0x4fd59f in mrb_vm_exec /root/mruby/src/vm.c:1716\n    #5 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #6 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #7 0x53260f in ecall /root/mruby/src/vm.c:320\n    #8 0x508b65 in mrb_vm_exec /root/mruby/src/vm.c:1170\n    #9 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #10 0x53260f in mrb_run /root/mruby/src/vm.c:2644\n    #11 0x53260f in ecall /root/mruby/src/vm.c:320\n    #12 0x508b65 in mrb_vm_exec /root/mruby/src/vm.c:1170\n    #13 0x530a19 in mrb_vm_run /root/mruby/src/vm.c:829\n    #14 0x40781f in main /root/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n    #15 0x7f93c4ea5b44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b44)\n    #16 0x40a71c (/root/mruby/bin/mirb+0x40a71c)\n\n0x60200001c920 is located 0 bytes to the right of 16-byte region [0x60200001c910,0x60200001c920)\nallocated by thread T0 here:\n    #0 0x7f93c55849f6 in __interceptor_realloc (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x549f6)\n    #1 0x421a2e in mrb_realloc_simple /root/mruby/src/gc.c:202\n    #2 0x421a2e in mrb_realloc /root/mruby/src/gc.c:216\n    #3 0x421a2e in mrb_malloc /root/mruby/src/gc.c:237\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/mruby/src/vm.c:1556 mrb_vm_exec\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":176172,"file_name":"test000","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/172/fca839da8ed6c9f6598c8fc6ba9d4c9853280ec4/test000?response-content-disposition=attachment%3B%20filename%3D%22test000%22%3B%20filename%2A%3DUTF-8%27%27test000\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050015Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=c6f801aa4d9bb5811a03e5541ae4129d9683b822bc6a571bc6917b07a6e7df74","file_size":198,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-06-08T02:45:30.783Z","allow_singular_disclosure_after":-112328084.4115825,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","geeknik","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1613327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to two weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the large volume of reports we have received, it may take us up to two weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-04-15T18:08:56.222Z","updated_at":"2017-04-15T18:08:56.222Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1615445,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the crash and opened an issue upstream: https://github.com/mruby/mruby/issues/3610","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the crash and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3610\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3610\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3610\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-17T13:53:42.028Z","updated_at":"2017-04-17T13:53:42.028Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1621053,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue was addressed upstream in the following commits:\n\nhttps://github.com/mruby/mruby/commit/82ab46139e6ee6bf664a5772cd83c37ed3bc17fe\nhttps://github.com/mruby/mruby/commit/05fceb5992c20c30a6b31f89d2b0aa0f0698a9a2\nhttps://github.com/mruby/mruby/commit/283d145d3efd04b04a008193e34f8b0f9d0aff16\n\nOur next round of bounty decisions will take place in approximately one week, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue was addressed upstream in the following commits:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/mruby/mruby/commit/82ab46139e6ee6bf664a5772cd83c37ed3bc17fe\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F82ab46139e6ee6bf664a5772cd83c37ed3bc17fe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/82ab46139e6ee6bf664a5772cd83c37ed3bc17fe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/mruby/mruby/commit/05fceb5992c20c30a6b31f89d2b0aa0f0698a9a2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F05fceb5992c20c30a6b31f89d2b0aa0f0698a9a2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/05fceb5992c20c30a6b31f89d2b0aa0f0698a9a2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/mruby/mruby/commit/283d145d3efd04b04a008193e34f8b0f9d0aff16\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F283d145d3efd04b04a008193e34f8b0f9d0aff16\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/283d145d3efd04b04a008193e34f8b0f9d0aff16\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place in approximately one week, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T13:47:54.783Z","updated_at":"2017-04-19T13:47:54.783Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1650273,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-02T22:05:09.447Z","updated_at":"2017-05-02T22:05:09.447Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1662071,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T02:45:30.754Z","updated_at":"2017-05-09T02:45:30.754Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1663023,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T12:43:39.414Z","updated_at":"2017-05-09T12:43:39.414Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1663024,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T12:43:39.464Z","updated_at":"2017-05-09T12:43:39.464Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}