{"id":293358,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTMzNTg=","url":"https://hackerone.com/reports/293358","title":"The Microsoft Store Uber App Does Not Implement Certificate Pinning","state":"Closed","substate":"duplicate","severity_rating":"critical","readable_substate":"Duplicate","created_at":"2017-11-28T03:18:23.439Z","submitted_at":"2017-11-28T03:18:23.439Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gregoryvperry","url":"/gregoryvperry","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-12-24T20:16:01.570Z","bug_reporter_agreed_on_going_public_at":"2017-12-11T16:54:03.537Z","team_member_agreed_on_going_public_at":"2017-12-24T20:16:01.507Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nThe Microsoft Store Uber App (Windows Phone Architecture) does not properly implement certificate pinning.\n\n## Security Impact\nLayer-2+ network traffic transmitted from and received by the app can be surreptitiously intercepted and transparently modified by an attacker, with no warnings or errors presented to the app user.\n\n## Reproduction Steps\nA transparent Layer-2 MITM proxy was configured between a device running the most recent release of the Uber app for Windows Phone Architecture and an Internet gateway. Self-signed certificates were asserted on behalf of the remote systems that the app communicated with. All traffic transmitted and received by the Uber app was able to be captured and then modified transparently, without any notifications or certificate warnings sent to the app user.\n\n## Specifics\n* Account GregPerry804@gmail.com was used for testing\n* It appears that the apps for iOS and Android properly implement certificate pinning, with only the Windows Phone Architecture Uber App affected by this vulnerability.\n\n## Impact\n\nIn this scenario an attacker has the ability to modify a rider's profile, to access previous trip histories, to schedule and/or cancel Uber driver dispatches, and the ability to access and/or modify stored payment information.\n\nDriver functionality was not tested. If the Uber Driver role is also implemented within the Microsoft Phone Architecture Uber App, then all functionality encapsulated within the app as relates to driver functionality could be surreptitiously observed and/or transparently modified as well.\n\nThis particular vulnerability can be implemented as an ARP cache poisoning attack, making it especially relevant to Uber riders who utilize wireless access points at public hotspots to dispatch Uber rides.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe Microsoft Store Uber App (Windows Phone Architecture) does not properly implement certificate pinning.\u003c/p\u003e\n\n\u003ch2 id=\"security-impact\"\u003eSecurity Impact\u003c/h2\u003e\n\n\u003cp\u003eLayer-2+ network traffic transmitted from and received by the app can be surreptitiously intercepted and transparently modified by an attacker, with no warnings or errors presented to the app user.\u003c/p\u003e\n\n\u003ch2 id=\"reproduction-steps\"\u003eReproduction Steps\u003c/h2\u003e\n\n\u003cp\u003eA transparent Layer-2 MITM proxy was configured between a device running the most recent release of the Uber app for Windows Phone Architecture and an Internet gateway. Self-signed certificates were asserted on behalf of the remote systems that the app communicated with. All traffic transmitted and received by the Uber app was able to be captured and then modified transparently, without any notifications or certificate warnings sent to the app user.\u003c/p\u003e\n\n\u003ch2 id=\"specifics\"\u003eSpecifics\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eAccount \u003ca title=\"GregPerry804@gmail.com\" href=\"mailto:GregPerry804@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eGregPerry804@gmail.com\u003c/a\u003e was used for testing\u003c/li\u003e\n\u003cli\u003eIt appears that the apps for iOS and Android properly implement certificate pinning, with only the Windows Phone Architecture Uber App affected by this vulnerability.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIn this scenario an attacker has the ability to modify a rider\u0026#39;s profile, to access previous trip histories, to schedule and/or cancel Uber driver dispatches, and the ability to access and/or modify stored payment information.\u003c/p\u003e\n\n\u003cp\u003eDriver functionality was not tested. If the Uber Driver role is also implemented within the Microsoft Phone Architecture Uber App, then all functionality encapsulated within the app as relates to driver functionality could be surreptitiously observed and/or transparently modified as well.\u003c/p\u003e\n\n\u003cp\u003eThis particular vulnerability can be implemented as an ARP cache poisoning attack, making it especially relevant to Uber riders who utilize wireless access points at public hotspots to dispatch Uber rides.\u003c/p\u003e\n","weakness":{"id":28,"name":"Improper Certificate Validation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["jensec","fa1rlight","bugdiscloseguys","hbargi","mntl_","gregoryvperry","tkye"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2187448,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@gregperry,\n\nAwesome, glad to see your account got whitelisted!\n\nWe'll take a look and follow-up ASAP when we have more details.\n\nThanks,\nRob","markdown_message":"\u003cp\u003e\u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAwesome, glad to see your account got whitelisted!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll take a look and follow-up ASAP when we have more details.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nRob\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T20:04:31.104Z","updated_at":"2017-11-28T20:04:31.104Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2214653,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"This limitation is already known to us and as such we'll be closing this `duplicate` per our program guidelines.","markdown_message":"\u003cp\u003eThis limitation is already known to us and as such we\u0026#39;ll be closing this \u003ccode\u003eduplicate\u003c/code\u003e per our program guidelines.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-11T16:15:17.314Z","updated_at":"2017-12-11T16:15:17.314Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2214673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cute. Big surprise.","markdown_message":"\u003cp\u003eCute. Big surprise.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-11T16:22:04.075Z","updated_at":"2017-12-11T16:22:04.075Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2214781,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-11T16:54:03.565Z","updated_at":"2017-12-11T16:54:03.565Z","first_to_agree":true,"actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2245217,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-24T20:16:01.534Z","updated_at":"2017-12-24T20:16:01.534Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2245218,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-24T20:16:01.596Z","updated_at":"2017-12-24T20:16:01.596Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2256537,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-02T19:13:10.698Z","updated_at":"2018-01-02T19:13:10.698Z","actor":{"username":"hackerone-support","cleared":false,"url":"/hackerone-support","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/817/18a96ff3fda22c0a08cf114c5e7d2400fe41943c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}