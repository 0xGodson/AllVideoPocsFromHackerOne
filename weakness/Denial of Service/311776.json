{"id":311776,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTE3NzY=","url":"https://hackerone.com/reports/311776","title":"Securemail server used to internal spam and resource exhaustion","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-02-02T18:57:21.929Z","submitted_at":"2018-02-02T18:57:21.929Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"billy_blaze","url":"/billy_blaze","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-15T20:28:39.023Z","bug_reporter_agreed_on_going_public_at":"2018-02-15T20:28:38.963Z","team_member_agreed_on_going_public_at":"2018-02-15T20:03:11.794Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nConfidential message systems fails to restrict large amount of receivers. This might lead to hardware exhausting and/or attacking localtapiola internal employees as securemail recipient.\n\n**Description:** \nDespite https://secure.lahitapiola.fi/ is designed to send emails, there is small bug which allows user to exhaust server resources and or exhausting peoples work time. I used 376 different dummy non-existent *@lahitapiola.fi receiver in tests.\n\n**Impact:**\nLoss of worktime while checking thru every securemail email. It takes time to copy/paste received links and check if the contact is real or not. This is basically email spam with some steroids as sender server is lahitapiola´s trusted one. Mixing different senders addrs and attachments this could be neat tool to exploiters.\n\n## Browsers / Apps Verified In:\n\n  *Chrome, Firefox\n\n## Steps To Reproduce:\n\n  1. Go to https://secure.lahitapiola.fi/index and fill all fields. Intercept when sending email and add recipient email addresses separeted by comma in under Content-Disposition: form-data; name=\"recipient\"\n\n\n## Additional material\n\n  * not applicable\n\n## Related reports, best practices\n\n  * Deltagon´s secure mail allows user to add more than one recipient by clicking \"add row\". This can be manually overrided. There is no limit or it is very high. Service should restrict amount of default receivers or allow email to be send only to email addresses inserted thru \"add row\" process.\n\n## Impact\n\nspamming from 'trusted' source internal lahitapiola´s employees.","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nConfidential message systems fails to restrict large amount of receivers. This might lead to hardware exhausting and/or attacking localtapiola internal employees as securemail recipient.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nDespite \u003ca title=\"https://secure.lahitapiola.fi/\" href=\"/redirect?url=https%3A%2F%2Fsecure.lahitapiola.fi%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.lahitapiola.fi/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is designed to send emails, there is small bug which allows user to exhaust server resources and or exhausting peoples work time. I used 376 different dummy non-existent *@lahitapiola.fi receiver in tests.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003cbr\u003e\nLoss of worktime while checking thru every securemail email. It takes time to copy/paste received links and check if the contact is real or not. This is basically email spam with some steroids as sender server is lahitapiola´s trusted one. Mixing different senders addrs and attachments this could be neat tool to exploiters.\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cp\u003e*Chrome, Firefox\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://secure.lahitapiola.fi/index\" href=\"/redirect?url=https%3A%2F%2Fsecure.lahitapiola.fi%2Findex\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.lahitapiola.fi/index\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and fill all fields. Intercept when sending email and add recipient email addresses separeted by comma in under Content-Disposition: form-data; name=\u0026quot;recipient\u0026quot;\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003enot applicable\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eDeltagon´s secure mail allows user to add more than one recipient by clicking \u0026quot;add row\u0026quot;. This can be manually overrided. There is no limit or it is very high. Service should restrict amount of default receivers or allow email to be send only to email addresses inserted thru \u0026quot;add row\u0026quot; process.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003espamming from \u0026#39;trusted\u0026#39; source internal lahitapiola´s employees.\u003c/p\u003e\n","bounty_amount":"264.0","formatted_bounty":"$264","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["muon4","eveeez","ak1t4","t-4-y-m","namansahore","0x08"],"structured_scope":{"databaseId":1050,"asset_type":"URL","asset_identifier":"secure.lahitapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2346398,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report and http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/. Also, our policy contains a lot of information on what is relevant and what is not.*","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/\" href=\"/redirect?url=http%3A%2F%2Fblog.bugcrowd.com%2Fadvice-for-writing-a-great-vulnerability-report%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Also, our policy contains a lot of information on what is relevant and what is not.\u003c/em\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-02T20:15:46.205Z","updated_at":"2018-02-02T20:15:46.205Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2364030,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, there is a fix in production for this - have a look. The limit is now set at 20, according to business needs.","markdown_message":"\u003cp\u003eHi, there is a fix in production for this - have a look. The limit is now set at 20, according to business needs.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T21:05:32.712Z","updated_at":"2018-02-08T21:05:32.712Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2364051,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The bounty is based on a set standard for phishing and reports related to emails / spam.","markdown_message":"\u003cp\u003eThe bounty is based on a set standard for phishing and reports related to emails / spam.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T21:14:24.189Z","updated_at":"2018-02-08T21:14:24.189Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"264.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"billy_blaze","url":"/billy_blaze"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2367058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nLimit working. ","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nLimit working. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T14:11:19.409Z","updated_at":"2018-02-09T14:11:19.409Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2368322,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved. Thanks.","markdown_message":"\u003cp\u003eClosing as resolved. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T18:16:37.902Z","updated_at":"2018-02-09T18:16:37.902Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"billy_blaze","url":"/billy_blaze"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2387730,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We can do full disclosure.","markdown_message":"\u003cp\u003eWe can do full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-15T20:03:11.849Z","updated_at":"2018-02-15T20:03:11.849Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2387803,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-15T20:28:38.990Z","updated_at":"2018-02-15T20:28:38.990Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2387804,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-15T20:28:39.051Z","updated_at":"2018-02-15T20:28:39.051Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6639,"category":"team","content":"##Issue\n\nThe reporter found that the secure messaging platform did not restrict the amount of recipients which could lead to a logical denial of service by flooding the backoffice with spam.\n\n##Fix\n\nA limit was introduced.\n\n##Reasoning\n\nThe messaging platform by definition allows sending of emails, also to multiple recipients. The report revealed an issue that could theoretically cause a \"non-technical resource exhaustion\" in the backoffice. People would get overwhelmed by spam filling their inboxes. Theoretical for the reason that there are controls in the backoffice limiting the impact. The proof in this report was fair and reasonable enough without actually flooding.\n","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found that the secure messaging platform did not restrict the amount of recipients which could lead to a logical denial of service by flooding the backoffice with spam.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eA limit was introduced.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe messaging platform by definition allows sending of emails, also to multiple recipients. The report revealed an issue that could theoretically cause a \u0026quot;non-technical resource exhaustion\u0026quot; in the backoffice. People would get overwhelmed by spam filling their inboxes. Theoretical for the reason that there are controls in the backoffice limiting the impact. The proof in this report was fair and reasonable enough without actually flooding.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}