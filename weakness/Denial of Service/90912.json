{"id":90912,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDkxMg==","url":"https://hackerone.com/reports/90912","title":"Inadequate input validation on API endpoint leading to self denial of service and increased system load.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-29T13:59:37.609Z","submitted_at":"2015-09-29T13:59:37.609Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mantis","url":"/mantis","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EBC5Yt74S3Vwtd7eVYs4PqQy/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-12T17:45:20.270Z","bug_reporter_agreed_on_going_public_at":"2015-10-12T17:08:51.895Z","team_member_agreed_on_going_public_at":"2015-10-12T17:45:20.070Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-11T17:08:52.074Z","allow_singular_disclosure_after":-161964063.88862896,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":602861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-30T11:02:07.156Z","updated_at":"2015-09-30T11:02:07.156Z","actor":{"username":"mantis","cleared":false,"url":"/mantis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EBC5Yt74S3Vwtd7eVYs4PqQy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":612610,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-07T11:04:31.063Z","updated_at":"2015-10-07T11:04:31.063Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617824,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:06:50.298Z","updated_at":"2015-10-12T17:06:50.298Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mantis","url":"/mantis"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617827,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:08:51.927Z","updated_at":"2015-10-12T17:08:51.927Z","first_to_agree":true,"actor":{"username":"mantis","cleared":false,"url":"/mantis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EBC5Yt74S3Vwtd7eVYs4PqQy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":617831,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:11:01.053Z","updated_at":"2015-10-12T17:11:01.053Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"mantis","url":"/mantis"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617867,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:34:57.033Z","updated_at":"2015-10-12T17:34:57.033Z","additional_data":{},"actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617868,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:35:22.642Z","updated_at":"2015-10-12T17:35:22.642Z","additional_data":{},"actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:45:20.103Z","updated_at":"2015-10-12T17:45:20.103Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":617877,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T17:45:20.301Z","updated_at":"2015-10-12T17:45:20.301Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":917,"category":"team","content":"## Summary\n\nA security researcher discovered an API payload that would send invalid data to their own user process, which would repeatedly fail to be handled correctly. This error handling loop prevented further access to their user account.\n\n## Details\n\nThe payload was a JSON object containing an empty string wrapped in an array as the value of the `to` key, sent to the [say](https://github.com/irccloud/irccloud-tools/wiki/API-RPC-Reference#post-say) API endpoint via a websocket.\n\ne.g. ```{\"to\": [\"\"]}```\n\n## Severity\n\nThe severity was limited to their own account, and was not replicable to other users or vulnerable to CSRF/redirection attacks. However, the looping error state also added increased load to the system, and unchecked, could have had knock on effects that would impact other users of the service.\n\n## Cause and resolution\n\nThe error was caused by inadequate input validation. A fix was released and verified by the researcher, who tested all other API endpoints for vulnerability in the process.\n\n## Credit\n\nWe're very grateful to Richard Clifford of [Pentura](http://www.pentura.com/) for the extra effort put into researching this issue and confirming the fix, and for following responsible disclosure practices in reporting it to us.\n\nThis class of issue would normally be eligible for a smaller bounty, but we're increasing the amount to reward the extra effort put into researching the issue and verifying the fix across multiple endpoints.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eA security researcher discovered an API payload that would send invalid data to their own user process, which would repeatedly fail to be handled correctly. This error handling loop prevented further access to their user account.\u003c/p\u003e\n\n\u003ch2 id=\"details\"\u003eDetails\u003c/h2\u003e\n\n\u003cp\u003eThe payload was a JSON object containing an empty string wrapped in an array as the value of the \u003ccode\u003eto\u003c/code\u003e key, sent to the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Firccloud%2Firccloud-tools%2Fwiki%2FAPI-RPC-Reference%23post-say\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esay\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e API endpoint via a websocket.\u003c/p\u003e\n\n\u003cp\u003ee.g. \u003ccode\u003e{\u0026quot;to\u0026quot;: [\u0026quot;\u0026quot;]}\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"severity\"\u003eSeverity\u003c/h2\u003e\n\n\u003cp\u003eThe severity was limited to their own account, and was not replicable to other users or vulnerable to CSRF/redirection attacks. However, the looping error state also added increased load to the system, and unchecked, could have had knock on effects that would impact other users of the service.\u003c/p\u003e\n\n\u003ch2 id=\"cause-and-resolution\"\u003eCause and resolution\u003c/h2\u003e\n\n\u003cp\u003eThe error was caused by inadequate input validation. A fix was released and verified by the researcher, who tested all other API endpoints for vulnerability in the process.\u003c/p\u003e\n\n\u003ch2 id=\"credit\"\u003eCredit\u003c/h2\u003e\n\n\u003cp\u003eWe\u0026#39;re very grateful to Richard Clifford of \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.pentura.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePentura\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for the extra effort put into researching this issue and confirming the fix, and for following responsible disclosure practices in reporting it to us.\u003c/p\u003e\n\n\u003cp\u003eThis class of issue would normally be eligible for a smaller bounty, but we\u0026#39;re increasing the amount to reward the extra effort put into researching the issue and verifying the fix across multiple endpoints.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}