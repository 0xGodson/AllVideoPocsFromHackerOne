{"id":694467,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTQ0Njc=","url":"https://hackerone.com/reports/694467","title":"load scripts DOS vulnerability","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-09-13T14:58:42.606Z","submitted_at":"2019-09-13T14:58:42.606Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"badisman","url":"/badisman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/614/3028a5d60a32a9e6aaff730d6c8e780707ec87b9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8146,"url":"https://hackerone.com/olx","handle":"olx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OLX","twitter_handle":"OLX","website":"http://olx.com","about":"OLX is an online classifieds platform that enables its users to create ads and display them on social networks."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-19T15:34:31.624Z","bug_reporter_agreed_on_going_public_at":"2020-02-18T15:34:27.788Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1) vulnerability description\n\nWordPress allows users to load multiple JS files and CSS files through load-scripts.php files at once. For example, https://wpwebsite.com/wp-admin/load-scripts.php?c=1\u0026load%5B%5D=jquery-ui-core,editor\u0026ver=4.9.1, file load-scripts.php will load jquery-ui-core and editor files automatically and return the contents of the file.\n\nHowever, the number and size of files are not restricted in the process of loading JS files, attackers can use this function to deplete server resources and launch denial of service attacks.\n\n(check references for more details about the vulnerability)\n2) attack details\n\n*affected link : http://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026load%5B%5D=jquery-ui-core\u0026ver=4.9.1\n\n*proof of concept ( description );\n\nthe load-scripts.php file was receiving a parameter called load[]. This parameter is an array that was receiving the names of the JS files that needed to be loaded. In this case, it was receiving jQuery UI Core, which is the name of one of the Javascript files used by the WordPress login page. (it can be longer, this is just an example)\nAs no rate-limiting is setup for this URL - then DoS comes real\n\n*proof of concept ( link ) ;\nhttp://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026load%5B%5D=jquery-ui-core\u0026ver=4.9.1\n\n3) how to fix\n\nThe web application firewall will mitigate attacks by adding the following to .htaccess -file:\n\n\u003cFiles load-scripts.php\u003e\n\nOrder allow, deny\n\nDeny from all\n\n\u003c/Files\u003e\n\n4) vulnerability classification:\n\n*owasp 2017 top 10 (A9 Using Components with Known Vulnerabilities )\n\n*CVE( Common Vulnerabilities and Exposures ) : https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389\n\n5) references:\n\nhttps://blog.threatpress.com/wordpress-vulnerability-dos/\n\nhttps://baraktawily.blogspot.com/2018/02/how-to-dos-29-of-world-wide-websites.html\n\n## Impact\n\nDenial of service","vulnerability_information_html":"\u003cp\u003e1) vulnerability description\u003c/p\u003e\n\n\u003cp\u003eWordPress allows users to load multiple JS files and CSS files through load-scripts.php files at once. For example, \u003ca title=\"https://wpwebsite.com/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core,editor\u0026amp;ver=4.9.1\" href=\"/redirect?url=https%3A%2F%2Fwpwebsite.com%2Fwp-admin%2Fload-scripts.php%3Fc%3D1%26load%255B%255D%3Djquery-ui-core%2Ceditor%26ver%3D4.9.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wpwebsite.com/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core,editor\u0026amp;ver=4.9.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, file load-scripts.php will load jquery-ui-core and editor files automatically and return the contents of the file.\u003c/p\u003e\n\n\u003cp\u003eHowever, the number and size of files are not restricted in the process of loading JS files, attackers can use this function to deplete server resources and launch denial of service attacks.\u003c/p\u003e\n\n\u003cp\u003e(check references for more details about the vulnerability)\u003cbr\u003e\n2) attack details\u003c/p\u003e\n\n\u003cp\u003e*affected link : \u003ca title=\"http://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core\u0026amp;ver=4.9.1\" href=\"/redirect?url=http%3A%2F%2Fblog.praca.olx.pl%2Fwp-admin%2Fload-scripts.php%3Fc%3D1%26load%255B%255D%3Djquery-ui-core%26ver%3D4.9.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core\u0026amp;ver=4.9.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e*proof of concept ( description );\u003c/p\u003e\n\n\u003cp\u003ethe load-scripts.php file was receiving a parameter called load[]. This parameter is an array that was receiving the names of the JS files that needed to be loaded. In this case, it was receiving jQuery UI Core, which is the name of one of the Javascript files used by the WordPress login page. (it can be longer, this is just an example)\u003cbr\u003e\nAs no rate-limiting is setup for this URL - then DoS comes real\u003c/p\u003e\n\n\u003cp\u003e*proof of concept ( link ) ;\u003cbr\u003e\n\u003ca title=\"http://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core\u0026amp;ver=4.9.1\" href=\"/redirect?url=http%3A%2F%2Fblog.praca.olx.pl%2Fwp-admin%2Fload-scripts.php%3Fc%3D1%26load%255B%255D%3Djquery-ui-core%26ver%3D4.9.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.praca.olx.pl/wp-admin/load-scripts.php?c=1\u0026amp;load%5B%5D=jquery-ui-core\u0026amp;ver=4.9.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e3) how to fix\u003c/p\u003e\n\n\u003cp\u003eThe web application firewall will mitigate attacks by adding the following to .htaccess -file:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;Files load-scripts.php\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eOrder allow, deny\u003c/p\u003e\n\n\u003cp\u003eDeny from all\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;/Files\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e4) vulnerability classification:\u003c/p\u003e\n\n\u003cp\u003e*owasp 2017 top 10 (A9 Using Components with Known Vulnerabilities )\u003c/p\u003e\n\n\u003cp\u003e*CVE( Common Vulnerabilities and Exposures ) : \u003ca title=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389\" href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2018-6389\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e5) references:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://blog.threatpress.com/wordpress-vulnerability-dos/\" href=\"/redirect?url=https%3A%2F%2Fblog.threatpress.com%2Fwordpress-vulnerability-dos%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.threatpress.com/wordpress-vulnerability-dos/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://baraktawily.blogspot.com/2018/02/how-to-dos-29-of-world-wide-websites.html\" href=\"/redirect?url=https%3A%2F%2Fbaraktawily.blogspot.com%2F2018%2F02%2Fhow-to-dos-29-of-world-wide-websites.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://baraktawily.blogspot.com/2018/02/how-to-dos-29-of-world-wide-websites.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-19T15:34:27.853Z","allow_singular_disclosure_after":-24591881.189260967,"singular_disclosure_allowed":true,"vote_count":9,"voters":["a_d_a_m","realtess","zelzal","sourceflow","cryptographer","klau5","gsilvapt","defectstar","electriceve"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6041740,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nWe are deeply grateful for the security issue you shared with us. OLX's staff will we working on this issue to solve it ASAP.\n\nWe would like to add you to our Security Hall of Fame site that is hosted on security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\n\nBest regards,\n\nEurope Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eWe are deeply grateful for the security issue you shared with us. OLX\u0026#39;s staff will we working on this issue to solve it ASAP.\u003c/p\u003e\n\n\u003cp\u003eWe would like to add you to our Security Hall of Fame site that is hosted on security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eEurope Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-15T08:41:24.713Z","updated_at":"2019-10-15T08:41:24.713Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6053652,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The issue has already been fixed.\n\nThanks again for the report.\n\nBest regards,\nEurope Security Team ","markdown_message":"\u003cp\u003eThe issue has already been fixed.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEurope Security Team \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-16T10:03:20.577Z","updated_at":"2019-10-16T10:03:20.577Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"badisman","url":"/badisman"},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6082057,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello thanks so much \ni would like to add my name on the hof ( badis ben abderaouf mansouri)","markdown_message":"\u003cp\u003ehello thanks so much \u003cbr\u003e\ni would like to add my name on the hof ( badis ben abderaouf mansouri)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-19T20:59:29.286Z","updated_at":"2019-10-19T20:59:29.286Z","actor":{"username":"badisman","cleared":false,"url":"/badisman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/614/3028a5d60a32a9e6aaff730d6c8e780707ec87b9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7080977,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"HI,\nCan this be disclosed?","markdown_message":"\u003cp\u003eHI,\u003cbr\u003e\nCan this be disclosed?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-18T15:34:27.810Z","updated_at":"2020-02-18T15:34:27.810Z","first_to_agree":true,"actor":{"username":"badisman","cleared":false,"url":"/badisman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/614/3028a5d60a32a9e6aaff730d6c8e780707ec87b9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7370234,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-19T15:34:31.670Z","updated_at":"2020-03-19T15:34:31.670Z","actor":{"url":"/olx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OLX"}},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}