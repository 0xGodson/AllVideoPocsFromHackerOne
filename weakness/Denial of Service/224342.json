{"id":224342,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQzNDI=","url":"https://hackerone.com/reports/224342","title":"Bypassing captcha in registration on Hosted site","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-04-27T14:05:38.032Z","submitted_at":"2017-04-27T14:05:38.032Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pavanw3b","url":"/pavanw3b","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-03T05:56:15.863Z","bug_reporter_agreed_on_going_public_at":"2017-07-03T05:56:15.801Z","team_member_agreed_on_going_public_at":"2017-05-18T19:52:52.130Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again,\n\nI believe the captcha on the user registration form is very simple and can be easily bypassed to automatically register any number of accounts.\n\nA program can read the math captcha, solve it and submit the form with the answer and the other required parameters \u0026 headers.\n\n**Note:** I read the out of scope guideline about \"rate limiting\". I guess that's about rate limiting password change or other places. Want to make sure this bug is not neglected.\n\n### Risk\nA bad guy can automate the form submission. This has a potential to degrade the server performance as each submission invokes multiple database transactions like checking username, inserting the form data into user table etc.\n\n### Proof of concept\nI'm attaching a small python script to this report, which can completely automates the registration form submission. When you run the script, it asks how many accounts you want to register. Once you enter, it creates that many users and also prints user details, captcha challenge with question and the link to access the public email inbox.\n\n### How to run the POC\n* Open a command or Terminal if on mac\n* Enter `python \u003cPATH\u003e/wl-captcha-bypass.py`\n* Enter a small number for `How many accounts do you want to create?`\n* Note the response. Follow the guide to verify the confirmation email. You can also verify at the backend.\n\n### Requirement to run the POC Python Script\n* python 2.7+\n* request\n* beautifulsoup\n*Please refer the internet to set up*\n\n### Suggested Fix\n* Configure a hard captcha. You can consider Google's reCAPTCHA.\n\nLet me know if any questions.","vulnerability_information_html":"\u003cp\u003eHello again,\u003c/p\u003e\n\n\u003cp\u003eI believe the captcha on the user registration form is very simple and can be easily bypassed to automatically register any number of accounts.\u003c/p\u003e\n\n\u003cp\u003eA program can read the math captcha, solve it and submit the form with the answer and the other required parameters \u0026amp; headers.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e I read the out of scope guideline about \u0026quot;rate limiting\u0026quot;. I guess that\u0026#39;s about rate limiting password change or other places. Want to make sure this bug is not neglected.\u003c/p\u003e\n\n\u003ch3 id=\"risk\"\u003eRisk\u003c/h3\u003e\n\n\u003cp\u003eA bad guy can automate the form submission. This has a potential to degrade the server performance as each submission invokes multiple database transactions like checking username, inserting the form data into user table etc.\u003c/p\u003e\n\n\u003ch3 id=\"proof-of-concept\"\u003eProof of concept\u003c/h3\u003e\n\n\u003cp\u003eI\u0026#39;m attaching a small python script to this report, which can completely automates the registration form submission. When you run the script, it asks how many accounts you want to register. Once you enter, it creates that many users and also prints user details, captcha challenge with question and the link to access the public email inbox.\u003c/p\u003e\n\n\u003ch3 id=\"how-to-run-the-poc\"\u003eHow to run the POC\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eOpen a command or Terminal if on mac\u003c/li\u003e\n\u003cli\u003eEnter \u003ccode\u003epython \u0026lt;PATH\u0026gt;/wl-captcha-bypass.py\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter a small number for \u003ccode\u003eHow many accounts do you want to create?\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNote the response. Follow the guide to verify the confirmation email. You can also verify at the backend.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"requirement-to-run-the-poc-python-script\"\u003eRequirement to run the POC Python Script\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003epython 2.7+\u003c/li\u003e\n\u003cli\u003erequest\u003c/li\u003e\n\u003cli\u003ebeautifulsoup\n\u003cem\u003ePlease refer the internet to set up\u003c/em\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"suggested-fix\"\u003eSuggested Fix\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eConfigure a hard captcha. You can consider Google\u0026#39;s reCAPTCHA.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLet me know if any questions.\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":180022,"file_name":"wl-captcha-bypass.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/180/022/ed1a623c47e44bd8e6f49d73daede65db8a6d81f/wl-captcha-bypass.py?response-content-disposition=attachment%3B%20filename%3D%22wl-captcha-bypass.py%22%3B%20filename%2A%3DUTF-8%27%27wl-captcha-bypass.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050221Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=3ed4d3ae5db143310b0613057f210a92acd27aa925a3ff2650b3e78d20aa37a5","file_size":3069,"type":"text/x-python"},{"id":180023,"file_name":"weblate-automated-registration.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/180/023/fad7446bfb4bfb97a463c03b48880cb40f3c1223/weblate-automated-registration.png?response-content-disposition=attachment%3B%20filename%3D%22weblate-automated-registration.png%22%3B%20filename%2A%3DUTF-8%27%27weblate-automated-registration.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050221Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=7ba41b640c4215a2d81db60e3cf9bcc903941e78747ae60c5ae23fb9b3cc13cf","file_size":319229,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["pavanw3b"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1640024,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can delete the accounts I created for testing. All of them have first name `Abuser` and email `abuser****@mailinator.com`","markdown_message":"\u003cp\u003eYou can delete the accounts I created for testing. All of them have first name \u003ccode\u003eAbuser\u003c/code\u003e and email \u003ccode\u003eabuser****@mailinator.com\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T14:09:58.301Z","updated_at":"2017-04-27T14:09:58.301Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1640184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Indeed it's possible to bypass captcha by custom script. The main motivation behind it was to avoid automated submissions by generic bots and I think it serves this purpose quite well.\n\nUsing Google's reCAPTCHA was rejected some time ago for privacy reasons.","markdown_message":"\u003cp\u003eIndeed it\u0026#39;s possible to bypass captcha by custom script. The main motivation behind it was to avoid automated submissions by generic bots and I think it serves this purpose quite well.\u003c/p\u003e\n\n\u003cp\u003eUsing Google\u0026#39;s reCAPTCHA was rejected some time ago for privacy reasons.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T15:02:55.268Z","updated_at":"2017-04-27T15:02:55.268Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1642910,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Having harder captcha is certainly option for future, but current solution is good enough right now.\n\nWe will certainly address this in future, I've added this to our issue tracker at GitHub: https://github.com/WeblateOrg/weblate/issues/1462","markdown_message":"\u003cp\u003eHaving harder captcha is certainly option for future, but current solution is good enough right now.\u003c/p\u003e\n\n\u003cp\u003eWe will certainly address this in future, I\u0026#39;ve added this to our issue tracker at GitHub: \u003ca title=\"https://github.com/WeblateOrg/weblate/issues/1462\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fweblate%2Fissues%2F1462\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/weblate/issues/1462\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-28T16:04:08.394Z","updated_at":"2017-04-28T16:04:08.394Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1684319,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-18T19:52:52.154Z","updated_at":"2017-05-18T19:52:52.154Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1729645,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T07:45:17.149Z","updated_at":"2017-06-05T07:45:17.149Z","additional_data":{"duplicate_report_id":236401},"actor":{"username":"mishraanoopam98","cleared":false,"url":"/mishraanoopam98","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798369,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, would love to help other hunters!","markdown_message":"\u003cp\u003eSure, would love to help other hunters!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T05:56:15.829Z","updated_at":"2017-07-03T05:56:15.829Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798370,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T05:56:15.882Z","updated_at":"2017-07-03T05:56:15.882Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}