{"id":13652,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzY1Mg==","url":"https://hackerone.com/reports/13652","title":"Proxy service crash DoS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-27T15:54:52.896Z","submitted_at":"2014-05-27T15:54:52.896Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bitquark","url":"/bitquark","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3,"url":"https://hackerone.com/factlink","handle":"factlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Factlink","twitter_handle":"factlink","website":"https://factlink.com","about":"Share your knowledge with the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-06-04T11:19:15.608Z","bug_reporter_agreed_on_going_public_at":"2014-06-04T11:19:15.461Z","team_member_agreed_on_going_public_at":"2014-06-04T09:44:48.135Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Sending certain URLs to the proxy appears to crash the service, leading to a _502 Bad Gateway_ from nginx, presumably until the service is restarted. The following sequence sent in a short period appears to cause the crash (it could just be the _javascript:confirm()_ request, as the last request receives the 502, but I can't re-test to be sure):\r\n\r\nhttp://staging.fct.li/?url=data:text/html,Hello\r\nhttp://staging.fct.li/?url=data://text/html,Hello\r\nhttp://staging.fct.li/?url=data://staging.fct.li/\r\nhttp://staging.fct.li/?url=javascript:confirm()\r\nhttp://staging.fct.li/?url=javascript:confirm(\"staging.fct.li\")","vulnerability_information_html":"\u003cp\u003eSending certain URLs to the proxy appears to crash the service, leading to a \u003cu\u003e502 Bad Gateway\u003c/u\u003e from nginx, presumably until the service is restarted. The following sequence sent in a short period appears to cause the crash (it could just be the \u003cu\u003ejavascript:confirm()\u003c/u\u003e request, as the last request receives the 502, but I can\u0026#39;t re-test to be sure):\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://staging.fct.li/?url=data:text/html,Hello\" href=\"/redirect?url=http%3A%2F%2Fstaging.fct.li%2F%3Furl%3Ddata%3Atext%2Fhtml%2CHello\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://staging.fct.li/?url=data:text/html,Hello\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://staging.fct.li/?url=data://text/html,Hello\" href=\"/redirect?url=http%3A%2F%2Fstaging.fct.li%2F%3Furl%3Ddata%3A%2F%2Ftext%2Fhtml%2CHello\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://staging.fct.li/?url=data://text/html,Hello\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://staging.fct.li/?url=data://staging.fct.li/\" href=\"/redirect?url=http%3A%2F%2Fstaging.fct.li%2F%3Furl%3Ddata%3A%2F%2Fstaging.fct.li%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://staging.fct.li/?url=data://staging.fct.li/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://staging.fct.li/?url=javascript:confirm()\" href=\"/redirect?url=http%3A%2F%2Fstaging.fct.li%2F%3Furl%3Djavascript%3Aconfirm%28%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://staging.fct.li/?url=javascript:confirm()\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://staging.fct.li/?url=javascript:confirm(%22staging.fct.li%22)\" href=\"/redirect?url=http%3A%2F%2Fstaging.fct.li%2F%3Furl%3Djavascript%3Aconfirm%28%2522staging.fct.li%2522%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://staging.fct.li/?url=javascript:confirm(%22staging.fct.li%22)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-04T09:03:28.301Z","allow_singular_disclosure_after":-204751382.0918588,"singular_disclosure_allowed":true,"vote_count":7,"voters":["sw33tlie","eveeez","ak1t4","linkks","japz","nigba","b73772bded7541989b54f6a"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":58557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report. I've just restarted the proxy. Could you confirm it's because of the javascript:confirm() requests?","markdown_message":"\u003cp\u003eThanks for your report. I\u0026#39;ve just restarted the proxy. Could you confirm it\u0026#39;s because of the javascript:confirm() requests?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T16:59:11.087Z","updated_at":"2014-05-27T16:59:11.087Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":58679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, I've confirmed that that particular URL is causing the issue (and crashed the proxy again, apologies!), however it doesn't seem to happen if the URL is opened in the browser directly. If you wouldn't mind letting me know when the proxy has been restarted I have a theory that I'd like to test :-)","markdown_message":"\u003cp\u003eThanks, I\u0026#39;ve confirmed that that particular URL is causing the issue (and crashed the proxy again, apologies!), however it doesn\u0026#39;t seem to happen if the URL is opened in the browser directly. If you wouldn\u0026#39;t mind letting me know when the proxy has been restarted I have a theory that I\u0026#39;d like to test :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T17:54:44.418Z","updated_at":"2014-05-27T17:54:44.418Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":58954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem, thanks for your help! I've restarted the proxy. (please do not test this on our production environment). Feel free to test some more with our proxy.\n\nYou can also run the proxy on your local machine. The code can be found on: https://github.com/Factlink/web-proxy","markdown_message":"\u003cp\u003eNo problem, thanks for your help! I\u0026#39;ve restarted the proxy. (please do not test this on our production environment). Feel free to test some more with our proxy.\u003c/p\u003e\n\n\u003cp\u003eYou can also run the proxy on your local machine. The code can be found on: \u003ca title=\"https://github.com/Factlink/web-proxy\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFactlink%2Fweb-proxy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/Factlink/web-proxy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T20:59:58.543Z","updated_at":"2014-05-27T20:59:58.543Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59521,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, got it. It's the double quotes that are causing the issue. If the browser sends them encoded as _%22_ the proxy works just fine, but sending them through unencoded as _\"_ \nbreaks the proxy.\n\nI haven't got time to go through the source, but the logs might be a good place to start!","markdown_message":"\u003cp\u003eOkay, got it. It\u0026#39;s the double quotes that are causing the issue. If the browser sends them encoded as \u003cu\u003e%22\u003c/u\u003e the proxy works just fine, but sending them through unencoded as \u003cu\u003e\u0026quot;\u003c/u\u003e \u003cbr\u003e\nbreaks the proxy.\u003c/p\u003e\n\n\u003cp\u003eI haven\u0026#39;t got time to go through the source, but the logs might be a good place to start!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T11:52:30.436Z","updated_at":"2014-05-28T11:52:30.436Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":59581,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your research. I can reproduce it locally as well know. I'll look into it, and will let you know as soon as we fix it.","markdown_message":"\u003cp\u003eThanks for your research. I can reproduce it locally as well know. I\u0026#39;ll look into it, and will let you know as soon as we fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T13:01:17.072Z","updated_at":"2014-05-28T13:01:17.072Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59586,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any time. Thanks guys :-)","markdown_message":"\u003cp\u003eAny time. Thanks guys :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T13:10:27.846Z","updated_at":"2014-05-28T13:10:27.846Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":66161,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Turns out this was actually a bug in Goliath (our webserver). It was actually fixed before, but never released:\n\nhttps://github.com/postrank-labs/goliath/commit/5c0b74ff1d6470a4f15bd898e333aecf8771e32f\n\nWe run on their version now, so as far as I can see, this is fixed. Could you verify?","markdown_message":"\u003cp\u003eTurns out this was actually a bug in Goliath (our webserver). It was actually fixed before, but never released:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/postrank-labs/goliath/commit/5c0b74ff1d6470a4f15bd898e333aecf8771e32f\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fpostrank-labs%2Fgoliath%2Fcommit%2F5c0b74ff1d6470a4f15bd898e333aecf8771e32f\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/postrank-labs/goliath/commit/5c0b74ff1d6470a4f15bd898e333aecf8771e32f\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe run on their version now, so as far as I can see, this is fixed. Could you verify?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-04T09:03:28.329Z","updated_at":"2014-06-04T09:03:28.329Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bitquark","url":"/bitquark"},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":66212,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T09:44:48.150Z","updated_at":"2014-06-04T09:44:48.150Z","first_to_agree":true,"actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":66259,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Interesting, I'm glad it's been resolved. Just re-tested, looks good to me!","markdown_message":"\u003cp\u003eInteresting, I\u0026#39;m glad it\u0026#39;s been resolved. Just re-tested, looks good to me!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-04T11:02:48.593Z","updated_at":"2014-06-04T11:02:48.593Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":66269,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T11:19:15.477Z","updated_at":"2014-06-04T11:19:15.477Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":66270,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T11:19:15.623Z","updated_at":"2014-06-04T11:19:15.623Z","actor":{"username":"bitquark","cleared":false,"url":"/bitquark","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/068/5b51009b3fd817bf0a054d36aa792c7068efa1b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}