{"id":390,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTA=","url":"https://hackerone.com/reports/390","title":"Pixel flood attack","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2013-11-12T16:04:27.096Z","submitted_at":"2013-11-12T16:04:27.096Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"beurtschipper","url":"/beurtschipper","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2013-11-30T12:50:43.920Z","bug_reporter_agreed_on_going_public_at":"2013-11-30T12:50:43.920Z","team_member_agreed_on_going_public_at":"2013-11-29T22:37:26.143Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey guys,\r\n\r\nI just found a way to make your service timeout. I didn't know if I should put this under the Internet section of just the HackerOne section, because the exploit also crashes my Windows Image Viewer. A lot of other services should be vulnerable as well.\r\n\r\nFor the sake of responsible disclosure I haven't made an article about this yet. But if you fix this problem I would like to publish this for my ego, and because of the maximum giggles I experienced after finding this.\r\n\r\nThe exploit is really simple. I have an image of 5kb, 260x260 pixels. In the image itself I exchange the 260x260 values with 0xfafa x 0xfafa (so 64250x64250 pixels). Now from what I remember your service tries to convert the image once uploaded. By loading the 'whole image' into memory, it tries to allocate 4128062500 pixels into memory, flooding the memory and causing DoS. This also happens with Windows Photo Viewer on my computer.\r\n\r\nAs attachments I sent three foto's of your service timing out (had to be sure it was my image), and the image with the 'spoofed' pixels.\r\n\r\nAs a patch I would just set a maximum amount of pixels an image can have.\r\n\r\nWith kind regards,\r\n\r\nSipke (Graa)","vulnerability_information_html":"\u003cp\u003eHey guys,\u003c/p\u003e\n\n\u003cp\u003eI just found a way to make your service timeout. I didn\u0026#39;t know if I should put this under the Internet section of just the HackerOne section, because the exploit also crashes my Windows Image Viewer. A lot of other services should be vulnerable as well.\u003c/p\u003e\n\n\u003cp\u003eFor the sake of responsible disclosure I haven\u0026#39;t made an article about this yet. But if you fix this problem I would like to publish this for my ego, and because of the maximum giggles I experienced after finding this.\u003c/p\u003e\n\n\u003cp\u003eThe exploit is really simple. I have an image of 5kb, 260x260 pixels. In the image itself I exchange the 260x260 values with 0xfafa x 0xfafa (so 64250x64250 pixels). Now from what I remember your service tries to convert the image once uploaded. By loading the \u0026#39;whole image\u0026#39; into memory, it tries to allocate 4128062500 pixels into memory, flooding the memory and causing DoS. This also happens with Windows Photo Viewer on my computer.\u003c/p\u003e\n\n\u003cp\u003eAs attachments I sent three foto\u0026#39;s of your service timing out (had to be sure it was my image), and the image with the \u0026#39;spoofed\u0026#39; pixels.\u003c/p\u003e\n\n\u003cp\u003eAs a patch I would just set a maximum amount of pixels an image can have.\u003c/p\u003e\n\n\u003cp\u003eWith kind regards,\u003c/p\u003e\n\n\u003cp\u003eSipke (Graa)\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":128,"file_name":"lottapixel.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/000/128/5f5a974e5f67ab7a11d2d92bd40f8997969f2f17/lottapixel.jpg?response-content-disposition=attachment%3B%20filename%3D%22lottapixel.jpg%22%3B%20filename%2A%3DUTF-8%27%27lottapixel.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054909Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=0aac2b684d61c0a095cdba9c78f6ffc03fb1c518b48e8c6ad019f5a7ddede514","file_size":4856,"type":"image/jpeg"},{"id":129,"file_name":"timeout1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/000/129/e3e0772eef6dfc5de6771a63ac2278a6f6322dd3/timeout1.png?response-content-disposition=attachment%3B%20filename%3D%22timeout1.png%22%3B%20filename%2A%3DUTF-8%27%27timeout1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054909Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=f9d4259ff73d82e52927d7acd6c01d99d05ccc75bc741d87398f6428484a951f","file_size":17589,"type":"image/png"},{"id":130,"file_name":"timeout2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/000/130/dde4645cf07170d871c7ef0dd55e1365e6796b00/timeout2.png?response-content-disposition=attachment%3B%20filename%3D%22timeout2.png%22%3B%20filename%2A%3DUTF-8%27%27timeout2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054909Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=f2ac21065dbc445a10f3f43cb01328336cf4703d20f959dcf50f360a98bc0fe5","file_size":17886,"type":"image/png"},{"id":131,"file_name":"timeout3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/000/131/508c53ebc5bcec601308545cc9e57a473f5c8f67/timeout3.png?response-content-disposition=attachment%3B%20filename%3D%22timeout3.png%22%3B%20filename%2A%3DUTF-8%27%27timeout3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054909Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=6d6d6a98203baa153729fcc66e613bd2b3d931a549852468421a8613d21ddcde","file_size":17957,"type":"image/png"}],"allow_singular_disclosure_at":"2013-11-30T12:50:44.000Z","allow_singular_disclosure_after":-223405105.2637977,"singular_disclosure_allowed":true,"vote_count":38,"voters":["test0x00","sw33tlie","jensec","bogdantcaciuc","bibekshah","sameerphad72","hackerhero","skansing","aishkendle","cuso4","and 28 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2178,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Nice catch! Thanks for your quick and prompt report. Shortly after you uploaded the tampered JPEG file, we noticed storage and memory exhaustion errors.\r\n\r\nThe bug seems to be related to Paperclip, a gem we use to process image uploads and resizing. Paperclip passes the file on to the `identify` command (part of the ImageMagick suite). This command somehow gets confused since the given dimensions differ from the actual dimensions. It runs out of memory and starts swapping to disk, which in turn increased disk I/O. \r\n\r\nWe identified two problems:\r\n\r\n- Paperclip seems to always run the `identify` command with the `exif:orientation` option enabled, while only one Paperclip feature (auto orient) needs this option. This option caused the DoS at our side. We fixed this by monkey patching [the way Paperclip builds a geometry string](https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/geometry_detector_factory.rb#L18). This is probably something that should get fixed in Paperclip too.\r\n- Paperclip started resizing the uploaded image even before it validated whether the image's dimensions were too large. We fixed this by instructing Paperclip to run validations before starting the resizing process.\r\n\r\nThanks again! We'll follow up regarding a reward soon.","markdown_message":"\u003cp\u003eNice catch! Thanks for your quick and prompt report. Shortly after you uploaded the tampered JPEG file, we noticed storage and memory exhaustion errors.\u003c/p\u003e\n\n\u003cp\u003eThe bug seems to be related to Paperclip, a gem we use to process image uploads and resizing. Paperclip passes the file on to the \u003ccode\u003eidentify\u003c/code\u003e command (part of the ImageMagick suite). This command somehow gets confused since the given dimensions differ from the actual dimensions. It runs out of memory and starts swapping to disk, which in turn increased disk I/O. \u003c/p\u003e\n\n\u003cp\u003eWe identified two problems:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePaperclip seems to always run the \u003ccode\u003eidentify\u003c/code\u003e command with the \u003ccode\u003eexif:orientation\u003c/code\u003e option enabled, while only one Paperclip feature (auto orient) needs this option. This option caused the DoS at our side. We fixed this by monkey patching \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthoughtbot%2Fpaperclip%2Fblob%2Fmaster%2Flib%2Fpaperclip%2Fgeometry_detector_factory.rb%23L18\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe way Paperclip builds a geometry string\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This is probably something that should get fixed in Paperclip too.\u003c/li\u003e\n\u003cli\u003ePaperclip started resizing the uploaded image even before it validated whether the image\u0026#39;s dimensions were too large. We fixed this by instructing Paperclip to run validations before starting the resizing process.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks again! We\u0026#39;ll follow up regarding a reward soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2013-11-12T21:58:27.518Z","updated_at":"2013-11-12T21:58:27.518Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"beurtschipper","url":"/beurtschipper"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2687,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2013-11-29T22:37:17.603Z","updated_at":"2013-11-29T22:37:17.603Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"beurtschipper","url":"/beurtschipper"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2688,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2013-11-29T22:37:26.160Z","updated_at":"2013-11-29T22:37:26.160Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2762,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the service! Never imagined I'd pay the rent with an image. :)","markdown_message":"\u003cp\u003eThanks for the service! Never imagined I\u0026#39;d pay the rent with an image. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2013-11-30T12:50:43.937Z","updated_at":"2013-11-30T12:50:43.937Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3902,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've got a few requests to post a follow up regarding the solution we ended up implementing.\r\n\r\nFor now, we're just monkey patching Paperclip's [geometry_detector_factory.rb](https://github.com/thoughtbot/paperclip/blob/73d40d165e739193a268b54baba170ed457799ac/lib/paperclip/geometry_detector_factory.rb) in order to disable ImageMagick's EXIF orientation option (which was causing the trouble here).\r\n\r\nHere's the monkey patch:\r\n\r\n```\r\nmodule Paperclip\r\n  class GeometryDetector\r\n    private\r\n\r\n    def geometry_string\r\n      begin\r\n        silence_stream(STDERR) do\r\n          Paperclip.run(\"identify\", \"-format '%wx%h,1' :file\", :file =\u003e \"#{path}[0]\")\r\n        end\r\n      rescue Cocaine::ExitStatusError\r\n        \"\"\r\n      rescue Cocaine::CommandNotFoundError =\u003e e\r\n        raise_because_imagemagick_missing\r\n      end\r\n    end\r\n  end\r\nend\r\n```","markdown_message":"\u003cp\u003eWe\u0026#39;ve got a few requests to post a follow up regarding the solution we ended up implementing.\u003c/p\u003e\n\n\u003cp\u003eFor now, we\u0026#39;re just monkey patching Paperclip\u0026#39;s \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthoughtbot%2Fpaperclip%2Fblob%2F73d40d165e739193a268b54baba170ed457799ac%2Flib%2Fpaperclip%2Fgeometry_detector_factory.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egeometry_detector_factory.rb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in order to disable ImageMagick\u0026#39;s EXIF orientation option (which was causing the trouble here).\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the monkey patch:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emodule Paperclip\n  class GeometryDetector\n    private\n\n    def geometry_string\n      begin\n        silence_stream(STDERR) do\n          Paperclip.run(\u0026quot;identify\u0026quot;, \u0026quot;-format \u0026#39;%wx%h,1\u0026#39; :file\u0026quot;, :file =\u0026gt; \u0026quot;#{path}[0]\u0026quot;)\n        end\n      rescue Cocaine::ExitStatusError\n        \u0026quot;\u0026quot;\n      rescue Cocaine::CommandNotFoundError =\u0026gt; e\n        raise_because_imagemagick_missing\n      end\n    end\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2014-01-21T21:10:35.357Z","updated_at":"2014-01-21T21:10:52.083Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}