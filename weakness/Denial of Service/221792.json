{"id":221792,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjE3OTI=","url":"https://hackerone.com/reports/221792","title":"Excessive allocation of memory in dtls1_preprocess_fragment() (CVE-2016-6308)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-18T07:42:44.573Z","submitted_at":"2017-04-18T07:42:44.573Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"theyarestone","url":"/theyarestone","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24,"url":"https://hackerone.com/ibb-openssl","handle":"ibb-openssl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OpenSSL (IBB)","twitter_handle":"","website":"https://www.openssl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-6308"],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-25T01:32:36.072Z","bug_reporter_agreed_on_going_public_at":"2017-05-25T01:32:36.018Z","team_member_agreed_on_going_public_at":"2017-05-24T16:14:15.620Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This issue is very similar to CVE-2016-6307. The underlying defect is different\nbut the security analysis and impacts are the same except that it impacts DTLS.\n\nA DTLS message includes 3 bytes for its length in the header for the message.\nThis would allow for messages up to 16Mb in length. Messages of this length are\nexcessive and OpenSSL includes a check to ensure that a peer is sending\nreasonably sized messages in order to avoid too much memory being consumed to\nservice a connection. A flaw in the logic of version 1.1.0 means that memory for\nthe message is allocated too early, prior to the excessive message length\ncheck. Due to way memory is allocated in OpenSSL this could mean an attacker\ncould force up to 21Mb to be allocated to service a connection. This could lead\nto a Denial of Service through memory exhaustion. However, the excessive message\nlength check still takes place, and this would cause the connection to\nimmediately fail. Assuming that the application calls SSL_free() on the failed\nconneciton in a timely manner then the 21Mb of allocated memory will then be\nimmediately freed again. Therefore the excessive memory allocation will be\ntransitory in nature. This then means that there is only a security impact if:\n\n1) The application does not call SSL_free() in a timely manner in the\nevent that the connection fails\nor\n2) The application is working in a constrained environment where there\nis very little free memory\nor\n3) The attacker initiates multiple connection attempts such that there\nare multiple connections in a state where memory has been allocated for\nthe connection; SSL_free() has not yet been called; and there is\ninsufficient memory to service the multiple requests.\n\nExcept in the instance of (1) above any Denial Of Service is likely to\nbe transitory because as soon as the connection fails the memory is\nsubsequently freed again in the SSL_free() call. However there is an\nincreased risk during this period of application crashes due to the lack\nof memory - which would then mean a more serious Denial of Service.\n\nThis issue does not affect TLS users.\n\nrefer:\nhttps://www.openssl.org/news/secadv/20160922.txt","vulnerability_information_html":"\u003cp\u003eThis issue is very similar to CVE-2016-6307. The underlying defect is different\u003cbr\u003e\nbut the security analysis and impacts are the same except that it impacts DTLS.\u003c/p\u003e\n\n\u003cp\u003eA DTLS message includes 3 bytes for its length in the header for the message.\u003cbr\u003e\nThis would allow for messages up to 16Mb in length. Messages of this length are\u003cbr\u003e\nexcessive and OpenSSL includes a check to ensure that a peer is sending\u003cbr\u003e\nreasonably sized messages in order to avoid too much memory being consumed to\u003cbr\u003e\nservice a connection. A flaw in the logic of version 1.1.0 means that memory for\u003cbr\u003e\nthe message is allocated too early, prior to the excessive message length\u003cbr\u003e\ncheck. Due to way memory is allocated in OpenSSL this could mean an attacker\u003cbr\u003e\ncould force up to 21Mb to be allocated to service a connection. This could lead\u003cbr\u003e\nto a Denial of Service through memory exhaustion. However, the excessive message\u003cbr\u003e\nlength check still takes place, and this would cause the connection to\u003cbr\u003e\nimmediately fail. Assuming that the application calls SSL_free() on the failed\u003cbr\u003e\nconneciton in a timely manner then the 21Mb of allocated memory will then be\u003cbr\u003e\nimmediately freed again. Therefore the excessive memory allocation will be\u003cbr\u003e\ntransitory in nature. This then means that there is only a security impact if:\u003c/p\u003e\n\n\u003cp\u003e1) The application does not call SSL_free() in a timely manner in the\u003cbr\u003e\nevent that the connection fails\u003cbr\u003e\nor\u003cbr\u003e\n2) The application is working in a constrained environment where there\u003cbr\u003e\nis very little free memory\u003cbr\u003e\nor\u003cbr\u003e\n3) The attacker initiates multiple connection attempts such that there\u003cbr\u003e\nare multiple connections in a state where memory has been allocated for\u003cbr\u003e\nthe connection; SSL_free() has not yet been called; and there is\u003cbr\u003e\ninsufficient memory to service the multiple requests.\u003c/p\u003e\n\n\u003cp\u003eExcept in the instance of (1) above any Denial Of Service is likely to\u003cbr\u003e\nbe transitory because as soon as the connection fails the memory is\u003cbr\u003e\nsubsequently freed again in the SSL_free() call. However there is an\u003cbr\u003e\nincreased risk during this period of application crashes due to the lack\u003cbr\u003e\nof memory - which would then mean a more serious Denial of Service.\u003c/p\u003e\n\n\u003cp\u003eThis issue does not affect TLS users.\u003c/p\u003e\n\n\u003cp\u003erefer:\u003cbr\u003e\n\u003ca title=\"https://www.openssl.org/news/secadv/20160922.txt\" href=\"/redirect?url=https%3A%2F%2Fwww.openssl.org%2Fnews%2Fsecadv%2F20160922.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.openssl.org/news/secadv/20160922.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-23T16:14:15.671Z","allow_singular_disclosure_after":-110983589.15164538,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mpz","eveeez","japz","sumit7","spetr0x"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1698101,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:13:55.236Z","updated_at":"2017-05-24T16:13:55.236Z","cve_ids":["CVE-2016-6308"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698102,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:14:00.327Z","updated_at":"2018-02-28T13:11:07.922Z","additional_data":{"added_weaknesses":[{"id":48,"name":"Denial of Service"}],"removed_weaknesses":[]},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698103,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:14:06.447Z","updated_at":"2017-05-24T16:14:06.447Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"theyarestone","url":"/theyarestone"},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698104,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:14:11.371Z","updated_at":"2017-05-24T16:14:11.371Z","actor":{"url":"/ibb-openssl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OpenSSL (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-openssl","collaborator":{"username":"theyarestone","url":"/theyarestone"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698105,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:14:15.639Z","updated_at":"2017-05-24T16:14:15.639Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1699580,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-25T01:32:36.037Z","updated_at":"2017-05-25T01:32:36.037Z","actor":{"username":"theyarestone","cleared":false,"url":"/theyarestone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1699581,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-25T01:32:36.088Z","updated_at":"2017-05-25T01:32:36.088Z","actor":{"username":"theyarestone","cleared":false,"url":"/theyarestone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4186,"category":"team","content":"This issue is very similar to CVE-2016-6307. The underlying defect is different but the security analysis and impacts are the same except that it impacts DTLS.\n\nA DTLS message includes 3 bytes for its length in the header for the message.\n\nThis would allow for messages up to 16Mb in length. Messages of this length are excessive and OpenSSL includes a check to ensure that a peer is sending reasonably sized messages in order to avoid too much memory being consumed to service a connection. A flaw in the logic of version 1.1.0 means that memory for the message is allocated too early, prior to the excessive message length check. Due to way memory is allocated in OpenSSL this could mean an attacker could force up to 21Mb to be allocated to service a connection. This could lead to a Denial of Service through memory exhaustion. However, the excessive message length check still takes place, and this would cause the connection to immediately fail. Assuming that the application calls SSL_free() on the failed conneciton in a timely manner then the 21Mb of allocated memory will then be immediately freed again. Therefore the excessive memory allocation will be transitory in nature. This then means that there is only a security impact if:\n\n1) The application does not call SSL_free() in a timely manner in the event that the connection fails\nor\n2) The application is working in a constrained environment where there is very little free memory\nor\n3) The attacker initiates multiple connection attempts such that there are multiple connections in a state where memory has been allocated for the connection; SSL_free() has not yet been called; and there is insufficient memory to service the multiple requests.\n\nExcept in the instance of (1) above any Denial Of Service is likely to be transitory because as soon as the connection fails the memory is subsequently freed again in the SSL_free() call. However there is an increased risk during this period of application crashes due to the lack of memory - which would then mean a more serious Denial of Service.\n\nThis issue does not affect TLS users.\n\nOpenSSL 1.1.0 DTLS users should upgrade to 1.1.0a\n\nThis issue was reported to OpenSSL on 18th September 2016 by Shi Lei (Gear Team, Qihoo 360 Inc.). The fix was developed by Matt Caswell of the OpenSSL development team.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis issue is very similar to CVE-2016-6307. The underlying defect is different but the security analysis and impacts are the same except that it impacts DTLS.\u003c/p\u003e\n\n\u003cp\u003eA DTLS message includes 3 bytes for its length in the header for the message.\u003c/p\u003e\n\n\u003cp\u003eThis would allow for messages up to 16Mb in length. Messages of this length are excessive and OpenSSL includes a check to ensure that a peer is sending reasonably sized messages in order to avoid too much memory being consumed to service a connection. A flaw in the logic of version 1.1.0 means that memory for the message is allocated too early, prior to the excessive message length check. Due to way memory is allocated in OpenSSL this could mean an attacker could force up to 21Mb to be allocated to service a connection. This could lead to a Denial of Service through memory exhaustion. However, the excessive message length check still takes place, and this would cause the connection to immediately fail. Assuming that the application calls SSL_free() on the failed conneciton in a timely manner then the 21Mb of allocated memory will then be immediately freed again. Therefore the excessive memory allocation will be transitory in nature. This then means that there is only a security impact if:\u003c/p\u003e\n\n\u003cp\u003e1) The application does not call SSL_free() in a timely manner in the event that the connection fails\u003cbr\u003e\nor\u003cbr\u003e\n2) The application is working in a constrained environment where there is very little free memory\u003cbr\u003e\nor\u003cbr\u003e\n3) The attacker initiates multiple connection attempts such that there are multiple connections in a state where memory has been allocated for the connection; SSL_free() has not yet been called; and there is insufficient memory to service the multiple requests.\u003c/p\u003e\n\n\u003cp\u003eExcept in the instance of (1) above any Denial Of Service is likely to be transitory because as soon as the connection fails the memory is subsequently freed again in the SSL_free() call. However there is an increased risk during this period of application crashes due to the lack of memory - which would then mean a more serious Denial of Service.\u003c/p\u003e\n\n\u003cp\u003eThis issue does not affect TLS users.\u003c/p\u003e\n\n\u003cp\u003eOpenSSL 1.1.0 DTLS users should upgrade to 1.1.0a\u003c/p\u003e\n\n\u003cp\u003eThis issue was reported to OpenSSL on 18th September 2016 by Shi Lei (Gear Team, Qihoo 360 Inc.). The fix was developed by Matt Caswell of the OpenSSL development team.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}