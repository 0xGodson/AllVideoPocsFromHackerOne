{"id":159820,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTk4MjA=","url":"https://hackerone.com/reports/159820","title":"Issues with uploading list images","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-16T18:46:47.530Z","submitted_at":"2016-08-16T18:46:47.530Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-26T20:14:17.710Z","bug_reporter_agreed_on_going_public_at":"2016-09-05T14:07:06.658Z","team_member_agreed_on_going_public_at":"2016-09-26T20:14:17.602Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThere are several issues with uploading images for a list, i.e. with a PUT request to `https://www.instacart.com/api/v2/lists/153253` and passing `list[remote_image_url]`.\n\nFirst, information about open ports and SSH information can be disclosed via different urls. For example, PUT-ing localhost:80 will return a 404 error, but localhost:1010 will return a connection refused error. PUT-ing localhost:22 will, return `\"Image could not download file: wrong status line: 'SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.3'\"`, showing that OpenSSH version 6.6.1p1 is being used, which is outdated and may be vulnerable to published exploits.\n\nPassing a value such as `http://google.com` will show that rmagick is being used, with an error: `\"Image must be a JPEG or PNG\",\"Image Failed to manipulate with rmagick, maybe it is not an image? Original Error: unable to open file `/tmp/magick-ezcF8DGU': No such file or directory @ error/constitute.c/ReadImage/583\"`\n\nFinally, uploading a JPG such as in [https://hackerone.com/reports/390] makes the server timeout and returns a 502 error, overflowing the memory. I have attached the image below.\n\nThanks for your time, and please let me know if you need any more information.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThere are several issues with uploading images for a list, i.e. with a PUT request to \u003ccode\u003ehttps://www.instacart.com/api/v2/lists/153253\u003c/code\u003e and passing \u003ccode\u003elist[remote_image_url]\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eFirst, information about open ports and SSH information can be disclosed via different urls. For example, PUT-ing localhost:80 will return a 404 error, but localhost:1010 will return a connection refused error. PUT-ing localhost:22 will, return \u003ccode\u003e\u0026quot;Image could not download file: wrong status line: \u0026#39;SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.3\u0026#39;\u0026quot;\u003c/code\u003e, showing that OpenSSH version 6.6.1p1 is being used, which is outdated and may be vulnerable to published exploits.\u003c/p\u003e\n\n\u003cp\u003ePassing a value such as \u003ccode\u003ehttp://google.com\u003c/code\u003e will show that rmagick is being used, with an error: \u003ccode\u003e\u0026quot;Image must be a JPEG or PNG\u0026quot;,\u0026quot;Image Failed to manipulate with rmagick, maybe it is not an image? Original Error: unable to open file\u003c/code\u003e/tmp/magick-ezcF8DGU\u0026#39;: No such file or directory @ error/constitute.c/ReadImage/583\u0026quot;`\u003c/p\u003e\n\n\u003cp\u003eFinally, uploading a JPG such as in [\u003ca title=\"https://hackerone.com/reports/390\" href=\"https://hackerone.com/reports/390\"\u003ehttps://hackerone.com/reports/390\u003c/a\u003e] makes the server timeout and returns a 502 error, overflowing the memory. I have attached the image below.\u003c/p\u003e\n\n\u003cp\u003eThanks for your time, and please let me know if you need any more information.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":112575,"file_name":"image.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/112/575/dfb4f0f6007a6f2deaed72e1637a73e5f4152238/image.jpg?response-content-disposition=attachment%3B%20filename%3D%22image.jpg%22%3B%20filename%2A%3DUTF-8%27%27image.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2CQCXB7P%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043637Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCKfc9uxh22FGIBSKNqNzEdwAGilNzlyCJlRQkk6L7ywwIgTF9zV46T%2F8NjN%2BIYnxBP9uKa%2FXVMex8eb6F8QfoW3wEqtAMIURABGgwwMTM2MTkyNzQ4NDkiDJ5ZNSNolCYK8UaqCyqRAzNhE%2Fm3zPdEHRm5WUEnZo0COkaeE9dAwJeLRl1TZ11d43Lhd%2FMikAINQoGyi4r4ILldIaNgVmSsjmb0fcorizPel9Yzwr4cFLsZOlxR5w1wIcH9%2B%2FXSVM%2FPyc6y3YiLMP%2BnfwLJ7AL67U%2BsYNgwrwRQCUMORslIWy4Bee0CRE37pQRcD%2BpnBGoZEqEgw%2FHEeFzSipLRBmOXQXxK8U%2FyZbCwKI3Y7jZdrKPqHfhEodvEeD0Wwknnt5JRb8OwCuT7%2BjnXPx7Ftl6fh7ZHEZSimVCNgNXHtQ7MayTMvGyEcE%2FGEdWIy%2BvUTFD59Sbk%2B4fSP5XGoClsVLqX8UQRsOAbpYFv8pGdRWsta2NjZfh4swj28Z1ENJENNBr0wiLwpBy4s4wlkmS86icFZ53iBsI3EOJmZJ5DZ5redWS7l%2BgYoOpzpgENRZcaEYNEAzZuOnjhHMp0RSoAnDuPybSiBCQrW8JftW%2Buq0QzjkbBqzj7nPJ0%2FbXQQzRl4pJZycpxagVMpzjAmvRed9%2BHfODrR1Wa1B9bMPDlqf8FOusBVFGMNirRKMu5AkI7qGagYnYSG4HpDqpKcH5QuM0jUoRkB5r%2BZWkCPAsBHe6t6p0Cfzk0IF3j5b1WbHsN2UHZ8rtF%2BtQ%2F7OawY4eFB8qp9BuOlUA1okg7%2BXvgui2gDL6mFoU2mzqz8v%2BmiFTIaBj8QjYyPX%2Ft4bj%2FyE7%2BzfsRuoeKoPtREJbjscDMF4yK366F0eCTIiw1cnRHt2i638RsSrY3MoN%2BD241aZxfV0getVCLrP4EjZE1CMOAzzhsZEa%2B%2BPrZg0WXd5TN40IoVxY7vjGdJo5rtxp6xBPK%2FbNPk5gPBu93zpBV2vOdiQ%3D%3D\u0026X-Amz-Signature=55cbfc682576becf7dfb76af5afe3bfa714d04dbe76934cfba36b10df49c79da","file_size":4856,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-10-05T14:07:06.785Z","allow_singular_disclosure_after":-133540170.69926214,"singular_disclosure_allowed":true,"vote_count":10,"voters":["yaworsk","cablej","eveeez","dkd","marwan","jens","its_afolic","gopi","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1133096,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-17T22:05:38.201Z","updated_at":"2016-08-17T22:05:38.201Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1146253,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @cablej,\n\nThank you for the report. The first two issues you are mentioning were duplicates of previous reports. \n\nBut the issue related to overflowing the memory is real and you are the first one to report it. It should now be resolved.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. The first two issues you are mentioning were duplicates of previous reports. \u003c/p\u003e\n\n\u003cp\u003eBut the issue related to overflowing the memory is real and you are the first one to report it. It should now be resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-22T22:51:20.244Z","updated_at":"2016-08-22T22:51:20.244Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1146254,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T22:51:29.509Z","updated_at":"2016-08-22T22:51:29.509Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"cablej","url":"/cablej"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1149632,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks for the reward and glad I could help out. I can verify that the server now returns an image size error.","markdown_message":"\u003cp\u003eGreat, thanks for the reward and glad I could help out. I can verify that the server now returns an image size error.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T17:36:21.002Z","updated_at":"2016-08-23T17:36:21.002Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1174250,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-05T14:07:06.721Z","updated_at":"2016-09-05T14:07:06.721Z","first_to_agree":true,"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217151,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-26T20:14:17.633Z","updated_at":"2016-09-26T20:14:17.633Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1217152,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-26T20:14:17.734Z","updated_at":"2016-09-26T20:14:17.734Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}