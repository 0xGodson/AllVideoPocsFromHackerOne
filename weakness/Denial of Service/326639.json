{"id":326639,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjY2Mzk=","url":"https://hackerone.com/reports/326639","title":"DoS through cache poisoning using invalid HTTP parameters","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-16T13:26:10.119Z","submitted_at":"2018-03-16T13:26:10.119Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"irvinlim","url":"/irvinlim","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":312,"url":"https://hackerone.com/greenhouse","handle":"greenhouse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Greenhouse.io","twitter_handle":"","website":"https://app.greenhouse.io","about":"Software to optimize your entire recruiting and onboarding process."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-02T17:29:01.968Z","bug_reporter_agreed_on_going_public_at":"2018-05-01T05:34:52.590Z","team_member_agreed_on_going_public_at":"2018-05-02T17:29:01.877Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I was taking a look into a related report (https://hackerone.com/reports/298265) and I discovered that the https://boards.greenhouse.io/embed/job_board/js?for= endpoint doesn't throw errors when I try to pass in an array of `for` parameters like this:\n\n```\nhttps://boards.greenhouse.io/embed/job_board/js?for[]=twitter\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\u0026for[]=\n```\n\nInstead, in the resultant JS, we can see that the HTTP parameters are escaped and injected into the `Grnhse.Settings` object:\n\n```js\nGrnhse.Settings = {\n  targetDomain:   'https://boards.greenhouse.io',\n  scrollOnLoad:   true,\n  autoLoad:       true,\n  boardURI:       'https://boards.greenhouse.io/embed/job_board?for%5B%5D=twitter\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=',\n  applicationURI: 'https://boards.greenhouse.io/embed/job_app?for%5B%5D=twitter\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=\u0026amp;for%5B%5D=',\n  baseURI:        '',\n  iFrameWidth:    650\n};\n```\n\nWhen fetching the actual correct endpoint (https://boards.greenhouse.io/embed/job_board/js?for=twitter), we see that the result for `twitter` is cached, returning the same corrupted URIs in the JS file. From my tests, it seems that these endpoints are cached for an unknown amount of time, with some staying in the cache for only a few minutes while others may be an hour or longer.\n\nI also found out that the particular endpoint is on CloudFront by observing one of the IP addresses which served the file (35.164.91.227) and corroborating it with the IP range list published by AWS (https://ip-ranges.amazonaws.com/ip-ranges.json). However, fetching from different edge servers seems to result in the same mutated file being fetched at the correct endpoint (https://boards.greenhouse.io/embed/job_board/js?for=twitter). I conclude that there is a second layer of caching somewhere on the application layer.\n\nThe impact of corrupting the `boardURI` and `applicationURI` values is that the `job_app` or `job_board` iframes would fail to load in the client's website since the URI is incorrect, resulting in a denial of service for the client. One example is that Airbnb's job application page shows a Greenhouse.io error page (see attached images), which I managed to replicate it twice and lasted for about 20 minutes and less than 5 minutes respectively.\n\nI tried to investigate if I could reliably replicate this PoC by waiting for cache to expire, as well as across several domains, but failed to find anything conclusive without knowledge of the underlying network architecture. Additionally, I am not sure if what is going on at play is due to a cache, and seeing that some IDs take quite a while to recover back to its normal state, I will stop trying to replicate the attack for now.\n\nP.S. This is my first report, so do let me know if I could be of more help!\n\n## Impact\n\nIf the attacker has more patience and knowledge about the underlying architecture, the attacker could attempt to poison the cache reliably, resulting in an extended denial of service of Greenhouse job boards/application iframes in client sites.","vulnerability_information_html":"\u003cp\u003eI was taking a look into a related report (\u003ca title=\"https://hackerone.com/reports/298265\" href=\"https://hackerone.com/reports/298265\"\u003ehttps://hackerone.com/reports/298265\u003c/a\u003e) and I discovered that the \u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e endpoint doesn\u0026#39;t throw errors when I try to pass in an array of \u003ccode\u003efor\u003c/code\u003e parameters like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://boards.greenhouse.io/embed/job_board/js?for[]=twitter\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\u0026amp;for[]=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eInstead, in the resultant JS, we can see that the HTTP parameters are escaped and injected into the \u003ccode\u003eGrnhse.Settings\u003c/code\u003e object:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eGrnhse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSettings\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etargetDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://boards.greenhouse.io\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003escrollOnLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eautoLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eboardURI\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://boards.greenhouse.io/embed/job_board?for%5B%5D=twitter\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eapplicationURI\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://boards.greenhouse.io/embed/job_app?for%5B%5D=twitter\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u0026amp;amp;for%5B%5D=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ebaseURI\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e        \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eiFrameWidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e    \u003cspan class=\"mi\"\u003e650\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen fetching the actual correct endpoint (\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twitter\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwitter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), we see that the result for \u003ccode\u003etwitter\u003c/code\u003e is cached, returning the same corrupted URIs in the JS file. From my tests, it seems that these endpoints are cached for an unknown amount of time, with some staying in the cache for only a few minutes while others may be an hour or longer.\u003c/p\u003e\n\n\u003cp\u003eI also found out that the particular endpoint is on CloudFront by observing one of the IP addresses which served the file (35.164.91.227) and corroborating it with the IP range list published by AWS (\u003ca title=\"https://ip-ranges.amazonaws.com/ip-ranges.json\" href=\"/redirect?url=https%3A%2F%2Fip-ranges.amazonaws.com%2Fip-ranges.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ip-ranges.amazonaws.com/ip-ranges.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). However, fetching from different edge servers seems to result in the same mutated file being fetched at the correct endpoint (\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twitter\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwitter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). I conclude that there is a second layer of caching somewhere on the application layer.\u003c/p\u003e\n\n\u003cp\u003eThe impact of corrupting the \u003ccode\u003eboardURI\u003c/code\u003e and \u003ccode\u003eapplicationURI\u003c/code\u003e values is that the \u003ccode\u003ejob_app\u003c/code\u003e or \u003ccode\u003ejob_board\u003c/code\u003e iframes would fail to load in the client\u0026#39;s website since the URI is incorrect, resulting in a denial of service for the client. One example is that Airbnb\u0026#39;s job application page shows a Greenhouse.io error page (see attached images), which I managed to replicate it twice and lasted for about 20 minutes and less than 5 minutes respectively.\u003c/p\u003e\n\n\u003cp\u003eI tried to investigate if I could reliably replicate this PoC by waiting for cache to expire, as well as across several domains, but failed to find anything conclusive without knowledge of the underlying network architecture. Additionally, I am not sure if what is going on at play is due to a cache, and seeing that some IDs take quite a while to recover back to its normal state, I will stop trying to replicate the attack for now.\u003c/p\u003e\n\n\u003cp\u003eP.S. This is my first report, so do let me know if I could be of more help!\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf the attacker has more patience and knowledge about the underlying architecture, the attacker could attempt to poison the cache reliably, resulting in an extended denial of service of Greenhouse job boards/application iframes in client sites.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":272864,"file_name":"airbnb_error-1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/272/864/5c40c9f0b027f80ca6723feec173de6bc7f4e9c4/airbnb_error-1.png?response-content-disposition=attachment%3B%20filename%3D%22airbnb_error-1.png%22%3B%20filename%2A%3DUTF-8%27%27airbnb_error-1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=798302375c11a5a0ff1bb83e5cba7adc9ded300d991fc65cc758949deb9f50c9","file_size":309716,"type":"image/png"},{"id":272865,"file_name":"airbnb_error-2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/272/865/f4394cdb2ec2969d9bd36da03f5784f08f643202/airbnb_error-2.png?response-content-disposition=attachment%3B%20filename%3D%22airbnb_error-2.png%22%3B%20filename%2A%3DUTF-8%27%27airbnb_error-2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=1a01ed7a217cd61ea1683b6f5fde195b62cbec197dbce65efb2aa935a04d0a91","file_size":313490,"type":"image/png"}],"allow_singular_disclosure_at":"2018-05-31T05:34:52.681Z","allow_singular_disclosure_after":-81475260.38896164,"singular_disclosure_allowed":true,"vote_count":19,"voters":["irvinlim","jokebookservice1","muon4","michan","eveeez","geeknik","apapedulimu","lordjerry0x01","an0nym0us","whitesector","and 9 more..."],"severity":{"rating":"medium","score":5.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"none","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":9058,"asset_type":"URL","asset_identifier":"boards.greenhouse.io","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2499083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @irvinlim, \n\nThanks for the submission. We will try to reproduce internally and let you know if we agree that it is an issue. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/irvinlim\"\u003e@irvinlim\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThanks for the submission. We will try to reproduce internally and let you know if we agree that it is an issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-16T13:38:13.308Z","updated_at":"2018-03-16T13:38:13.308Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2499098,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rongutierrez, thanks for looking into it. It might be quite hard to replicate reliably especially behind multiple layers of caching, so it may be best to look into these URLs which seem to still be impacted (all of them look like they either don't use `iframe`s on their job site or stopped using Greenhouse):\n\n* https://boards.greenhouse.io/embed/job_board/js?for=2\n* https://boards.greenhouse.io/embed/job_board/js?for=twitter\n* https://boards.greenhouse.io/embed/job_board/js?for=zenefits\n* https://boards.greenhouse.io/embed/job_board/js?for=surveymonkey\n* https://boards.greenhouse.io/embed/job_board/js?for=twilio","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rongutierrez\"\u003e@rongutierrez\u003c/a\u003e, thanks for looking into it. It might be quite hard to replicate reliably especially behind multiple layers of caching, so it may be best to look into these URLs which seem to still be impacted (all of them look like they either don\u0026#39;t use \u003ccode\u003eiframe\u003c/code\u003es on their job site or stopped using Greenhouse):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=2\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3D2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twitter\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwitter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=zenefits\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dzenefits\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=zenefits\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=surveymonkey\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dsurveymonkey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=surveymonkey\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twilio\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwilio\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twilio\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2018-03-16T13:44:35.098Z","updated_at":"2018-03-16T13:44:35.098Z","actor":{"username":"irvinlim","cleared":false,"url":"/irvinlim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2533445,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @irvinlim, \n\nI've validated the issue and it has been triaged on our end. We will let you know once it has been resolved.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/irvinlim\"\u003e@irvinlim\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve validated the issue and it has been triaged on our end. We will let you know once it has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-26T20:01:50.331Z","updated_at":"2018-03-26T20:01:50.331Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2570725,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @irvinlim, \n\nWe released a fix for this a couple of days ago. Would you be able to verify that it is working as expected?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/irvinlim\"\u003e@irvinlim\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eWe released a fix for this a couple of days ago. Would you be able to verify that it is working as expected?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-05T19:23:51.666Z","updated_at":"2018-04-05T19:23:51.666Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2570843,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @rongutierrez, looks good to me. However since I am behind CDN and other layers of caching, the results I'm seeing may possibly be cached. I trust that your internal team has thoroughly tested it directly on the origin server.\n\nI'm OK to resolve the issue. Can I also check if this is eligible for bounty?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rongutierrez\"\u003e@rongutierrez\u003c/a\u003e, looks good to me. However since I am behind CDN and other layers of caching, the results I\u0026#39;m seeing may possibly be cached. I trust that your internal team has thoroughly tested it directly on the origin server.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m OK to resolve the issue. Can I also check if this is eligible for bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-05T19:54:55.135Z","updated_at":"2018-04-05T19:54:55.135Z","actor":{"username":"irvinlim","cleared":false,"url":"/irvinlim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2570906,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The fix we implemented was to prevent the 'for' parameter from being anything other than a string. I'm going to mark the issue as resolved and award you with a bounty. Thanks for the thorough writeup and for being patient while we released the fix. ","markdown_message":"\u003cp\u003eThe fix we implemented was to prevent the \u0026#39;for\u0026#39; parameter from being anything other than a string. I\u0026#39;m going to mark the issue as resolved and award you with a bounty. Thanks for the thorough writeup and for being patient while we released the fix. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-05T20:11:53.981Z","updated_at":"2018-04-05T20:11:53.981Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"irvinlim","url":"/irvinlim"},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2570908,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-05T20:12:04.413Z","updated_at":"2018-04-05T20:12:04.413Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Greenhouse.io"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"greenhouse","collaborator":{"username":"irvinlim","url":"/irvinlim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2570919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the generous bounty!","markdown_message":"\u003cp\u003eThank you very much for the generous bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-05T20:14:26.403Z","updated_at":"2018-04-05T20:14:26.403Z","actor":{"username":"irvinlim","cleared":false,"url":"/irvinlim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2684934,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-01T05:34:52.623Z","updated_at":"2018-05-01T05:34:52.623Z","first_to_agree":true,"actor":{"username":"irvinlim","cleared":false,"url":"/irvinlim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2691708,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Shall we disclose?","markdown_message":"\u003cp\u003eShall we disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-02T17:15:26.744Z","updated_at":"2018-05-02T17:15:26.744Z","actor":{"username":"irvinlim","cleared":false,"url":"/irvinlim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/182/993/ef72d24864e65926f1e13ccd3aadc1ca1a0002b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2691754,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-02T17:29:01.907Z","updated_at":"2018-05-02T17:29:01.907Z","actor":{"username":"lcvicknair","cleared":false,"url":"/lcvicknair","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2691755,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-02T17:29:01.998Z","updated_at":"2018-05-02T17:29:01.998Z","actor":{"username":"lcvicknair","cleared":false,"url":"/lcvicknair","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4436811,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-01T22:28:00.344Z","updated_at":"2019-04-01T22:28:00.344Z","actor":{"username":"lcvicknair","cleared":false,"url":"/lcvicknair","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"boards.greenhouse.io","genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":7295,"category":"researcher","content":"Greenhouse.io allows its customers to embed iframes using its provided JS SDK on https://boards.greenhouse.io/embed/job_board/js?for=twitter, for Twitter for example. (Twitter does not seem to use Greenhouse.io anymore, but their account still exists.)\n\nI found that using parameter arrays (e.g. `for[]=twitter`) still loads the correct JS file, but with different URLs for the job board and application iframes. This file turns out to be cached, which I had effectively poisoned even when accessing the original URL (i.e. https://boards.greenhouse.io/embed/job_board/js?for=twitter). This results in a denial of service of the Greenhouse.io iframes that would be embedded in the customer's site, for around 20-30 minutes until the cache was cleared again.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eGreenhouse.io allows its customers to embed iframes using its provided JS SDK on \u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twitter\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwitter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, for Twitter for example. (Twitter does not seem to use Greenhouse.io anymore, but their account still exists.)\u003c/p\u003e\n\n\u003cp\u003eI found that using parameter arrays (e.g. \u003ccode\u003efor[]=twitter\u003c/code\u003e) still loads the correct JS file, but with different URLs for the job board and application iframes. This file turns out to be cached, which I had effectively poisoned even when accessing the original URL (i.e. \u003ca title=\"https://boards.greenhouse.io/embed/job_board/js?for=twitter\" href=\"/redirect?url=https%3A%2F%2Fboards.greenhouse.io%2Fembed%2Fjob_board%2Fjs%3Ffor%3Dtwitter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://boards.greenhouse.io/embed/job_board/js?for=twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). This results in a denial of service of the Greenhouse.io iframes that would be embedded in the customer\u0026#39;s site, for around 20-30 minutes until the cache was cleared again.\u003c/p\u003e\n"}]}