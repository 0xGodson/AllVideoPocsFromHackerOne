{"id":296632,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTY2MzI=","url":"https://hackerone.com/reports/296632","title":"Audit log validation","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2017-12-10T04:08:59.173Z","submitted_at":"2017-12-10T04:08:59.173Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mur90210","url":"/mur90210","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-28T08:07:11.549Z","bug_reporter_agreed_on_going_public_at":"2018-08-28T08:07:11.442Z","team_member_agreed_on_going_public_at":"2018-08-27T09:22:50.891Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Issue ##\nFor the docker image (git clone https://github.com/WeblateOrg/docker.git weblate-docker), the IP address in the audit log (in the user's profile, and in the administration console) can be forged using the `X-Forwarded-For` header during the login process.\n\nThis does not affect http://demo.weblate.org/.\n\nFor http://demo.weblate.org/, `User-Agent: '\"\u003cb\u003etest` was accepted. This will not lead to XSS issues, but could potentially be an issue if the input is used elsewhere, such as a database query.\n\n## Impact\n\n## Consequence ##\nWhen using the docker image, it may be possible to spoof audit log entries. If an account were compromised, it may be more difficult to determine this from the audit log entries.","vulnerability_information_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eFor the docker image (git clone \u003ca title=\"https://github.com/WeblateOrg/docker.git\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fdocker.git\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/docker.git\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e weblate-docker), the IP address in the audit log (in the user\u0026#39;s profile, and in the administration console) can be forged using the \u003ccode\u003eX-Forwarded-For\u003c/code\u003e header during the login process.\u003c/p\u003e\n\n\u003cp\u003eThis does not affect \u003ca title=\"http://demo.weblate.org/\" href=\"/redirect?url=http%3A%2F%2Fdemo.weblate.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://demo.weblate.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eFor \u003ca title=\"http://demo.weblate.org/\" href=\"/redirect?url=http%3A%2F%2Fdemo.weblate.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://demo.weblate.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ccode\u003eUser-Agent: \u0026#39;\u0026quot;\u0026lt;b\u0026gt;test\u003c/code\u003e was accepted. This will not lead to XSS issues, but could potentially be an issue if the input is used elsewhere, such as a database query.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch2 id=\"consequence\"\u003eConsequence\u003c/h2\u003e\n\n\u003cp\u003eWhen using the docker image, it may be possible to spoof audit log entries. If an account were compromised, it may be more difficult to determine this from the audit log entries.\u003c/p\u003e\n","weakness":{"id":93,"name":"Improper Neutralization of HTTP Headers for Scripting Syntax"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-09-26T09:22:50.983Z","allow_singular_disclosure_after":-71265869.06506659,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sameerphad72","apapedulimu","japz","cryptographer"],"severity":{"rating":"none","author_type":"User"},"structured_scope":{"databaseId":175,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/WeblateOrg/docker","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2212486,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your input. The User-Agent is certainly always properly escaped, so thats not an issue. However the X-Forwarded-For header should be certainly fixed for the docker container.","markdown_message":"\u003cp\u003eThanks for your input. The User-Agent is certainly always properly escaped, so thats not an issue. However the X-Forwarded-For header should be certainly fixed for the docker container.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-10T18:56:54.376Z","updated_at":"2017-12-10T18:56:54.376Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2225075,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for spotting, fixed in https://github.com/WeblateOrg/docker/commit/8de4ea63401172510ace23829a3198b25af40962. The configuration was written in assumption this all is running behind reverse proxy which will set this header, but you're right it's not necessary, so in case somebody needs this, he should enable this setting.","markdown_message":"\u003cp\u003eThanks for spotting, fixed in \u003ca title=\"https://github.com/WeblateOrg/docker/commit/8de4ea63401172510ace23829a3198b25af40962\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fdocker%2Fcommit%2F8de4ea63401172510ace23829a3198b25af40962\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/docker/commit/8de4ea63401172510ace23829a3198b25af40962\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The configuration was written in assumption this all is running behind reverse proxy which will set this header, but you\u0026#39;re right it\u0026#39;s not necessary, so in case somebody needs this, he should enable this setting.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T08:05:39.797Z","updated_at":"2017-12-15T08:05:39.797Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mur90210","url":"/mur90210"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3251666,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-27T09:22:50.928Z","updated_at":"2018-08-27T09:22:50.928Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3256859,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-28T08:07:11.489Z","updated_at":"2018-08-28T08:07:11.489Z","actor":{"username":"mur90210","cleared":false,"url":"/mur90210","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3256860,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-28T08:07:11.580Z","updated_at":"2018-08-28T08:07:11.580Z","actor":{"username":"mur90210","cleared":false,"url":"/mur90210","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}