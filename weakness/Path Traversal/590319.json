{"id":590319,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTAzMTk=","url":"https://hackerone.com/reports/590319","title":"Linux client is vulnerable to directory traversal when downloading files","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-05-26T04:50:06.211Z","submitted_at":"2019-05-26T04:50:06.211Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"icewater","url":"/icewater","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8227"],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-17T12:57:06.364Z","bug_reporter_agreed_on_going_public_at":"2020-08-17T12:57:06.325Z","team_member_agreed_on_going_public_at":"2020-08-05T08:52:47.735Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nThe Nextcloud Linux client is vulnerable to directory traversal when downloading files from a Nextcloud server. A malicious Nextcloud administrator can exploit the vulnerability to write arbitrary files to a user computer(s) with the potential for remote command execution under certain conditions.\n\n## Reproduction\n\nThe issue is exploited via a two step process. It is possible to do this using a proxy such as Burp suite, but it is tricky and involves modifying some server replies while also passing through others. The general process is:\n\nConfigure the client to use a proxy like Burp and set Burp to intercept server replies for review. Allow all client and server requests/responses to pass except the ones listed here. Force sync or wait for the client to issue the request \"PROPFIND /nextcloud/remote.php/dav/files/admin/\" with body paramters of:\n\u003c?xml version=\"1.0\" ?\u003e\n\u003cd:propfind xmlns:d=\"DAV:\" xmlns:oc=\"http://owncloud.org/ns\"\u003e\n  \u003cd:prop\u003e\n    \u003cd:resourcetype /\u003e\n    \u003cd:getlastmodified /\u003e\n    \u003cd:getcontentlength /\u003e\n    \u003cd:getetag /\u003e\n    \u003coc:id /\u003e\n    \u003coc:downloadURL /\u003e\n    \u003coc:dDC /\u003e\n    \u003coc:permissions /\u003e\n    \u003coc:checksums /\u003e\n    \u003coc:data-fingerprint /\u003e\n    \u003coc:share-types /\u003e\n  \u003c/d:prop\u003e\n\u003c/d:propfind\u003e\n\nForward it. When the server replies, insert an entry in the XML response for an available file. The file name in the HREF tag of the modification data is the vulnerable parameter. For example, you could insert the following:\n\u003cd:response\u003e\u003cd:href\u003e/nextcloud/remote.php/dav/files/user/../.bash_profile\u003c/d:href\u003e\u003cd:propstat\u003e\u003cd:prop\u003e\u003cd:resourcetype/\u003e\u003cd:getlastmodified\u003eTue, 30 Apr 2020 20:44:16 GMT\u003c/d:getlastmodified\u003e\u003cd:getcontentlength\u003e37042\u003c/d:getcontentlength\u003e\u003cd:getetag\u003e\u0026quot;08b9d12b0e2263f92820e8b4706a42c7\u0026quot;\u003c/d:getetag\u003e\u003coc:id\u003e00000051ocya3bx9cxde\u003c/oc:id\u003e\u003coc:downloadURL\u003e\u003c/oc:downloadURL\u003e\u003coc:permissions\u003eRGDNVW\u003c/oc:permissions\u003e\u003coc:data-fingerprint\u003e\u003c/oc:data-fingerprint\u003e\u003coc:share-types/\u003e\u003c/d:prop\u003e\u003cd:status\u003eHTTP/1.1 200 OK\u003c/d:status\u003e\u003c/d:propstat\u003e\u003cd:propstat\u003e\u003cd:prop\u003e\u003coc:dDC/\u003e\u003coc:checksums/\u003e\u003c/d:prop\u003e\u003cd:status\u003eHTTP/1.1 404 Not Found\u003c/d:status\u003e\u003c/d:propstat\u003e\u003c/d:response\u003e\n\nNote the path /nextcloud/remote.php/dav/files/user/../.bash_profile. When the client goes to write this file to disk, it will write traverse to the directory above the sync location (~/Nextcloud/ by default, so would end up at ~/)\n\nNext, the client should send a request to the server requesting the file, like so:\nGET http://192.168.144.128/nextcloud/remote.php/dav/files/user/../.bash_profile HTTP/1.1\nHost: 192.168.144.128\nAuthorization: Basic abc123\nUser-Agent: Mozilla/5.0 (Linux) mirall/2.5.2git (build 20190319) (Nextcloud)\nAccept: */*\nX-Request-ID: 4a1e1d20-283b-4072-9d24-9f39cf7db243abc123\nCookie: nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true; ocya3bx9cxde=rvam; oc_sessionPassphrase=srq12bLDYJI8abc123\nConnection: Keep-Alive\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,*\n\nThe server should reply saying the file wasn't found. Modify the response to become:\n\nHTTP/1.1 200 OK\nConnection: close\nContent-Type: text/text; charset=utf-8\nContent-Length: 93\nETag: 08b9d12b0e2263f92820e8b4706a42c7\n\necho \"It worked! Nextcloud Linux client directory traversal/code execution proof of concept.\"\n\n...and the content will be written to ~/.bash_profile instead of ~/Nextcloud/.bash_profile\n\nTo simplify the process, I created a proof of concept Python script and attached it here. The script must be run with Python3 and requires the requests HTTP library. It listens on port 8080 and is a proxy; it forwards all requests from the client to the real Nextcloud server. The proxy reviews each request and if it detects one of the aforementioned vulnerable requests, it modifies the server reply appropriately. For PoC purposes the filename is test.txt.\n\nTo use, open a terminal and run 'python3 poc.py'. Open the Nextcloud client settings, go to Network, and set it to use a proxy of 127.0.0.1 port 8080. You can force a sync if one does not trigger. After it syncs you should get a file 'test.txt' written one level above your Nextcloud sync folder.\n\nFor testing purposes an http-only Nextcloud server is needed, as the proxy is not SSL capable.\n\nThe proxy is not completely reliable, you may need to get the proxy running, then set the Nextcloud client to use proxy address 127.0.0.1:8080. If you have any issues identifying or reproducing this please let me know.\n\n## Impact\n\n## Limitations\n\nSome limitations surrounding this vulnerability:\n- Only new files can be written to disk. I have not found a way to overwrite existing files, i.e. if ~/test.txt already exists it won't get overwritten by the attacker's content.\n- An attacker can only write files to locations the Nextcloud program has permission to access.\n- The attacker must continously have the intercept running to keep the file on the target's system. If you stop the proof of concept script, the client interprets the exploit file's absence in the next sync as meaning it was deleted elsewhere, so it deletes the local copy. \n\n## Impact\n\nSince an attacker cannot overwrite existing files, this makes getting anything useful from the exploit harder, but not impossible. I have noticed with Ubuntu 16.04 and 18.04 systems the ~/.bash_profile file is absent by default. Bash executes any commands in this file when the user logs in from a terminal (not the GUI and not when opening the Terminal app within the GUI). An attacker could potentially get remote code execution by:\n- Exploiting the Nextcloud client to write ~/.bash_profile containing shell commands.\n- Getting lucky and having the user log in via SSH or virtual console. For example, in Ubuntu, pressing CTRL+ALT+F1 at the GUI login screen brings up a virtual console. Logging in here will execute ~/.bash_profile.\n\nAn attacker could also write various executable files (jar, sh, bin, etc) to various places on the user's system and hope the user, not knowing how they got there, would execute one.\n\nOther exploit payloads might exist, this is all I could come up at this time.\n\n## Scope\nIf a Nextcloud server adminstrator wanted to exploit the vulnerability, they could do so on the Nextcloud server itself by modifying the core code and not rely in traffic interception. Modifying the Nextcloud PHP code directly would also have the benefit of removing SSL as a limitation. \n\nThe Nextcloud security scope document states Nextcloud administrators are expected to have ability to access all user files and execute code on the server. However, with this vulnerability Nextcloud administrators could potentially execute code on remote user clients, which they may not have control over. \n\nSorry for the long winded report. :) If I can provide any further information please let me know. Thanks!","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe Nextcloud Linux client is vulnerable to directory traversal when downloading files from a Nextcloud server. A malicious Nextcloud administrator can exploit the vulnerability to write arbitrary files to a user computer(s) with the potential for remote command execution under certain conditions.\u003c/p\u003e\n\n\u003ch2 id=\"reproduction\"\u003eReproduction\u003c/h2\u003e\n\n\u003cp\u003eThe issue is exploited via a two step process. It is possible to do this using a proxy such as Burp suite, but it is tricky and involves modifying some server replies while also passing through others. The general process is:\u003c/p\u003e\n\n\u003cp\u003eConfigure the client to use a proxy like Burp and set Burp to intercept server replies for review. Allow all client and server requests/responses to pass except the ones listed here. Force sync or wait for the client to issue the request \u0026quot;PROPFIND /nextcloud/remote.php/dav/files/admin/\u0026quot; with body paramters of:\u003cbr\u003e\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; ?\u0026gt;\u003cbr\u003e\n\u0026lt;d:propfind xmlns:d=\u0026quot;DAV:\u0026quot; xmlns:oc=\u0026quot;http://owncloud.org/ns\u0026quot;\u0026gt;\u003cbr\u003e\n  \u0026lt;d:prop\u0026gt;\u003cbr\u003e\n    \u0026lt;d:resourcetype /\u0026gt;\u003cbr\u003e\n    \u0026lt;d:getlastmodified /\u0026gt;\u003cbr\u003e\n    \u0026lt;d:getcontentlength /\u0026gt;\u003cbr\u003e\n    \u0026lt;d:getetag /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:id /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:downloadURL /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:dDC /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:permissions /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:checksums /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:data-fingerprint /\u0026gt;\u003cbr\u003e\n    \u0026lt;oc:share-types /\u0026gt;\u003cbr\u003e\n  \u003ca title=\"/d:prop\" href=\"/d:prop\"\u003e/d:prop\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"/d:propfind\" href=\"/d:propfind\"\u003e/d:propfind\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eForward it. When the server replies, insert an entry in the XML response for an available file. The file name in the HREF tag of the modification data is the vulnerable parameter. For example, you could insert the following:\u003cbr\u003e\n\u0026lt;d:response\u0026gt;\u0026lt;d:href\u0026gt;/nextcloud/remote.php/dav/files/user/../.bash_profile\u003ca title=\"/d:href\" href=\"/d:href\"\u003e/d:href\u003c/a\u003e\u0026lt;d:propstat\u0026gt;\u0026lt;d:prop\u0026gt;\u0026lt;d:resourcetype/\u0026gt;\u0026lt;d:getlastmodified\u0026gt;Tue, 30 Apr 2020 20:44:16 GMT\u003ca title=\"/d:getlastmodified\" href=\"/d:getlastmodified\"\u003e/d:getlastmodified\u003c/a\u003e\u0026lt;d:getcontentlength\u0026gt;37042\u003ca title=\"/d:getcontentlength\" href=\"/d:getcontentlength\"\u003e/d:getcontentlength\u003c/a\u003e\u0026lt;d:getetag\u0026gt;\u0026quot;08b9d12b0e2263f92820e8b4706a42c7\u0026quot;\u003ca title=\"/d:getetag\" href=\"/d:getetag\"\u003e/d:getetag\u003c/a\u003eoc:id00000051ocya3bx9cxde\u003ca title=\"/oc:id\" href=\"/oc:id\"\u003e/oc:id\u003c/a\u003eoc:downloadURL\u003ca title=\"/oc:downloadURL\" href=\"/oc:downloadURL\"\u003e/oc:downloadURL\u003c/a\u003eoc:permissionsRGDNVW\u003ca title=\"/oc:permissions\" href=\"/oc:permissions\"\u003e/oc:permissions\u003c/a\u003eoc:data-fingerprint\u003ca title=\"/oc:data-fingerprint\" href=\"/oc:data-fingerprint\"\u003e/oc:data-fingerprint\u003c/a\u003eoc:share-types/\u003ca title=\"/d:prop\" href=\"/d:prop\"\u003e/d:prop\u003c/a\u003e\u0026lt;d:status\u0026gt;HTTP/1.1 200 OK\u003ca title=\"/d:status\" href=\"/d:status\"\u003e/d:status\u003c/a\u003e\u003ca title=\"/d:propstat\" href=\"/d:propstat\"\u003e/d:propstat\u003c/a\u003e\u0026lt;d:propstat\u0026gt;\u0026lt;d:prop\u0026gt;oc:dDC/oc:checksums/\u003ca title=\"/d:prop\" href=\"/d:prop\"\u003e/d:prop\u003c/a\u003e\u0026lt;d:status\u0026gt;HTTP/1.1 404 Not Found\u003ca title=\"/d:status\" href=\"/d:status\"\u003e/d:status\u003c/a\u003e\u003ca title=\"/d:propstat\" href=\"/d:propstat\"\u003e/d:propstat\u003c/a\u003e\u003ca title=\"/d:response\" href=\"/d:response\"\u003e/d:response\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNote the path /nextcloud/remote.php/dav/files/user/../.bash_profile. When the client goes to write this file to disk, it will write traverse to the directory above the sync location (~/Nextcloud/ by default, so would end up at ~/)\u003c/p\u003e\n\n\u003cp\u003eNext, the client should send a request to the server requesting the file, like so:\u003cbr\u003e\nGET \u003ca title=\"http://192.168.144.128/nextcloud/remote.php/dav/files/.bash_profile\" href=\"/redirect?url=http%3A%2F%2F192.168.144.128%2Fnextcloud%2Fremote.php%2Fdav%2Ffiles%2F.bash_profile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://192.168.144.128/nextcloud/remote.php/dav/files/.bash_profile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e HTTP/1.1\u003cbr\u003e\nHost: 192.168.144.128\u003cbr\u003e\nAuthorization: Basic abc123\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Linux) mirall/2.5.2git (build 20190319) (Nextcloud)\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nX-Request-ID: 4a1e1d20-283b-4072-9d24-9f39cf7db243abc123\u003cbr\u003e\nCookie: nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true; ocya3bx9cxde=rvam; oc_sessionPassphrase=srq12bLDYJI8abc123\u003cbr\u003e\nConnection: Keep-Alive\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nAccept-Language: en-US,*\u003c/p\u003e\n\n\u003cp\u003eThe server should reply saying the file wasn\u0026#39;t found. Modify the response to become:\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 200 OK\u003cbr\u003e\nConnection: close\u003cbr\u003e\nContent-Type: text/text; charset=utf-8\u003cbr\u003e\nContent-Length: 93\u003cbr\u003e\nETag: 08b9d12b0e2263f92820e8b4706a42c7\u003c/p\u003e\n\n\u003cp\u003eecho \u0026quot;It worked! Nextcloud Linux client directory traversal/code execution proof of concept.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e...and the content will be written to ~/.bash_profile instead of ~/Nextcloud/.bash_profile\u003c/p\u003e\n\n\u003cp\u003eTo simplify the process, I created a proof of concept Python script and attached it here. The script must be run with Python3 and requires the requests HTTP library. It listens on port 8080 and is a proxy; it forwards all requests from the client to the real Nextcloud server. The proxy reviews each request and if it detects one of the aforementioned vulnerable requests, it modifies the server reply appropriately. For PoC purposes the filename is test.txt.\u003c/p\u003e\n\n\u003cp\u003eTo use, open a terminal and run \u0026#39;python3 poc.py\u0026#39;. Open the Nextcloud client settings, go to Network, and set it to use a proxy of 127.0.0.1 port 8080. You can force a sync if one does not trigger. After it syncs you should get a file \u0026#39;test.txt\u0026#39; written one level above your Nextcloud sync folder.\u003c/p\u003e\n\n\u003cp\u003eFor testing purposes an http-only Nextcloud server is needed, as the proxy is not SSL capable.\u003c/p\u003e\n\n\u003cp\u003eThe proxy is not completely reliable, you may need to get the proxy running, then set the Nextcloud client to use proxy address 127.0.0.1:8080. If you have any issues identifying or reproducing this please let me know.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch2 id=\"limitations\"\u003eLimitations\u003c/h2\u003e\n\n\u003cp\u003eSome limitations surrounding this vulnerability:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOnly new files can be written to disk. I have not found a way to overwrite existing files, i.e. if ~/test.txt already exists it won\u0026#39;t get overwritten by the attacker\u0026#39;s content.\u003c/li\u003e\n\u003cli\u003eAn attacker can only write files to locations the Nextcloud program has permission to access.\u003c/li\u003e\n\u003cli\u003eThe attacker must continously have the intercept running to keep the file on the target\u0026#39;s system. If you stop the proof of concept script, the client interprets the exploit file\u0026#39;s absence in the next sync as meaning it was deleted elsewhere, so it deletes the local copy. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince an attacker cannot overwrite existing files, this makes getting anything useful from the exploit harder, but not impossible. I have noticed with Ubuntu 16.04 and 18.04 systems the ~/.bash_profile file is absent by default. Bash executes any commands in this file when the user logs in from a terminal (not the GUI and not when opening the Terminal app within the GUI). An attacker could potentially get remote code execution by:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eExploiting the Nextcloud client to write ~/.bash_profile containing shell commands.\u003c/li\u003e\n\u003cli\u003eGetting lucky and having the user log in via SSH or virtual console. For example, in Ubuntu, pressing CTRL+ALT+F1 at the GUI login screen brings up a virtual console. Logging in here will execute ~/.bash_profile.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAn attacker could also write various executable files (jar, sh, bin, etc) to various places on the user\u0026#39;s system and hope the user, not knowing how they got there, would execute one.\u003c/p\u003e\n\n\u003cp\u003eOther exploit payloads might exist, this is all I could come up at this time.\u003c/p\u003e\n\n\u003ch2 id=\"scope\"\u003eScope\u003c/h2\u003e\n\n\u003cp\u003eIf a Nextcloud server adminstrator wanted to exploit the vulnerability, they could do so on the Nextcloud server itself by modifying the core code and not rely in traffic interception. Modifying the Nextcloud PHP code directly would also have the benefit of removing SSL as a limitation. \u003c/p\u003e\n\n\u003cp\u003eThe Nextcloud security scope document states Nextcloud administrators are expected to have ability to access all user files and execute code on the server. However, with this vulnerability Nextcloud administrators could potentially execute code on remote user clients, which they may not have control over. \u003c/p\u003e\n\n\u003cp\u003eSorry for the long winded report. :) If I can provide any further information please let me know. Thanks!\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":496879,"file_name":"nextcloud_poc.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/496/879/5e3a06b689bb968be7a420ebc5614f85b6362fe7/nextcloud_poc.py?response-content-disposition=attachment%3B%20filename%3D%22nextcloud_poc.py%22%3B%20filename%2A%3DUTF-8%27%27nextcloud_poc.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062839Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=6f469cc2f9ae27bfe02e891db1a2b2bb560440f75ee99a38456e53b370105664","file_size":8059,"type":"text/x-python"}],"allow_singular_disclosure_at":"2020-09-04T08:52:47.851Z","allow_singular_disclosure_after":-10013751.797085924,"singular_disclosure_allowed":true,"vote_count":13,"voters":["mygf","khizer47","xko2x","paqman","hitman_","aoneslex","tungisme","gr3yr0n1n","hodiecras","mr0bart","and 3 more..."],"severity":{"rating":"medium","score":5.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":77,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Desktop Client","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4925127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-05-26T04:50:07.136Z","updated_at":"2019-05-26T04:50:07.136Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4925129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Gah, looks like Markdown ate my copy/pasted XML. Sorry about that. Let me know if you'd like it and I can upload a text file or something.","markdown_message":"\u003cp\u003eGah, looks like Markdown ate my copy/pasted XML. Sorry about that. Let me know if you\u0026#39;d like it and I can upload a text file or something.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-26T04:50:58.525Z","updated_at":"2019-05-26T04:50:58.525Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4931389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @icewater ,\n\nThanks for your report. I'll discuss this with our desktop team adn get back to you.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi \u003ca href=\"/icewater\"\u003e@icewater\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report. I\u0026#39;ll discuss this with our desktop team adn get back to you.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-27T11:44:04.015Z","updated_at":"2019-05-27T11:44:04.015Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4931391,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-27T11:44:23.972Z","updated_at":"2019-05-27T11:44:23.972Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6283102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Nextcloud, do you know if this issue has been investigated further? Thanks!","markdown_message":"\u003cp\u003eHello Nextcloud, do you know if this issue has been investigated further? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-12T01:02:23.927Z","updated_at":"2019-11-12T01:02:23.927Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8222441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Nextcloud, wondering if you've had a chance to investigate this issue further? If I can provide further information please feel free to let me know.","markdown_message":"\u003cp\u003eHello Nextcloud, wondering if you\u0026#39;ve had a chance to investigate this issue further? If I can provide further information please feel free to let me know.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-07T04:17:57.669Z","updated_at":"2020-06-07T04:17:57.669Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8229095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, the comment was set to the wrong visibility:\n\nA PR was done 21 days ago and merged 19 days ago:\nhttps://github.com/nextcloud/desktop/pull/1986\n\nIf you want you can try the daily build of the desktop clients to see if it works:\nhttps://download.nextcloud.com/desktop/daily/Linux/\n\nOtherwise you have to wait for 2.6.5 to be released which should come soon.","markdown_message":"\u003cp\u003eSorry, the comment was set to the wrong visibility:\u003c/p\u003e\n\n\u003cp\u003eA PR was done 21 days ago and merged 19 days ago:\u003cbr\u003e\n\u003ca title=\"https://github.com/nextcloud/desktop/pull/1986\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fdesktop%2Fpull%2F1986\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/desktop/pull/1986\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you want you can try the daily build of the desktop clients to see if it works:\u003cbr\u003e\n\u003ca title=\"https://download.nextcloud.com/desktop/daily/Linux/\" href=\"/redirect?url=https%3A%2F%2Fdownload.nextcloud.com%2Fdesktop%2Fdaily%2FLinux%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://download.nextcloud.com/desktop/daily/Linux/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOtherwise you have to wait for 2.6.5 to be released which should come soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-08T09:36:03.429Z","updated_at":"2020-06-08T09:36:03.429Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8229113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Further roadmap:\nOnce 2.6.5 is out, we will \"resolve\" this issue on h1 and prepare the advisories and CVE.\nSA and CVE are published ~4 weeks after the release","markdown_message":"\u003cp\u003eFurther roadmap:\u003cbr\u003e\nOnce 2.6.5 is out, we will \u0026quot;resolve\u0026quot; this issue on h1 and prepare the advisories and CVE.\u003cbr\u003e\nSA and CVE are published ~4 weeks after the release\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-08T09:39:06.200Z","updated_at":"2020-06-08T09:39:06.200Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8243321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries, thank you for the update. I need to recreate my test environment but once I do I'll try to give this issue a retest.","markdown_message":"\u003cp\u003eNo worries, thank you for the update. I need to recreate my test environment but once I do I\u0026#39;ll try to give this issue a retest.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-09T14:14:31.110Z","updated_at":"2020-06-09T14:14:31.110Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8657494,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tested client 2.6.5 today and was unable to reproduce the vulnerability. Appears to be fixed. ","markdown_message":"\u003cp\u003eI tested client 2.6.5 today and was unable to reproduce the vulnerability. Appears to be fixed. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T19:57:20.262Z","updated_at":"2020-07-20T19:57:20.262Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8794541,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-07-29T14:51:06.852Z","updated_at":"2020-07-29T14:51:06.852Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"icewater","url":"/icewater"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8796361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, for credit information just a name this time:\nName: Carl Pearson\n","markdown_message":"\u003cp\u003eThanks, for credit information just a name this time:\u003cbr\u003e\nName: Carl Pearson\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-29T15:56:09.969Z","updated_at":"2020-07-29T15:56:09.969Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8802536,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-30T07:35:13.433Z","updated_at":"2020-07-30T07:35:13.433Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.1)","old_severity_id":402254,"new_severity_id":805195},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8802630,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-30T07:50:42.993Z","updated_at":"2020-07-30T07:50:42.993Z","additional_data":{"old_title":"Linux client - directory traversal when downloading files","new_title":"Linux client is vulnerable to directory traversal when downloading files"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8851722,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"SA will be published at https://nextcloud.com/security/advisory/?id=NC-SA-2020-032\nRequested CVE: CVE-2020-8227","markdown_message":"\u003cp\u003eSA will be published at \u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-032\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-032\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-032\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nRequested CVE: CVE-2020-8227\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-05T08:52:47.761Z","updated_at":"2020-08-05T08:52:47.761Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8955325,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T10:06:47.839Z","updated_at":"2020-08-17T10:06:47.839Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"icewater","url":"/icewater"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8957557,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T12:57:06.342Z","updated_at":"2020-08-17T12:57:06.342Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8957558,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T12:57:06.432Z","updated_at":"2020-08-17T12:57:06.432Z","actor":{"username":"icewater","cleared":true,"url":"/icewater","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}