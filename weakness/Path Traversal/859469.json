{"id":859469,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTk0Njk=","url":"https://hackerone.com/reports/859469","title":"Path traversal in ZIP extract routine on LINE Android","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-26T01:07:30.646Z","submitted_at":"2020-04-26T01:07:30.646Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kanytu","url":"/kanytu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13343,"url":"https://hackerone.com/line","handle":"line","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LINE","twitter_handle":"","website":"https://line.me","about":"LINE Security Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-17T06:26:56.030Z","bug_reporter_agreed_on_going_public_at":"2020-10-26T10:34:28.104Z","team_member_agreed_on_going_public_at":"2020-11-17T06:26:55.423Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"475.0","formatted_bounty":"$475","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":29,"voters":["ltidi","mashoud1122","xnutronex","kapkan","bitsscrambler","hardlane","akshansh","mygf","powerjacobb1","aporlorxl23","and 19 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":32087,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"jp.naver.line.android","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7808887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T12:54:33.940Z","updated_at":"2020-04-27T12:54:33.940Z","actor":{"username":"nochnoidozor","cleared":false,"url":"/nochnoidozor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7809115,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T13:19:28.647Z","updated_at":"2020-04-27T13:19:28.647Z","actor":{"username":"nochnoidozor","cleared":false,"url":"/nochnoidozor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7809289,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-27T13:37:05.080Z","updated_at":"2020-04-27T13:37:05.080Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7871962,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-02T09:12:37.131Z","updated_at":"2020-05-02T09:12:37.131Z","additional_data":{},"actor":{"username":"nochnoidozor","cleared":false,"url":"/nochnoidozor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7882099,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-04T04:13:56.909Z","updated_at":"2020-05-04T04:13:56.909Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7997533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T08:45:43.118Z","updated_at":"2020-05-14T08:45:43.118Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8382473,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-23T08:53:37.198Z","updated_at":"2020-06-23T08:53:37.198Z","actor":{"url":"/line","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LINE"}},"bounty_amount":"475.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"line","collaborator":{"username":"kanytu","url":"/kanytu"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8733668,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-24T03:54:29.821Z","updated_at":"2020-07-24T03:54:29.821Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kanytu","url":"/kanytu"},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9633684,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-26T10:34:28.133Z","updated_at":"2020-10-26T10:34:28.133Z","first_to_agree":true,"actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9635360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-26T12:48:14.690Z","updated_at":"2020-10-26T12:48:14.690Z","actor":{"username":"dokydoky_line","cleared":false,"url":"/dokydoky_line","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9840230,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T05:12:50.968Z","updated_at":"2020-11-17T05:12:50.968Z","additional_data":{},"actor":{"username":"lee-by","cleared":false,"url":"/lee-by","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/e7YSYHJbCxRkTMx3w2a92mts/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9840468,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T06:26:55.463Z","updated_at":"2020-11-17T06:26:55.463Z","actor":{"username":"lee-by","cleared":false,"url":"/lee-by","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/e7YSYHJbCxRkTMx3w2a92mts/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9840469,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T06:26:56.073Z","updated_at":"2020-11-17T06:26:56.073Z","actor":{"username":"lee-by","cleared":false,"url":"/lee-by","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/e7YSYHJbCxRkTMx3w2a92mts/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":25462,"category":"team","content":"@kanytu discovered that LINE Keep(a file storage service in the LINE App) contains an unsafe unzipping pattern, which can potentially be exploited to launch Path traversal attack. The reporter proved that it can lead to overwriting files in the LINE app's private folders under certain conditions by providing a PoC Android application and clear explanations. Additionally, there was an issue of LINE storing data in external storage, which was a known issue prior to reporting and had been fixed.\n\nThe complete chain looks like this:\n\nPre-conditions:\n\nLINE for Android provisioned with a valid account\nLINE for Chrome installed and configured with the same account as the device\n\"Do not keep activities\" setting has to be disabled\nA malicious Android application must be pre-installed on the victim's device and STORAGE permission is required.\nSteps to reproduce:\n\nIn LINE for Chrome, create a new Memo and add some text to it.\nInstall the PoC Android application on the victim's device and grant STORAGE permission when requested\nOpen LINE for Android and go to the \"keep\" account.\n\nYou can see the new note there, as a ZIP file. If not, pull to refresh. At this point, the PoC application tries to replace the original Memo file with a malicious ZIP file which contains an entry containing path traversal characters (“../”) in its name (e.g. `../../../../../../../data/data/jp.naver.line.android/files/something`)\n\nTap your ZIP note and tap on it again to open the contents of the ZIP file\n\nThe LINE app will crash as part of a \"SecurityException,\" but at this point, the files in the LINE app's private folders have already been overwritten.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/kanytu\"\u003e@kanytu\u003c/a\u003e discovered that LINE Keep(a file storage service in the LINE App) contains an unsafe unzipping pattern, which can potentially be exploited to launch Path traversal attack. The reporter proved that it can lead to overwriting files in the LINE app\u0026#39;s private folders under certain conditions by providing a PoC Android application and clear explanations. Additionally, there was an issue of LINE storing data in external storage, which was a known issue prior to reporting and had been fixed.\u003c/p\u003e\n\n\u003cp\u003eThe complete chain looks like this:\u003c/p\u003e\n\n\u003cp\u003ePre-conditions:\u003c/p\u003e\n\n\u003cp\u003eLINE for Android provisioned with a valid account\u003cbr\u003e\nLINE for Chrome installed and configured with the same account as the device\u003cbr\u003e\n\u0026quot;Do not keep activities\u0026quot; setting has to be disabled\u003cbr\u003e\nA malicious Android application must be pre-installed on the victim\u0026#39;s device and STORAGE permission is required.\u003cbr\u003e\nSteps to reproduce:\u003c/p\u003e\n\n\u003cp\u003eIn LINE for Chrome, create a new Memo and add some text to it.\u003cbr\u003e\nInstall the PoC Android application on the victim\u0026#39;s device and grant STORAGE permission when requested\u003cbr\u003e\nOpen LINE for Android and go to the \u0026quot;keep\u0026quot; account.\u003c/p\u003e\n\n\u003cp\u003eYou can see the new note there, as a ZIP file. If not, pull to refresh. At this point, the PoC application tries to replace the original Memo file with a malicious ZIP file which contains an entry containing path traversal characters (“../”) in its name (e.g. \u003ccode\u003e../../../../../../../data/data/jp.naver.line.android/files/something\u003c/code\u003e)\u003c/p\u003e\n\n\u003cp\u003eTap your ZIP note and tap on it again to open the contents of the ZIP file\u003c/p\u003e\n\n\u003cp\u003eThe LINE app will crash as part of a \u0026quot;SecurityException,\u0026quot; but at this point, the files in the LINE app\u0026#39;s private folders have already been overwritten.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}