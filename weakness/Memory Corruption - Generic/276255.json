{"id":276255,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzYyNTU=","url":"https://hackerone.com/reports/276255","title":"Use of unitialized value in token_check_object (src/or/parsecommon.c:224)","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-10-11T04:53:58.839Z","submitted_at":"2017-10-11T04:53:58.839Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-04T16:25:57.684Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:25:57.635Z","team_member_agreed_on_going_public_at":"2017-11-07T01:56:37.353Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Triggered in `22139c0`, compiled with `-fsanitize=memory` and clang 6.0.0-trunk.\n\n`./fuzz-consensus \u003c test00d68`\n\n```\n=9591==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55ca86e51348 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55ca86e51348 in get_next_token /root/tor/src/or/parsecommon.c:397\n    #2 0x55ca86e3ff83 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55ca8711139a in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55ca8676fbd1 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55ca8676f29d in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f32a84f2b44 in __libc_start_main /build/glibc-6V9RKT/glibc-2.19/csu/libc-start.c:287\n    #7 0x55ca866fc8ce in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x3bc8ce)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\n```","vulnerability_information_html":"\u003cp\u003eTriggered in \u003ccode\u003e22139c0\u003c/code\u003e, compiled with \u003ccode\u003e-fsanitize=memory\u003c/code\u003e and clang 6.0.0-trunk.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e./fuzz-consensus \u0026lt; test00d68\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e=9591==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55ca86e51348 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55ca86e51348 in get_next_token /root/tor/src/or/parsecommon.c:397\n    #2 0x55ca86e3ff83 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55ca8711139a in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55ca8676fbd1 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55ca8676f29d in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f32a84f2b44 in __libc_start_main /build/glibc-6V9RKT/glibc-2.19/csu/libc-start.c:287\n    #7 0x55ca866fc8ce in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x3bc8ce)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":274998,"original_report_url":"https://hackerone.com/reports/274998","attachments":[{"id":228135,"file_name":"test00d68.gz","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/228/135/713b5d32a79bb3ff3449fe4ed64ca368702580cb/test00d68.gz?response-content-disposition=attachment%3B%20filename%3D%22test00d68.gz%22%3B%20filename%2A%3DUTF-8%27%27test00d68.gz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=2919319546c2ee32a546f30244395978fff6f9cc6f792f45d44116d9b4e06972","file_size":1475,"type":"application/gzip"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["0xd0m7","geeknik","x0x01"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2102506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"better stack trace:\n\n```\n==27377==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55f18fea89d4 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55f18fea4fc7 in get_next_token /root/tor/src/or/parsecommon.c:397:9\n    #2 0x55f18fea1a93 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55f1900356ce in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55f18fae8b33 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55f18fae7fc0 in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f39f76c63f0 in __libc_start_main /build/glibc-mXZSwJ/glibc-2.24/csu/../csu/libc-start.c:291\n    #7 0x55f18fa75a19 in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x71a19)\n\n  Uninitialized value was created by a heap allocation\n    #0 0x55f18fa9e77d in __interceptor_malloc (/root/tor/src/test/fuzz/fuzz-consensus+0x9a77d)\n    #1 0x7f39f8a45e87 in CRYPTO_malloc (/lib/x86_64-linux-gnu/libcrypto.so.1.0.0+0x62e87)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\nExiting\n```","markdown_message":"\u003cp\u003ebetter stack trace:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e==27377==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55f18fea89d4 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55f18fea4fc7 in get_next_token /root/tor/src/or/parsecommon.c:397:9\n    #2 0x55f18fea1a93 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55f1900356ce in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55f18fae8b33 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55f18fae7fc0 in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f39f76c63f0 in __libc_start_main /build/glibc-mXZSwJ/glibc-2.24/csu/../csu/libc-start.c:291\n    #7 0x55f18fa75a19 in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x71a19)\n\n  Uninitialized value was created by a heap allocation\n    #0 0x55f18fa9e77d in __interceptor_malloc (/root/tor/src/test/fuzz/fuzz-consensus+0x9a77d)\n    #1 0x7f39f8a45e87 in CRYPTO_malloc (/lib/x86_64-linux-gnu/libcrypto.so.1.0.0+0x62e87)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\nExiting\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-10-25T18:35:56.654Z","updated_at":"2017-10-25T18:35:56.654Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2139000,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks for the report. This looks like a very similar code path as #274998, where the memory allocated and written to in libcrypto isn't marked by MemorySanitizer as initialized, probably due to lack of instrumentation in libcrypto.","markdown_message":"\u003cp\u003eThanks for the report. This looks like a very similar code path as \u003ca href=\"/reports/274998\"\u003e#274998\u003c/a\u003e, where the memory allocated and written to in libcrypto isn\u0026#39;t marked by MemorySanitizer as initialized, probably due to lack of instrumentation in libcrypto.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-07T01:55:53.586Z","updated_at":"2017-11-07T01:55:53.586Z","original_report_id":274998,"actor":{"username":"argonblue","cleared":false,"url":"/argonblue","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2139003,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-07T01:56:37.403Z","updated_at":"2017-11-07T01:56:37.403Z","first_to_agree":true,"actor":{"username":"argonblue","cleared":false,"url":"/argonblue","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960702,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:25:57.656Z","updated_at":"2019-10-04T16:25:57.656Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960703,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:25:57.703Z","updated_at":"2019-10-04T16:25:57.703Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}