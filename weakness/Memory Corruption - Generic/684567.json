{"id":684567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODQ1Njc=","url":"https://hackerone.com/reports/684567","title":"Linux kernel: CVE-2017-7308: a signedness issue in AF_PACKET sockets","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-29T13:48:44.294Z","submitted_at":"2019-08-29T13:48:44.294Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xairy","url":"/xairy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-11T00:19:43.892Z","bug_reporter_agreed_on_going_public_at":"2019-09-11T00:19:43.844Z","team_member_agreed_on_going_public_at":"2019-09-10T22:43:23.274Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi!\n\n[CVE-2017-7308](https://nvd.nist.gov/vuln/detail/CVE-2017-7308) is a vulnerability I found in the Linux kernel caused by a signedness issue in AF_PACKET sockets. It can be exploited to gain kernel code execution from an unprivileged process. The kernel has to be built with CONFIG_PACKET for the vulnerability to be present. A lot of modern distributions enable this option by default.\n\nI initially reported this vulnerability to security@kernel.org following the coordinated disclosure process. As advised by them I've developed a fix for this vulnerability and sent it upstream. The fix was [committed](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=2b6867c2ce76c596676bec7d2d525af525fdc6e2) on Mar 30, 2017.\n\nI wrote a proof-of-concept exploit for the 4.8.0-41-generic Ubuntu kernel which gains root from an unprivileged user, which can be found [here](https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-7308). More details about the vulnerability and exploitation can be found [here](https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html).\n\nThe reason I'm reporting this now is that a [similar bug](https://hackerone.com/reports/347282) that I've reported a while ago has recently been triaged and addressed, so it seems that LPE Linux kernel bugs are within the scope of this IBB program.\n\nThanks!\n\n## Impact\n\nThis vulnerability allows a local attacker to elevate privileges to root on a machine with vulnerable Linux kernel version.","vulnerability_information_html":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE-2017-7308\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVE-2017-7308\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is a vulnerability I found in the Linux kernel caused by a signedness issue in AF_PACKET sockets. It can be exploited to gain kernel code execution from an unprivileged process. The kernel has to be built with CONFIG_PACKET for the vulnerability to be present. A lot of modern distributions enable this option by default.\u003c/p\u003e\n\n\u003cp\u003eI initially reported this vulnerability to \u003ca title=\"security@kernel.org\" href=\"mailto:security@kernel.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@kernel.org\u003c/a\u003e following the coordinated disclosure process. As advised by them I\u0026#39;ve developed a fix for this vulnerability and sent it upstream. The fix was \u003ca href=\"/redirect?url=https%3A%2F%2Fgit.kernel.org%2Fcgit%2Flinux%2Fkernel%2Fgit%2Ftorvalds%2Flinux.git%2Fcommit%2F%3Fid%3D2b6867c2ce76c596676bec7d2d525af525fdc6e2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecommitted\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on Mar 30, 2017.\u003c/p\u003e\n\n\u003cp\u003eI wrote a proof-of-concept exploit for the 4.8.0-41-generic Ubuntu kernel which gains root from an unprivileged user, which can be found \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fxairy%2Fkernel-exploits%2Ftree%2Fmaster%2FCVE-2017-7308\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. More details about the vulnerability and exploitation can be found \u003ca href=\"/redirect?url=https%3A%2F%2Fgoogleprojectzero.blogspot.com%2F2017%2F05%2Fexploiting-linux-kernel-via-packet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe reason I\u0026#39;m reporting this now is that a \u003ca href=\"https://hackerone.com/reports/347282\"\u003esimilar bug\u003c/a\u003e that I\u0026#39;ve reported a while ago has recently been triaged and addressed, so it seems that LPE Linux kernel bugs are within the scope of this IBB program.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability allows a local attacker to elevate privileges to root on a machine with vulnerable Linux kernel version.\u003c/p\u003e\n","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-10T22:43:23.360Z","allow_singular_disclosure_after":-38476467.705028675,"singular_disclosure_allowed":true,"vote_count":10,"voters":["0-1","cyberunit","codeanddecode","cryptographer","unsecury","carlos_melero","sun_sc","netmous3","firegod","danidbugger"],"severity":{"rating":"high","score":7.8,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5713684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xairy,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xairy\"\u003e@xairy\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T18:22:05.467Z","updated_at":"2019-09-02T18:22:05.467Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5713693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xairy - I'm discussing this submission internally with the The Internet team. You will be updated as soon as there is additional information to share. Thanks for your patience! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xairy\"\u003e@xairy\u003c/a\u003e - I\u0026#39;m discussing this submission internally with the The Internet team. You will be updated as soon as there is additional information to share. Thanks for your patience! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T18:26:03.282Z","updated_at":"2019-09-02T18:26:03.282Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5775146,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Hi @xairy,\n\nAfter discussing this with the IBB Panel today, we've decided that this issue is just too old to qualify. We only recently decided we're going to pay out for certain Linux kernel issues, and we just don't have the resources or funding to backdate that to vulnerabilities fixed several years ago.\n\nIf you find new issues, we'd be happy to take a look at them.\n\nUntil then, happy hacking, and thanks for helping protect the Internet!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xairy\"\u003e@xairy\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAfter discussing this with the IBB Panel today, we\u0026#39;ve decided that this issue is just too old to qualify. We only recently decided we\u0026#39;re going to pay out for certain Linux kernel issues, and we just don\u0026#39;t have the resources or funding to backdate that to vulnerabilities fixed several years ago.\u003c/p\u003e\n\n\u003cp\u003eIf you find new issues, we\u0026#39;d be happy to take a look at them.\u003c/p\u003e\n\n\u003cp\u003eUntil then, happy hacking, and thanks for helping protect the Internet!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-10T22:43:10.299Z","updated_at":"2019-09-10T22:43:10.299Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5775147,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T22:43:17.168Z","updated_at":"2019-09-10T22:43:17.168Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"xairy","url":"/xairy"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5775148,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T22:43:23.294Z","updated_at":"2019-09-10T22:43:23.294Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5775460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi!\n\nThat's unfortunate.\n\nCould you define some formal rules of how old a vulnerability must be to qualify and put those in the IBB program description?\n\nThanks!","markdown_message":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s unfortunate.\u003c/p\u003e\n\n\u003cp\u003eCould you define some formal rules of how old a vulnerability must be to qualify and put those in the IBB program description?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-11T00:19:37.655Z","updated_at":"2019-09-11T00:19:37.655Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5775461,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-11T00:19:43.862Z","updated_at":"2019-09-11T00:19:43.862Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5775462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-11T00:19:43.908Z","updated_at":"2019-09-11T00:19:43.908Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5775718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@xairy, while we do that for all other IBB programs, @internet is meant to have a pretty open scope. Every bounty is individually voted on by the IBB Panel. As such, I don't expect us to constrain ourselves too much in the policy, as in the end, it's the IBB Panel's explicit decision as to award a bounty in all such submitted reports.","markdown_message":"\u003cp\u003e\u003ca href=\"/xairy\"\u003e@xairy\u003c/a\u003e, while we do that for all other IBB programs, \u003ca href=\"/internet\"\u003e@internet\u003c/a\u003e is meant to have a pretty open scope. Every bounty is individually voted on by the IBB Panel. As such, I don\u0026#39;t expect us to constrain ourselves too much in the policy, as in the end, it\u0026#39;s the IBB Panel\u0026#39;s explicit decision as to award a bounty in all such submitted reports.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-11T02:22:30.163Z","updated_at":"2019-09-11T02:22:30.163Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}