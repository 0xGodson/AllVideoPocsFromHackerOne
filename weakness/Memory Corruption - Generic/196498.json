{"id":196498,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY0OTg=","url":"https://hackerone.com/reports/196498","title":"Segmentation fault on program counter","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-07T06:47:57.572Z","submitted_at":"2017-01-07T06:47:57.572Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"icanthack","url":"/icanthack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-05T04:50:47.169Z","bug_reporter_agreed_on_going_public_at":"2017-02-05T04:50:47.106Z","team_member_agreed_on_going_public_at":"2017-01-30T21:33:17.798Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Mruby running on linux x64\ngcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)\n\npoc\n```\nfor i in methods Kernel.initialize.public_methods print\nprint %i[0 0 0 0]end\n```\n \noutput\n```\n[----------------------------------registers-----------------------------------]\nRAX: 0x6b0e00 --\u003e 0x80101\nRBX: 0x6bef20 --\u003e 0x6b73d0 --\u003e 0x210\nRCX: 0x6ac010 --\u003e 0x7fffffffe0b0 --\u003e 0x0\nRDX: 0x8\nRSI: 0x6b3830 --\u003e 0x408\nRDI: 0x6ac010 --\u003e 0x7fffffffe0b0 --\u003e 0x0\nRBP: 0x7fffffffe1a0 --\u003e 0x7fffffffe1f0 --\u003e 0x7fffffffe250 --\u003e 0x7fffffffe3e0 --\u003e 0x7fffffffe410 --\u003e 0x7fffffffe590 (--\u003e ...)\nRSP: 0x7fffffffdc18 --\u003e 0x40fdb4 (\u003cmrb_vm_exec+6984\u003e:\tmov    QWORD PTR [rbp-0x1d0],rax)\nRIP: 0x6b0e00 --\u003e 0x80101\nR8 : 0x1\nR9 : 0x10\nR10: 0x2cb11\nR11: 0xf7acd701\nR12: 0x401b20 (\u003c_start\u003e:\txor    ebp,ebp)\nR13: 0x7fffffffe670 --\u003e 0x2\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x10297 (CARRY PARITY ADJUST zero SIGN trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n   0x6b0dfa:\tadd    BYTE PTR [rax],al\n   0x6b0dfc:\tadd    BYTE PTR [rax],al\n   0x6b0dfe:\tadd    BYTE PTR [rax],al\n=\u003e 0x6b0e00:\tadd    DWORD PTR [rcx],eax\n   0x6b0e02:\tor     BYTE PTR [rax],al\n   0x6b0e04:\tadd    BYTE PTR [rax],al\n   0x6b0e06:\tadd    BYTE PTR [rax],al\n   0x6b0e08:\t(bad)\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffdc18 --\u003e 0x40fdb4 (\u003cmrb_vm_exec+6984\u003e:\tmov    QWORD PTR [rbp-0x1d0],rax)\n0008| 0x7fffffffdc20 --\u003e 0x5b00000000 ('')\n0016| 0x7fffffffdc28 --\u003e 0x0\n0024| 0x7fffffffdc30 --\u003e 0x0\n0032| 0x7fffffffdc38 --\u003e 0x48a3f8 --\u003e 0x280c001028040a0\n0040| 0x7fffffffdc40 --\u003e 0x6b0e30 --\u003e 0x8040d\n0048| 0x7fffffffdc48 --\u003e 0x6ac010 --\u003e 0x7fffffffe0b0 --\u003e 0x0\n0056| 0x7fffffffdc50 --\u003e 0x28040a000000000\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value\nStopped reason: SIGSEGV\n0x00000000006b0e00 in ?? ()\ngdb-peda$ bt\n#0  0x00000000006b0e00 in ?? ()\n#1  0x000000000040fdb4 in mrb_vm_exec (mrb=0x6ac010, proc=0x6b0e30, pc=0x48a3f8 \u003cgem_mrblib_irep_mruby_print+328\u003e) at /home/vagrant/mruby/src/vm.c:1174\n#2  0x000000000040e26a in mrb_vm_run (mrb=0x6ac010, proc=0x6af150, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:772\n#3  0x000000000041627e in mrb_top_run (mrb=0x6ac010, proc=0x6af150, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:2490\n#4  0x000000000043bfb4 in mrb_load_exec (mrb=0x6ac010, p=0x7082c0, c=0x706f30) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#5  0x000000000043c04a in mrb_load_file_cxt (mrb=0x6ac010, f=0x707f00, c=0x706f30) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n#6  0x00000000004024f8 in main (argc=0x2, argv=0x7fffffffe678) at /home/vagrant/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n#7  0x00007ffff7730f45 in __libc_start_main (main=0x40214f \u003cmain\u003e, argc=0x2, argv=0x7fffffffe678, init=\u003coptimized out\u003e, fini=\u003coptimized out\u003e,\n    rtld_fini=\u003coptimized out\u003e, stack_end=0x7fffffffe668) at libc-start.c:287\n#8  0x0000000000401b49 in _start ()\ngdb-peda$","vulnerability_information_html":"\u003cp\u003eMruby running on linux x64\u003cbr\u003e\ngcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)\u003c/p\u003e\n\n\u003cp\u003epoc\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efor i in methods Kernel.initialize.public_methods print\nprint %i[0 0 0 0]end\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eoutput\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[----------------------------------registers-----------------------------------]\nRAX: 0x6b0e00 --\u0026gt; 0x80101\nRBX: 0x6bef20 --\u0026gt; 0x6b73d0 --\u0026gt; 0x210\nRCX: 0x6ac010 --\u0026gt; 0x7fffffffe0b0 --\u0026gt; 0x0\nRDX: 0x8\nRSI: 0x6b3830 --\u0026gt; 0x408\nRDI: 0x6ac010 --\u0026gt; 0x7fffffffe0b0 --\u0026gt; 0x0\nRBP: 0x7fffffffe1a0 --\u0026gt; 0x7fffffffe1f0 --\u0026gt; 0x7fffffffe250 --\u0026gt; 0x7fffffffe3e0 --\u0026gt; 0x7fffffffe410 --\u0026gt; 0x7fffffffe590 (--\u0026gt; ...)\nRSP: 0x7fffffffdc18 --\u0026gt; 0x40fdb4 (\u0026lt;mrb_vm_exec+6984\u0026gt;:   mov    QWORD PTR [rbp-0x1d0],rax)\nRIP: 0x6b0e00 --\u0026gt; 0x80101\nR8 : 0x1\nR9 : 0x10\nR10: 0x2cb11\nR11: 0xf7acd701\nR12: 0x401b20 (\u0026lt;_start\u0026gt;:    xor    ebp,ebp)\nR13: 0x7fffffffe670 --\u0026gt; 0x2\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x10297 (CARRY PARITY ADJUST zero SIGN trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n   0x6b0dfa:    add    BYTE PTR [rax],al\n   0x6b0dfc:    add    BYTE PTR [rax],al\n   0x6b0dfe:    add    BYTE PTR [rax],al\n=\u0026gt; 0x6b0e00:    add    DWORD PTR [rcx],eax\n   0x6b0e02:    or     BYTE PTR [rax],al\n   0x6b0e04:    add    BYTE PTR [rax],al\n   0x6b0e06:    add    BYTE PTR [rax],al\n   0x6b0e08:    (bad)\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffdc18 --\u0026gt; 0x40fdb4 (\u0026lt;mrb_vm_exec+6984\u0026gt;:  mov    QWORD PTR [rbp-0x1d0],rax)\n0008| 0x7fffffffdc20 --\u0026gt; 0x5b00000000 (\u0026#39;\u0026#39;)\n0016| 0x7fffffffdc28 --\u0026gt; 0x0\n0024| 0x7fffffffdc30 --\u0026gt; 0x0\n0032| 0x7fffffffdc38 --\u0026gt; 0x48a3f8 --\u0026gt; 0x280c001028040a0\n0040| 0x7fffffffdc40 --\u0026gt; 0x6b0e30 --\u0026gt; 0x8040d\n0048| 0x7fffffffdc48 --\u0026gt; 0x6ac010 --\u0026gt; 0x7fffffffe0b0 --\u0026gt; 0x0\n0056| 0x7fffffffdc50 --\u0026gt; 0x28040a000000000\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value\nStopped reason: SIGSEGV\n0x00000000006b0e00 in ?? ()\ngdb-peda$ bt\n#0  0x00000000006b0e00 in ?? ()\n#1  0x000000000040fdb4 in mrb_vm_exec (mrb=0x6ac010, proc=0x6b0e30, pc=0x48a3f8 \u0026lt;gem_mrblib_irep_mruby_print+328\u0026gt;) at /home/vagrant/mruby/src/vm.c:1174\n#2  0x000000000040e26a in mrb_vm_run (mrb=0x6ac010, proc=0x6af150, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:772\n#3  0x000000000041627e in mrb_top_run (mrb=0x6ac010, proc=0x6af150, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:2490\n#4  0x000000000043bfb4 in mrb_load_exec (mrb=0x6ac010, p=0x7082c0, c=0x706f30) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#5  0x000000000043c04a in mrb_load_file_cxt (mrb=0x6ac010, f=0x707f00, c=0x706f30) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5764\n#6  0x00000000004024f8 in main (argc=0x2, argv=0x7fffffffe678) at /home/vagrant/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n#7  0x00007ffff7730f45 in __libc_start_main (main=0x40214f \u0026lt;main\u0026gt;, argc=0x2, argv=0x7fffffffe678, init=\u0026lt;optimized out\u0026gt;, fini=\u0026lt;optimized out\u0026gt;,\n    rtld_fini=\u0026lt;optimized out\u0026gt;, stack_end=0x7fffffffe668) at libc-start.c:287\n#8  0x0000000000401b49 in _start ()\ngdb-peda$\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-01T21:33:17.844Z","allow_singular_disclosure_after":-120813503.84240247,"singular_disclosure_allowed":true,"vote_count":10,"voters":["delimitry","mygf","icanthack","madrobot","mpz","eveeez","japz","spetr0x","b69fb2ebda43240ece9dbeb","sk0wt"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1405881,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-01-07T06:47:57.784Z","updated_at":"2017-01-07T06:47:57.784Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1414585,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the crash, and opened an issue upstream: https://github.com/mruby/mruby/issues/3397","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the crash, and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3397\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3397\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3397\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T20:47:46.463Z","updated_at":"2017-01-11T20:47:46.463Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414586,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-11T20:47:52.375Z","updated_at":"2017-01-11T20:47:52.375Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":18934},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1418992,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @icanthack, I just confirmed that this commit fixes the issue you reported: https://github.com/mruby/mruby/commit/38acb9ec36bdd56123e6680885499fbf7f729f21. Since this is fixed upstream, I'll close this issue as Resolved now.\n\nFor your information, we usually do payouts on a 2 week schedule, so our next round should be around January 23rd.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/icanthack\"\u003e@icanthack\u003c/a\u003e, I just confirmed that this commit fixes the issue you reported: \u003ca title=\"https://github.com/mruby/mruby/commit/38acb9ec36bdd56123e6680885499fbf7f729f21\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F38acb9ec36bdd56123e6680885499fbf7f729f21\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/38acb9ec36bdd56123e6680885499fbf7f729f21\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Since this is fixed upstream, I\u0026#39;ll close this issue as Resolved now.\u003c/p\u003e\n\n\u003cp\u003eFor your information, we usually do payouts on a 2 week schedule, so our next round should be around January 23rd.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-13T17:50:29.000Z","updated_at":"2017-01-13T17:50:29.000Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"icanthack","url":"/icanthack"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1424327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"okay. thanks!","markdown_message":"\u003cp\u003eokay. thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T07:22:59.490Z","updated_at":"2017-01-17T07:22:59.490Z","actor":{"username":"icanthack","cleared":true,"url":"/icanthack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1452699,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the Mruby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify and the Mruby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-30T21:33:11.866Z","updated_at":"2017-01-30T21:33:11.866Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"icanthack","url":"/icanthack"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1452700,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-30T21:33:17.819Z","updated_at":"2017-01-30T21:33:17.819Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1463494,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-05T04:50:47.130Z","updated_at":"2017-02-05T04:50:47.130Z","actor":{"username":"icanthack","cleared":true,"url":"/icanthack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1463495,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-05T04:50:47.185Z","updated_at":"2017-02-05T04:50:47.185Z","actor":{"username":"icanthack","cleared":true,"url":"/icanthack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}