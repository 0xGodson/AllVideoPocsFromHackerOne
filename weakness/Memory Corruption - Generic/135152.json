{"id":135152,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzUxNTI=","url":"https://hackerone.com/reports/135152","title":"Integer overflow in ZipArchive::getFrom*","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-28T07:46:56.198Z","submitted_at":"2016-04-28T07:46:56.198Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hji","url":"/hji","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/051/951/84a69eb3dbb5616cb38e216865e76698c1aa1917_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-05-05T21:20:48.775Z","bug_reporter_agreed_on_going_public_at":"2016-05-05T21:20:48.517Z","team_member_agreed_on_going_public_at":"2016-05-05T20:33:41.744Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"https://bugs.php.net/bug.php?id=71923","vulnerability_information_html":"\u003cp\u003e\u003ca title=\"https://bugs.php.net/bug.php?id=71923\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D71923\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=71923\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-04T20:33:41.789Z","allow_singular_disclosure_after":-144143534.77967468,"singular_disclosure_allowed":true,"vote_count":3,"voters":["mak","eboda","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":941314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice. Thank you for the excellently written proof-of-concept!\n\nImpact to vulnerable systems seems clear. Are you able to quantify or speculate as to how widespread this issue may be in practice? e.g., are there many standard libraries that call `getFrom[Name|Index]` on user-supplied archives? ","markdown_message":"\u003cp\u003eNice. Thank you for the excellently written proof-of-concept!\u003c/p\u003e\n\n\u003cp\u003eImpact to vulnerable systems seems clear. Are you able to quantify or speculate as to how widespread this issue may be in practice? e.g., are there many standard libraries that call \u003ccode\u003egetFrom[Name|Index]\u003c/code\u003e on user-supplied archives? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T00:35:19.604Z","updated_at":"2016-05-05T00:35:19.604Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":941442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A quick search suggest that PHPExcel[1] (which is bundled in\nMoodle[2][3]) and some other libraries from the PHPOffice project use\ngetFromName.  So does Fusionforge[4] when processing OpenDocument[5]\nfiles.\n\nA bunch of self-updaters in various packages (eg. WordPress[6]) also use\ngetFrom* -- although if one is in a position to MITM such a download and\nsupply an arbitrary zip file, a memory corruption is obviously not\nneeded to do wicked stuff (unless, I suppose, a signature is expected to\nbe embedded inside the archive, like some *nix package managers does...)\n\nNote that this is only a cursory search on Debian Code Search[7] -- I\nhaven't investigated whether the packages/libraries mentioned are\nvulnerable to CVE-2016-3078.\n\n1: https://github.com/PHPOffice/PHPExcel\n2: https://en.wikipedia.org/wiki/Moodle\n3: https://codesearch.debian.net/results/getFromName%20filetype%3Aphp%20package%3Amoodle/page_0\n4: https://sources.debian.net/src/fusionforge/6.0.4%2B20160504-1/plugins/projectimport/common/UploadedFiles.class.php/?hl=144#L144\n5: https://en.wikipedia.org/wiki/OpenDocument\n6: https://sources.debian.net/src/wordpress/4.5.1%2Bdfsg-1/wp-admin/includes/file.php/?hl=692#L692\n7: https://codesearch.debian.net/\n","markdown_message":"\u003cp\u003eA quick search suggest that PHPExcel[1] (which is bundled in\u003cbr\u003e\nMoodle[2][3]) and some other libraries from the PHPOffice project use\u003cbr\u003e\ngetFromName.  So does Fusionforge[4] when processing OpenDocument[5]\u003cbr\u003e\nfiles.\u003c/p\u003e\n\n\u003cp\u003eA bunch of self-updaters in various packages (eg. WordPress[6]) also use\u003cbr\u003e\ngetFrom* -- although if one is in a position to MITM such a download and\u003cbr\u003e\nsupply an arbitrary zip file, a memory corruption is obviously not\u003cbr\u003e\nneeded to do wicked stuff (unless, I suppose, a signature is expected to\u003cbr\u003e\nbe embedded inside the archive, like some *nix package managers does...)\u003c/p\u003e\n\n\u003cp\u003eNote that this is only a cursory search on Debian Code Search[7] -- I\u003cbr\u003e\nhaven\u0026#39;t investigated whether the packages/libraries mentioned are\u003cbr\u003e\nvulnerable to CVE-2016-3078.\u003c/p\u003e\n\n\u003cp\u003e1: \u003ca title=\"https://github.com/PHPOffice/PHPExcel\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPHPOffice%2FPHPExcel\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PHPOffice/PHPExcel\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2: \u003ca title=\"https://en.wikipedia.org/wiki/Moodle\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMoodle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Moodle\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n3: \u003ca title=\"https://codesearch.debian.net/results/getFromName%20filetype%3Aphp%20package%3Amoodle/page_0\" href=\"/redirect?url=https%3A%2F%2Fcodesearch.debian.net%2Fresults%2FgetFromName%2520filetype%253Aphp%2520package%253Amoodle%2Fpage_0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://codesearch.debian.net/results/getFromName%20filetype%3Aphp%20package%3Amoodle/page_0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n4: \u003ca title=\"https://sources.debian.net/src/fusionforge/6.0.4%2B20160504-1/plugins/projectimport/common/UploadedFiles.class.php/?hl=144#L144\" href=\"/redirect?url=https%3A%2F%2Fsources.debian.net%2Fsrc%2Ffusionforge%2F6.0.4%252B20160504-1%2Fplugins%2Fprojectimport%2Fcommon%2FUploadedFiles.class.php%2F%3Fhl%3D144%23L144\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sources.debian.net/src/fusionforge/6.0.4%2B20160504-1/plugins/projectimport/common/UploadedFiles.class.php/?hl=144#L144\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n5: \u003ca title=\"https://en.wikipedia.org/wiki/OpenDocument\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FOpenDocument\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/OpenDocument\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n6: \u003ca title=\"https://sources.debian.net/src/wordpress/4.5.1%2Bdfsg-1/wp-admin/includes/file.php/?hl=692#L692\" href=\"/redirect?url=https%3A%2F%2Fsources.debian.net%2Fsrc%2Fwordpress%2F4.5.1%252Bdfsg-1%2Fwp-admin%2Fincludes%2Ffile.php%2F%3Fhl%3D692%23L692\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sources.debian.net/src/wordpress/4.5.1%2Bdfsg-1/wp-admin/includes/file.php/?hl=692#L692\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n7: \u003ca title=\"https://codesearch.debian.net/\" href=\"/redirect?url=https%3A%2F%2Fcodesearch.debian.net%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://codesearch.debian.net/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T03:13:29.104Z","updated_at":"2016-05-05T03:13:29.104Z","actor":{"username":"hji","cleared":false,"url":"/hji","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/951/84a69eb3dbb5616cb38e216865e76698c1aa1917_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942792,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-05T20:33:24.273Z","updated_at":"2016-05-05T20:33:24.273Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"hji","url":"/hji"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942793,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-05T20:33:33.327Z","updated_at":"2016-05-05T20:33:33.327Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hji","url":"/hji"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942794,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T20:33:41.760Z","updated_at":"2016-05-05T20:33:41.760Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942902,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-05T21:20:48.732Z","updated_at":"2016-05-05T21:20:48.732Z","actor":{"username":"hji","cleared":false,"url":"/hji","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/951/84a69eb3dbb5616cb38e216865e76698c1aa1917_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942903,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-05T21:20:48.797Z","updated_at":"2016-05-05T21:20:48.797Z","actor":{"username":"hji","cleared":false,"url":"/hji","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/951/84a69eb3dbb5616cb38e216865e76698c1aa1917_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}