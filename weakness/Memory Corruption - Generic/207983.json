{"id":207983,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDc5ODM=","url":"https://hackerone.com/reports/207983","title":"read outside of buffer (heap buffer overflow) in S_regmatch - regexec.c:6057","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-02-21T19:06:08.632Z","submitted_at":"2017-02-21T19:06:08.632Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30,"url":"https://hackerone.com/ibb-perl","handle":"ibb-perl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Perl (IBB)","twitter_handle":"","website":"http://www.perl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-28T19:23:59.393Z","bug_reporter_agreed_on_going_public_at":"2017-05-26T22:47:48.342Z","team_member_agreed_on_going_public_at":"2017-05-28T19:23:59.310Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Reported to the Perl security mailing list on 20 August 2016, reported fixed by `khw` on 30 August 2016. \n\n```\n==14086==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900000a4aa at pc 0x000000b9988f bp 0x7fff325d9630 sp 0x7fff325d9628\nREAD of size 1 at 0x61900000a4aa thread T0\n    #0 0xb9988e in S_regmatch /root/perl/regexec.c:6057:24\n    #1 0xb691ec in S_regtry /root/perl/regexec.c:3619:14\n    #2 0xb5323c in S_find_byclass /root/perl/regexec.c:2357:9\n    #3 0xb41439 in Perl_regexec_flags /root/perl/regexec.c:3368:13\n    #4 0xa36982 in Perl_pp_substcont /root/perl/pp_ctl.c:225:18\n    #5 0x7f1b53 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #6 0x5a0ff6 in S_run_body /root/perl/perl.c:2524:2\n    #7 0x5a0ff6 in perl_run /root/perl/perl.c:2447\n    #8 0x4de68d in main /root/perl/perlmain.c:123:9\n    #9 0x7fdb3ea25b44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #10 0x4de2fc in _start (/root/perl/perl+0x4de2fc)\n\n0x61900000a4aa is located 2 bytes to the right of 1064-byte region [0x61900000a080,0x61900000a4a8)\nallocated by thread T0 here:\n    #0 0x4c0c7b in malloc (/root/perl/perl+0x4c0c7b)\n    #1 0x7f5997 in Perl_safesysmalloc /root/perl/util.c:153:21\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/perl/regexec.c:6057 S_regmatch\n```\nIn some circumstances, this will just cause a crash (denial of service), in other circumstances, it could read outside of the buffer by up to 12 bytes:\n\n```\nThat means the maximum it can extend beyond the string is 12 bytes, if the character is \\xFF, and a UV is a quad. Otherwise it is 6 bytes or less.\n```\n\nThe final resting place of this bug is https://rt.perl.org/Public/Bug/Display.html?id=129024 where you can see this mentioned as a security fix for maintenance release 5.22.4/5.24.2. ","vulnerability_information_html":"\u003cp\u003eReported to the Perl security mailing list on 20 August 2016, reported fixed by \u003ccode\u003ekhw\u003c/code\u003e on 30 August 2016. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e==14086==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900000a4aa at pc 0x000000b9988f bp 0x7fff325d9630 sp 0x7fff325d9628\nREAD of size 1 at 0x61900000a4aa thread T0\n    #0 0xb9988e in S_regmatch /root/perl/regexec.c:6057:24\n    #1 0xb691ec in S_regtry /root/perl/regexec.c:3619:14\n    #2 0xb5323c in S_find_byclass /root/perl/regexec.c:2357:9\n    #3 0xb41439 in Perl_regexec_flags /root/perl/regexec.c:3368:13\n    #4 0xa36982 in Perl_pp_substcont /root/perl/pp_ctl.c:225:18\n    #5 0x7f1b53 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #6 0x5a0ff6 in S_run_body /root/perl/perl.c:2524:2\n    #7 0x5a0ff6 in perl_run /root/perl/perl.c:2447\n    #8 0x4de68d in main /root/perl/perlmain.c:123:9\n    #9 0x7fdb3ea25b44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #10 0x4de2fc in _start (/root/perl/perl+0x4de2fc)\n\n0x61900000a4aa is located 2 bytes to the right of 1064-byte region [0x61900000a080,0x61900000a4a8)\nallocated by thread T0 here:\n    #0 0x4c0c7b in malloc (/root/perl/perl+0x4c0c7b)\n    #1 0x7f5997 in Perl_safesysmalloc /root/perl/util.c:153:21\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/perl/regexec.c:6057 S_regmatch\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn some circumstances, this will just cause a crash (denial of service), in other circumstances, it could read outside of the buffer by up to 12 bytes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThat means the maximum it can extend beyond the string is 12 bytes, if the character is \\xFF, and a UV is a quad. Otherwise it is 6 bytes or less.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe final resting place of this bug is \u003ca title=\"https://rt.perl.org/Public/Bug/Display.html?id=129024\" href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FPublic%2FBug%2FDisplay.html%3Fid%3D129024\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rt.perl.org/Public/Bug/Display.html?id=129024\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e where you can see this mentioned as a security fix for maintenance release 5.22.4/5.24.2. \u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-25T22:47:48.387Z","allow_singular_disclosure_after":-110786883.07962929,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","geeknik","apapedulimu","sumit7","spetr0x","mrr3boot","beachglass"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1698162,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:37:38.790Z","updated_at":"2018-02-28T13:11:07.986Z","additional_data":{"added_weaknesses":[{"id":5,"name":"Heap Overflow"}],"removed_weaknesses":[{"id":2,"name":"Memory Corruption - Generic"}]},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698164,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:37:43.812Z","updated_at":"2017-05-24T16:37:43.812Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":27073,"new_severity_id":44593},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698165,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:37:50.114Z","updated_at":"2017-05-24T16:37:50.114Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698167,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T16:37:58.495Z","updated_at":"2017-05-24T16:37:58.495Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-perl","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704515,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T22:47:48.360Z","updated_at":"2017-05-26T22:47:48.360Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1706388,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-28T19:23:59.329Z","updated_at":"2017-05-28T19:23:59.329Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1706389,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-28T19:23:59.409Z","updated_at":"2017-05-28T19:23:59.409Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}