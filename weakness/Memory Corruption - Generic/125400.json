{"id":125400,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU0MDA=","url":"https://hackerone.com/reports/125400","title":"Too many included lookups","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-23T13:34:00.248Z","submitted_at":"2016-03-23T13:34:00.248Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"trabajoduro_2","url":"/trabajoduro_2","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-02T23:42:42.858Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-05-02T20:17:05.336Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Your SPF record required more than 10 DNS Lookups to be performed during the test. The number of \"include\" mechanisms and chained \"redirect' modifiers should be kept to a minimum.\n\nAccording to RFC 4408, 'SPF implementations MUST limit the number of mechanisms and modifiers that do DNS Lookups to at most 10 per SPF check, including any lookups caused by the use of the \"include\" mechanism or the \"redirect\" modifier\"'.  The mechanisms of: \"include\", \"mx\", \"a\", \"ptr\", and \"exists\"  count against the limit of 10 lookups. The \"all, \"ip4\", and \"ip6\" mechanisms do not count against the limit of 10 since they do not require a DNS Lookup.\n\nSPF implementations should be restrict the number of DNS Lookups to 10 per check in order to explicitly limit how much data will be accepted to:\n\nPrevent excessive bandwidth usage or memory usage\nPrevent DoS attacks\nIf you use the \"include\" in your SPF record, it will have referenced SPF records evaluated with your SPF record and as a direct result the DNS Lookup count is dependent upon third parties. If you are close to reaching your limit of 10 DNS Lookups and someone in your \"include\" adds additional DNS record to their own SPF record, you could easily go over your limit of 10.\n\nHow can you fix this?\nPrune unnecessary :include files from the SPF record.\nUse different domains for mail from different places so you don’t need one SPF record to rule them all.\nDon’t publish SPF records, rely on DKIM for authentication. Even Hotmail is checking DKIM these days.","vulnerability_information_html":"\u003cp\u003eYour SPF record required more than 10 DNS Lookups to be performed during the test. The number of \u0026quot;include\u0026quot; mechanisms and chained \u0026quot;redirect\u0026#39; modifiers should be kept to a minimum.\u003c/p\u003e\n\n\u003cp\u003eAccording to RFC 4408, \u0026#39;SPF implementations MUST limit the number of mechanisms and modifiers that do DNS Lookups to at most 10 per SPF check, including any lookups caused by the use of the \u0026quot;include\u0026quot; mechanism or the \u0026quot;redirect\u0026quot; modifier\u0026quot;\u0026#39;.  The mechanisms of: \u0026quot;include\u0026quot;, \u0026quot;mx\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;ptr\u0026quot;, and \u0026quot;exists\u0026quot;  count against the limit of 10 lookups. The \u0026quot;all, \u0026quot;ip4\u0026quot;, and \u0026quot;ip6\u0026quot; mechanisms do not count against the limit of 10 since they do not require a DNS Lookup.\u003c/p\u003e\n\n\u003cp\u003eSPF implementations should be restrict the number of DNS Lookups to 10 per check in order to explicitly limit how much data will be accepted to:\u003c/p\u003e\n\n\u003cp\u003ePrevent excessive bandwidth usage or memory usage\u003cbr\u003e\nPrevent DoS attacks\u003cbr\u003e\nIf you use the \u0026quot;include\u0026quot; in your SPF record, it will have referenced SPF records evaluated with your SPF record and as a direct result the DNS Lookup count is dependent upon third parties. If you are close to reaching your limit of 10 DNS Lookups and someone in your \u0026quot;include\u0026quot; adds additional DNS record to their own SPF record, you could easily go over your limit of 10.\u003c/p\u003e\n\n\u003cp\u003eHow can you fix this?\u003cbr\u003e\nPrune unnecessary :include files from the SPF record.\u003cbr\u003e\nUse different domains for mail from different places so you don’t need one SPF record to rule them all.\u003cbr\u003e\nDon’t publish SPF records, rely on DKIM for authentication. Even Hotmail is checking DKIM these days.\u003c/p\u003e\n","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-01T20:17:05.404Z","allow_singular_disclosure_after":-144403524.1547052,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":865742,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thank you for your report of an SPF, DKIM, DMARC or other anti spam email configuration issue.\n\nWe are currently working on improving how New Relic sends email. As part of this work, we are actively investigating our SPF configuration and researching whether we can configure our SPF policy to be more strict . We will provide updates as available. \n\nWe don't consider these email related issues vulnerabilities, but they are certainly best practices - correspondingly, we're closing this report as Informative. ","markdown_message":"\u003cp\u003eThank you for your report of an SPF, DKIM, DMARC or other anti spam email configuration issue.\u003c/p\u003e\n\n\u003cp\u003eWe are currently working on improving how New Relic sends email. As part of this work, we are actively investigating our SPF configuration and researching whether we can configure our SPF policy to be more strict . We will provide updates as available. \u003c/p\u003e\n\n\u003cp\u003eWe don\u0026#39;t consider these email related issues vulnerabilities, but they are certainly best practices - correspondingly, we\u0026#39;re closing this report as Informative. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T20:28:10.094Z","updated_at":"2016-03-23T20:28:10.094Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":931498,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"disclosure ?","markdown_message":"\u003cp\u003edisclosure ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T07:02:22.614Z","updated_at":"2016-04-28T07:02:22.614Z","actor":{"username":"trabajoduro_2","cleared":false,"url":"/trabajoduro_2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":932214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, we're open to that if you want to request it :) ","markdown_message":"\u003cp\u003eSure, we\u0026#39;re open to that if you want to request it :) \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T16:54:00.603Z","updated_at":"2016-04-28T16:54:00.603Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":933078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please disclose it :)","markdown_message":"\u003cp\u003ePlease disclose it :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-29T06:00:54.186Z","updated_at":"2016-04-29T06:00:54.186Z","actor":{"username":"trabajoduro_2","cleared":false,"url":"/trabajoduro_2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-02T20:17:05.366Z","updated_at":"2016-05-02T20:17:05.366Z","first_to_agree":true,"actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@trabajoduro_2 you need to request disclosure as well, I believe. ","markdown_message":"\u003cp\u003e\u003ca href=\"/trabajoduro_2\"\u003e@trabajoduro_2\u003c/a\u003e you need to request disclosure as well, I believe. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T23:42:17.417Z","updated_at":"2016-05-02T23:42:17.417Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937658,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Ah no, we can disclose - doing so. ","markdown_message":"\u003cp\u003eAh no, we can disclose - doing so. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T23:42:42.824Z","updated_at":"2016-05-02T23:42:42.824Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":958855,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I request you to disclose from my end :)","markdown_message":"\u003cp\u003eI request you to disclose from my end :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T10:41:56.368Z","updated_at":"2016-05-16T10:41:56.368Z","actor":{"username":"trabajoduro_2","cleared":false,"url":"/trabajoduro_2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2224339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you please disclose the issue","markdown_message":"\u003cp\u003eCould you please disclose the issue\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-14T22:24:24.612Z","updated_at":"2017-12-14T22:24:24.612Z","actor":{"username":"trabajoduro_2","cleared":false,"url":"/trabajoduro_2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}