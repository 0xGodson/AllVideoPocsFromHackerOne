{"id":126598,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjY1OTg=","url":"https://hackerone.com/reports/126598","title":"Overreads/overcopies in torsocks","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-28T22:31:30.976Z","submitted_at":"2016-03-28T22:31:30.976Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"guido","url":"/guido","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-19T10:14:57.678Z","bug_reporter_agreed_on_going_public_at":"2017-10-19T10:14:57.622Z","team_member_agreed_on_going_public_at":"2017-10-19T09:41:06.532Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"First off, I know torsocks isn't in scope, so I don't expect anything in return for this. I happened to stumble upon this so why not report it. However if you feel generous you're welcome to give me bounty/swag ofcourse :P.\n\nHere 16 bytes instead of 4 are copied, thereby copying 12 bytes of non-relevant stack memory.\n\n```c\n 62 LIBC_GETHOSTBYNAME_RET_TYPE tsocks_gethostbyname(LIBC_GETHOSTBYNAME_SIG)\n 63 {\n 64     int ret;\n 65     uint32_t ip;\n ...\n 86     memcpy(tsocks_he_addr, \u0026ip, sizeof(tsocks_he_addr));\n```\n\nHere 255 bytes (```sizeof(tsocks_he_name)```) are copied even if the resolved hostname is much smaller (say 20 bytes). Thus a overread/overcopy of hundreds of bytes occurs.\n\n```c\n151 LIBC_GETHOSTBYADDR_RET_TYPE tsocks_gethostbyaddr(LIBC_GETHOSTBYADDR_SIG)\n152 {\n153     int ret;\n154     char *hostname;\n...\n173     ret = tsocks_tor_resolve_ptr(addr, \u0026hostname, type);\n...\n184         memcpy(tsocks_he_name, hostname, sizeof(tsocks_he_name));\n```\n\n```hostname``` is set via this path:\n\n```tsocks_gethostbyaddr``` calls ```tsocks_tor_resolve_ptr```\n```tsocks_tor_resolve_ptr``` calls ```socks5_recv_resolve_ptr_reply```\n\nin (```lib/torsocks.c```)\n```c\n641     /* Force IPv4 resolution for now. */\n642     ret = socks5_recv_resolve_ptr_reply(\u0026conn, ip);\n643     if (ret \u003c 0) {\n644         goto end_close;\n645     }\n```\n\n(```socks5_recv_resolve_ptr_reply```, in ```common/socks5.c```)\n```c\n784 ATTR_HIDDEN                                                          \n785 int socks5_recv_resolve_ptr_reply(struct connection *conn, char **_hostname)                                                                   \n786 {\n787     int ret;\n788     ssize_t ret_recv;\n789     char *hostname = NULL;\n...\n799     ret_recv = recv_data(conn-\u003efd, \u0026buffer, sizeof(buffer));\n...\n817     if (buffer.msg.atyp == SOCKS5_ATYP_DOMAIN) {\n818         /* Allocate hostname len plus an extra for the null byte. */\n819         hostname = zmalloc(buffer.len + 1);\n820         if (!hostname) {\n821             ret = -ENOMEM;\n822             goto error;\n823         }\n824         ret_recv = recv_data(conn-\u003efd, hostname, buffer.len);\n825         if (ret_recv \u003c 0) {\n826             ret = ret_recv;\n827             goto error;\n828         }\n829         hostname[buffer.len] = '\\0';\n830     } else {\n```\n\nAlso, if recv_data() puts over 255 bytes in 'buffer', say 300 bytes, then line 829 becomes:\n\n```c\n829         hostname[300] = '\\0';\n```\n\nand consequently ```tsocks_gethostbyaddr``` puts a string of 300 bytes in h_addr_list:\n\n```c\n184         memcpy(tsocks_he_name, hostname, sizeof(tsocks_he_name));\n185         free(hostname);\n186         tsocks_he_addr_list[0] = (char *) addr;\n187     }\n188 \n189     tsocks_he.h_name = tsocks_he_name;\n190     tsocks_he.h_aliases = NULL;                                                                                                                \n191     tsocks_he.h_length = strlen(tsocks_he_name);\n192     tsocks_he.h_addrtype = type;\n193     tsocks_he.h_addr_list = tsocks_he_addr_list;\n```\n\nIf the application using this library things that it is guaranteed that the strings in h_addr_list are never more than 255 bytes, an overflow in the \"parent\" application might occur. But honestly I haven't tested whether any of this could actually occur.\n\nAlthough I think there isn't a *direct* security risk in the overreads/overcopies, it could lead to crashes, and moreover, their existence makes it easier to secretly implement backdoors in applications that use torsocks as a wrapper (they could introduce code that looks like a regular programming error but in fact exploit the fact that torsocks writes non-relevant heap/stack memory in order to aid an attacker with ASLR circumvention, for example), if you get my drift.\n\nGuido\n","vulnerability_information_html":"\u003cp\u003eFirst off, I know torsocks isn\u0026#39;t in scope, so I don\u0026#39;t expect anything in return for this. I happened to stumble upon this so why not report it. However if you feel generous you\u0026#39;re welcome to give me bounty/swag ofcourse :P.\u003c/p\u003e\n\n\u003cp\u003eHere 16 bytes instead of 4 are copied, thereby copying 12 bytes of non-relevant stack memory.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e \u003cspan class=\"mi\"\u003e62\u003c/span\u003e \u003cspan class=\"n\"\u003eLIBC_GETHOSTBYNAME_RET_TYPE\u003c/span\u003e \u003cspan class=\"n\"\u003etsocks_gethostbyname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLIBC_GETHOSTBYNAME_SIG\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n \u003cspan class=\"mi\"\u003e63\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n \u003cspan class=\"mi\"\u003e64\u003c/span\u003e     \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n \u003cspan class=\"mi\"\u003e65\u003c/span\u003e     \u003cspan class=\"kt\"\u003euint32_t\u003c/span\u003e \u003cspan class=\"n\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n \u003cspan class=\"mi\"\u003e86\u003c/span\u003e     \u003cspan class=\"n\"\u003ememcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_addr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_addr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere 255 bytes (\u003ccode\u003esizeof(tsocks_he_name)\u003c/code\u003e) are copied even if the resolved hostname is much smaller (say 20 bytes). Thus a overread/overcopy of hundreds of bytes occurs.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e151\u003c/span\u003e \u003cspan class=\"n\"\u003eLIBC_GETHOSTBYADDR_RET_TYPE\u003c/span\u003e \u003cspan class=\"n\"\u003etsocks_gethostbyaddr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLIBC_GETHOSTBYADDR_SIG\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e152\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e153\u003c/span\u003e     \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e154\u003c/span\u003e     \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e173\u003c/span\u003e     \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etsocks_tor_resolve_ptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaddr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e184\u003c/span\u003e         \u003cspan class=\"n\"\u003ememcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003ehostname\u003c/code\u003e is set via this path:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003etsocks_gethostbyaddr\u003c/code\u003e calls \u003ccode\u003etsocks_tor_resolve_ptr\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003etsocks_tor_resolve_ptr\u003c/code\u003e calls \u003ccode\u003esocks5_recv_resolve_ptr_reply\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ein (\u003ccode\u003elib/torsocks.c\u003c/code\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e641\u003c/span\u003e     \u003cspan class=\"cm\"\u003e/* Force IPv4 resolution for now. */\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e642\u003c/span\u003e     \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esocks5_recv_resolve_ptr_reply\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003econn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e643\u003c/span\u003e     \u003cspan class=\"nf\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e644\u003c/span\u003e         \u003cspan class=\"k\"\u003egoto\u003c/span\u003e \u003cspan class=\"n\"\u003eend_close\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e645\u003c/span\u003e     \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e(\u003ccode\u003esocks5_recv_resolve_ptr_reply\u003c/code\u003e, in \u003ccode\u003ecommon/socks5.c\u003c/code\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e784\u003c/span\u003e \u003cspan class=\"n\"\u003eATTR_HIDDEN\u003c/span\u003e                                                          \n\u003cspan class=\"mi\"\u003e785\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003esocks5_recv_resolve_ptr_reply\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"n\"\u003econnection\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003e_hostname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e                                                                   \n\u003cspan class=\"mi\"\u003e786\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e787\u003c/span\u003e     \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eret\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e788\u003c/span\u003e     \u003cspan class=\"kt\"\u003essize_t\u003c/span\u003e \u003cspan class=\"n\"\u003eret_recv\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e789\u003c/span\u003e     \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e799\u003c/span\u003e     \u003cspan class=\"n\"\u003eret_recv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erecv_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econn\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003efd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e817\u003c/span\u003e     \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eatyp\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eSOCKS5_ATYP_DOMAIN\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e818\u003c/span\u003e         \u003cspan class=\"cm\"\u003e/* Allocate hostname len plus an extra for the null byte. */\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e819\u003c/span\u003e         \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ezmalloc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e820\u003c/span\u003e         \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e821\u003c/span\u003e             \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eENOMEM\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e822\u003c/span\u003e             \u003cspan class=\"k\"\u003egoto\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e823\u003c/span\u003e         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e824\u003c/span\u003e         \u003cspan class=\"n\"\u003eret_recv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erecv_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econn\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003efd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e825\u003c/span\u003e         \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eret_recv\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e826\u003c/span\u003e             \u003cspan class=\"n\"\u003eret\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eret_recv\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e827\u003c/span\u003e             \u003cspan class=\"k\"\u003egoto\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e828\u003c/span\u003e         \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e829\u003c/span\u003e         \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;\\0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e830\u003c/span\u003e     \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAlso, if recv_data() puts over 255 bytes in \u0026#39;buffer\u0026#39;, say 300 bytes, then line 829 becomes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e829\u003c/span\u003e         \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e300\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;\\0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand consequently \u003ccode\u003etsocks_gethostbyaddr\u003c/code\u003e puts a string of 300 bytes in h_addr_list:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e184\u003c/span\u003e         \u003cspan class=\"nf\"\u003ememcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003esizeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e185\u003c/span\u003e         \u003cspan class=\"nf\"\u003efree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e186\u003c/span\u003e         \u003cspan class=\"n\"\u003etsocks_he_addr_list\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eaddr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e187\u003c/span\u003e     \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e188\u003c/span\u003e \n\u003cspan class=\"mi\"\u003e189\u003c/span\u003e     \u003cspan class=\"n\"\u003etsocks_he\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e190\u003c/span\u003e     \u003cspan class=\"n\"\u003etsocks_he\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh_aliases\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                                                                                                                \n\u003cspan class=\"mi\"\u003e191\u003c/span\u003e     \u003cspan class=\"n\"\u003etsocks_he\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estrlen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etsocks_he_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e192\u003c/span\u003e     \u003cspan class=\"n\"\u003etsocks_he\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh_addrtype\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e193\u003c/span\u003e     \u003cspan class=\"n\"\u003etsocks_he\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh_addr_list\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etsocks_he_addr_list\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the application using this library things that it is guaranteed that the strings in h_addr_list are never more than 255 bytes, an overflow in the \u0026quot;parent\u0026quot; application might occur. But honestly I haven\u0026#39;t tested whether any of this could actually occur.\u003c/p\u003e\n\n\u003cp\u003eAlthough I think there isn\u0026#39;t a \u003cem\u003edirect\u003c/em\u003e security risk in the overreads/overcopies, it could lead to crashes, and moreover, their existence makes it easier to secretly implement backdoors in applications that use torsocks as a wrapper (they could introduce code that looks like a regular programming error but in fact exploit the fact that torsocks writes non-relevant heap/stack memory in order to aid an attacker with ASLR circumvention, for example), if you get my drift.\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-18T09:41:06.607Z","allow_singular_disclosure_after":-98217721.43001293,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","geeknik","mr_r3boot","hisxo","spetr0x","b4155f7c29acd42c27d007a"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":901954,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks, and sorry that it took me so long to get back to you. Yes, torsocks is alas out of scope of our bug bounty program. We might add it later but for now it is just core Tor and Tor Browser. That said I've informed the torsocks main developer and he confirms these issues. I am leaving this bug here until it is properly fixed. We might even add links to the bugs in our own bug tracker for reference. Thanks again for this report it is really appreciated.","markdown_message":"\u003cp\u003eThanks, and sorry that it took me so long to get back to you. Yes, torsocks is alas out of scope of our bug bounty program. We might add it later but for now it is just core Tor and Tor Browser. That said I\u0026#39;ve informed the torsocks main developer and he confirms these issues. I am leaving this bug here until it is properly fixed. We might even add links to the bugs in our own bug tracker for reference. Thanks again for this report it is really appreciated.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:09:49.858Z","updated_at":"2016-04-12T19:09:49.858Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":902554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.\n\nAm I still the only one who has submitted a valid report to Tor? On the timeline ( https://hackerone.com/torproject ) I only see myself still, and that usually means I am the only valid reporter, but I was thinking that maybe you or HackerOne configured something so that I don't see the other reporters?\n\nGuido","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n\n\u003cp\u003eAm I still the only one who has submitted a valid report to Tor? On the timeline ( \u003ca title=\"https://hackerone.com/torproject\" href=\"https://hackerone.com/torproject\"\u003ehttps://hackerone.com/torproject\u003c/a\u003e ) I only see myself still, and that usually means I am the only valid reporter, but I was thinking that maybe you or HackerOne configured something so that I don\u0026#39;t see the other reporters?\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T23:21:54.381Z","updated_at":"2016-04-12T23:21:54.381Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":999565,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Has there been any progress in the resolution of this bug? I can create and submit a patch if that will help speed up the process.\n\nGuido","markdown_message":"\u003cp\u003eHas there been any progress in the resolution of this bug? I can create and submit a patch if that will help speed up the process.\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-04T09:40:25.563Z","updated_at":"2016-06-04T09:40:25.563Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1000909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Guido,\n\nDavid (the lead torsocks dev) told me that this bug is on his TODO list, but the list is quite deep.\n\nHe said that if you prepare a patch, that will greatly speed up progress here.  If you are up for this, feel free to attach the patch in this hackerone ticket here.\n\nThanks!","markdown_message":"\u003cp\u003eHello Guido,\u003c/p\u003e\n\n\u003cp\u003eDavid (the lead torsocks dev) told me that this bug is on his TODO list, but the list is quite deep.\u003c/p\u003e\n\n\u003cp\u003eHe said that if you prepare a patch, that will greatly speed up progress here.  If you are up for this, feel free to attach the patch in this hackerone ticket here.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-06T11:53:58.465Z","updated_at":"2016-06-06T11:53:58.465Z","actor":{"username":"asn","cleared":false,"url":"/asn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1003998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are patches for the issues brought up in this report.\n\nI recommend that David carefully reviews the patches before applying them, of course.\n\nDo you appreciate that I submit reports for out-of-scope Tor software via HackerOne or do you prefer I do so by some other means?\n\nGuido\n\n","markdown_message":"\u003cp\u003eHere are patches for the issues brought up in this report.\u003c/p\u003e\n\n\u003cp\u003eI recommend that David carefully reviews the patches before applying them, of course.\u003c/p\u003e\n\n\u003cp\u003eDo you appreciate that I submit reports for out-of-scope Tor software via HackerOne or do you prefer I do so by some other means?\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-08T01:08:14.699Z","updated_at":"2016-06-08T01:08:14.699Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":98446,"filename":"0003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/098/446/855019145e6bd226734053a29e128e7c5e9c0747/0003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch?response-content-disposition=attachment%3B%20filename%3D%220003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch%22%3B%20filename%2A%3DUTF-8%27%270003-Ensure-length-of-hostname-doesn-t-exceed-255-bytes-i.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042308Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=a88911ba5221da645aadb30508e979814b56069cea0f8a4f012cc40266424a13"},{"id":98444,"filename":"0001-Remove-overcopy-in-tsocks_gethostbyname.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/098/444/9f3c927d5a2cebd6e354918f5469d078407ec5c6/0001-Remove-overcopy-in-tsocks_gethostbyname.patch?response-content-disposition=attachment%3B%20filename%3D%220001-Remove-overcopy-in-tsocks_gethostbyname.patch%22%3B%20filename%2A%3DUTF-8%27%270001-Remove-overcopy-in-tsocks_gethostbyname.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042308Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=b524ec014044765a3f0403ce1ebf2597d51922c3bfa3785b47a33f7dc8a2f815"},{"id":98445,"filename":"0002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/098/445/f40552e4a6a98ec5032bd9b634e8b089bc7d3be4/0002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch?response-content-disposition=attachment%3B%20filename%3D%220002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch%22%3B%20filename%2A%3DUTF-8%27%270002-Remove-potential-overcopy-in-tsocks_gethostbyaddr.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042308Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=7261e20b65abbc8ba809b8e2a4631bb3d422d83af3093e8ef5d05fe66ced71e5"}],"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1006474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello guido,\n\nthanks for the patches. I notified David and he said he is going to check them out.\n\nI think submitting reports for out-of-scope Tor software can be done through hackerone if that is convenient for you. Otherwise, feel free to open tickets in trac.torproject.org and CC the right people (or CC me and I will triage the ticket as needed).\n\nThanks!","markdown_message":"\u003cp\u003eHello guido,\u003c/p\u003e\n\n\u003cp\u003ethanks for the patches. I notified David and he said he is going to check them out.\u003c/p\u003e\n\n\u003cp\u003eI think submitting reports for out-of-scope Tor software can be done through hackerone if that is convenient for you. Otherwise, feel free to open tickets in trac.torproject.org and CC the right people (or CC me and I will triage the ticket as needed).\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-09T13:46:38.322Z","updated_at":"2016-06-09T13:46:38.322Z","actor":{"username":"asn","cleared":false,"url":"/asn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1143226,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guido,\n\nOk I finally fixed these issues. Epic delay but at least it will get in the next 2.2.0 stable.\n\nI've fixed both issues although second one, this `hostname[300] = '\\0';` can't happen because `buffer.len` is a `uint8_t` thus 256 is the maximum value so at most `hostname` can be of size `257` because of `hostname = zmalloc(buffer.len + 1);` making the memcpy go up to 256 bytes. I've changed that to a strncpy() here.\n\nNonetheless, I've fixed those issues. Huge thanks! See commit `23651bc` and `34b1f1c`. Please let me know if I fucked up :).","markdown_message":"\u003cp\u003eHi guido,\u003c/p\u003e\n\n\u003cp\u003eOk I finally fixed these issues. Epic delay but at least it will get in the next 2.2.0 stable.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve fixed both issues although second one, this \u003ccode\u003ehostname[300] = \u0026#39;\\0\u0026#39;;\u003c/code\u003e can\u0026#39;t happen because \u003ccode\u003ebuffer.len\u003c/code\u003e is a \u003ccode\u003euint8_t\u003c/code\u003e thus 256 is the maximum value so at most \u003ccode\u003ehostname\u003c/code\u003e can be of size \u003ccode\u003e257\u003c/code\u003e because of \u003ccode\u003ehostname = zmalloc(buffer.len + 1);\u003c/code\u003e making the memcpy go up to 256 bytes. I\u0026#39;ve changed that to a strncpy() here.\u003c/p\u003e\n\n\u003cp\u003eNonetheless, I\u0026#39;ve fixed those issues. Huge thanks! See commit \u003ccode\u003e23651bc\u003c/code\u003e and \u003ccode\u003e34b1f1c\u003c/code\u003e. Please let me know if I fucked up :).\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-21T15:14:28.950Z","updated_at":"2016-08-21T15:14:28.950Z","actor":{"username":"dgoulet","cleared":false,"url":"/dgoulet","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/294/164843aa48b0aebb2236ed876d0b98670e41affa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1143227,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-21T15:14:37.686Z","updated_at":"2016-08-21T15:14:37.686Z","actor":{"username":"dgoulet","cleared":false,"url":"/dgoulet","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/294/164843aa48b0aebb2236ed876d0b98670e41affa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"guido","url":"/guido"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1604388,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"Thanks for the bug report Guido! \n\nSeems like we forgot this one open. I'm closing it for good :)","markdown_message":"\u003cp\u003eThanks for the bug report Guido! \u003c/p\u003e\n\n\u003cp\u003eSeems like we forgot this one open. I\u0026#39;m closing it for good :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T10:09:30.727Z","updated_at":"2017-04-11T10:09:30.727Z","actor":{"url":"/torproject","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Tor"}},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1604389,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-11T10:09:52.635Z","updated_at":"2017-04-11T10:09:52.635Z","actor":{"url":"/torproject","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Tor"}},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083679,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T09:41:06.567Z","updated_at":"2017-10-19T09:41:06.567Z","first_to_agree":true,"actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083730,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T10:14:57.644Z","updated_at":"2017-10-19T10:14:57.644Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2083731,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T10:14:57.705Z","updated_at":"2017-10-19T10:14:57.705Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}