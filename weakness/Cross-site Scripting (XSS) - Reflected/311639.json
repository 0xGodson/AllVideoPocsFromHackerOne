{"id":311639,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTE2Mzk=","url":"https://hackerone.com/reports/311639","title":"Reflected XSS on https://www.zomato.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-02T12:39:58.735Z","submitted_at":"2018-02-02T12:39:58.735Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"strukt","url":"/strukt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-07T07:07:31.208Z","bug_reporter_agreed_on_going_public_at":"2018-03-08T07:07:26.018Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI found an XSS issue due to the incorrect handling of the \\ character in a \u003cscript\u003e context, the following link works as a PoC that alerts the location of the document:\n\nhttps://www.zomato.com/googleOAuth2Callback?)}(alert)(location);{%3C!--\u0026state=\\\n\nThe issue exists because, given that the \\ character supplied as the `state` parameter value is not well escaped and reflected into the page, we are able to use it to escape the \" and then inject our own JS code to execute it on the page.\n\nNote: This only works when the page is opened by an authenticated user\n\n## Impact\n\nThis allows an attacker to inject custom Javascript codes that can be used to steal information from Zomato's user base and lure them to malicious websites on the internet on behalf of Zomato's website.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI found an XSS issue due to the incorrect handling of the \\ character in a \u0026lt;script\u0026gt; context, the following link works as a PoC that alerts the location of the document:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.zomato.com/googleOAuth2Callback?)%7D(alert)(location)%3B%7B%3C!--\u0026amp;state=\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2FgoogleOAuth2Callback%3F%29%257D%28alert%29%28location%29%253B%257B%253C%21--%26state%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/googleOAuth2Callback?)%7D(alert)(location)%3B%7B%3C!--\u0026amp;state=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe issue exists because, given that the \\ character supplied as the \u003ccode\u003estate\u003c/code\u003e parameter value is not well escaped and reflected into the page, we are able to use it to escape the \u0026quot; and then inject our own JS code to execute it on the page.\u003c/p\u003e\n\n\u003cp\u003eNote: This only works when the page is opened by an authenticated user\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis allows an attacker to inject custom Javascript codes that can be used to steal information from Zomato\u0026#39;s user base and lure them to malicious websites on the internet on behalf of Zomato\u0026#39;s website.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-07T07:07:26.114Z","allow_singular_disclosure_after":-86135084.57386404,"singular_disclosure_allowed":true,"vote_count":14,"voters":["sp1d3rs","muon4","sameerphad72","asad0x01_","eveeez","apapedulimu","japz","666reda","scraps","0619","and 4 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2347740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I apologize, HackerOne normalize URLs in weird ways, here's the correct URL:\n\n`https://www.zomato.com/googleOAuth2Callback?)%7D(alert)(location);%7B%3C!--\u0026state=\\`","markdown_message":"\u003cp\u003eI apologize, HackerOne normalize URLs in weird ways, here\u0026#39;s the correct URL:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.zomato.com/googleOAuth2Callback?)%7D(alert)(location);%7B%3C!--\u0026amp;state=\\\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-03T11:45:41.921Z","updated_at":"2018-02-03T11:45:41.921Z","actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2347750,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\n\nRegards.\n@joystick","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003cbr\u003e\n\u003ca href=\"/joystick\"\u003e@joystick\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-03T11:52:56.284Z","updated_at":"2018-02-03T11:52:56.284Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2347753,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-03T11:54:10.132Z","updated_at":"2018-02-03T11:54:10.132Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.4)","old_severity_id":114590,"new_severity_id":114898},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2414162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@joystick Any news here ?","markdown_message":"\u003cp\u003e\u003ca href=\"/joystick\"\u003e@joystick\u003c/a\u003e Any news here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T07:14:21.720Z","updated_at":"2018-02-22T07:14:21.720Z","actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2459570,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T15:38:59.654Z","updated_at":"2018-03-05T15:38:59.654Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2467703,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-07T07:55:42.998Z","updated_at":"2018-03-07T07:55:42.998Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2470175,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vinothzomato any news about the bounty ?","markdown_message":"\u003cp\u003e\u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e any news about the bounty ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-07T14:24:20.320Z","updated_at":"2018-03-07T14:24:20.320Z","actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2472254,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T06:44:58.019Z","updated_at":"2018-03-08T06:44:58.019Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"strukt","url":"/strukt"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2472293,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T07:07:26.062Z","updated_at":"2018-03-08T07:07:26.062Z","first_to_agree":true,"actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2575506,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-07T07:07:31.236Z","updated_at":"2018-04-07T07:07:31.236Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}