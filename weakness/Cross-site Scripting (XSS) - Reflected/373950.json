{"id":373950,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzM5NTA=","url":"https://hackerone.com/reports/373950","title":"Reflected Cross-Site Scripting in Serendipity (serendipity.SetCookie)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-29T16:09:17.875Z","submitted_at":"2018-06-29T16:09:17.875Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"oreamnos","url":"/oreamnos","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30278,"url":"https://hackerone.com/hannob","handle":"hannob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Hanno's projects","twitter_handle":"hanno","website":"https://hboeck.de/","about":"Personal web projects from Hanno Böck."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-09T14:44:43.029Z","bug_reporter_agreed_on_going_public_at":"2018-11-09T14:44:42.968Z","team_member_agreed_on_going_public_at":"2018-11-09T14:36:35.628Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nThe *Smarty* template responsible of creating *JavaScript* snippets assigning cookies to users is during sorting of entries in the administration interface is affected by a reflected cross-site scripting.\n\n## Description\n\nIn `templates/2k11/admin/entries.inc.tpl`, the following code is dynamically creating a *JavaScript* snippet consisting of calls to `serendipity.SetCookie()`:\n\n```html\n    \u003cscript\u003e\n        $(document).ready(function() {\n    {foreach $filter_import AS $f_import}\n        serendipity.SetCookie(\"entrylist_filter_{$f_import}\", \"{$get_filter_{$f_import}}\" )\n    {/foreach}\n    {foreach $sort_import AS $s_import}\n        serendipity.SetCookie(\"entrylist_sort_{$s_import}\", \"{$get_sort_{$s_import}}\" )\n    {/foreach}\n        });\n    \u003c/script\u003e\n```\n\nHowever, *Smarty* is not aware of the context is is not told to escape it as `javascript` (https://www.smarty.net/docsv2/en/language.modifier.escape) and no prior encoding is performed on data injected in the template (see `include/admin/entries.inc.php:216`):\n\n```php\n\u003c?php\n// [...]\ncase 'editSelect':\n        $data['switched_output'] = false;\n        $filter_import = array('author', 'category', 'isdraft');\n        $sort_import   = array('perPage', 'ordermode', 'order');\n\n        foreach($filter_import AS $f_import) {\n            serendipity_restoreVar($serendipity['COOKIE']['entrylist_filter_' . $f_import], $serendipity['GET']['filter'][$f_import]);\n            $data[\"get_filter_$f_import\"] = $serendipity['GET']['filter'][$f_import];\n        }\n\n        foreach($sort_import AS $s_import) {\n            serendipity_restoreVar($serendipity['COOKIE']['entrylist_sort_' . $s_import], $serendipity['GET']['sort'][$s_import]);\n            $data[\"get_sort_$s_import\"] = $serendipity['GET']['sort'][$s_import];\n        }\n```\n\nFor the record, the function `serendipity_JSsetCookie` is also vulnerable, but it's not in use in this version:\n```php\n\u003c?php\n// [...]\nfunction serendipity_JSsetCookie($name, $value) {\n    $name  = serendipity_entities($name);\n    $value = urlencode($value);\n\n    echo '\u003cscript type=\"text/javascript\"\u003eserendipity.SetCookie(\"' . $name . '\", unescape(\"' . $value . '\"))\u003c/script\u003e' . \"\\n\";\n}\n```\n\n## Steps To Reproduce\n\n  1. Access https://blog.fuzzing-project.org/serendipity_admin.php?serendipity[action]=admin\u0026serendipity[adminModule]=entries\u0026serendipity[adminAction]=editSelect\u0026serendipity[filter][author]=1xx\");alert(document.domain);// while being authenticated;\n  1. Notice the execution of `alert(document.domain)` within the context of  `blog.fuzzing-project.org`.\n\n## Impact\n\nBy accessing a link specially crafted by an attacker and exploiting this vulnerability, an authenticated victim could be forced to perform actions on its behalf on the domain blog.fuzzing-project.org. If the victim is authenticated as administrator, it could be used to compromise the website or the underlying server (through the installation of `serendipity_plugin_externalphp`).","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003e Summary\u003c/h2\u003e\n\n\u003cp\u003eThe \u003cem\u003eSmarty\u003c/em\u003e template responsible of creating \u003cem\u003eJavaScript\u003c/em\u003e snippets assigning cookies to users is during sorting of entries in the administration interface is affected by a reflected cross-site scripting.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eIn \u003ccode\u003etemplates/2k11/admin/entries.inc.tpl\u003c/code\u003e, the following code is dynamically creating a \u003cem\u003eJavaScript\u003c/em\u003e snippet consisting of calls to \u003ccode\u003eserendipity.SetCookie()\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eready\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eforeach\u003c/span\u003e \u003cspan class=\"nx\"\u003e$filter_import\u003c/span\u003e \u003cspan class=\"nx\"\u003eAS\u003c/span\u003e \u003cspan class=\"nx\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eserendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSetCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eentrylist_filter_{$f_import}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e{$get_filter_{$f_import}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"sr\"\u003e/foreach\u003c/span\u003e\u003cspan class=\"err\"\u003e}\n\u003c/span\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eforeach\u003c/span\u003e \u003cspan class=\"nx\"\u003e$sort_import\u003c/span\u003e \u003cspan class=\"nx\"\u003eAS\u003c/span\u003e \u003cspan class=\"nx\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eserendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSetCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eentrylist_sort_{$s_import}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e{$get_sort_{$s_import}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"sr\"\u003e/foreach\u003c/span\u003e\u003cspan class=\"err\"\u003e}\n\u003c/span\u003e        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, \u003cem\u003eSmarty\u003c/em\u003e is not aware of the context is is not told to escape it as \u003ccode\u003ejavascript\u003c/code\u003e (\u003ca title=\"https://www.smarty.net/docsv2/en/language.modifier.escape\" href=\"/redirect?url=https%3A%2F%2Fwww.smarty.net%2Fdocsv2%2Fen%2Flanguage.modifier.escape\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.smarty.net/docsv2/en/language.modifier.escape\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and no prior encoding is performed on data injected in the template (see \u003ccode\u003einclude/admin/entries.inc.php:216\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// [...]\u003c/span\u003e\n\u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;editSelect\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;switched_output\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"nv\"\u003e$filter_import\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;author\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;category\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;isdraft\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nv\"\u003e$sort_import\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;perPage\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ordermode\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;order\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$filter_import\u003c/span\u003e \u003cspan class=\"nx\"\u003eAS\u003c/span\u003e \u003cspan class=\"nv\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003eserendipity_restoreVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;COOKIE\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;entrylist_filter_\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;filter\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"nv\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;get_filter_\u003c/span\u003e\u003cspan class=\"nv\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;filter\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"nv\"\u003e$f_import\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sort_import\u003c/span\u003e \u003cspan class=\"nx\"\u003eAS\u003c/span\u003e \u003cspan class=\"nv\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003eserendipity_restoreVar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;COOKIE\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;entrylist_sort_\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;sort\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n            \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;get_sort_\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;sort\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s_import\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor the record, the function \u003ccode\u003eserendipity_JSsetCookie\u003c/code\u003e is also vulnerable, but it\u0026#39;s not in use in this version:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// [...]\u003c/span\u003e\n\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eserendipity_JSsetCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$value\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eserendipity_entities\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nv\"\u003e$value\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eurlencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$value\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt;serendipity.SetCookie(\u0026quot;\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026quot;, unescape(\u0026quot;\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$value\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026quot;))\u0026lt;/script\u0026gt;\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAccess \u003ca title=\"https://blog.fuzzing-project.org/serendipity_admin.php?serendipity%5Baction%5D=admin\u0026amp;serendipity%5BadminModule%5D=entries\u0026amp;serendipity%5BadminAction%5D=editSelect\u0026amp;serendipity%5Bfilter%5D%5Bauthor%5D=1xx%22)%3Balert(document.domain)%3B//\" href=\"/redirect?url=https%3A%2F%2Fblog.fuzzing-project.org%2Fserendipity_admin.php%3Fserendipity%255Baction%255D%3Dadmin%26serendipity%255BadminModule%255D%3Dentries%26serendipity%255BadminAction%255D%3DeditSelect%26serendipity%255Bfilter%255D%255Bauthor%255D%3D1xx%2522%29%253Balert%28document.domain%29%253B%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.fuzzing-project.org/serendipity_admin.php?serendipity%5Baction%5D=admin\u0026amp;serendipity%5BadminModule%5D=entries\u0026amp;serendipity%5BadminAction%5D=editSelect\u0026amp;serendipity%5Bfilter%5D%5Bauthor%5D=1xx%22)%3Balert(document.domain)%3B//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e while being authenticated;\u003c/li\u003e\n\u003cli\u003eNotice the execution of \u003ccode\u003ealert(document.domain)\u003c/code\u003e within the context of  \u003ccode\u003eblog.fuzzing-project.org\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy accessing a link specially crafted by an attacker and exploiting this vulnerability, an authenticated victim could be forced to perform actions on its behalf on the domain blog.fuzzing-project.org. If the victim is authenticated as administrator, it could be used to compromise the website or the underlying server (through the installation of \u003ccode\u003eserendipity_plugin_externalphp\u003c/code\u003e).\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-09T14:36:35.696Z","allow_singular_disclosure_after":-64854533.45611605,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","geeknik","billal5625"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":11140,"asset_type":"URL","asset_identifier":"*.fuzzing-project.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2968279,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I can confirm this, I'm forwarding this to the serendipity developers.\n\nI'm unsure about serendipity_JSsetCookie, from what I can see this is problematic if the first parameter is unescaped. I found a use of that function in the staticpage plugin, but the first param is a fixed string, so it looks harmless.","markdown_message":"\u003cp\u003eI can confirm this, I\u0026#39;m forwarding this to the serendipity developers.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m unsure about serendipity_JSsetCookie, from what I can see this is problematic if the first parameter is unescaped. I found a use of that function in the staticpage plugin, but the first param is a fixed string, so it looks harmless.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T10:02:32.338Z","updated_at":"2018-07-01T10:02:32.338Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2968321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Preliminary patch, also sent to s9y devs. I believe it's likely that similar issues exist, but a review of the templates would be a lot of work.","markdown_message":"\u003cp\u003ePreliminary patch, also sent to s9y devs. I believe it\u0026#39;s likely that similar issues exist, but a review of the templates would be a lot of work.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T10:35:30.387Z","updated_at":"2018-07-01T10:35:30.387Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":314223,"filename":"H1S9Y-XSS-1.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/223/a7b95cbfe9cb3c041d967b082aa40ac39d5d5387/H1S9Y-XSS-1.diff?response-content-disposition=attachment%3B%20filename%3D%22H1S9Y-XSS-1.diff%22%3B%20filename%2A%3DUTF-8%27%27H1S9Y-XSS-1.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054529Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=8848fd237beeff40a5e63c6b4e8894f3bf85a3c123186cd85642a82f1aa337c5"}],"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3063065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is now fixed with a patch I got from s9y's dev (as should be all other open issues).\nI'd appreciate if you could check that and also look for further issues, s9y will soon release a security update.","markdown_message":"\u003cp\u003eThis is now fixed with a patch I got from s9y\u0026#39;s dev (as should be all other open issues).\u003cbr\u003e\nI\u0026#39;d appreciate if you could check that and also look for further issues, s9y will soon release a security update.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T17:37:14.559Z","updated_at":"2018-07-18T17:37:14.559Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3063179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The fix (https://github.com/s9y/Serendipity/commit/19513cdf143ef5659f8afbfb3b16df921060d550#diff-dc826483a3a52ca69c83cec2fb97ce8e) looks good to me.","markdown_message":"\u003cp\u003eThe fix (\u003ca title=\"https://github.com/s9y/Serendipity/commit/19513cdf143ef5659f8afbfb3b16df921060d550#diff-dc826483a3a52ca69c83cec2fb97ce8e\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fs9y%2FSerendipity%2Fcommit%2F19513cdf143ef5659f8afbfb3b16df921060d550%23diff-dc826483a3a52ca69c83cec2fb97ce8e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/s9y/Serendipity/commit/19513cdf143ef5659f8afbfb3b16df921060d550#diff-dc826483a3a52ca69c83cec2fb97ce8e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) looks good to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T17:59:36.619Z","updated_at":"2018-07-18T17:59:36.619Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3203958,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fix released:\nhttp://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\n\nFix is not mentioned in release notes, but it got committed.","markdown_message":"\u003cp\u003eFix released:\u003cbr\u003e\n\u003ca title=\"http://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\" href=\"/redirect?url=http%3A%2F%2Fblog.s9y.org%2Farchives%2F278-Serendipity-2.1.3-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFix is not mentioned in release notes, but it got committed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-16T13:33:49.622Z","updated_at":"2018-08-16T13:33:49.622Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"oreamnos","url":"/oreamnos"},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617244,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:36:35.663Z","updated_at":"2018-11-09T14:36:35.663Z","first_to_agree":true,"actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617262,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:44:42.995Z","updated_at":"2018-11-09T14:44:42.995Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3617263,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:44:43.050Z","updated_at":"2018-11-09T14:44:43.050Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}