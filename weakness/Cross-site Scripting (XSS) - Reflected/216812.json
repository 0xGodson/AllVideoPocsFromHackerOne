{"id":216812,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTY4MTI=","url":"https://hackerone.com/reports/216812","title":"Reflected XSS in error pages (NC-SA-2017-008)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-03-28T21:53:11.174Z","submitted_at":"2017-03-28T21:53:11.174Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sinkmanu","url":"/sinkmanu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-0891"],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-15T19:54:37.173Z","bug_reporter_agreed_on_going_public_at":"2017-05-15T19:54:37.115Z","team_member_agreed_on_going_public_at":"2017-05-08T12:20:05.358Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI found a HTML injection vulnerability [1] flaw in the Nextcloud (and Owncloud) latest version. Through this vulnerability an attacker could manipulate the website. This vulnerability could affect to the logged users. An attacker could send a malicious link (that contains the manipulated URL) to a legitimate user that he is logged in and simulate the login screen to stole the password (phishing), or multiple attacks more, like XSS.\n\nThe Nextcloud/Owncloud application contains multiple security headers of HTTP, so, inject scripts or redirect to another websites is difficult, the problem is that not all the browser supports these headers (fortunatelly, the most used browsers yes).\n\nExist more options to attack, for example, redirect the content of an \u003cobject\u003e or \u003cscript\u003e to a saved and shared items of your directory. Also, the mimetypes are well configured and the most browsers will not execute a javascript file that doesn't have the javascript content-type.\n\nAnyway, all the mitigations are well, but these aren't never-falling. So the solution to this vulnerability is sanitize the output before to deliver the HTML to the final user.\n\nAlso, another security flaw is showed, but the impact is less, it is a full path disclosure and it show the full path of the Nextcloud/Owncloud installation.\n\nPoC (Proof of Concept):\n\nhttps://nextcloud-site/index.php/apps/files/ajax/download.php?files=%00\u0026dir=\u003c/p\u003eHTMLCODE\n\nI tested it in the last version.\n\nIf you need more information, ask to me.\n\nRegards,\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI found a HTML injection vulnerability [1] flaw in the Nextcloud (and Owncloud) latest version. Through this vulnerability an attacker could manipulate the website. This vulnerability could affect to the logged users. An attacker could send a malicious link (that contains the manipulated URL) to a legitimate user that he is logged in and simulate the login screen to stole the password (phishing), or multiple attacks more, like XSS.\u003c/p\u003e\n\n\u003cp\u003eThe Nextcloud/Owncloud application contains multiple security headers of HTTP, so, inject scripts or redirect to another websites is difficult, the problem is that not all the browser supports these headers (fortunatelly, the most used browsers yes).\u003c/p\u003e\n\n\u003cp\u003eExist more options to attack, for example, redirect the content of an \u0026lt;object\u0026gt; or \u0026lt;script\u0026gt; to a saved and shared items of your directory. Also, the mimetypes are well configured and the most browsers will not execute a javascript file that doesn\u0026#39;t have the javascript content-type.\u003c/p\u003e\n\n\u003cp\u003eAnyway, all the mitigations are well, but these aren\u0026#39;t never-falling. So the solution to this vulnerability is sanitize the output before to deliver the HTML to the final user.\u003c/p\u003e\n\n\u003cp\u003eAlso, another security flaw is showed, but the impact is less, it is a full path disclosure and it show the full path of the Nextcloud/Owncloud installation.\u003c/p\u003e\n\n\u003cp\u003ePoC (Proof of Concept):\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://nextcloud-site/index.php/apps/files/ajax/download.php?files=%00\u0026amp;dir=\" href=\"/redirect?url=https%3A%2F%2Fnextcloud-site%2Findex.php%2Fapps%2Ffiles%2Fajax%2Fdownload.php%3Ffiles%3D%2500%26dir%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud-site/index.php/apps/files/ajax/download.php?files=%00\u0026amp;dir=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;/p\u0026gt;HTMLCODE\u003c/p\u003e\n\n\u003cp\u003eI tested it in the last version.\u003c/p\u003e\n\n\u003cp\u003eIf you need more information, ask to me.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","bounty_amount":"450.0","formatted_bounty":"$450","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-07T12:20:05.411Z","allow_singular_disclosure_after":-112379924.56588379,"singular_disclosure_allowed":true,"vote_count":26,"voters":["lukasreschke","sp1d3rs","secator","hunter","michiel","bl4de","flashdisk","supernatural","mpz","eveeez","and 16 more..."],"severity":{"rating":"low","score":3.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1569076,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-03-28T21:53:11.618Z","updated_at":"2017-03-28T21:53:11.618Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I reported this vulnerability to Owncloud 6 days ago, but nobody answer yet.","markdown_message":"\u003cp\u003eI reported this vulnerability to Owncloud 6 days ago, but nobody answer yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-28T21:54:18.549Z","updated_at":"2017-03-28T21:54:18.549Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569082,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. On the first look this looks like a valid report and we'll review this internally and get back to you.","markdown_message":"\u003cp\u003eThanks for your report. On the first look this looks like a valid report and we\u0026#39;ll review this internally and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-28T21:55:10.007Z","updated_at":"2017-03-28T21:55:10.007Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Lukas, could you update this issue? I checked the nextcloud repository and I look that you fixed the vulnerability. Also, How works the Owncloud security team, they didn't answer me yet and I don't see any update about that issue. ","markdown_message":"\u003cp\u003eHello Lukas, could you update this issue? I checked the nextcloud repository and I look that you fixed the vulnerability. Also, How works the Owncloud security team, they didn\u0026#39;t answer me yet and I don\u0026#39;t see any update about that issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T18:38:14.785Z","updated_at":"2017-04-04T18:38:14.785Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @sinkmanu \n\nWe're working on backporting this issue to all affected releases and include the patch in our releases planned for next week.\n\nWe'll publicly announce this issue usually within 2 weeks after our release and create a public advisory for this as well as request a CVE identifier. Once patches have been released we'll also mark this issue as resolved and award a bounty.\n\nTo speed the process up a bit, please let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n\nThanks for your patience!\nLukas","markdown_message":"\u003cp\u003eHey \u003ca href=\"/sinkmanu\"\u003e@sinkmanu\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re working on backporting this issue to all affected releases and include the patch in our releases planned for next week.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll publicly announce this issue usually within 2 weeks after our release and create a public advisory for this as well as request a CVE identifier. Once patches have been released we\u0026#39;ll also mark this issue as resolved and award a bounty.\u003c/p\u003e\n\n\u003cp\u003eTo speed the process up a bit, please let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks for your patience!\u003cbr\u003e\nLukas\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T18:43:16.565Z","updated_at":"2017-04-04T18:43:16.565Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great. Thank you for your a quick reply. \nYou can use my name Manuel Mancera and e.g. the website may be my twitter account (@sinkmanu). \n\nRegards,","markdown_message":"\u003cp\u003eGreat. Thank you for your a quick reply. \u003cbr\u003e\nYou can use my name Manuel Mancera and e.g. the website may be my twitter account (@sinkmanu). \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T19:04:55.977Z","updated_at":"2017-04-04T19:04:55.977Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1625850,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-21T09:55:17.299Z","updated_at":"2017-04-21T09:55:17.299Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"sinkmanu","url":"/sinkmanu"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1625864,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $450. This award considers the fact that this is blocked by CSP on most browsers. Thus limiting the exploitability hugely here. \n\nPlease keep in mind that we didn't patch the vulnerability yet, so please do not share this information with any third-parties. We're planning to release patched releases next Monday.","markdown_message":"\u003cp\u003eCongratulations! We have determined this to be eligible for a reward of $450. This award considers the fact that this is blocked by CSP on most browsers. Thus limiting the exploitability hugely here. \u003c/p\u003e\n\n\u003cp\u003ePlease keep in mind that we didn\u0026#39;t patch the vulnerability yet, so please do not share this information with any third-parties. We\u0026#39;re planning to release patched releases next Monday.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-21T09:58:00.758Z","updated_at":"2017-04-21T09:58:00.758Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"450.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"sinkmanu","url":"/sinkmanu"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658136,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-06T13:17:50.579Z","updated_at":"2017-05-06T13:17:50.579Z","additional_data":{"old_title":"HTML Injection in NextCloud","new_title":"Reflected XSS in error pages (NC-SA-2017-008)"},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We plan to release public advisories for this issue on Monday. We've added a draft version of the advisory as summary to this report.\n\nPlease let us know if you wish any changes to the advisory.","markdown_message":"\u003cp\u003eWe plan to release public advisories for this issue on Monday. We\u0026#39;ve added a draft version of the advisory as summary to this report.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you wish any changes to the advisory.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-06T13:18:08.627Z","updated_at":"2017-05-06T13:18:08.627Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect @lukasreschke. No changes.\n\nAfter the security advisories are published I will send an email with the PoC to the Full Disclosure list (securityfocus and fulldisclosure). I will wait some days after the security advisory is published.\n\nRegards.","markdown_message":"\u003cp\u003ePerfect \u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e. No changes.\u003c/p\u003e\n\n\u003cp\u003eAfter the security advisories are published I will send an email with the PoC to the Full Disclosure list (securityfocus and fulldisclosure). I will wait some days after the security advisory is published.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-06T15:52:40.346Z","updated_at":"2017-05-06T15:52:40.346Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1660083,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T11:54:17.459Z","updated_at":"2017-05-08T11:54:17.459Z","cve_ids":["CVE-2017-0891"],"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1660128,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again!","markdown_message":"\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-08T12:19:53.937Z","updated_at":"2017-05-08T12:19:53.937Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sinkmanu","url":"/sinkmanu"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1660129,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting limited disclosure for transparency here.","markdown_message":"\u003cp\u003eRequesting limited disclosure for transparency here.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-08T12:20:05.375Z","updated_at":"2017-05-08T12:20:05.375Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1671247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e After the security advisories are published I will send an email with the PoC to the Full Disclosure list (securityfocus and fulldisclosure). I will wait some days after the security advisory is published.\n\nJust out of curiosity: has this happened yet?","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eAfter the security advisories are published I will send an email with the PoC to the Full Disclosure list (securityfocus and fulldisclosure). I will wait some days after the security advisory is published.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eJust out of curiosity: has this happened yet?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-12T23:26:16.925Z","updated_at":"2017-05-12T23:26:16.925Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1671285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I @lukasreschke, I will send the email on monday. I was waiting to another company that they have the same problem, and they know it before then nextcloud, but they didn't answer me. Also, I was very busy, I will update you when I send this email. Thank you :)","markdown_message":"\u003cp\u003eI \u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e, I will send the email on monday. I was waiting to another company that they have the same problem, and they know it before then nextcloud, but they didn\u0026#39;t answer me. Also, I was very busy, I will update you when I send this email. Thank you :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-12T23:48:18.424Z","updated_at":"2017-05-12T23:48:18.424Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1675541,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-15T19:54:37.136Z","updated_at":"2017-05-15T19:54:37.136Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1675542,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-15T19:54:37.189Z","updated_at":"2017-05-15T19:54:37.189Z","actor":{"username":"sinkmanu","cleared":false,"url":"/sinkmanu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/212/2e28328c649d1e4b6a1b6784f888de1b2ff955f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1676421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Changing visibility to public as exploit is also included at http://seclists.org/fulldisclosure/2017/May/56","markdown_message":"\u003cp\u003eChanging visibility to public as exploit is also included at \u003ca title=\"http://seclists.org/fulldisclosure/2017/May/56\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Ffulldisclosure%2F2017%2FMay%2F56\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/fulldisclosure/2017/May/56\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-16T07:19:04.851Z","updated_at":"2017-05-16T07:19:04.851Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3974,"category":"team","content":"#[Reflected XSS in error pages (NC-SA-2017-008)](https://nextcloud.com/security/advisory/?id=nc-sa-2017-008)\n\n**Risk level:** Low\n**CVSS v3 Base Score:** 3.5 (AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N)\n**CWE:** Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (CWE-79)\n\n#Description\nInadequate escaping of error messages leads to XSS vulnerabilities in multiple components.\n\nNote that Nextcloud employs a strict Content-Security-Policy preventing exploitation of this XSS issue on modern web browsers.\n\n#Affected Software\n- Nextcloud Server \u003c 11.0.3 (CVE-2017-0891)\n- Nextcloud Server \u003c 10.0.5 (CVE-2017-0891)\n- Nextcloud Server \u003c 9.0.58 (CVE-2017-0891)\n\n#Action Taken\nError messages are now properly escaped.\n\n#Acknowledgements\nThe Nextcloud team thanks the following people for their research and responsible disclosure of the above advisory:\n\n- [Manuel Mancera](http://twitter.com/sinkmanu) - Vulnerability discovery and disclosure.","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"reflected-xss-in-error-pages-nc-sa-2017-008\"\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3Dnc-sa-2017-008\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eReflected XSS in error pages (NC-SA-2017-008)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003eRisk level:\u003c/strong\u003e Low\u003cbr\u003e\n\u003cstrong\u003eCVSS v3 Base Score:\u003c/strong\u003e 3.5 (AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N)\u003cbr\u003e\n\u003cstrong\u003eCWE:\u003c/strong\u003e Improper Neutralization of Input During Web Page Generation (\u0026#39;Cross-site Scripting\u0026#39;) (CWE-79)\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eInadequate escaping of error messages leads to XSS vulnerabilities in multiple components.\u003c/p\u003e\n\n\u003cp\u003eNote that Nextcloud employs a strict Content-Security-Policy preventing exploitation of this XSS issue on modern web browsers.\u003c/p\u003e\n\n\u003ch1 id=\"affected-software\"\u003eAffected Software\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eNextcloud Server \u0026lt; 11.0.3 (CVE-2017-0891)\u003c/li\u003e\n\u003cli\u003eNextcloud Server \u0026lt; 10.0.5 (CVE-2017-0891)\u003c/li\u003e\n\u003cli\u003eNextcloud Server \u0026lt; 9.0.58 (CVE-2017-0891)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"action-taken\"\u003eAction Taken\u003c/h1\u003e\n\n\u003cp\u003eError messages are now properly escaped.\u003c/p\u003e\n\n\u003ch1 id=\"acknowledgements\"\u003eAcknowledgements\u003c/h1\u003e\n\n\u003cp\u003eThe Nextcloud team thanks the following people for their research and responsible disclosure of the above advisory:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Ftwitter.com%2Fsinkmanu\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eManuel Mancera\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - Vulnerability discovery and disclosure.\u003c/li\u003e\n\u003c/ul\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}