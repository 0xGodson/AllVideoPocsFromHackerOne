{"id":265528,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjU1Mjg=","url":"https://hackerone.com/reports/265528","title":"Reflected XSS on the data.gov (WAF bypass+ Chrome XSS Auditor bypass+ works in all browsers)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-02T18:21:43.165Z","submitted_at":"2017-09-02T18:21:43.165Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-15T13:39:04.674Z","bug_reporter_agreed_on_going_public_at":"2017-09-15T12:43:18.669Z","team_member_agreed_on_going_public_at":"2017-09-15T13:39:04.616Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHello. I discovered Cross-Site scripting issue on the https://www.data.gov/local/ endpoint.\nThe issue can be site-wide, and exploitable in any place, where pagination exist.\n\n##The Impact and Severity\nI assigned the High severity, because unlike the last #263226 report (that XSS was exploitable in the Firefox only), this XSS works in all browsers (Chrome/IE/Firefox).\nBut, considering that this case requires user interaction (hovering the mouse to the Page 2), the severity can be lowered to the Medium, if you consider so.\n\n##POC (Reflected XSS)\nUse this link in the Mozilla Firefox, Chrome or IE\nhttps://www.data.gov/local/?\u0026q\u0026zzz%27onmou%3Cseover=1\u0026ale%3Crt(%27xsp%27%3C)%3C;1;%20//\n\nand hover the mouse to the page 2.\n{F217930}\n\n##Suggested fix\nSanitize the URLs in the `\u003cdiv class=\"pagination\"\u003e` block. \n","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eHello. I discovered Cross-Site scripting issue on the \u003ca title=\"https://www.data.gov/local/\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Flocal%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/local/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e endpoint.\u003cbr\u003e\nThe issue can be site-wide, and exploitable in any place, where pagination exist.\u003c/p\u003e\n\n\u003ch2 id=\"the-impact-and-severity\"\u003eThe Impact and Severity\u003c/h2\u003e\n\n\u003cp\u003eI assigned the High severity, because unlike the last \u003ca href=\"/reports/263226\"\u003e#263226\u003c/a\u003e report (that XSS was exploitable in the Firefox only), this XSS works in all browsers (Chrome/IE/Firefox).\u003cbr\u003e\nBut, considering that this case requires user interaction (hovering the mouse to the Page 2), the severity can be lowered to the Medium, if you consider so.\u003c/p\u003e\n\n\u003ch2 id=\"poc-reflected-xss\"\u003ePOC (Reflected XSS)\u003c/h2\u003e\n\n\u003cp\u003eUse this link in the Mozilla Firefox, Chrome or IE\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/local/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Flocal%2F%3F%26q%26zzz%2527onmou%253Cseover%3D1%26ale%253Crt%28%2527xsp%2527%253C%29%253C%253B1%253B%2520%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/local/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eand hover the mouse to the page 2.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"zxv.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/930/c19512ea6a4f2c76cf03fea67f51dafcf4d989b3/zxv.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxv.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=9ce4048e23d1274318bbade9a52c5f78e044f156269751f826f793825c4d35d4\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/930/c19512ea6a4f2c76cf03fea67f51dafcf4d989b3/zxv.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxv.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=9ce4048e23d1274318bbade9a52c5f78e044f156269751f826f793825c4d35d4\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cp\u003eSanitize the URLs in the \u003ccode\u003e\u0026lt;div class=\u0026quot;pagination\u0026quot;\u0026gt;\u003c/code\u003e block. \u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":217930,"file_name":"zxv.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/930/c19512ea6a4f2c76cf03fea67f51dafcf4d989b3/zxv.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxv.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxv.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051700Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=9ce4048e23d1274318bbade9a52c5f78e044f156269751f826f793825c4d35d4","file_size":82378,"type":"image/png"},{"id":217931,"file_name":"zxc.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/931/15ba8702b6946a98f6067e5172ba58e71b02308d/zxc.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxc.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxc.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051700Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=efeb69aaa3e8e49fe668dcfb9185904af435efcba3a1fd33d690b0597475de72","file_size":89747,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":28,"voters":["bl4de","flashdisk","cuso4","edoverflow","vijay_kumar","eveeez","r3y","harry_mg","grampae","vulnh0lic","and 18 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":1009,"asset_type":"URL","asset_identifier":"https://www.data.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1973089,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just checked, it is indeed site-wide issue, every endpoint with Pagination is affected.\nhttps://www.data.gov/food/?\u0026q\u0026zzz%27onmou%3Cseover=1\u0026ale%3Crt(%27xsp%27%3C)%3C;1;%20//\nhttps://www.data.gov/consumer/?\u0026q\u0026zzz%27onmou%3Cseover=1\u0026ale%3Crt(%27xsp%27%3C)%3C;1;%20//\n...\netc.","markdown_message":"\u003cp\u003eJust checked, it is indeed site-wide issue, every endpoint with Pagination is affected.\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/food/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Ffood%2F%3F%26q%26zzz%2527onmou%253Cseover%3D1%26ale%253Crt%28%2527xsp%2527%253C%29%253C%253B1%253B%2520%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/food/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/consumer/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Fconsumer%2F%3F%26q%26zzz%2527onmou%253Cseover%3D1%26ale%253Crt%28%2527xsp%2527%253C%29%253C%253B1%253B%2520%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/consumer/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n...\u003cbr\u003e\netc.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-02T18:27:31.368Z","updated_at":"2017-09-02T18:27:31.368Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975896,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs \n\nThanks for your submission. We will review it and get back to you.","markdown_message":"\u003cp\u003e\u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We will review it and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T02:06:36.821Z","updated_at":"2017-09-05T02:06:36.821Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1977715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"actively investigating thx @sp1d3rs ","markdown_message":"\u003cp\u003eactively investigating thx \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T18:23:27.254Z","updated_at":"2017-09-05T18:23:27.254Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1978381,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Interesting to figure the root cause of this - because the initial payload even haven't double quotes, due to correct html encoding. But something breaks the event handler (i think that the first `'` becomes the `\"`, but all next singlequotes reflected as is).\n\nThe unescaped reflection happens only in combination with `\u0026`, what makes me think that it can be a WAF, some input filter, or parameters parsing fault.\nSame payload without `\u0026` will not work:\nhttps://www.data.gov/local/?zzz%27onmou%3Cseover=1ale%3Crt(%27xsp%27%3C)%3C;1;%20//\n{F218652}\nbut when we add few `\u0026` (one will not be enough - without 3rd `\u0026` there will be no reflection)\nit will work:\nhttps://www.data.gov/local/?\u0026q\u0026zzz%27onmou%3Cseover=1\u0026ale%3Crt(%27xsp%27%3C)%3C;1;%20//\n","markdown_message":"\u003cp\u003eInteresting to figure the root cause of this - because the initial payload even haven\u0026#39;t double quotes, due to correct html encoding. But something breaks the event handler (i think that the first \u003ccode\u003e\u0026#39;\u003c/code\u003e becomes the \u003ccode\u003e\u0026quot;\u003c/code\u003e, but all next singlequotes reflected as is).\u003c/p\u003e\n\n\u003cp\u003eThe unescaped reflection happens only in combination with \u003ccode\u003e\u0026amp;\u003c/code\u003e, what makes me think that it can be a WAF, some input filter, or parameters parsing fault.\u003cbr\u003e\nSame payload without \u003ccode\u003e\u0026amp;\u003c/code\u003e will not work:\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/local/?zzz%27onmou%3Cseover=1ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Flocal%2F%3Fzzz%2527onmou%253Cseover%3D1ale%253Crt%28%2527xsp%2527%253C%29%253C%253B1%253B%2520%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/local/?zzz%27onmou%3Cseover=1ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"zxz.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/652/ba67106ef2464047e184ad4a3e2faa479b4d4928/zxz.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxz.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxz.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=0caa41a10ec6f58c166ec7f95cf13b437eb00f145b8c79abd8a47a862cc145d8\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/652/ba67106ef2464047e184ad4a3e2faa479b4d4928/zxz.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxz.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxz.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=0caa41a10ec6f58c166ec7f95cf13b437eb00f145b8c79abd8a47a862cc145d8\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nbut when we add few \u003ccode\u003e\u0026amp;\u003c/code\u003e (one will not be enough - without 3rd \u003ccode\u003e\u0026amp;\u003c/code\u003e there will be no reflection)\u003cbr\u003e\nit will work:\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/local/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Flocal%2F%3F%26q%26zzz%2527onmou%253Cseover%3D1%26ale%253Crt%28%2527xsp%2527%253C%29%253C%253B1%253B%2520%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/local/?\u0026amp;q\u0026amp;zzz%27onmou%3Cseover=1\u0026amp;ale%3Crt(%27xsp%27%3C)%3C%3B1%3B%20//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T21:12:03.579Z","updated_at":"2017-09-05T21:27:01.693Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":218652,"filename":"zxz.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/652/ba67106ef2464047e184ad4a3e2faa479b4d4928/zxz.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxz.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxz.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051700Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=0caa41a10ec6f58c166ec7f95cf13b437eb00f145b8c79abd8a47a862cc145d8"}],"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1981307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I figured out the root cause - the pagination links has `href` attribute data included in single quotes instead double quotes:\n{F218909}\nand thats why single quote in the payload can break the attribute.\nExample: https://github.com/GSA/data.gov/blob/master/roots-nextdatagov/templates/content-all-apps-pagination.php, line 368:\n{F218910}\nLooks like\n```\n$query = filter_var($_GET['q'], FILTER_SANITIZE_STRING);\n```\non line 44 does not sanitize string completely.\n\nSo changing the single quote to the double quotes when building href attribute (or escaping the single quote in the input) should fix the issue.\n\nIn overall i detected 80 endpoints (using Google Search), affected by this XSS (it can be more of them as any page with pagination is affected):\n{F218912}\n","markdown_message":"\u003cp\u003eI figured out the root cause - the pagination links has \u003ccode\u003ehref\u003c/code\u003e attribute data included in single quotes instead double quotes:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"zxzx.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/909/212e727efaac677b36ce0acef5d73b5e4d289291/zxzx.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxzx.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxzx.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=7a0cffae572aa8e0eb68c6cd2806a1e7450a2e87d0ef54412bf15791430f71f4\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/909/212e727efaac677b36ce0acef5d73b5e4d289291/zxzx.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxzx.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxzx.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=7a0cffae572aa8e0eb68c6cd2806a1e7450a2e87d0ef54412bf15791430f71f4\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nand thats why single quote in the payload can break the attribute.\u003cbr\u003e\nExample: \u003ca title=\"https://github.com/GSA/data.gov/blob/master/roots-nextdatagov/templates/content-all-apps-pagination.php\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FGSA%2Fdata.gov%2Fblob%2Fmaster%2Froots-nextdatagov%2Ftemplates%2Fcontent-all-apps-pagination.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/GSA/data.gov/blob/master/roots-nextdatagov/templates/content-all-apps-pagination.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, line 368:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"vv.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/910/ba99ba24f84dce07c245bca96564b5addcb6bbf1/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=40bfea07b292ff41c1692376a1547e0d336fa24f6e031494f0ee78673b3293ca\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/910/ba99ba24f84dce07c245bca96564b5addcb6bbf1/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=40bfea07b292ff41c1692376a1547e0d336fa24f6e031494f0ee78673b3293ca\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nLooks like\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$query = filter_var($_GET[\u0026#39;q\u0026#39;], FILTER_SANITIZE_STRING);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eon line 44 does not sanitize string completely.\u003c/p\u003e\n\n\u003cp\u003eSo changing the single quote to the double quotes when building href attribute (or escaping the single quote in the input) should fix the issue.\u003c/p\u003e\n\n\u003cp\u003eIn overall i detected 80 endpoints (using Google Search), affected by this XSS (it can be more of them as any page with pagination is affected):\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"affected_endpoints.txt\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/912/68b2da71a27d930b0ab90282d00182961bf16aef/affected_endpoints.txt?response-content-disposition=attachment%3B%20filename%3D%22affected_endpoints.txt%22%3B%20filename%2A%3DUTF-8%27%27affected_endpoints.txt\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051700Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=3e5e9a44216555f7579dd595abaf3e1088f82904724c6d7e84265e8f77646766\" data-attachment-type=\"text/plain\"\u003eaffected_endpoints.txt (F218912)\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T00:03:36.138Z","updated_at":"2017-09-07T00:15:51.516Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":218912,"filename":"affected_endpoints.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/912/68b2da71a27d930b0ab90282d00182961bf16aef/affected_endpoints.txt?response-content-disposition=attachment%3B%20filename%3D%22affected_endpoints.txt%22%3B%20filename%2A%3DUTF-8%27%27affected_endpoints.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051701Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=3c00da73416d6ce5bc475976ccfc80c276465c2cd5c0ccc6d04327566d34b81f"},{"id":218910,"filename":"vv.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/910/ba99ba24f84dce07c245bca96564b5addcb6bbf1/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051701Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=76a956526f908a57a5d6260524b398d3ed594dd1f372a9d2b794725b5dd3b402"},{"id":218909,"filename":"zxzx.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/909/212e727efaac677b36ce0acef5d73b5e4d289291/zxzx.PNG?response-content-disposition=attachment%3B%20filename%3D%22zxzx.PNG%22%3B%20filename%2A%3DUTF-8%27%27zxzx.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051701Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=44158e1961dc0eed47cdf30a2a1491f655641685111de7fb4bb75b8f49170038"}],"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1982482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My apologies, mentioned source file looks like only the particular case of the issue (it affects only https://www.data.gov/applications path) - so i didn't figure the root cause:)","markdown_message":"\u003cp\u003eMy apologies, mentioned source file looks like only the particular case of the issue (it affects only \u003ca title=\"https://www.data.gov/applications\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Fapplications\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/applications\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e path) - so i didn\u0026#39;t figure the root cause:)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T11:49:51.635Z","updated_at":"2017-09-07T11:50:01.646Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1984182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"still digging into this one... should have a response tommorrow thanks as always @sp1d3rs ","markdown_message":"\u003cp\u003estill digging into this one... should have a response tommorrow thanks as always \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-08T02:54:37.992Z","updated_at":"2017-09-08T02:54:37.992Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1986193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fixed, great work!\nI did not find a way to bypass the fix, so report can be moved to the `Resolved` state.","markdown_message":"\u003cp\u003eLooks fixed, great work!\u003cbr\u003e\nI did not find a way to bypass the fix, so report can be moved to the \u003ccode\u003eResolved\u003c/code\u003e state.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-08T23:05:20.410Z","updated_at":"2017-09-08T23:05:20.410Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995470,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-13T21:31:15.245Z","updated_at":"2017-09-13T21:31:15.245Z","additional_data":{"old_team":"TTS Private Bug Bounty","new_team":"TTS Bug Bounty"},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup this was a valid finding that we have pushed a fix to production please move to resolved","markdown_message":"\u003cp\u003e\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e this was a valid finding that we have pushed a fix to production please move to resolved\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T16:17:30.912Z","updated_at":"2017-09-14T16:17:30.912Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1997855,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for another great report @sp1d3rs! ","markdown_message":"\u003cp\u003eThanks again for another great report \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T20:24:53.984Z","updated_at":"2017-09-14T20:24:53.984Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997889,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-14T20:43:28.314Z","updated_at":"2017-09-14T20:43:28.314Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.0)","old_severity_id":72786,"new_severity_id":75276},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997951,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for another great report @sp1d3rs! We eagerly await your next report :) ","markdown_message":"\u003cp\u003eThanks again for another great report \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e! We eagerly await your next report :) \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T21:22:44.750Z","updated_at":"2017-09-14T21:22:44.750Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1999289,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T12:43:18.702Z","updated_at":"2017-09-15T12:43:18.702Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1999377,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T13:39:04.642Z","updated_at":"2017-09-15T13:39:04.642Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1999378,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T13:39:04.698Z","updated_at":"2017-09-15T13:39:04.698Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5334,"category":"researcher","content":"*Thanks to the 18F team for the great experience, fast fix, and the bounty!*\n\nThis case was weird. The XSS worked only with few `\u0026` chars in certain places (identified by trial-and-error method), and input appeared to be correctly sanitized without it.\nIt bypassed Chrome XSS auditor, and due to stripping chars function in place (hi `FILTER_SANITIZE_STRING`) it also bypassed Kona WAF using stripped chars in the payload. It is a curious example, how two different defense mechanisms neutralize each other.\nThe discovered XSS issue was site-wide and affected 80+ endpoints.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cem\u003eThanks to the 18F team for the great experience, fast fix, and the bounty!\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eThis case was weird. The XSS worked only with few \u003ccode\u003e\u0026amp;\u003c/code\u003e chars in certain places (identified by trial-and-error method), and input appeared to be correctly sanitized without it.\u003cbr\u003e\nIt bypassed Chrome XSS auditor, and due to stripping chars function in place (hi \u003ccode\u003eFILTER_SANITIZE_STRING\u003c/code\u003e) it also bypassed Kona WAF using stripped chars in the payload. It is a curious example, how two different defense mechanisms neutralize each other.\u003cbr\u003e\nThe discovered XSS issue was site-wide and affected 80+ endpoints.\u003c/p\u003e\n"}]}