{"id":255125,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTUxMjU=","url":"https://hackerone.com/reports/255125","title":"Null Byte Injection in all fields of Profile","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2017-07-31T10:29:46.785Z","submitted_at":"2017-07-31T10:29:46.785Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asaxena2190","url":"/asaxena2190","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-24T12:29:05.011Z","bug_reporter_agreed_on_going_public_at":"2018-02-24T12:29:04.934Z","team_member_agreed_on_going_public_at":"2017-08-26T23:05:52.968Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nNull byte injection is possible in all the fields of Edit Profile functionality.\n\n**Affected URL:** \nhttps://app.legalrobot.com/account\n\n**Description:** \nPossible Injection of control characters, such as Null Byte 0x00, \\000, \\x00, \\z, or the Unicode representation \\u0000 into vulnerable fields in the Message endpoints in order to cause unexpected, harmful behaviors. \n A null character can be placed in a any field of profile with the percent code %00.\nThe ability to represent a null character does not always mean the resulting string will be correctly interpreted, as many programs will consider the null to be the end of the string.\n\n**POC:**\n1. Register a User.\n2. Click on Account.\n3. Click on Edit Profile.\n4. Put some control characters.\n5. Click on submit.\n6. Control characters will be saved at Server side as well as rendered at client side.\n\n**Fix:** Block the control characters from being saved on the back-end when included in user-input, as well as to suppress the output and rendering of previously-submitted control characters.\n\nPlease find the attached screen shot as well.\n\nThanks,\nAkash Saxena","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eNull byte injection is possible in all the fields of Edit Profile functionality.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAffected URL:\u003c/strong\u003e \u003cbr\u003e\n\u003ca title=\"https://app.legalrobot.com/account\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/account\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nPossible Injection of control characters, such as Null Byte 0x00, \\000, \\x00, \\z, or the Unicode representation \\u0000 into vulnerable fields in the Message endpoints in order to cause unexpected, harmful behaviors. \u003cbr\u003e\n A null character can be placed in a any field of profile with the percent code %00.\u003cbr\u003e\nThe ability to represent a null character does not always mean the resulting string will be correctly interpreted, as many programs will consider the null to be the end of the string.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRegister a User.\u003c/li\u003e\n\u003cli\u003eClick on Account.\u003c/li\u003e\n\u003cli\u003eClick on Edit Profile.\u003c/li\u003e\n\u003cli\u003ePut some control characters.\u003c/li\u003e\n\u003cli\u003eClick on submit.\u003c/li\u003e\n\u003cli\u003eControl characters will be saved at Server side as well as rendered at client side.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix:\u003c/strong\u003e Block the control characters from being saved on the back-end when included in user-input, as well as to suppress the output and rendering of previously-submitted control characters.\u003c/p\u003e\n\n\u003cp\u003ePlease find the attached screen shot as well.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAkash Saxena\u003c/p\u003e\n","weakness":{"id":14,"name":"Improper Null Termination"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":208506,"file_name":"legalrobot.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/208/506/4472de22ef6bddc37caea1a6017cf1f2d84b9f97/legalrobot.JPG?response-content-disposition=attachment%3B%20filename%3D%22legalrobot.JPG%22%3B%20filename%2A%3DUTF-8%27%27legalrobot.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051313Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=a3548b8ca2c2db469662b2272f8c5fbafd60cf8aee2a39710ce0c1f5fbc0b2cf","file_size":98022,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["apapedulimu","asaxena2190"],"structured_scope":{"databaseId":519,"asset_type":"URL","asset_identifier":"app.legalrobot.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1881527,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report! We do allow some special characters in the profile (see our recently disclosed report #254927 for more detail). However, ASCII control characters are blocked. In this case, we would actually interpret `\\x00` as a string with a backslash, then an x character, followed by two zeros. Theoretically, someone could change their legal name to `\\x00Haxor` (stranger things have occurred) and we would accept that as a valid string. So long as we're treating those as strings rather than evaluating the characters, we should be ok.","markdown_message":"\u003cp\u003eThanks for the report! We do allow some special characters in the profile (see our recently disclosed report \u003ca href=\"/reports/254927\"\u003e#254927\u003c/a\u003e for more detail). However, ASCII control characters are blocked. In this case, we would actually interpret \u003ccode\u003e\\x00\u003c/code\u003e as a string with a backslash, then an x character, followed by two zeros. Theoretically, someone could change their legal name to \u003ccode\u003e\\x00Haxor\u003c/code\u003e (stranger things have occurred) and we would accept that as a valid string. So long as we\u0026#39;re treating those as strings rather than evaluating the characters, we should be ok.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-01T07:50:15.104Z","updated_at":"2017-08-01T07:50:15.104Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1957528,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-26T23:05:52.992Z","updated_at":"2017-08-26T23:05:52.992Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2428821,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-24T12:29:04.973Z","updated_at":"2018-02-24T12:29:04.973Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2428822,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-24T12:29:05.039Z","updated_at":"2018-02-24T12:29:05.039Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}