{"id":262620,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjI2MjA=","url":"https://hackerone.com/reports/262620","title":"Gratipay rails secret token (secret_key_base) publicly exposed in GitHub","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-23T16:40:01.692Z","submitted_at":"2017-08-23T16:40:01.692Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp4rrow","url":"/sp4rrow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/167/668/c142929e727824c63deec1fc890ea2d0c3473477_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-23T17:04:45.686Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-08-23T16:51:52.281Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\nGratipay's Rails secret token is publicly exposed on GitHub. Knowing the secret token allows an attacker to impersonate any user in the application.\n\nThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects, below is the referenced github for the analysis. \n\n# Description\nThe `secret_token.rb` file's content includes a long randomized string which is used to verify the integrity of signed cookies (such as user sessions when people are signed into your web app).\n[Documentation](http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html) says:\n\u003e Use your existing `secret_key_base` from the `secret_token.rb` initializer to set the `SECRET_KEY_BASE` environment variable for whichever users run the Rails app in production mode. Alternately, you can simply copy the existing `secret_key_base` from the `secret_token.rb` initializer to `secrets.yml` under the production section, replacing `\u003c%= ENV[\"SECRET_KEY_BASE\"] %\u003e`.\n\u003e Make sure your secret_key_base is kept private\nif you're sharing your code publicly.\n\n**Further Details:**\nKnowing the secret token allows an attacker to impersonate any user in the application.\n\n# Steps To Reproduce\nGo to the Gratipay \"Access Dashboard\" project (https://github.com/gratipay/access-dashboard/blob/rails-recode/config/initializers)\nIn the `secret_token.rb` file the `secret_key_base` is publicly disclosed.\nAs per the comments in the code as well as the documentation the key should always be kept private, looks like the developer forgot to remove the token. Happens! Too much work sometimes and the expected delivery deadlines :)\n\n# Patch\nRemoving the secret key would do the work!\n\n# Supporting Material/References:\nThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects. :)\n(https://gist.github.com/EdOverflow/922549f610b258f459b219a32f92d10b)\n\nPlease let me know if any further information is needed on this.\n\nBR,\nnull","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eGratipay\u0026#39;s Rails secret token is publicly exposed on GitHub. Knowing the secret token allows an attacker to impersonate any user in the application.\u003c/p\u003e\n\n\u003cp\u003eThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects, below is the referenced github for the analysis. \u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eThe \u003ccode\u003esecret_token.rb\u003c/code\u003e file\u0026#39;s content includes a long randomized string which is used to verify the integrity of signed cookies (such as user sessions when people are signed into your web app).\u003cbr\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fedgeguides.rubyonrails.org%2Fupgrading_ruby_on_rails.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eDocumentation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e says:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eUse your existing \u003ccode\u003esecret_key_base\u003c/code\u003e from the \u003ccode\u003esecret_token.rb\u003c/code\u003e initializer to set the \u003ccode\u003eSECRET_KEY_BASE\u003c/code\u003e environment variable for whichever users run the Rails app in production mode. Alternately, you can simply copy the existing \u003ccode\u003esecret_key_base\u003c/code\u003e from the \u003ccode\u003esecret_token.rb\u003c/code\u003e initializer to \u003ccode\u003esecrets.yml\u003c/code\u003e under the production section, replacing \u003ccode\u003e\u0026lt;%= ENV[\u0026quot;SECRET_KEY_BASE\u0026quot;] %\u0026gt;\u003c/code\u003e.\u003cbr\u003e\nMake sure your secret_key_base is kept private\u003cbr\u003e\nif you\u0026#39;re sharing your code publicly.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eFurther Details:\u003c/strong\u003e\u003cbr\u003e\nKnowing the secret token allows an attacker to impersonate any user in the application.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h1\u003e\n\n\u003cp\u003eGo to the Gratipay \u0026quot;Access Dashboard\u0026quot; project (\u003ca title=\"https://github.com/gratipay/access-dashboard/blob/rails-recode/config/initializers\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Faccess-dashboard%2Fblob%2Frails-recode%2Fconfig%2Finitializers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/gratipay/access-dashboard/blob/rails-recode/config/initializers\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003cbr\u003e\nIn the \u003ccode\u003esecret_token.rb\u003c/code\u003e file the \u003ccode\u003esecret_key_base\u003c/code\u003e is publicly disclosed.\u003cbr\u003e\nAs per the comments in the code as well as the documentation the key should always be kept private, looks like the developer forgot to remove the token. Happens! Too much work sometimes and the expected delivery deadlines :)\u003c/p\u003e\n\n\u003ch1 id=\"patch\"\u003ePatch\u003c/h1\u003e\n\n\u003cp\u003eRemoving the secret key would do the work!\u003c/p\u003e\n\n\u003ch1 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h1\u003e\n\n\u003cp\u003eThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects. :)\u003cbr\u003e\n(\u003ca title=\"https://gist.github.com/EdOverflow/922549f610b258f459b219a32f92d10b\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2FEdOverflow%2F922549f610b258f459b219a32f92d10b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/EdOverflow/922549f610b258f459b219a32f92d10b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if any further information is needed on this.\u003c/p\u003e\n\n\u003cp\u003eBR,\u003cbr\u003e\nnull\u003c/p\u003e\n","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-22T16:51:52.344Z","allow_singular_disclosure_after":-103119822.07590018,"singular_disclosure_allowed":true,"vote_count":9,"voters":["sp1d3rs","dawgyg","ngalog","skansing","eveeez","khizer47","sp4rrow","edio","coldbrew"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":373,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/gratipay/bot","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1949359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\u003c/p\u003e\n\n\u003cp\u003ePlease expect additional feedback from us within the next couple of days. The \u0026quot;INFORMATION SECURITY\u0026quot; section of the following page has additional, useful information regarding our platform\u0026#39;s security: \u003ca title=\"http://inside.gratipay.com/howto/manage-risk\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fhowto%2Fmanage-risk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/howto/manage-risk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your interest in securing our platform and look forward to working with you.\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nThe Gratipay Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-08-23T16:40:01.885Z","updated_at":"2017-08-23T16:40:01.885Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1949366,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @nuii,\n\nThis looks like a valid issue. While it is out of scope, we have made an exception and decided to accept this report. The issue cannot currently be exploited since the app has never been deployed, but we would like to prevent any confusion and possible deployment of this vulnerable app in the future.\n\nAlso I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)\n\nBest regards,\nEdOverflow ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nuii\"\u003e@nuii\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis looks like a valid issue. While it is out of scope, we have made an exception and decided to accept this report. The issue cannot currently be exploited since the app has never been deployed, but we would like to prevent any confusion and possible deployment of this vulnerable app in the future.\u003c/p\u003e\n\n\u003cp\u003eAlso I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEdOverflow \u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T16:44:27.894Z","updated_at":"2017-08-23T16:44:27.894Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949378,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @nuii,\n\nThank you very much for the report. We have resolved this issue by removing the affected branch, but we plan on removing the whole repo at some point too.\n\nBest regards,\nEdOverflow","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nuii\"\u003e@nuii\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you very much for the report. We have resolved this issue by removing the affected branch, but we plan on removing the whole repo at some point too.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEdOverflow\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T16:51:43.355Z","updated_at":"2017-08-23T16:51:43.355Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp4rrow","url":"/sp4rrow"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949379,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-23T16:51:52.312Z","updated_at":"2017-08-23T16:51:52.312Z","first_to_agree":true,"actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wooo, it's fixed. \nThis was really fast :)\nThe secret_token.rb file isnt accessible anymore.\n\n_Also I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)_\n\nThanks for the writeups Ed. They are really helpful, keep sharing.\n\nWe can disclose this.\n","markdown_message":"\u003cp\u003eWooo, it\u0026#39;s fixed. \u003cbr\u003e\nThis was really fast :)\u003cbr\u003e\nThe secret_token.rb file isnt accessible anymore.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eAlso I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)\u003c/u\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks for the writeups Ed. They are really helpful, keep sharing.\u003c/p\u003e\n\n\u003cp\u003eWe can disclose this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T17:01:38.751Z","updated_at":"2017-08-23T17:01:38.751Z","actor":{"username":"sp4rrow","cleared":false,"url":"/sp4rrow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/668/c142929e727824c63deec1fc890ea2d0c3473477_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1949409,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-23T17:04:45.668Z","updated_at":"2017-08-23T17:04:45.668Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Keep up the good work @nuii!","markdown_message":"\u003cp\u003eKeep up the good work \u003ca href=\"/nuii\"\u003e@nuii\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T17:05:20.416Z","updated_at":"2017-08-23T17:05:20.416Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2036449,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-01T12:41:43.353Z","updated_at":"2017-10-01T12:41:43.353Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}