{"id":283550,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM1NTA=","url":"https://hackerone.com/reports/283550","title":"Password Reset Token Not Expired ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-10-27T15:01:43.544Z","submitted_at":"2017-10-27T15:01:43.544Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekninja","url":"/geekninja","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/195/607/a6374ede686d0cf2b1dd1d56ae1e1d74f2db4418_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21745,"url":"https://hackerone.com/infogram","handle":"infogram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Infogram","twitter_handle":"infogram","website":"http://infogram.com","about":"Make Infographics and Charts that People Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-30T09:20:44.066Z","bug_reporter_agreed_on_going_public_at":"2017-10-30T08:49:39.383Z","team_member_agreed_on_going_public_at":"2017-10-30T09:20:43.981Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team,\n\nHere in this scenario, I've found that the there's a kind of server side invalidation of Password Reset tokens. Like if I've requested for password reset token (token1) and I don't use it, after I will make another request for password reset token (token2). This time I'll use the token2 means the link that I requested for the second time, so the first token (token1) should explicitly expire by the server. But here I can use the token1 also after password change by token2, this is unusual behavior of web application.\n\nExploit Scenario:\nIf victim's email account is still logged into his/her Office Computers or any public Internet Cafe. Then any external attacker can use the unused token to reset victims token.\n\nProof of Concept:\n\n1)Go to https://infogram.com/forgot and ask for password reset link.\n2)Don't use the link keep it in Email inbox.\n3)After some time repeat the step 1.\n4)This time use the password reset link which was asked in step 3. means the 2nd link.\n5)After changing the password, use the password reset link that was captured in step 1.\n6)You'll see the password reset link is not expired even after password change.\n7)I've also explained you the Exploit Scenario, now its all upto you.\n\nRegards,\nAli Razzaq","vulnerability_information_html":"\u003cp\u003eHello Team,\u003c/p\u003e\n\n\u003cp\u003eHere in this scenario, I\u0026#39;ve found that the there\u0026#39;s a kind of server side invalidation of Password Reset tokens. Like if I\u0026#39;ve requested for password reset token (token1) and I don\u0026#39;t use it, after I will make another request for password reset token (token2). This time I\u0026#39;ll use the token2 means the link that I requested for the second time, so the first token (token1) should explicitly expire by the server. But here I can use the token1 also after password change by token2, this is unusual behavior of web application.\u003c/p\u003e\n\n\u003cp\u003eExploit Scenario:\u003cbr\u003e\nIf victim\u0026#39;s email account is still logged into his/her Office Computers or any public Internet Cafe. Then any external attacker can use the unused token to reset victims token.\u003c/p\u003e\n\n\u003cp\u003eProof of Concept:\u003c/p\u003e\n\n\u003cp\u003e1)Go to \u003ca title=\"https://infogram.com/forgot\" href=\"/redirect?url=https%3A%2F%2Finfogram.com%2Fforgot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://infogram.com/forgot\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and ask for password reset link.\u003cbr\u003e\n2)Don\u0026#39;t use the link keep it in Email inbox.\u003cbr\u003e\n3)After some time repeat the step 1.\u003cbr\u003e\n4)This time use the password reset link which was asked in step 3. means the 2nd link.\u003cbr\u003e\n5)After changing the password, use the password reset link that was captured in step 1.\u003cbr\u003e\n6)You\u0026#39;ll see the password reset link is not expired even after password change.\u003cbr\u003e\n7)I\u0026#39;ve also explained you the Exploit Scenario, now its all upto you.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAli Razzaq\u003c/p\u003e\n","weakness":{"id":92,"name":"Weak Password Recovery Mechanism for Forgotten Password"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-29T08:49:39.534Z","allow_singular_disclosure_after":-97274018.79058063,"singular_disclosure_allowed":true,"vote_count":11,"voters":["sameerphad72","akaash_pantherdefence","gamliel","eveeez","an0nym0us","exadmin","namansahore","sahurjt","b4155f7c29acd42c27d007a","4w3","and 1 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":870,"asset_type":"URL","asset_identifier":"infogram.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2112331,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, it should be fixed now.\n\nBest regards,\nKaspars\n","markdown_message":"\u003cp\u003eThanks, it should be fixed now.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nKaspars\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-30T08:32:56.600Z","updated_at":"2017-10-30T08:32:56.600Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"geekninja","url":"/geekninja"},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2112350,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-30T08:49:39.449Z","updated_at":"2017-10-30T08:49:39.449Z","first_to_agree":true,"actor":{"username":"geekninja","cleared":false,"url":"/geekninja","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/195/607/a6374ede686d0cf2b1dd1d56ae1e1d74f2db4418_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2112410,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-30T09:20:44.016Z","updated_at":"2017-10-30T09:20:44.016Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2112411,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-30T09:20:44.100Z","updated_at":"2017-10-30T09:20:44.100Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}