{"id":582349,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81ODIzNDk=","url":"https://hackerone.com/reports/582349","title":"Last pipeline status for MR leaked ","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-05-16T12:09:57.979Z","submitted_at":"2019-05-16T12:09:57.979Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xanbanx","url":"/xanbanx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-01T08:48:29.437Z","bug_reporter_agreed_on_going_public_at":"2019-10-01T08:48:29.373Z","team_member_agreed_on_going_public_at":"2019-10-01T08:46:44.808Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi GitLab security team,\n\n### Summary\n\nGitLab allows for public and internal projects to restrict the visibility of pipelines to project members only. Then, only project members should have access to the pipeline information. \n\nHowever, this can be bypassed. There is a internal endpoint (`:namespace/:project_name/merge_requests/:iid/pipeline_status`) on each merge request page allowing anyone with merge request access also view the last pipeline status for this merge request. \n\n### Steps to reproduce\n\n1. Create a public project, disable public pipelines, and restrict the visibility of pipelines to project members only\n2. Setup the repo such that there is a CI job, and create a merge request\n3. As an unauthorized user, perform the following request in the browser: `https://example.gitlab.com/\u003cnamespace\u003e/\u003cproject\u003e/merge_requests/1/pipeline_status`. This will return a JSON response with a content similar to the one like this leaking the pipeline status:\n\n```\n{\n    \"icon\": \"status_running\",\n    \"text\": \"running\",\n    \"label\": \"running\",\n    \"group\": \"running\",\n    \"tooltip\": \"running\",\n    \"has_details\": false,\n    \"details_path\": \"/test-project/testproject/pipelines/37\",\n    \"illustration\": null,\n    \"favicon\": \"https://example.gitlab.com/assets/ci_favicons/favicon_status_running-9c635b2419a8e1ec991c993061b89cc5aefc0743bb238ecd0c381e7741a70e8c.png\"\n}\n```\n\nThis information is only limited to project members only and thus is leaked to everyone with project and merge request access.\n\n### Impact\n\nUnauthorized users have access to the pipeline status of a merge request.\n\n### What is the current *bug* behavior?\n\nAn unauthorized user can make this request and successfully can get information to attached pipelines.\n\n### What is the expected *correct* behavior?\n\nThis request above should return 403 Forbidden, if the user does not have access to view pipelines.\n\n### Output of checks\n\nThis happens on gitlab.com\n\nBest regards,\nXanbanx\n\n## Impact\n\nUnauthorized users have access to the pipeline status of a merge request.","vulnerability_information_html":"\u003cp\u003eHi GitLab security team,\u003c/p\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eGitLab allows for public and internal projects to restrict the visibility of pipelines to project members only. Then, only project members should have access to the pipeline information. \u003c/p\u003e\n\n\u003cp\u003eHowever, this can be bypassed. There is a internal endpoint (\u003ccode\u003e:namespace/:project_name/merge_requests/:iid/pipeline_status\u003c/code\u003e) on each merge request page allowing anyone with merge request access also view the last pipeline status for this merge request. \u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a public project, disable public pipelines, and restrict the visibility of pipelines to project members only\u003c/li\u003e\n\u003cli\u003eSetup the repo such that there is a CI job, and create a merge request\u003c/li\u003e\n\u003cli\u003eAs an unauthorized user, perform the following request in the browser: \u003ccode\u003ehttps://example.gitlab.com/\u0026lt;namespace\u0026gt;/\u0026lt;project\u0026gt;/merge_requests/1/pipeline_status\u003c/code\u003e. This will return a JSON response with a content similar to the one like this leaking the pipeline status:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026quot;icon\u0026quot;: \u0026quot;status_running\u0026quot;,\n    \u0026quot;text\u0026quot;: \u0026quot;running\u0026quot;,\n    \u0026quot;label\u0026quot;: \u0026quot;running\u0026quot;,\n    \u0026quot;group\u0026quot;: \u0026quot;running\u0026quot;,\n    \u0026quot;tooltip\u0026quot;: \u0026quot;running\u0026quot;,\n    \u0026quot;has_details\u0026quot;: false,\n    \u0026quot;details_path\u0026quot;: \u0026quot;/test-project/testproject/pipelines/37\u0026quot;,\n    \u0026quot;illustration\u0026quot;: null,\n    \u0026quot;favicon\u0026quot;: \u0026quot;https://example.gitlab.com/assets/ci_favicons/favicon_status_running-9c635b2419a8e1ec991c993061b89cc5aefc0743bb238ecd0c381e7741a70e8c.png\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis information is only limited to project members only and thus is leaked to everyone with project and merge request access.\u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact\u003c/h3\u003e\n\n\u003cp\u003eUnauthorized users have access to the pipeline status of a merge request.\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-current-bug-behavior\"\u003eWhat is the current \u003cem\u003ebug\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eAn unauthorized user can make this request and successfully can get information to attached pipelines.\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eThis request above should return 403 Forbidden, if the user does not have access to view pipelines.\u003c/p\u003e\n\n\u003ch3 id=\"output-of-checks\"\u003eOutput of checks\u003c/h3\u003e\n\n\u003cp\u003eThis happens on gitlab.com\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nXanbanx\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUnauthorized users have access to the pipeline status of a merge request.\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["mygf","cr4xerbik4sh","cryptographer","jasy","mattini","hackdwerg","7a-69","psf"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4857163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xanbanx,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 20 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 20 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-05-16T12:21:42.826Z","updated_at":"2019-05-16T12:21:42.826Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4888492,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @xanbanx ,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab-ce/issues/62073.  This issue will be made public 30 days following the release of a patch.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nEthan\nSecurity Team | GitLab Inc.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003c/p\u003e\n\n\u003cp\u003eWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/62073\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F62073\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/62073\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.  This issue will be made public 30 days following the release of a patch.\u003c/p\u003e\n\n\u003cp\u003eWe will continue to update you via HackerOne as a patch is scheduled for release.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEthan\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-20T23:59:04.582Z","updated_at":"2019-05-20T23:59:04.582Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5088217,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @xanbanx,\n\nThe GitLab issue created from your report is currently scheduled for 2019-08-22.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe GitLab issue created from your report is currently scheduled for 2019-08-22.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-06-14T04:22:51.005Z","updated_at":"2019-06-14T04:22:51.005Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5623412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @xanbanx,\n\nThe GitLab issue created from your report is currently scheduled for 2019-09-22.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe GitLab issue created from your report is currently scheduled for 2019-09-22.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-08-21T04:21:47.948Z","updated_at":"2019-08-21T04:21:47.948Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5699178,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-30T15:40:21.731Z","updated_at":"2019-08-30T15:40:21.731Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"xanbanx","url":"/xanbanx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5699183,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @xanbanx,\n\nThank you again for the report! Your finding has been patched in GitLab version 12.2.3 and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nEthan\nSecurity Team | GitLab Inc.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched in GitLab version 12.2.3 and we are awarding a bounty. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEthan\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T15:40:59.306Z","updated_at":"2019-08-30T15:40:59.306Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"xanbanx","url":"/xanbanx"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5928291,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-01T08:46:44.833Z","updated_at":"2019-10-01T08:46:44.833Z","first_to_agree":true,"actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5928300,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-01T08:48:29.394Z","updated_at":"2019-10-01T08:48:29.394Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5928301,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-01T08:48:29.455Z","updated_at":"2019-10-01T08:48:29.455Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}