{"id":52646,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjY0Ng==","url":"https://hackerone.com/reports/52646","title":"Insecure direct object reference - have access to deleted DM's","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-19T19:01:36.118Z","submitted_at":"2015-03-19T19:01:36.118Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akhil-reni","url":"/akhil-reni","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-12T04:56:07.348Z","bug_reporter_agreed_on_going_public_at":"2015-09-12T04:55:52.073Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Hello**,\r\n\r\nThe bug is straight and simple, \r\nI have access to deleted DM's.\r\nOnce a DM is deleted a user/app will still be able to access the DM's using show DM endpoint\r\n\r\nAttack Scenario\r\n====================\r\nTheir are two accounts Sam and Molly ,\r\nSam Dm's Molly something important and both quickly delete the Dm's after the chat,\r\nSam has given access to a 3rd party app which can access his DM's.\r\nWhen Sam DM's molly every DM gets a unique id like 123456\r\nand the DM can be accessed using the following API call ,\r\nhttps://api.twitter.com/1.1/direct_messages/show.json?id={DM-id}\r\nNow let's say Sam and Molly both deleted the DM ,\r\nbut the 3rd party app can still access the deleted DM using the above end point.\r\n\r\nSteps to reproduce\r\n==========================\r\n- Create 2 account's A and B\r\n- From account A Dm account B\r\n- Note down the Dm id , and make an api \r\nhttps://api.twitter.com/1.1/direct_messages/show.json?id=[noted-dm-id]\r\n- Now delete the DM\r\n- Repeat the api call \r\nhttps://api.twitter.com/1.1/direct_messages/show.json?id=578631102144741376\r\n- You will still have access to the deleted DM.\r\n\r\n*POC: Check for video attached*\r\n\r\n\r\n\r\n**Regards,\r\nWesecureapp**\r\n\r\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eHello\u003c/strong\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe bug is straight and simple, \u003cbr\u003e\nI have access to deleted DM\u0026#39;s.\u003cbr\u003e\nOnce a DM is deleted a user/app will still be able to access the DM\u0026#39;s using show DM endpoint\u003c/p\u003e\n\n\u003ch1 id=\"attack-scenario\"\u003eAttack Scenario\u003c/h1\u003e\n\n\u003cp\u003eTheir are two accounts Sam and Molly ,\u003cbr\u003e\nSam Dm\u0026#39;s Molly something important and both quickly delete the Dm\u0026#39;s after the chat,\u003cbr\u003e\nSam has given access to a 3rd party app which can access his DM\u0026#39;s.\u003cbr\u003e\nWhen Sam DM\u0026#39;s molly every DM gets a unique id like 123456\u003cbr\u003e\nand the DM can be accessed using the following API call ,\u003cbr\u003e\n\u003ca title=\"https://api.twitter.com/1.1/direct_messages/show.json?id=%7BDM-id%7D\" href=\"/redirect?url=https%3A%2F%2Fapi.twitter.com%2F1.1%2Fdirect_messages%2Fshow.json%3Fid%3D%257BDM-id%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.twitter.com/1.1/direct_messages/show.json?id=%7BDM-id%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nNow let\u0026#39;s say Sam and Molly both deleted the DM ,\u003cbr\u003e\nbut the 3rd party app can still access the deleted DM using the above end point.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eCreate 2 account\u0026#39;s A and B\u003c/li\u003e\n\u003cli\u003eFrom account A Dm account B\u003c/li\u003e\n\u003cli\u003eNote down the Dm id , and make an api \n\u003ca title=\"https://api.twitter.com/1.1/direct_messages/show.json?id=%5Bnoted-dm-id%5D\" href=\"/redirect?url=https%3A%2F%2Fapi.twitter.com%2F1.1%2Fdirect_messages%2Fshow.json%3Fid%3D%255Bnoted-dm-id%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.twitter.com/1.1/direct_messages/show.json?id=%5Bnoted-dm-id%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNow delete the DM\u003c/li\u003e\n\u003cli\u003eRepeat the api call \n\u003ca title=\"https://api.twitter.com/1.1/direct_messages/show.json?id=578631102144741376\" href=\"/redirect?url=https%3A%2F%2Fapi.twitter.com%2F1.1%2Fdirect_messages%2Fshow.json%3Fid%3D578631102144741376\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.twitter.com/1.1/direct_messages/show.json?id=578631102144741376\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eYou will still have access to the deleted DM.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cem\u003ePOC: Check for video attached\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRegards,\u003cbr\u003e\nWesecureapp\u003c/strong\u003e\u003c/p\u003e\n","bounty_amount":"420.0","formatted_bounty":"$420","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":32465,"file_name":"twitterdm.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/465/54896055d620c8882a001e2bb1b57b8ec9c2dc00/twitterdm.mp4?response-content-disposition=attachment%3B%20filename%3D%22twitterdm.mp4%22%3B%20filename%2A%3DUTF-8%27%27twitterdm.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061456Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=17cfd02f86f2fe525df740d8b4ffde773dbed0aefef9d8a34fdf2ef917b9cef2","file_size":3243149,"type":"video/mp4"}],"allow_singular_disclosure_at":"2015-10-12T04:55:52.379Z","allow_singular_disclosure_after":-164596743.97920862,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","wargsec","nicky619"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":358892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PS: I even tried deleting the DM from both the accounts and even then i was successfully able to access the deleted DM\n","markdown_message":"\u003cp\u003ePS: I even tried deleting the DM from both the accounts and even then i was successfully able to access the deleted DM\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-19T20:46:15.099Z","updated_at":"2015-03-19T20:46:15.099Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":361143,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-23T20:20:57.595Z","updated_at":"2015-03-23T20:20:57.595Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":364812,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-27T20:41:59.813Z","updated_at":"2015-03-27T20:41:59.813Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"420.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"akhil-reni","url":"/akhil-reni"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":585795,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-11T23:21:31.568Z","updated_at":"2015-09-11T23:21:31.568Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"akhil-reni","url":"/akhil-reni"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":586023,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-12T04:55:52.127Z","updated_at":"2015-09-12T04:55:52.127Z","first_to_agree":true,"actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":617102,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-12T04:56:07.373Z","updated_at":"2015-10-12T04:56:07.373Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}