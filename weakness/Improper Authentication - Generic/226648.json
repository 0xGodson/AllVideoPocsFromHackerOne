{"id":226648,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjY2NDg=","url":"https://hackerone.com/reports/226648","title":"Unauthorized access to the slack channel via inside.gratipay.com/appendices/chat","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2017-05-06T22:47:32.498Z","submitted_at":"2017-05-06T22:47:32.498Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"7h0r4pp4n","url":"/7h0r4pp4n","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-09T13:41:58.518Z","bug_reporter_agreed_on_going_public_at":"2017-05-09T13:41:58.467Z","team_member_agreed_on_going_public_at":"2017-05-07T10:55:11.232Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\nIt is possible to force send invites for gratipay slack channel to arbitary email ids with no bruteforce limit. This is done by modifying the `coc` parameter to `1` in the POST data sent from https://inside.gratipay.com/appendices/chat\n\n# Description\nSending a post request with `coc` parameter set to `1` appears to be bypassing some validation that is being done in the server. Without the same, the server responds with `Woot. Check your email` to the requests. \n\n**Request**\n```\nPOST /invite HTTP/1.1\nHost: gratipay-slackin.herokuapp.com\nContent-Type: application/json\nContent-Length: 36\n\n{\"coc\":1,\"email\":\"dobum@alienware13.com\"}\n```\n\n**Response**\n```\nHTTP/1.1 400 Bad Request\nServer: Cowboy\nConnection: keep-alive\nX-Powered-By: Express\nContent-Type: application/json; charset=utf-8\nContent-Length: 93\nDate: Sat, 06 May 2017 22:33:39 GMT\nVia: 1.1 vegur\n\n{\"msg\":\"You have already been invited to Slack. Check for an email from feedback@slack.com.\"}\n```\n\nEven though the response is a `400 Bad Request`, an invite email is received from `\"Slack\" \u003cfeedback@slack.com\u003e` with the subject `Paul Kuruvilla has invited you to join a Slack team`.\nWhatever the validation may be, this allows invites to be forced sent to arbitary email ids with no brute force limit.\n\n# Steps To Reproduce\n * Send the post data with an arbitary email id\n * An invite to the gratipay slack channel `gratipay.slack.com` will be received at that email account \n\n# Supporting References:\n  * https://gratipay.slack.com/team/dobum","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eIt is possible to force send invites for gratipay slack channel to arbitary email ids with no bruteforce limit. This is done by modifying the \u003ccode\u003ecoc\u003c/code\u003e parameter to \u003ccode\u003e1\u003c/code\u003e in the POST data sent from \u003ca title=\"https://inside.gratipay.com/appendices/chat\" href=\"/redirect?url=https%3A%2F%2Finside.gratipay.com%2Fappendices%2Fchat\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://inside.gratipay.com/appendices/chat\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eSending a post request with \u003ccode\u003ecoc\u003c/code\u003e parameter set to \u003ccode\u003e1\u003c/code\u003e appears to be bypassing some validation that is being done in the server. Without the same, the server responds with \u003ccode\u003eWoot. Check your email\u003c/code\u003e to the requests. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /invite HTTP/1.1\nHost: gratipay-slackin.herokuapp.com\nContent-Type: application/json\nContent-Length: 36\n\n{\u0026quot;coc\u0026quot;:1,\u0026quot;email\u0026quot;:\u0026quot;dobum@alienware13.com\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 400 Bad Request\nServer: Cowboy\nConnection: keep-alive\nX-Powered-By: Express\nContent-Type: application/json; charset=utf-8\nContent-Length: 93\nDate: Sat, 06 May 2017 22:33:39 GMT\nVia: 1.1 vegur\n\n{\u0026quot;msg\u0026quot;:\u0026quot;You have already been invited to Slack. Check for an email from feedback@slack.com.\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEven though the response is a \u003ccode\u003e400 Bad Request\u003c/code\u003e, an invite email is received from \u003ccode\u003e\u0026quot;Slack\u0026quot; \u0026lt;feedback@slack.com\u0026gt;\u003c/code\u003e with the subject \u003ccode\u003ePaul Kuruvilla has invited you to join a Slack team\u003c/code\u003e.\u003cbr\u003e\nWhatever the validation may be, this allows invites to be forced sent to arbitary email ids with no brute force limit.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eSend the post data with an arbitary email id\u003c/li\u003e\n\u003cli\u003eAn invite to the gratipay slack channel \u003ccode\u003egratipay.slack.com\u003c/code\u003e will be received at that email account \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"supporting-references\"\u003eSupporting References:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://gratipay.slack.com/team/dobum\" href=\"/redirect?url=https%3A%2F%2Fgratipay.slack.com%2Fteam%2Fdobum\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.slack.com/team/dobum\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["spetr0x"],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1658543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\u003c/p\u003e\n\n\u003cp\u003ePlease expect additional feedback from us within the next couple of days. The \u0026quot;INFORMATION SECURITY\u0026quot; section of the following page has additional, useful information regarding our platform\u0026#39;s security: \u003ca title=\"http://inside.gratipay.com/howto/manage-risk\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fhowto%2Fmanage-risk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/howto/manage-risk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your interest in securing our platform and look forward to working with you.\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nThe Gratipay Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-05-06T22:47:32.656Z","updated_at":"2017-05-06T22:47:32.656Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, this request can be used for username enumeration as a valid email used in slack will return with an `HTTP 303`","markdown_message":"\u003cp\u003eAlso, this request can be used for username enumeration as a valid email used in slack will return with an \u003ccode\u003eHTTP 303\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T05:08:39.252Z","updated_at":"2017-05-07T05:08:39.252Z","actor":{"username":"7h0r4pp4n","cleared":false,"url":"/7h0r4pp4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @7h0r4pp4n,\n\nBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. Our Slack channel is open to everyone and can be viewed here: https://gratipay.slackarchive.io/gratipay/page-97\n\nIf you disagree, please reply with additional information describing your reasoning.\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/7h0r4pp4n\"\u003e@7h0r4pp4n\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. Our Slack channel is open to everyone and can be viewed here: \u003ca title=\"https://gratipay.slackarchive.io/gratipay/page-97\" href=\"/redirect?url=https%3A%2F%2Fgratipay.slackarchive.io%2Fgratipay%2Fpage-97\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.slackarchive.io/gratipay/page-97\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you disagree, please reply with additional information describing your reasoning.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T07:48:50.569Z","updated_at":"2017-05-07T07:48:50.569Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1658769,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-07T07:49:17.580Z","updated_at":"2017-05-07T07:49:17.580Z","additional_data":{"old_severity":"High (7.5)","new_severity":"None (0.0)","old_severity_id":40775,"new_severity_id":40807},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1658846,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright. This was my bad :)","markdown_message":"\u003cp\u003eAlright. This was my bad :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T10:32:25.469Z","updated_at":"2017-05-07T10:32:25.469Z","actor":{"username":"7h0r4pp4n","cleared":false,"url":"/7h0r4pp4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658865,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We look forward to more reports from you in the future.","markdown_message":"\u003cp\u003eWe look forward to more reports from you in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T10:54:57.357Z","updated_at":"2017-05-07T10:54:57.357Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1658866,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-07T10:55:11.246Z","updated_at":"2017-05-07T10:55:11.246Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1663166,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T13:41:58.490Z","updated_at":"2017-05-09T13:41:58.490Z","actor":{"username":"7h0r4pp4n","cleared":false,"url":"/7h0r4pp4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1663167,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T13:41:58.531Z","updated_at":"2017-05-09T13:41:58.531Z","actor":{"username":"7h0r4pp4n","cleared":false,"url":"/7h0r4pp4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}