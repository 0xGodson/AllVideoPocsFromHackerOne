{"id":145402,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU0MDI=","url":"https://hackerone.com/reports/145402","title":"No permission set on Activities [Android App]","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-17T13:50:03.526Z","submitted_at":"2016-06-17T13:50:03.526Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eavesdr0pp3r","url":"/eavesdr0pp3r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/UsBwY4EhwfGyPYM9HKU6LeuG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-20T15:10:52.170Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-06-20T15:09:31.681Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Android app version: 1.0.0\n\nIssue Details:\n-----------------\nThe following activities are exported and it does not have a permission set. \n\n1) com.owncloud.android.ui.activity.FileDisplayActivity\n2) com.owncloud.android.ui.activity.ReceiveExternalFilesActivity\n3) com.owncloud.android.authentication.AuthenticatorActivity\n4) com.owncloud.android.ui.activity.ShareActivity\n\nThis could allow any malicious application to initiate the above mentioned activities thus bypassing security checks or getting private information of any user.\n\nRecommendation:\n-------------------------\nSet the permission for the above mentioned activities or either set android:exported=false (which allows the activities to be launched by only components of the same app or the same uid)","vulnerability_information_html":"\u003cp\u003eAndroid app version: 1.0.0\u003c/p\u003e\n\n\u003ch2 id=\"issue-details\"\u003eIssue Details:\u003c/h2\u003e\n\n\u003cp\u003eThe following activities are exported and it does not have a permission set. \u003c/p\u003e\n\n\u003cp\u003e1) com.owncloud.android.ui.activity.FileDisplayActivity\u003cbr\u003e\n2) com.owncloud.android.ui.activity.ReceiveExternalFilesActivity\u003cbr\u003e\n3) com.owncloud.android.authentication.AuthenticatorActivity\u003cbr\u003e\n4) com.owncloud.android.ui.activity.ShareActivity\u003c/p\u003e\n\n\u003cp\u003eThis could allow any malicious application to initiate the above mentioned activities thus bypassing security checks or getting private information of any user.\u003c/p\u003e\n\n\u003ch2 id=\"recommendation\"\u003eRecommendation:\u003c/h2\u003e\n\n\u003cp\u003eSet the permission for the above mentioned activities or either set android:exported=false (which allows the activities to be launched by only components of the same app or the same uid)\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1019176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-17T13:50:03.713Z","updated_at":"2016-06-17T13:50:03.713Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019911,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Much appreciated!\n\nWe're considering this a non-issue at the moment because of the fact that an exploitation requires a malicious Android app already to be installed. As per https://nextcloud.com/security/threat-model/ we don't consider this part of our threat model for now.\n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re considering this a non-issue at the moment because of the fact that an exploitation requires a malicious Android app already to be installed. As per \u003ca title=\"https://nextcloud.com/security/threat-model/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/threat-model/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e we don\u0026#39;t consider this part of our threat model for now.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T19:08:04.597Z","updated_at":"2016-06-17T19:08:04.597Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your threat model says:\n\n    We do consider attacks involving other Android apps on the device as minimal risk.\n\nI agree the vulnerability requires a minimal user interaction but this vulnerability do have a high impact as it is able to bypass the login mechanism of the app and view the sensitive information of the victim's account.\n\nThis is where CSRF, open redirect and phishing attacks come which requires a user interaction and still considered a high risk.\n\nokay let's imagine an attack scenario here:\n\n* I have created an android app and embedded a malicious payload targeting nextcloud users.\n* Uploaded this app to the google play store.\n* If any nextcloud user downloads this app and install it in its device, the payload will get triggered.\n* The attacker gets all the sensitive info from the user's nextcloud account.\n\nSecond attack scenario:\n\n* Suppose the attacker steals the victim's mobile (Lost and mobile theft are common these days). \n* The attacker does not need the username and password for the nextcloud account. He can bypass the mechanism because the activities are exported and can view the files of the victim.\n\nMoreover, most of the android related issues require a malicious app to exploit it.\n\nIf you still think that this is not an issue at your side, then kindly publicly disclose the issue!\n\nThanks.\n","markdown_message":"\u003cp\u003eYour threat model says:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eWe do consider attacks involving other Android apps on the device as minimal risk.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI agree the vulnerability requires a minimal user interaction but this vulnerability do have a high impact as it is able to bypass the login mechanism of the app and view the sensitive information of the victim\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003eThis is where CSRF, open redirect and phishing attacks come which requires a user interaction and still considered a high risk.\u003c/p\u003e\n\n\u003cp\u003eokay let\u0026#39;s imagine an attack scenario here:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eI have created an android app and embedded a malicious payload targeting nextcloud users.\u003c/li\u003e\n\u003cli\u003eUploaded this app to the google play store.\u003c/li\u003e\n\u003cli\u003eIf any nextcloud user downloads this app and install it in its device, the payload will get triggered.\u003c/li\u003e\n\u003cli\u003eThe attacker gets all the sensitive info from the user\u0026#39;s nextcloud account.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSecond attack scenario:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSuppose the attacker steals the victim\u0026#39;s mobile (Lost and mobile theft are common these days). \u003c/li\u003e\n\u003cli\u003eThe attacker does not need the username and password for the nextcloud account. He can bypass the mechanism because the activities are exported and can view the files of the victim.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eMoreover, most of the android related issues require a malicious app to exploit it.\u003c/p\u003e\n\n\u003cp\u003eIf you still think that this is not an issue at your side, then kindly publicly disclose the issue!\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T08:12:50.753Z","updated_at":"2016-06-20T08:12:50.753Z","actor":{"username":"eavesdr0pp3r","cleared":true,"url":"/eavesdr0pp3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UsBwY4EhwfGyPYM9HKU6LeuG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024671,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks a lot for your further remarks, we do agree that the scope on this maybe hasn't been prominently enough displayed on the HackerOne page. We have updated this one here, so people don't need to read up on our dedicated security page for that.\n\nThe reason we're at the moment excluding malicious third-party applications is the fact that they require a very high level of user interaction to be installed and the architecture of our app is not properly protecting data in these cases.\n\nThe Nextcloud Android client can be used to download and upload files to your Nextcloud instance. At the moment files downloaded are simply stored in the public accessible data area of the Android phone. Thus any other app can access the data. There is work on-going for adding a Content Provider though. \n\nAlso, as soon as somebody has physical access to a device one can normally assume that an attacker is able to extract any data. Especially if they're anyways able to sideload arbitrary apps.\n\n\u003e If you still think that this is not an issue at your side, then kindly publicly disclose the issue!\n\nAbsolutely. We're happy to disclose any report.","markdown_message":"\u003cp\u003eThanks a lot for your further remarks, we do agree that the scope on this maybe hasn\u0026#39;t been prominently enough displayed on the HackerOne page. We have updated this one here, so people don\u0026#39;t need to read up on our dedicated security page for that.\u003c/p\u003e\n\n\u003cp\u003eThe reason we\u0026#39;re at the moment excluding malicious third-party applications is the fact that they require a very high level of user interaction to be installed and the architecture of our app is not properly protecting data in these cases.\u003c/p\u003e\n\n\u003cp\u003eThe Nextcloud Android client can be used to download and upload files to your Nextcloud instance. At the moment files downloaded are simply stored in the public accessible data area of the Android phone. Thus any other app can access the data. There is work on-going for adding a Content Provider though. \u003c/p\u003e\n\n\u003cp\u003eAlso, as soon as somebody has physical access to a device one can normally assume that an attacker is able to extract any data. Especially if they\u0026#39;re anyways able to sideload arbitrary apps.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf you still think that this is not an issue at your side, then kindly publicly disclose the issue!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAbsolutely. We\u0026#39;re happy to disclose any report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:09:31.750Z","updated_at":"2016-06-20T15:10:05.246Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024676,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Disclosed on request of the reporter.","markdown_message":"\u003cp\u003eDisclosed on request of the reporter.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-20T15:10:28.973Z","updated_at":"2016-06-20T15:10:28.973Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}