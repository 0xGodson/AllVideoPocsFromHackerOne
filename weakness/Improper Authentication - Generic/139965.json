{"id":139965,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzk5NjU=","url":"https://hackerone.com/reports/139965","title":"No authentication required to add an email address.","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-05-20T15:49:07.688Z","submitted_at":"2016-05-20T15:49:07.688Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"apok","url":"/apok","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-27T00:55:50.533Z","bug_reporter_agreed_on_going_public_at":"2016-05-26T23:44:40.308Z","team_member_agreed_on_going_public_at":"2016-05-27T00:55:39.911Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\nI hope this mongoose I'm sending will help make phabricator safer.\n\nDescription:\n==========\nThe issue in question, is that whenever you add a new email address to your account, no additional authentication is required. Furthermore, when the account has 2FA enabled, it's not necessary to enter high security mode when adding a new email address (But it is necessary to authenticate and login).\n\nOf course a malicious individual would have to have access to an open account or hijack the session cookie. But since the session cookies have a long expiration period, it makes this attack more plausible. Specially considering that most people don't logout of their accounts when they are done using them, they just close the tab/browser.\n\nImpact:\n=======\nA malicious individual with access to an account, can add and validate an email address which can later on be used to get a one time login link and change the user password, thus compromising the account completely.\n\nRecommendation:\n===============\nEnforce asking the user for the account password prior to adding the new email address. In addition, if 2FA is active on the account, require high security mode to add a new email address.\n\nI'm attaching screenshots of a step by step.\nKind Regards,\nAlex.","vulnerability_information_html":"\u003cp\u003eHi Team,\u003cbr\u003e\nI hope this mongoose I\u0026#39;m sending will help make phabricator safer.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription:\u003c/h1\u003e\n\n\u003cp\u003eThe issue in question, is that whenever you add a new email address to your account, no additional authentication is required. Furthermore, when the account has 2FA enabled, it\u0026#39;s not necessary to enter high security mode when adding a new email address (But it is necessary to authenticate and login).\u003c/p\u003e\n\n\u003cp\u003eOf course a malicious individual would have to have access to an open account or hijack the session cookie. But since the session cookies have a long expiration period, it makes this attack more plausible. Specially considering that most people don\u0026#39;t logout of their accounts when they are done using them, they just close the tab/browser.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact:\u003c/h1\u003e\n\n\u003cp\u003eA malicious individual with access to an account, can add and validate an email address which can later on be used to get a one time login link and change the user password, thus compromising the account completely.\u003c/p\u003e\n\n\u003ch1 id=\"recommendation\"\u003eRecommendation:\u003c/h1\u003e\n\n\u003cp\u003eEnforce asking the user for the account password prior to adding the new email address. In addition, if 2FA is active on the account, require high security mode to add a new email address.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m attaching screenshots of a step by step.\u003cbr\u003e\nKind Regards,\u003cbr\u003e\nAlex.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94900,"file_name":"No_authentication_required_to_add_email_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/900/87162775ae38440f006875ff0d18449201e588ac/No_authentication_required_to_add_email_1.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_1.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=2110c4ccc47481504df35d06a2341c5dcda1064fb006c04775955a4bfdcfc65d","file_size":20215,"type":"image/png"},{"id":94901,"file_name":"No_authentication_required_to_add_email_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/901/5620553ab822c3ffa02c967a528948e29462c81a/No_authentication_required_to_add_email_2.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_2.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=c61fc3f8ce9016914f9b5f47438e141f332ee573dee75661969713eab2eb5202","file_size":19777,"type":"image/png"},{"id":94902,"file_name":"No_authentication_required_to_add_email_3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/902/c285ca9b7524a59bb82c846d998c5c2647a1451c/No_authentication_required_to_add_email_3.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_3.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=7a6163223805cb059870c1890978b8472c11cfd3cd2b982c5f1962c4ab7561d8","file_size":22203,"type":"image/png"},{"id":94903,"file_name":"No_authentication_required_to_add_email_4.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/903/d2d540b075ef9dfcdac83c63c15d6e86b0e24426/No_authentication_required_to_add_email_4.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_4.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_4.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=668c271c510cb99584089752b33b86433beb4edf4fd90f5fb8ca8e67e750df72","file_size":13685,"type":"image/png"},{"id":94904,"file_name":"No_authentication_required_to_add_email_5.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/904/9994fe4eff408f463b67e7200d7ad40715a19266/No_authentication_required_to_add_email_5.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_5.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_5.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=6d4aef3dda1feb823731ba58144d8e9511be69acc8d4bb5ae7da5ec68bd91242","file_size":13552,"type":"image/png"},{"id":94905,"file_name":"No_authentication_required_to_add_email_6.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/905/cf590dd2953d80293aae9429746e9adbc1f136c7/No_authentication_required_to_add_email_6.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_6.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_6.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=d2a7d2f3ba7cbd6f04d451c37ff17abc174f1660161d4cffcbcb731efc83647a","file_size":15669,"type":"image/png"},{"id":94906,"file_name":"No_authentication_required_to_add_email_7.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/906/293944a7d337e0b15d2fa5a821e7e5bfe846d91a/No_authentication_required_to_add_email_7.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_7.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_7.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=5e9586f966a32ac2e2d1326ac8b002e53b51851da457c1f96db53bf3ffcce2e5","file_size":12624,"type":"image/png"},{"id":94907,"file_name":"No_authentication_required_to_add_email_8.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/907/2145c65df42d6afa250d27c2815ea98444256f9d/No_authentication_required_to_add_email_8.png?response-content-disposition=attachment%3B%20filename%3D%22No_authentication_required_to_add_email_8.png%22%3B%20filename%2A%3DUTF-8%27%27No_authentication_required_to_add_email_8.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=2c52e9c41d853eca193d194d57e3ad26fa5b3ba021e3b62fe068a1c351af2766","file_size":21932,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":966585,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can't reproduce this: between steps 7 and 8, I must provide an MFA token to establish the new session.\n\nHere's what I did:\n\n  - In a new logged-out browser, send myself a password reset email. (\"Try to gain access to the account later as the attacker.\")\n  - Follow that link while logged out.\n  - I get the \"confirm login\" screen (login_1.png).\n  - I click \"Login as admin\".\n  - I get prompted for MFA (login_2.png).\n\nDo you know what I'm doing differently than you?\n\nIt's intentional that we don't prompt for MFA when adding an address because I believe it doesn't meaningfully support any attack. (We do require MFA to make an address a primary address, because this does support attacks, and require MFA to login.)\n\nI've generally been hesitant to add MFA when there's no specific threat because I don't want users to hesitate to add (or stop using) MFA because it's annoying them too often. At an extreme, prompting for MFA on every possible action would be \"more secure\" in some sense, but no one would use it, so users would be less secure on the balance.\n\nI think this is a probably a case where I was more cautious than necessarily when implementing the feature originally, and we could reasonably harden it today. We haven't seen much feedback about MFA being frustrating, and this operation (changing email addresses) is rare and an extra MFA prompt here is unlikely to cause much frustration. But I don't *think* it allows any material attack extension or MFA bypass, unless I'm misunderstanding the attack flow.","markdown_message":"\u003cp\u003eI can\u0026#39;t reproduce this: between steps 7 and 8, I must provide an MFA token to establish the new session.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s what I did:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIn a new logged-out browser, send myself a password reset email. (\u0026quot;Try to gain access to the account later as the attacker.\u0026quot;)\u003c/li\u003e\n\u003cli\u003eFollow that link while logged out.\u003c/li\u003e\n\u003cli\u003eI get the \u0026quot;confirm login\u0026quot; screen (login_1.png).\u003c/li\u003e\n\u003cli\u003eI click \u0026quot;Login as admin\u0026quot;.\u003c/li\u003e\n\u003cli\u003eI get prompted for MFA (login_2.png).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eDo you know what I\u0026#39;m doing differently than you?\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s intentional that we don\u0026#39;t prompt for MFA when adding an address because I believe it doesn\u0026#39;t meaningfully support any attack. (We do require MFA to make an address a primary address, because this does support attacks, and require MFA to login.)\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve generally been hesitant to add MFA when there\u0026#39;s no specific threat because I don\u0026#39;t want users to hesitate to add (or stop using) MFA because it\u0026#39;s annoying them too often. At an extreme, prompting for MFA on every possible action would be \u0026quot;more secure\u0026quot; in some sense, but no one would use it, so users would be less secure on the balance.\u003c/p\u003e\n\n\u003cp\u003eI think this is a probably a case where I was more cautious than necessarily when implementing the feature originally, and we could reasonably harden it today. We haven\u0026#39;t seen much feedback about MFA being frustrating, and this operation (changing email addresses) is rare and an extra MFA prompt here is unlikely to cause much frustration. But I don\u0026#39;t \u003cem\u003ethink\u003c/em\u003e it allows any material attack extension or MFA bypass, unless I\u0026#39;m misunderstanding the attack flow.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:12:04.184Z","updated_at":"2016-05-20T16:12:04.184Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":94914,"filename":"login_2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/914/1889357653d268fd44213ce181a242176d67c26f/login_2.png?response-content-disposition=attachment%3B%20filename%3D%22login_2.png%22%3B%20filename%2A%3DUTF-8%27%27login_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=d50556980b60e0db571926ef320b9f13c9169fa3bb6946e9fb6fae27571eacf6"},{"id":94913,"filename":"login_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/913/9f03a4fb0213c280ad21a87eb6a4489d725e7974/login_1.png?response-content-disposition=attachment%3B%20filename%3D%22login_1.png%22%3B%20filename%2A%3DUTF-8%27%27login_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042749Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=d7985b0bef371791c55e5c231587c0a6d9cc84b267d228904e14e89640668fb1"}],"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":966592,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nI'm sorry I must have confused you with that whole \"MFA\" thing. The attack happens when MFA is disabled, if MFA is enabled, then it's necessary to introduce the token as you said.","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nI\u0026#39;m sorry I must have confused you with that whole \u0026quot;MFA\u0026quot; thing. The attack happens when MFA is disabled, if MFA is enabled, then it\u0026#39;s necessary to introduce the token as you said.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:14:58.395Z","updated_at":"2016-05-20T16:14:58.395Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":966622,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Ah, okay.\n\nSo, we don't prompt for MFA here because we prompt for MFA on login anyway, and I historically wanted to limit the risk of users becoming fatigued with MFA prompts.\n\nWe never prompt for a password as a \"pseudo-MFA\" check because almost no accounts in the wild have one. Almost every install uses OAuth or LDAP or another non-password credential, so using passwords as a sort of \"soft MFA\" would protect very few accounts. If we did want to do this, I'd likely just add a \"password\" MFA type, but this has always seemed sort of silly since you can just add real TOTP MFA if you're doing this anyway. (And passwords are often saved in password managers, which an attacker who already has access to a session may also have access to, by merit of having gained session access by physically stealing or otherwise physically compromising a laptop in the first place).\n\nPractically, if you're concerned about this attack you should configure MFA (which provides real protection) and if you configure MFA you should configure proper TOTP MFA (which provides better protection than a password would, since a password is barely a second factor).\n\nOverall, this is working as intended because we don't treat passwords as \"pseudo-MFA\", by design. Few users would be protected and it's poor protection compared to TOTP MFA. I'll file a task to add MFA gates to all email address operations because I think the benefits outweighs the risk of fatigue given that we now have a better understanding that users don't currently feel fatigued by MFA prompts, but I don't think this addresses any concrete risk, and don't currently plan to implement psuedo-MFA password re-prompts.","markdown_message":"\u003cp\u003eAh, okay.\u003c/p\u003e\n\n\u003cp\u003eSo, we don\u0026#39;t prompt for MFA here because we prompt for MFA on login anyway, and I historically wanted to limit the risk of users becoming fatigued with MFA prompts.\u003c/p\u003e\n\n\u003cp\u003eWe never prompt for a password as a \u0026quot;pseudo-MFA\u0026quot; check because almost no accounts in the wild have one. Almost every install uses OAuth or LDAP or another non-password credential, so using passwords as a sort of \u0026quot;soft MFA\u0026quot; would protect very few accounts. If we did want to do this, I\u0026#39;d likely just add a \u0026quot;password\u0026quot; MFA type, but this has always seemed sort of silly since you can just add real TOTP MFA if you\u0026#39;re doing this anyway. (And passwords are often saved in password managers, which an attacker who already has access to a session may also have access to, by merit of having gained session access by physically stealing or otherwise physically compromising a laptop in the first place).\u003c/p\u003e\n\n\u003cp\u003ePractically, if you\u0026#39;re concerned about this attack you should configure MFA (which provides real protection) and if you configure MFA you should configure proper TOTP MFA (which provides better protection than a password would, since a password is barely a second factor).\u003c/p\u003e\n\n\u003cp\u003eOverall, this is working as intended because we don\u0026#39;t treat passwords as \u0026quot;pseudo-MFA\u0026quot;, by design. Few users would be protected and it\u0026#39;s poor protection compared to TOTP MFA. I\u0026#39;ll file a task to add MFA gates to all email address operations because I think the benefits outweighs the risk of fatigue given that we now have a better understanding that users don\u0026#39;t currently feel fatigued by MFA prompts, but I don\u0026#39;t think this addresses any concrete risk, and don\u0026#39;t currently plan to implement psuedo-MFA password re-prompts.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:43:05.358Z","updated_at":"2016-05-20T16:43:05.358Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":966632,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the upstream followup, which almost got a cool task number:\n\nhttps://secure.phabricator.com/T10999","markdown_message":"\u003cp\u003eHere\u0026#39;s the upstream followup, which almost got a cool task number:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/T10999\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT10999\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T10999\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:49:18.379Z","updated_at":"2016-05-20T16:49:18.379Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":966634,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, if passwords aren't used at all on live scenarios, then I guess I agree, it is though a good practice to authenticate the user prior to making significant account changes. \nThis is also an instance of https://cwe.mitre.org/data/definitions/620.html (Unverified password change), since the behaviour that changes the password, asks for the old one. This way we could bypass that. Again, provided MFA is disabled. ","markdown_message":"\u003cp\u003eWell, if passwords aren\u0026#39;t used at all on live scenarios, then I guess I agree, it is though a good practice to authenticate the user prior to making significant account changes. \u003cbr\u003e\nThis is also an instance of \u003ca title=\"https://cwe.mitre.org/data/definitions/620.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F620.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/620.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (Unverified password change), since the behaviour that changes the password, asks for the old one. This way we could bypass that. Again, provided MFA is disabled. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:50:31.490Z","updated_at":"2016-05-20T16:50:31.490Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":966646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, I love that you have a fast response time. The thing I hate the most about h1 is that they take forever to answer things.","markdown_message":"\u003cp\u003eBtw, I love that you have a fast response time. The thing I hate the most about h1 is that they take forever to answer things.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:53:38.210Z","updated_at":"2016-05-20T16:53:38.210Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":966653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HackerOne is rolling out some new stats for projects that show response times. Ours look pretty good for now -- I have no idea how the math on this works out, pretty sure I'm not *that* fast (stats.png).\n\nThe \"mongoose\" check is also like 98% effective in filtering out the garbage reports from people who didn't read the description, everyone that actually reads it is almost always submitting good stuff.","markdown_message":"\u003cp\u003eHackerOne is rolling out some new stats for projects that show response times. Ours look pretty good for now -- I have no idea how the math on this works out, pretty sure I\u0026#39;m not \u003cem\u003ethat\u003c/em\u003e fast (stats.png).\u003c/p\u003e\n\n\u003cp\u003eThe \u0026quot;mongoose\u0026quot; check is also like 98% effective in filtering out the garbage reports from people who didn\u0026#39;t read the description, everyone that actually reads it is almost always submitting good stuff.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:58:05.068Z","updated_at":"2016-05-20T16:58:05.068Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":94916,"filename":"stats.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/916/76fc4a0454f72673d6ce309b09f55a123ed2518a/stats.png?response-content-disposition=attachment%3B%20filename%3D%22stats.png%22%3B%20filename%2A%3DUTF-8%27%27stats.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042750Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=2e5ca477444e4020b0984b9b310249b5df2aa1c3a8896c1a49a13bd1c8322b22"}],"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":966662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, that's a great feature. Anyways, I'm running a scan with some custom rules on the code while I do the manual testing, so hopefully I'm gonna have some more juicy findings soon.\nThanks!","markdown_message":"\u003cp\u003eYes, that\u0026#39;s a great feature. Anyways, I\u0026#39;m running a scan with some custom rules on the code while I do the manual testing, so hopefully I\u0026#39;m gonna have some more juicy findings soon.\u003cbr\u003e\nThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-20T16:59:51.129Z","updated_at":"2016-05-20T16:59:51.129Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":986243,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey, do you mind if we disclose?","markdown_message":"\u003cp\u003eHey, do you mind if we disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-26T23:44:40.336Z","updated_at":"2016-05-26T23:44:40.336Z","first_to_agree":true,"actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":986339,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T00:55:39.937Z","updated_at":"2016-05-27T00:55:39.937Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":986340,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T00:55:50.555Z","updated_at":"2016-05-27T00:55:50.555Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}