{"id":202177,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDIxNzc=","url":"https://hackerone.com/reports/202177","title":"Login with Google Not Authenticated on iOS App","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-30T17:31:17.674Z","submitted_at":"2017-01-30T17:31:17.674Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bhavukjain1","url":"/bhavukjain1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-21T07:20:06.866Z","bug_reporter_agreed_on_going_public_at":"2017-04-21T07:20:03.749Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":" In your iOS application, there is Login with Google. In this, you're not authenticating a user properly and it can lead to access to user accounts.\n\nAffected API:\nhttps://www.instacart.com/api/v2/users/google_login_auth\n\nIn this request, these are the parameters: access_token, client_id,id_token, login_only, read_terms.\n\nIn the parameter: id_token, you're passing the token generated by Google user authentication. But the token generated is not properly authenticated at your backend. You're not authenticating if the token is generated by your app or not.\nFor example, I logged in with the app Meetup via login with Google. The id_token generated by Google for this app, when used with your /google_login_auth API, it's still get accepted.\n\nThis means ​an app like Meetup can access the user accounts of your users using the id_token generated by Meetup. This can compromise your user's accounts.\n\nThe proper way of authenticating the user is mentioned here:\nhttps://developers.google.com/identity/sign-in/web/backend-auth#verify-the-integrity-of-the-id-token\n","vulnerability_information_html":"\u003cp\u003eIn your iOS application, there is Login with Google. In this, you\u0026#39;re not authenticating a user properly and it can lead to access to user accounts.\u003c/p\u003e\n\n\u003cp\u003eAffected API:\u003cbr\u003e\n\u003ca title=\"https://www.instacart.com/api/v2/users/google_login_auth\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fapi%2Fv2%2Fusers%2Fgoogle_login_auth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/api/v2/users/google_login_auth\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn this request, these are the parameters: access_token, client_id,id_token, login_only, read_terms.\u003c/p\u003e\n\n\u003cp\u003eIn the parameter: id_token, you\u0026#39;re passing the token generated by Google user authentication. But the token generated is not properly authenticated at your backend. You\u0026#39;re not authenticating if the token is generated by your app or not.\u003cbr\u003e\nFor example, I logged in with the app Meetup via login with Google. The id_token generated by Google for this app, when used with your /google_login_auth API, it\u0026#39;s still get accepted.\u003c/p\u003e\n\n\u003cp\u003eThis means ​an app like Meetup can access the user accounts of your users using the id_token generated by Meetup. This can compromise your user\u0026#39;s accounts.\u003c/p\u003e\n\n\u003cp\u003eThe proper way of authenticating the user is mentioned here:\u003cbr\u003e\n\u003ca title=\"https://developers.google.com/identity/sign-in/web/backend-auth#verify-the-integrity-of-the-id-token\" href=\"/redirect?url=https%3A%2F%2Fdevelopers.google.com%2Fidentity%2Fsign-in%2Fweb%2Fbackend-auth%23verify-the-integrity-of-the-id-token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developers.google.com/identity/sign-in/web/backend-auth#verify-the-integrity-of-the-id-token\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-21T07:20:03.790Z","allow_singular_disclosure_after":-113866421.26665139,"singular_disclosure_allowed":true,"vote_count":9,"voters":["eveeez","ronygigi","b3nac","na5ne3t","japz","sayaanalam","spetr0x","clarckowen_","anand_jons"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1465973,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @bhavukjain1,\n\nThank you for the report. This should now be resolved, can you confirm?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bhavukjain1\"\u003e@bhavukjain1\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. This should now be resolved, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-06T18:23:10.878Z","updated_at":"2017-02-06T18:23:10.878Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bhavukjain1","url":"/bhavukjain1"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1465977,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-06T18:23:17.244Z","updated_at":"2017-02-06T18:23:17.244Z","additional_data":{"old_severity":"Critical","new_severity":"Low","old_severity_id":22486,"new_severity_id":23843},"actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1466324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes! It is resolved.","markdown_message":"\u003cp\u003eYes! It is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-06T19:30:12.103Z","updated_at":"2017-02-06T19:30:12.103Z","actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1486369,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Does this report qualify for bug bounty?","markdown_message":"\u003cp\u003eHi. Does this report qualify for bug bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-15T05:20:55.549Z","updated_at":"2017-02-15T05:20:55.549Z","actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517056,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"I've not been awarded bounty and it has been almost a month, the issue was resolved. No response from the team as well.","markdown_message":"\u003cp\u003eI\u0026#39;ve not been awarded bounty and it has been almost a month, the issue was resolved. No response from the team as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-03T09:18:23.405Z","updated_at":"2017-03-03T09:18:23.405Z","actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612583,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-14T23:35:00.723Z","updated_at":"2017-04-14T23:35:00.723Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"bhavukjain1","url":"/bhavukjain1"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1625638,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-21T07:20:03.763Z","updated_at":"2017-04-21T07:20:03.763Z","first_to_agree":true,"actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1689542,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-21T07:20:06.889Z","updated_at":"2017-05-21T07:20:06.889Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}