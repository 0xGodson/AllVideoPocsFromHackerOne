{"id":176116,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzYxMTY=","url":"https://hackerone.com/reports/176116","title":"Weak Forgot Password implementation","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-16T09:36:26.873Z","submitted_at":"2016-10-16T09:36:26.873Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pavanw3b","url":"/pavanw3b","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2367,"url":"https://hackerone.com/revive_adserver","handle":"revive_adserver","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Revive Adserver","twitter_handle":"revive_adserver","website":"https://www.revive-adserver.com","about":"Revive Adserver is a free open source ad serving system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-02T05:58:25.063Z","bug_reporter_agreed_on_going_public_at":"2017-07-03T05:58:11.309Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**\"Cricetinae\"** :)\n\n###Short Description\nThe Forgot Password is missing a several industry best practices. I strongly believe due to the level of the access given after a successful exploitation, the implementation could have been better.\n\n###Vulnerability Details\nReferring to OWASP Standards and guidelines [https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet], I see the following risks in the Forgot Password implementation:\n* Invalidate or provide an option to invalidate existing sessions after password has been reset\n* Invalidate the current session and redirect to login after successful password reset.\n\nAlso consider:\n* Do not allow the old the password as the new one.\n* Provide an option to set up Security Questions for admin accounts.\n\nI'm not sure about the above two points as they sound more like features rather than bugs.\n\n### Steps to Reproduce\n* Login as a admin on **Browser A** \u0026 keep it.\n* Open **Browser B** (or incognito/private). Go to Password Recovery page by clicking `Forgot your password?` from the login page.\n* Note the `sessionID` cookie. Enter the email address and `Proceed \u003e`.\n* Open the reset link received by email on **Browser B**. Note that the `sessionID` remained the same. Change the password. Note that the user have logged to dashboard without invalidating the current session and the `sessionID` remained the same.\n* Come back to **Browser A** and note that the user session is still valid.\n\n### Attack vector\n* **Invalidating other existing session:** The `sessionID` cookie which drives everything about user accounts, is set to expire on `Session` which means until the user explicitly clicks the `Logout` or the browser/tab is closed. Thus if an attacker some how (phishing or brute force) compromised an user account, the hacked session remained the same even though the account owner resets the password or change the email address.\n* **Invalidating the current session after the password recovery:** Attacker with physical access to the user's computer, leaves the Revive Adserver login page open by noting down the `sessionID`. User comes, resets the password and logged in. As the attacker knows the `sessionID`, he can use that in logging in as the user. This works even the attacker not having admin access on the system to install a keylogger and valid until the user logs out and the session is destroyed.\n\n### Test Environment Details\nVersion: Latest as on Oct 16: revive-adserver-4.0.0 downloaded from the official source\nSetup type: local\nBrowser: Firefox 47.0\nOS: Mac OS X\n\n\nCheers,\nPavan\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003e\u0026quot;Cricetinae\u0026quot;\u003c/strong\u003e :)\u003c/p\u003e\n\n\u003ch3 id=\"short-description\"\u003eShort Description\u003c/h3\u003e\n\n\u003cp\u003eThe Forgot Password is missing a several industry best practices. I strongly believe due to the level of the access given after a successful exploitation, the implementation could have been better.\u003c/p\u003e\n\n\u003ch3 id=\"vulnerability-details\"\u003eVulnerability Details\u003c/h3\u003e\n\n\u003cp\u003eReferring to OWASP Standards and guidelines [\u003ca title=\"https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FForgot_Password_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e], I see the following risks in the Forgot Password implementation:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eInvalidate or provide an option to invalidate existing sessions after password has been reset\u003c/li\u003e\n\u003cli\u003eInvalidate the current session and redirect to login after successful password reset.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlso consider:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eDo not allow the old the password as the new one.\u003c/li\u003e\n\u003cli\u003eProvide an option to set up Security Questions for admin accounts.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI\u0026#39;m not sure about the above two points as they sound more like features rather than bugs.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eLogin as a admin on \u003cstrong\u003eBrowser A\u003c/strong\u003e \u0026amp; keep it.\u003c/li\u003e\n\u003cli\u003eOpen \u003cstrong\u003eBrowser B\u003c/strong\u003e (or incognito/private). Go to Password Recovery page by clicking \u003ccode\u003eForgot your password?\u003c/code\u003e from the login page.\u003c/li\u003e\n\u003cli\u003eNote the \u003ccode\u003esessionID\u003c/code\u003e cookie. Enter the email address and \u003ccode\u003eProceed \u0026gt;\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eOpen the reset link received by email on \u003cstrong\u003eBrowser B\u003c/strong\u003e. Note that the \u003ccode\u003esessionID\u003c/code\u003e remained the same. Change the password. Note that the user have logged to dashboard without invalidating the current session and the \u003ccode\u003esessionID\u003c/code\u003e remained the same.\u003c/li\u003e\n\u003cli\u003eCome back to \u003cstrong\u003eBrowser A\u003c/strong\u003e and note that the user session is still valid.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"attack-vector\"\u003eAttack vector\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003eInvalidating other existing session:\u003c/strong\u003e The \u003ccode\u003esessionID\u003c/code\u003e cookie which drives everything about user accounts, is set to expire on \u003ccode\u003eSession\u003c/code\u003e which means until the user explicitly clicks the \u003ccode\u003eLogout\u003c/code\u003e or the browser/tab is closed. Thus if an attacker some how (phishing or brute force) compromised an user account, the hacked session remained the same even though the account owner resets the password or change the email address.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eInvalidating the current session after the password recovery:\u003c/strong\u003e Attacker with physical access to the user\u0026#39;s computer, leaves the Revive Adserver login page open by noting down the \u003ccode\u003esessionID\u003c/code\u003e. User comes, resets the password and logged in. As the attacker knows the \u003ccode\u003esessionID\u003c/code\u003e, he can use that in logging in as the user. This works even the attacker not having admin access on the system to install a keylogger and valid until the user logs out and the session is destroyed.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"test-environment-details\"\u003eTest Environment Details\u003c/h3\u003e\n\n\u003cp\u003eVersion: Latest as on Oct 16: revive-adserver-4.0.0 downloaded from the official source\u003cbr\u003e\nSetup type: local\u003cbr\u003e\nBrowser: Firefox 47.0\u003cbr\u003e\nOS: Mac OS X\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nPavan\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-02T05:58:11.363Z","allow_singular_disclosure_after":-107563502.17401962,"singular_disclosure_allowed":true,"vote_count":11,"voters":["eveeez","realtess","zerodaykb","pavanw3b","japz","sumit7","spetr0x","clarckowen_","jeyaram95","anonymous26","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1252592,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report. We'll look into it.","markdown_message":"\u003cp\u003eThanks for your report. We\u0026#39;ll look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-18T08:28:20.053Z","updated_at":"2016-10-18T08:28:20.053Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1266314,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. The attached patch will ensure the session ID is regenerated after a successful password recovery/change.","markdown_message":"\u003cp\u003eThanks for the report. The attached patch will ensure the session ID is regenerated after a successful password recovery/change.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-25T09:32:27.474Z","updated_at":"2016-10-25T09:32:27.474Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":130059,"filename":"h1-176116.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/130/059/989786568e0a6385a09c1b9d7317342074272141/h1-176116.patch?response-content-disposition=attachment%3B%20filename%3D%22h1-176116.patch%22%3B%20filename%2A%3DUTF-8%27%27h1-176116.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044313Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=bc79c846d2f39b9f4be0f1f73d105c732f37bce011c7233a0e86ba607f927949"}],"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1356841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mbeccati any update about closing this report?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mbeccati\"\u003e@mbeccati\u003c/a\u003e any update about closing this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-11T07:31:20.334Z","updated_at":"2016-12-11T07:31:20.334Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1388643,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Will be part of the 4.0.1 release (Jan 18th). Thanks again","markdown_message":"\u003cp\u003eWill be part of the 4.0.1 release (Jan 18th). Thanks again\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-28T08:29:44.436Z","updated_at":"2016-12-28T08:29:44.436Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pavanw3b","url":"/pavanw3b"},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1453692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Resolved in 4.0.1. Security advisory published: https://www.revive-adserver.com/security/revive-sa-2017-001/ and sent to bugtraq and fulldisclosure.\n\n██████████","markdown_message":"\u003cp\u003eResolved in 4.0.1. Security advisory published: \u003ca title=\"https://www.revive-adserver.com/security/revive-sa-2017-001/\" href=\"/redirect?url=https%3A%2F%2Fwww.revive-adserver.com%2Fsecurity%2Frevive-sa-2017-001%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.revive-adserver.com/security/revive-sa-2017-001/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and sent to bugtraq and fulldisclosure.\u003c/p\u003e\n\n\u003cp\u003e██████████\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-31T10:12:41.247Z","updated_at":"2017-07-26T06:48:47.518Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1798382,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T05:58:11.336Z","updated_at":"2017-07-03T05:58:11.336Z","first_to_agree":true,"actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1884465,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-02T05:58:25.082Z","updated_at":"2017-08-02T05:58:25.082Z","actor":{"url":"/revive_adserver","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Revive Adserver"}},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}