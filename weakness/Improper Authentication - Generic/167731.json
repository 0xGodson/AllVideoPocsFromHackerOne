{"id":167731,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjc3MzE=","url":"https://hackerone.com/reports/167731","title":"Make victim buy in attacker's account without any idea - http://www.booztlet.com/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-12T09:35:59.822Z","submitted_at":"2016-09-12T09:35:59.822Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1453,"url":"https://hackerone.com/boozt","handle":"boozt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Boozt Fashion AB","twitter_handle":"","website":"http://www.boozt.com","about":"E-Commerce shop"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-31T18:38:40.049Z","bug_reporter_agreed_on_going_public_at":"2016-10-31T15:52:14.718Z","team_member_agreed_on_going_public_at":"2016-10-31T18:38:40.008Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"INTRODUCTION\n------------------------\nDuring the testing of http://www.booztlet.com/ I have noticed that the account related links available from https://www.boozt.com/ are also available in http://www.booztlet.com/. This should not be the case, as this shop doesn't have a \"My account\" section.\n\nATTACK\n-------------\n1. The attacker creates a new account in http://www.booztlet.com/ by using the link https://www.booztlet.com/se/sv/customer/create \n2. The attacker creates a page with the contents from playground.html and uploads it somewhere\n3. The target recieved the playground.html link. Here he will be automatically logged in the http://www.booztlet.com/ in the attacker's account and then redirected to the start page. Both steps can be done, because the \"OK\" answer recieved after login from http://www.booztlet.com/ will be as attachement in plain text and the victim is not redirected somewhere else, thus allowing the attacker to execute a second step.\n4. The victim has no idea he is logged in another account and makes a purchase.\n5. From this point on I couldn't test forward because that would involve in actually making a real order.\n\nWHY IS THIS EXPLOITABLE\n-----------------\nSo, as mentioned in step 5, I couldn't test it forward and I am assuming here. After the victim makes the order, the attacked has access to the real order from \"my orders\" link (https://www.booztlet.com/se/sv/customer/orders). From here he may see a lot of sensitive information, such as payment method, address and so on. He could, maybe, contact support to change the delivery address as he has access to all the real data. The attacked can also probably see the telephone number (and call the victim pretending to be an admin from the shop) or maybe even access parts of the payment method (probably nothing real sensitive).\n\nHOW TO FIX IT\n-----------------\nDisable the login and register process as clearly this is not intended for https://www.booztlet.com.\n","vulnerability_information_html":"\u003ch2 id=\"introduction\"\u003eINTRODUCTION\u003c/h2\u003e\n\n\u003cp\u003eDuring the testing of \u003ca title=\"http://www.booztlet.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.booztlet.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.booztlet.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e I have noticed that the account related links available from \u003ca title=\"https://www.boozt.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.boozt.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.boozt.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e are also available in \u003ca title=\"http://www.booztlet.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.booztlet.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.booztlet.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This should not be the case, as this shop doesn\u0026#39;t have a \u0026quot;My account\u0026quot; section.\u003c/p\u003e\n\n\u003ch2 id=\"attack\"\u003eATTACK\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eThe attacker creates a new account in \u003ca title=\"http://www.booztlet.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.booztlet.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.booztlet.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e by using the link \u003ca title=\"https://www.booztlet.com/se/sv/customer/create\" href=\"/redirect?url=https%3A%2F%2Fwww.booztlet.com%2Fse%2Fsv%2Fcustomer%2Fcreate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.booztlet.com/se/sv/customer/create\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003eThe attacker creates a page with the contents from playground.html and uploads it somewhere\u003c/li\u003e\n\u003cli\u003eThe target recieved the playground.html link. Here he will be automatically logged in the \u003ca title=\"http://www.booztlet.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.booztlet.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.booztlet.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in the attacker\u0026#39;s account and then redirected to the start page. Both steps can be done, because the \u0026quot;OK\u0026quot; answer recieved after login from \u003ca title=\"http://www.booztlet.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.booztlet.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.booztlet.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e will be as attachement in plain text and the victim is not redirected somewhere else, thus allowing the attacker to execute a second step.\u003c/li\u003e\n\u003cli\u003eThe victim has no idea he is logged in another account and makes a purchase.\u003c/li\u003e\n\u003cli\u003eFrom this point on I couldn\u0026#39;t test forward because that would involve in actually making a real order.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"why-is-this-exploitable\"\u003eWHY IS THIS EXPLOITABLE\u003c/h2\u003e\n\n\u003cp\u003eSo, as mentioned in step 5, I couldn\u0026#39;t test it forward and I am assuming here. After the victim makes the order, the attacked has access to the real order from \u0026quot;my orders\u0026quot; link (\u003ca title=\"https://www.booztlet.com/se/sv/customer/orders\" href=\"/redirect?url=https%3A%2F%2Fwww.booztlet.com%2Fse%2Fsv%2Fcustomer%2Forders\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.booztlet.com/se/sv/customer/orders\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). From here he may see a lot of sensitive information, such as payment method, address and so on. He could, maybe, contact support to change the delivery address as he has access to all the real data. The attacked can also probably see the telephone number (and call the victim pretending to be an admin from the shop) or maybe even access parts of the payment method (probably nothing real sensitive).\u003c/p\u003e\n\n\u003ch2 id=\"how-to-fix-it\"\u003eHOW TO FIX IT\u003c/h2\u003e\n\n\u003cp\u003eDisable the login and register process as clearly this is not intended for \u003ca title=\"https://www.booztlet.com\" href=\"/redirect?url=https%3A%2F%2Fwww.booztlet.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.booztlet.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","bounty_amount":"80.0","formatted_bounty":"$80","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":119236,"file_name":"playground.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/236/10a91b541b705c0f3e8bc81f768bb2be861b037e/playground.html?response-content-disposition=attachment%3B%20filename%3D%22playground.html%22%3B%20filename%2A%3DUTF-8%27%27playground.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043943Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=4ad78783587f0dbfe3a479b468bb380e4f672d78f3e0ca4e0e40ed1545d35f42","file_size":898,"type":"text/html"}],"allow_singular_disclosure_at":"2016-11-30T15:52:14.772Z","allow_singular_disclosure_after":-128695648.6148882,"singular_disclosure_allowed":true,"vote_count":3,"voters":["c1231665","spetr0x","muhaddix"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1188413,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\nThanks for the report - we will look into it.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nThanks for the report - we will look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T11:25:27.555Z","updated_at":"2016-09-12T11:25:27.555Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1250590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update here ?","markdown_message":"\u003cp\u003eAny update here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-17T11:33:35.554Z","updated_at":"2016-10-17T11:33:35.554Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276231,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\nThanks for the report. We allow login as it is part of the system and we are working on \"profile\" page. However as you stated it's not clear for a customer that it is possible to actually create a profile page. We disabled that option.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nThanks for the report. We allow login as it is part of the system and we are working on \u0026quot;profile\u0026quot; page. However as you stated it\u0026#39;s not clear for a customer that it is possible to actually create a profile page. We disabled that option.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-31T15:12:29.961Z","updated_at":"2016-10-31T15:12:29.961Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276232,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-31T15:12:38.384Z","updated_at":"2016-10-31T15:12:38.384Z","actor":{"url":"/boozt","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Boozt Fashion AB"}},"bounty_amount":"80.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"boozt","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276337,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello, thx for the bounty! I have tested this again and it is fixed, the links from the \"profile\" section are not available anymore. Care to disclose this or you want it private ?","markdown_message":"\u003cp\u003eHello, thx for the bounty! I have tested this again and it is fixed, the links from the \u0026quot;profile\u0026quot; section are not available anymore. Care to disclose this or you want it private ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-31T15:52:14.736Z","updated_at":"2016-10-31T15:52:14.736Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276804,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-31T18:38:40.023Z","updated_at":"2016-10-31T18:38:40.023Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276805,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-31T18:38:40.063Z","updated_at":"2016-10-31T18:38:40.063Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}