{"id":145621,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU2MjE=","url":"https://hackerone.com/reports/145621","title":"Unauthenticated Access to some old file thumbnails ","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-18T04:17:29.507Z","submitted_at":"2016-06-18T04:17:29.507Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mkbb","url":"/mkbb","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-21T23:34:51.428Z","bug_reporter_agreed_on_going_public_at":"2016-06-20T21:47:38.268Z","team_member_agreed_on_going_public_at":"2016-06-21T23:34:51.264Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1025027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-20T17:51:35.747Z","updated_at":"2016-06-20T17:51:35.747Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025468,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-20T20:16:12.686Z","updated_at":"2016-06-20T20:16:12.686Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-20T20:22:24.547Z","updated_at":"2016-06-20T20:22:24.547Z","actor":{"username":"mkbb","cleared":false,"url":"/mkbb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025544,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-20T21:00:55.519Z","updated_at":"2016-06-20T21:00:55.519Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025630,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-20T21:47:38.294Z","updated_at":"2016-06-20T21:47:38.294Z","first_to_agree":true,"actor":{"username":"mkbb","cleared":false,"url":"/mkbb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T00:43:22.546Z","updated_at":"2016-06-21T00:43:22.546Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T20:53:03.477Z","updated_at":"2016-06-21T20:53:03.477Z","actor":{"username":"mkbb","cleared":false,"url":"/mkbb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027217,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T21:11:27.371Z","updated_at":"2016-06-21T21:11:27.371Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027218,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T21:12:15.760Z","updated_at":"2016-06-21T21:13:49.976Z","actor":{"username":"mkbb","cleared":false,"url":"/mkbb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T21:34:29.349Z","updated_at":"2016-06-21T21:34:29.349Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027409,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T23:34:51.287Z","updated_at":"2016-06-21T23:34:51.287Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027410,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-21T23:34:51.448Z","updated_at":"2016-06-21T23:34:51.448Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2099,"category":"team","content":"File thumbnails which were uploaded before the implementation of auth checks do not have those checks retroactively applied. However, their URLs contain a secret which prevents guessing or brute-forcing of their location.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eFile thumbnails which were uploaded before the implementation of auth checks do not have those checks retroactively applied. However, their URLs contain a secret which prevents guessing or brute-forcing of their location.\u003c/p\u003e\n"},{"id":2100,"category":"researcher","content":"Well, since you hid all the details which is why I requested disclosure in the first place, here goes the actual report:\n\nHello,\n\nAfter reading these posts - https://medium.com/slack-developer-blog/important-changes-to-files-in-the-web-api-eb38f2a9c1e7#.96m8zq8nz and https://api.slack.com/types/file#authentication, it is clear that any access to file thumbnails should require authentication or the Authorization header with proper scopes defined (if accessed via the API).\n\nHowever, it was observed that some of these files are accessible without any authentication required. I believe these files were uploaded before the security checks were implemented but I am not 100% sure about it. On recently uploaded files, authentication is indeed required so I believe this only applies to certain old files. Nevertheless, this is still information leakage (sensitive in some cases) and I believe all file access requests should be requiring authentication - whether old or new.\n\nWe confirmed that a lot of our files (sensitive images) that we uploaded (before 2016 around the same time when the security checks were implemented) are still accessible publicly without any authentication. This is a serious concern for us because these files (images) are sensitive and we wouldn't want anyone to get hold of them. We obviously rely on Slack to protect us against anyone accessing these old images as well even though the security checks are implemented for new files uploaded now.\n\nI am not going to send our own files as PoC but I just google searched for \"files.slack.com/files-tmb/\" and came across some files that were accessible without authentication. They are listed below:\n\nhttps://files.slack.com/files-tmb/T024MFP4J-F0J4R5MBN-2d878cd37b/add-new-color-scheme-inconsistency_360.png\n\nhttps://files.slack.com/files-tmb/T0F8RH7U7-F0J505EG1-33434fadf3/screenshot_from_2015-12-28_15_23_39_160.png\n\nPS - some of these files that were publicly accessible were shared in private channels as well so it is not like only images shared in public channels were accessible.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWell, since you hid all the details which is why I requested disclosure in the first place, here goes the actual report:\u003c/p\u003e\n\n\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eAfter reading these posts - \u003ca title=\"https://medium.com/slack-developer-blog/important-changes-to-files-in-the-web-api-eb38f2a9c1e7#.96m8zq8nz\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fslack-developer-blog%2Fimportant-changes-to-files-in-the-web-api-eb38f2a9c1e7%23.96m8zq8nz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/slack-developer-blog/important-changes-to-files-in-the-web-api-eb38f2a9c1e7#.96m8zq8nz\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"https://api.slack.com/types/file#authentication\" href=\"/redirect?url=https%3A%2F%2Fapi.slack.com%2Ftypes%2Ffile%23authentication\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.slack.com/types/file#authentication\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, it is clear that any access to file thumbnails should require authentication or the Authorization header with proper scopes defined (if accessed via the API).\u003c/p\u003e\n\n\u003cp\u003eHowever, it was observed that some of these files are accessible without any authentication required. I believe these files were uploaded before the security checks were implemented but I am not 100% sure about it. On recently uploaded files, authentication is indeed required so I believe this only applies to certain old files. Nevertheless, this is still information leakage (sensitive in some cases) and I believe all file access requests should be requiring authentication - whether old or new.\u003c/p\u003e\n\n\u003cp\u003eWe confirmed that a lot of our files (sensitive images) that we uploaded (before 2016 around the same time when the security checks were implemented) are still accessible publicly without any authentication. This is a serious concern for us because these files (images) are sensitive and we wouldn\u0026#39;t want anyone to get hold of them. We obviously rely on Slack to protect us against anyone accessing these old images as well even though the security checks are implemented for new files uploaded now.\u003c/p\u003e\n\n\u003cp\u003eI am not going to send our own files as PoC but I just google searched for \u0026quot;files.slack.com/files-tmb/\u0026quot; and came across some files that were accessible without authentication. They are listed below:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://files.slack.com/files-tmb/T024MFP4J-F0J4R5MBN-2d878cd37b/add-new-color-scheme-inconsistency_360.png\" href=\"/redirect?url=https%3A%2F%2Ffiles.slack.com%2Ffiles-tmb%2FT024MFP4J-F0J4R5MBN-2d878cd37b%2Fadd-new-color-scheme-inconsistency_360.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://files.slack.com/files-tmb/T024MFP4J-F0J4R5MBN-2d878cd37b/add-new-color-scheme-inconsistency_360.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://files.slack.com/files-tmb/T0F8RH7U7-F0J505EG1-33434fadf3/screenshot_from_2015-12-28_15_23_39_160.png\" href=\"/redirect?url=https%3A%2F%2Ffiles.slack.com%2Ffiles-tmb%2FT0F8RH7U7-F0J505EG1-33434fadf3%2Fscreenshot_from_2015-12-28_15_23_39_160.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://files.slack.com/files-tmb/T0F8RH7U7-F0J505EG1-33434fadf3/screenshot_from_2015-12-28_15_23_39_160.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePS - some of these files that were publicly accessible were shared in private channels as well so it is not like only images shared in public channels were accessible.\u003c/p\u003e\n"}]}