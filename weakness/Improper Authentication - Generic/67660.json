{"id":67660,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzY2MA==","url":"https://hackerone.com/reports/67660","title":"Verification code issues for Two-Step Authentication","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-12T20:58:31.999Z","submitted_at":"2015-06-12T20:58:31.999Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"maverickrocky02","url":"/maverickrocky02","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-09-20T16:05:47.316Z","bug_reporter_agreed_on_going_public_at":"2015-08-21T16:05:41.421Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\r\nI noticed two issues regarding the verification code that is sent to the phone as Two-Step Authentication for Wordpress accounts. I found out that verification code sent as SMS while enabling Two-Step Authentication can be reused infinitely for login. \r\n\r\nIssue#1 The application does not correctly verifies the verification code for login\r\n\r\nSteps to reproduce:\r\n1. Log into your Wordpress account\r\n2. Navigate to Security under Profile\r\n3. Enable Two-Step Authentication\r\n4. Select verify via SMS \r\n5. Note down the verification code (MagicCode)\r\n6. Complete the process by selecting I am finished printing\r\n7. Sign out from the application \r\n8. Log into the application by providing email/username and password\r\n9. When application will prompt you to provide verification code, use the code(MagicCode) initially provided while enabling the 2-FA\r\n10. Notice that you are allowed to logged in using obsolete verification code. \r\n11. Try it multiple times by logging out and log in by providing same MagicCode all time during 2-FA verification.\r\n\r\nIt simply kills the purpose of having second factor when you are not verifying it correctly. An attacker can use it for account take over.\r\n\r\nIssue#2 The application does not correctly verifies the verification code for disabling Two-Step Authentication\r\n\r\nSteps to reproduce:\r\n1. Follow steps 1 through 6 from the Issue#1\r\n2. After sometime, again navigate to Security and click on Two-Step Authentication\r\n3. Click on \"Disable Two-Step Authentication\"\r\n4. It will prompt for verification code that is sent to your mobile phone (note : A code has been sent to your device via SMS. You may request another code after one minute.)\r\n5. Instead of typing the new code, use the old code(MagicCode) that was received as the first SMS during enabling 2-FA.\r\n6. Notice that you are able to Disable Two-Step by using past verification code \r\n\r\nThis is a weird behavior of the MagicCode. Its not time based as well. I have tried it after waiting sufficient time. There are other codes as well received during the test like the code for disabling 2-FA but they behave differently.\r\n\r\nCurrently I am trying to build attack scenario where an attacker can take advantage of this behavior but nevertheless it does not stop you from delving into the matter and fixing the issue. \r\n ","vulnerability_information_html":"\u003cp\u003eHi there,\u003cbr\u003e\nI noticed two issues regarding the verification code that is sent to the phone as Two-Step Authentication for Wordpress accounts. I found out that verification code sent as SMS while enabling Two-Step Authentication can be reused infinitely for login. \u003c/p\u003e\n\n\u003cp\u003eIssue#1 The application does not correctly verifies the verification code for login\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into your Wordpress account\u003c/li\u003e\n\u003cli\u003eNavigate to Security under Profile\u003c/li\u003e\n\u003cli\u003eEnable Two-Step Authentication\u003c/li\u003e\n\u003cli\u003eSelect verify via SMS \u003c/li\u003e\n\u003cli\u003eNote down the verification code (MagicCode)\u003c/li\u003e\n\u003cli\u003eComplete the process by selecting I am finished printing\u003c/li\u003e\n\u003cli\u003eSign out from the application \u003c/li\u003e\n\u003cli\u003eLog into the application by providing email/username and password\u003c/li\u003e\n\u003cli\u003eWhen application will prompt you to provide verification code, use the code(MagicCode) initially provided while enabling the 2-FA\u003c/li\u003e\n\u003cli\u003eNotice that you are allowed to logged in using obsolete verification code. \u003c/li\u003e\n\u003cli\u003eTry it multiple times by logging out and log in by providing same MagicCode all time during 2-FA verification.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIt simply kills the purpose of having second factor when you are not verifying it correctly. An attacker can use it for account take over.\u003c/p\u003e\n\n\u003cp\u003eIssue#2 The application does not correctly verifies the verification code for disabling Two-Step Authentication\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFollow steps 1 through 6 from the Issue#1\u003c/li\u003e\n\u003cli\u003eAfter sometime, again navigate to Security and click on Two-Step Authentication\u003c/li\u003e\n\u003cli\u003eClick on \u0026quot;Disable Two-Step Authentication\u0026quot;\u003c/li\u003e\n\u003cli\u003eIt will prompt for verification code that is sent to your mobile phone (note : A code has been sent to your device via SMS. You may request another code after one minute.)\u003c/li\u003e\n\u003cli\u003eInstead of typing the new code, use the old code(MagicCode) that was received as the first SMS during enabling 2-FA.\u003c/li\u003e\n\u003cli\u003eNotice that you are able to Disable Two-Step by using past verification code \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis is a weird behavior of the MagicCode. Its not time based as well. I have tried it after waiting sufficient time. There are other codes as well received during the test like the code for disabling 2-FA but they behave differently.\u003c/p\u003e\n\n\u003cp\u003eCurrently I am trying to build attack scenario where an attacker can take advantage of this behavior but nevertheless it does not stop you from delving into the matter and fixing the issue. \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-20T16:05:42.445Z","allow_singular_disclosure_after":-166458683.077016,"singular_disclosure_allowed":true,"vote_count":1,"voters":["maverickrocky02"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":525021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its been over a month, is there anyone looking into this report","markdown_message":"\u003cp\u003eIts been over a month, is there anyone looking into this report\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-25T02:14:13.122Z","updated_at":"2015-07-25T02:14:13.122Z","actor":{"username":"maverickrocky02","cleared":false,"url":"/maverickrocky02","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":526794,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi. Thanks for the report and sorry for our delayed response. After a quick look, it looks like our SMS tokens have a longer expiration time. This, combined to the fact that you can reuse the tokens is probably the problem you are observing. I brought up this issue to our team for a discussion and will keep you updated.","markdown_message":"\u003cp\u003eHi. Thanks for the report and sorry for our delayed response. After a quick look, it looks like our SMS tokens have a longer expiration time. This, combined to the fact that you can reuse the tokens is probably the problem you are observing. I brought up this issue to our team for a discussion and will keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T11:48:56.115Z","updated_at":"2015-07-27T11:48:56.115Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":546824,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. We've deployed a fix so the codes can be only used once. This should resolve the issue you mentioned. Can you please confirm?","markdown_message":"\u003cp\u003eHi. We\u0026#39;ve deployed a fix so the codes can be only used once. This should resolve the issue you mentioned. Can you please confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-13T08:12:35.336Z","updated_at":"2015-08-13T08:12:35.336Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":548053,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have verified that I am no longer able to reuse the codes. Fix confirmed.","markdown_message":"\u003cp\u003eI have verified that I am no longer able to reuse the codes. Fix confirmed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-14T01:47:21.359Z","updated_at":"2015-08-14T01:47:21.359Z","actor":{"username":"maverickrocky02","cleared":false,"url":"/maverickrocky02","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":552685,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-18T08:27:18.954Z","updated_at":"2015-08-18T08:27:18.954Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"maverickrocky02","url":"/maverickrocky02"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":552689,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-18T08:28:03.483Z","updated_at":"2015-08-18T08:28:03.483Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"maverickrocky02","url":"/maverickrocky02"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":557628,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-21T16:05:41.449Z","updated_at":"2015-08-21T16:05:41.449Z","first_to_agree":true,"actor":{"username":"maverickrocky02","cleared":false,"url":"/maverickrocky02","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":593075,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-20T16:05:47.350Z","updated_at":"2015-09-20T16:05:47.350Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}