{"id":384289,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODQyODk=","url":"https://hackerone.com/reports/384289","title":"Redirect on authorization allows account compromise","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-07-19T19:20:29.501Z","submitted_at":"2018-07-19T19:20:29.501Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej_dds","url":"/cablej_dds","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-06T20:53:24.944Z","bug_reporter_agreed_on_going_public_at":"2018-11-06T20:53:24.865Z","team_member_agreed_on_going_public_at":"2018-11-06T03:08:26.294Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["spam404","sameerphad72","mygf","michan","khizer47","salmon","cryptographer","0x08","smither","mblegedes","and 2 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":12081,"asset_type":"URL","asset_identifier":"*.login.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3070387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-19T20:54:02.492Z","updated_at":"2018-07-19T20:54:02.492Z","actor":{"username":"brodygov","cleared":false,"url":"/brodygov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3071141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-19T23:58:39.024Z","updated_at":"2018-07-19T23:58:39.024Z","actor":{"username":"brodygov","cleared":false,"url":"/brodygov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3074056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-20T13:40:22.845Z","updated_at":"2018-07-20T13:40:22.845Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3083235,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-23T08:31:30.535Z","updated_at":"2018-07-23T08:31:30.535Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3153239,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-07T01:01:32.607Z","updated_at":"2018-08-07T01:01:32.607Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3199129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-15T13:30:44.403Z","updated_at":"2018-08-15T13:30:44.403Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3417778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-02T05:36:46.389Z","updated_at":"2018-10-02T05:36:46.389Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3422029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-02T17:29:02.682Z","updated_at":"2018-10-02T17:29:02.682Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3457913,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-09T22:33:14.772Z","updated_at":"2018-10-09T22:33:14.772Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572366,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-01T21:13:04.818Z","updated_at":"2018-11-01T21:13:04.818Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cablej_dds","url":"/cablej_dds"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3589838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-05T21:16:59.560Z","updated_at":"2018-11-05T21:16:59.560Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3591191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-06T03:08:26.321Z","updated_at":"2018-11-06T03:08:26.321Z","first_to_agree":true,"actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3595943,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-06T20:53:24.890Z","updated_at":"2018-11-06T20:53:24.890Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3595944,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-06T20:53:25.028Z","updated_at":"2018-11-06T20:53:25.028Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11533,"category":"team","content":"Login.gov had a bug in validating the redirect_uri in the `/openid_connect/authorize` endpoint, which allowed specially crafted subdomains to be incorrectly validated when they began with a valid hostname. For example, a `redirect_uri` with a hostname of `agency.gov.example.com` would validate a URL as if it were presented as `agency.gov`.\n\nThis enabled an attacker to compromise user sessions on sites that integrated with login.gov. No user interaction was required other than the user being redirected to a URL.\n\nLogin.gov immediately patched this bug by making validation of the `redirect_uri` significantly stricter by enforcing an exact match of the hostname. Shortly after, Login.gov worked with agency partners to identify every full URL that agency service providers (SPs) would need to register, and then implemented exact matching for the entire `redirect_uri` (including the URL path).\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eLogin.gov had a bug in validating the redirect_uri in the \u003ccode\u003e/openid_connect/authorize\u003c/code\u003e endpoint, which allowed specially crafted subdomains to be incorrectly validated when they began with a valid hostname. For example, a \u003ccode\u003eredirect_uri\u003c/code\u003e with a hostname of \u003ccode\u003eagency.gov.example.com\u003c/code\u003e would validate a URL as if it were presented as \u003ccode\u003eagency.gov\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis enabled an attacker to compromise user sessions on sites that integrated with login.gov. No user interaction was required other than the user being redirected to a URL.\u003c/p\u003e\n\n\u003cp\u003eLogin.gov immediately patched this bug by making validation of the \u003ccode\u003eredirect_uri\u003c/code\u003e significantly stricter by enforcing an exact match of the hostname. Shortly after, Login.gov worked with agency partners to identify every full URL that agency service providers (SPs) would need to register, and then implemented exact matching for the entire \u003ccode\u003eredirect_uri\u003c/code\u003e (including the URL path).\u003c/p\u003e\n"},{"id":11550,"category":"researcher","content":"An error in parsing redirect urls during the authorization flow allowed an attacker to compromise a user's Login.gov token by redirecting users to a malicious site. Props to the TTS team for quickly issuing a patch after the report!\n\nIneligible for bounty due to government employment.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAn error in parsing redirect urls during the authorization flow allowed an attacker to compromise a user\u0026#39;s Login.gov token by redirecting users to a malicious site. Props to the TTS team for quickly issuing a patch after the report!\u003c/p\u003e\n\n\u003cp\u003eIneligible for bounty due to government employment.\u003c/p\u003e\n"}]}