{"id":159391,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkzOTE=","url":"https://hackerone.com/reports/159391","title":"Record payment for any invoice by PM (Access control Issue)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-15T01:53:11.383Z","submitted_at":"2016-08-15T01:53:11.383Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:02:34.680Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:02:34.393Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Project Manager(Full access ) With Access to limited projects also have limited access to Invoices. So Project manager is assigned to limited project by Admin and he have access to limited Invoices related to assigned project. But Project manager can Actually Record payment of any invoice in the company.The HTTP request of Recording payment is Vulnerable to Privilege Escalation where server doesn't check whether Project manager have access to corresponding Invoice or not.\n\nVulnerable HTTP request : \n\nPOST /invoices/[Invoice_ID]/payments HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani.harvestapp.com/invoices/10392603\nCookie: [Cookie_values]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 228\n\nutf8=%E2%9C%93\u0026authenticity_token= [Oauth_token]\u0026payment%5Bpaid_at_human_format%5D=08%2F15%2F2016\u0026payment%5Bamount%5D=0.00\u0026payment%5Bnotes%5D= \n\nSteps to reproduce : \n1.Create a Invoice by project manager account and record the payment for that Invoice.\n2.The HTTP request of recording payment would look something like the above mentioned request.\n3.Change the Invoice ID in the Request to any other Invoice ID which the project manager doesn't have access to and send the request tot the server.\n4.You will see that the Payment will be recorded for your mentioned Invoice ID.\n\n\nLet me know if you need any further assistance or Video POC to understand the issue.\n\nBest Regards !\nVijay Kumar ","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : Project Manager(Full access ) With Access to limited projects also have limited access to Invoices. So Project manager is assigned to limited project by Admin and he have access to limited Invoices related to assigned project. But Project manager can Actually Record payment of any invoice in the company.The HTTP request of Recording payment is Vulnerable to Privilege Escalation where server doesn\u0026#39;t check whether Project manager have access to corresponding Invoice or not.\u003c/p\u003e\n\n\u003cp\u003eVulnerable HTTP request : \u003c/p\u003e\n\n\u003cp\u003ePOST /invoices/[Invoice_ID]/payments HTTP/1.1\u003cbr\u003e\nHost: vijaygangani.harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/10392603\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2F10392603\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/10392603\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie_values]\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 228\u003c/p\u003e\n\n\u003cp\u003eutf8=%E2%9C%93\u0026amp;authenticity_token= [Oauth_token]\u0026amp;payment%5Bpaid_at_human_format%5D=08%2F15%2F2016\u0026amp;payment%5Bamount%5D=0.00\u0026amp;payment%5Bnotes%5D= \u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003cbr\u003e\n1.Create a Invoice by project manager account and record the payment for that Invoice.\u003cbr\u003e\n2.The HTTP request of recording payment would look something like the above mentioned request.\u003cbr\u003e\n3.Change the Invoice ID in the Request to any other Invoice ID which the project manager doesn\u0026#39;t have access to and send the request tot the server.\u003cbr\u003e\n4.You will see that the Payment will be recorded for your mentioned Invoice ID.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any further assistance or Video POC to understand the issue.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:02:34.626Z","allow_singular_disclosure_after":-134026426.96935461,"singular_disclosure_allowed":true,"vote_count":10,"voters":["thisishrsh","dmatrix","dilawer01","vijay_kumar","jens","kaito","jbbbkj","sumit7","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1147181,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Vijay,\n\nThis issue should be fixed now. Could you check if you are able to reproduce it?\n\nThanks,\nJorge","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eThis issue should be fixed now. Could you check if you are able to reproduce it?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T10:01:05.457Z","updated_at":"2016-08-23T10:01:05.457Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162668,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T16:49:48.619Z","updated_at":"2016-08-30T16:49:48.619Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163620,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T23:02:34.441Z","updated_at":"2016-08-30T23:02:34.441Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223848,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T15:52:49.330Z","updated_at":"2016-09-29T15:52:49.330Z","additional_data":{"old_title":"Record payment for any invoice by limited access project Manager(Access control Issue)","new_title":"Record payment for any invoice by PM (Access control Issue)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224813,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T23:02:34.729Z","updated_at":"2016-09-29T23:02:34.729Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}