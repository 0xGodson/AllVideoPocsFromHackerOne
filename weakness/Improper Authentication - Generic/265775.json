{"id":265775,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjU3NzU=","url":"https://hackerone.com/reports/265775","title":"Password reset token issue","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-09-04T12:02:42.475Z","submitted_at":"2017-09-04T12:02:42.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ghoibsec","url":"/ghoibsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/172/453/79d81a66d9eb095976af48fa3529a1b31e1c7710_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-05T00:23:31.684Z","bug_reporter_agreed_on_going_public_at":"2017-09-05T00:23:31.628Z","team_member_agreed_on_going_public_at":"2017-09-05T00:21:48.459Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary\nCan still change password without token\n\n##Step to Reproduce\n\n- Request for password reset link.\n- Go to email and click on password reset link https://app.legalrobot.com/password-reset/token?v=uWe_yFJS0-N9fIk0nG0b0NZ70lkwNNi7RdUZu0KhiaX\n- Now remove the token and use the link https://app.legalrobot.com/password-reset\n\nObserve that able to reset the password without the token.\n\n##Fix :\nAlways password reset link should work with a valid token.\n\n##Reference :\nhttps://hackerone.com/reports/253934\n\nThanks,\ntell me if you need video. i'll create one.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eCan still change password without token\u003c/p\u003e\n\n\u003ch2 id=\"step-to-reproduce\"\u003eStep to Reproduce\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eRequest for password reset link.\u003c/li\u003e\n\u003cli\u003eGo to email and click on password reset link \u003ca title=\"https://app.legalrobot.com/password-reset/token?v=uWe_yFJS0-N9fIk0nG0b0NZ70lkwNNi7RdUZu0KhiaX\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Fpassword-reset%2Ftoken%3Fv%3DuWe_yFJS0-N9fIk0nG0b0NZ70lkwNNi7RdUZu0KhiaX\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/password-reset/token?v=uWe_yFJS0-N9fIk0nG0b0NZ70lkwNNi7RdUZu0KhiaX\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNow remove the token and use the link \u003ca title=\"https://app.legalrobot.com/password-reset\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Fpassword-reset\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/password-reset\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eObserve that able to reset the password without the token.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix :\u003c/h2\u003e\n\n\u003cp\u003eAlways password reset link should work with a valid token.\u003c/p\u003e\n\n\u003ch2 id=\"reference\"\u003eReference :\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://hackerone.com/reports/253934\" href=\"https://hackerone.com/reports/253934\"\u003ehttps://hackerone.com/reports/253934\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\ntell me if you need video. i\u0026#39;ll create one.\u003c/p\u003e\n","bounty_amount":"20.0","formatted_bounty":"$20","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-05T00:21:48.528Z","allow_singular_disclosure_after":-102056121.14435351,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","apapedulimu","ronygigi","japz","ghoibsec","kinso","h3r0es"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":519,"asset_type":"URL","asset_identifier":"app.legalrobot.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1975578,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"This behavior is not surprising since the /password-reset/token route sets a cookie with a temporary token after consuming the token that gets emailed to the user. Try clearing your cookies or using Private mode in your browser, then go to https://app.legalrobot.com/password-reset/ and try to reset your password.","markdown_message":"\u003cp\u003eThis behavior is not surprising since the /password-reset/token route sets a cookie with a temporary token after consuming the token that gets emailed to the user. Try clearing your cookies or using Private mode in your browser, then go to \u003ca title=\"https://app.legalrobot.com/password-reset/\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Fpassword-reset%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/password-reset/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and try to reset your password.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T19:41:47.474Z","updated_at":"2017-09-04T19:41:47.474Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975579,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure in the interest of transparency.","markdown_message":"\u003cp\u003eRequesting full disclosure in the interest of transparency.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T19:42:07.928Z","updated_at":"2017-09-04T19:42:07.928Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yeah, i know but it will more secure if when user not access the token  he will not can access password reset. Try to access the token and back soon on 2 or 3 hours to https://app.legalrobot.com/password-reset/ it can still reset password.  ","markdown_message":"\u003cp\u003eyeah, i know but it will more secure if when user not access the token  he will not can access password reset. Try to access the token and back soon on 2 or 3 hours to \u003ca title=\"https://app.legalrobot.com/password-reset/\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Fpassword-reset%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/password-reset/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e it can still reset password.  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T22:25:16.572Z","updated_at":"2017-09-04T22:25:16.572Z","actor":{"username":"ghoibsec","cleared":false,"url":"/ghoibsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/453/79d81a66d9eb095976af48fa3529a1b31e1c7710_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975763,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Ok, that's fair. Just as we expire the session for users that have signed in, we should not allow the user to indefinitely dwell on the password reset page with a valid token.\n\nWhat we currently do is consume the token from the email, then set a cookie with a new temporary token. That cookie expires in 30 seconds. In the page load event for the /password-reset/ route, we get that value from the cookie and load it into the Session, then delete the cookie. Once that value is in the Session, it no longer has an expiration attached to it, which means, as long as the user doesn't do a hard refresh, they have unlimited time to reset the password. What we'll do is extend the cookie expiration to an hour and get rid of the part with the Session variable, then we can just let the browser to clean up the token.\n\nThanks for continuing to work through this issue with me. Re-opening and awarding bounty now.","markdown_message":"\u003cp\u003eOk, that\u0026#39;s fair. Just as we expire the session for users that have signed in, we should not allow the user to indefinitely dwell on the password reset page with a valid token.\u003c/p\u003e\n\n\u003cp\u003eWhat we currently do is consume the token from the email, then set a cookie with a new temporary token. That cookie expires in 30 seconds. In the page load event for the /password-reset/ route, we get that value from the cookie and load it into the Session, then delete the cookie. Once that value is in the Session, it no longer has an expiration attached to it, which means, as long as the user doesn\u0026#39;t do a hard refresh, they have unlimited time to reset the password. What we\u0026#39;ll do is extend the cookie expiration to an hour and get rid of the part with the Session variable, then we can just let the browser to clean up the token.\u003c/p\u003e\n\n\u003cp\u003eThanks for continuing to work through this issue with me. Re-opening and awarding bounty now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T22:59:46.890Z","updated_at":"2017-09-04T22:59:46.890Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975764,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-04T22:59:53.110Z","updated_at":"2017-09-04T22:59:53.110Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975766,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-04T23:00:01.561Z","updated_at":"2017-09-04T23:00:01.561Z","actor":{"url":"/legalrobot","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Legal Robot"}},"bounty_amount":"20.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"legalrobot","collaborator":{"username":"ghoibsec","url":"/ghoibsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975831,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is resolved and will be deployed tonight. Thanks!","markdown_message":"\u003cp\u003eThis is resolved and will be deployed tonight. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T00:21:31.375Z","updated_at":"2017-09-05T00:21:31.375Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ghoibsec","url":"/ghoibsec"},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975833,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure in the interest of transparency.","markdown_message":"\u003cp\u003eRequesting full disclosure in the interest of transparency.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T00:21:48.489Z","updated_at":"2017-09-05T00:21:48.489Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1975836,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @danrubins, okay, thanks for bounty and good cooperation. hope i'll found another issue on Legal Robot. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/danrubins\"\u003e@danrubins\u003c/a\u003e, okay, thanks for bounty and good cooperation. hope i\u0026#39;ll found another issue on Legal Robot. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-05T00:23:31.651Z","updated_at":"2017-09-05T00:23:31.651Z","actor":{"username":"ghoibsec","cleared":false,"url":"/ghoibsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/453/79d81a66d9eb095976af48fa3529a1b31e1c7710_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975837,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-05T00:23:31.707Z","updated_at":"2017-09-05T00:23:31.707Z","actor":{"username":"ghoibsec","cleared":false,"url":"/ghoibsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/453/79d81a66d9eb095976af48fa3529a1b31e1c7710_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}