{"id":175397,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzUzOTc=","url":"https://hackerone.com/reports/175397","title":"Subdomain Takeover of Brave.com","state":"Closed","substate":"duplicate","severity_rating":"none","readable_substate":"Duplicate","created_at":"2016-10-12T14:49:13.371Z","submitted_at":"2016-10-12T14:49:13.371Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sahiltikoo","url":"/sahiltikoo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-14T17:33:23.573Z","bug_reporter_agreed_on_going_public_at":"2016-10-12T18:40:35.530Z","team_member_agreed_on_going_public_at":"2016-10-14T17:33:23.545Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nHey!\n\nI want to inform you about sub domain takeover issue i.e. when I did your DNS enumeration i came across :-\n\nIp Address        Target Name\n----------        -----------\n151.101.9.7       www.brave.com\n151.101.9.7       prod.p.ssl.global.fastly.net\n151.101.9.7       prod.p.ssl.global.fastlylb.net\n\nExcept the first domain name , the rest two CName point to an unclaimed domain on fastly.com(CDN) that when opened show :-\n\nFastly error: unknown domain: prod.p.ssl.global.fastly.net. Please check that this domain has been added to a service\n\nthe above error indicates that the above address is not in use and can be claimed by an attacker by making an account on fastly.com . \n\n\n\n## Products affected: \n\n *  Brave's sub domain \n\n## Steps To Reproduce:\n\n * Steps:- Open the above CName ( prod.p.ssl.global.fastly.net.) , as the error is thrown , it indicates the above address can be claimed by creating an account on fastly and giving this as the Cname for your own domain.\n\n## Supporting Material/References:\n\n  * I have added POC image for the DNS enumeration i did. just have a look .\n","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHey!\u003c/p\u003e\n\n\u003cp\u003eI want to inform you about sub domain takeover issue i.e. when I did your DNS enumeration i came across :-\u003c/p\u003e\n\n\u003cp\u003eIp Address        Target Name\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e151.101.9.7       \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.brave.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.brave.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n151.101.9.7       prod.p.ssl.global.fastly.net\u003cbr\u003e\n151.101.9.7       prod.p.ssl.global.fastlylb.net\u003c/p\u003e\n\n\u003cp\u003eExcept the first domain name , the rest two CName point to an unclaimed domain on fastly.com(CDN) that when opened show :-\u003c/p\u003e\n\n\u003cp\u003eFastly error: unknown domain: prod.p.ssl.global.fastly.net. Please check that this domain has been added to a service\u003c/p\u003e\n\n\u003cp\u003ethe above error indicates that the above address is not in use and can be claimed by an attacker by making an account on fastly.com . \u003c/p\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e Brave\u0026#39;s sub domain \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSteps:- Open the above CName ( prod.p.ssl.global.fastly.net.) , as the error is thrown , it indicates the above address can be claimed by creating an account on fastly and giving this as the Cname for your own domain.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eI have added POC image for the DNS enumeration i did. just have a look .\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":127440,"file_name":"poc(brave).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/127/440/3ca081fb239265deacac5fc298af96b55f5f5802/poc%28brave%29.png?response-content-disposition=attachment%3B%20filename%3D%22poc%2528brave%2529.png%22%3B%20filename%2A%3DUTF-8%27%27poc%2528brave%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=f9635c94e02cf9686e63a444e268ed9cac57c682a65278591f09e140b42c8a46","file_size":14022,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["sameerphad72","bugdiscloseguys","japz","spetr0x","prospere","dyabla"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1244104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FIX?\n\n    You can delete the CNAME entry for  prod.p.ssl.global.fastly.net\n\nor..\n\n    You can have make it point to the actual site, in short use it.\n","markdown_message":"\u003cp\u003eFIX?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eYou can delete the CNAME entry for  prod.p.ssl.global.fastly.net\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eor..\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eYou can have make it point to the actual site, in short use it.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-10-12T14:55:24.477Z","updated_at":"2016-10-12T14:55:24.477Z","actor":{"username":"sahiltikoo","cleared":false,"url":"/sahiltikoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1244579,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"already reported","markdown_message":"\u003cp\u003ealready reported\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-12T18:32:11.338Z","updated_at":"2016-10-12T18:32:11.338Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244601,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"can you?","markdown_message":"\u003cp\u003ecan you?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-12T18:40:35.548Z","updated_at":"2016-10-12T18:40:35.548Z","first_to_agree":true,"actor":{"username":"sahiltikoo","cleared":false,"url":"/sahiltikoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bridiver your call on whether to disclose this. if so, please add a comment explaining why this isn't an issue.","markdown_message":"\u003cp\u003e\u003ca href=\"/bridiver\"\u003e@bridiver\u003c/a\u003e your call on whether to disclose this. if so, please add a comment explaining why this isn\u0026#39;t an issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-13T19:20:48.557Z","updated_at":"2016-10-13T19:20:48.557Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not an unclaimed domain on fastly.com, it is a shared endpoint for the CDN. When you go to brave.com the browser sends a Host header that allows Fastly to map the request to our configured service for brave.com. This is how CDNs work and allows Fastly to manage the the actual IP that is returned to the client based on the location of the request. You cannot claim prod.p.ssl.global.fastly.net and we clearly are using it because it responds with the brave.com website when you access it by going through brave.com","markdown_message":"\u003cp\u003eThis is not an unclaimed domain on fastly.com, it is a shared endpoint for the CDN. When you go to brave.com the browser sends a Host header that allows Fastly to map the request to our configured service for brave.com. This is how CDNs work and allows Fastly to manage the the actual IP that is returned to the client based on the location of the request. You cannot claim prod.p.ssl.global.fastly.net and we clearly are using it because it responds with the brave.com website when you access it by going through brave.com\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-14T08:07:17.002Z","updated_at":"2016-10-14T08:07:17.002Z","actor":{"username":"bridiver","cleared":false,"url":"/bridiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247309,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-14T08:08:09.828Z","updated_at":"2016-10-14T08:08:09.828Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":1766,"new_severity_id":2113},"actor":{"username":"bridiver","cleared":false,"url":"/bridiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247970,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-14T17:33:23.561Z","updated_at":"2016-10-14T17:33:23.561Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247971,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-14T17:33:23.586Z","updated_at":"2016-10-14T17:33:23.586Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300383,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T14:11:39.852Z","updated_at":"2016-11-15T14:11:39.852Z","additional_data":{"duplicate_report_id":182241},"actor":{"username":"mvbk1991","cleared":false,"url":"/mvbk1991","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}