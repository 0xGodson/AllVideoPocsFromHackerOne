{"id":140432,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDA0MzI=","url":"https://hackerone.com/reports/140432","title":"configure a redirect URI for Facebook OAuth","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-05-23T08:09:16.903Z","submitted_at":"2016-05-23T08:09:16.903Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-17T06:42:09.412Z","bug_reporter_agreed_on_going_public_at":"2016-06-17T06:42:09.145Z","team_member_agreed_on_going_public_at":"2016-06-15T17:24:24.670Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey,\n\nIts me again. since the Login with Facebook doesnt have a dedicated directory like gratipay.com/facebook/callback it is possible to still steal access tokens.\n\nhttps://www.facebook.com/dialog/oauth?response_type=code\u0026client_id=144124902390407\u0026redirect_uri=https://gratipay.com/~attacka/\u0026scope=public_profile%2Cemail%2Cuser_friends\u0026state=mjemgKNb0s24lbEqBcyVqDEVNoYDYs\n\nAs you can see it will send the token to my profile (/~attacka) and my profile points to example.com, if the user clicks on that link the referrer header will send tokenz (obviously lol)\n\ngratipay also imports pictures from 3rd parties, forexample my img src is from ls.googleusercontent.com which means it will also leak the access_tokens to there.\n\nFix: add the redirect uri like: https://www.gratipay.com/facebook/callback so users have no way to tamper with it.\n\nThanks,\nP","vulnerability_information_html":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eIts me again. since the Login with Facebook doesnt have a dedicated directory like gratipay.com/facebook/callback it is possible to still steal access tokens.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.facebook.com/dialog/oauth?response_type=code\u0026amp;client_id=144124902390407\u0026amp;redirect_uri=https://gratipay.com/~attacka/\u0026amp;scope=public_profile%2Cemail%2Cuser_friends\u0026amp;state=mjemgKNb0s24lbEqBcyVqDEVNoYDYs\" href=\"/redirect?url=https%3A%2F%2Fwww.facebook.com%2Fdialog%2Foauth%3Fresponse_type%3Dcode%26client_id%3D144124902390407%26redirect_uri%3Dhttps%3A%2F%2Fgratipay.com%2F~attacka%2F%26scope%3Dpublic_profile%252Cemail%252Cuser_friends%26state%3DmjemgKNb0s24lbEqBcyVqDEVNoYDYs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.facebook.com/dialog/oauth?response_type=code\u0026amp;client_id=144124902390407\u0026amp;redirect_uri=https://gratipay.com/~attacka/\u0026amp;scope=public_profile%2Cemail%2Cuser_friends\u0026amp;state=mjemgKNb0s24lbEqBcyVqDEVNoYDYs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAs you can see it will send the token to my profile (/~attacka) and my profile points to example.com, if the user clicks on that link the referrer header will send tokenz (obviously lol)\u003c/p\u003e\n\n\u003cp\u003egratipay also imports pictures from 3rd parties, forexample my img src is from ls.googleusercontent.com which means it will also leak the access_tokens to there.\u003c/p\u003e\n\n\u003cp\u003eFix: add the redirect uri like: \u003ca title=\"https://www.gratipay.com/facebook/callback\" href=\"/redirect?url=https%3A%2F%2Fwww.gratipay.com%2Ffacebook%2Fcallback\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.gratipay.com/facebook/callback\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e so users have no way to tamper with it.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nP\u003c/p\u003e\n","bounty_amount":"10.0","formatted_bounty":"$10","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-07-15T17:24:24.756Z","allow_singular_disclosure_after":-140612613.80825323,"singular_disclosure_allowed":true,"vote_count":13,"voters":["shailesh4594","gerben_javado","geekboy","bugdiscloseguys","chernobyl","paresh_parmar","paulos_","ahmed_abdalla","spetr0x","martijn","and 3 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":971327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hammad ping","markdown_message":"\u003cp\u003e\u003ca href=\"/hammad\"\u003e@hammad\u003c/a\u003e ping\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T01:45:16.863Z","updated_at":"2016-05-24T01:45:16.863Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":971328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"do note: they are different issues (also trying to gather rep points here)","markdown_message":"\u003cp\u003edo note: they are different issues (also trying to gather rep points here)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T01:45:38.084Z","updated_at":"2016-05-24T01:45:38.084Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015444,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Accepting as a mild risk, which carries a $10 bounty per our [program](https://hackerone.com/gratipay). Thanks for the report!","markdown_message":"\u003cp\u003eAccepting as a mild risk, which carries a $10 bounty per our \u003ca href=\"https://hackerone.com/gratipay\"\u003eprogram\u003c/a\u003e. Thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T17:05:57.602Z","updated_at":"2016-06-15T17:05:57.602Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015445,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T17:06:29.399Z","updated_at":"2016-06-15T17:06:29.399Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"bounty_amount":"10.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"paulos_","url":"/paulos_"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015448,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just made it back into our Facebook app management console, and found this warning:\n\n\u003e Client OAuth login is enabled but you haven't listed any valid OAuth redirect URIs. Click here for more information.\n\n;-)","markdown_message":"\u003cp\u003eI just made it back into our Facebook app management console, and found this warning:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eClient OAuth login is enabled but you haven\u0026#39;t listed any valid OAuth redirect URIs. Click here for more information.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e;-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T17:07:18.934Z","updated_at":"2016-06-15T17:07:18.934Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015494,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I've configured the redirect URI as https://gratipay.com/on/facebook/associate.","markdown_message":"\u003cp\u003eI\u0026#39;ve configured the redirect URI as \u003ca title=\"https://gratipay.com/on/facebook/associate\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2Fon%2Ffacebook%2Fassociate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/on/facebook/associate\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T17:24:17.603Z","updated_at":"2016-06-15T17:24:17.603Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"paulos_","url":"/paulos_"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T17:24:24.707Z","updated_at":"2016-06-15T17:24:24.707Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537 can you hold of the public disclosure? too many sites like this are vulnerable. I will request public disclosure 30 days later. ","markdown_message":"\u003cp\u003e\u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e can you hold of the public disclosure? too many sites like this are vulnerable. I will request public disclosure 30 days later. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T18:32:38.238Z","updated_at":"2016-06-15T18:32:38.238Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015715,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T18:51:26.595Z","updated_at":"2016-06-15T18:51:26.595Z","additional_data":{"old_title":"oauth misconfig 2","new_title":"configure a redirect URI for Facebook OAuth"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@paulos_ Sure, happy to let the 30-day disclosure clock run out.","markdown_message":"\u003cp\u003e\u003ca href=\"/paulos_\"\u003e@paulos_\u003c/a\u003e Sure, happy to let the 30-day disclosure clock run out.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T18:51:55.449Z","updated_at":"2016-06-15T18:51:55.449Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1015727,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T18:54:34.245Z","updated_at":"2016-06-15T18:54:34.245Z","additional_data":{"duplicate_report_id":141646},"actor":{"username":"faisal_hfr","cleared":false,"url":"/faisal_hfr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/739/2147fe98044da80e699dbc7865df7b0fdf0e6fb5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1018566,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-17T06:42:09.221Z","updated_at":"2016-06-17T06:42:09.221Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1018567,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-17T06:42:09.433Z","updated_at":"2016-06-17T06:42:09.433Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340033,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-04T18:21:54.968Z","updated_at":"2016-12-04T18:21:54.968Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":11504},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}