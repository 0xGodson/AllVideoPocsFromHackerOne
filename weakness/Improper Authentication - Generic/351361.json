{"id":351361,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTEzNjE=","url":"https://hackerone.com/reports/351361","title":"Administrator can create user without entering high security mode","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-05-14T09:56:08.683Z","submitted_at":"2018-05-14T09:56:08.683Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ivh","url":"/ivh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-22T09:27:26.906Z","bug_reporter_agreed_on_going_public_at":"2018-05-22T09:27:26.811Z","team_member_agreed_on_going_public_at":"2018-05-14T21:38:23.697Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When an administrator wants to create a user, he can go to https://phabricator.example.com/people/create/ and will be required to enter his MFA token in order to enter high security mode.\n\nHowever, if an administrator goes to https://phabricator.example.com/people/new/standard/ he will bypass the choice of user type and go straight to the new standard user form. This form allows the administrator to create a new user without entering high security mode.\n\nmongoose\n\n## Impact\n\nThe attacker could create a user account for someone that is not supposed to have access to Phabricator, or for himself in order to keep his access to Phabricator after losing access to the (compromised) administrator account.","vulnerability_information_html":"\u003cp\u003eWhen an administrator wants to create a user, he can go to \u003ca title=\"https://phabricator.example.com/people/create/\" href=\"/redirect?url=https%3A%2F%2Fphabricator.example.com%2Fpeople%2Fcreate%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://phabricator.example.com/people/create/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and will be required to enter his MFA token in order to enter high security mode.\u003c/p\u003e\n\n\u003cp\u003eHowever, if an administrator goes to \u003ca title=\"https://phabricator.example.com/people/new/standard/\" href=\"/redirect?url=https%3A%2F%2Fphabricator.example.com%2Fpeople%2Fnew%2Fstandard%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://phabricator.example.com/people/new/standard/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e he will bypass the choice of user type and go straight to the new standard user form. This form allows the administrator to create a new user without entering high security mode.\u003c/p\u003e\n\n\u003cp\u003emongoose\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker could create a user account for someone that is not supposed to have access to Phabricator, or for himself in order to keep his access to Phabricator after losing access to the (compromised) administrator account.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-13T21:38:23.797Z","allow_singular_disclosure_after":-80294576.52796353,"singular_disclosure_allowed":true,"vote_count":10,"voters":["jokebookservice1","eveeez","xiaoyinl","apapedulimu","lordjerry0x01","ranjit_p","mefkan","japz","0x08","testinghacker0x01"],"severity":{"rating":"low","score":3.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2739572,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! I believe this should be resolved by this patch, which adds an MFA check to the actual creation controller:\n\n\u003chttps://secure.phabricator.com/D19448\u003e\n\nWe're somewhat inconsistent about requiring MFA to create users: you can currently approve users or invite users without MFA. Creating users isn't especially dangerous on its own, but I think we're generally correct to require MFA for it and that we should probably lock the approve/invite flows down at some point. I've filed this task to address this eventually:\n\n\u003chttps://secure.phabricator.com/T13138\u003e","markdown_message":"\u003cp\u003eThanks! I believe this should be resolved by this patch, which adds an MFA check to the actual creation controller:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/D19448\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FD19448\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/D19448\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re somewhat inconsistent about requiring MFA to create users: you can currently approve users or invite users without MFA. Creating users isn\u0026#39;t especially dangerous on its own, but I think we\u0026#39;re generally correct to require MFA for it and that we should probably lock the approve/invite flows down at some point. I\u0026#39;ve filed this task to address this eventually:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/T13138\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT13138\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T13138\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-14T14:15:10.224Z","updated_at":"2018-05-14T14:15:10.224Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2742886,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is now resolved in `master`.","markdown_message":"\u003cp\u003eThis is now resolved in \u003ccode\u003emaster\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-14T21:35:28.747Z","updated_at":"2018-05-14T21:35:28.747Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ivh","url":"/ivh"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2742889,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"In assessing an award for this issue, I'm primarily considering the relatively low impact of the issue. Although an attacker might be able to use this to extend access, creating accounts isn't inherently dangerous and exploiting this requires the attacker first compromise an administrator account. Some adjacent concerns were also already known to the upstream and tracked by \u003chttps://secure.phabricator.com/T7667\u003e, although this specific issue wasn't previously known.","markdown_message":"\u003cp\u003eIn assessing an award for this issue, I\u0026#39;m primarily considering the relatively low impact of the issue. Although an attacker might be able to use this to extend access, creating accounts isn\u0026#39;t inherently dangerous and exploiting this requires the attacker first compromise an administrator account. Some adjacent concerns were also already known to the upstream and tracked by \u003ca title=\"https://secure.phabricator.com/T7667\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT7667\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T7667\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, although this specific issue wasn\u0026#39;t previously known.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-14T21:37:43.500Z","updated_at":"2018-05-14T21:37:43.500Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"ivh","url":"/ivh"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2742890,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Details for this issue are publicly available in commit history and on `secure.phabricator.com`, so the report may be disclosed at any time.\n\nThanks again! Let us know if you find anything else.","markdown_message":"\u003cp\u003eDetails for this issue are publicly available in commit history and on \u003ccode\u003esecure.phabricator.com\u003c/code\u003e, so the report may be disclosed at any time.\u003c/p\u003e\n\n\u003cp\u003eThanks again! Let us know if you find anything else.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-14T21:38:23.725Z","updated_at":"2018-05-14T21:38:23.725Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2778037,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-22T09:27:26.846Z","updated_at":"2018-05-22T09:27:26.846Z","actor":{"username":"ivh","cleared":false,"url":"/ivh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2778038,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-22T09:27:26.945Z","updated_at":"2018-05-22T09:27:26.945Z","actor":{"username":"ivh","cleared":false,"url":"/ivh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}