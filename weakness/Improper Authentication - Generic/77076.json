{"id":77076,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzA3Ng==","url":"https://hackerone.com/reports/77076","title":"GA code not verified on the server side allows sending Verification Documents on behalf of another user","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-20T20:42:07.571Z","submitted_at":"2015-07-20T20:42:07.571Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"crab","url":"/crab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-27T06:28:47.665Z","bug_reporter_agreed_on_going_public_at":"2015-10-28T06:28:46.666Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Host**\r\napi.romit.io\r\n\r\n**Endpoint**\r\n/v0/cash/auth/login/verify\r\n\r\n**Issue**\r\nThe GA Code is not verified on the server side for the users whose \"Verification application\" has been DENIED by the Romit support Team\r\n\r\n**PoC**\r\n\r\n1.    Setup an account at app.romit.io, use your apiKey, apiSecret and Location-ID to setup.\r\n2.   Now click on Send Money, add the Phone Number and PIN of an account whose verification application has been denied once.\r\n3.   You are prompted for GA code, enter any code. The server reponds with the following message `\r\n{\r\n  \"success\" : true,\r\n  \"error\" : null,\r\n  \"response\" : {\r\n    \"kioskEnrollmentStatusType\" : \"DENIED\"\r\n  }\r\n}`\r\nand prompted with this message on the UI [see image resubmit.png]\r\n4. You are prompted to take an image of your ID and your image.\r\n5. These documents are then saved on the server side.\r\n\r\nThanks\r\ncrab\r\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eHost\u003c/strong\u003e\u003cbr\u003e\napi.romit.io\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eEndpoint\u003c/strong\u003e\u003cbr\u003e\n/v0/cash/auth/login/verify\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eIssue\u003c/strong\u003e\u003cbr\u003e\nThe GA Code is not verified on the server side for the users whose \u0026quot;Verification application\u0026quot; has been DENIED by the Romit support Team\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e   Setup an account at app.romit.io, use your apiKey, apiSecret and Location-ID to setup.\u003c/li\u003e\n\u003cli\u003e  Now click on Send Money, add the Phone Number and PIN of an account whose verification application has been denied once.\u003c/li\u003e\n\u003cli\u003e  You are prompted for GA code, enter any code. The server reponds with the following message \u003ccode\u003e\n{\n\u0026quot;success\u0026quot; : true,\n\u0026quot;error\u0026quot; : null,\n\u0026quot;response\u0026quot; : {\n\u0026quot;kioskEnrollmentStatusType\u0026quot; : \u0026quot;DENIED\u0026quot;\n}\n}\u003c/code\u003e\nand prompted with this message on the UI [see image resubmit.png]\u003c/li\u003e\n\u003cli\u003eYou are prompted to take an image of your ID and your image.\u003c/li\u003e\n\u003cli\u003eThese documents are then saved on the server side.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\ncrab\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":46034,"file_name":"resubmit.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/034/748347e6489a7195144c1d9c6706be8b24d327db/resubmit.png?response-content-disposition=attachment%3B%20filename%3D%22resubmit.png%22%3B%20filename%2A%3DUTF-8%27%27resubmit.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064929Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=dc9f160804510a47ac18ab04705dc840d8141c4ca164fe5be48edecf577aa7d4","file_size":329696,"type":"image/png"}],"allow_singular_disclosure_at":"2015-11-27T06:28:46.801Z","allow_singular_disclosure_after":-160618842.52544767,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":517906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Should I provide an account whose \"Application\" has been denied?","markdown_message":"\u003cp\u003eShould I provide an account whose \u0026quot;Application\u0026quot; has been denied?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T20:42:55.086Z","updated_at":"2015-07-20T20:42:55.086Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":517936,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Crab,\nYou revealed a issue with our enrollment status system that gives users the ability to upload documents using only a PIN.  What should be noted, however, is the user is still not capable of performing financial transactions (like /buy or /sell) in that state.If you are able to use those or other endpoints in this limited approved state, certainly let us know as that will greatly change the severity of this issue.  Thanks.","markdown_message":"\u003cp\u003eHi Crab,\u003cbr\u003e\nYou revealed a issue with our enrollment status system that gives users the ability to upload documents using only a PIN.  What should be noted, however, is the user is still not capable of performing financial transactions (like /buy or /sell) in that state.If you are able to use those or other endpoints in this limited approved state, certainly let us know as that will greatly change the severity of this issue.  Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T20:56:52.323Z","updated_at":"2015-07-20T20:56:52.323Z","actor":{"username":"thallium205","cleared":false,"url":"/thallium205","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/608/bdef748d3aa294829f5ff0cc617b03543ab883f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":518064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi thallium205\n\nI have verified it is not possible to perform financial transactions as the sessionid issued doesn't consider user to be logged in, so the attacker can only submit the \"Verification Document\" given that session Id, but still the attacker can submit his/her id proof and try to takeover the account by providing those documents to romit support to change number(thats a long shot) or at the very least deny \"the actual user\" access as the user will now need attackers documents to verify themselves with romit support.\n\nGiven this report and #75702,  I think you should add rate limit at PIN verification too.\n\nThanks\ncrab","markdown_message":"\u003cp\u003eHi thallium205\u003c/p\u003e\n\n\u003cp\u003eI have verified it is not possible to perform financial transactions as the sessionid issued doesn\u0026#39;t consider user to be logged in, so the attacker can only submit the \u0026quot;Verification Document\u0026quot; given that session Id, but still the attacker can submit his/her id proof and try to takeover the account by providing those documents to romit support to change number(thats a long shot) or at the very least deny \u0026quot;the actual user\u0026quot; access as the user will now need attackers documents to verify themselves with romit support.\u003c/p\u003e\n\n\u003cp\u003eGiven this report and \u003ca href=\"/reports/75702\"\u003e#75702\u003c/a\u003e,  I think you should add rate limit at PIN verification too.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\ncrab\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T21:37:16.766Z","updated_at":"2015-07-20T21:37:16.766Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":526975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update on this?\n\nthanks\ncrab","markdown_message":"\u003cp\u003eany update on this?\u003c/p\u003e\n\n\u003cp\u003ethanks\u003cbr\u003e\ncrab\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T14:35:57.817Z","updated_at":"2015-07-27T14:35:57.817Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":534459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi \n\nAny update on this?\n\nThanks\nCrab","markdown_message":"\u003cp\u003eHi \u003c/p\u003e\n\n\u003cp\u003eAny update on this?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nCrab\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-01T15:22:40.379Z","updated_at":"2015-08-01T15:22:40.379Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":537875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We believe to have resolved this issue.  Can you confirm?","markdown_message":"\u003cp\u003eWe believe to have resolved this issue.  Can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-04T22:32:32.126Z","updated_at":"2015-08-04T22:32:32.126Z","actor":{"username":"thallium205","cleared":false,"url":"/thallium205","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/608/bdef748d3aa294829f5ff0cc617b03543ab883f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":538291,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes the issue has been resolved.\n\nThanks\ncrab","markdown_message":"\u003cp\u003eYes the issue has been resolved.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\ncrab\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-05T09:01:52.656Z","updated_at":"2015-08-05T09:01:52.656Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":538894,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-05T19:07:04.773Z","updated_at":"2015-08-05T19:07:04.773Z","actor":{"username":"thallium205","cleared":false,"url":"/thallium205","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/608/bdef748d3aa294829f5ff0cc617b03543ab883f0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"crab","url":"/crab"},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":538895,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"No rate limit on PIN combined with this exploit could lead to direct exploitation with a support ticket.","markdown_message":"\u003cp\u003eNo rate limit on PIN combined with this exploit could lead to direct exploitation with a support ticket.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-05T19:07:10.452Z","updated_at":"2015-08-05T19:09:44.269Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"crab","url":"/crab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":635040,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-28T06:28:46.701Z","updated_at":"2015-10-28T06:28:46.701Z","first_to_agree":true,"actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":700483,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-27T06:28:47.702Z","updated_at":"2015-11-27T06:28:47.702Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}