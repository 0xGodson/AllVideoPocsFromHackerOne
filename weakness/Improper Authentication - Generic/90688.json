{"id":90688,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDY4OA==","url":"https://hackerone.com/reports/90688","title":"create staff member without owner access","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-27T20:10:42.338Z","submitted_at":"2015-09-27T20:10:42.338Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"supernatural","url":"/supernatural","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-29T17:17:07.990Z","bug_reporter_agreed_on_going_public_at":"2016-02-29T17:17:07.814Z","team_member_agreed_on_going_public_at":"2015-12-14T17:57:59.393Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi \n\nas you mentioned in #56726 \n\n    \"Only the the store owner is allowed to create new staff members\"\n\nadmins can't create new staff members!\nbut with this vulnerability admins can use api to create user! \n\n\nsteps:\n\n- get access token for one full access admin (you can send request to xauth or sniff it from mobile device)\n\n- send request with POST method to \"https://~ShopName~.myshopify.com/admin/users.json\"\n\ndata : \n\n{\n\"user\": {\n\"email\": \"anyvalidmail@valid.com\",\n\"first_name\":\"~fname~\",\n\"last_name\" : \"~lname~\",\n\"pin\" : 1234\n}\n}\n\n\nnow, a user will be created! this user marked as POS staff member, without any access to admin shop!\n\n-  go to \"https://~ShopName~.myshopify.com/admin/auth/recover\"\n\n- enter new admin email address\n\n- follow instructions to reset password\nafter recovering password user will convert to normal limited access\n\n- open that first full access admin and then select new created admin\n\n- unselect limited access\n\nDone, a new admin will full access created!\n\n\nRegards\n\n\n","vulnerability_information_html":"\u003cp\u003eHi \u003c/p\u003e\n\n\u003cp\u003eas you mentioned in \u003ca href=\"/reports/56726\"\u003e#56726\u003c/a\u003e \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026quot;Only the the store owner is allowed to create new staff members\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eadmins can\u0026#39;t create new staff members!\u003cbr\u003e\nbut with this vulnerability admins can use api to create user! \u003c/p\u003e\n\n\u003cp\u003esteps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eget access token for one full access admin (you can send request to xauth or sniff it from mobile device)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003esend request with POST method to \u0026quot;https://~ShopName~.myshopify.com/admin/users.json\u0026quot;\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003edata : \u003c/p\u003e\n\n\u003cp\u003e{\u003cbr\u003e\n\u0026quot;user\u0026quot;: {\u003cbr\u003e\n\u0026quot;email\u0026quot;: \u0026quot;\u003ca title=\"anyvalidmail@valid.com\" href=\"mailto:anyvalidmail@valid.com\" rel=\"nofollow noopener noreferrer\"\u003eanyvalidmail@valid.com\u003c/a\u003e\u0026quot;,\u003cbr\u003e\n\u0026quot;first_name\u0026quot;:\u0026quot;~fname~\u0026quot;,\u003cbr\u003e\n\u0026quot;last_name\u0026quot; : \u0026quot;~lname~\u0026quot;,\u003cbr\u003e\n\u0026quot;pin\u0026quot; : 1234\u003cbr\u003e\n}\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003cp\u003enow, a user will be created! this user marked as POS staff member, without any access to admin shop!\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003ego to \u0026quot;https://~ShopName~.myshopify.com/admin/auth/recover\u0026quot;\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eenter new admin email address\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003efollow instructions to reset password\u003cbr\u003e\nafter recovering password user will convert to normal limited access\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eopen that first full access admin and then select new created admin\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eunselect limited access\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eDone, a new admin will full access created!\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-01-13T17:57:59.595Z","allow_singular_disclosure_after":-156517898.54487625,"singular_disclosure_allowed":true,"vote_count":2,"voters":["bogdantcaciuc","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":599759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us **up to 3 weeks or more** to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us \u003cstrong\u003eup to 3 weeks or more\u003c/strong\u003e to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-09-27T20:10:43.296Z","updated_at":"2015-09-27T20:10:43.296Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":599761,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"users with \"restricted \" type will convert to \"regular\" after reset password!","markdown_message":"\u003cp\u003eusers with \u0026quot;restricted \u0026quot; type will convert to \u0026quot;regular\u0026quot; after reset password!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-27T20:14:02.986Z","updated_at":"2015-09-27T20:14:02.986Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":605670,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is a interesting bypass, I opened an issue and our team is going to investigate. I will keep you informed of the progress.\n\nThanks for reporting the issue!","markdown_message":"\u003cp\u003eThis is a interesting bypass, I opened an issue and our team is going to investigate. I will keep you informed of the progress.\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting the issue!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T20:46:40.715Z","updated_at":"2015-10-01T20:46:40.715Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712856,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report.\n\nAs you discovered, there was a bug which caused POS staff members to be converted to admins when a password reset was requested. We've corrected the bug and disabled the password reset functionality for POS staff members (since they don't have passwords).\n\nOur next round of bounty decisions will take place within the next week, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report.\u003c/p\u003e\n\n\u003cp\u003eAs you discovered, there was a bug which caused POS staff members to be converted to admins when a password reset was requested. We\u0026#39;ve corrected the bug and disabled the password reset functionality for POS staff members (since they don\u0026#39;t have passwords).\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within the next week, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T15:15:55.410Z","updated_at":"2015-12-08T15:15:55.410Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"supernatural","url":"/supernatural"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":719856,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-14T17:57:29.131Z","updated_at":"2015-12-14T17:57:29.131Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"supernatural","url":"/supernatural"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":719860,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-14T17:57:59.440Z","updated_at":"2015-12-14T17:57:59.440Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":817316,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-29T17:17:07.852Z","updated_at":"2016-02-29T17:17:07.852Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":817317,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-29T17:17:08.020Z","updated_at":"2016-02-29T17:17:08.020Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}