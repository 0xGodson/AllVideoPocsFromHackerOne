{"id":479464,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Nzk0NjQ=","url":"https://hackerone.com/reports/479464","title":"Significant Two step verification Authentication Bypass","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2019-01-14T20:22:50.295Z","submitted_at":"2019-01-14T20:22:50.295Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"david993","url":"/david993","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-02-19T17:40:52.489Z","bug_reporter_agreed_on_going_public_at":"2019-01-15T20:00:24.487Z","team_member_agreed_on_going_public_at":"2019-02-19T17:40:52.370Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["sameerphad72","mygf","khizer47","j4yd33-","drkaolin","irishred86","shiwankgpt","geek_computer_servicez","minat0","reddmist"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":6237,"asset_type":"URL","asset_identifier":"www.dropbox.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3974793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-14T20:25:02.624Z","updated_at":"2019-01-14T20:25:02.624Z","actor":{"username":"david993","cleared":false,"url":"/david993","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3974981,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-14T21:21:39.099Z","updated_at":"2019-01-14T21:21:39.099Z","actor":{"username":"rohan","cleared":false,"url":"/rohan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3976783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-15T06:38:53.969Z","updated_at":"2019-01-15T06:38:53.969Z","actor":{"username":"david993","cleared":false,"url":"/david993","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3982334,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-15T20:00:24.529Z","updated_at":"2019-01-15T20:00:24.529Z","first_to_agree":true,"actor":{"username":"david993","cleared":false,"url":"/david993","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4174510,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-19T17:40:52.403Z","updated_at":"2019-02-19T17:40:52.403Z","actor":{"username":"nlattimer","cleared":false,"url":"/nlattimer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/079/0305beb899e1ea03230c543d37f1cf2844ec2874_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4174511,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-19T17:40:52.610Z","updated_at":"2019-02-19T17:40:52.610Z","actor":{"username":"nlattimer","cleared":false,"url":"/nlattimer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/079/0305beb899e1ea03230c543d37f1cf2844ec2874_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14248,"category":"team","content":"This report described a concern with our “Trust this Computer” feature in Dropbox web sign in. \n\nThe way our “Trust this Computer” feature works, at a high level, is that while authenticating using 2FA, the user can request that this device be trusted in the future so they don’t have to use 2FA again. We return a high entropy token, bound to the user’s 2FA settings, as a cookie on the device to verify the device in any future authentication attempts. Lastly, we suggest in the UI that a user only use this feature on devices they trust.\n\nThe report suggested that this cookie-based model was insecure for two main reasons:\n\n1. Anyone with the trusted cookie could bypass 2FA.\n2. The trust relationship is not unlinkable via personal settings.\n\nTo exploit any insecurity, an attacker would also likely need to be executing code on the device in question because the trusted device cookie is HttpOnly indicating that exfiltration via XSS would likely not be possible. The high entropy nature of the token would make guessing the token infeasible.\n\nTo the second point, while we don’t have a way to unlink via the settings, a user can invalidate these tokens by disabling and reenabling 2FA on their account. This will unbind all of the previous tokens linked to the account. A user can also delete the cookie from their device if they don’t want that device trusted any longer.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report described a concern with our “Trust this Computer” feature in Dropbox web sign in. \u003c/p\u003e\n\n\u003cp\u003eThe way our “Trust this Computer” feature works, at a high level, is that while authenticating using 2FA, the user can request that this device be trusted in the future so they don’t have to use 2FA again. We return a high entropy token, bound to the user’s 2FA settings, as a cookie on the device to verify the device in any future authentication attempts. Lastly, we suggest in the UI that a user only use this feature on devices they trust.\u003c/p\u003e\n\n\u003cp\u003eThe report suggested that this cookie-based model was insecure for two main reasons:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAnyone with the trusted cookie could bypass 2FA.\u003c/li\u003e\n\u003cli\u003eThe trust relationship is not unlinkable via personal settings.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eTo exploit any insecurity, an attacker would also likely need to be executing code on the device in question because the trusted device cookie is HttpOnly indicating that exfiltration via XSS would likely not be possible. The high entropy nature of the token would make guessing the token infeasible.\u003c/p\u003e\n\n\u003cp\u003eTo the second point, while we don’t have a way to unlink via the settings, a user can invalidate these tokens by disabling and reenabling 2FA on their account. This will unbind all of the previous tokens linked to the account. A user can also delete the cookie from their device if they don’t want that device trusted any longer.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}