{"id":100938,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA5Mzg=","url":"https://hackerone.com/reports/100938","title":"An administrator without any permission is able to get order notifications using his APNS Token.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-22T12:16:06.681Z","submitted_at":"2015-11-22T12:16:06.681Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rms","url":"/rms","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/954/96084dbb997dff1d0904bd0642ca0a4d99df39dc_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-14T18:00:13.307Z","bug_reporter_agreed_on_going_public_at":"2015-12-03T18:37:06.521Z","team_member_agreed_on_going_public_at":"2015-12-14T18:00:13.163Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description**\n----\nAn administrator who lacks the 'Settings' permission is not able to add notifications through the UI. But the endpoint `shop.myshopify.com/admin/mobile_devices.json` does allow the unprivileged user to add his own device.\n\n\n\n**PoC**\n----\nThis PoC simply show how to get \u0026 re-use the mobile APNS Token.\n\n. Log in the Shopify phone app with a full access account\n. Intercept the request to `POST /admin/mobile_devices.json`\n. Remove all permissions of that account.\n. Remove the mobile notification added.\n. Replay the request to `POST /admin/mobile_devices.json`\n\nThe order notification has been added in `/admin/settings/notifications`\nMake an order, and the mobile will get the notification.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/h2\u003e\n\n\u003cp\u003eAn administrator who lacks the \u0026#39;Settings\u0026#39; permission is not able to add notifications through the UI. But the endpoint \u003ccode\u003eshop.myshopify.com/admin/mobile_devices.json\u003c/code\u003e does allow the unprivileged user to add his own device.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003e\u003cstrong\u003ePoC\u003c/strong\u003e\u003c/h2\u003e\n\n\u003cp\u003eThis PoC simply show how to get \u0026amp; re-use the mobile APNS Token.\u003c/p\u003e\n\n\u003cp\u003e. Log in the Shopify phone app with a full access account\u003cbr\u003e\n. Intercept the request to \u003ccode\u003ePOST /admin/mobile_devices.json\u003c/code\u003e\u003cbr\u003e\n. Remove all permissions of that account.\u003cbr\u003e\n. Remove the mobile notification added.\u003cbr\u003e\n. Replay the request to \u003ccode\u003ePOST /admin/mobile_devices.json\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe order notification has been added in \u003ccode\u003e/admin/settings/notifications\u003c/code\u003e\u003cbr\u003e\nMake an order, and the mobile will get the notification.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-01-02T18:37:06.729Z","allow_singular_disclosure_after":-157455260.37060702,"singular_disclosure_allowed":true,"vote_count":4,"voters":["rms","snappyjack","b73772bded7541989b54f6a","safisec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":694522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-11-22T12:16:07.709Z","updated_at":"2015-11-22T12:16:07.709Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":697971,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-24T18:24:15.086Z","updated_at":"2015-11-24T18:24:15.086Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707586,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We have resolved this issue by changing `/admin/mobile_devices.json` to require the Settings permission.\n\nOur next round of bounty decisions will take place sometime in the next week, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. We have resolved this issue by changing \u003ccode\u003e/admin/mobile_devices.json\u003c/code\u003e to require the Settings permission.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place sometime in the next week, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-03T18:34:47.044Z","updated_at":"2015-12-03T18:34:47.044Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rms","url":"/rms"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707590,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-03T18:37:06.596Z","updated_at":"2015-12-03T18:37:06.596Z","first_to_agree":true,"actor":{"username":"rms","cleared":false,"url":"/rms","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/954/96084dbb997dff1d0904bd0642ca0a4d99df39dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":714570,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Bounty decisions will take place early next week; sorry for the delay.","markdown_message":"\u003cp\u003eBounty decisions will take place early next week; sorry for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-09T18:46:50.051Z","updated_at":"2015-12-09T18:46:50.051Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":714708,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, thanks for the information.","markdown_message":"\u003cp\u003eNice, thanks for the information.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-09T19:50:49.515Z","updated_at":"2015-12-09T19:50:49.515Z","actor":{"username":"rms","cleared":false,"url":"/rms","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/954/96084dbb997dff1d0904bd0642ca0a4d99df39dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":719872,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-14T17:59:49.345Z","updated_at":"2015-12-14T17:59:49.345Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"rms","url":"/rms"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":719878,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-14T18:00:13.199Z","updated_at":"2015-12-14T18:00:13.199Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":719879,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-14T18:00:13.329Z","updated_at":"2015-12-14T18:00:13.329Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":720354,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-15T00:43:58.055Z","updated_at":"2015-12-15T00:43:58.055Z","actor":{"username":"rms","cleared":false,"url":"/rms","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/954/96084dbb997dff1d0904bd0642ca0a4d99df39dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}