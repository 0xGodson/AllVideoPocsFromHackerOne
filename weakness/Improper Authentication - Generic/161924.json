{"id":161924,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjE5MjQ=","url":"https://hackerone.com/reports/161924","title":"Password Reset Link issue","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-21T12:28:08.191Z","submitted_at":"2016-08-21T12:28:08.191Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"i1ackerone","url":"/i1ackerone","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/102/931/faf20c2420969d5a61d900a1b1b6b978222b7c31_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-23T12:16:57.893Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-08-24T12:16:43.820Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\ni found out about an issue in your password reset links and their expiration\nSteps to reproduce:\nRequest a password reset link to an account\nLogin to the account afterwards\nLogout and use the link to reset the password\nThe link would not be expired\n\nNow i know that the links need to expire after a certain time, but thinking logically there is no point of keeping the link alive once the user has logged in, It indicates the possibility that the user's original email has been compromised and the attacker has requested the link, This way the user's account can be compromised.\n\nAttack Scenario:\nAttacker requests the password reset link, User logs in, Link does not expire even after that. The attacker can use the link easily. Infact requesting a link when the account is logged in from a location should be prohibited to prevent compromise\n\nI think this should be fixed, \nThanks","vulnerability_information_html":"\u003cp\u003eHello,\u003cbr\u003e\ni found out about an issue in your password reset links and their expiration\u003cbr\u003e\nSteps to reproduce:\u003cbr\u003e\nRequest a password reset link to an account\u003cbr\u003e\nLogin to the account afterwards\u003cbr\u003e\nLogout and use the link to reset the password\u003cbr\u003e\nThe link would not be expired\u003c/p\u003e\n\n\u003cp\u003eNow i know that the links need to expire after a certain time, but thinking logically there is no point of keeping the link alive once the user has logged in, It indicates the possibility that the user\u0026#39;s original email has been compromised and the attacker has requested the link, This way the user\u0026#39;s account can be compromised.\u003c/p\u003e\n\n\u003cp\u003eAttack Scenario:\u003cbr\u003e\nAttacker requests the password reset link, User logs in, Link does not expire even after that. The attacker can use the link easily. Infact requesting a link when the account is logged in from a location should be prohibited to prevent compromise\u003c/p\u003e\n\n\u003cp\u003eI think this should be fixed, \u003cbr\u003e\nThanks\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-23T12:16:43.877Z","allow_singular_disclosure_after":-134583635.7970347,"singular_disclosure_allowed":true,"vote_count":5,"voters":["spetr0x","scept1c","dyabla","butterflydosuno","bhavins"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1143134,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-08-21T12:28:08.420Z","updated_at":"2016-08-21T12:28:08.420Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1143359,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Much appreciated!\n\nAt the moment we don't see an immediate security risk in this and consider this accepted risk.\n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003c/p\u003e\n\n\u003cp\u003eAt the moment we don\u0026#39;t see an immediate security risk in this and consider this accepted risk.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-21T18:49:18.942Z","updated_at":"2016-08-21T18:49:18.942Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1147266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"not any security risk? also added attacking scenario and other circumstances\n\nThere are many vectors where the factor remains about the attacker having access to at least something, And having access to the user's original email is nothing new i suppose.\nLately i have been clearly thinking about the likability of the attacks i am reporting, because at the end it is me who is loosing points here.\n\nLet me explain, If a user is logged in to his account, why would he request a password reset link, moreover notifying him or doing a logout would mean that at least some suspicious activity has taken place. ","markdown_message":"\u003cp\u003enot any security risk? also added attacking scenario and other circumstances\u003c/p\u003e\n\n\u003cp\u003eThere are many vectors where the factor remains about the attacker having access to at least something, And having access to the user\u0026#39;s original email is nothing new i suppose.\u003cbr\u003e\nLately i have been clearly thinking about the likability of the attacks i am reporting, because at the end it is me who is loosing points here.\u003c/p\u003e\n\n\u003cp\u003eLet me explain, If a user is logged in to his account, why would he request a password reset link, moreover notifying him or doing a logout would mean that at least some suspicious activity has taken place. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T10:31:59.013Z","updated_at":"2016-08-23T10:31:59.013Z","actor":{"username":"i1ackerone","cleared":false,"url":"/i1ackerone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/931/faf20c2420969d5a61d900a1b1b6b978222b7c31_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1151451,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"We've discussed this internally again a team member has voted to [add this change as security hardening](https://github.com/nextcloud/server/pull/1024). This means it will be included in our next major release but not backported to older releases.\n\nWe do however believe that this does not meet the minimum requirements for a monetary bounty. We'd however be happy to provide you with some swag.","markdown_message":"\u003cp\u003eWe\u0026#39;ve discussed this internally again a team member has voted to \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F1024\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eadd this change as security hardening\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This means it will be included in our next major release but not backported to older releases.\u003c/p\u003e\n\n\u003cp\u003eWe do however believe that this does not meet the minimum requirements for a monetary bounty. We\u0026#39;d however be happy to provide you with some swag.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-24T12:16:05.027Z","updated_at":"2016-08-24T12:16:37.220Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1151452,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T12:16:12.570Z","updated_at":"2016-08-24T12:16:12.570Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"i1ackerone","url":"/i1ackerone"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1151453,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T12:16:18.726Z","updated_at":"2016-08-24T12:16:18.726Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"i1ackerone","url":"/i1ackerone"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1151454,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T12:16:24.479Z","updated_at":"2016-08-24T12:16:24.479Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1151456,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T12:16:43.850Z","updated_at":"2016-08-24T12:16:43.850Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1153690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for shirt, i am sending this T to my teacher from Pakistan.\n\nSorry i dont want to disclose it, contacted H1 support for it.\n\nHope it dosent effect ur program.\nThanks","markdown_message":"\u003cp\u003eThanks for shirt, i am sending this T to my teacher from Pakistan.\u003c/p\u003e\n\n\u003cp\u003eSorry i dont want to disclose it, contacted H1 support for it.\u003c/p\u003e\n\n\u003cp\u003eHope it dosent effect ur program.\u003cbr\u003e\nThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-25T12:46:06.331Z","updated_at":"2016-08-25T12:47:54.070Z","actor":{"username":"i1ackerone","cleared":false,"url":"/i1ackerone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/931/faf20c2420969d5a61d900a1b1b6b978222b7c31_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"my friend didnt got shirt till now, its 23rd day PLEASE iNFORM ME AND SHARE TRACKING LINK\nplus i requested that i dont want to disclose, already stated there and already contacted H1.\n\n","markdown_message":"\u003cp\u003emy friend didnt got shirt till now, its 23rd day PLEASE iNFORM ME AND SHARE TRACKING LINK\u003cbr\u003e\nplus i requested that i dont want to disclose, already stated there and already contacted H1.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-17T17:17:24.289Z","updated_at":"2016-09-17T17:17:24.289Z","actor":{"username":"i1ackerone","cleared":false,"url":"/i1ackerone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/931/faf20c2420969d5a61d900a1b1b6b978222b7c31_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1212482,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-23T12:16:57.980Z","updated_at":"2016-09-23T12:16:57.980Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1339857,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"my friend didnt got shirt till now, its 2months ago\n PLEASE iNFORM ME AND SHARE TRACKING LINK\nplus i requested that i dont want to disclose, already stated there and already contacted H1.","markdown_message":"\u003cp\u003emy friend didnt got shirt till now, its 2months ago\u003cbr\u003e\n PLEASE iNFORM ME AND SHARE TRACKING LINK\u003cbr\u003e\nplus i requested that i dont want to disclose, already stated there and already contacted H1.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-04T14:46:31.106Z","updated_at":"2016-12-04T14:46:48.672Z","actor":{"username":"i1ackerone","cleared":false,"url":"/i1ackerone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/931/faf20c2420969d5a61d900a1b1b6b978222b7c31_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1341375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e my friend didnt got shirt till now, its 2months ago\n\u003e PLEASE iNFORM ME AND SHARE TRACKING LINK\n\nWe don't have any tracking link as that has been sent via regular post. Please send a quick mail to security@nextcloud.com including your address and we can do some research on that.\n\n\u003e plus i requested that i dont want to disclose, already stated there and already contacted H1.\n\nAs per our policy we publicly disclose all fixed reports.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003emy friend didnt got shirt till now, its 2months ago\u003cbr\u003e\nPLEASE iNFORM ME AND SHARE TRACKING LINK\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe don\u0026#39;t have any tracking link as that has been sent via regular post. Please send a quick mail to \u003ca title=\"security@nextcloud.com\" href=\"mailto:security@nextcloud.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@nextcloud.com\u003c/a\u003e including your address and we can do some research on that.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eplus i requested that i dont want to disclose, already stated there and already contacted H1.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs per our policy we publicly disclose all fixed reports.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-05T14:54:18.335Z","updated_at":"2016-12-05T14:54:24.757Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}