{"id":56177,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjE3Nw==","url":"https://hackerone.com/reports/56177","title":"SMTP protection not used","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-13T21:03:03.437Z","submitted_at":"2015-04-13T21:03:03.437Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"shubham","url":"/shubham","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1526,"url":"https://hackerone.com/coinspace","handle":"coinspace","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/526/8b8013d522c309d7993c44f3a221eac68c393b1f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/526/8b8013d522c309d7993c44f3a221eac68c393b1f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coin.Space","twitter_handle":"coin_space","website":"https://coin.space","about":"Coin.Space HD Wallet is a free online bitcoin wallet, which you can use to make worldwide payments for free. "}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-06-10T23:51:43.406Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-05-11T23:51:38.728Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\r\n\r\nI'm checking your website found spf record there.\r\nYou should apply strict **SMPT policy** to stop spoofed email sending from your domain.\r\n\r\nAn attacker would send a Fake email from security@coin.space saying that Please change your password, The victim is aware of phishing attacks, But when he sees that the mail originated from security@coin.space , He has no other way than to believe it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his coin.space id and pin (SESSION COOKIE). The results can be more dangerous.\r\n\r\n```\r\n\u003c?php\r\n$to = \"VICTIM@example.com\";\r\n$subject = \"Password Change\";\r\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\r\n$headers = \"From: security@coin.space\";\r\nmail($to,$subject,$txt,$headers);\r\n?\u003e\r\n```\r\n\r\n**Fix**\r\n\r\nYour SPF record is `v=spf1 include:_spf.google.com ~all`\r\n\r\nIt should be `v=spf1 include:_spf.google.com -all`\r\n\r\nI strongly recommend you to read this article :\r\n\r\nhttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\r\n\r\nThe problem\r\nThe article clearly shows difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. in your SPF record you should replace `~` with `-` at last before all , `-` is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using `~` , you should use `-`\r\n\r\nBest Regard\r\n**Shubham**","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m checking your website found spf record there.\u003cbr\u003e\nYou should apply strict \u003cstrong\u003eSMPT policy\u003c/strong\u003e to stop spoofed email sending from your domain.\u003c/p\u003e\n\n\u003cp\u003eAn attacker would send a Fake email from \u003ca title=\"security@coin.space\" href=\"mailto:security@coin.space\" rel=\"nofollow noopener noreferrer\"\u003esecurity@coin.space\u003c/a\u003e saying that Please change your password, The victim is aware of phishing attacks, But when he sees that the mail originated from \u003ca title=\"security@coin.space\" href=\"mailto:security@coin.space\" rel=\"nofollow noopener noreferrer\"\u003esecurity@coin.space\u003c/a\u003e , He has no other way than to believe it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his coin.space id and pin (SESSION COOKIE). The results can be more dangerous.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;VICTIM@example.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Password Change\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Change your password by visiting here - [VIRUS LINK HERE]l\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;From: security@coin.space\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eFix\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eYour SPF record is \u003ccode\u003ev=spf1 include:_spf.google.com ~all\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIt should be \u003ccode\u003ev=spf1 include:_spf.google.com -all\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI strongly recommend you to read this article :\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe problem\u003cbr\u003e\nThe article clearly shows difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. in your SPF record you should replace \u003ccode\u003e~\u003c/code\u003e with \u003ccode\u003e-\u003c/code\u003e at last before all , \u003ccode\u003e-\u003c/code\u003e is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using \u003ccode\u003e~\u003c/code\u003e , you should use \u003ccode\u003e-\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBest Regard\u003cbr\u003e\n\u003cstrong\u003eShubham\u003c/strong\u003e\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-06-10T23:51:39.455Z","allow_singular_disclosure_after":-175242526.4327691,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":379738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you, but we only use coinspace.ch as a marketing site and coin.space for the App. So we never send emails from these domain, there are other coinspace.com domains that we do not own that could also be confusing for users, but since we do not have any usernames or password we believe it is very limited that spoof emails are sent from any of our domains.  And no real customer account information can be collected via a email spoof. ","markdown_message":"\u003cp\u003eThank you, but we only use coinspace.ch as a marketing site and coin.space for the App. So we never send emails from these domain, there are other coinspace.com domains that we do not own that could also be confusing for users, but since we do not have any usernames or password we believe it is very limited that spoof emails are sent from any of our domains.  And no real customer account information can be collected via a email spoof. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-14T15:12:33.332Z","updated_at":"2015-04-14T15:12:33.332Z","actor":{"username":"jspeigner","cleared":false,"url":"/jspeigner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/359/5440e5f1c04b187c419e07e9ada35affc96a97f2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":379752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've checked coinspace.ch there is no spf record.","markdown_message":"\u003cp\u003eI\u0026#39;ve checked coinspace.ch there is no spf record.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-14T15:21:13.362Z","updated_at":"2015-04-14T15:21:13.362Z","actor":{"username":"shubham","cleared":false,"url":"/shubham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":379778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That is correct. This bug tracker is for coin.space only not any of our other domains. ","markdown_message":"\u003cp\u003eThat is correct. This bug tracker is for coin.space only not any of our other domains. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-14T15:46:42.369Z","updated_at":"2015-04-14T15:46:42.369Z","actor":{"username":"jspeigner","cleared":false,"url":"/jspeigner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/359/5440e5f1c04b187c419e07e9ada35affc96a97f2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":379790,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"but when attacker send a email from coinspace.ch email, when he sees that the mail originated from security@coinspace.ch , He has no other way than to believe it.","markdown_message":"\u003cp\u003ebut when attacker send a email from coinspace.ch email, when he sees that the mail originated from \u003ca title=\"security@coinspace.ch\" href=\"mailto:security@coinspace.ch\" rel=\"nofollow noopener noreferrer\"\u003esecurity@coinspace.ch\u003c/a\u003e , He has no other way than to believe it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-14T15:55:40.482Z","updated_at":"2015-04-14T15:55:40.482Z","actor":{"username":"shubham","cleared":false,"url":"/shubham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":380131,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We do not send emails out and someone could send from a domain like coinspace.it and also confuse a person. Since we do not have usernames and passwords for login to the App we believe this to not be a risk. Thank you for reporting it but it is not an issue for our users. ","markdown_message":"\u003cp\u003eWe do not send emails out and someone could send from a domain like coinspace.it and also confuse a person. Since we do not have usernames and passwords for login to the App we believe this to not be a risk. Thank you for reporting it but it is not an issue for our users. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-14T22:09:04.917Z","updated_at":"2015-04-14T22:09:04.917Z","actor":{"username":"jspeigner","cleared":false,"url":"/jspeigner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/359/5440e5f1c04b187c419e07e9ada35affc96a97f2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"shubham","url":"/shubham"},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":380132,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-14T22:09:29.776Z","updated_at":"2015-04-14T22:09:29.776Z","actor":{"url":"/coinspace","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/526/8b8013d522c309d7993c44f3a221eac68c393b1f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coin.Space"}},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":385359,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-20T12:43:01.794Z","updated_at":"2015-04-20T12:43:01.794Z","additional_data":{"duplicate_report_id":57190},"actor":{"username":"booduck","cleared":false,"url":"/booduck","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":385393,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-20T13:00:10.817Z","updated_at":"2015-04-20T13:00:10.817Z","additional_data":{"duplicate_report_id":57397},"actor":{"username":"d1pakda5","cleared":false,"url":"/d1pakda5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UvqpiRvrgrhwxihriHuhrDme/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":387417,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-22T16:47:45.619Z","updated_at":"2015-04-22T16:47:45.619Z","additional_data":{"duplicate_report_id":57612},"actor":{"username":"mehulmpt","cleared":false,"url":"/mehulmpt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/186/2b128bccadf8f6a7258cbcbf0c4fb0c1f85a46ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":392091,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-28T01:12:19.136Z","updated_at":"2015-04-28T01:12:19.136Z","additional_data":{"duplicate_report_id":58712},"actor":{"username":"0x0x0x0x0x","cleared":false,"url":"/0x0x0x0x0x","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/859/d8505908ed23084af145156816969b2e90200f45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No Hall of fame too ?\n","markdown_message":"\u003cp\u003eNo Hall of fame too ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-11T22:59:56.542Z","updated_at":"2015-05-11T22:59:56.542Z","actor":{"username":"0x0x0x0x0x","cleared":false,"url":"/0x0x0x0x0x","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/859/d8505908ed23084af145156816969b2e90200f45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408674,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-11T23:51:38.782Z","updated_at":"2015-05-11T23:51:38.782Z","first_to_agree":true,"actor":{"username":"jspeigner","cleared":false,"url":"/jspeigner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/359/5440e5f1c04b187c419e07e9ada35affc96a97f2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":408710,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-12T00:08:16.290Z","updated_at":"2015-05-12T00:08:16.290Z","additional_data":{"duplicate_report_id":59157},"actor":{"username":"hacker00000000","cleared":false,"url":"/hacker00000000","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":449961,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-10T23:51:43.620Z","updated_at":"2015-06-10T23:51:43.620Z","actor":{"url":"/coinspace","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/526/8b8013d522c309d7993c44f3a221eac68c393b1f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coin.Space"}},"genius_execution_id":null,"team_handle":"coinspace","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}