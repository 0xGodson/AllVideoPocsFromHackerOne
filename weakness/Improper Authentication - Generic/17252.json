{"id":17252,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI1Mg==","url":"https://hackerone.com/reports/17252","title":"All Active user sessions should be destroyed when user change his password!","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-06-23T02:02:14.475Z","submitted_at":"2014-06-23T02:02:14.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"faisalahmed","url":"/faisalahmed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":230,"url":"https://hackerone.com/uzbey","handle":"uzbey","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/230/31db3ca09aa073798698f713a4c01d0e9faf39aa_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/230/31db3ca09aa073798698f713a4c01d0e9faf39aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uzbey","twitter_handle":"","website":"https://staging.uzbey.com/","about":"The goal of Uzbey is to create the worlds largest selfie to be launched into space. test @jobert"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-30T20:56:00.450Z","bug_reporter_agreed_on_going_public_at":"2014-07-30T20:56:00.298Z","team_member_agreed_on_going_public_at":"2014-07-08T18:48:41.540Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\nThere is an user sessions issue on your application that should be fixed.\r\n\r\nProof of Concept\r\n------------------------\r\nSuppose, you have an account on **uzbey**\r\nSomehow an attacker manage to get your password and logged in your account.. after knowing that your ID has been compromised what you'll do ?\r\ni guess first thing that will popup into your head is, \"I should change my password!\" and you'll change the password.. maximum users just change his/her password when they recover their ID.\r\nin **uzbey**, changing the password doesn't destroys the other sessions which are logged in with old passwords.\r\n(Logging in with the new password doesn't invalidate the older sessions either)\r\nAs other sessions is not destroyed, attacker will be still logged in your account even after changing password, cause his session is still active.. he'll have complete access on your account till that session expires!\r\nSo, your account remains insecure even after the changing of password.\r\n\r\nPATCH\r\n----------\r\n\r\n* When someone change his/her password, each and every active sessions that belongs to that particular account must be destroyed!\r\n* I would recommend you to follow Facebook on this security issue.. They fixed this issue few months back by adding a process that asks users whether user want to close all open sessions or not right after changing password.\r\n\r\nSo there is two way, either you let users to choose if they want to keep active sessions or just destroy every active sessions when users change his/her password!\r\n\r\nI look forward to hearing from you!\r\n\r\nThanks and Best Wishes.","vulnerability_information_html":"\u003cp\u003eHello,\u003cbr\u003e\nThere is an user sessions issue on your application that should be fixed.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\n\u003cp\u003eSuppose, you have an account on \u003cstrong\u003euzbey\u003c/strong\u003e\u003cbr\u003e\nSomehow an attacker manage to get your password and logged in your account.. after knowing that your ID has been compromised what you\u0026#39;ll do ?\u003cbr\u003e\ni guess first thing that will popup into your head is, \u0026quot;I should change my password!\u0026quot; and you\u0026#39;ll change the password.. maximum users just change his/her password when they recover their ID.\u003cbr\u003e\nin \u003cstrong\u003euzbey\u003c/strong\u003e, changing the password doesn\u0026#39;t destroys the other sessions which are logged in with old passwords.\u003cbr\u003e\n(Logging in with the new password doesn\u0026#39;t invalidate the older sessions either)\u003cbr\u003e\nAs other sessions is not destroyed, attacker will be still logged in your account even after changing password, cause his session is still active.. he\u0026#39;ll have complete access on your account till that session expires!\u003cbr\u003e\nSo, your account remains insecure even after the changing of password.\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePATCH\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eWhen someone change his/her password, each and every active sessions that belongs to that particular account must be destroyed!\u003c/li\u003e\n\u003cli\u003eI would recommend you to follow Facebook on this security issue.. They fixed this issue few months back by adding a process that asks users whether user want to close all open sessions or not right after changing password.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSo there is two way, either you let users to choose if they want to keep active sessions or just destroy every active sessions when users change his/her password!\u003c/p\u003e\n\n\u003cp\u003eI look forward to hearing from you!\u003c/p\u003e\n\n\u003cp\u003eThanks and Best Wishes.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-07T18:48:41.702Z","allow_singular_disclosure_after":-201779556.13427892,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":77514,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-23T06:40:23.948Z","updated_at":"2014-06-23T06:40:23.948Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":80194,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello,\nThis issue is fixed now. Please confirm that you are no longer able to reproduce this issue.\n\nThank you for your report.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThis issue is fixed now. Please confirm that you are no longer able to reproduce this issue.\u003c/p\u003e\n\n\u003cp\u003eThank you for your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-27T20:17:46.306Z","updated_at":"2014-06-27T20:17:46.306Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"faisalahmed","url":"/faisalahmed"},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":80377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm no longer able to reproduce it.\ngood job :)\n\nThank you!","markdown_message":"\u003cp\u003eI\u0026#39;m no longer able to reproduce it.\u003cbr\u003e\ngood job :)\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-28T01:26:47.170Z","updated_at":"2014-06-28T01:26:47.170Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86202,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-08T18:48:41.556Z","updated_at":"2014-07-08T18:48:41.556Z","first_to_agree":true,"actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98476,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-30T20:56:00.313Z","updated_at":"2014-07-30T20:56:00.313Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98477,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-30T20:56:00.466Z","updated_at":"2014-07-30T20:56:00.466Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uzbey","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}