{"id":346217,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDYyMTc=","url":"https://hackerone.com/reports/346217","title":"Persistent XSS - Selecting users as allowed merge request approvers","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-01T19:54:11.493Z","submitted_at":"2018-05-01T19:54:11.493Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"phillycheeze","url":"/phillycheeze","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-16T17:19:23.297Z","bug_reporter_agreed_on_going_public_at":"2018-06-26T20:55:59.382Z","team_member_agreed_on_going_public_at":"2018-07-16T17:19:23.162Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nWhen using the dropdown that selects the users that are allowed to approve a merge request, it is possible to trigger a XSS with a malicious user name string.\n\n**Description:**\nThis vulnerability is similar to the recently announced CVE-2018-10379 (and another vulnerability I recently reported here in hackerone).\n\nThe steps to reproduce are fairly simple but there are some restrictions:\n\n  *  Only members of a project with Master access are able to become victims of the XSS\n  *  Only groups/members with a subscription level of Starter or higher are able to perform the XSS. This is a premium feature only allowed at Starter or higher. (https://gitlab.com/help/user/project/merge_requests/merge_request_approvals)\n\n## Steps To Reproduce:\n\n  1. Set your own username as \"\u003cimg src=x onerror=alert(document.domain)\u003e foo / bar\"\n  1. Make yourself have at least Master access to a project\n  1. Under Project Settings -\u003e General -\u003e Merge Request Settings,click the \"Merge request approvals\" checkbox\n  1. Select the user dropdown input for selecting eligible users to approve merge requests\n  1. Notice that the onerror attribute from the username renders.\n\n## Supporting Material/References:\n\nMore information can be provided upon request.\n\n## Suggested Remediation\n\nLike the previous report I submitted, it is due to improper sanitization in a JS file.  I believe this is the offending line: https://gitlab.com/gitlab-org/gitlab-ee/blob/master/ee/app/assets/javascripts/approvers_select.js#L134\n\n## Impact\n\nThe security impact is the same as any typical persistent xss.\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://gitlab.com/group/project/edit\n\n**Verified**\nYes\n\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nWhen using the dropdown that selects the users that are allowed to approve a merge request, it is possible to trigger a XSS with a malicious user name string.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThis vulnerability is similar to the recently announced CVE-2018-10379 (and another vulnerability I recently reported here in hackerone).\u003c/p\u003e\n\n\u003cp\u003eThe steps to reproduce are fairly simple but there are some restrictions:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e Only members of a project with Master access are able to become victims of the XSS\u003c/li\u003e\n\u003cli\u003e Only groups/members with a subscription level of Starter or higher are able to perform the XSS. This is a premium feature only allowed at Starter or higher. (\u003ca title=\"https://gitlab.com/help/user/project/merge_requests/merge_request_approvals\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fhelp%2Fuser%2Fproject%2Fmerge_requests%2Fmerge_request_approvals\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/help/user/project/merge_requests/merge_request_approvals\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eSet your own username as \u0026quot;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; foo / bar\u0026quot;\u003c/li\u003e\n\u003cli\u003eMake yourself have at least Master access to a project\u003c/li\u003e\n\u003cli\u003eUnder Project Settings -\u0026gt; General -\u0026gt; Merge Request Settings,click the \u0026quot;Merge request approvals\u0026quot; checkbox\u003c/li\u003e\n\u003cli\u003eSelect the user dropdown input for selecting eligible users to approve merge requests\u003c/li\u003e\n\u003cli\u003eNotice that the onerror attribute from the username renders.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eMore information can be provided upon request.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-remediation\"\u003eSuggested Remediation\u003c/h2\u003e\n\n\u003cp\u003eLike the previous report I submitted, it is due to improper sanitization in a JS file.  I believe this is the offending line: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ee/blob/master/ee/app/assets/javascripts/approvers_select.js#L134\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ee%2Fblob%2Fmaster%2Fee%2Fapp%2Fassets%2Fjavascripts%2Fapprovers_select.js%23L134\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ee/blob/master/ee/app/assets/javascripts/approvers_select.js#L134\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe security impact is the same as any typical persistent xss.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-site Scripting (XSS) - Stored\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://gitlab.com/group/project/edit\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgroup%2Fproject%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/group/project/edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-26T20:55:59.511Z","allow_singular_disclosure_after":-76581860.68589872,"singular_disclosure_allowed":true,"vote_count":10,"voters":["phillycheeze","muon4","eveeez","apapedulimu","khizer47","0x08","jamyboy","drik","yyyyyyyy","amrhacker"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2701316,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-04T17:30:44.783Z","updated_at":"2018-05-04T17:30:44.783Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":148242,"new_severity_id":149551},"actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2701361,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello, Phillip,\n\nThank you for submitting this report.  Due to the limited impact due the license and user/project relationship, I've adjusted the severity to Medium.  We will be tracking the issue internally at https://gitlab.com/gitlab-org/gitlab-ee/issues/5892.   The issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\n\nFeel free to contact us at anytime if you need an update.\n\nRegards,\nAntony","markdown_message":"\u003cp\u003eHello, Phillip,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.  Due to the limited impact due the license and user/project relationship, I\u0026#39;ve adjusted the severity to Medium.  We will be tracking the issue internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ee/issues/5892\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ee%2Fissues%2F5892\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ee/issues/5892\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.   The issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\u003c/p\u003e\n\n\u003cp\u003eFeel free to contact us at anytime if you need an update.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAntony\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-04T17:42:52.324Z","updated_at":"2018-05-04T17:42:52.324Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2730085,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!\n\nA second report I filed that is extremely similar to this one was marked as a High severity rating. See: https://gitlab.com/gitlab-org/gitlab-ce/issues/45994\n\nJust letting you know because the scopes are the same for both bugs.","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003eA second report I filed that is extremely similar to this one was marked as a High severity rating. See: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/45994\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F45994\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/45994\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eJust letting you know because the scopes are the same for both bugs.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-11T17:18:00.450Z","updated_at":"2018-05-11T17:18:00.450Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2740583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've recently made some additions to our program descriptions regarding adjustments to scope based on number of users potentially impacted, so I think these ones fell in between.  We will keep this in mind when assigning bounty amounts.\n\n/cc @jritchey ","markdown_message":"\u003cp\u003eWe\u0026#39;ve recently made some additions to our program descriptions regarding adjustments to scope based on number of users potentially impacted, so I think these ones fell in between.  We will keep this in mind when assigning bounty amounts.\u003c/p\u003e\n\n\u003cp\u003e/cc \u003ca href=\"/jritchey\"\u003e@jritchey\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-14T17:02:30.448Z","updated_at":"2018-05-14T17:02:30.448Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2814793,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @phillycheeze ,\n\nThis issue has been addressed in the most recent security release: https://about.gitlab.com/2018/05/29/security-release-gitlab-10-dot-8-dot-2-released/\n\nThank you for the report,\nGitlab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/phillycheeze\"\u003e@phillycheeze\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThis issue has been addressed in the most recent security release: \u003ca title=\"https://about.gitlab.com/2018/05/29/security-release-gitlab-10-dot-8-dot-2-released/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2F2018%2F05%2F29%2Fsecurity-release-gitlab-10-dot-8-dot-2-released%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/2018/05/29/security-release-gitlab-10-dot-8-dot-2-released/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for the report,\u003cbr\u003e\nGitlab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-29T23:47:56.091Z","updated_at":"2018-05-29T23:47:56.091Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"phillycheeze","url":"/phillycheeze"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2938131,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Was made public here: https://gitlab.com/gitlab-org/gitlab-ce/issues/45994","markdown_message":"\u003cp\u003eWas made public here: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/45994\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F45994\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/45994\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-26T20:55:59.430Z","updated_at":"2018-06-26T20:55:59.430Z","first_to_agree":true,"actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3052795,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Setting to public","markdown_message":"\u003cp\u003eSetting to public\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-16T17:19:23.201Z","updated_at":"2018-07-16T17:19:23.201Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3052796,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-16T17:19:23.340Z","updated_at":"2018-07-16T17:19:23.340Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}