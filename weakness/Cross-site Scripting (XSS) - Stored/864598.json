{"id":864598,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjQ1OTg=","url":"https://hackerone.com/reports/864598","title":"[panel.city-mobil.ru/admin/] Blind XSS via partner name (similar to #746505)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-05-02T06:59:55.005Z","submitted_at":"2020-05-02T06:59:55.005Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"act1on3","url":"/act1on3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Cvg2UMwEE7txwhP1kpsLdqWx/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-01T14:54:13.308Z","bug_reporter_agreed_on_going_public_at":"2020-10-01T14:54:13.208Z","team_member_agreed_on_going_public_at":"2020-10-01T14:42:29.662Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-10-31T14:42:29.757Z","allow_singular_disclosure_after":-5070033.427013787,"singular_disclosure_allowed":true,"vote_count":10,"voters":["secator","maxarr","ms-13","what_web","sheerwood","sa1tama0","rushhacker10","yubo","vldrn","yousif_f"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":40415,"asset_type":"OTHER","asset_identifier":"Citymobil","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7885211,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-04T09:24:43.949Z","updated_at":"2020-05-04T09:24:43.949Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7900294,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-05T15:15:57.142Z","updated_at":"2020-05-05T15:15:57.142Z","actor":{"username":"act1on3","cleared":false,"url":"/act1on3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Cvg2UMwEE7txwhP1kpsLdqWx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7927100,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-07T14:32:58.558Z","updated_at":"2020-05-07T14:32:58.558Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"act1on3","url":"/act1on3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7985370,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T07:07:29.868Z","updated_at":"2020-05-13T07:07:29.868Z","actor":{"username":"m_ar","cleared":false,"url":"/m_ar","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"act1on3","url":"/act1on3"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9386695,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-01T14:42:29.685Z","updated_at":"2020-10-01T14:42:29.685Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9386806,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-01T14:54:13.236Z","updated_at":"2020-10-01T14:54:13.236Z","actor":{"username":"act1on3","cleared":false,"url":"/act1on3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Cvg2UMwEE7txwhP1kpsLdqWx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9386807,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-01T14:54:13.356Z","updated_at":"2020-10-01T14:54:13.356Z","actor":{"username":"act1on3","cleared":false,"url":"/act1on3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Cvg2UMwEE7txwhP1kpsLdqWx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24674,"category":"team","content":"It was possible to cause XSS condition in admin panel of Citymobil by setting malformed partner name in https://fleet.city-mobil.ru/front/ ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIt was possible to cause XSS condition in admin panel of Citymobil by setting malformed partner name in \u003ca title=\"https://fleet.city-mobil.ru/front/\" href=\"/redirect?url=https%3A%2F%2Ffleet.city-mobil.ru%2Ffront%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://fleet.city-mobil.ru/front/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n"},{"id":24676,"category":"researcher","content":"The issue is really similar to [#746505](https://hackerone.com/reports/746505).\nThe original issue was exploited via editing an existed user - we could add blind XSS payload during user editing. The original issue was fixed with input encoding. It means that encoding was performed during saving information about an existed user.\n\nI was able to bypass a fix via another action. I've created a new user with XSS payload as a name and received a callback. Input encoding hasn't been performed for that action.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe issue is really similar to \u003ca href=\"https://hackerone.com/reports/746505\"\u003e#746505\u003c/a\u003e.\u003cbr\u003e\nThe original issue was exploited via editing an existed user - we could add blind XSS payload during user editing. The original issue was fixed with input encoding. It means that encoding was performed during saving information about an existed user.\u003c/p\u003e\n\n\u003cp\u003eI was able to bypass a fix via another action. I\u0026#39;ve created a new user with XSS payload as a name and received a callback. Input encoding hasn\u0026#39;t been performed for that action.\u003c/p\u003e\n"}]}