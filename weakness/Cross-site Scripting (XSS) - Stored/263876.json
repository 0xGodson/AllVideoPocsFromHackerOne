{"id":263876,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjM4NzY=","url":"https://hackerone.com/reports/263876","title":"Stored XSS Deleting Menu Links in the Shopify Admin","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-28T02:27:45.917Z","submitted_at":"2017-08-28T02:27:45.917Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4z1zu","url":"/4z1zu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-08T16:40:57.521Z","bug_reporter_agreed_on_going_public_at":"2017-09-03T07:06:36.702Z","team_member_agreed_on_going_public_at":"2017-09-08T16:40:57.457Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team,\n\nI found a stored xss issue.\n\nPoC (unlisted): https://youtu.be/MjnKyFgqTTo\n\nwatch my PoC than you'll understood everything.\n\nPayloads: // # \"\u003e\u003csvg/onload=prompt(1)\u003e\n\nLooks Like this issue available at \" Title in Add menu \" and also available at \"Title\" in \" Menu Item \"\n\nMirror: https://azizvai.myshopify.com/\n\nThanks","vulnerability_information_html":"\u003cp\u003eHello Team,\u003c/p\u003e\n\n\u003cp\u003eI found a stored xss issue.\u003c/p\u003e\n\n\u003cp\u003ePoC (unlisted): \u003ca title=\"https://youtu.be/MjnKyFgqTTo\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FMjnKyFgqTTo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/MjnKyFgqTTo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ewatch my PoC than you\u0026#39;ll understood everything.\u003c/p\u003e\n\n\u003cp\u003ePayloads: // # \u0026quot;\u0026gt;\u0026lt;svg/onload=prompt(1)\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eLooks Like this issue available at \u0026quot; Title in Add menu \u0026quot; and also available at \u0026quot;Title\u0026quot; in \u0026quot; Menu Item \u0026quot;\u003c/p\u003e\n\n\u003cp\u003eMirror: \u003ca title=\"https://azizvai.myshopify.com/\" href=\"/redirect?url=https%3A%2F%2Fazizvai.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://azizvai.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":216380,"file_name":"Screenshot_128.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/216/380/607da87fbdb88e1d5c6fba6b4b7e2dedde48a811/Screenshot_128.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_128.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_128.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051625Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=6b8afc14155678ea595127fe5e64442423e2ec3c8c6bd13e5d099d31c913d392","file_size":192404,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":31,"voters":["sp1d3rs","flashdisk","003random","icanthack","fa1rlight","cuso4","eveeez","r3y","harry_mg","grampae","and 21 more..."],"severity":{"rating":"medium","score":6.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1959690,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T13:29:52.485Z","updated_at":"2017-08-28T13:29:52.485Z","additional_data":{"old_title":"Shopify Stored XSS Vulnerability","new_title":"Stored XSS Deleting Menu Links in the Shopify Admin"},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1959695,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T13:32:48.639Z","updated_at":"2017-08-28T13:32:48.639Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1960157,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently deployed a fix for this issue.\n\nWe'll get back to you within the next few days, once we decide on a bounty amount.","markdown_message":"\u003cp\u003eThanks again for your report. We recently deployed a fix for this issue.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll get back to you within the next few days, once we decide on a bounty amount.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T15:16:22.585Z","updated_at":"2017-08-28T15:16:22.585Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"4z1zu","url":"/4z1zu"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1960174,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Waiting For The Bounty :) Thanks","markdown_message":"\u003cp\u003eWaiting For The Bounty :) Thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T15:20:03.103Z","updated_at":"2017-08-28T15:20:03.103Z","actor":{"username":"4z1zu","cleared":false,"url":"/4z1zu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"updates ?","markdown_message":"\u003cp\u003eupdates ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T20:57:54.065Z","updated_at":"2017-08-31T20:57:54.065Z","actor":{"username":"4z1zu","cleared":false,"url":"/4z1zu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@azizs3curity We'll get back to you soon. Thank you for your patience.","markdown_message":"\u003cp\u003e\u003ca href=\"/azizs3curity\"\u003e@azizs3curity\u003c/a\u003e We\u0026#39;ll get back to you soon. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T21:27:49.252Z","updated_at":"2017-08-31T21:27:49.252Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1973410,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T07:06:36.735Z","updated_at":"2017-09-03T07:06:36.735Z","first_to_agree":true,"actor":{"username":"4z1zu","cleared":false,"url":"/4z1zu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1973414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@clayton updates ?","markdown_message":"\u003cp\u003e\u003ca href=\"/clayton\"\u003e@clayton\u003c/a\u003e updates ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-03T07:13:04.253Z","updated_at":"2017-09-03T07:13:04.253Z","actor":{"username":"4z1zu","cleared":false,"url":"/4z1zu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1978895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Team, Any Updates ?","markdown_message":"\u003cp\u003eHello Team, Any Updates ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-06T03:23:41.189Z","updated_at":"2017-09-06T03:23:41.189Z","actor":{"username":"4z1zu","cleared":false,"url":"/4z1zu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9rGP8X7FcY1s8cJhmMVUdRT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1979595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@azizs3curity Sorry for the delay. We expect to process bounty payments within the next day.","markdown_message":"\u003cp\u003e\u003ca href=\"/azizs3curity\"\u003e@azizs3curity\u003c/a\u003e Sorry for the delay. We expect to process bounty payments within the next day.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-06T13:14:02.783Z","updated_at":"2017-09-06T13:14:02.783Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1985331,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you again for this report @azizs3curity. I've updated the summary of this report to mention why this report is rewarded, even though most of the XSS reports we typically receive are excluded from our program. We're looking forward to receiving more valid XSS reports like this one!","markdown_message":"\u003cp\u003eThank you again for this report \u003ca href=\"/azizs3curity\"\u003e@azizs3curity\u003c/a\u003e. I\u0026#39;ve updated the summary of this report to mention why this report is rewarded, even though most of the XSS reports we typically receive are excluded from our program. We\u0026#39;re looking forward to receiving more valid XSS reports like this one!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-08T16:40:37.566Z","updated_at":"2017-09-08T16:40:37.566Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"4z1zu","url":"/4z1zu"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1985332,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-08T16:40:57.479Z","updated_at":"2017-09-08T16:40:57.479Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1985333,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-08T16:40:57.541Z","updated_at":"2017-09-08T16:40:57.541Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2890018,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T18:50:23.462Z","updated_at":"2018-06-15T18:50:23.462Z","additional_data":{"old_severity":null,"new_severity":"Medium (6.4)","old_severity_id":null,"new_severity_id":168652},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5297,"category":"team","content":"The researcher found that menu titles were being rendered without proper escaping in the admin area. Unlike many other XSS reports we typically receive, this one has its payload excluded in a way that is not excluded in our [program page's exclusion list](https://hackerone.com/shopify).","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe researcher found that menu titles were being rendered without proper escaping in the admin area. Unlike many other XSS reports we typically receive, this one has its payload excluded in a way that is not excluded in our \u003ca href=\"https://hackerone.com/shopify\"\u003eprogram page\u0026#39;s exclusion list\u003c/a\u003e.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}