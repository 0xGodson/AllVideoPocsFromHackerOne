{"id":674426,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzQ0MjY=","url":"https://hackerone.com/reports/674426","title":"XSS For Profile Name","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-15T09:48:11.561Z","submitted_at":"2019-08-15T09:48:11.561Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mindingdata","url":"/mindingdata","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-25T19:41:54.386Z","bug_reporter_agreed_on_going_public_at":"2020-02-24T19:41:53.443Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nIn short, if your username is something as simple as \u003cscript\u003ealert(1)\u003c/script\u003e this will not be filtered when viewing your profile page. The unfiltered script alert is echo'd underneath your image in your profile. This can be viewed by anyone viewing your profile (Although in some cases the browser will attempt to block it so you might not see it immediately - but it will show in the console etc).\n\nWhile you are unable to change your username to have \u003c\u003e tags via the web, I noticed if I edited the name directly in the database I could get it to prompt. \n\nFrom there I found two ways to make your name accept tags. \n\n- via the API, you can create a user with a script tag as a name and it goes through fine. \n- via social logins. Although Facebook, Twitter and Google all block \u003c\u003e tags in their \"Name\" field, things like Github and Steam do not and the social login plugins take the \"name\" wholesale without any filtering. \n\n**Description:**\n\n## Steps to reproduce:\n\nYou can ofcourse just edit the name of a user in the gdn_user table if you want to short circuit it. Otherwise... \n\n1. Call the API (Even via Swagger in the admin panel) with the following : (RoleId may need to be changed to suite local install)\n\n{\n  \"bypassSpam\": false,\n  \"email\": \"test@test.com\",\n  \"emailConfirmed\": true,\n  \"name\": \"\u003cscript\u003ealert(1)\u003c/script\u003e\",\n  \"password\": \"P@ssw0rd\",\n  \"photo\": \"\",\n  \"roleID\": [\n    8\n  ]\n}\n\n2. Login as this user/view this users profile via the front end web. You should see the alert. \n\n(And again alternatively you can set up OpenID/Social Logins with a provider that also allows script tags in the name and it will come through also)\n\n## Anything else we should know?\n\nWhile the web does block it so the exploit relies on either an API integration or a social login, I think relying on third parties to block script tags on their end so they don't get into the Vanilla DB is probably pretty dangerous. If Vanilla has inbuilt support for something like Github this would be a much larger problem etc.\n\n## Impact\n\nStandard XSS rules apply","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eIn short, if your username is something as simple as \u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt; this will not be filtered when viewing your profile page. The unfiltered script alert is echo\u0026#39;d underneath your image in your profile. This can be viewed by anyone viewing your profile (Although in some cases the browser will attempt to block it so you might not see it immediately - but it will show in the console etc).\u003c/p\u003e\n\n\u003cp\u003eWhile you are unable to change your username to have \u0026lt;\u0026gt; tags via the web, I noticed if I edited the name directly in the database I could get it to prompt. \u003c/p\u003e\n\n\u003cp\u003eFrom there I found two ways to make your name accept tags. \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003evia the API, you can create a user with a script tag as a name and it goes through fine. \u003c/li\u003e\n\u003cli\u003evia social logins. Although Facebook, Twitter and Google all block \u0026lt;\u0026gt; tags in their \u0026quot;Name\u0026quot; field, things like Github and Steam do not and the social login plugins take the \u0026quot;name\u0026quot; wholesale without any filtering. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003cp\u003eYou can ofcourse just edit the name of a user in the gdn_user table if you want to short circuit it. Otherwise... \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCall the API (Even via Swagger in the admin panel) with the following : (RoleId may need to be changed to suite local install)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e{\u003cbr\u003e\n  \u0026quot;bypassSpam\u0026quot;: false,\u003cbr\u003e\n  \u0026quot;email\u0026quot;: \u0026quot;\u003ca title=\"test@test.com\" href=\"mailto:test@test.com\" rel=\"nofollow noopener noreferrer\"\u003etest@test.com\u003c/a\u003e\u0026quot;,\u003cbr\u003e\n  \u0026quot;emailConfirmed\u0026quot;: true,\u003cbr\u003e\n  \u0026quot;name\u0026quot;: \u0026quot;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026quot;,\u003cbr\u003e\n  \u0026quot;password\u0026quot;: \u0026quot;P@ssw0rd\u0026quot;,\u003cbr\u003e\n  \u0026quot;photo\u0026quot;: \u0026quot;\u0026quot;,\u003cbr\u003e\n  \u0026quot;roleID\u0026quot;: [\u003cbr\u003e\n    8\u003cbr\u003e\n  ]\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin as this user/view this users profile via the front end web. You should see the alert. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e(And again alternatively you can set up OpenID/Social Logins with a provider that also allows script tags in the name and it will come through also)\u003c/p\u003e\n\n\u003ch2 id=\"anything-else-we-should-know\"\u003eAnything else we should know?\u003c/h2\u003e\n\n\u003cp\u003eWhile the web does block it so the exploit relies on either an API integration or a social login, I think relying on third parties to block script tags on their end so they don\u0026#39;t get into the Vanilla DB is probably pretty dangerous. If Vanilla has inbuilt support for something like Github this would be a much larger problem etc.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eStandard XSS rules apply\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-25T19:41:53.506Z","allow_singular_disclosure_after":-24058492.569709674,"singular_disclosure_allowed":true,"vote_count":30,"voters":["rapiddns","bayesian_hacker","mashoud1122","mygf","powerjacobb1","bhavi","coinb8797","mightyowl","mindingdata","tadpole404","and 20 more..."],"severity":{"rating":"high","score":7.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":14811,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/vanilla/community","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5584410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the report. We will investigate and reply to you shortly.","markdown_message":"\u003cp\u003eThank you for the report. We will investigate and reply to you shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T14:26:18.177Z","updated_at":"2019-08-15T14:26:18.177Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5584795,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-15T15:30:06.504Z","updated_at":"2019-08-15T15:30:06.504Z","additional_data":{"old_severity":"Medium","new_severity":"High (7.1)","old_severity_id":493604,"new_severity_id":493757},"actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5593184,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I have triaged this ticket as valid. Thank you for reporting it.","markdown_message":"\u003cp\u003eI have triaged this ticket as valid. Thank you for reporting it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-16T18:20:37.985Z","updated_at":"2019-08-16T18:20:37.985Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6048810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys, where did we get with this one? ","markdown_message":"\u003cp\u003eHi guys, where did we get with this one? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-15T20:35:03.674Z","updated_at":"2019-10-15T20:35:03.674Z","actor":{"username":"mindingdata","cleared":false,"url":"/mindingdata","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6055699,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T15:00:32.042Z","updated_at":"2019-10-16T15:00:32.042Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"mindingdata","url":"/mindingdata"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6373026,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-21T22:33:05.485Z","updated_at":"2019-11-21T22:33:05.485Z","actor":{"username":"initvector","cleared":false,"url":"/initvector","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mindingdata","url":"/mindingdata"},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7138942,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-24T19:41:53.469Z","updated_at":"2020-02-24T19:41:53.469Z","first_to_agree":true,"actor":{"username":"mindingdata","cleared":false,"url":"/mindingdata","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7441060,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-25T19:41:54.413Z","updated_at":"2020-03-25T19:41:54.413Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}