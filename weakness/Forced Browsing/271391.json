{"id":271391,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzEzOTE=","url":"https://hackerone.com/reports/271391","title":"Potential server misconfiguration leads to disclosure of vendor/ directory","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-25T02:56:01.478Z","submitted_at":"2017-09-25T02:56:01.478Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"h4ckninja","url":"/h4ckninja","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-23T05:47:08.128Z","bug_reporter_agreed_on_going_public_at":"2017-09-25T14:45:32.074Z","team_member_agreed_on_going_public_at":"2017-10-23T05:47:08.078Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nApologies for the weakness label, it was the closest I could find for what appears to be a server misconfiguration.\n\nTypically, in MVC frameworks like Slim (which I see you are using here), Symfony, Laravel, etc., the front controller is the only thing exposed, leaving `vendor/`, `logs/`, and others outside of document root, inaccessible to web browsers.\n\nHowever, it appears that here that's not the case, having `vendor/` accessible.\n\n## PoC\n\n`https://www.zomato.com/vendor/composer/installed.json`\n\n`https://www.zomato.com/vendor/slim/slim/composer.json`\n\n`https://www.zomato.com/vendor/bin/phpunit`\n\nI can see that Slim is used, and various libraries are installed with `composer`.\n\n\n## Why it's a concern\n\nRecently, `phpunit` had an RCE vulnerability, that if exposed, would allow users to run arbitrary PHP code. PHPUnit is indeed installed: `https://www.zomato.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`. However, it appears that you are fortunately running the patched version. Reference: `http://phpunit.vulnbusters.com/`.\n\n\n## Additional notes\n\nI did try other directories, like the `logs/` directory, but it doesn't seem to be exposed. Or at least the common `app.log` isn't available.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eApologies for the weakness label, it was the closest I could find for what appears to be a server misconfiguration.\u003c/p\u003e\n\n\u003cp\u003eTypically, in MVC frameworks like Slim (which I see you are using here), Symfony, Laravel, etc., the front controller is the only thing exposed, leaving \u003ccode\u003evendor/\u003c/code\u003e, \u003ccode\u003elogs/\u003c/code\u003e, and others outside of document root, inaccessible to web browsers.\u003c/p\u003e\n\n\u003cp\u003eHowever, it appears that here that\u0026#39;s not the case, having \u003ccode\u003evendor/\u003c/code\u003e accessible.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.zomato.com/vendor/composer/installed.json\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.zomato.com/vendor/slim/slim/composer.json\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.zomato.com/vendor/bin/phpunit\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI can see that Slim is used, and various libraries are installed with \u003ccode\u003ecomposer\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"why-it-s-a-concern\"\u003eWhy it\u0026#39;s a concern\u003c/h2\u003e\n\n\u003cp\u003eRecently, \u003ccode\u003ephpunit\u003c/code\u003e had an RCE vulnerability, that if exposed, would allow users to run arbitrary PHP code. PHPUnit is indeed installed: \u003ccode\u003ehttps://www.zomato.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php\u003c/code\u003e. However, it appears that you are fortunately running the patched version. Reference: \u003ccode\u003ehttp://phpunit.vulnbusters.com/\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"additional-notes\"\u003eAdditional notes\u003c/h2\u003e\n\n\u003cp\u003eI did try other directories, like the \u003ccode\u003elogs/\u003c/code\u003e directory, but it doesn\u0026#39;t seem to be exposed. Or at least the common \u003ccode\u003eapp.log\u003c/code\u003e isn\u0026#39;t available.\u003c/p\u003e\n","weakness":{"id":85,"name":"Forced Browsing"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-25T14:45:32.166Z","allow_singular_disclosure_after":-100276418.04137632,"singular_disclosure_allowed":true,"vote_count":10,"voters":["cuso4","eveeez","khizer47","zerotoone","japz","sumit7","klau5","ping-king","hongen","b4155f7c29acd42c27d007a"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2019437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting @hextitan, we're looking into this and will get back to you shortly. ","markdown_message":"\u003cp\u003eThanks for reporting \u003ca href=\"/hextitan\"\u003e@hextitan\u003c/a\u003e, we\u0026#39;re looking into this and will get back to you shortly. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T05:42:51.049Z","updated_at":"2017-09-25T05:42:51.049Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2020074,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hextitan this should be fixed now.","markdown_message":"\u003cp\u003e\u003ca href=\"/hextitan\"\u003e@hextitan\u003c/a\u003e this should be fixed now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T10:04:10.639Z","updated_at":"2017-09-25T10:05:00.396Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2020077,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-25T10:05:15.161Z","updated_at":"2017-09-25T10:05:15.161Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"h4ckninja","url":"/h4ckninja"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2020766,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the quick turnaround. Disclose?","markdown_message":"\u003cp\u003eThanks for the quick turnaround. Disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T14:45:32.098Z","updated_at":"2017-09-25T14:45:32.098Z","first_to_agree":true,"actor":{"username":"h4ckninja","cleared":false,"url":"/h4ckninja","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2021211,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Hi @hextitan - Since this wasn't technically a security issue we have decided that this not eligible for a bounty at this time, however we did make a change on behalf of your report so we wanted to make sure that you received reputation for it. Thanks again for your report and we look forward to more reports from you in the future! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hextitan\"\u003e@hextitan\u003c/a\u003e - Since this wasn\u0026#39;t technically a security issue we have decided that this not eligible for a bounty at this time, however we did make a change on behalf of your report so we wanted to make sure that you received reputation for it. Thanks again for your report and we look forward to more reports from you in the future! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-25T16:25:06.736Z","updated_at":"2017-09-25T16:25:06.736Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2093977,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-23T05:47:08.106Z","updated_at":"2017-10-23T05:47:08.106Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2093978,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-23T05:47:08.148Z","updated_at":"2017-10-23T05:47:08.148Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}