{"id":101909,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE5MDk=","url":"https://hackerone.com/reports/101909","title":"account.ubnt.com CSRF","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-24T21:58:43.155Z","submitted_at":"2015-11-24T21:58:43.155Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"benkhlifafahmi","url":"/benkhlifafahmi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-05T23:50:51.984Z","bug_reporter_agreed_on_going_public_at":"2016-11-05T23:50:38.705Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Good Evening Sir, \nI want to inform you that i have successfully discovered a problem on  the API (django Restfull API) you used to manage the security of \nhttps://account.ubnt.com\nThe vulnerability type : CSRF\nVulnerability description : \nAn attacker create a web page with the code attached to this  report : \"hacking_code.html\"\nthen transfer the link of the file to the  victim (note victim need to be logged in to his account)\nonce the victim visit the link , his password will be changed immediatly to the password set by the hacker \nNote: an attacker can also change user information (name , email , etc...).\nYou can watch this video as proof of concept : \nLink : https://mega.nz/#!JZ1DxYyb\nand to make this video private you may need to be asked for decryption key : \nthe key is :  !██████\n\nImpact : Critical as the account.ubnt.com is the site that manage all acounts on the ubnt.com (ex: community.ubnt.com , store.ubnt.com) , i see this require a quick fix and i am ready to help\n\nHow to fix this : 1st you need to enable the csrf_token of Django ; 2nd when change user information you may ask the user for his current password.\n\n\nPS: if you need any help coding a solution i am ready to do this for you , I have a great knowledge on  DJango Development and i am ready to this for you for free :p \n\nif you need any thing urgent feel free to call me +█████████ , or mail me ! ███████\n\nThank you for your time\nBest Regards , \nBen khlifa Fahmi \nCO-Founder \u0026 Pentester at Tunisian Whitehats Security","vulnerability_information_html":"\u003cp\u003eGood Evening Sir, \u003cbr\u003e\nI want to inform you that i have successfully discovered a problem on  the API (django Restfull API) you used to manage the security of \u003cbr\u003e\n\u003ca title=\"https://account.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Faccount.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://account.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThe vulnerability type : CSRF\u003cbr\u003e\nVulnerability description : \u003cbr\u003e\nAn attacker create a web page with the code attached to this  report : \u0026quot;hacking_code.html\u0026quot;\u003cbr\u003e\nthen transfer the link of the file to the  victim (note victim need to be logged in to his account)\u003cbr\u003e\nonce the victim visit the link , his password will be changed immediatly to the password set by the hacker \u003cbr\u003e\nNote: an attacker can also change user information (name , email , etc...).\u003cbr\u003e\nYou can watch this video as proof of concept : \u003cbr\u003e\nLink : \u003ca title=\"https://mega.nz/#!JZ1DxYyb\" href=\"/redirect?url=https%3A%2F%2Fmega.nz%2F%23%21JZ1DxYyb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mega.nz/#!JZ1DxYyb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand to make this video private you may need to be asked for decryption key : \u003cbr\u003e\nthe key is :  !██████\u003c/p\u003e\n\n\u003cp\u003eImpact : Critical as the account.ubnt.com is the site that manage all acounts on the ubnt.com (ex: community.ubnt.com , store.ubnt.com) , i see this require a quick fix and i am ready to help\u003c/p\u003e\n\n\u003cp\u003eHow to fix this : 1st you need to enable the csrf_token of Django ; 2nd when change user information you may ask the user for his current password.\u003c/p\u003e\n\n\u003cp\u003ePS: if you need any help coding a solution i am ready to do this for you , I have a great knowledge on  DJango Development and i am ready to this for you for free :p \u003c/p\u003e\n\n\u003cp\u003eif you need any thing urgent feel free to call me +█████████ , or mail me ! ███████\u003c/p\u003e\n\n\u003cp\u003eThank you for your time\u003cbr\u003e\nBest Regards , \u003cbr\u003e\nBen khlifa Fahmi \u003cbr\u003e\nCO-Founder \u0026amp; Pentester at Tunisian Whitehats Security\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":63392,"file_name":"exploit_csrf_poc.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/063/392/e544295a22123c3e77057a6b9a875f2095127124/exploit_csrf_poc.html?response-content-disposition=attachment%3B%20filename%3D%22exploit_csrf_poc.html%22%3B%20filename%2A%3DUTF-8%27%27exploit_csrf_poc.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041157Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=05077e14400bb372bdc46a33d68e386483193d43d8e8614318bdf2db5990b4f5","file_size":408,"type":"text/html"}],"allow_singular_disclosure_at":"2016-12-05T23:50:38.743Z","allow_singular_disclosure_after":-128233279.0938355,"singular_disclosure_allowed":true,"vote_count":7,"voters":["dilawer01","vijay_kumar","m16","benkhlifafahmi","spetr0x","0619","dayaar"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":799058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey , This bug is now 3 months ago and still  exist , please try to fix it as quickly as you can because this put in danger all your clients , \na good exploit of this vulnerability will allow an attacker to full account take over .","markdown_message":"\u003cp\u003eHey , This bug is now 3 months ago and still  exist , please try to fix it as quickly as you can because this put in danger all your clients , \u003cbr\u003e\na good exploit of this vulnerability will allow an attacker to full account take over .\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T21:15:09.383Z","updated_at":"2016-02-15T21:15:09.383Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":865558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"is there any update , as this vulnerability is easy to exploit and it has a critical impact , and can cause damage to all users , it may cause account take over ,etc..\n","markdown_message":"\u003cp\u003eis there any update , as this vulnerability is easy to exploit and it has a critical impact , and can cause damage to all users , it may cause account take over ,etc..\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T19:16:32.189Z","updated_at":"2016-03-23T19:16:32.189Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":982893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello , Any update this post has now more than 8months :o ","markdown_message":"\u003cp\u003eHello , Any update this post has now more than 8months :o \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T11:27:29.171Z","updated_at":"2016-05-25T11:27:29.171Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1139433,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello any updates ???","markdown_message":"\u003cp\u003eHello any updates ???\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T04:51:43.078Z","updated_at":"2016-08-19T04:51:43.078Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1257754,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May ask if this case is legit or not ? it has been now 11 months since i report this and no reply ","markdown_message":"\u003cp\u003eMay ask if this case is legit or not ? it has been now 11 months since i report this and no reply \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-20T11:49:16.922Z","updated_at":"2016-10-20T11:49:16.922Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273085,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @benkhlifafahmi\n\nThanks for your report and sorry for the delay, can you verify if it was fixed?\n\nThanks for testing","markdown_message":"\u003cp\u003eHi \u003ca href=\"/benkhlifafahmi\"\u003e@benkhlifafahmi\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks for your report and sorry for the delay, can you verify if it was fixed?\u003c/p\u003e\n\n\u003cp\u003eThanks for testing\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T16:34:01.751Z","updated_at":"2016-10-28T16:34:01.751Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1275275,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi , \nThanks for reply , yeah i can confirm that the bug has been fixed :) ","markdown_message":"\u003cp\u003eHi , \u003cbr\u003e\nThanks for reply , yeah i can confirm that the bug has been fixed :) \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-30T22:58:43.614Z","updated_at":"2016-10-30T22:58:43.614Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1275570,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-31T09:01:02.989Z","updated_at":"2016-10-31T09:01:02.989Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"benkhlifafahmi","url":"/benkhlifafahmi"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1275579,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @benkhlifafahmi. Sorry for the delay, it will not happen again, I hope to see more reports like this ;-)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/benkhlifafahmi\"\u003e@benkhlifafahmi\u003c/a\u003e. Sorry for the delay, it will not happen again, I hope to see more reports like this ;-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-31T09:05:15.976Z","updated_at":"2016-10-31T09:05:15.976Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"benkhlifafahmi","url":"/benkhlifafahmi"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1275743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty , and about the delay there is no problem i am sure you where busy resolving other critical issue and improving your service .\nI am glad to help you ;) ","markdown_message":"\u003cp\u003eThank you for the bounty , and about the delay there is no problem i am sure you where busy resolving other critical issue and improving your service .\u003cbr\u003e\nI am glad to help you ;) \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-31T10:42:06.183Z","updated_at":"2016-10-31T10:42:06.183Z","actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1286341,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"and please remove my phone and email address ","markdown_message":"\u003cp\u003eand please remove my phone and email address \u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-05T23:50:38.720Z","updated_at":"2016-11-05T23:50:38.720Z","first_to_agree":true,"actor":{"username":"benkhlifafahmi","cleared":false,"url":"/benkhlifafahmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/235/6f3f67b309925f21d0211e6124ef57f3ea2d4ac1_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1342889,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-05T23:50:52.000Z","updated_at":"2016-12-05T23:50:52.000Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}