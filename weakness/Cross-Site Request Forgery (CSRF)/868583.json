{"id":868583,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njg1ODM=","url":"https://hackerone.com/reports/868583","title":"CSRF on https://apps.topcoder.com/wiki/users general and email preferences","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-07T23:14:40.286Z","submitted_at":"2020-05-07T23:14:40.286Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"powerpuff","url":"/powerpuff","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NV7a2msHVqudWaWig6Vspzr4/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":43330,"url":"https://hackerone.com/topcoder","handle":"topcoder","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/kS4MdqW4T4tGEgyNs2u8P4zY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/kS4MdqW4T4tGEgyNs2u8P4zY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Topcoder","twitter_handle":null,"website":"http://topcoder.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-12T13:36:14.506Z","bug_reporter_agreed_on_going_public_at":"2020-05-12T08:56:58.641Z","team_member_agreed_on_going_public_at":"2020-05-12T13:36:14.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi :) There is a CSRF on setting general and email preferences.\n\n## Steps To Reproduce:\nThere is no CSRF token or anything like that on https://apps.topcoder.com/wiki/users/editmypreferences.action and  https://apps.topcoder.com/wiki/users/editemailpreferences.action . I added the poc html files below. Attacker can change victim's preferences.\n\nNote: This only works to signed-in users. There is a mistake on https://apps.topcoder.com/wiki/login.action now. If you encounter an error, you can login on main site (https://accounts.topcoder.com/member) then try.\n\n## Impact\n\nAn attacker can force other users to change their preferences without their knowledge.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHi :) There is a CSRF on setting general and email preferences.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eThere is no CSRF token or anything like that on \u003ca title=\"https://apps.topcoder.com/wiki/users/editmypreferences.action\" href=\"/redirect?url=https%3A%2F%2Fapps.topcoder.com%2Fwiki%2Fusers%2Feditmypreferences.action\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://apps.topcoder.com/wiki/users/editmypreferences.action\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and  \u003ca title=\"https://apps.topcoder.com/wiki/users/editemailpreferences.action\" href=\"/redirect?url=https%3A%2F%2Fapps.topcoder.com%2Fwiki%2Fusers%2Feditemailpreferences.action\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://apps.topcoder.com/wiki/users/editemailpreferences.action\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e . I added the poc html files below. Attacker can change victim\u0026#39;s preferences.\u003c/p\u003e\n\n\u003cp\u003eNote: This only works to signed-in users. There is a mistake on \u003ca title=\"https://apps.topcoder.com/wiki/login.action\" href=\"/redirect?url=https%3A%2F%2Fapps.topcoder.com%2Fwiki%2Flogin.action\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://apps.topcoder.com/wiki/login.action\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e now. If you encounter an error, you can login on main site (\u003ca title=\"https://accounts.topcoder.com/member\" href=\"/redirect?url=https%3A%2F%2Faccounts.topcoder.com%2Fmember\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://accounts.topcoder.com/member\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) then try.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can force other users to change their preferences without their knowledge.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":819934,"file_name":"csrf_mail.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dvfWXApiUbv1NwSbaus4WGfF?response-content-disposition=attachment%3B%20filename%3D%22csrf_mail.html%22%3B%20filename%2A%3DUTF-8%27%27csrf_mail.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070344Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=24216a0f267960428df7349dff459c031ffcef0c31fb0a995c5d05909ae3581e","file_size":498,"type":"text/html"},{"id":819935,"file_name":"csrf_general.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CzhetzCjHzi2Wox1udo2orEp?response-content-disposition=attachment%3B%20filename%3D%22csrf_general.html%22%3B%20filename%2A%3DUTF-8%27%27csrf_general.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070344Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=2af9f4b386c68c0e0bf9b86aa7d75033e88218df2952033e5494d4f33b316ca9","file_size":503,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["mik317","sa1tama0","glamorous_noob"],"severity":{"rating":"medium","score":6.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":37578,"asset_type":"URL","asset_identifier":"apps.topcoder.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7937049,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @powerpuff,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nOn a side note, make sure to file a separate report per each issue. This will help us and the team to better track their status. \n\nBest of luck with your future findings,\n@lugtag","markdown_message":"\u003cp\u003eHello \u003ca href=\"/powerpuff\"\u003e@powerpuff\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eOn a side note, make sure to file a separate report per each issue. This will help us and the team to better track their status. \u003c/p\u003e\n\n\u003cp\u003eBest of luck with your future findings,\u003cbr\u003e\n\u003ca href=\"/lugtag\"\u003e@lugtag\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T10:10:35.497Z","updated_at":"2020-05-08T10:10:35.497Z","actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7966875,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The legacy topcoder wiki has been disabled. This is not longer reproducible.","markdown_message":"\u003cp\u003eThe legacy topcoder wiki has been disabled. This is not longer reproducible.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-11T19:48:10.503Z","updated_at":"2020-05-11T19:48:10.503Z","actor":{"username":"jwheeler","cleared":false,"url":"/jwheeler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GwjmYrZ8TN3LsZ63NQnwopL7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"powerpuff","url":"/powerpuff"},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7972500,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this?","markdown_message":"\u003cp\u003eCan we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T08:56:58.670Z","updated_at":"2020-05-12T08:56:58.670Z","first_to_agree":true,"actor":{"username":"powerpuff","cleared":false,"url":"/powerpuff","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NV7a2msHVqudWaWig6Vspzr4/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7975364,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-12T13:36:14.428Z","updated_at":"2020-05-12T13:36:14.428Z","actor":{"username":"jwheeler","cleared":false,"url":"/jwheeler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GwjmYrZ8TN3LsZ63NQnwopL7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7975365,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-12T13:36:14.544Z","updated_at":"2020-05-12T13:36:14.544Z","actor":{"username":"jwheeler","cleared":false,"url":"/jwheeler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GwjmYrZ8TN3LsZ63NQnwopL7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}