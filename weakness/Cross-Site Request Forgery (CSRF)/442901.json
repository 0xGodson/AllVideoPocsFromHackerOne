{"id":442901,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDI5MDE=","url":"https://hackerone.com/reports/442901","title":"Take over of accounts created using Google or Facebook","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-11-16T20:54:56.443Z","submitted_at":"2018-11-16T20:54:56.443Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomoh","url":"/tomoh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":134,"url":"https://hackerone.com/khanacademy","handle":"khanacademy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Khan Academy","twitter_handle":"","website":"https://www.khanacademy.org/","about":"Start learning now. Completely free, forever."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-17T03:36:27.301Z","bug_reporter_agreed_on_going_public_at":"2019-04-17T03:36:20.796Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When a user creates an account using Google or Facebook and does not set an additional password, it is possible to set their passwords via CSRF.\nSince the account is created using a social media account, no existing password check is needed and the CSRF check on the endpoint is broken. \nTo reproduce, create an account with Google or Facebook and make account load the attached HTML file. You should now be able to login to the account with password=ATTACKER_PASS.\n\n## Impact\n\nAn attacker can take over of accounts created using Google or Facebook.","vulnerability_information_html":"\u003cp\u003eWhen a user creates an account using Google or Facebook and does not set an additional password, it is possible to set their passwords via CSRF.\u003cbr\u003e\nSince the account is created using a social media account, no existing password check is needed and the CSRF check on the endpoint is broken. \u003cbr\u003e\nTo reproduce, create an account with Google or Facebook and make account load the attached HTML file. You should now be able to login to the account with password=ATTACKER_PASS.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can take over of accounts created using Google or Facebook.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":376645,"file_name":"khan_password.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/376/645/b1220e7d272f494b5e9af746e925cb310a35a9d5/khan_password.html?response-content-disposition=attachment%3B%20filename%3D%22khan_password.html%22%3B%20filename%2A%3DUTF-8%27%27khan_password.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055855Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=c95aa4ed4da0fc81e96708ca474f69a1c56973facad24e7868454c6c1c56b03c","file_size":439,"type":"text/html"}],"allow_singular_disclosure_at":"2019-05-17T03:36:21.204Z","allow_singular_disclosure_after":-51157353.81461683,"singular_disclosure_allowed":true,"vote_count":167,"voters":["spaceraccoon","base_64","mik317","sameerphad72","ta8ahi","yashrs","dhakal_ananda","theappsec","mygf","aeswagyewgyes","and 157 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3660360,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report! I've made an issue for this in our internal tracker so we can look into doing it; it will be prioritized according to its severity and how difficult it ends up being for us to implement.\n\nIf you send me your Khan Academy account email or username I'd be happy to give you our [Friendly Hacker](https://www.khanacademy.org/badges/friendly-hacker) badge--but I think you already have it, no?\n\nbest,\nDave","markdown_message":"\u003cp\u003eThanks for the report! I\u0026#39;ve made an issue for this in our internal tracker so we can look into doing it; it will be prioritized according to its severity and how difficult it ends up being for us to implement.\u003c/p\u003e\n\n\u003cp\u003eIf you send me your Khan Academy account email or username I\u0026#39;d be happy to give you our \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.khanacademy.org%2Fbadges%2Ffriendly-hacker\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFriendly Hacker\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e badge--but I think you already have it, no?\u003c/p\u003e\n\n\u003cp\u003ebest,\u003cbr\u003e\nDave\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-17T00:07:22.862Z","updated_at":"2018-11-17T00:07:22.862Z","actor":{"username":"drosile","cleared":false,"url":"/drosile","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Q4ceVVjALdR4FtiZDBdehawK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3713130,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report. This should now be fixed – can you confirm?\n\nbest,\nDave","markdown_message":"\u003cp\u003eThank you again for your report. This should now be fixed – can you confirm?\u003c/p\u003e\n\n\u003cp\u003ebest,\u003cbr\u003e\nDave\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-26T23:39:30.823Z","updated_at":"2018-11-26T23:39:30.823Z","actor":{"username":"drosile","cleared":false,"url":"/drosile","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Q4ceVVjALdR4FtiZDBdehawK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"tomoh","url":"/tomoh"},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3713537,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Dave,\nThis is fixed. Thanks.","markdown_message":"\u003cp\u003eHi Dave,\u003cbr\u003e\nThis is fixed. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-27T02:49:03.389Z","updated_at":"2018-11-27T02:49:03.389Z","actor":{"username":"tomoh","cleared":false,"url":"/tomoh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4579642,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-17T03:36:20.816Z","updated_at":"2019-04-17T03:36:20.816Z","first_to_agree":true,"actor":{"username":"tomoh","cleared":false,"url":"/tomoh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4863414,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T03:36:27.323Z","updated_at":"2019-05-17T03:36:27.323Z","actor":{"url":"/khanacademy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Khan Academy"}},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}