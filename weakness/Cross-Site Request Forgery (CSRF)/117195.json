{"id":117195,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTcxOTU=","url":"https://hackerone.com/reports/117195","title":"Login csrf.","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-02-18T19:27:22.866Z","submitted_at":"2016-02-18T19:27:22.866Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"diffender23","url":"/diffender23","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/496/70c731a1098c5d7fb03a1c39786e5089c5109e9c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-21T13:29:29.202Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-04-15T17:41:11.676Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , \n\nThere is no state parameter in bitbucket login request .\n\nhttps://bitbucket.org/site/oauth1/authorize?oauth_token=ZmCHb7dnyYVYKTYRNt .\n\nAs you can see that there is no state parameter in above request there it is possible to exploit login csrf.\n","vulnerability_information_html":"\u003cp\u003eHi , \u003c/p\u003e\n\n\u003cp\u003eThere is no state parameter in bitbucket login request .\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://bitbucket.org/site/oauth1/authorize?oauth_token=ZmCHb7dnyYVYKTYRNt\" href=\"/redirect?url=https%3A%2F%2Fbitbucket.org%2Fsite%2Foauth1%2Fauthorize%3Foauth_token%3DZmCHb7dnyYVYKTYRNt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bitbucket.org/site/oauth1/authorize?oauth_token=ZmCHb7dnyYVYKTYRNt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e .\u003c/p\u003e\n\n\u003cp\u003eAs you can see that there is no state parameter in above request there it is possible to exploit login csrf.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-15T17:41:11.736Z","allow_singular_disclosure_after":-145881474.10153377,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":803239,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Please provide detailed steps to reproduce the vulnerability. Thanks.","markdown_message":"\u003cp\u003ePlease provide detailed steps to reproduce the vulnerability. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-18T19:28:21.830Z","updated_at":"2016-02-18T19:28:21.830Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803243,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sure:\n1.Attacker initiates bitbucket OAuth process with Gratipay.\n2.Attacker allows access to Gratipay app and attacker drops the redirection to Gratipay so as not to consume the token.\n3.Now attacker will redirect victim to \n/auth/login/bitbucket:bitbucket.com/?oauth_token={attacker_token}\n4.Victim is now logged in as attacker.\n\nI have reported similar issue to founderbliss too :\nRef: https://github.com/sishen/omniauth-bitbucket/pull/8 ","markdown_message":"\u003cp\u003eSure:\u003cbr\u003e\n1.Attacker initiates bitbucket OAuth process with Gratipay.\u003cbr\u003e\n2.Attacker allows access to Gratipay app and attacker drops the redirection to Gratipay so as not to consume the token.\u003cbr\u003e\n3.Now attacker will redirect victim to \u003cbr\u003e\n/auth/login/bitbucket:bitbucket.com/?oauth_token={attacker_token}\u003cbr\u003e\n4.Victim is now logged in as attacker.\u003c/p\u003e\n\n\u003cp\u003eI have reported similar issue to founderbliss too :\u003cbr\u003e\nRef: \u003ca title=\"https://github.com/sishen/omniauth-bitbucket/pull/8\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsishen%2Fomniauth-bitbucket%2Fpull%2F8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/sishen/omniauth-bitbucket/pull/8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-18T19:30:28.696Z","updated_at":"2016-02-18T19:30:28.696Z","actor":{"username":"diffender23","cleared":false,"url":"/diffender23","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/496/70c731a1098c5d7fb03a1c39786e5089c5109e9c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":803278,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Okay, thanks for the report, @23ranjan.","markdown_message":"\u003cp\u003eOkay, thanks for the report, \u003ca href=\"/23ranjan\"\u003e@23ranjan\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-18T19:54:16.088Z","updated_at":"2016-02-18T19:54:16.088Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @whit537  \n\nI guess the state parameter is also missing in twitter oauth .\nhttps://api.twitter.com/oauth/authenticate?oauth_token=MAUHywAAAAAAMQjhAAABUvggA4w \n\nPlease have a look in to this alos.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e  \u003c/p\u003e\n\n\u003cp\u003eI guess the state parameter is also missing in twitter oauth .\u003cbr\u003e\n\u003ca title=\"https://api.twitter.com/oauth/authenticate?oauth_token=MAUHywAAAAAAMQjhAAABUvggA4w\" href=\"/redirect?url=https%3A%2F%2Fapi.twitter.com%2Foauth%2Fauthenticate%3Foauth_token%3DMAUHywAAAAAAMQjhAAABUvggA4w\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.twitter.com/oauth/authenticate?oauth_token=MAUHywAAAAAAMQjhAAABUvggA4w\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003ePlease have a look in to this alos.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-19T06:05:07.768Z","updated_at":"2016-02-19T06:05:07.768Z","actor":{"username":"diffender23","cleared":false,"url":"/diffender23","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/496/70c731a1098c5d7fb03a1c39786e5089c5109e9c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":843814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the slow response, @23ranjan, we are a small team with limited resources, still processing your report ...","markdown_message":"\u003cp\u003eSorry for the slow response, \u003ca href=\"/23ranjan\"\u003e@23ranjan\u003c/a\u003e, we are a small team with limited resources, still processing your report ...\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-16T18:51:46.927Z","updated_at":"2016-03-16T18:51:46.927Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":844496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e 3.Now attacker will redirect victim to \n/auth/login/bitbucket:bitbucket.com/?oauth_token={attacker_token}\n\nCan you be more specific on this step? What is the full URL that an attacker would send a victim to?","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003e3.Now attacker will redirect victim to \u003cbr\u003e\n/auth/login/bitbucket:bitbucket.com/?oauth_token={attacker_token}\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCan you be more specific on this step? What is the full URL that an attacker would send a victim to?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-17T04:00:55.697Z","updated_at":"2016-03-17T04:00:55.697Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":896602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[This](http://www.twobotechnologies.com/blog/2014/02/importance-of-state-in-oauth2.html) post for reference.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.twobotechnologies.com%2Fblog%2F2014%2F02%2Fimportance-of-state-in-oauth2.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eThis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e post for reference.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-08T20:54:40.226Z","updated_at":"2016-04-08T20:54:40.226Z","actor":{"username":"aandis","cleared":false,"url":"/aandis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":896606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@23ranjan Thanks for the report. However, we *[do](https://github.com/gratipay/gratipay.com/blob/651a397c9b0fd2bad0bb3d44c732af06a6596b07/www/on/%25platform/associate.spt#L19)* protect against CSRF attacks during login using cookies. So this isn't really applicable.","markdown_message":"\u003cp\u003e\u003ca href=\"/23ranjan\"\u003e@23ranjan\u003c/a\u003e Thanks for the report. However, we \u003cem\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F651a397c9b0fd2bad0bb3d44c732af06a6596b07%2Fwww%2Fon%2F%2525platform%2Fassociate.spt%23L19\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/em\u003e protect against CSRF attacks during login using cookies. So this isn\u0026#39;t really applicable.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-08T20:56:02.533Z","updated_at":"2016-04-08T20:56:02.533Z","actor":{"username":"aandis","cleared":false,"url":"/aandis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908226,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537 I'm closing this as not applicable.","markdown_message":"\u003cp\u003e\u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e I\u0026#39;m closing this as not applicable.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-15T17:30:04.758Z","updated_at":"2016-04-15T17:30:04.758Z","actor":{"username":"aandis","cleared":false,"url":"/aandis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908227,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-15T17:30:43.406Z","updated_at":"2016-04-15T17:30:43.406Z","actor":{"username":"aandis","cleared":false,"url":"/aandis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay.\n\n@23ranjan If you have a better POC please let us know.","markdown_message":"\u003cp\u003eOkay.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/23ranjan\"\u003e@23ranjan\u003c/a\u003e If you have a better POC please let us know.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-15T17:41:05.594Z","updated_at":"2016-04-15T17:41:05.594Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908262,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-15T17:41:11.700Z","updated_at":"2016-04-15T17:41:11.700Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1943363,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T13:29:29.160Z","updated_at":"2017-08-21T13:29:29.160Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}