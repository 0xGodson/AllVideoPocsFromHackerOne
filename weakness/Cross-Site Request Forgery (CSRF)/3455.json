{"id":3455,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDU1","url":"https://hackerone.com/reports/3455","title":"flash content type sniff vulnerability in api.slack.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-03-07T14:17:25.238Z","submitted_at":"2014-03-07T14:17:25.238Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"netfuzzer","url":"/netfuzzer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-04-08T23:56:03.546Z","bug_reporter_agreed_on_going_public_at":"2014-03-10T15:39:37.969Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nI have found a flash content type sniff vulnerability could allow attackers get user's team auth2 tokens. As the page lists user's teams and its security tokens, this could allow attackers to do csrf attacks.\r\n\r\nSteps to reproduce:\r\n1. Log in api.slack.com\r\n2. after go to http://netfuzzer.com/api-slack-vuln2.html\r\n3. wait 5 seconds until the page finish load\r\n4. see your team's security tokens.\r\n\r\nCheers,\r\nMario\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI have found a flash content type sniff vulnerability could allow attackers get user\u0026#39;s team auth2 tokens. As the page lists user\u0026#39;s teams and its security tokens, this could allow attackers to do csrf attacks.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog in api.slack.com\u003c/li\u003e\n\u003cli\u003eafter go to \u003ca title=\"http://netfuzzer.com/api-slack-vuln2.html\" href=\"/redirect?url=http%3A%2F%2Fnetfuzzer.com%2Fapi-slack-vuln2.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://netfuzzer.com/api-slack-vuln2.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ewait 5 seconds until the page finish load\u003c/li\u003e\n\u003cli\u003esee your team\u0026#39;s security tokens.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nMario\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":4091,"file_name":"screenshot.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/004/091/5b5bcb34a13fff76517a22396e04970e49c6ba85/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054017Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=bdf4818cdd371ca41c24749150bc0d3370f78c2b1217db5524279206ff2b792a","file_size":64159,"type":"image/png"}],"allow_singular_disclosure_at":"2014-04-08T22:55:50.252Z","allow_singular_disclosure_after":-212222667.4132428,"singular_disclosure_allowed":true,"vote_count":1,"voters":["eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":14506,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Please explain what's going on here","markdown_message":"\u003cp\u003ePlease explain what\u0026#39;s going on here\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-08T22:20:04.421Z","updated_at":"2014-03-08T22:20:04.421Z","actor":{"username":"iamcal","cleared":false,"url":"/iamcal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/138/0e164dd6477c48d57f2f5a1c56756f7ec98229cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":14543,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"hey,\n\ni'm reporting a flash content type sniff xss on page https://api.slack.com/api/users.list this vulnerabilities allows me do http requests in any pages of api.slack.com(where if visited by a logged user,  it has victim's teams tokens(used in slack api). The vulnerability occurs due the page prints the content of param \"callback\" so if the page is being embed like for exemple: \u003cobject data=\"https://api.slack.com/api/users.list?callback=\u003cswf-file-content\u003e\" type=\"type= application/x-shockwave-flash\"\u003e , then flash will ignore the header \"content-type\" and will render the page as a flash file , so allowing go get/post requests in any pageof api.slack.com.\n\nwhen visiting api.slack.com is displayed user's team security tokens, using this vulnerability is possible get all user's security tokens.\n\n","markdown_message":"\u003cp\u003ehey,\u003c/p\u003e\n\n\u003cp\u003ei\u0026#39;m reporting a flash content type sniff xss on page \u003ca title=\"https://api.slack.com/api/users.list\" href=\"/redirect?url=https%3A%2F%2Fapi.slack.com%2Fapi%2Fusers.list\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.slack.com/api/users.list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e this vulnerabilities allows me do http requests in any pages of api.slack.com(where if visited by a logged user,  it has victim\u0026#39;s teams tokens(used in slack api). The vulnerability occurs due the page prints the content of param \u0026quot;callback\u0026quot; so if the page is being embed like for exemple: \u0026lt;object data=\u0026quot;https://api.slack.com/api/users.list?callback=\u0026lt;swf-file-content\u0026gt;\u0026quot; type=\u0026quot;type= application/x-shockwave-flash\u0026quot;\u0026gt; , then flash will ignore the header \u0026quot;content-type\u0026quot; and will render the page as a flash file , so allowing go get/post requests in any pageof api.slack.com.\u003c/p\u003e\n\n\u003cp\u003ewhen visiting api.slack.com is displayed user\u0026#39;s team security tokens, using this vulnerability is possible get all user\u0026#39;s security tokens.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-08T23:30:41.212Z","updated_at":"2014-03-08T23:30:41.212Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":14728,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-09T23:51:26.332Z","updated_at":"2014-03-09T23:51:26.332Z","actor":{"username":"iamcal","cleared":false,"url":"/iamcal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/138/0e164dd6477c48d57f2f5a1c56756f7ec98229cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":14730,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for finding and reporting this. We've rolled out a fix to validate the callback param and avoid the callback being the first byte (by inserting a JS comment first) so that an attacker has no control over the firs few bytes.","markdown_message":"\u003cp\u003eThanks for finding and reporting this. We\u0026#39;ve rolled out a fix to validate the callback param and avoid the callback being the first byte (by inserting a JS comment first) so that an attacker has no control over the firs few bytes.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-09T23:55:50.513Z","updated_at":"2014-03-09T23:55:50.513Z","actor":{"username":"iamcal","cleared":false,"url":"/iamcal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/138/0e164dd6477c48d57f2f5a1c56756f7ec98229cf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"netfuzzer","url":"/netfuzzer"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":14731,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-09T23:55:59.149Z","updated_at":"2014-03-09T23:55:59.149Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"netfuzzer","url":"/netfuzzer"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":14820,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice. Thanks for the fix and bounty! :)","markdown_message":"\u003cp\u003eNice. Thanks for the fix and bounty! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-10T15:35:42.782Z","updated_at":"2014-03-10T15:35:42.782Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":14822,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-10T15:39:37.982Z","updated_at":"2014-03-10T15:39:37.982Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":26998,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-08T23:56:03.931Z","updated_at":"2014-04-08T23:56:03.931Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}