{"id":766205,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjYyMDU=","url":"https://hackerone.com/reports/766205","title":"csrf bypass using flash file + 307 redirect method at plugins endpoint","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-12-30T19:59:15.099Z","submitted_at":"2019-12-30T19:59:15.099Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"qotoz","url":"/qotoz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-10T08:38:16.876Z","bug_reporter_agreed_on_going_public_at":"2020-02-08T22:42:26.783Z","team_member_agreed_on_going_public_at":"2020-02-10T08:38:16.797Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Security team,\n\ni have found that the request sent to https://my.stripo.email/cabinet/stripeapi/v1/plugin/$userid$/plugins     don't have any protection against csrf attacks as the server only validates that the content type is application/json and this can be bypassed using the flash file + 307 redirect technique \n\n\nSteps To Reproduce:\n\n  1.  login to your account at https://my.stripo.email\n  2.  visit https://thehackerblog.com/crossdomain/\n  3.  use this link as php redirector https://testingsubdomain.000webhostapp.com/stripo.php\n  4.  in the request headers : Content-Type: application/json;charset=UTF-8\n  5. the payload\n\n```\n{\"email\":\"attacker@example.com\",\"name\":\"csrf poc\",\"webUrl\":\"csrf poc \"}\n```\n\n \n\n##Watch the network traffic from the network tab on the Devtools \n##and go back to and refresh the site you'll find all the application data have created\n\n\nall these steps would be integrated together and performed by the attacker's server\n\ni am attaching a poc video declaring the steps\n{F671826}\n\n##Supporting Material/References:\nhttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\nhttp://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\nhttps://blog.cm2.pw/forging-content-type-header-with-flash/\n\n## Impact\n\nattacker can send request to create an application in behalf of user","vulnerability_information_html":"\u003cp\u003eHi Security team,\u003c/p\u003e\n\n\u003cp\u003ei have found that the request sent to \u003ca title=\"https://my.stripo.email/cabinet/stripeapi/v1/plugin/$userid$/plugins\" href=\"/redirect?url=https%3A%2F%2Fmy.stripo.email%2Fcabinet%2Fstripeapi%2Fv1%2Fplugin%2F%24userid%24%2Fplugins\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.stripo.email/cabinet/stripeapi/v1/plugin/$userid$/plugins\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e     don\u0026#39;t have any protection against csrf attacks as the server only validates that the content type is application/json and this can be bypassed using the flash file + 307 redirect technique \u003c/p\u003e\n\n\u003cp\u003eSteps To Reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e login to your account at \u003ca title=\"https://my.stripo.email\" href=\"/redirect?url=https%3A%2F%2Fmy.stripo.email\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.stripo.email\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e visit \u003ca title=\"https://thehackerblog.com/crossdomain/\" href=\"/redirect?url=https%3A%2F%2Fthehackerblog.com%2Fcrossdomain%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://thehackerblog.com/crossdomain/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e use this link as php redirector \u003ca title=\"https://testingsubdomain.000webhostapp.com/stripo.php\" href=\"/redirect?url=https%3A%2F%2Ftestingsubdomain.000webhostapp.com%2Fstripo.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://testingsubdomain.000webhostapp.com/stripo.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e in the request headers : Content-Type: application/json;charset=UTF-8\u003c/li\u003e\n\u003cli\u003ethe payload\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;email\u0026quot;:\u0026quot;attacker@example.com\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;csrf poc\u0026quot;,\u0026quot;webUrl\u0026quot;:\u0026quot;csrf poc \u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"watch-the-network-traffic-from-the-network-tab-on-the-devtools\"\u003eWatch the network traffic from the network tab on the Devtools\u003c/h2\u003e\n\n\u003ch2 id=\"and-go-back-to-and-refresh-the-site-you-ll-find-all-the-application-data-have-created\"\u003eand go back to and refresh the site you\u0026#39;ll find all the application data have created\u003c/h2\u003e\n\n\u003cp\u003eall these steps would be integrated together and performed by the attacker\u0026#39;s server\u003c/p\u003e\n\n\u003cp\u003ei am attaching a poc video declaring the steps\u003cbr\u003e\n{F671826}\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\" href=\"/redirect?url=http%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\" href=\"/redirect?url=http%3A%2F%2Fresources.infosecinstitute.com%2Fbypassing-csrf-protections-fun-profit%2F%23gref\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://blog.cm2.pw/forging-content-type-header-with-flash/\" href=\"/redirect?url=https%3A%2F%2Fblog.cm2.pw%2Fforging-content-type-header-with-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.cm2.pw/forging-content-type-header-with-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eattacker can send request to create an application in behalf of user\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["sultancad","sourc7","pain45","renekroka","qotoz","cryptographer","demons_0786","hackerfrks","bf797b7a3fb3d3995ce8ec2","silentalpha","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":38702,"asset_type":"URL","asset_identifier":"my.stripo.email","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6664678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @qotoz \n\nPlease check the video you are referring to. I don't see it in attachments.\n\nThanks","markdown_message":"\u003cp\u003eHello \u003ca href=\"/qotoz\"\u003e@qotoz\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003ePlease check the video you are referring to. I don\u0026#39;t see it in attachments.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-31T10:02:27.542Z","updated_at":"2019-12-31T10:02:27.542Z","actor":{"username":"dkulaksyz","cleared":false,"url":"/dkulaksyz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S3TPxR7pmh7Mxu2XaqmxrKpz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6665685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @dkulaksyz ,\n\n i am reattching the video here \n█████████\n\nregards","markdown_message":"\u003cp\u003ehi \u003ca href=\"/dkulaksyz\"\u003e@dkulaksyz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003ei am reattching the video here \u003cbr\u003e\n█████████\u003c/p\u003e\n\n\u003cp\u003eregards\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-31T14:33:19.401Z","updated_at":"2020-02-10T08:38:31.818Z","actor":{"username":"qotoz","cleared":false,"url":"/qotoz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6673651,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report \n\nI have created tasks for the developers to fix this asap. Will come to you here in case of any questions from the team. Have a great day ahead!","markdown_message":"\u003cp\u003eThank you for the report \u003c/p\u003e\n\n\u003cp\u003eI have created tasks for the developers to fix this asap. Will come to you here in case of any questions from the team. Have a great day ahead!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-02T14:26:48.834Z","updated_at":"2020-01-02T14:26:48.834Z","actor":{"username":"dkulaksyz","cleared":false,"url":"/dkulaksyz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S3TPxR7pmh7Mxu2XaqmxrKpz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6986138,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-07T10:02:55.562Z","updated_at":"2020-02-07T10:02:55.562Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"qotoz","url":"/qotoz"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6997871,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"let's disclose this one ","markdown_message":"\u003cp\u003elet\u0026#39;s disclose this one \u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-08T22:42:26.814Z","updated_at":"2020-02-08T22:42:26.814Z","first_to_agree":true,"actor":{"username":"qotoz","cleared":false,"url":"/qotoz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7003396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-10T08:38:16.817Z","updated_at":"2020-02-10T08:38:16.817Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7003397,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-10T08:38:16.897Z","updated_at":"2020-02-10T08:38:16.897Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}