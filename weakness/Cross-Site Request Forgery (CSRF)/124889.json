{"id":124889,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjQ4ODk=","url":"https://hackerone.com/reports/124889","title":"Websites opened from reports can change url of report page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-21T23:47:18.780Z","submitted_at":"2016-03-21T23:47:18.780Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-21T11:00:26.198Z","bug_reporter_agreed_on_going_public_at":"2016-04-21T11:00:26.123Z","team_member_agreed_on_going_public_at":"2016-04-21T04:23:19.376Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Websites opened from the a hackerone report can change the url of the report page. For example, clicking on a link set to \"http://d214mfsab.org/same.html\" (including this one) will change the still-open report page to http://example.com. This works on current versions of Safari (including mobile) and possibly other browsers.\n\nThis vulnerability can lead to phishing attacks, where the user changes the url of the report page to a similar-looking page. Users would trust the tab with the report open to remain the same, and would be unsuspecting.\n\nThis is due to mishandling of the 'target=\"_blank\"' option.\n\nTo reproduce:\n\n1. In any html page (does not need to be the same origin), add the javascript \"opener.location = 'http://example.com'\". For this, I created http://d214mfsab.org/same.html\n2. Add this url to a hackerone report.\n3. When a user clicks on this url, the original report page's url will be changed to a potentially malicious url.\n\nA malicious user could modify the report page to an extremely similar page, which a user would be unlikely to notice. An attacker could duplicate the entire report page, and present a login form, which would steal the user's password.\n\nAlthough the user is warned about following links, this is not sufficient protection, as hackerone should ensure that pages cannot modify the report url.","vulnerability_information_html":"\u003cp\u003eWebsites opened from the a hackerone report can change the url of the report page. For example, clicking on a link set to \u0026quot;\u003ca title=\"http://d214mfsab.org/same.html\" href=\"/redirect?url=http%3A%2F%2Fd214mfsab.org%2Fsame.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://d214mfsab.org/same.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; (including this one) will change the still-open report page to \u003ca title=\"http://example.com\" href=\"/redirect?url=http%3A%2F%2Fexample.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This works on current versions of Safari (including mobile) and possibly other browsers.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability can lead to phishing attacks, where the user changes the url of the report page to a similar-looking page. Users would trust the tab with the report open to remain the same, and would be unsuspecting.\u003c/p\u003e\n\n\u003cp\u003eThis is due to mishandling of the \u0026#39;target=\u0026quot;_blank\u0026quot;\u0026#39; option.\u003c/p\u003e\n\n\u003cp\u003eTo reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIn any html page (does not need to be the same origin), add the javascript \u0026quot;opener.location = \u0026#39;\u003ca title=\"http://example.com\u0026#39;\" href=\"/redirect?url=http%3A%2F%2Fexample.com%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;. For this, I created \u003ca title=\"http://d214mfsab.org/same.html\" href=\"/redirect?url=http%3A%2F%2Fd214mfsab.org%2Fsame.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://d214mfsab.org/same.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAdd this url to a hackerone report.\u003c/li\u003e\n\u003cli\u003eWhen a user clicks on this url, the original report page\u0026#39;s url will be changed to a potentially malicious url.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eA malicious user could modify the report page to an extremely similar page, which a user would be unlikely to notice. An attacker could duplicate the entire report page, and present a login form, which would steal the user\u0026#39;s password.\u003c/p\u003e\n\n\u003cp\u003eAlthough the user is warned about following links, this is not sufficient protection, as hackerone should ensure that pages cannot modify the report url.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-21T04:23:19.432Z","allow_singular_disclosure_after":-145411130.93489447,"singular_disclosure_allowed":true,"vote_count":5,"voters":["cablej","eveeez","temmyscript","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":861427,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Which specific fields are you able to do this in? You state \"Websites opened from the a hackerone report\", but when you have an external link in a report it will open our interstitial redirect page in a new tab which exposes the url on the proceed button link without `target='_blank'`. Please provide what fields you are referring to.","markdown_message":"\u003cp\u003eWhich specific fields are you able to do this in? You state \u0026quot;Websites opened from the a hackerone report\u0026quot;, but when you have an external link in a report it will open our interstitial redirect page in a new tab which exposes the url on the proceed button link without \u003ccode\u003etarget=\u0026#39;_blank\u0026#39;\u003c/code\u003e. Please provide what fields you are referring to.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-22T00:41:39.028Z","updated_at":"2016-03-22T00:41:39.028Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":861445,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"This occurs as a combination of clicking a link in a report and clicking the \"proceed\" button on the redirect page. This is possible as the \"window.opener\" variable is set to the tab with the report open, allowing a malicious user to change the url of the open tab. In order to prevent this, the \"window.opener\" variable must be set to null. Oddly enough, in the redirect page, the variable *is* null, but is set to the original report tab when the external page is opened.\n\nAs an example, clicking the following link in Safari on iOS or Mac and proceeding on the redirect page will change this page to example.com:\n\nhttp://d214mfsab.org/same.html","markdown_message":"\u003cp\u003eThis occurs as a combination of clicking a link in a report and clicking the \u0026quot;proceed\u0026quot; button on the redirect page. This is possible as the \u0026quot;window.opener\u0026quot; variable is set to the tab with the report open, allowing a malicious user to change the url of the open tab. In order to prevent this, the \u0026quot;window.opener\u0026quot; variable must be set to null. Oddly enough, in the redirect page, the variable \u003cem\u003eis\u003c/em\u003e null, but is set to the original report tab when the external page is opened.\u003c/p\u003e\n\n\u003cp\u003eAs an example, clicking the following link in Safari on iOS or Mac and proceeding on the redirect page will change this page to example.com:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://d214mfsab.org/same.html\" href=\"/redirect?url=http%3A%2F%2Fd214mfsab.org%2Fsame.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://d214mfsab.org/same.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-22T01:16:55.111Z","updated_at":"2016-03-22T01:16:55.111Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":861921,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-22T13:30:15.856Z","updated_at":"2016-03-22T13:30:15.856Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":877840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cablej,\n\nI noticed it's been a while since you got a last public reply, sorry about that. We're looking into this report, and trying decide what the best solution is here. Please stay tuned!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI noticed it\u0026#39;s been a while since you got a last public reply, sorry about that. We\u0026#39;re looking into this report, and trying decide what the best solution is here. Please stay tuned!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-30T11:44:15.109Z","updated_at":"2016-03-30T11:44:15.109Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":879360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the response! Looking forward to hearing back.","markdown_message":"\u003cp\u003eThanks for the response! Looking forward to hearing back.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-31T02:32:58.297Z","updated_at":"2016-03-31T02:32:58.297Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cablej,\n\nWe attempted to fix this by using `target: \"_blank\"` if the browser is Safari. The issue doesn't exist on either Chrome nor Firefox.\n\nCould you please confirm that this resolves the issue?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe attempted to fix this by using \u003ccode\u003etarget: \u0026quot;_blank\u0026quot;\u003c/code\u003e if the browser is Safari. The issue doesn\u0026#39;t exist on either Chrome nor Firefox.\u003c/p\u003e\n\n\u003cp\u003eCould you please confirm that this resolves the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T11:50:13.967Z","updated_at":"2016-04-01T11:50:13.967Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've tested this on Safari for iOS, and can confirm that it is fixed. I will verify this later today on Safari for Mac.","markdown_message":"\u003cp\u003eI\u0026#39;ve tested this on Safari for iOS, and can confirm that it is fixed. I will verify this later today on Safari for Mac.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T13:24:05.526Z","updated_at":"2016-04-01T13:24:05.526Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":889318,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-05T08:57:07.784Z","updated_at":"2016-04-05T08:57:07.784Z","actor":{"username":"rso","cleared":false,"url":"/rso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/031/bad304b45f09b089c121de18c65d91d226f0aeea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":896603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, I'm wondering if this report is eligible for a bounty.\n\nThanks,\nJack","markdown_message":"\u003cp\u003eHey, I\u0026#39;m wondering if this report is eligible for a bounty.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJack\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-08T20:55:00.813Z","updated_at":"2016-04-08T20:55:00.813Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @cablej!\n\nSo sorry for the delay, it's been a hectic week. We're looking into this, and will get back to you soon!\n\n\nEvan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eSo sorry for the delay, it\u0026#39;s been a hectic week. We\u0026#39;re looking into this, and will get back to you soon!\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T18:30:16.048Z","updated_at":"2016-04-19T18:30:16.048Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":919465,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks, @cablej, for this report. We appreciate your finding, and we welcome future reports like this in the future.\n\nHappy hacking!","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e, for this report. We appreciate your finding, and we welcome future reports like this in the future.\u003c/p\u003e\n\n\u003cp\u003eHappy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T04:22:59.824Z","updated_at":"2016-04-21T04:22:59.824Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"cablej","url":"/cablej"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":919466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-21T04:23:19.401Z","updated_at":"2016-04-21T04:23:19.401Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":920014,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-21T11:00:26.144Z","updated_at":"2016-04-21T11:00:26.144Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":920015,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-21T11:00:26.217Z","updated_at":"2016-04-21T11:00:26.217Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1732,"category":"team","content":"This issue is similar to #23386, though only exploitable via Safari.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis issue is similar to \u003ca href=\"/reports/23386\"\u003e#23386\u003c/a\u003e, though only exploitable via Safari.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}