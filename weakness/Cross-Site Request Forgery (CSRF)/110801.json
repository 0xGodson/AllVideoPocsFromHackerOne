{"id":110801,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA4MDE=","url":"https://hackerone.com/reports/110801","title":"Internal GET SSRF via CSRF with Press This scan feature","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-14T22:11:01.564Z","submitted_at":"2016-01-14T22:11:01.564Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skansing","url":"/skansing","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-04T10:14:19.660Z","bug_reporter_agreed_on_going_public_at":"2016-02-03T10:14:04.257Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n-----------------------------------\nThe url `http://xxx.xxx.xxx.xxx/wp-admin/press-this.php?u=URL_TO_SCRAPE\u0026url-scan-submit=Scan` does not validate that user intends to send a scrape request.\nThe filter does not validate for `0.0.0.0:PORT` and allows the attacker to make the victim send GET request to servers priate127.0.0.1:PORT, localhost:PORT or anything which can be accessed via 0.0.0.0\n\nSo basicly a wordpress installations can send unwanted scrape/scan requests on behalf of their user invoked by the attacker. Including private connections via 0.0.0.0\n\n\nExample\n--------------------------------------- \nVictim is owner of myWordpress.com\n\n- Victim is logged into Wordpress.\n- Victim visits bad site with a content of`\u003cimg src=\"//myWordpress.com/wp-admin/press-this.php?u=htto://0.0.0.0:8080\u0026url-scan-submit=Scan\" /\u003e \n-  Victim sends a unwanted request to their server requesting a internal server address to be hit.\n- Server sends get request to 0.0.0.0:8080\n- Servers private 127.0.0.1 answers back.\n\nThis example is with a private address, but it could also be a public. address\n\n  \nFix\n----------------------------------------\nThe scan/scrape should be a POST request using a csrf token or etc. \nThe address 0.0.0.0 should not be allowd for scanning/scraping.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eThe url \u003ccode\u003ehttp://xxx.xxx.xxx.xxx/wp-admin/press-this.php?u=URL_TO_SCRAPE\u0026amp;url-scan-submit=Scan\u003c/code\u003e does not validate that user intends to send a scrape request.\u003cbr\u003e\nThe filter does not validate for \u003ccode\u003e0.0.0.0:PORT\u003c/code\u003e and allows the attacker to make the victim send GET request to servers priate127.0.0.1:PORT, localhost:PORT or anything which can be accessed via 0.0.0.0\u003c/p\u003e\n\n\u003cp\u003eSo basicly a wordpress installations can send unwanted scrape/scan requests on behalf of their user invoked by the attacker. Including private connections via 0.0.0.0\u003c/p\u003e\n\n\u003ch2 id=\"example\"\u003eExample\u003c/h2\u003e\n\n\u003cp\u003eVictim is owner of myWordpress.com\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eVictim is logged into Wordpress.\u003c/li\u003e\n\u003cli\u003eVictim visits bad site with a content of`\u0026lt;img src=\u0026quot;//myWordpress.com/wp-admin/press-this.php?u=htto://0.0.0.0:8080\u0026amp;url-scan-submit=Scan\u0026quot; /\u0026gt; \u003c/li\u003e\n\u003cli\u003e Victim sends a unwanted request to their server requesting a internal server address to be hit.\u003c/li\u003e\n\u003cli\u003eServer sends get request to 0.0.0.0:8080\u003c/li\u003e\n\u003cli\u003eServers private 127.0.0.1 answers back.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis example is with a private address, but it could also be a public. address\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe scan/scrape should be a POST request using a csrf token or etc. \u003cbr\u003e\nThe address 0.0.0.0 should not be allowd for scanning/scraping.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-04T10:14:05.046Z","allow_singular_disclosure_after":-152128931.89182335,"singular_disclosure_allowed":true,"vote_count":3,"voters":["skansing","eveeez","frkhansen"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":758582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wheps.. the ip `xxx.xxx.xxx.xxx` in the top example is my wp test server.  It was actual meant as placeholder for any wordpress site with Press This. \nMy test was done against latest version.\n\n\n","markdown_message":"\u003cp\u003eWheps.. the ip \u003ccode\u003exxx.xxx.xxx.xxx\u003c/code\u003e in the top example is my wp test server.  It was actual meant as placeholder for any wordpress site with Press This. \u003cbr\u003e\nMy test was done against latest version.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-14T22:46:28.865Z","updated_at":"2016-03-04T12:16:39.467Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":767155,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on this?","markdown_message":"\u003cp\u003eAny update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-21T19:06:36.241Z","updated_at":"2016-01-21T19:06:36.241Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":767869,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, thanks for the report.\nThe WordPress security team has been notified and are currently investigating this issue.","markdown_message":"\u003cp\u003eHi, thanks for the report.\u003cbr\u003e\nThe WordPress security team has been notified and are currently investigating this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-22T05:13:12.028Z","updated_at":"2016-01-22T05:13:12.028Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How would you like to be credited for this bug report?","markdown_message":"\u003cp\u003eHow would you like to be credited for this bug report?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T15:48:18.498Z","updated_at":"2016-02-02T15:48:18.498Z","actor":{"username":"mdawaffe","cleared":false,"url":"/mdawaffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/980/361d223c60a3868eb44f3eb91cdb964118362ff4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mdawaffe \n\nYes thanks. If you are using a fullname, please use \"Ronni Skansing\" else\nlet me know what you need. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mdawaffe\"\u003e@mdawaffe\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eYes thanks. If you are using a fullname, please use \u0026quot;Ronni Skansing\u0026quot; else\u003cbr\u003e\nlet me know what you need. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T16:00:02.573Z","updated_at":"2016-02-02T16:00:02.573Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":781300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks.  Would you like us to include a link as well? Your hackerone profile, a https://wordpress.org/ profile, something else? No URL is fine too.","markdown_message":"\u003cp\u003eGreat, thanks.  Would you like us to include a link as well? Your hackerone profile, a \u003ca title=\"https://wordpress.org/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e profile, something else? No URL is fine too.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T16:05:30.904Z","updated_at":"2016-02-02T16:05:30.904Z","actor":{"username":"mdawaffe","cleared":false,"url":"/mdawaffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/980/361d223c60a3868eb44f3eb91cdb964118362ff4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If it's possible to link to my linkedin, that would be great. https://www.linkedin.com/in/ronni-skansing-36143b65","markdown_message":"\u003cp\u003eIf it\u0026#39;s possible to link to my linkedin, that would be great. \u003ca title=\"https://www.linkedin.com/in/ronni-skansing-36143b65\" href=\"/redirect?url=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fronni-skansing-36143b65\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.linkedin.com/in/ronni-skansing-36143b65\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T16:09:36.380Z","updated_at":"2016-02-02T16:09:36.380Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":781668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the fine credits on the release page of the new version.\n\nhttps://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/\n\nI did however notice it credited as \"XSS\" (wrong term unless you found another vector from the bug).\nit is more along the lines of  \"CSRF / SSRF / SSRF GET request bypass to local via 0.* \" or whatever suits better.\n\nIf for any reason you want to keep as it is, even if it is incorrect, then I have no problem with that.\n\n.","markdown_message":"\u003cp\u003eThanks for the fine credits on the release page of the new version.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.org%2Fnews%2F2016%2F02%2Fwordpress-4-4-2-security-and-maintenance-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI did however notice it credited as \u0026quot;XSS\u0026quot; (wrong term unless you found another vector from the bug).\u003cbr\u003e\nit is more along the lines of  \u0026quot;CSRF / SSRF / SSRF GET request bypass to local via 0.* \u0026quot; or whatever suits better.\u003c/p\u003e\n\n\u003cp\u003eIf for any reason you want to keep as it is, even if it is incorrect, then I have no problem with that.\u003c/p\u003e\n\n\u003cp\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T19:22:47.204Z","updated_at":"2016-02-02T19:22:47.204Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":781821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's pretty funny :) I will ask the author to change it.","markdown_message":"\u003cp\u003eThat\u0026#39;s pretty funny :) I will ask the author to change it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T21:07:10.105Z","updated_at":"2016-02-02T21:07:10.105Z","actor":{"username":"mdawaffe","cleared":false,"url":"/mdawaffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/980/361d223c60a3868eb44f3eb91cdb964118362ff4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yep made me giggle abit too =) \n\nThank for the quick feedback.","markdown_message":"\u003cp\u003eyep made me giggle abit too =) \u003c/p\u003e\n\n\u003cp\u003eThank for the quick feedback.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T21:10:37.485Z","updated_at":"2016-02-02T21:10:55.281Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":782097,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-03T00:37:18.460Z","updated_at":"2016-02-03T00:37:18.460Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skansing","url":"/skansing"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":782102,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-03T00:43:01.591Z","updated_at":"2016-02-03T00:43:01.591Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"skansing","url":"/skansing"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":782513,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty.\n\nHow do you feel about public disclosure","markdown_message":"\u003cp\u003eThanks for the bounty.\u003c/p\u003e\n\n\u003cp\u003eHow do you feel about public disclosure\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-03T10:14:04.282Z","updated_at":"2016-02-03T10:14:04.282Z","first_to_agree":true,"actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":823924,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-04T10:14:19.693Z","updated_at":"2016-03-04T10:14:19.693Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}