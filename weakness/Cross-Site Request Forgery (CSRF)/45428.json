{"id":45428,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTQyOA==","url":"https://hackerone.com/reports/45428","title":"CSRF bypass","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-01-27T19:22:38.392Z","submitted_at":"2015-01-27T19:22:38.392Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"shubham","url":"/shubham","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-01-30T18:18:49.473Z","bug_reporter_agreed_on_going_public_at":"2015-01-30T00:07:53.219Z","team_member_agreed_on_going_public_at":"2015-01-30T18:18:48.788Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Team,\r\n\r\nOnce again i'm here.\r\nDuring research of vimeo.com I found that you are using anti-csrf token against csrf attack. but it's not going to validate on server side.\r\n\r\nlet's see\r\n\r\nStep 1: go to https://vimeo.com/forgot_password\r\nStep 2: write your email and click on **help me**.\r\nStep 3: Now before posting make sure **Burp Suite's Interceptor is turned on** to capture the request.\r\n\r\nClick on \"help me\" now, you will see below kind of request in Burp suite:\r\n\r\n```\r\nPOST /forgot_password HTTP/1.1\r\nHost: vimeo.com\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:35.0) Gecko/20100101 Firefox/35.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://vimeo.com/forgot_password\r\nCookie: vuid=471411067.232973627; __utma=18302654.785580395.1421186258.1421859718.1422384189.4; __utmz=18302654.1421186258.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmv=18302654.|2=user_type=basic=1^3=ms=0=1^7=video_count=0=1; site_settings=%7B%22sticky_page%22%3Anull%7D; has_logged_in=1; __gads=ID=3eb5153d2e8ef474:T=1421187886:S=ALNI_MZ62UIUIjNjSl4kp3auNxfRHSXdnQ; stats_start_date=2015%2F01%2F10; stats_end_date=2015%2F01%2F14; __utmb=18302654.4.10.1422384189; __utmc=18302654; __utmli=forgot_form; xsrft=e9b0179d3dd45669bd6d44a2484fb0f5.0\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 79\r\n\r\nemail=shubhamgupta109.1995%40gmail.com\u0026token=e9b0179d3dd45669bd6d44a2484fb0f5.0\r\n```\r\n\r\nnow you can see you are using **anti-csrf token** there but it's not going to validate. attacker can flood user account with too many mails for password reset request.\r\n\r\nI'ave attached POC of the same.\r\nLet me know if you needed more info.\r\n\r\nBest Regard\r\nShubham","vulnerability_information_html":"\u003cp\u003eDear Team,\u003c/p\u003e\n\n\u003cp\u003eOnce again i\u0026#39;m here.\u003cbr\u003e\nDuring research of vimeo.com I found that you are using anti-csrf token against csrf attack. but it\u0026#39;s not going to validate on server side.\u003c/p\u003e\n\n\u003cp\u003elet\u0026#39;s see\u003c/p\u003e\n\n\u003cp\u003eStep 1: go to \u003ca title=\"https://vimeo.com/forgot_password\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fforgot_password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/forgot_password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nStep 2: write your email and click on \u003cstrong\u003ehelp me\u003c/strong\u003e.\u003cbr\u003e\nStep 3: Now before posting make sure \u003cstrong\u003eBurp Suite\u0026#39;s Interceptor is turned on\u003c/strong\u003e to capture the request.\u003c/p\u003e\n\n\u003cp\u003eClick on \u0026quot;help me\u0026quot; now, you will see below kind of request in Burp suite:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /forgot_password HTTP/1.1\nHost: vimeo.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:35.0) Gecko/20100101 Firefox/35.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://vimeo.com/forgot_password\nCookie: vuid=471411067.232973627; __utma=18302654.785580395.1421186258.1421859718.1422384189.4; __utmz=18302654.1421186258.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmv=18302654.|2=user_type=basic=1^3=ms=0=1^7=video_count=0=1; site_settings=%7B%22sticky_page%22%3Anull%7D; has_logged_in=1; __gads=ID=3eb5153d2e8ef474:T=1421187886:S=ALNI_MZ62UIUIjNjSl4kp3auNxfRHSXdnQ; stats_start_date=2015%2F01%2F10; stats_end_date=2015%2F01%2F14; __utmb=18302654.4.10.1422384189; __utmc=18302654; __utmli=forgot_form; xsrft=e9b0179d3dd45669bd6d44a2484fb0f5.0\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 79\n\nemail=shubhamgupta109.1995%40gmail.com\u0026amp;token=e9b0179d3dd45669bd6d44a2484fb0f5.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003enow you can see you are using \u003cstrong\u003eanti-csrf token\u003c/strong\u003e there but it\u0026#39;s not going to validate. attacker can flood user account with too many mails for password reset request.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ave attached POC of the same.\u003cbr\u003e\nLet me know if you needed more info.\u003c/p\u003e\n\n\u003cp\u003eBest Regard\u003cbr\u003e\nShubham\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":27951,"file_name":"POC.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/951/621e762f2c5db1fb13f30678cfcf02202b42f171/POC.gif?response-content-disposition=attachment%3B%20filename%3D%22POC.gif%22%3B%20filename%2A%3DUTF-8%27%27POC.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060026Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=fc60fe5922173fc7d699bd1f64faddd9ef44afb9a46318e1b9db1bc8c57b3e72","file_size":4177850,"type":"image/gif"}],"allow_singular_disclosure_at":"2015-03-01T00:07:54.778Z","allow_singular_disclosure_after":-184053151.52828026,"singular_disclosure_allowed":true,"vote_count":1,"voters":["tandav"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":319307,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Our CSRF tokens can currently be re-used. In this case we've implemented rate limiting on this page to prevent abuse.","markdown_message":"\u003cp\u003eOur CSRF tokens can currently be re-used. In this case we\u0026#39;ve implemented rate limiting on this page to prevent abuse.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-27T23:01:07.117Z","updated_at":"2015-01-27T23:01:07.117Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319488,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok your csrf token can be re-used but at least you have fix that vuln. By implemented rate limiting on that page so I think you have to change status as resolved.\n\nBest Regard\nShubham","markdown_message":"\u003cp\u003eOk your csrf token can be re-used but at least you have fix that vuln. By implemented rate limiting on that page so I think you have to change status as resolved.\u003c/p\u003e\n\n\u003cp\u003eBest Regard\u003cbr\u003e\nShubham\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-28T06:10:37.210Z","updated_at":"2015-01-28T06:10:37.210Z","actor":{"username":"shubham","cleared":false,"url":"/shubham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"atleast reply me on this.","markdown_message":"\u003cp\u003eatleast reply me on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-28T18:24:26.608Z","updated_at":"2015-01-28T18:24:26.608Z","actor":{"username":"shubham","cleared":false,"url":"/shubham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure plz.","markdown_message":"\u003cp\u003ePublic disclosure plz.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-30T00:07:53.666Z","updated_at":"2015-01-30T00:07:53.666Z","first_to_agree":true,"actor":{"username":"shubham","cleared":false,"url":"/shubham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321390,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey Shubham, sorry I accidentally posted my response privately. I'm not marking it as resolved because it's not the original report that prompted us to add rate limiting and I like to be clear on who gets credit for what. ","markdown_message":"\u003cp\u003eHey Shubham, sorry I accidentally posted my response privately. I\u0026#39;m not marking it as resolved because it\u0026#39;s not the original report that prompted us to add rate limiting and I like to be clear on who gets credit for what. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-30T18:18:48.832Z","updated_at":"2015-01-30T18:18:48.832Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321391,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-30T18:18:49.509Z","updated_at":"2015-01-30T18:18:49.509Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}