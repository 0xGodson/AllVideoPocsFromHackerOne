{"id":738,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mzg=","url":"https://hackerone.com/reports/738","title":"Information disclosure (reset password token) and changing the user's password","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-01-17T00:49:34.781Z","submitted_at":"2014-01-17T00:49:34.781Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dawidczagan","url":"/dawidczagan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-02-19T23:44:04.883Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-01-23T02:16:57.890Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The user gets an e-mail with password recovery link, which includes reset password token. The user clicks this link and is expected to enter a new password twice. Before entering the password the user clicks a link to a picture (https://xkcd.com/936/). When this happens, cross-domain referer leakage takes place. \r\n\r\n\r\nGET /936/ HTTP/1.1\r\nHost: xkcd.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:25.0) Gecko/20100101 Firefox/25.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: pl,en-us;q=0.7,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://hackerone.com/users/password/edit?reset_password_token=HERE_IS_THE_VALUE_OF_RESET_PASSWORD_TOKEN\r\nConnection: keep-alive\r\n\r\n\r\nIt allows the person who has control of xkcd.com to change the user's password (CSRF attack), because this person knows reset password token of the user, uses a new user's password of his choice and authenticity_token is not needed to make it happen. ","vulnerability_information_html":"\u003cp\u003eThe user gets an e-mail with password recovery link, which includes reset password token. The user clicks this link and is expected to enter a new password twice. Before entering the password the user clicks a link to a picture (\u003ca title=\"https://xkcd.com/936/\" href=\"/redirect?url=https%3A%2F%2Fxkcd.com%2F936%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://xkcd.com/936/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). When this happens, cross-domain referer leakage takes place. \u003c/p\u003e\n\n\u003cp\u003eGET /936/ HTTP/1.1\u003cbr\u003e\nHost: xkcd.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:25.0) Gecko/20100101 Firefox/25.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: pl,en-us;q=0.7,en;q=0.3\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://hackerone.com/users/password/edit?reset_password_token=HERE_IS_THE_VALUE_OF_RESET_PASSWORD_TOKEN\" href=\"https://hackerone.com/users/password/edit?reset_password_token=HERE_IS_THE_VALUE_OF_RESET_PASSWORD_TOKEN\"\u003ehttps://hackerone.com/users/password/edit?reset_password_token=HERE_IS_THE_VALUE_OF_RESET_PASSWORD_TOKEN\u003c/a\u003e\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eIt allows the person who has control of xkcd.com to change the user\u0026#39;s password (CSRF attack), because this person knows reset password token of the user, uses a new user\u0026#39;s password of his choice and authenticity_token is not needed to make it happen. \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-02-19T23:44:02.218Z","allow_singular_disclosure_after":-216370837.35391542,"singular_disclosure_allowed":true,"vote_count":15,"voters":["hogarth45","spam404","sameerphad72","th3-l3g3nd","skansing","mygf","eveeez","khizer47","0xffrenxi","its_afolic","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me correct the last section of the report (\"It allows the person who has control of xkcd.com...\"). The person who has control of xkcd.com (let's call him attacker in the report) knows at this point the password recovery link from Referer. The attacker visits the link from Referer and sets up a new password for the user's account. Moreover, the attacker is automatically logged in after changing the password (this is helpful when the attacker doesn't know the e-mail of the user).","markdown_message":"\u003cp\u003eLet me correct the last section of the report (\u0026quot;It allows the person who has control of xkcd.com...\u0026quot;). The person who has control of xkcd.com (let\u0026#39;s call him attacker in the report) knows at this point the password recovery link from Referer. The attacker visits the link from Referer and sets up a new password for the user\u0026#39;s account. Moreover, the attacker is automatically logged in after changing the password (this is helpful when the attacker doesn\u0026#39;t know the e-mail of the user).\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-18T08:17:01.829Z","updated_at":"2014-01-18T08:17:01.829Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3814,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hah, pretty creative find. :) This isn't incredibly high risk, but we'll get this one fixed soon. Thanks!","markdown_message":"\u003cp\u003eHah, pretty creative find. :) This isn\u0026#39;t incredibly high risk, but we\u0026#39;ll get this one fixed soon. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-18T09:36:06.628Z","updated_at":"2014-01-18T09:36:06.628Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3865,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We shouldn't be leaking referrers to `xkcd.com` anymore. Thanks!","markdown_message":"\u003cp\u003eWe shouldn\u0026#39;t be leaking referrers to \u003ccode\u003exkcd.com\u003c/code\u003e anymore. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-20T23:44:02.508Z","updated_at":"2014-01-20T23:44:02.508Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"dawidczagan","url":"/dawidczagan"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3866,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-01-20T23:45:18.141Z","updated_at":"2014-01-20T23:45:18.141Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"dawidczagan","url":"/dawidczagan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4163,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-01-23T02:16:57.905Z","updated_at":"2014-01-23T02:16:57.905Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8425,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-02-19T23:44:04.931Z","updated_at":"2014-02-19T23:44:04.931Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}