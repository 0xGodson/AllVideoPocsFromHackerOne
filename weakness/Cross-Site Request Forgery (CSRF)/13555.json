{"id":13555,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzU1NQ==","url":"https://hackerone.com/reports/13555","title":"Login CSRF using Twitter oauth","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-27T08:06:02.615Z","submitted_at":"2014-05-27T08:06:02.615Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"robin","url":"/robin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/962/912899e3bae0502ed37490fec9f7eaf0e606284c_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3,"url":"https://hackerone.com/factlink","handle":"factlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Factlink","twitter_handle":"factlink","website":"https://factlink.com","about":"Share your knowledge with the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-05T14:33:43.579Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-06-05T15:42:18.068Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"this bug allows a user to be logged in as the attacker. The main reason is that no state is maintained in the authentication flow. Although the Twitter flow still uses OAuth 1.0A, which has no state parameter as in OAuth 2, it is still possible to prevent this type of attack by setting an additional parameter in the oauth_callback value.\r\n\r\nAn attacker could exploit this bug as follows:\r\n\r\nAttacker initiates Twitter OAuth process with Phabricator\r\nAttacker allows access to Phabricator app\r\nAttacker records and drops redirection to Phabricator (in order not to consume token)\r\nAttacker directs victim to /auth/login/twitter:twitter.com/?oauth_token={attacker_token}\u0026oauth_verifier={attacker_verifier}\r\nVictim is now logged in as attacker\r\nTo mitigate this vulnerability, either maintain state in the authentication flow by adding a parameter in the callback value or, as Twitter seems to support OAuth 2, use that instead","vulnerability_information_html":"\u003cp\u003ethis bug allows a user to be logged in as the attacker. The main reason is that no state is maintained in the authentication flow. Although the Twitter flow still uses OAuth 1.0A, which has no state parameter as in OAuth 2, it is still possible to prevent this type of attack by setting an additional parameter in the oauth_callback value.\u003c/p\u003e\n\n\u003cp\u003eAn attacker could exploit this bug as follows:\u003c/p\u003e\n\n\u003cp\u003eAttacker initiates Twitter OAuth process with Phabricator\u003cbr\u003e\nAttacker allows access to Phabricator app\u003cbr\u003e\nAttacker records and drops redirection to Phabricator (in order not to consume token)\u003cbr\u003e\nAttacker directs victim to /auth/login/twitter:twitter.com/?oauth_token={attacker_token}\u0026amp;oauth_verifier={attacker_verifier}\u003cbr\u003e\nVictim is now logged in as attacker\u003cbr\u003e\nTo mitigate this vulnerability, either maintain state in the authentication flow by adding a parameter in the callback value or, as Twitter seems to support OAuth 2, use that instead\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-05T14:33:42.061Z","allow_singular_disclosure_after":-204645144.71293855,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":58042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry i wrote Phabricator instead of Factlink..Hope you wont mind..","markdown_message":"\u003cp\u003eSorry i wrote Phabricator instead of Factlink..Hope you wont mind..\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T08:06:41.738Z","updated_at":"2014-05-27T08:06:41.738Z","actor":{"username":"robin","cleared":false,"url":"/robin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/962/912899e3bae0502ed37490fec9f7eaf0e606284c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":59628,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. We're looking into it.","markdown_message":"\u003cp\u003eThanks for your report. We\u0026#39;re looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T13:39:07.444Z","updated_at":"2014-05-28T13:39:07.444Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":67207,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your help. The bug has been [resolved](https://github.com/Factlink/factlink-core/pull/38) and is now running on the staging server.\n","markdown_message":"\u003cp\u003eThanks for your help. The bug has been \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFactlink%2Ffactlink-core%2Fpull%2F38\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eresolved\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and is now running on the staging server.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-05T14:33:42.089Z","updated_at":"2014-06-05T14:37:06.691Z","actor":{"username":"mvgijssel","cleared":false,"url":"/mvgijssel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/630/800fef8d03ef6911255da0e4bad8b7a4eee5d6da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"robin","url":"/robin"},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":67244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok sir","markdown_message":"\u003cp\u003eok sir\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-05T15:36:24.520Z","updated_at":"2014-06-05T15:36:24.520Z","actor":{"username":"robin","cleared":false,"url":"/robin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/962/912899e3bae0502ed37490fec9f7eaf0e606284c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":67248,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-05T15:42:18.089Z","updated_at":"2014-06-05T15:42:18.089Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":84738,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-05T14:33:43.600Z","updated_at":"2014-07-05T14:33:43.600Z","actor":{"url":"/factlink","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Factlink"}},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}