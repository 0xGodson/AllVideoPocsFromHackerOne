{"id":123125,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjMxMjU=","url":"https://hackerone.com/reports/123125","title":"XSS on hardware.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-15T01:03:38.664Z","submitted_at":"2016-03-15T01:03:38.664Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"virtualhunter","url":"/virtualhunter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-09T00:03:05.637Z","bug_reporter_agreed_on_going_public_at":"2016-04-09T00:03:05.408Z","team_member_agreed_on_going_public_at":"2016-04-04T22:47:31.507Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This is stored vulnerability for all your users, not only registered or signed in.\n\nVulnerable parameter: properties[builder_id] at *.shopify.com/cart/add\nThe vulnerability is in array levels. When you try something like \nproperties[builder_id][second_parameter]=value,\nyou will see many corrupted tags in HTML because 2-level array will return as \n\"builder_id\":{\"second_parameter \":\"value\"} instead of \"builder_id\":\"shapp_options_421549285_1455208671885\" in cart.js\n\nSo you could inject your code in tr,div,a,insert  tags. All you need - is redirect a victim to special url. For example, you cold try this: properties[builder_id][%20onmouseover%3dalert(1)%20]=value \nScript will strike when victim will move a coursor over product.\n\nHere is a link with your cookies in a harware store for example:\nhttp://hardware.shopify.com/cart/add?\u0026id=1106494145\u0026iPad%20Stand=1120276481\u0026Cash%20Drawer=1120176153\u0026Receipt%20Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id][%20onmouseover%3dalert(document.cookie)%20]=shapp_options_421549285_1455208671885\u0026properties[master_builder][]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n\nI recommend you to check incoming parameters for arrays like here:\nhttp://php.net/manual/en/function.is-array.php","vulnerability_information_html":"\u003cp\u003eThis is stored vulnerability for all your users, not only registered or signed in.\u003c/p\u003e\n\n\u003cp\u003eVulnerable parameter: properties[builder_id] at *.shopify.com/cart/add\u003cbr\u003e\nThe vulnerability is in array levels. When you try something like \u003cbr\u003e\nproperties[builder_id][second_parameter]=value,\u003cbr\u003e\nyou will see many corrupted tags in HTML because 2-level array will return as \u003cbr\u003e\n\u0026quot;builder_id\u0026quot;:{\u0026quot;second_parameter \u0026quot;:\u0026quot;value\u0026quot;} instead of \u0026quot;builder_id\u0026quot;:\u0026quot;shapp_options_421549285_1455208671885\u0026quot; in cart.js\u003c/p\u003e\n\n\u003cp\u003eSo you could inject your code in tr,div,a,insert  tags. All you need - is redirect a victim to special url. For example, you cold try this: properties[builder_id][%20onmouseover%3dalert(1)%20]=value \u003cbr\u003e\nScript will strike when victim will move a coursor over product.\u003c/p\u003e\n\n\u003cp\u003eHere is a link with your cookies in a harware store for example:\u003cbr\u003e\n\u003ca title=\"http://hardware.shopify.com/cart/add?\u0026amp;id=1106494145\u0026amp;iPad%20Stand=1120276481\u0026amp;Cash%20Drawer=1120176153\u0026amp;Receipt%20Printer=1120166789\u0026amp;attributes%5Bcart_exists%5D=true\u0026amp;properties%5Bbuilder_id%5D%5B%20onmouseover%3dalert(document.cookie)%20%5D=shapp_options_421549285_1455208671885\u0026amp;properties%5Bmaster_builder%5D%5B%5D=1\u0026amp;properties%5Btest%5D=test\u0026amp;properties%5Bvalue%5D=11\u0026amp;add\" href=\"/redirect?url=http%3A%2F%2Fhardware.shopify.com%2Fcart%2Fadd%3F%26id%3D1106494145%26iPad%2520Stand%3D1120276481%26Cash%2520Drawer%3D1120176153%26Receipt%2520Printer%3D1120166789%26attributes%255Bcart_exists%255D%3Dtrue%26properties%255Bbuilder_id%255D%255B%2520onmouseover%253dalert%28document.cookie%29%2520%255D%3Dshapp_options_421549285_1455208671885%26properties%255Bmaster_builder%255D%255B%255D%3D1%26properties%255Btest%255D%3Dtest%26properties%255Bvalue%255D%3D11%26add\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://hardware.shopify.com/cart/add?\u0026amp;id=1106494145\u0026amp;iPad%20Stand=1120276481\u0026amp;Cash%20Drawer=1120176153\u0026amp;Receipt%20Printer=1120166789\u0026amp;attributes%5Bcart_exists%5D=true\u0026amp;properties%5Bbuilder_id%5D%5B%20onmouseover%3dalert(document.cookie)%20%5D=shapp_options_421549285_1455208671885\u0026amp;properties%5Bmaster_builder%5D%5B%5D=1\u0026amp;properties%5Btest%5D=test\u0026amp;properties%5Bvalue%5D=11\u0026amp;add\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI recommend you to check incoming parameters for arrays like here:\u003cbr\u003e\n\u003ca title=\"http://php.net/manual/en/function.is-array.php\" href=\"/redirect?url=http%3A%2F%2Fphp.net%2Fmanual%2Fen%2Ffunction.is-array.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://php.net/manual/en/function.is-array.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":78845,"file_name":"shopify.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/078/845/797e9ac5983f4f4e163ca1ec78428578f85ef582/shopify.jpg?response-content-disposition=attachment%3B%20filename%3D%22shopify.jpg%22%3B%20filename%2A%3DUTF-8%27%27shopify.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=63f9bd97ade42d9953443bfb3dc4dcc46fdeee243a891f2ad71c7d7d9f99514b","file_size":167693,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-05-04T22:47:31.705Z","allow_singular_disclosure_after":-146813625.6892377,"singular_disclosure_allowed":true,"vote_count":4,"voters":["b6117130df17feef13481e3","mashoud1122","sameerphad72","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":840617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You should understand, that not only one parameter affected. It is a whole vector, reducing to malformed code, depends on input parameters. So you should include better checking for all your data input.","markdown_message":"\u003cp\u003eYou should understand, that not only one parameter affected. It is a whole vector, reducing to malformed code, depends on input parameters. So you should include better checking for all your data input.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-15T10:36:42.069Z","updated_at":"2016-03-15T10:36:42.069Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841719,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-15T19:37:18.991Z","updated_at":"2016-03-15T19:37:18.991Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":848451,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has now been resolved.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue has now been resolved.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-18T14:56:46.166Z","updated_at":"2016-03-18T14:56:46.166Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"virtualhunter","url":"/virtualhunter"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":849835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to hear! Looks fixed :)","markdown_message":"\u003cp\u003eGlad to hear! Looks fixed :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-19T10:53:25.922Z","updated_at":"2016-03-19T10:53:25.922Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888705,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T22:47:18.764Z","updated_at":"2016-04-04T22:47:18.764Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"virtualhunter","url":"/virtualhunter"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":888706,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T22:47:31.532Z","updated_at":"2016-04-04T22:47:31.532Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":896917,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you! Disclosing :)","markdown_message":"\u003cp\u003eThank you! Disclosing :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-09T00:03:05.444Z","updated_at":"2016-04-09T00:03:05.444Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":896918,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-09T00:03:05.656Z","updated_at":"2016-04-09T00:03:05.656Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164662,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T13:05:59.439Z","updated_at":"2018-02-28T13:10:45.720Z","additional_data":{"added_weaknesses":[],"removed_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}