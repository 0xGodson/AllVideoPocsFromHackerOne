{"id":361130,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjExMzA=","url":"https://hackerone.com/reports/361130","title":"Same CSRF token is being used for deleting other platform login’s within an account and across other liberapay Account’s","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-06-02T16:52:29.297Z","submitted_at":"2018-06-02T16:52:29.297Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mah1ndra","url":"/mah1ndra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-04T08:13:00.725Z","bug_reporter_agreed_on_going_public_at":"2018-06-04T08:13:00.666Z","team_member_agreed_on_going_public_at":"2018-06-04T06:45:17.685Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003eWe’ve got  “Accounts Elsewhere” option in the profile section. where we can connect our liberapay account with multiple other platform accounts.\n\n\u003eWhile deleting those Multiple other platform accounts same CSRF token is being used.\n\n\u003eI’ve signed up with a couple of liberapay accounts. Where I found the using of same CSRF token within the account and across other accounts.\n\n## Impact\n\nIn the first account in \"Accounts ElseWhere\" section, I've logged in with Google+ account successfully and while deleting the account I got CSRF token = J0Lk5iXTpp40iDN5KNcrI24bulPcF0PV\nNext, I found the same CSRF token is being during deleting all other available other platform logins.\n\nI've created another liberapay account and in \"Account ElseWhere\" section. I've logged in with my Facebook account and while deleting it I came across same CSRF token used in other account = J0Lk5iXTpp40iDN5KNcrI24bulPcF0PV.\n\nSo, I'Ve found same CSRF token is being used for deleting other platform accounts within a liberapay account and across liberapay accounts.\n\nI'm dropping the POC video below.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eWe’ve got  “Accounts Elsewhere” option in the profile section. where we can connect our liberapay account with multiple other platform accounts.\u003c/p\u003e\n\n\u003cp\u003eWhile deleting those Multiple other platform accounts same CSRF token is being used.\u003c/p\u003e\n\n\u003cp\u003eI’ve signed up with a couple of liberapay accounts. Where I found the using of same CSRF token within the account and across other accounts.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIn the first account in \u0026quot;Accounts ElseWhere\u0026quot; section, I\u0026#39;ve logged in with Google+ account successfully and while deleting the account I got CSRF token = J0Lk5iXTpp40iDN5KNcrI24bulPcF0PV\u003cbr\u003e\nNext, I found the same CSRF token is being during deleting all other available other platform logins.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve created another liberapay account and in \u0026quot;Account ElseWhere\u0026quot; section. I\u0026#39;ve logged in with my Facebook account and while deleting it I came across same CSRF token used in other account = J0Lk5iXTpp40iDN5KNcrI24bulPcF0PV.\u003c/p\u003e\n\n\u003cp\u003eSo, I\u0026#39;Ve found same CSRF token is being used for deleting other platform accounts within a liberapay account and across liberapay accounts.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m dropping the POC video below.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":304427,"file_name":"liberapay.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/304/427/2b7e4ff655dc21e780f25d1cb0616c4b4d400007/liberapay.mp4?response-content-disposition=attachment%3B%20filename%3D%22liberapay.mp4%22%3B%20filename%2A%3DUTF-8%27%27liberapay.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054311Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=d9c11c95989b378a7beeefd807ef2e8f9320f6504efab7c3f977aa549d30317f","file_size":7002363,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["foobar7","0x08","mah1ndra"],"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2833418,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! I am currently reviewing your report.","markdown_message":"\u003cp\u003eThank you for your submission! I am currently reviewing your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T17:17:42.501Z","updated_at":"2018-06-02T17:17:42.501Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the update!","markdown_message":"\u003cp\u003eThank you for the update!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T17:20:08.342Z","updated_at":"2018-06-02T17:20:08.342Z","actor":{"username":"mah1ndra","cleared":false,"url":"/mah1ndra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2833432,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I am triaging this report to indicate that we have processed this report, but still need to determine whether or not this is a valid issue.","markdown_message":"\u003cp\u003eI am triaging this report to indicate that we have processed this report, but still need to determine whether or not this is a valid issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T17:24:03.479Z","updated_at":"2018-06-02T17:24:03.479Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The CSRF token is a randomly generated string stored in a generic cookie with a validity of 7 days. Since it's not tied to an account you won't see it change if you create multiple accounts in the same week using the same browser. Reusing the same token multiple times may not be ideal, but it doesn't mean that the CSRF protection is broken.","markdown_message":"\u003cp\u003eThe CSRF token is a randomly generated string stored in a generic cookie with a validity of 7 days. Since it\u0026#39;s not tied to an account you won\u0026#39;t see it change if you create multiple accounts in the same week using the same browser. Reusing the same token multiple times may not be ideal, but it doesn\u0026#39;t mean that the CSRF protection is broken.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T20:03:13.577Z","updated_at":"2018-06-02T20:03:13.577Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yes. the token is being generated randomly. But when we've signout of our account the cookie should be expired and  when a new user signs in he should get a different random token with a new cookie. That's good security practice. But in case of liberapay it's not happening. It may seem to be a small issue. But we cannot leave them like that right. We should always be on secure side with security in mind. Anytime anything may happen. like Cookie-Based Injection. It's may be possible to steal or manipulate session and cookies if an attacker can injection XSS .\nThank you for the update @changaco ","markdown_message":"\u003cp\u003eyes. the token is being generated randomly. But when we\u0026#39;ve signout of our account the cookie should be expired and  when a new user signs in he should get a different random token with a new cookie. That\u0026#39;s good security practice. But in case of liberapay it\u0026#39;s not happening. It may seem to be a small issue. But we cannot leave them like that right. We should always be on secure side with security in mind. Anytime anything may happen. like Cookie-Based Injection. It\u0026#39;s may be possible to steal or manipulate session and cookies if an attacker can injection XSS .\u003cbr\u003e\nThank you for the update \u003ca href=\"/changaco\"\u003e@changaco\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T20:21:18.952Z","updated_at":"2018-06-02T20:21:18.952Z","actor":{"username":"mah1ndra","cleared":false,"url":"/mah1ndra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2833672,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Good to know! I will close this report as informative so as not to affect your reputation.","markdown_message":"\u003cp\u003eGood to know! I will close this report as informative so as not to affect your reputation.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T20:21:46.093Z","updated_at":"2018-06-02T20:21:46.093Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the feedback @edoverflow ","markdown_message":"\u003cp\u003eThank you for the feedback \u003ca href=\"/edoverflow\"\u003e@edoverflow\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T20:27:38.887Z","updated_at":"2018-06-02T20:30:09.890Z","actor":{"username":"mah1ndra","cleared":false,"url":"/mah1ndra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2837084,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-04T06:45:17.782Z","updated_at":"2018-06-04T06:45:17.782Z","first_to_agree":true,"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2837085,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-04T06:45:41.190Z","updated_at":"2018-06-04T06:45:41.190Z","additional_data":{"duplicate_report_id":361400},"actor":{"username":"d4w","cleared":false,"url":"/d4w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/833/6437ac42a7135d3ae0e0be5226166f85dcb596f7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2837205,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-04T08:13:00.697Z","updated_at":"2018-06-04T08:13:00.697Z","actor":{"username":"mah1ndra","cleared":false,"url":"/mah1ndra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2837206,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-04T08:13:00.751Z","updated_at":"2018-06-04T08:13:00.751Z","actor":{"username":"mah1ndra","cleared":false,"url":"/mah1ndra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/737/8672301a3268c1a6d9e7958778cff2321a2a5aea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}