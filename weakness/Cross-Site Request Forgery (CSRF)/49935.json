{"id":49935,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTkzNQ==","url":"https://hackerone.com/reports/49935","title":"rails-ujs will send CSRF tokens to other origins","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-03T18:42:54.912Z","submitted_at":"2015-03-03T18:42:54.912Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mastahyeti","url":"/mastahyeti","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-06-16T19:21:31.440Z","bug_reporter_agreed_on_going_public_at":"2015-06-16T19:21:31.180Z","team_member_agreed_on_going_public_at":"2015-06-16T19:20:31.532Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I reported this via email a few months ago. Here was my initial email:\r\n\r\n\u003e Hello,\r\n\u003e I've been playing with getting Rails apps to send CSRF tokens to the wrong domains and I found a few problems. The main motivation for this is in attacking a site that uses Content Security Policy. With CSP enabled, an attacker with an XSS vulnerability cannot simply inject inline JavaScript, but they can still abuse some Rails features to steal a CSRF token.\r\n\u003e \r\n\u003e In the scenario where an attacker can inject arbitrary HTML into the response, the simplest attack would be to inject:\r\n\u003e \r\n\u003e \u003ca href=\"https://attacker.com\" data-remote data-method=\"post\" data-cross-domain=\"false\"\u003e\r\n\u003e \r\n\u003e Clicking on this link will trigger an OPTIONS request to attacker.com. If the attacker returns the correct CORS headers, a POST request containing the user's CSRF token will be sent to attacker.com.\r\n\u003e \r\n\u003e In a second scenario, an attacker might be able to control only the href attribute of an anchor tag or the action attribute of a form tag that will trigger a data-remote action. This isn't uncommon to see if the site is building anchor or form tags dynamically. In this case, the attacker can set the href or action to \" https://attacker.com\". This will be passed to JQuery, who will see this as a same origin request.\r\n\u003e \r\n\u003e The JQuery behavior can be found here and a similar bug in Zepto can be found here. In both these cases, weak regexes don't match the URL and the framework fails open into assuming that the URL is same origin. Prefixing the URL with a space character is one way to break this regex, but the regexes are pretty weak and there are probably other ways as well.\r\n\u003e \r\n\u003e I'll contact the JQuery/Zepto folks about fixing their regexes, but there are a few thing that could improve this in jquery_ujs as well.\r\n\u003e \r\n\u003e I don't think a data attribute (data-cross-domain) should be able to force jquery_ujs to send the CSRF token.\r\n\u003e The href attribute should be accessed directly here rather than calling attr(\"href\"). When called directly, the browser does a lot to clean up the URL and make sure that it is well formed. This would address the space prefix issue.\r\n\u003e Some stronger protections could be added before calling CSRFProtection here.\r\n\u003e For links with data-method, but without data-remote, the origin isn't even checked before adding a CSRF token to the form. This could even be exploited accidentally. Origin checking should be added here\r\n\u003e \r\n\u003e I haven't seen a bulletproof way for comparing origins yet, but I've got a few ideas if you want to discuss it more. Let me know what you think.\r\n\u003e \r\n\u003e Thanks,\r\n\u003e Ben Toews\r\n\u003e GitHub Security","vulnerability_information_html":"\u003cp\u003eI reported this via email a few months ago. Here was my initial email:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eHello,\u003cbr\u003e\nI\u0026#39;ve been playing with getting Rails apps to send CSRF tokens to the wrong domains and I found a few problems. The main motivation for this is in attacking a site that uses Content Security Policy. With CSP enabled, an attacker with an XSS vulnerability cannot simply inject inline JavaScript, but they can still abuse some Rails features to steal a CSRF token.\u003c/p\u003e\n\n\u003cp\u003eIn the scenario where an attacker can inject arbitrary HTML into the response, the simplest attack would be to inject:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;a href=\u0026quot;https://attacker.com\u0026quot; data-remote data-method=\u0026quot;post\u0026quot; data-cross-domain=\u0026quot;false\u0026quot;\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eClicking on this link will trigger an OPTIONS request to attacker.com. If the attacker returns the correct CORS headers, a POST request containing the user\u0026#39;s CSRF token will be sent to attacker.com.\u003c/p\u003e\n\n\u003cp\u003eIn a second scenario, an attacker might be able to control only the href attribute of an anchor tag or the action attribute of a form tag that will trigger a data-remote action. This isn\u0026#39;t uncommon to see if the site is building anchor or form tags dynamically. In this case, the attacker can set the href or action to \u0026quot; \u003ca title=\"https://attacker.com\" href=\"/redirect?url=https%3A%2F%2Fattacker.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://attacker.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;. This will be passed to JQuery, who will see this as a same origin request.\u003c/p\u003e\n\n\u003cp\u003eThe JQuery behavior can be found here and a similar bug in Zepto can be found here. In both these cases, weak regexes don\u0026#39;t match the URL and the framework fails open into assuming that the URL is same origin. Prefixing the URL with a space character is one way to break this regex, but the regexes are pretty weak and there are probably other ways as well.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll contact the JQuery/Zepto folks about fixing their regexes, but there are a few thing that could improve this in jquery_ujs as well.\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t think a data attribute (data-cross-domain) should be able to force jquery_ujs to send the CSRF token.\u003cbr\u003e\nThe href attribute should be accessed directly here rather than calling attr(\u0026quot;href\u0026quot;). When called directly, the browser does a lot to clean up the URL and make sure that it is well formed. This would address the space prefix issue.\u003cbr\u003e\nSome stronger protections could be added before calling CSRFProtection here.\u003cbr\u003e\nFor links with data-method, but without data-remote, the origin isn\u0026#39;t even checked before adding a CSRF token to the form. This could even be exploited accidentally. Origin checking should be added here\u003c/p\u003e\n\n\u003cp\u003eI haven\u0026#39;t seen a bulletproof way for comparing origins yet, but I\u0026#39;ve got a few ideas if you want to discuss it more. Let me know what you think.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nBen Toews\u003cbr\u003e\nGitHub Security\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-16T19:20:31.802Z","allow_singular_disclosure_after":-172147728.58358115,"singular_disclosure_allowed":true,"vote_count":1,"voters":["cryptographer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":345288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since my initial report, I got a fix merged into JQuery and Zepto, though JQuery has yet to cut a release including the fix. ","markdown_message":"\u003cp\u003eSince my initial report, I got a fix merged into JQuery and Zepto, though JQuery has yet to cut a release including the fix. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-03T18:44:16.091Z","updated_at":"2015-03-03T18:44:16.091Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":345293,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-03T18:45:31.401Z","updated_at":"2015-03-03T18:45:31.401Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":345296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Including the patch here.","markdown_message":"\u003cp\u003eIncluding the patch here.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-03T18:46:04.196Z","updated_at":"2015-03-03T18:46:04.196Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":30805,"filename":"jquery_ujs.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/030/805/256527868602f786e7649b806f5273396fc969db/jquery_ujs.diff?response-content-disposition=attachment%3B%20filename%3D%22jquery_ujs.diff%22%3B%20filename%2A%3DUTF-8%27%27jquery_ujs.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=77c28696897ecbba492394069a3319aad04dbcf96635011da9699e45f9597002"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":345309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"At first glance the patch looks good.","markdown_message":"\u003cp\u003eAt first glance the patch looks good.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-03T18:57:08.137Z","updated_at":"2015-03-03T18:57:08.137Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":346074,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FYI: https://github.com/josh/rails-behaviors/pull/42","markdown_message":"\u003cp\u003eFYI: \u003ca title=\"https://github.com/josh/rails-behaviors/pull/42\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjosh%2Frails-behaviors%2Fpull%2F42\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/josh/rails-behaviors/pull/42\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-04T18:34:50.071Z","updated_at":"2015-03-04T18:34:50.071Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The safari bug was fixed in 8.0.4: https://support.apple.com/en-us/HT204560","markdown_message":"\u003cp\u003eThe safari bug was fixed in 8.0.4: \u003ca title=\"https://support.apple.com/en-us/HT204560\" href=\"/redirect?url=https%3A%2F%2Fsupport.apple.com%2Fen-us%2FHT204560\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.apple.com/en-us/HT204560\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-18T16:59:33.528Z","updated_at":"2015-03-18T16:59:33.528Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":361410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What do you think about this advisory. Can you think in a better way to work around this issue?","markdown_message":"\u003cp\u003eWhat do you think about this advisory. Can you think in a better way to work around this issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-24T02:54:09.382Z","updated_at":"2015-03-24T02:54:09.382Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":32760,"filename":"advisory.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/760/586dfeffcbd99d07ca1f876bee30797333357598/advisory.txt?response-content-disposition=attachment%3B%20filename%3D%22advisory.txt%22%3B%20filename%2A%3DUTF-8%27%27advisory.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=3cff3f83247cfc4366771b4b077e3be965189b4344f68c3df28a65ac49a1c9b0"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":361983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added an updated version of the patch.","markdown_message":"\u003cp\u003eAdded an updated version of the patch.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-24T17:38:00.330Z","updated_at":"2015-03-24T17:38:00.330Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":32810,"filename":"jquery_ujs.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/810/8d33238f616684436d92a299c3725291727c768d/jquery_ujs.diff?response-content-disposition=attachment%3B%20filename%3D%22jquery_ujs.diff%22%3B%20filename%2A%3DUTF-8%27%27jquery_ujs.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=a9e37a38bbffdcaf69fa13f73e4d81433218bcccc4a5cee034b2234179a525f5"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":363058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Final patches and advisory reviewed by @tenderlove.\n\nLet me know if you think we need to change something.","markdown_message":"\u003cp\u003eFinal patches and advisory reviewed by \u003ca href=\"/tenderlove\"\u003e@tenderlove\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you think we need to change something.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-25T20:42:25.703Z","updated_at":"2015-03-25T20:42:25.703Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":32914,"filename":"1-0-3-jquery_ujs_csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/914/a87193ac68a96d647a73c2a3ed3d261c532a86a1/1-0-3-jquery_ujs_csrf.patch?response-content-disposition=attachment%3B%20filename%3D%221-0-3-jquery_ujs_csrf.patch%22%3B%20filename%2A%3DUTF-8%27%271-0-3-jquery_ujs_csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=81596b204b56ec5a001dd24dc21745fd51b3907dec730cc24db4cf2571decf5e"},{"id":32915,"filename":"3-1-2-jquery-rails-csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/915/3f1462c3fdf6b00fe61e72f691329f894256e4d4/3-1-2-jquery-rails-csrf.patch?response-content-disposition=attachment%3B%20filename%3D%223-1-2-jquery-rails-csrf.patch%22%3B%20filename%2A%3DUTF-8%27%273-1-2-jquery-rails-csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=ccb51edb21f8001bbe8a9ef45014052ed15c23a8e42bee0e1dc28700392023a0"},{"id":32916,"filename":"advisory.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/916/94b9a4ae5d1847d2cc1d6b9143e06b11b2c7b5f7/advisory.txt?response-content-disposition=attachment%3B%20filename%3D%22advisory.txt%22%3B%20filename%2A%3DUTF-8%27%27advisory.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=cc8b858a6104342637314b65e3be990b93cfe1a0a8ccde2de37870f8230b517a"},{"id":32917,"filename":"4-0-3-jquery-rails-csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/917/dbd1ab0d69d7e660fc414c206ed576fdc619398c/4-0-3-jquery-rails-csrf.patch?response-content-disposition=attachment%3B%20filename%3D%224-0-3-jquery-rails-csrf.patch%22%3B%20filename%2A%3DUTF-8%27%274-0-3-jquery-rails-csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=d28c4b7f231ea32e021f3b2484aa77517a86d022ae07a2726f1621fd83bd6a49"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":363141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, I've been traveling this week. I'll check out the patches and advisory tomorrow.","markdown_message":"\u003cp\u003eSorry, I\u0026#39;ve been traveling this week. I\u0026#39;ll check out the patches and advisory tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-25T22:18:16.542Z","updated_at":"2015-03-25T22:18:16.542Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":363620,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The advisory looks good. It might be worth noting that this is also a CSP bypass for apps using CSP. A few comments about the patches:\n\n\nIt might be nice to add a comment explaining that this line is an IE workaround.\n\n```\nurlAnchor.href = urlAnchor.href;\n```\n\nThis would actually fail open if the browser failed to parse the URL:\n\n```\n        return urlAnchor.protocol \u0026\u0026 urlAnchor.host \u0026\u0026\n          (originAnchor.protocol + \"//\" + originAnchor.host !==\n            urlAnchor.protocol + \"//\" + urlAnchor.host);\n```\n\nIt should be:\n\n```\n        return !urlAnchor.protocol || !urlAnchor.host ||\n          (originAnchor.protocol + \"//\" + originAnchor.host !==\n            urlAnchor.protocol + \"//\" + urlAnchor.host);\n```\n\nOther than that, everything is looking good.","markdown_message":"\u003cp\u003eThe advisory looks good. It might be worth noting that this is also a CSP bypass for apps using CSP. A few comments about the patches:\u003c/p\u003e\n\n\u003cp\u003eIt might be nice to add a comment explaining that this line is an IE workaround.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eurlAnchor.href = urlAnchor.href;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis would actually fail open if the browser failed to parse the URL:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        return urlAnchor.protocol \u0026amp;\u0026amp; urlAnchor.host \u0026amp;\u0026amp;\n          (originAnchor.protocol + \u0026quot;//\u0026quot; + originAnchor.host !==\n            urlAnchor.protocol + \u0026quot;//\u0026quot; + urlAnchor.host);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt should be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        return !urlAnchor.protocol || !urlAnchor.host ||\n          (originAnchor.protocol + \u0026quot;//\u0026quot; + originAnchor.host !==\n            urlAnchor.protocol + \u0026quot;//\u0026quot; + urlAnchor.host);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOther than that, everything is looking good.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-26T14:52:09.519Z","updated_at":"2015-03-26T14:52:09.519Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":363739,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-26T17:02:30.442Z","updated_at":"2015-03-26T17:02:30.442Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":363763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You are right. The patches were wrong. Added a new version with the conditional fix and the comment about IE workaround.\n\nAlso update the advisory to talk about the CSP bypass.","markdown_message":"\u003cp\u003eYou are right. The patches were wrong. Added a new version with the conditional fix and the comment about IE workaround.\u003c/p\u003e\n\n\u003cp\u003eAlso update the advisory to talk about the CSP bypass.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-26T17:32:05.992Z","updated_at":"2015-03-26T17:32:05.992Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":32955,"filename":"3-1-2-jquery-rails-csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/955/1e702355ec42cf0c3fad6a55db0e0a93635555ac/3-1-2-jquery-rails-csrf.patch?response-content-disposition=attachment%3B%20filename%3D%223-1-2-jquery-rails-csrf.patch%22%3B%20filename%2A%3DUTF-8%27%273-1-2-jquery-rails-csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=2bbb07359953846fb0ad3a459b3bf51107b5cebc1759eb6afaf9bcf87dcee0e4"},{"id":32956,"filename":"1-0-3-jquery_ujs_csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/956/fc4021b3b814f02f2a3d72f20eadeba877f44ea4/1-0-3-jquery_ujs_csrf.patch?response-content-disposition=attachment%3B%20filename%3D%221-0-3-jquery_ujs_csrf.patch%22%3B%20filename%2A%3DUTF-8%27%271-0-3-jquery_ujs_csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=bb003924ed69468b4b8f274e946527a34636cbb23efa70a22793e8417bf45f38"},{"id":32957,"filename":"4-0-3-jquery-rails-csrf.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/957/6f13db9f10f51110de0af952128fb695a27d7587/4-0-3-jquery-rails-csrf.patch?response-content-disposition=attachment%3B%20filename%3D%224-0-3-jquery-rails-csrf.patch%22%3B%20filename%2A%3DUTF-8%27%274-0-3-jquery-rails-csrf.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=4398be53ca6e7db4295a4c2f2c4d6fdcf7920310a252ca3bbc05327063672e12"},{"id":32958,"filename":"advisory.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/958/58da95328b11734dc83d598e8ca58e22c5408e12/advisory.txt?response-content-disposition=attachment%3B%20filename%3D%22advisory.txt%22%3B%20filename%2A%3DUTF-8%27%27advisory.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060920Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=e85c84bb8fb6c679e61f8a0ad3e0117a9a46d9bb99de808b78afd6bc872376f0"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":363861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The updates look good. Thanks!","markdown_message":"\u003cp\u003eThe updates look good. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-26T18:40:24.668Z","updated_at":"2015-03-26T18:40:24.668Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474505,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:20:22.015Z","updated_at":"2015-06-16T19:20:22.015Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mastahyeti","url":"/mastahyeti"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":474506,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:20:31.562Z","updated_at":"2015-06-16T19:20:31.562Z","first_to_agree":true,"actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":474508,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:21:31.209Z","updated_at":"2015-06-16T19:21:31.209Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474509,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:21:31.481Z","updated_at":"2015-06-16T19:21:31.481Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":615252,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-09T06:55:00.874Z","updated_at":"2015-10-09T06:55:00.874Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"mastahyeti","url":"/mastahyeti"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":167,"category":"team","content":"CSRF Vulnerability in jquery-ujs and jquery-rails \n\nThere is an vulnerability in jquery-ujs and jquery-rails that can be used to \nbypass CSP protections and allows attackers to send CSRF tokens to attacker domains. \n\nThis vulnerability has been assigned the CVE identifier CVE-2015-1840. \n\nVersions Affected:  All. \nNot affected:       Applications which don't use jquery-ujs or jquery-rails. \nFixed Versions:     jquery-rails versions 4.0.4 and 3.1.3 and jquery-ujs 1.0.4. \n\nImpact \n------ \nIn the scenario where an attacker might be able to control the href attribute of an anchor tag or \nthe action attribute of a form tag that will trigger a POST action, the attacker can set the \nhref or action to \" https://attacker.com\" (note the leading space) that will be passed to JQuery, \nwho will see this as a same origin request, and send the user's CSRF token to the attacker domain. \n\nReleases \n-------- \nThe FIXED releases are available at the normal locations. \n\nWorkarounds \n----------- \nTo work around this problem, change code that allows users to control the href attribute of an anchor \ntag or the action attribute of a form tag to filter the user parameters. \n\nFor example, code like this: \n\n    link_to params \n\nto code like this: \n\n    link_to filtered_params \n\n    def filtered_params \n      # Filter just the parameters that you trust \n    end \n\nPatches \n------- \nTo aid users who aren't able to upgrade immediately we have provided patches for the \nsupported release series. They are in git-am format and consist of a single changeset. \n\n* 1-0-3-jquery_ujs_csrf.patch - Patch for jquery-ujs 1.0.3. \n* 3-1-2-jquery-rails-csrf.patch - Patch for jquery-rails 3.1.2. \n* 4-0-3-jquery-rails-csrf.patch - Patch for jquery-rails 4.0.3. \n\nCredits \n------- \n\nThanks to Ben Toews of GitHub for reporting the vulnerability to us, and working with us on a fix. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eCSRF Vulnerability in jquery-ujs and jquery-rails \u003c/p\u003e\n\n\u003cp\u003eThere is an vulnerability in jquery-ujs and jquery-rails that can be used to \u003cbr\u003e\nbypass CSP protections and allows attackers to send CSRF tokens to attacker domains. \u003c/p\u003e\n\n\u003cp\u003eThis vulnerability has been assigned the CVE identifier CVE-2015-1840. \u003c/p\u003e\n\n\u003cp\u003eVersions Affected:  All. \u003cbr\u003e\nNot affected:       Applications which don\u0026#39;t use jquery-ujs or jquery-rails. \u003cbr\u003e\nFixed Versions:     jquery-rails versions 4.0.4 and 3.1.3 and jquery-ujs 1.0.4. \u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact \u003c/h2\u003e\n\n\u003cp\u003eIn the scenario where an attacker might be able to control the href attribute of an anchor tag or \u003cbr\u003e\nthe action attribute of a form tag that will trigger a POST action, the attacker can set the \u003cbr\u003e\nhref or action to \u0026quot; \u003ca title=\"https://attacker.com\" href=\"/redirect?url=https%3A%2F%2Fattacker.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://attacker.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; (note the leading space) that will be passed to JQuery, \u003cbr\u003e\nwho will see this as a same origin request, and send the user\u0026#39;s CSRF token to the attacker domain. \u003c/p\u003e\n\n\u003ch2 id=\"releases\"\u003eReleases \u003c/h2\u003e\n\n\u003cp\u003eThe FIXED releases are available at the normal locations. \u003c/p\u003e\n\n\u003ch2 id=\"workarounds\"\u003eWorkarounds \u003c/h2\u003e\n\n\u003cp\u003eTo work around this problem, change code that allows users to control the href attribute of an anchor \u003cbr\u003e\ntag or the action attribute of a form tag to filter the user parameters. \u003c/p\u003e\n\n\u003cp\u003eFor example, code like this: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003elink_to params \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eto code like this: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003elink_to filtered_params \n\ndef filtered_params \n  # Filter just the parameters that you trust \nend \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patches\"\u003ePatches \u003c/h2\u003e\n\n\u003cp\u003eTo aid users who aren\u0026#39;t able to upgrade immediately we have provided patches for the \u003cbr\u003e\nsupported release series. They are in git-am format and consist of a single changeset. \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e1-0-3-jquery_ujs_csrf.patch - Patch for jquery-ujs 1.0.3. \u003c/li\u003e\n\u003cli\u003e3-1-2-jquery-rails-csrf.patch - Patch for jquery-rails 3.1.2. \u003c/li\u003e\n\u003cli\u003e4-0-3-jquery-rails-csrf.patch - Patch for jquery-rails 4.0.3. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"credits\"\u003eCredits \u003c/h2\u003e\n\n\u003cp\u003eThanks to Ben Toews of GitHub for reporting the vulnerability to us, and working with us on a fix. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}