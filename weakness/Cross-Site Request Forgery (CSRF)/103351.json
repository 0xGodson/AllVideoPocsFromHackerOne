{"id":103351,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDMzNTE=","url":"https://hackerone.com/reports/103351","title":"[CSRF] Install premium themes ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-04T01:13:24.382Z","submitted_at":"2015-12-04T01:13:24.382Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-27T18:52:19.703Z","bug_reporter_agreed_on_going_public_at":"2016-07-27T18:52:19.598Z","team_member_agreed_on_going_public_at":"2016-07-27T18:17:45.622Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found a CSRF issue in themes.shopify.com when installing premium themes.\n#Details:\nWhen going to a premium theme page for example: https://themes.shopify.com/themes/editions/styles/light/ there is a button saying `Preview in your store` , clicking that button sends a **POST** request to `https://themes.shopify.com/themes/editions/styles/light/demo` with an **authenticity token** to prevent CSRF , but going to the url `https://themes.shopify.com/themes/editions/styles/light/demo ` directly will get the theme installed without any validation for the authenticity token.\n#Steps to reproduce:\n1. Go to themes.myshopify.com then login with your store\n2. Go to https://themes.shopify.com/themes/editions/styles/light/demo and the theme `editions` will be installed in your shop\n3. To confirm go to `https://\u003cyour_store\u003e.myshopify.com/admin/themes` and you'll see the theme installed there.\n\nThanks","vulnerability_information_html":"\u003cp\u003eHi , I have found a CSRF issue in themes.shopify.com when installing premium themes.\u003c/p\u003e\n\n\u003ch1 id=\"details\"\u003eDetails:\u003c/h1\u003e\n\n\u003cp\u003eWhen going to a premium theme page for example: \u003ca title=\"https://themes.shopify.com/themes/editions/styles/light/\" href=\"/redirect?url=https%3A%2F%2Fthemes.shopify.com%2Fthemes%2Feditions%2Fstyles%2Flight%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://themes.shopify.com/themes/editions/styles/light/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e there is a button saying \u003ccode\u003ePreview in your store\u003c/code\u003e , clicking that button sends a \u003cstrong\u003ePOST\u003c/strong\u003e request to \u003ccode\u003ehttps://themes.shopify.com/themes/editions/styles/light/demo\u003c/code\u003e with an \u003cstrong\u003eauthenticity token\u003c/strong\u003e to prevent CSRF , but going to the url \u003ccode\u003ehttps://themes.shopify.com/themes/editions/styles/light/demo\u003c/code\u003e directly will get the theme installed without any validation for the authenticity token.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to themes.myshopify.com then login with your store\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://themes.shopify.com/themes/editions/styles/light/demo\" href=\"/redirect?url=https%3A%2F%2Fthemes.shopify.com%2Fthemes%2Feditions%2Fstyles%2Flight%2Fdemo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://themes.shopify.com/themes/editions/styles/light/demo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and the theme \u003ccode\u003eeditions\u003c/code\u003e will be installed in your shop\u003c/li\u003e\n\u003cli\u003eTo confirm go to \u003ccode\u003ehttps://\u0026lt;your_store\u0026gt;.myshopify.com/admin/themes\u003c/code\u003e and you\u0026#39;ll see the theme installed there.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["shailesh4594","mdv","flex0geek","sumit7","sysecure","spetr0x","clarckowen_","dyabla","loraa_loraa_kk","louislane"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":708010,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-12-04T01:13:24.619Z","updated_at":"2015-12-04T01:13:24.619Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":708848,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-04T18:37:44.287Z","updated_at":"2015-12-04T18:37:44.287Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":832142,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi , any updates regarding this report ? ","markdown_message":"\u003cp\u003eHi , any updates regarding this report ? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-09T23:31:49.831Z","updated_at":"2016-03-09T23:31:49.831Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not yet. We will contact you when we have an update on the issue. Thank you for your patience.","markdown_message":"\u003cp\u003eNot yet. We will contact you when we have an update on the issue. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-09T23:35:56.757Z","updated_at":"2016-03-09T23:35:56.757Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":881176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi , Sorry , but I wanted to ask a question about a bug I found in checkout.shopify.com, I have found a stored XSS in checkout.shopify.com which can be achieved by injecting the javascript through the attacker's store in the 404 page of the storefront and whenever the victim visits the `checkout.shopify.com` url, XSS will trigger.\nIs this valid ? \nThanks!","markdown_message":"\u003cp\u003eHi , Sorry , but I wanted to ask a question about a bug I found in checkout.shopify.com, I have found a stored XSS in checkout.shopify.com which can be achieved by injecting the javascript through the attacker\u0026#39;s store in the 404 page of the storefront and whenever the victim visits the \u003ccode\u003echeckout.shopify.com\u003c/code\u003e url, XSS will trigger.\u003cbr\u003e\nIs this valid ? \u003cbr\u003e\nThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T01:09:36.683Z","updated_at":"2016-04-01T01:09:36.683Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your question is unrelated to this issue. Please open a new issue if you have found something else.","markdown_message":"\u003cp\u003eYour question is unrelated to this issue. Please open a new issue if you have found something else.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T14:00:53.726Z","updated_at":"2016-04-01T14:00:53.726Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1089446,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your patience. We recently deployed a fix for this issue.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThank you for your patience. We recently deployed a fix for this issue.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-26T21:44:32.772Z","updated_at":"2016-07-26T21:44:32.772Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1091354,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-27T18:17:37.163Z","updated_at":"2016-07-27T18:17:37.163Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1091355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T18:17:45.669Z","updated_at":"2016-07-27T18:17:45.669Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1091441,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T18:52:19.626Z","updated_at":"2016-07-27T18:52:19.626Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091442,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T18:52:19.758Z","updated_at":"2016-07-27T18:52:19.758Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}