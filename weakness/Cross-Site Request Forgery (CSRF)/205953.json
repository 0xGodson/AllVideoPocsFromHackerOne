{"id":205953,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDU5NTM=","url":"https://hackerone.com/reports/205953","title":"CSRF - Adding unlimited number of saved items via GET request","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-02-13T12:05:55.609Z","submitted_at":"2017-02-13T12:05:55.609Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16334,"url":"https://hackerone.com/lyst","handle":"lyst","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Lyst","twitter_handle":"makinglyst","website":"https://www.lyst.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-28T07:23:06.764Z","bug_reporter_agreed_on_going_public_at":"2017-08-29T07:22:49.166Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, I have found a way of potentially adding thousands of items to the saved items list by using a GET request.\n\nPOC\n-----------\n```\nGET /email-capture/stock-alert/93543518/?return_url=/email-capture/stock-alert/91703404/?return_url=/email-capture/stock-alert/89201857/ HTTP/1.1\nHost: www.lyst.com\n```\n\nBy adding a stock alert notification to an item, the respective item is automatically added in the saved list and because this is a GET request, there is no CSRF token/protection here.\n\nIMPACT\n-------\nBecause this is done via GET request it is very easy to add thousands of products in the target user account by making one or both of these:\n1. Chain your internal redirect requests (shown in POC)\n2. Simply embed 1000x 1px image that with the target link (of course different product id per image)\n\nBecause of the extreme volume of the added items, the attacker can make the target's save list simply unusable (he must then delete 1000 entries and NO ONE will do that). I think a lot of people are taking advantage of the list, so a CSRF here can have a pretty big/annoying impact and you could loose clients.\n\nVideo POC attached.\n\n","vulnerability_information_html":"\u003cp\u003eHello, I have found a way of potentially adding thousands of items to the saved items list by using a GET request.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /email-capture/stock-alert/93543518/?return_url=/email-capture/stock-alert/91703404/?return_url=/email-capture/stock-alert/89201857/ HTTP/1.1\nHost: www.lyst.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBy adding a stock alert notification to an item, the respective item is automatically added in the saved list and because this is a GET request, there is no CSRF token/protection here.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eIMPACT\u003c/h2\u003e\n\n\u003cp\u003eBecause this is done via GET request it is very easy to add thousands of products in the target user account by making one or both of these:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eChain your internal redirect requests (shown in POC)\u003c/li\u003e\n\u003cli\u003eSimply embed 1000x 1px image that with the target link (of course different product id per image)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eBecause of the extreme volume of the added items, the attacker can make the target\u0026#39;s save list simply unusable (he must then delete 1000 entries and NO ONE will do that). I think a lot of people are taking advantage of the list, so a CSRF here can have a pretty big/annoying impact and you could loose clients.\u003c/p\u003e\n\n\u003cp\u003eVideo POC attached.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-28T07:22:49.215Z","allow_singular_disclosure_after":-102634343.7543197,"singular_disclosure_allowed":true,"vote_count":14,"voters":["jensec","bugdiscloseguys","samet","vijay_kumar","eveeez","r3y","khizer47","mr_r3boot","t-4-y-m","justas_b","and 4 more..."],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1487233,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-15T15:17:20.498Z","updated_at":"2017-02-15T15:17:20.498Z","actor":{"username":"alexs","cleared":false,"url":"/alexs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1524159,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-07T12:36:16.763Z","updated_at":"2017-03-07T12:36:16.763Z","actor":{"url":"/lyst","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Lyst"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"lyst","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1574906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexs @lyst \n\nI see that this has been fixed. Can you mark this as resolved ?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/alexs\"\u003e@alexs\u003c/a\u003e \u003ca href=\"/lyst\"\u003e@lyst\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI see that this has been fixed. Can you mark this as resolved ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-31T11:08:10.407Z","updated_at":"2017-03-31T11:08:10.407Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1637315,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@iserko : I see that @alexs has been removed. \n\nI see that this has been fixed. Can you mark this as resolved please ?","markdown_message":"\u003cp\u003e\u003ca href=\"/iserko\"\u003e@iserko\u003c/a\u003e : I see that \u003ca href=\"/alexs\"\u003e@alexs\u003c/a\u003e has been removed. \u003c/p\u003e\n\n\u003cp\u003eI see that this has been fixed. Can you mark this as resolved please ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-26T12:33:51.550Z","updated_at":"2017-04-26T12:34:06.613Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1679354,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@inhibitor181 sorry for the delay in closing the issue. Thanks for the help!","markdown_message":"\u003cp\u003e\u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e sorry for the delay in closing the issue. Thanks for the help!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-17T06:45:08.809Z","updated_at":"2017-05-17T06:45:08.809Z","actor":{"username":"iserko","cleared":false,"url":"/iserko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/036/39b2ca36595f9cb4a40f97505dd4ab14e123d80a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1962214,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-29T07:22:49.186Z","updated_at":"2017-08-29T07:22:49.186Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029280,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T07:23:06.785Z","updated_at":"2017-09-28T07:23:06.785Z","actor":{"url":"/lyst","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Lyst"}},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}