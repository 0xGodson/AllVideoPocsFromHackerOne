{"id":1007988,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA3OTg4","url":"https://hackerone.com/reports/1007988","title":"Able to comment/view in others support ticket at https://en.instagram-brand.com/requests/dashboard","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-10-14T02:33:28.392Z","submitted_at":"2020-10-14T02:33:28.614Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ajay_saycure","url":"/ajay_saycure","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-05T13:21:03.579Z","bug_reporter_agreed_on_going_public_at":"2020-11-05T13:20:51.554Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nI reported the vulnerability to Facebook, and they have said to report it here for the bounty. \n\n## Platform(s) Affected:\n https://en.instagram-brand.com/requests/dashboard\n## Steps To Reproduce:\n1. Create two account User A, User B at https://en.instagram-brand.com/\n2. Apply for Instagram brand from https://en.instagram-brand.com/requests/dashboard by User A\n3. Login to user B and intercept the request\n\n4.Send a post request with cookie and other header got by intercepting user B in the below endpoint and replace comment 44799 with User A support ticket id \nPOST /wp-json/brc/v1/approval-requests/44799/comments HTTP/1.1\ntext=sure thanks\u0026files=1597287925578-44741-%3Etest.jpg\u0026sizes=4249\n\n## Supporting Material/References:\n\nvideo POC - https://drive.google.com/file/d/1My6MQuQTmYwCWQw_7uw1veGFkn13WkDP/view?usp=sharing\nscreenshot of viewing other's messages - https://drive.google.com/file/d/1WnDGPDHGA6pP9RIPBQpEAIXxPTaFJZVX/view?usp=sharing\u0026fbclid=IwAR3k4cEfCcUcfBKhlffQgjDcy4ASRf7V3fsS7FmZcHyyd_HZZfFk1OlDpf8\n\n## Impact\n\n1) can comment in other's support ticket\n2) can view other's support ticket comments (Both Instagram as well as user's)","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eI reported the vulnerability to Facebook, and they have said to report it here for the bounty. \u003c/p\u003e\n\n\u003ch2 id=\"platform-s-affected\"\u003ePlatform(s) Affected:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://en.instagram-brand.com/requests/dashboard\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Frequests%2Fdashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/requests/dashboard\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate two account User A, User B at \u003ca title=\"https://en.instagram-brand.com/\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eApply for Instagram brand from \u003ca title=\"https://en.instagram-brand.com/requests/dashboard\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Frequests%2Fdashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/requests/dashboard\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e by User A\u003c/li\u003e\n\u003cli\u003eLogin to user B and intercept the request\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e4.Send a post request with cookie and other header got by intercepting user B in the below endpoint and replace comment 44799 with User A support ticket id \u003cbr\u003e\nPOST /wp-json/brc/v1/approval-requests/44799/comments HTTP/1.1\u003cbr\u003e\ntext=sure thanks\u0026amp;files=1597287925578-44741-%3Etest.jpg\u0026amp;sizes=4249\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003evideo POC - \u003ca title=\"https://drive.google.com/file/d/1My6MQuQTmYwCWQw_7uw1veGFkn13WkDP/view?usp=sharing\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F1My6MQuQTmYwCWQw_7uw1veGFkn13WkDP%2Fview%3Fusp%3Dsharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/1My6MQuQTmYwCWQw_7uw1veGFkn13WkDP/view?usp=sharing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nscreenshot of viewing other\u0026#39;s messages - \u003ca title=\"https://drive.google.com/file/d/1WnDGPDHGA6pP9RIPBQpEAIXxPTaFJZVX/view?usp=sharing\u0026amp;fbclid=IwAR3k4cEfCcUcfBKhlffQgjDcy4ASRf7V3fsS7FmZcHyyd_HZZfFk1OlDpf8\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F1WnDGPDHGA6pP9RIPBQpEAIXxPTaFJZVX%2Fview%3Fusp%3Dsharing%26fbclid%3DIwAR3k4cEfCcUcfBKhlffQgjDcy4ASRf7V3fsS7FmZcHyyd_HZZfFk1OlDpf8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/1WnDGPDHGA6pP9RIPBQpEAIXxPTaFJZVX/view?usp=sharing\u0026amp;fbclid=IwAR3k4cEfCcUcfBKhlffQgjDcy4ASRf7V3fsS7FmZcHyyd_HZZfFk1OlDpf8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e1) can comment in other\u0026#39;s support ticket\u003cbr\u003e\n2) can view other\u0026#39;s support ticket comments (Both Instagram as well as user\u0026#39;s)\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-05T13:20:51.690Z","allow_singular_disclosure_after":-2040626.89671827,"singular_disclosure_allowed":true,"vote_count":33,"voters":["sw33tlie","kapkan","th4nu_0x0","prophet","youngsheldon","mygf","powerjacobb1","rudra_2000","exploit_db","f_m","and 23 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":42403,"asset_type":"URL","asset_identifier":"www.tumblr.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9516671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. Your report will be reviewed and we'll get back to you shortly.","markdown_message":"\u003cp\u003eThank you for your submission. Your report will be reviewed and we\u0026#39;ll get back to you shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-14T06:50:35.372Z","updated_at":"2020-10-14T06:50:35.372Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9526863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thanks for the information","markdown_message":"\u003cp\u003eSure thanks for the information\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T04:23:15.380Z","updated_at":"2020-10-15T04:23:15.380Z","actor":{"username":"ajay_saycure","cleared":false,"url":"/ajay_saycure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9585342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @ajay_saycure , I've tried to reproduce what you've shared with a test account but have been unsuccessful so far. \n\nIs there a chance you can submit a more detailed video with burpsuite showing all requests so I can better reproduce. In the video it's not clear how the requests work.\n\nThanks,\nPaul","markdown_message":"\u003cp\u003ehi \u003ca href=\"/ajay_saycure\"\u003e@ajay_saycure\u003c/a\u003e , I\u0026#39;ve tried to reproduce what you\u0026#39;ve shared with a test account but have been unsuccessful so far. \u003c/p\u003e\n\n\u003cp\u003eIs there a chance you can submit a more detailed video with burpsuite showing all requests so I can better reproduce. In the video it\u0026#39;s not clear how the requests work.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nPaul\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-21T08:01:16.424Z","updated_at":"2020-10-21T08:01:16.424Z","actor":{"username":"pkevan","cleared":false,"url":"/pkevan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9599465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi pkevan\n\nThis issue has already been resolved. Facebook security team reported it to the atomattic and now its resolved. I am here for the bounty","markdown_message":"\u003cp\u003eHi pkevan\u003c/p\u003e\n\n\u003cp\u003eThis issue has already been resolved. Facebook security team reported it to the atomattic and now its resolved. I am here for the bounty\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-22T05:33:43.744Z","updated_at":"2020-10-22T05:33:43.744Z","actor":{"username":"ajay_saycure","cleared":false,"url":"/ajay_saycure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9600070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nDo you have details as to when it was resolved so I can see if this was previously reported? ","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eDo you have details as to when it was resolved so I can see if this was previously reported? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-22T07:34:40.461Z","updated_at":"2020-10-22T07:34:40.461Z","actor":{"username":"pkevan","cleared":false,"url":"/pkevan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9601209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reported - Aug 13, 2020\nTriaged - september 2\nFixed - October 14, 2020","markdown_message":"\u003cp\u003eReported - Aug 13, 2020\u003cbr\u003e\nTriaged - september 2\u003cbr\u003e\nFixed - October 14, 2020\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-22T09:42:33.718Z","updated_at":"2020-10-22T09:42:33.718Z","actor":{"username":"ajay_saycure","cleared":false,"url":"/ajay_saycure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9710459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update here","markdown_message":"\u003cp\u003eAny update here\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-03T07:38:59.627Z","updated_at":"2020-11-03T07:38:59.627Z","actor":{"username":"ajay_saycure","cleared":false,"url":"/ajay_saycure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9731606,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi. Sorry for the delayed response. In the future, can you please report directly here or mention that you already contacted someone else. It will save everyone's time :)","markdown_message":"\u003cp\u003eHi. Sorry for the delayed response. In the future, can you please report directly here or mention that you already contacted someone else. It will save everyone\u0026#39;s time :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T10:26:44.342Z","updated_at":"2020-11-05T10:26:44.342Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ajay_saycure","url":"/ajay_saycure"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9731613,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-05T10:27:10.633Z","updated_at":"2020-11-05T10:27:10.633Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"ajay_saycure","url":"/ajay_saycure"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9732841,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks xknown. Sure will do ","markdown_message":"\u003cp\u003eThanks xknown. Sure will do \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T13:20:51.594Z","updated_at":"2020-11-05T13:20:51.594Z","first_to_agree":true,"actor":{"username":"ajay_saycure","cleared":false,"url":"/ajay_saycure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/170/484/0ede37e97b74083ad134881ca2dd3b4611f7cdaa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10013212,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-05T13:21:03.606Z","updated_at":"2020-12-05T13:21:03.606Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}