{"id":200487,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA0ODc=","url":"https://hackerone.com/reports/200487","title":"Incomplete HTML sanitization + Session id leaking + private information disclosure","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-23T09:23:04.061Z","submitted_at":"2017-01-23T09:23:04.061Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-27T05:56:18.020Z","bug_reporter_agreed_on_going_public_at":"2017-08-28T05:56:15.945Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI have found a chain of events that lead to session id leaking, witch can be then used to gather private data about other added inboxes to account / login id and some other infos. Unfortunatelly (for me) I wasn't able to make a hostile account takeover because of you session id + cookie linkage.\n\nSo, these are the problems :\n1. Incomplete sanitization in attachements :\n\n```\nli {list-style-image: url(\"https://www.google.com/\");}\n```\n\n is not sanitized and google.com is called\n2. The referer is passed when calling google.com\n3. If the attachement is put in task, calendar or profile, the session id is passed in the url when the attachement is opened in browser. Thus, the session id is in the referer and leaked\n4. The link \n\n```\nhttps://sandbox.open-xchange.com/appsuite/api/login?action=rampup\u0026rampup=true\u0026rampupFor=open-xchange-appsuite\u0026session=SESSION_ID_HERE\n```\n\ncan be called by not logged in users and reveals some sensitive data like : userid for login, uid (don't actually know the impact for this), various other data and most importantly, __private email accounts and their directories__\n\nBecause the video is too big (30-40Mb), I have attached it in my google drive :\n\n█████\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI have found a chain of events that lead to session id leaking, witch can be then used to gather private data about other added inboxes to account / login id and some other infos. Unfortunatelly (for me) I wasn\u0026#39;t able to make a hostile account takeover because of you session id + cookie linkage.\u003c/p\u003e\n\n\u003cp\u003eSo, these are the problems :\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIncomplete sanitization in attachements :\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eli {list-style-image: url(\u0026quot;https://www.google.com/\u0026quot;);}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eis not sanitized and google.com is called\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe referer is passed when calling google.com\u003c/li\u003e\n\u003cli\u003eIf the attachement is put in task, calendar or profile, the session id is passed in the url when the attachement is opened in browser. Thus, the session id is in the referer and leaked\u003c/li\u003e\n\u003cli\u003eThe link \u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://sandbox.open-xchange.com/appsuite/api/login?action=rampup\u0026amp;rampup=true\u0026amp;rampupFor=open-xchange-appsuite\u0026amp;session=SESSION_ID_HERE\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ecan be called by not logged in users and reveals some sensitive data like : userid for login, uid (don\u0026#39;t actually know the impact for this), various other data and most importantly, \u003cstrong\u003eprivate email accounts and their directories\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eBecause the video is too big (30-40Mb), I have attached it in my google drive :\u003c/p\u003e\n\n\u003cp\u003e█████\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-27T05:56:16.005Z","allow_singular_disclosure_after":-102725813.99984913,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","r3y","indoappsec","luckydivino","t-4-y-m","sumit7","spetr0x","yongjin"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1437796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, indeed there is no way to take over a session by knowing the \"sessionid\" without replicating/stealing cookies, user-agent, geolocation and other parameters. We're looking into the situation about missing sanitization with regards to privacy however.","markdown_message":"\u003cp\u003eThanks for the report, indeed there is no way to take over a session by knowing the \u0026quot;sessionid\u0026quot; without replicating/stealing cookies, user-agent, geolocation and other parameters. We\u0026#39;re looking into the situation about missing sanitization with regards to privacy however.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T09:38:19.558Z","updated_at":"2017-01-23T09:38:19.558Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437822,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We did some checks with E-Mail, and this can also be used to bypass the \"do not load external images\" privacy protection.","markdown_message":"\u003cp\u003eWe did some checks with E-Mail, and this can also be used to bypass the \u0026quot;do not load external images\u0026quot; privacy protection.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T09:59:37.276Z","updated_at":"2017-01-23T09:59:37.276Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mheiland : Thanks for the updates, really appreciate it ! ","markdown_message":"\u003cp\u003e\u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e : Thanks for the updates, really appreciate it ! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T10:02:11.518Z","updated_at":"2017-01-23T10:02:11.518Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467940,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved to award reputation, note that we're delivering and deploying the fix for this issue independently from HackerOne.","markdown_message":"\u003cp\u003eClosing as resolved to award reputation, note that we\u0026#39;re delivering and deploying the fix for this issue independently from HackerOne.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T09:27:13.065Z","updated_at":"2017-02-07T09:27:13.065Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467941,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T09:27:22.136Z","updated_at":"2017-02-07T09:27:22.136Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1948035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland . I would like to start disclosing some bugs. Would you mind redacting the link from google drive with the video ?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e . I would like to start disclosing some bugs. Would you mind redacting the link from google drive with the video ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T05:35:28.374Z","updated_at":"2017-08-23T05:35:28.374Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1948248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, disclosing this bug is fine, we patched it back in February already.","markdown_message":"\u003cp\u003eHi, disclosing this bug is fine, we patched it back in February already.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-23T08:24:37.017Z","updated_at":"2017-08-23T08:24:37.017Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1958924,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T05:56:15.967Z","updated_at":"2017-08-28T05:56:15.967Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2026526,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-27T05:56:18.045Z","updated_at":"2017-09-27T05:56:18.045Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4916998,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:19:08.666Z","updated_at":"2019-05-24T12:19:08.666Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":401098},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}