{"id":13557,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzU1Nw==","url":"https://hackerone.com/reports/13557","title":"Leaking of password reset token through referer","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-05-27T08:10:06.992Z","submitted_at":"2014-05-27T08:10:06.992Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"robin","url":"/robin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/962/912899e3bae0502ed37490fec9f7eaf0e606284c_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3,"url":"https://hackerone.com/factlink","handle":"factlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Factlink","twitter_handle":"factlink","website":"https://factlink.com","about":"Share your knowledge with the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-08T10:00:32.004Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-06-04T12:22:38.157Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When we request a password reset link, after that before Writing a new password, Going to an External link would cause Referer leakage...\r\n\r\nRemote Address:74.125.68.95:443\r\nRequest URL:https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700\r\nRequest Method:GET\r\nStatus Code:200 OK\r\nRequest Headers\r\n:host:fonts.googleapis.com\r\n:method:GET\r\n:path:/css?family=Open+Sans:400italic,700italic,400,700\r\n:scheme:https\r\n:version:HTTP/1.1\r\naccept:text/css,*/*;q=0.1\r\naccept-encoding:gzip,deflate,sdch\r\naccept-language:en-US,en;q=0.8\r\ncache-control:max-age=0\r\nreferer:https://factlink-staging.herokuapp.com/users/password/edit?reset_password_token=8GbCsdRTX3yx3wZzwPuy\r\nuser-agent:Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36\r\nQuery String Parametersview sourceview URL encoded\r\nfamily:Open Sans:400italic,700italic,400,700\r\nResponse Headers\r\nalternate-protocol:443:quic\r\ncache-control:private, max-age=86400\r\ncontent-encoding:gzip\r\ncontent-length:387\r\ncontent-type:text/css\r\ndate:Tue, 27 May 2014 08:08:05 GMT\r\nexpires:Tue, 27 May 2014 08:08:05 GMT\r\nserver:GSE\r\nstatus:200 OK\r\ntiming-allow-origin:*\r\nversion:HTTP/1.1\r\nx-content-type-options:nosniff\r\nx-frame-options:SAMEORIGIN\r\nx-xss-protection:1; mode=block","vulnerability_information_html":"\u003cp\u003eWhen we request a password reset link, after that before Writing a new password, Going to an External link would cause Referer leakage...\u003c/p\u003e\n\n\u003cp\u003eRemote Address:74.125.68.95:443\u003cbr\u003e\nRequest URL:\u003ca title=\"https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700\" href=\"/redirect?url=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DOpen%2BSans%3A400italic%2C700italic%2C400%2C700\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nRequest Method:GET\u003cbr\u003e\nStatus Code:200 OK\u003cbr\u003e\nRequest Headers\u003cbr\u003e\n:host:fonts.googleapis.com\u003cbr\u003e\n:method:GET\u003cbr\u003e\n:path:/css?family=Open+Sans:400italic,700italic,400,700\u003cbr\u003e\n:scheme:https\u003cbr\u003e\n:version:HTTP/1.1\u003cbr\u003e\naccept:text/css,\u003cem\u003e/\u003c/em\u003e;q=0.1\u003cbr\u003e\naccept-encoding:gzip,deflate,sdch\u003cbr\u003e\naccept-language:en-US,en;q=0.8\u003cbr\u003e\ncache-control:max-age=0\u003cbr\u003e\nreferer:\u003ca title=\"https://factlink-staging.herokuapp.com/users/password/edit?reset_password_token=8GbCsdRTX3yx3wZzwPuy\" href=\"/redirect?url=https%3A%2F%2Ffactlink-staging.herokuapp.com%2Fusers%2Fpassword%2Fedit%3Freset_password_token%3D8GbCsdRTX3yx3wZzwPuy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://factlink-staging.herokuapp.com/users/password/edit?reset_password_token=8GbCsdRTX3yx3wZzwPuy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nuser-agent:Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36\u003cbr\u003e\nQuery String Parametersview sourceview URL encoded\u003cbr\u003e\nfamily:Open Sans:400italic,700italic,400,700\u003cbr\u003e\nResponse Headers\u003cbr\u003e\nalternate-protocol:443:quic\u003cbr\u003e\ncache-control:private, max-age=86400\u003cbr\u003e\ncontent-encoding:gzip\u003cbr\u003e\ncontent-length:387\u003cbr\u003e\ncontent-type:text/css\u003cbr\u003e\ndate:Tue, 27 May 2014 08:08:05 GMT\u003cbr\u003e\nexpires:Tue, 27 May 2014 08:08:05 GMT\u003cbr\u003e\nserver:GSE\u003cbr\u003e\nstatus:200 OK\u003cbr\u003e\ntiming-allow-origin:*\u003cbr\u003e\nversion:HTTP/1.1\u003cbr\u003e\nx-content-type-options:nosniff\u003cbr\u003e\nx-frame-options:SAMEORIGIN\u003cbr\u003e\nx-xss-protection:1; mode=block\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-04T12:22:30.711Z","allow_singular_disclosure_after":-204739417.34005138,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":58243,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting! It's a nice find. We cannot easily not include the token in the URL, we could remove all extarnal links from this page. Would you agree that that would mitigate this attack?","markdown_message":"\u003cp\u003eThanks for reporting! It\u0026#39;s a nice find. We cannot easily not include the token in the URL, we could remove all extarnal links from this page. Would you agree that that would mitigate this attack?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T11:45:26.429Z","updated_at":"2014-05-27T11:45:26.429Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":58276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep!","markdown_message":"\u003cp\u003eYep!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T12:19:58.373Z","updated_at":"2014-05-27T12:19:58.373Z","actor":{"username":"robin","cleared":false,"url":"/robin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/962/912899e3bae0502ed37490fec9f7eaf0e606284c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":66287,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We investigated this issue, but found no way around it. There's no easy way not to send along the referrer. However, since the parties we are sending it to are Google, Twitter and Facebook, we feel that this is an acceptable risk. We therefore decided not to fix this.","markdown_message":"\u003cp\u003eWe investigated this issue, but found no way around it. There\u0026#39;s no easy way not to send along the referrer. However, since the parties we are sending it to are Google, Twitter and Facebook, we feel that this is an acceptable risk. We therefore decided not to fix this.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-04T12:22:30.741Z","updated_at":"2014-06-04T12:22:30.741Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":66288,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T12:22:38.178Z","updated_at":"2014-06-04T12:22:38.178Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":85923,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-08T10:00:32.014Z","updated_at":"2014-07-08T10:00:32.014Z","actor":{"url":"/factlink","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Factlink"}},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}