{"id":29835,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTgzNQ==","url":"https://hackerone.com/reports/29835","title":"Profile Pic padding (Length-hiding) fails due to use of GZIP","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-03T16:49:18.808Z","submitted_at":"2014-10-03T16:49:18.808Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ericlaw","url":"/ericlaw","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-18T17:41:26.481Z","bug_reporter_agreed_on_going_public_at":"2016-03-17T19:35:04.406Z","team_member_agreed_on_going_public_at":"2016-03-18T17:41:26.287Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Back in August, I noted that Twitter was appending anywhere from dozens to thousands of junk (0x20) bytes on the end of the JPEG and PNG files they serve for users’ profile images. It was suggested that, though invalid, they were doing this deliberately, as an information-hiding mechanism. \r\n\r\nThe HTTPS protocol encrypts all of the data transferred over it, but it doesn’t hide the length of that data. Because Twitter profile pictures can appear in predictable patterns on 3rd-party pages, an otherwise “blind” network attacker could infer what pages a user was visiting based on the length of responses from Twitter’s image server. So, Twitter selected a number of common byte length thresholds and they pad images to those sizes. So, for instance, a 10174 byte image is padded with 6124 bytes of data to yield a 16298 byte response, while a 11502 byte response is padded with 4796 bytes to yield a matching 16298 byte response. Fiddler now detects this padded at the end of PNG files and surfaces it:\r\n\r\nUnfortunately it seems that Twitter's Performance team wasn't aware that this padding was intentional and they mistakenly enabled GZIP compression for these images. That change improves performance, but circumvents the length-blinding padding effort.\r\n","vulnerability_information_html":"\u003cp\u003eBack in August, I noted that Twitter was appending anywhere from dozens to thousands of junk (0x20) bytes on the end of the JPEG and PNG files they serve for users’ profile images. It was suggested that, though invalid, they were doing this deliberately, as an information-hiding mechanism. \u003c/p\u003e\n\n\u003cp\u003eThe HTTPS protocol encrypts all of the data transferred over it, but it doesn’t hide the length of that data. Because Twitter profile pictures can appear in predictable patterns on 3rd-party pages, an otherwise “blind” network attacker could infer what pages a user was visiting based on the length of responses from Twitter’s image server. So, Twitter selected a number of common byte length thresholds and they pad images to those sizes. So, for instance, a 10174 byte image is padded with 6124 bytes of data to yield a 16298 byte response, while a 11502 byte response is padded with 4796 bytes to yield a matching 16298 byte response. Fiddler now detects this padded at the end of PNG files and surfaces it:\u003c/p\u003e\n\n\u003cp\u003eUnfortunately it seems that Twitter\u0026#39;s Performance team wasn\u0026#39;t aware that this padding was intentional and they mistakenly enabled GZIP compression for these images. That change improves performance, but circumvents the length-blinding padding effort.\u003c/p\u003e\n","bounty_amount":"280.0","formatted_bounty":"$280","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-16T19:35:04.601Z","allow_singular_disclosure_after":-148384370.28939483,"singular_disclosure_allowed":true,"vote_count":6,"voters":["sw33tlie","xiaoyinl","jackb898","exception","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":135930,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-03T20:27:19.160Z","updated_at":"2014-10-03T20:27:19.160Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":145986,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-20T22:52:19.127Z","updated_at":"2014-10-20T22:52:19.127Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"280.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"ericlaw","url":"/ericlaw"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":146921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This doesn't qualify for a bounty. As I mentioned, I wasn't aware that this padding was intended to be a security mechanism, and only found out via Twitter (hence, public disclosure).\n\nThanks for addressing though.","markdown_message":"\u003cp\u003eThis doesn\u0026#39;t qualify for a bounty. As I mentioned, I wasn\u0026#39;t aware that this padding was intended to be a security mechanism, and only found out via Twitter (hence, public disclosure).\u003c/p\u003e\n\n\u003cp\u003eThanks for addressing though.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-22T18:50:43.396Z","updated_at":"2014-10-22T18:50:43.396Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":147044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Eric,\n\nThanks for your note.  We are happy to let you donate the bounty to charity, which HackerOne is already set up to allow you to do.  Let me know if this doesn't work for you.","markdown_message":"\u003cp\u003eHi Eric,\u003c/p\u003e\n\n\u003cp\u003eThanks for your note.  We are happy to let you donate the bounty to charity, which HackerOne is already set up to allow you to do.  Let me know if this doesn\u0026#39;t work for you.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-22T22:49:01.048Z","updated_at":"2014-10-22T22:49:01.048Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":147056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure if Twitter wants to award a bounty anyway, let's send it to charity. ","markdown_message":"\u003cp\u003eSure if Twitter wants to award a bounty anyway, let\u0026#39;s send it to charity. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-23T00:34:40.999Z","updated_at":"2014-10-23T00:34:40.999Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":178795,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-15T19:55:25.480Z","updated_at":"2014-12-15T19:55:25.480Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ericlaw","url":"/ericlaw"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":179448,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looking at the traffic, I no longer see GZIP compression being used on MOST of the images from pbs.twimg.com, although there are some rare exceptions (e.g. https://pbs.twimg.com/profile_images/1157921186/images_bigger.jpg appears to be GZIP compressed from 16298 bytes to 2227 bytes; maybe the \"_bigger\" images only appear in a first party context or something). \n\nBecause the details of Twitter's padding scheme are not public (as far as I know), it's hard to say whether or not it is working correctly otherwise. It appears that a significant number of the profile images are not padded with trailing nulls; whether this is intentional or not I cannot say.\n\n","markdown_message":"\u003cp\u003eLooking at the traffic, I no longer see GZIP compression being used on MOST of the images from pbs.twimg.com, although there are some rare exceptions (e.g. \u003ca title=\"https://pbs.twimg.com/profile_images/1157921186/images_bigger.jpg\" href=\"/redirect?url=https%3A%2F%2Fpbs.twimg.com%2Fprofile_images%2F1157921186%2Fimages_bigger.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pbs.twimg.com/profile_images/1157921186/images_bigger.jpg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e appears to be GZIP compressed from 16298 bytes to 2227 bytes; maybe the \u0026quot;_bigger\u0026quot; images only appear in a first party context or something). \u003c/p\u003e\n\n\u003cp\u003eBecause the details of Twitter\u0026#39;s padding scheme are not public (as far as I know), it\u0026#39;s hard to say whether or not it is working correctly otherwise. It appears that a significant number of the profile images are not padded with trailing nulls; whether this is intentional or not I cannot say.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-16T18:16:03.876Z","updated_at":"2014-12-16T18:16:03.876Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":495371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you have any objections to making this public? (Apparently there's no button to request this in Twitter's version of the HackerOne UI). Thanks!","markdown_message":"\u003cp\u003eDo you have any objections to making this public? (Apparently there\u0026#39;s no button to request this in Twitter\u0026#39;s version of the HackerOne UI). Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-29T16:27:13.228Z","updated_at":"2015-06-29T16:27:13.228Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":846693,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-17T19:35:04.438Z","updated_at":"2016-03-17T19:35:04.438Z","first_to_agree":true,"actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":848923,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-18T17:41:26.320Z","updated_at":"2016-03-18T17:41:26.320Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":848924,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-18T17:41:26.504Z","updated_at":"2016-03-18T17:41:26.504Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}