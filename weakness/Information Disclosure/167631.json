{"id":167631,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjc2MzE=","url":"https://hackerone.com/reports/167631","title":"Host header poisoning leads to account password reset links hijacking","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2016-09-11T20:05:24.016Z","submitted_at":"2016-09-11T20:05:24.016Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yassineaboukir","url":"/yassineaboukir","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1453,"url":"https://hackerone.com/boozt","handle":"boozt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Boozt Fashion AB","twitter_handle":"","website":"http://www.boozt.com","about":"E-Commerce shop"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-17T19:19:13.007Z","bug_reporter_agreed_on_going_public_at":"2016-09-16T08:55:32.238Z","team_member_agreed_on_going_public_at":"2016-09-17T19:19:12.867Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n**Issue Summary :**\nWhile conducting my regular testing I discovered that the mobile version of boozt.com application relies on the host header when constructing password reset links emailed to the user. Thus, an attacker can inject a arbitrary host header which leads to password reset leakage.\n\n**Impact :** The attacker will receive the leaked user password reset link and, as a consequence, take over user's account.\n\n**Proof Of Concept :**\n1. Browse to https://m.boozt.com/eu/en/customer/forgot_password\n2. Enter the victim's address mail (Easily enumerated abusing #165894).\n3. Click to reset the password.\n4. Intercept the HTTP request and tamper the host header to a domain name controlled by the atatcker as you can see below :\n\n{F119118}\n\nOtherwise, you can simply use the following CURL command to reproduce the request after replacing `\u003cTOKEN\u003e` and `\u003cSESSION\u003e` with a valid values:\n\n```\ncurl -i -s -k  -X 'POST' \\\n    -H 'Host: yassineaboukir.com' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:48.0) Gecko/20100101 Firefox/48.0' -H 'DNT: 1' -H 'Referer: https://m.boozt.com/eu/en/customer/forgot_password' -H 'cookie: \u003cSESSION\u003e;' -H 'Upgrade-Insecure-Requests: 1' -H 'Content-Type: application/x-www-form-urlencoded' \\\n    --data-binary $'forgot_password%5Bemail%5D=yaaboukir@gmail.com\u0026forgot_password%5B_token%5D=\u003cTOKEN\u003e' \\\n    'https://m.boozt.com/eu/en/customer/forgot_password'\n```\n\nNow, the victim will receive a password reset e-mail with a poisoned link as you can see below :\n\n{F119124}\n\nOnce the user clicks on it, he/she will be taken to :\n\n\u003ehttps://yassineaboukir.com/eu/en/customer/reset_password/c2eca9c2b4160c94c884faa529e7ae4c\n\nThe token is now leaked and the attacker now can simply go to the server logs and browse all the incoming HTTP requests to retrieve the password reset link. Consequently, the token is still valid and will be able to reset password of the victim's boozt account : GAME OVER!\n\n**Mitigation :** The web application should use the SERVER_NAME instead of the Host header as is the case in the main app boozt.com.\n\n**References :**\n- http://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html\n \nKind regards.\nYassine ABOUKIR\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eIssue Summary :\u003c/strong\u003e\u003cbr\u003e\nWhile conducting my regular testing I discovered that the mobile version of boozt.com application relies on the host header when constructing password reset links emailed to the user. Thus, an attacker can inject a arbitrary host header which leads to password reset leakage.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact :\u003c/strong\u003e The attacker will receive the leaked user password reset link and, as a consequence, take over user\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof Of Concept :\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eBrowse to \u003ca title=\"https://m.boozt.com/eu/en/customer/forgot_password\" href=\"/redirect?url=https%3A%2F%2Fm.boozt.com%2Feu%2Fen%2Fcustomer%2Fforgot_password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.boozt.com/eu/en/customer/forgot_password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter the victim\u0026#39;s address mail (Easily enumerated abusing \u003ca href=\"/reports/165894\"\u003e#165894\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003eClick to reset the password.\u003c/li\u003e\n\u003cli\u003eIntercept the HTTP request and tamper the host header to a domain name controlled by the atatcker as you can see below :\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Capture_d_e_cran_2016-09-11_a__20.32.44.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/118/d8493799ffb87a77630f35208a35fde30e966c92/Capture_d_e_cran_2016-09-11_a__20.32.44.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.32.44.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.32.44.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043939Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026amp;X-Amz-Signature=876c23eb266beabfac8371921d2ae3c688690de30af71f7ae2e9a015a5ea90ef\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/118/d8493799ffb87a77630f35208a35fde30e966c92/Capture_d_e_cran_2016-09-11_a__20.32.44.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.32.44.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.32.44.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043939Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026amp;X-Amz-Signature=876c23eb266beabfac8371921d2ae3c688690de30af71f7ae2e9a015a5ea90ef\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOtherwise, you can simply use the following CURL command to reproduce the request after replacing \u003ccode\u003e\u0026lt;TOKEN\u0026gt;\u003c/code\u003e and \u003ccode\u003e\u0026lt;SESSION\u0026gt;\u003c/code\u003e with a valid values:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X \u0026#39;POST\u0026#39; \\\n    -H \u0026#39;Host: yassineaboukir.com\u0026#39; -H \u0026#39;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:48.0) Gecko/20100101 Firefox/48.0\u0026#39; -H \u0026#39;DNT: 1\u0026#39; -H \u0026#39;Referer: https://m.boozt.com/eu/en/customer/forgot_password\u0026#39; -H \u0026#39;cookie: \u0026lt;SESSION\u0026gt;;\u0026#39; -H \u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; -H \u0026#39;Content-Type: application/x-www-form-urlencoded\u0026#39; \\\n    --data-binary $\u0026#39;forgot_password%5Bemail%5D=yaaboukir@gmail.com\u0026amp;forgot_password%5B_token%5D=\u0026lt;TOKEN\u0026gt;\u0026#39; \\\n    \u0026#39;https://m.boozt.com/eu/en/customer/forgot_password\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, the victim will receive a password reset e-mail with a poisoned link as you can see below :\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Capture_d_e_cran_2016-09-11_a__20.53.08.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/124/5e3e45bc7a9336bed67da2f6d95c12180ba2b11f/Capture_d_e_cran_2016-09-11_a__20.53.08.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.53.08.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.53.08.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043939Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026amp;X-Amz-Signature=bdf2563ea86d48e51d7771ba6547ba861c045aec07aff53c9a4deeb932316ab5\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/124/5e3e45bc7a9336bed67da2f6d95c12180ba2b11f/Capture_d_e_cran_2016-09-11_a__20.53.08.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.53.08.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.53.08.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043939Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026amp;X-Amz-Signature=bdf2563ea86d48e51d7771ba6547ba861c045aec07aff53c9a4deeb932316ab5\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOnce the user clicks on it, he/she will be taken to :\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca title=\"https://yassineaboukir.com/eu/en/customer/reset_password/c2eca9c2b4160c94c884faa529e7ae4c\" href=\"/redirect?url=https%3A%2F%2Fyassineaboukir.com%2Feu%2Fen%2Fcustomer%2Freset_password%2Fc2eca9c2b4160c94c884faa529e7ae4c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://yassineaboukir.com/eu/en/customer/reset_password/c2eca9c2b4160c94c884faa529e7ae4c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe token is now leaked and the attacker now can simply go to the server logs and browse all the incoming HTTP requests to retrieve the password reset link. Consequently, the token is still valid and will be able to reset password of the victim\u0026#39;s boozt account : GAME OVER!\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation :\u003c/strong\u003e The web application should use the SERVER_NAME instead of the Host header as is the case in the main app boozt.com.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReferences :\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"http://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html\" href=\"/redirect?url=http%3A%2F%2Fwww.skeletonscribe.net%2F2013%2F05%2Fpractical-http-host-header-attacks.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eKind regards.\u003cbr\u003e\nYassine ABOUKIR\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":166311,"original_report_url":"https://hackerone.com/reports/166311","attachments":[{"id":119118,"file_name":"Capture_d_e_cran_2016-09-11_a__20.32.44.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/118/d8493799ffb87a77630f35208a35fde30e966c92/Capture_d_e_cran_2016-09-11_a__20.32.44.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.32.44.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.32.44.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043939Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026X-Amz-Signature=876c23eb266beabfac8371921d2ae3c688690de30af71f7ae2e9a015a5ea90ef","file_size":28275,"type":"image/png"},{"id":119124,"file_name":"Capture_d_e_cran_2016-09-11_a__20.53.08.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/124/5e3e45bc7a9336bed67da2f6d95c12180ba2b11f/Capture_d_e_cran_2016-09-11_a__20.53.08.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.53.08.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.53.08.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25IEPN5W%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043939Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGojoFHYyCDvb%2BXAjQEzKXYo0cN6YgJWwRJoBMTBodvFAiEAkjYJPCZTbW5LF6pXKeYUzvifyblxt5cAp8OWQVJ%2FXdYqtAMIURABGgwwMTM2MTkyNzQ4NDkiDDd8nN1tNa5pzv30pCqRA7Ph9Co9HiSYfKlNApPKzMJp%2BPqxLe8Ju6%2FQtxdCI9U1lEQUFn9ewSrpodC9pOs%2FMyrIAI5stnxgaEaom7ujNOoc34l6%2BTkEGv9Y2TtDG%2F6MD5FCxKDE7316B4LRiNnhrXlf1kpMEqB49R9XZ9Th3JVnETQSl2atM14IgQgmpqJSfT7IPihC5115xtBUuM1b1VEaztOwJA0tvxbxI9Eiytp1g9j2FQ69Q6AdAyR5I0a60yTgU0xhtbO0NWn2gG79gCfnlrQtFfr649iby7EzrtBYQDKCva230prVXUOGd2rnezH1a6HejKRbcXyg3T0vJc6ItyCalAFZJA8RxggaGPoKBC0%2FxJU%2BMXbYAop0a78X0pvb9LQKNAkFl1qBzYHD7vLLP5slCA3D6rzVHe6vBmemFMQI9Cz5X3GfOfHNz8jHxqWJ8iVS%2FU9KbuSOI692syFt%2BGi53x25mKtDox9BHZ7WazOiLmA%2FHuTWS7Z90ZPbFXA1MTGak652TFT76e%2F5JnUL5rL6Dxz7ebozHt1mcI48MOrfqf8FOusBcmo4WmE5D%2BfgbL3cANmT8rb7g5Tg9JbhitDWFQRQqXzuETfjTp6Ezu4tf83dFSbU9eCxxiyLYau9EWPhE9B4v87XF74i5GK1OipYkT0%2BNZjB9EW9VZMX0230HnFKDsNiTQwr7mTXqrbYhakokbJBxaATcBVovUky68FMrCt3Tio%2BkpK4GD5UdzI9sNUqgKyzqtx%2B4A1yzJP2%2FTuukIsfe1T0MWeQN1ndQDyHOghRBuOjAsTy6OtXEu7F7l2DDxPlq0wvB1qgTPC0vZd5wwaH0hY%2BkAjliixgHKgN4gCnVWzZD7vjsUmfySTotg%3D%3D\u0026X-Amz-Signature=bdf2563ea86d48e51d7771ba6547ba861c045aec07aff53c9a4deeb932316ab5","file_size":47232,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":43,"voters":["derision","smiegles","albinowax","cdl","bogdantcaciuc","yaworsk","flashdisk","zombiehelp54","ngalog","yassineaboukir","and 33 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1188367,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi,\nThanks for the report, though someone beat you to reporting this.\nI know domain is different, but as per our program guidelines different domains share the same system, so the same bugs are counted as duplicate.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nThanks for the report, though someone beat you to reporting this.\u003cbr\u003e\nI know domain is different, but as per our program guidelines different domains share the same system, so the same bugs are counted as duplicate.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T11:08:52.540Z","updated_at":"2016-09-12T11:08:52.540Z","original_report_id":166311,"actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1188600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @aurelijus,\nThank you for getting back to me. I read your guidelines, but I thought boozt and shopeu.ecco.com does not have the same system because boozt.com is not vulnerable to it, only the mobile web app is vulnerable.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/aurelijus\"\u003e@aurelijus\u003c/a\u003e,\u003cbr\u003e\nThank you for getting back to me. I read your guidelines, but I thought boozt and shopeu.ecco.com does not have the same system because boozt.com is not vulnerable to it, only the mobile web app is vulnerable.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T13:47:27.562Z","updated_at":"2016-09-12T13:47:27.562Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1199988,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Shall we disclose ?","markdown_message":"\u003cp\u003eShall we disclose ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-16T08:55:32.305Z","updated_at":"2016-09-16T08:55:32.305Z","first_to_agree":true,"actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202196,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-17T19:19:12.944Z","updated_at":"2016-09-17T19:19:12.944Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202197,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-17T19:19:13.036Z","updated_at":"2016-09-17T19:19:13.036Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}