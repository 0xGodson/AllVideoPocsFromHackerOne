{"id":132777,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzI3Nzc=","url":"https://hackerone.com/reports/132777","title":"Labels created in private projects are leaked","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-20T03:52:17.524Z","submitted_at":"2016-04-20T03:52:17.524Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-03T01:00:20.457Z","bug_reporter_agreed_on_going_public_at":"2016-05-03T00:55:01.373Z","team_member_agreed_on_going_public_at":"2016-05-03T01:00:20.401Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Vulnerability details\nAn insecure direct object reference vulnerability exists in the code that assigns labels to issues and merge requests, that allows an attack to read labels of private projects. This probably doesn't leak a lot of super confidential data, but since it's hard to predict how people use labels, it'd be good to fix this issue.\n\n# Proof of concept\n**Note**: this proof of concept demonstrates the attack with an issue, but the same issue exists when a merge request is created. To start off, sign in as a victim (`jane`) and create a project (`private-project`). Set the visibility level to private for this project. When this is set up, create a label at http://gitlab-instance/jane/private-project/labels. When I reproduced this issue for myself, I used `SomeCompany Secret feature` as label name. The label had ID `1`. Now sign in as the attacker (`john`). John wants access to the label that Jane created for her private program. John creates a new project called `random-project` and creates a new issue at http://gitlab-instance/john/random-project/issues. No need to select a label in the New issue form.\n\nNow intercept the traffic before you click the \"Submit issue\" button. The request that is sent to the GitLab server looks something like this:\n\n```\nPOST /john/random-project/issues HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026authenticity_token=zD0fqQphsFSNP6gl6KWhTw5iaTtk3cGlDz1Gn563roNyiSq2ACIXGp8%2FmBMo9q70ZP3M0mCWmsq7XJCmzkdADg%3D%3D\u0026issue%5Btitle%5D=a\u0026issue%5Bdescription%5D=a\u0026issue%5Bassignee_id%5D=\u0026issue%5Bmilestone_id%5D=\u0026issue%5Blabel_ids%5D%5B%5D=\n```\n\nNow add the label ID that you want access to as value to the `issue[label_ids][]` array. The request will now look something like this (note the appended `1`):\n\n```\nPOST /john/random-project/issues HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026authenticity_token=zD0fqQphsFSNP6gl6KWhTw5iaTtk3cGlDz1Gn563roNyiSq2ACIXGp8%2FmBMo9q70ZP3M0mCWmsq7XJCmzkdADg%3D%3D\u0026issue%5Btitle%5D=a\u0026issue%5Bdescription%5D=a\u0026issue%5Bassignee_id%5D=\u0026issue%5Bmilestone_id%5D=\u0026issue%5Blabel_ids%5D%5B%5D=1\n```\n\nForward the request and go back to the browser. You'll see that the label that belongs to the private project shows up as attached label:\n\n{F88003}\n\n# Impact\nAn attacker could easily iterate over all existing label IDs to attach all labels to an issue. This way potential confidential information (either in the name or description) is revealed to an attacker. Like said in the introduction, because you don't know how people use these labels, this can contain confidential information.","vulnerability_information_html":"\u003ch1 id=\"vulnerability-details\"\u003eVulnerability details\u003c/h1\u003e\n\n\u003cp\u003eAn insecure direct object reference vulnerability exists in the code that assigns labels to issues and merge requests, that allows an attack to read labels of private projects. This probably doesn\u0026#39;t leak a lot of super confidential data, but since it\u0026#39;s hard to predict how people use labels, it\u0026#39;d be good to fix this issue.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e: this proof of concept demonstrates the attack with an issue, but the same issue exists when a merge request is created. To start off, sign in as a victim (\u003ccode\u003ejane\u003c/code\u003e) and create a project (\u003ccode\u003eprivate-project\u003c/code\u003e). Set the visibility level to private for this project. When this is set up, create a label at \u003ca title=\"http://gitlab-instance/jane/private-project/labels\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fjane%2Fprivate-project%2Flabels\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/jane/private-project/labels\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. When I reproduced this issue for myself, I used \u003ccode\u003eSomeCompany Secret feature\u003c/code\u003e as label name. The label had ID \u003ccode\u003e1\u003c/code\u003e. Now sign in as the attacker (\u003ccode\u003ejohn\u003c/code\u003e). John wants access to the label that Jane created for her private program. John creates a new project called \u003ccode\u003erandom-project\u003c/code\u003e and creates a new issue at \u003ca title=\"http://gitlab-instance/john/random-project/issues\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fjohn%2Frandom-project%2Fissues\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/john/random-project/issues\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. No need to select a label in the New issue form.\u003c/p\u003e\n\n\u003cp\u003eNow intercept the traffic before you click the \u0026quot;Submit issue\u0026quot; button. The request that is sent to the GitLab server looks something like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /john/random-project/issues HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026amp;authenticity_token=zD0fqQphsFSNP6gl6KWhTw5iaTtk3cGlDz1Gn563roNyiSq2ACIXGp8%2FmBMo9q70ZP3M0mCWmsq7XJCmzkdADg%3D%3D\u0026amp;issue%5Btitle%5D=a\u0026amp;issue%5Bdescription%5D=a\u0026amp;issue%5Bassignee_id%5D=\u0026amp;issue%5Bmilestone_id%5D=\u0026amp;issue%5Blabel_ids%5D%5B%5D=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow add the label ID that you want access to as value to the \u003ccode\u003eissue[label_ids][]\u003c/code\u003e array. The request will now look something like this (note the appended \u003ccode\u003e1\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /john/random-project/issues HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026amp;authenticity_token=zD0fqQphsFSNP6gl6KWhTw5iaTtk3cGlDz1Gn563roNyiSq2ACIXGp8%2FmBMo9q70ZP3M0mCWmsq7XJCmzkdADg%3D%3D\u0026amp;issue%5Btitle%5D=a\u0026amp;issue%5Bdescription%5D=a\u0026amp;issue%5Bassignee_id%5D=\u0026amp;issue%5Bmilestone_id%5D=\u0026amp;issue%5Blabel_ids%5D%5B%5D=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eForward the request and go back to the browser. You\u0026#39;ll see that the label that belongs to the private project shows up as attached label:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2016-04-19_at_20.42.27.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/088/003/28a81e5485a11cde5256098d3e9f4ed60c32589a/Screen_Shot_2016-04-19_at_20.42.27.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-04-19_at_20.42.27.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-04-19_at_20.42.27.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042517Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=a7cbef370b707f903a880ca4844dbdd342ede1dfd96efa1e54eeba1b2b478c69\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/088/003/28a81e5485a11cde5256098d3e9f4ed60c32589a/Screen_Shot_2016-04-19_at_20.42.27.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-04-19_at_20.42.27.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-04-19_at_20.42.27.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042517Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=a7cbef370b707f903a880ca4844dbdd342ede1dfd96efa1e54eeba1b2b478c69\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eAn attacker could easily iterate over all existing label IDs to attach all labels to an issue. This way potential confidential information (either in the name or description) is revealed to an attacker. Like said in the introduction, because you don\u0026#39;t know how people use these labels, this can contain confidential information.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":88003,"file_name":"Screen_Shot_2016-04-19_at_20.42.27.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/088/003/28a81e5485a11cde5256098d3e9f4ed60c32589a/Screen_Shot_2016-04-19_at_20.42.27.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-04-19_at_20.42.27.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-04-19_at_20.42.27.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042517Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=a7cbef370b707f903a880ca4844dbdd342ede1dfd96efa1e54eeba1b2b478c69","file_size":32581,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-02T00:55:01.472Z","allow_singular_disclosure_after":-144387016.10501763,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","spetr0x","martijn","dyabla","cryptosector","pei"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":919376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Thanks, Jobert. I've cross-posted this to https://gitlab.com/gitlab-org/gitlab-ce/issues/15439 -- you won't be able to see it currently because it's marked Confidential, but I'll keep you updated here on its progress.","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e Thanks, Jobert. I\u0026#39;ve cross-posted this to \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/15439\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F15439\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/15439\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e -- you won\u0026#39;t be able to see it currently because it\u0026#39;s marked Confidential, but I\u0026#39;ll keep you updated here on its progress.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T02:22:31.356Z","updated_at":"2016-04-21T02:22:31.356Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":920658,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A fix has been created and is undergoing review.","markdown_message":"\u003cp\u003eA fix has been created and is undergoing review.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T16:50:08.838Z","updated_at":"2016-04-21T16:50:08.838Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":921063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, @rspeicher! Let me know if you want me to check out the fix before it's merged back to develop.","markdown_message":"\u003cp\u003eThanks for the update, \u003ca href=\"/rspeicher\"\u003e@rspeicher\u003c/a\u003e! Let me know if you want me to check out the fix before it\u0026#39;s merged back to develop.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T18:51:22.530Z","updated_at":"2016-04-21T18:51:22.530Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Here's the relevant diff (I left out some spec changes and a CHANGELOG entry) if you'd like to verify it's fixed:\n\n```diff\ndiff --git a/app/services/issuable_base_service.rb b/app/services/issuable_base_service.rb\nindex 18f76d3..2b16089 100644\n--- a/app/services/issuable_base_service.rb\n+++ b/app/services/issuable_base_service.rb\n@@ -37,8 +37,9 @@ class IssuableBaseService \u003c BaseService\n   end\n \n   def filter_params(issuable_ability_name = :issue)\n-    params[:assignee_id]  = \"\" if params[:assignee_id] == IssuableFinder::NONE\n-    params[:milestone_id] = \"\" if params[:milestone_id] == IssuableFinder::NONE\n+    filter_assignee\n+    filter_milestone\n+    filter_labels\n \n     ability = :\"admin_#{issuable_ability_name}\"\n \n@@ -49,6 +50,29 @@ class IssuableBaseService \u003c BaseService\n     end\n   end\n \n+  def filter_assignee\n+    if params[:assignee_id] == IssuableFinder::NONE\n+      params[:assignee_id] = ''\n+    end\n+  end\n+\n+  def filter_milestone\n+    milestone_id = params[:milestone_id]\n+    return unless milestone_id\n+\n+    if milestone_id == IssuableFinder::NONE ||\n+        project.milestones.find_by(id: milestone_id).nil?\n+      params[:milestone_id] = ''\n+    end\n+  end\n+\n+  def filter_labels\n+    return if params[:label_ids].to_a.empty?\n+\n+    params[:label_ids] =\n+      project.labels.where(id: params[:label_ids]).pluck(:id)\n+  end\n+\n   def update(issuable)\n     change_state(issuable)\n     filter_params\n```\n\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e Here\u0026#39;s the relevant diff (I left out some spec changes and a CHANGELOG entry) if you\u0026#39;d like to verify it\u0026#39;s fixed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/app/services/issuable_base_service.rb b/app/services/issuable_base_service.rb\nindex 18f76d3..2b16089 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/app/services/issuable_base_service.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/app/services/issuable_base_service.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -37,8 +37,9 @@\u003c/span\u003e class IssuableBaseService \u0026lt; BaseService\n   end\n\n   def filter_params(issuable_ability_name = :issue)\n\u003cspan class=\"gd\"\u003e-    params[:assignee_id]  = \u0026quot;\u0026quot; if params[:assignee_id] == IssuableFinder::NONE\n-    params[:milestone_id] = \u0026quot;\u0026quot; if params[:milestone_id] == IssuableFinder::NONE\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    filter_assignee\n+    filter_milestone\n+    filter_labels\n\u003c/span\u003e\n     ability = :\u0026quot;admin_#{issuable_ability_name}\u0026quot;\n\n@@ -49,6 +50,29 @@ class IssuableBaseService \u0026lt; BaseService\n     end\n   end\n\n+  def filter_assignee\n\u003cspan class=\"gi\"\u003e+    if params[:assignee_id] == IssuableFinder::NONE\n+      params[:assignee_id] = \u0026#39;\u0026#39;\n+    end\n+  end\n+\n+  def filter_milestone\n+    milestone_id = params[:milestone_id]\n+    return unless milestone_id\n+\n+    if milestone_id == IssuableFinder::NONE ||\n+        project.milestones.find_by(id: milestone_id).nil?\n+      params[:milestone_id] = \u0026#39;\u0026#39;\n+    end\n+  end\n+\n+  def filter_labels\n+    return if params[:label_ids].to_a.empty?\n+\n+    params[:label_ids] =\n+      project.labels.where(id: params[:label_ids]).pluck(:id)\n+  end\n+\n\u003c/span\u003e   def update(issuable)\n     change_state(issuable)\n     filter_params\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T20:09:53.621Z","updated_at":"2016-04-21T20:09:53.621Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":921717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup, seems like this does the job! One think I noticed is that this requires everyone to use the `Issues::CreateService` class. This seems fine, but it might not be immediately clear to everyone. Hope code reviews catch this when this would happen in the future. The other option would be to add this constraint to the model, but I understand if you want to avoid adding business logic to the models. Nice job!","markdown_message":"\u003cp\u003eYup, seems like this does the job! One think I noticed is that this requires everyone to use the \u003ccode\u003eIssues::CreateService\u003c/code\u003e class. This seems fine, but it might not be immediately clear to everyone. Hope code reviews catch this when this would happen in the future. The other option would be to add this constraint to the model, but I understand if you want to avoid adding business logic to the models. Nice job!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-22T00:40:55.215Z","updated_at":"2016-04-22T00:40:55.215Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":922788,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-22T16:08:03.135Z","updated_at":"2016-04-22T16:08:03.135Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937752,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@jobert The patches that include a fix for this issue [have been released](https://about.gitlab.com/2016/05/02/cve-2016-4340-patches/) and the [acknowledgements page](https://about.gitlab.com/vulnerability-acknowledgements/) has been updated.\n\nFeel free to request public disclosure for this report if you'd like.\n\nThank you again!","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e The patches that include a fix for this issue \u003ca href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2F2016%2F05%2F02%2Fcve-2016-4340-patches%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehave been released\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and the \u003ca href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2Fvulnerability-acknowledgements%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eacknowledgements page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has been updated.\u003c/p\u003e\n\n\u003cp\u003eFeel free to request public disclosure for this report if you\u0026#39;d like.\u003c/p\u003e\n\n\u003cp\u003eThank you again!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-03T00:53:07.601Z","updated_at":"2016-05-03T00:53:07.601Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937766,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-03T00:55:01.407Z","updated_at":"2016-05-03T00:55:01.407Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937790,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-03T01:00:20.421Z","updated_at":"2016-05-03T01:00:20.421Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937791,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-03T01:00:20.477Z","updated_at":"2016-05-03T01:00:20.477Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}