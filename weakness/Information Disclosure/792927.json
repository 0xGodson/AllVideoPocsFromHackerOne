{"id":792927,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTI5Mjc=","url":"https://hackerone.com/reports/792927","title":"Email address of any user can be queried on Report Invitation GraphQL type when username is known","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-02-11T05:53:53.346Z","submitted_at":"2020-02-11T05:53:53.346Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"msdian7","url":"/msdian7","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-20T16:58:04.631Z","bug_reporter_agreed_on_going_public_at":"2020-02-20T16:58:04.569Z","team_member_agreed_on_going_public_at":"2020-02-20T16:48:26.430Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nEmail  id  of all hackerone users disclosure\n\n**Description:**\nThere is an flaw , with that i can get all hackerone users email id \n\n### Steps To Reproduce\n\n1. Invoke the below graphql call\n\nPOST /graphql HTTP/1.1\n\n```{\"query\":\"mutation Revoke_credential_mutation($input_0:AddReportParticipantInput!) {addReportParticipant(input:$input_0) {clientMutationId,...F1}}  fragment F1 on AddReportParticipantPayload {clientMutationId,was_successful,errors{nodes{message}},invitation{email,token}}\",\"variables\":{\"input_0\":{\"report_id\":\"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjYzNzE=\",\"email\":\"██████████\",\"username\":\"jobert\"}}}```\n\nyou will get below response\n\n```\n{\"data\":{\"addReportParticipant\":{\"clientMutationId\":null,\"was_successful\":true,\"errors\":{\"nodes\":[]},\"invitation\":{\"email\":\"████\",\"token\":null}}}}\n```\n\n2.  to reproduce from your account, create one test program, and create one report for that program, get that report id \ngid://hackerone/Report/626371 (here 626371 my test program's report id)  convert it into base 64, replace that id with the \"report_id\" in the above graphql query \n3.   Done\n\n## Impact\n\nPII disclosed","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nEmail  id  of all hackerone users disclosure\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThere is an flaw , with that i can get all hackerone users email id \u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eInvoke the below graphql call\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOST /graphql HTTP/1.1\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{\u0026quot;query\u0026quot;:\u0026quot;mutation Revoke_credential_mutation($input_0:AddReportParticipantInput!) {addReportParticipant(input:$input_0) {clientMutationId,...F1}}  fragment F1 on AddReportParticipantPayload {clientMutationId,was_successful,errors{nodes{message}},invitation{email,token}}\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;input_0\u0026quot;:{\u0026quot;report_id\u0026quot;:\u0026quot;Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjYzNzE=\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;██████████\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;jobert\u0026quot;}}}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eyou will get below response\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;data\u0026quot;:{\u0026quot;addReportParticipant\u0026quot;:{\u0026quot;clientMutationId\u0026quot;:null,\u0026quot;was_successful\u0026quot;:true,\u0026quot;errors\u0026quot;:{\u0026quot;nodes\u0026quot;:[]},\u0026quot;invitation\u0026quot;:{\u0026quot;email\u0026quot;:\u0026quot;████\u0026quot;,\u0026quot;token\u0026quot;:null}}}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003e to reproduce from your account, create one test program, and create one report for that program, get that report id \ngid://hackerone/Report/626371 (here 626371 my test program\u0026#39;s report id)  convert it into base 64, replace that id with the \u0026quot;report_id\u0026quot; in the above graphql query \u003c/li\u003e\n\u003cli\u003e  Done\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ePII disclosed\u003c/p\u003e\n","bounty_amount":"8500.0","formatted_bounty":"$8,500","weakness":{"id":124,"name":"Improper Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-21T16:48:26.928Z","allow_singular_disclosure_after":-24415538.380795423,"singular_disclosure_allowed":true,"vote_count":604,"voters":["whoareme","acut3","anh_thanh_nien","cattykit","nytr0gen","checkm50","sultancad","m0chan","skarsom","jobert","and 594 more..."],"severity":{"rating":"high","score":8.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7014673,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @msdian7 - thanks for your report. We're investigating this.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e - thanks for your report. We\u0026#39;re investigating this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-11T05:56:59.709Z","updated_at":"2020-02-11T05:56:59.709Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7014771,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-11T06:25:46.024Z","updated_at":"2020-02-11T06:25:46.024Z","additional_data":{"old_severity":"Critical","new_severity":"High (8.3)","old_severity_id":629682,"new_severity_id":629697},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7014776,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @msdian7,\n\nJust wanted to check, are the accounts you queried ██████ and █████ your accounts?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eJust wanted to check, are the accounts you queried ██████ and █████ your accounts?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-11T06:27:09.616Z","updated_at":"2020-02-11T08:16:05.810Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7014964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"███████ is my account and ████████ is not my acoount (that's my friend's account)","markdown_message":"\u003cp\u003e███████ is my account and ████████ is not my acoount (that\u0026#39;s my friend\u0026#39;s account)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-11T07:15:36.394Z","updated_at":"2020-02-11T08:16:05.805Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7015077,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-11T07:36:34.800Z","updated_at":"2020-02-11T07:36:34.800Z","additional_data":{"old_title":"Email  id disclosure","new_title":"Email address of any user can be queried on Report Invitation GraphQL type when username is known"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7015084,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-11T07:37:10.788Z","updated_at":"2020-02-11T07:37:10.788Z","additional_data":{"added_weaknesses":[{"id":124,"name":"Improper Authorization"}],"removed_weaknesses":[{"id":18,"name":"Information Disclosure"}]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7016118,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @msdian7,\n\nThanks again for bringing this to our attention, this was a great and speedy find! We've released a fix for the vulnerability. We'll follow up with our bounty decision tomorrow.\n\nRutger","markdown_message":"\u003cp\u003eHi \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks again for bringing this to our attention, this was a great and speedy find! We\u0026#39;ve released a fix for the vulnerability. We\u0026#39;ll follow up with our bounty decision tomorrow.\u003c/p\u003e\n\n\u003cp\u003eRutger\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-11T08:52:54.900Z","updated_at":"2020-02-11T08:52:54.900Z","actor":{"username":"rutger77","cleared":false,"url":"/rutger77","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HEpjhHJdRjX1BwF1vua6aTns/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"msdian7","url":"/msdian7"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7016685,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-02-11T09:20:55.532Z","updated_at":"2020-02-11T09:20:55.532Z","additional_data":{"report_retest_user_id":3000},"actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"email":"danlec","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7016686,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-02-11T09:20:56.196Z","updated_at":"2020-02-11T09:20:56.196Z","additional_data":{"report_retest_user_id":3001},"actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"email":"dr_dragon","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7016820,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-11T09:27:16.437Z","updated_at":"2020-02-11T09:27:16.437Z","additional_data":{"report_retest_user_id":3001},"actor":{"username":"dr_dragon","cleared":false,"url":"/dr_dragon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/r7Mc1RTnn4g3t5j7eEnogFAr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7024053,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks @msdian7 for reporting this to our program. We are awarding you with a $1000 bonus because of how quickly you were able to identify this vulnerability: less than 24hrs after we released the feature-shocking! 😮🎊","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e for reporting this to our program. We are awarding you with a $1000 bonus because of how quickly you were able to identify this vulnerability: less than 24hrs after we released the feature-shocking! 😮🎊\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-11T19:25:10.744Z","updated_at":"2020-02-12T00:49:23.535Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"7500.0","bounty_currency":"usd","bonus_amount":"1000.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"msdian7","url":"/msdian7"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7029576,"is_internal":false,"editable":false,"type":"Activities::ExternalUserInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-02-12T09:45:07.381Z","updated_at":"2020-02-12T09:45:07.381Z","additional_data":{"report_retest_user_id":3040},"actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"email":"kazan71p","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7037999,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-13T06:54:40.165Z","updated_at":"2020-02-13T06:54:40.165Z","additional_data":{"report_retest_user_id":3040},"actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7103222,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-20T16:48:26.518Z","updated_at":"2020-02-20T16:48:26.518Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7103275,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-20T16:58:04.590Z","updated_at":"2020-02-20T16:58:04.590Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7103276,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-20T16:58:04.652Z","updated_at":"2020-02-20T16:58:04.652Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7783428,"is_internal":false,"editable":false,"type":"Activities::UserLeftRetest","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-24T13:37:02.864Z","updated_at":"2020-09-11T11:07:47.094Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20324,"category":"team","content":"# Issue Summary\nThrough the HackerOne Bug Bounty Program on February 11, 2020 at 5:55 UTC, a HackerOne community member (“hacker”) notified HackerOne that they were able to determine a user’s email address by generating an invitation using only their username. The team patched the vulnerability at 08:30 UTC the same day.\n\nThe technical investigation finished at 8:40 UTC, concluding that there was no malicious intent or indicators of exploitation.\n\n# Timeline\n| Date Time (UTC) | Action |\n|---|---|\n|2020-02-10 15:13|Software containing vulnerability deployed to production.\n|2020-02-11 05:53|Vulnerability submitted to HackerOne’s bug bounty program.\n|2020-02-11 05:55|Incident Response (IR) team member on-call was paged about a critical severity report submitted to the HackerOne bug bounty program.|\n|2020-02-11 05:57|The on-call team member triaged the report and notified the full IR team.|\n|2020-02-11 06:04|A specialized IR team was assembled and began the investigation.|\n|2020-02-11 08:30|A vulnerability patch was deployed.|\n|2020-02-11 08:44|HackerOne’s IR team concluded technical investigation.|\n|2020-02-11 23:54|Two users were alerted that their information was exposed to the reporters who submitted the vulnerability.|\n\n# Root Cause\nHackerOne has an invitation system that allows program owners to send invitations to users for various purposes, such as invitations to hack on private programs, claim bounties, be added to programs, among others. The invitation system allows users to be invited by email or by username. If a user is invited by their username, the sender is not permitted to view the email address the invitation is sent to for user privacy. This rule has been guarded by HackerOne’s Access Control Lists (ACLs) in HackerOne’s Representational state transfer (REST) framework, but HackerOne has been migrating these objects to GraphQL under a new protection layer. When exposing a new invitation object, the ACL rule previously applied wasn’t implemented correctly to the new GraphQL protection layer.\n\n*How could this have been exploited to impact any user?*\nHackerOne provides demo programs for customers to experience the product as well as hackers to test against our production system. When you are a team member in a demo program, you can demo the report interface. In the report interface, you can invite an external participant to the report, which could be any user on the platform. By generating that invitation with a username and then viewing the invitation, the user’s email could have been exposed.\n\n# Resolution and Recovery\nAt 5:57 UTC, HackerOne successfully reproduced the vulnerability as described by the reporter. The IR team identified the change that introduced the vulnerability shortly after. A fix was deployed at 8:30 UTC, adding the necessary ACL into the GraphQL protection layer.\n\nThe IR team worked in parallel to identify the accounts impacted. It was determined shortly after the fix that there were no other usages except for those attempts by the reporter.\n\nThe maximum possible impact was assumed in determining the Common Vulnerability Scoring System (CVSS) score, which resulted in High (8.3). HackerOne decided to award a bonus of $1,000 due to the time to discover the vulnerability since the code was released, approximately 16 hours after the change was deployed.\n# Vulnerability Impact on Data\nThe reporter accessed the email addresses of two specific users to verify the findings, no other information could have been accessed with the discovered vulnerability.\n\n|Attribute| Description |\n|---|---|\n|email|The email address of the user invited|\n\n# Preventative Measures\nAs part of the HackerOne Incident Response process, HackerOne has conducted an internal review and analysis of the incident. HackerOne has taken the following actions to address the underlying cause of the issue and help prevent future occurrence.\n\n## Implement the proper ACL check within the invitation model\n\nThis change was the mitigating fix for resolving this vulnerability. It was deployed at 8:30UTC.\n\n## Identify sensitive database fields being added to GraphQL\n\nHackerOne maintains a list of sensitive database fields. The application security team is planning to leverage this list to have engineers acknowledge that they’ve, to their knowledge, properly implemented the authorization logic when they put up a code merge request. This change is expected to be implemented in Q1 2020.","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"issue-summary\"\u003eIssue Summary\u003c/h1\u003e\n\n\u003cp\u003eThrough the HackerOne Bug Bounty Program on February 11, 2020 at 5:55 UTC, a HackerOne community member (“hacker”) notified HackerOne that they were able to determine a user’s email address by generating an invitation using only their username. The team patched the vulnerability at 08:30 UTC the same day.\u003c/p\u003e\n\n\u003cp\u003eThe technical investigation finished at 8:40 UTC, concluding that there was no malicious intent or indicators of exploitation.\u003c/p\u003e\n\n\u003ch1 id=\"timeline\"\u003eTimeline\u003c/h1\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDate Time (UTC)\u003c/th\u003e\n\u003cth\u003eAction\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-10 15:13\u003c/td\u003e\n\u003ctd\u003eSoftware containing vulnerability deployed to production.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 05:53\u003c/td\u003e\n\u003ctd\u003eVulnerability submitted to HackerOne’s bug bounty program.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 05:55\u003c/td\u003e\n\u003ctd\u003eIncident Response (IR) team member on-call was paged about a critical severity report submitted to the HackerOne bug bounty program.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 05:57\u003c/td\u003e\n\u003ctd\u003eThe on-call team member triaged the report and notified the full IR team.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 06:04\u003c/td\u003e\n\u003ctd\u003eA specialized IR team was assembled and began the investigation.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 08:30\u003c/td\u003e\n\u003ctd\u003eA vulnerability patch was deployed.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 08:44\u003c/td\u003e\n\u003ctd\u003eHackerOne’s IR team concluded technical investigation.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-02-11 23:54\u003c/td\u003e\n\u003ctd\u003eTwo users were alerted that their information was exposed to the reporters who submitted the vulnerability.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1 id=\"root-cause\"\u003eRoot Cause\u003c/h1\u003e\n\n\u003cp\u003eHackerOne has an invitation system that allows program owners to send invitations to users for various purposes, such as invitations to hack on private programs, claim bounties, be added to programs, among others. The invitation system allows users to be invited by email or by username. If a user is invited by their username, the sender is not permitted to view the email address the invitation is sent to for user privacy. This rule has been guarded by HackerOne’s Access Control Lists (ACLs) in HackerOne’s Representational state transfer (REST) framework, but HackerOne has been migrating these objects to GraphQL under a new protection layer. When exposing a new invitation object, the ACL rule previously applied wasn’t implemented correctly to the new GraphQL protection layer.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eHow could this have been exploited to impact any user?\u003c/em\u003e\u003cbr\u003e\nHackerOne provides demo programs for customers to experience the product as well as hackers to test against our production system. When you are a team member in a demo program, you can demo the report interface. In the report interface, you can invite an external participant to the report, which could be any user on the platform. By generating that invitation with a username and then viewing the invitation, the user’s email could have been exposed.\u003c/p\u003e\n\n\u003ch1 id=\"resolution-and-recovery\"\u003eResolution and Recovery\u003c/h1\u003e\n\n\u003cp\u003eAt 5:57 UTC, HackerOne successfully reproduced the vulnerability as described by the reporter. The IR team identified the change that introduced the vulnerability shortly after. A fix was deployed at 8:30 UTC, adding the necessary ACL into the GraphQL protection layer.\u003c/p\u003e\n\n\u003cp\u003eThe IR team worked in parallel to identify the accounts impacted. It was determined shortly after the fix that there were no other usages except for those attempts by the reporter.\u003c/p\u003e\n\n\u003cp\u003eThe maximum possible impact was assumed in determining the Common Vulnerability Scoring System (CVSS) score, which resulted in High (8.3). HackerOne decided to award a bonus of $1,000 due to the time to discover the vulnerability since the code was released, approximately 16 hours after the change was deployed.\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability-impact-on-data\"\u003eVulnerability Impact on Data\u003c/h1\u003e\n\n\u003cp\u003eThe reporter accessed the email addresses of two specific users to verify the findings, no other information could have been accessed with the discovered vulnerability.\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eAttribute\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eemail\u003c/td\u003e\n\u003ctd\u003eThe email address of the user invited\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1 id=\"preventative-measures\"\u003ePreventative Measures\u003c/h1\u003e\n\n\u003cp\u003eAs part of the HackerOne Incident Response process, HackerOne has conducted an internal review and analysis of the incident. HackerOne has taken the following actions to address the underlying cause of the issue and help prevent future occurrence.\u003c/p\u003e\n\n\u003ch2 id=\"implement-the-proper-acl-check-within-the-invitation-model\"\u003eImplement the proper ACL check within the invitation model\u003c/h2\u003e\n\n\u003cp\u003eThis change was the mitigating fix for resolving this vulnerability. It was deployed at 8:30UTC.\u003c/p\u003e\n\n\u003ch2 id=\"identify-sensitive-database-fields-being-added-to-graphql\"\u003eIdentify sensitive database fields being added to GraphQL\u003c/h2\u003e\n\n\u003cp\u003eHackerOne maintains a list of sensitive database fields. The application security team is planning to leverage this list to have engineers acknowledge that they’ve, to their knowledge, properly implemented the authorization logic when they put up a code merge request. This change is expected to be implemented in Q1 2020.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}