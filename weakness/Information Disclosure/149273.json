{"id":149273,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDkyNzM=","url":"https://hackerone.com/reports/149273","title":"Filename and directory enumeration","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-05T05:37:57.738Z","submitted_at":"2016-07-05T05:37:57.738Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"strukt","url":"/strukt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":265,"url":"https://hackerone.com/expressionengine","handle":"expressionengine","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ExpressionEngine","twitter_handle":"eecms","website":"https://expressionengine.com/","about":"ExpressionEngine is a robust and flexible open-source Content Management System."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-08T02:42:35.248Z","bug_reporter_agreed_on_going_public_at":"2016-07-09T02:42:17.191Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThe \"Import File Converter\" can be abused by an admin to map the server directories and files, because the \"File location\" field doesn't sanitize the user input and allows access to root directories and files.\n\n## Steps to reproduce:\n1- Go to http://localhost/ee/admin.php?/cp/utilities/import_converter\n2- Set the \"File location\" to `///etc/`, notice that the error \"You must have at least 3 fields: username, screen_name, and email address\", proving that the file exists.\n3- Try with `///strukt/`, notice the different error message, now it says \"The path you submitted is not valid.\", meaning the directory doesn't exist.\n3- Now try with `///etc/passwd`, the first error message shows up.\n4- Finally, try with `///etc/strukt`, the second message appears.\n\n## More successful test cases:\n`///etc/hosts`\n`///usr/`\n`///var/`\n`../../../../../../../../etc/passwd`\n\nRegards","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe \u0026quot;Import File Converter\u0026quot; can be abused by an admin to map the server directories and files, because the \u0026quot;File location\u0026quot; field doesn\u0026#39;t sanitize the user input and allows access to root directories and files.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003cp\u003e1- Go to \u003ca title=\"http://localhost/ee/admin.php?/cp/utilities/import_converter\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fee%2Fadmin.php%3F%2Fcp%2Futilities%2Fimport_converter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/ee/admin.php?/cp/utilities/import_converter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2- Set the \u0026quot;File location\u0026quot; to \u003ccode\u003e///etc/\u003c/code\u003e, notice that the error \u0026quot;You must have at least 3 fields: username, screen_name, and email address\u0026quot;, proving that the file exists.\u003cbr\u003e\n3- Try with \u003ccode\u003e///strukt/\u003c/code\u003e, notice the different error message, now it says \u0026quot;The path you submitted is not valid.\u0026quot;, meaning the directory doesn\u0026#39;t exist.\u003cbr\u003e\n3- Now try with \u003ccode\u003e///etc/passwd\u003c/code\u003e, the first error message shows up.\u003cbr\u003e\n4- Finally, try with \u003ccode\u003e///etc/strukt\u003c/code\u003e, the second message appears.\u003c/p\u003e\n\n\u003ch2 id=\"more-successful-test-cases\"\u003eMore successful test cases:\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003e///etc/hosts\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003e///usr/\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003e///var/\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003e../../../../../../../../etc/passwd\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-08T02:42:17.282Z","allow_singular_disclosure_after":-138592202.18606892,"singular_disclosure_allowed":true,"vote_count":2,"voters":["its_afolic","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1058394,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Very interesting. We're going to have to rethink how we do validation of file paths, so no quick solution at the moment, but we're on it!","markdown_message":"\u003cp\u003eVery interesting. We\u0026#39;re going to have to rethink how we do validation of file paths, so no quick solution at the moment, but we\u0026#39;re on it!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-07T23:27:14.817Z","updated_at":"2016-07-07T23:27:14.817Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060126,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ok thanks again, Mustafa. What we've decided to do is combine those two error messages so that they don't differentiate between the file existing or being writable. So instead of there being two different error messages, you just get \"This path is either invalid or not writeable\" for either case. That way you don't know if the file exists or just isn't writable.","markdown_message":"\u003cp\u003eOk thanks again, Mustafa. What we\u0026#39;ve decided to do is combine those two error messages so that they don\u0026#39;t differentiate between the file existing or being writable. So instead of there being two different error messages, you just get \u0026quot;This path is either invalid or not writeable\u0026quot; for either case. That way you don\u0026#39;t know if the file exists or just isn\u0026#39;t writable.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T19:17:32.354Z","updated_at":"2016-07-08T19:17:32.354Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're welcome, well done (Y)","markdown_message":"\u003cp\u003eYou\u0026#39;re welcome, well done (Y)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-09T02:41:18.042Z","updated_at":"2016-07-09T02:41:18.042Z","actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060612,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-09T02:42:17.223Z","updated_at":"2016-07-09T02:42:17.223Z","first_to_agree":true,"actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1111709,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-08T02:42:35.378Z","updated_at":"2016-08-08T02:42:35.378Z","actor":{"url":"/expressionengine","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ExpressionEngine"}},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}