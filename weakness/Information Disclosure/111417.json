{"id":111417,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTE0MTc=","url":"https://hackerone.com/reports/111417","title":"Checking whether user liked the media or not even when you are blocked ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-18T14:16:23.657Z","submitted_at":"2016-01-18T14:16:23.657Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vraj","url":"/vraj","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/434/bb73406127ae2923dcedc4c1d9cafe6362f534a9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-05-25T18:42:36.353Z","bug_reporter_agreed_on_going_public_at":"2016-04-25T18:42:26.051Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Poc :\nTake 2 accounts A and B \n1.) Now from A id make a random post say http://vk.com/id307083341?w=wall307083341_36\n2.)Now from C id try to like the post of A .\n3.)Now from B id visit https://vk.com/dev/likes.getList\n4.) now put the owner id A and the post id == \u003e 307083341 which 36 in this case \n5.)and in the the friends_only field change 1 to 0 \n6.)then hit run you will find that vk.com will return the array of guys who have liked it now open another tab  \n7.)Now block B from A account .\n8.)Now try to again query https://vk.com/dev/likes.getList the same from 3 you will find that now vk.com will not allow you ! error \nbut now \n9.)But these methods are not protected === \u003e Visit now  https://vk.com/dev/likes.isLiked  and now put the owner_id=[307---], item_id=36 , user_id of the guy to which you have to check whether he has liked or not the media  and this time their is no error and vk.com will show liked : 1 \n\nHence no where in the application this information is being disclosed but here is the end point leaking the information \nraj_v\n","vulnerability_information_html":"\u003cp\u003ePoc :\u003cbr\u003e\nTake 2 accounts A and B \u003cbr\u003e\n1.) Now from A id make a random post say \u003ca title=\"http://vk.com/id307083341?w=wall307083341_36\" href=\"/redirect?url=http%3A%2F%2Fvk.com%2Fid307083341%3Fw%3Dwall307083341_36\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://vk.com/id307083341?w=wall307083341_36\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2.)Now from C id try to like the post of A .\u003cbr\u003e\n3.)Now from B id visit \u003ca title=\"https://vk.com/dev/likes.getList\" href=\"/redirect?url=https%3A%2F%2Fvk.com%2Fdev%2Flikes.getList\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vk.com/dev/likes.getList\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n4.) now put the owner id A and the post id == \u0026gt; 307083341 which 36 in this case \u003cbr\u003e\n5.)and in the the friends_only field change 1 to 0 \u003cbr\u003e\n6.)then hit run you will find that vk.com will return the array of guys who have liked it now open another tab\u003cbr\u003e\u003cbr\u003e\n7.)Now block B from A account .\u003cbr\u003e\n8.)Now try to again query \u003ca title=\"https://vk.com/dev/likes.getList\" href=\"/redirect?url=https%3A%2F%2Fvk.com%2Fdev%2Flikes.getList\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vk.com/dev/likes.getList\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the same from 3 you will find that now vk.com will not allow you ! error \u003cbr\u003e\nbut now \u003cbr\u003e\n9.)But these methods are not protected === \u0026gt; Visit now  \u003ca title=\"https://vk.com/dev/likes.isLiked\" href=\"/redirect?url=https%3A%2F%2Fvk.com%2Fdev%2Flikes.isLiked\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vk.com/dev/likes.isLiked\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  and now put the owner_id=[307---], item_id=36 , user_id of the guy to which you have to check whether he has liked or not the media  and this time their is no error and vk.com will show liked : 1 \u003c/p\u003e\n\n\u003cp\u003eHence no where in the application this information is being disclosed but here is the end point leaking the information \u003cbr\u003e\nraj_v\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-25T18:42:26.139Z","allow_singular_disclosure_after":-145013639.83249757,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mandeepkapoor","vraj","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":880781,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report. We will investigate this issue and write you back.","markdown_message":"\u003cp\u003eThank you for the report. We will investigate this issue and write you back.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-31T21:16:37.800Z","updated_at":"2016-03-31T21:16:37.800Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":918493,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed, check it, please.","markdown_message":"\u003cp\u003eFixed, check it, please.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-20T19:02:41.569Z","updated_at":"2016-04-20T19:02:41.569Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"vraj","url":"/vraj"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":920058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @exe looks good ! what about bounty ? \nRegards \nvishwa\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/exe\"\u003e@exe\u003c/a\u003e looks good ! what about bounty ? \u003cbr\u003e\nRegards \u003cbr\u003e\nvishwa\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T11:30:17.518Z","updated_at":"2016-04-21T11:30:17.518Z","actor":{"username":"vraj","cleared":false,"url":"/vraj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/434/bb73406127ae2923dcedc4c1d9cafe6362f534a9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":926645,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-25T17:47:31.068Z","updated_at":"2016-04-25T17:47:31.068Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"vraj","url":"/vraj"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":926782,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"thanks @exe for the bounty ","markdown_message":"\u003cp\u003ethanks \u003ca href=\"/exe\"\u003e@exe\u003c/a\u003e for the bounty \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-25T18:42:26.076Z","updated_at":"2016-04-25T18:42:26.076Z","first_to_agree":true,"actor":{"username":"vraj","cleared":false,"url":"/vraj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/434/bb73406127ae2923dcedc4c1d9cafe6362f534a9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":983608,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-25T18:42:36.428Z","updated_at":"2016-05-25T18:42:36.428Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}