{"id":150018,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTAwMTg=","url":"https://hackerone.com/reports/150018","title":"Full Path Disclosure by removing CSRF token","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-07-08T14:38:36.558Z","submitted_at":"2016-07-08T14:38:36.558Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"velby","url":"/velby","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-08T15:13:02.182Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-07-08T14:55:13.806Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, you can get an error and full path disclosure by following these steps:\non any user generated POST request (such as during login, or changing user data) remove the CSRF token from the post request entirely. For example, on the login POST request,\n\n_CSRF_TOKEN=WqXB7vmysdM06gBarWZiNfnZ%3AOMznb0rVagzWr41P_h_N2Qj50LwPV2HZxKyJxR17lB6b\u0026username=zrgzrgzerg\u0026passphrase=sergsergsergrg\u0026two_factor=\n\nBecomes\n\nusername=zrgzrgzerg\u0026passphrase=sergsergsergrg\u0026two_factor=\n\nWe get the following error with a full path disclosure:\n\n\u003cbr /\u003e\n\u003cb\u003eNotice\u003c/b\u003e:  Undefined variable: ex in \u003cb\u003e/var/www/csprng/src/public/index.php\u003c/b\u003e on line \u003cb\u003e160\u003c/b\u003e\u003cbr /\u003e\n\u003cbr /\u003e\n\u003cb\u003eFatal error\u003c/b\u003e:  Uncaught Error: Call to a member function getMessage() on null in /var/www/csprng/src/public/index.php:160\nStack trace:\n0 {main}\n  thrown in \u003cb\u003e/var/www/csprng/src/public/index.php\u003c/b\u003e on line \u003cb\u003e160\u003c/b\u003e\u003cbr /\u003e\n","vulnerability_information_html":"\u003cp\u003eHello, you can get an error and full path disclosure by following these steps:\u003cbr\u003e\non any user generated POST request (such as during login, or changing user data) remove the CSRF token from the post request entirely. For example, on the login POST request,\u003c/p\u003e\n\n\u003cp\u003e_CSRF_TOKEN=WqXB7vmysdM06gBarWZiNfnZ%3AOMznb0rVagzWr41P_h_N2Qj50LwPV2HZxKyJxR17lB6b\u0026amp;username=zrgzrgzerg\u0026amp;passphrase=sergsergsergrg\u0026amp;two_factor=\u003c/p\u003e\n\n\u003cp\u003eBecomes\u003c/p\u003e\n\n\u003cp\u003eusername=zrgzrgzerg\u0026amp;passphrase=sergsergsergrg\u0026amp;two_factor=\u003c/p\u003e\n\n\u003cp\u003eWe get the following error with a full path disclosure:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;br /\u0026gt;\u003cbr\u003e\n\u0026lt;b\u0026gt;Notice\u0026lt;/b\u0026gt;:  Undefined variable: ex in \u0026lt;b\u0026gt;/var/www/csprng/src/public/index.php\u0026lt;/b\u0026gt; on line \u0026lt;b\u0026gt;160\u0026lt;/b\u0026gt;\u0026lt;br /\u0026gt;\u003cbr\u003e\n\u0026lt;br /\u0026gt;\u003cbr\u003e\n\u0026lt;b\u0026gt;Fatal error\u0026lt;/b\u0026gt;:  Uncaught Error: Call to a member function getMessage() on null in /var/www/csprng/src/public/index.php:160\u003cbr\u003e\nStack trace:\u003cbr\u003e\n0 {main}\u003cbr\u003e\n  thrown in \u0026lt;b\u0026gt;/var/www/csprng/src/public/index.php\u0026lt;/b\u0026gt; on line \u0026lt;b\u0026gt;160\u0026lt;/b\u0026gt;\u0026lt;br /\u0026gt;\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["martijn","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1059637,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"There's definitely a bug here, which I will promptly fix, but not a vulnerability.\n\nTo clarify: I generally don't consider \"full path disclosure\" to be a *security vulnerability* in and of itself. They can be useful with a vulnerability (i.e. SQLi + FPD + `INTO OUTFILE` = reverse shell), but don't really give an attacker much that they couldn't infer from trial and error.\n\nI almost always use some variant of `/var/www/projectname/public_html` for document roots. In CSPR.NG's case, it's `/var/www/csprng/src/public`. Our company's website is in `/var/www/paragonie/public`. And so on)\n\nThis bug is only going to be triggered by debug mode being enabled (which it is, on CSPR.NG). Even without the existence of this bug, the full path disclosure is still going to happen from the debug mode stack trace caused by the exception being thrown.\n\nWhen debug mode is off, the exception isn't thrown. Instead, the `$this-\u003epost()` call simply returns false and the POST data is ignored completely.\n\nThanks for taking the time to poke around Airship.","markdown_message":"\u003cp\u003eThere\u0026#39;s definitely a bug here, which I will promptly fix, but not a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eTo clarify: I generally don\u0026#39;t consider \u0026quot;full path disclosure\u0026quot; to be a \u003cem\u003esecurity vulnerability\u003c/em\u003e in and of itself. They can be useful with a vulnerability (i.e. SQLi + FPD + \u003ccode\u003eINTO OUTFILE\u003c/code\u003e = reverse shell), but don\u0026#39;t really give an attacker much that they couldn\u0026#39;t infer from trial and error.\u003c/p\u003e\n\n\u003cp\u003eI almost always use some variant of \u003ccode\u003e/var/www/projectname/public_html\u003c/code\u003e for document roots. In CSPR.NG\u0026#39;s case, it\u0026#39;s \u003ccode\u003e/var/www/csprng/src/public\u003c/code\u003e. Our company\u0026#39;s website is in \u003ccode\u003e/var/www/paragonie/public\u003c/code\u003e. And so on)\u003c/p\u003e\n\n\u003cp\u003eThis bug is only going to be triggered by debug mode being enabled (which it is, on CSPR.NG). Even without the existence of this bug, the full path disclosure is still going to happen from the debug mode stack trace caused by the exception being thrown.\u003c/p\u003e\n\n\u003cp\u003eWhen debug mode is off, the exception isn\u0026#39;t thrown. Instead, the \u003ccode\u003e$this-\u0026gt;post()\u003c/code\u003e call simply returns false and the POST data is ignored completely.\u003c/p\u003e\n\n\u003cp\u003eThanks for taking the time to poke around Airship.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T14:55:08.237Z","updated_at":"2016-07-08T14:55:08.237Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1059638,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T14:55:13.843Z","updated_at":"2016-07-08T14:55:13.843Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1059686,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T15:13:02.109Z","updated_at":"2016-07-08T15:13:02.109Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1059723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup I agree, glad I could help, I'll poke around a bit more if I have the time","markdown_message":"\u003cp\u003eYup I agree, glad I could help, I\u0026#39;ll poke around a bit more if I have the time\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T15:27:14.590Z","updated_at":"2016-07-08T15:27:14.590Z","actor":{"username":"velby","cleared":false,"url":"/velby","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}