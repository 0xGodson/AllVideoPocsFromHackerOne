{"id":460928,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjA5Mjg=","url":"https://hackerone.com/reports/460928","title":"Line feed injection in get request leads AWS S3 Bucket information disclosure ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-12T02:52:23.638Z","submitted_at":"2018-12-12T02:52:23.638Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"aty","url":"/aty","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":26860,"url":"https://hackerone.com/ratelimited","handle":"ratelimited","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/026/860/4c9a902446bc9aa57b82156df4b7e358bdecd727_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/026/860/4c9a902446bc9aa57b82156df4b7e358bdecd727_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RATELIMITED","twitter_handle":"RATELIMITEDME","website":"https://ratelimited.me","about":"RATELIMITED is an opensource, no-bullshit file hosting service"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-01-14T08:47:33.843Z","bug_reporter_agreed_on_going_public_at":"2019-01-14T08:43:33.760Z","team_member_agreed_on_going_public_at":"2019-01-14T08:47:33.758Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nBy added line feed control character to the end of url https://ratelimited.me/migration/\nit is possible to list elements of bucket name \"████████\" , also it is possible to view source code of any php file in the bucket such as the php file with key \"██████████\" which is the \"URIDefinition.php\" from the open source HTMLPurifier , so no sensitive source code disclosure here unless this bucket directory contain sensitive .php files other than the HTMLPurifier library . \n\n**Description:** \nThere seems to be an ACL misconfiguration with a bucket name \"█████\" that can be listed by issuing a GET request to https://ratelimited.me/migration/%0A/  , the response will return  XML document that list the content of this bucket , i tried to see if i can acces some of the files listed in the bucket but it seems the request append .php to any name after the  \"%0A/\" soo the only files i can access are php files such as the one from this link  https://ratelimited.me/migration/%0a/00f776  , it is also possible to issue some limited S3 REST requests such as https://ratelimited.me/migration/%0A/?location  which will show the AWS region of the bucket [according to aws documentation this should be only allowed to bucket owner https://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETlocation.html ], also \"PUT\" and \"POST\" are not allowed so attacker can  not change the content of the bucket \n\nAlso note that the bucket list that return from the GET request is limited to 1000 but we can view all the files using the last elements as a marker to view the next 1000 elements https://ratelimited.me/migration/%0A/?marker=02ff70.png\n## Steps To Reproduce:\nopen the provided links in any browser \n\nhttps://ratelimited.me/migration/%0A/ \n https://ratelimited.me/migration/%0a/00f776\nhttps://ratelimited.me/migration/%0A/?location \nhttps://ratelimited.me/migration/%0A/?marker=02ff70.png\n\n## Impact\n\nAttacker can list the content of AWS S3 bucket list \"███\" and read the content of any .php file inside","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nBy added line feed control character to the end of url \u003ca title=\"https://ratelimited.me/migration/\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nit is possible to list elements of bucket name \u0026quot;████████\u0026quot; , also it is possible to view source code of any php file in the bucket such as the php file with key \u0026quot;██████████\u0026quot; which is the \u0026quot;URIDefinition.php\u0026quot; from the open source HTMLPurifier , so no sensitive source code disclosure here unless this bucket directory contain sensitive .php files other than the HTMLPurifier library . \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nThere seems to be an ACL misconfiguration with a bucket name \u0026quot;█████\u0026quot; that can be listed by issuing a GET request to \u003ca title=\"https://ratelimited.me/migration/%0A/\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  , the response will return  XML document that list the content of this bucket , i tried to see if i can acces some of the files listed in the bucket but it seems the request append .php to any name after the  \u0026quot;%0A/\u0026quot; soo the only files i can access are php files such as the one from this link  \u003ca title=\"https://ratelimited.me/migration/%0a/00f776\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250a%2F00f776\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0a/00f776\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  , it is also possible to issue some limited S3 REST requests such as \u003ca title=\"https://ratelimited.me/migration/%0A/?location\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F%3Flocation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/?location\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  which will show the AWS region of the bucket [according to aws documentation this should be only allowed to bucket owner \u003ca title=\"https://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETlocation.html\" href=\"/redirect?url=https%3A%2F%2Fdocs.aws.amazon.com%2FAmazonS3%2Flatest%2FAPI%2FRESTBucketGETlocation.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETlocation.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ], also \u0026quot;PUT\u0026quot; and \u0026quot;POST\u0026quot; are not allowed so attacker can  not change the content of the bucket \u003c/p\u003e\n\n\u003cp\u003eAlso note that the bucket list that return from the GET request is limited to 1000 but we can view all the files using the last elements as a marker to view the next 1000 elements \u003ca title=\"https://ratelimited.me/migration/%0A/?marker=02ff70.png\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F%3Fmarker%3D02ff70.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/?marker=02ff70.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eopen the provided links in any browser \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://ratelimited.me/migration/%0A/\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\n \u003ca title=\"https://ratelimited.me/migration/%0a/00f776\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250a%2F00f776\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0a/00f776\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://ratelimited.me/migration/%0A/?location\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F%3Flocation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/?location\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\n\u003ca title=\"https://ratelimited.me/migration/%0A/?marker=02ff70.png\" href=\"/redirect?url=https%3A%2F%2Fratelimited.me%2Fmigration%2F%250A%2F%3Fmarker%3D02ff70.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ratelimited.me/migration/%0A/?marker=02ff70.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can list the content of AWS S3 bucket list \u0026quot;███\u0026quot; and read the content of any .php file inside\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-02-13T08:43:33.839Z","allow_singular_disclosure_after":-59174269.98812731,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mygf","exadmin","snork","reppie"],"severity":{"rating":"medium","score":6.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":8576,"asset_type":"URL","asset_identifier":"ratelimited.me","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3811847,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @aty,\n\nThank you for reporting this to us.\n\nThe bucket named \"███\" contains user uploads to the file hosting service (ratelimited.me).\n\nThis is extremely unexpected behavior, and has to do with our migration form loading PHP files from the backend in order to make it as seamless as possible.\n\nWe'll be patching this issue in the next days (We have quite a lot of reports to respond to, and this is probably the most severe one).\n\nRegards,\nGeorge","markdown_message":"\u003cp\u003eHello \u003ca href=\"/aty\"\u003e@aty\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this to us.\u003c/p\u003e\n\n\u003cp\u003eThe bucket named \u0026quot;███\u0026quot; contains user uploads to the file hosting service (ratelimited.me).\u003c/p\u003e\n\n\u003cp\u003eThis is extremely unexpected behavior, and has to do with our migration form loading PHP files from the backend in order to make it as seamless as possible.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be patching this issue in the next days (We have quite a lot of reports to respond to, and this is probably the most severe one).\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nGeorge\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-12T09:17:55.379Z","updated_at":"2019-01-14T08:47:25.348Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3812054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you , that is great response time \n\nYes i agree this is weird behavior and am curious what is triggering it , i wanted to see if i could access files other than \".php\" but i think i will stop testing since this bucket contain user data.","markdown_message":"\u003cp\u003eThank you , that is great response time \u003c/p\u003e\n\n\u003cp\u003eYes i agree this is weird behavior and am curious what is triggering it , i wanted to see if i could access files other than \u0026quot;.php\u0026quot; but i think i will stop testing since this bucket contain user data.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-12T10:03:24.212Z","updated_at":"2018-12-12T10:03:24.212Z","actor":{"username":"aty","cleared":false,"url":"/aty","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3884768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there @aty,\n\nJust updating you on the situation, I have yet to find any clues as to what might be causing this.\n\nThe migration system will soon be dropped, as we're working on a rewrite of RLAuth, once that is done, I'll be marking this as resolved, unless you'd like to mark it right now. The issue has been logged into Jira, and as such, it's being tracked internally anyways.\n\nRegards,\nGeorge","markdown_message":"\u003cp\u003eHi there \u003ca href=\"/aty\"\u003e@aty\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eJust updating you on the situation, I have yet to find any clues as to what might be causing this.\u003c/p\u003e\n\n\u003cp\u003eThe migration system will soon be dropped, as we\u0026#39;re working on a rewrite of RLAuth, once that is done, I\u0026#39;ll be marking this as resolved, unless you\u0026#39;d like to mark it right now. The issue has been logged into Jira, and as such, it\u0026#39;s being tracked internally anyways.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nGeorge\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-23T22:24:48.569Z","updated_at":"2018-12-23T22:24:48.569Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3885361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thank you for the update , it is ok .. please mark it in the time appropriate for you ","markdown_message":"\u003cp\u003ethank you for the update , it is ok .. please mark it in the time appropriate for you \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T06:48:29.415Z","updated_at":"2018-12-24T06:48:29.415Z","actor":{"username":"aty","cleared":false,"url":"/aty","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3930001,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Recreating the Jira issue.\n\nWe've begun the development of the new authentication system which will not require this system. We've taken down the current system for a redesign, and we're in the works of fixing this.\n\nRegards,\nGeorge","markdown_message":"\u003cp\u003eRecreating the Jira issue.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve begun the development of the new authentication system which will not require this system. We\u0026#39;ve taken down the current system for a redesign, and we\u0026#39;re in the works of fixing this.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nGeorge\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-05T22:03:16.992Z","updated_at":"2019-01-05T22:03:16.992Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3971347,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey there @aty,\n\nI've taken down the migration system.\n\nResolved.\n\nRegards,\nGeorge","markdown_message":"\u003cp\u003eHey there \u003ca href=\"/aty\"\u003e@aty\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve taken down the migration system.\u003c/p\u003e\n\n\u003cp\u003eResolved.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nGeorge\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-14T08:34:16.169Z","updated_at":"2019-01-14T08:34:16.169Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"aty","url":"/aty"},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3971437,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Ok , it seems fixed now ..would you mind disclosing this one ?","markdown_message":"\u003cp\u003eOk , it seems fixed now ..would you mind disclosing this one ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-14T08:43:33.797Z","updated_at":"2019-01-14T08:43:33.797Z","first_to_agree":true,"actor":{"username":"aty","cleared":false,"url":"/aty","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3971455,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-14T08:47:33.798Z","updated_at":"2019-01-14T08:47:33.798Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3971456,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-14T08:47:33.864Z","updated_at":"2019-01-14T08:47:33.864Z","actor":{"username":"gtsatsis","cleared":false,"url":"/gtsatsis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/794/509e8b2bd2d59072a802056225f8baee5090135c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ratelimited","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}