{"id":124976,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjQ5NzY=","url":"https://hackerone.com/reports/124976","title":"Hijacking user session by forcing the use of  invalid HTTPs Certificate on images.gratipay.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-03-22T15:29:48.050Z","submitted_at":"2016-03-22T15:29:48.050Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ashesh","url":"/ashesh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-01T16:34:06.349Z","bug_reporter_agreed_on_going_public_at":"2016-04-01T16:34:05.996Z","team_member_agreed_on_going_public_at":"2016-04-01T16:33:02.031Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found that the domain images.gratipay.com is just a reverse proxy for gratipay.com and **HTTPS** works throughtout the site flawlessly except in one case, that it when we try to open user's profile:\n\nPOC: https://images.gratipay.com/~asdlfz/\n\nHttps Warning Page: http://i.imgur.com/XHsXJEvr.png?1\n\n\n**Risks**\n\nAny user browsing the page is under direct man-in-middle attack, as Https is being not implemented properly, The session data can be easily decrepted via any end point.\n\nFor new user's it might result like first impression of the site is an invalid https certificate and plus the warning Chrome gives is way more horrifying:\n\n\u003eAttackers might be trying to steal your information from images.gratipay.com (for example, passwords, messages, or credit cards).\n\nThe user might never dare to open even gratipay.com ever.\n\n\n**Fix**\nAdd a valid Certificate across `images.gratipay.com` or remove the domain at all.","vulnerability_information_html":"\u003cp\u003eI found that the domain images.gratipay.com is just a reverse proxy for gratipay.com and \u003cstrong\u003eHTTPS\u003c/strong\u003e works throughtout the site flawlessly except in one case, that it when we try to open user\u0026#39;s profile:\u003c/p\u003e\n\n\u003cp\u003ePOC: \u003ca title=\"https://images.gratipay.com/~asdlfz/\" href=\"/redirect?url=https%3A%2F%2Fimages.gratipay.com%2F~asdlfz%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://images.gratipay.com/~asdlfz/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHttps Warning Page: \u003ca title=\"http://i.imgur.com/XHsXJEvr.png?1\" href=\"/redirect?url=http%3A%2F%2Fi.imgur.com%2FXHsXJEvr.png%3F1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://i.imgur.com/XHsXJEvr.png?1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRisks\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAny user browsing the page is under direct man-in-middle attack, as Https is being not implemented properly, The session data can be easily decrepted via any end point.\u003c/p\u003e\n\n\u003cp\u003eFor new user\u0026#39;s it might result like first impression of the site is an invalid https certificate and plus the warning Chrome gives is way more horrifying:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAttackers might be trying to steal your information from images.gratipay.com (for example, passwords, messages, or credit cards).\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe user might never dare to open even gratipay.com ever.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix\u003c/strong\u003e\u003cbr\u003e\nAdd a valid Certificate across \u003ccode\u003eimages.gratipay.com\u003c/code\u003e or remove the domain at all.\u003c/p\u003e\n","bounty_amount":"1.0","formatted_bounty":"$1","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-01T16:33:02.224Z","allow_singular_disclosure_after":-147095351.53638646,"singular_disclosure_allowed":true,"vote_count":3,"voters":["spetr0x","dyabla","hackeroneanonymous"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":882941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @ashesh, looking into this ...","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/ashesh\"\u003e@ashesh\u003c/a\u003e, looking into this ...\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T15:42:08.477Z","updated_at":"2016-04-01T15:42:08.477Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":882972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm pretty sure we're not actually using `images.gratipay.com` and it should be removed. DNS is a CNAME for MaxCDN, but we didn't end up [using a CDN](https://github.com/gratipay/gratipay.com/issues/3777) when we rolled out avatars.","markdown_message":"\u003cp\u003eI\u0026#39;m pretty sure we\u0026#39;re not actually using \u003ccode\u003eimages.gratipay.com\u003c/code\u003e and it should be removed. DNS is a CNAME for MaxCDN, but we didn\u0026#39;t end up \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fissues%2F3777\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eusing a CDN\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e when we rolled out avatars.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T15:54:45.657Z","updated_at":"2016-04-01T15:55:21.695Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":882997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537 If the domain is no longer used, its recommend that it should be removed. Browser will recognise it as a part of Gratipay and doesn't care if the DNS is just a cname for another CDN. Hackers will still be able to compromise sessions.","markdown_message":"\u003cp\u003e\u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e If the domain is no longer used, its recommend that it should be removed. Browser will recognise it as a part of Gratipay and doesn\u0026#39;t care if the DNS is just a cname for another CDN. Hackers will still be able to compromise sessions.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:04:09.557Z","updated_at":"2016-04-01T16:04:09.557Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, reviewing the [Team images PR](https://github.com/gratipay/gratipay.com/pull/3750), it looks like I started configuring a CDN at `images.gratipay.com` but didn't finish, so the correct action here is to remove this domain. I've deleted the `images` pull zone at MaxCDN (we won't be able to use that name again), and I've deleted the CNAME for `images.gratipay.com` in DNS.","markdown_message":"\u003cp\u003eYeah, reviewing the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fpull%2F3750\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eTeam images PR\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, it looks like I started configuring a CDN at \u003ccode\u003eimages.gratipay.com\u003c/code\u003e but didn\u0026#39;t finish, so the correct action here is to remove this domain. I\u0026#39;ve deleted the \u003ccode\u003eimages\u003c/code\u003e pull zone at MaxCDN (we won\u0026#39;t be able to use that name again), and I\u0026#39;ve deleted the CNAME for \u003ccode\u003eimages.gratipay.com\u003c/code\u003e in DNS.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:30:01.771Z","updated_at":"2016-04-01T16:30:01.771Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that the issue is fixed as the domain images.gratipay.com is no longer accessible.","markdown_message":"\u003cp\u003eI can confirm that the issue is fixed as the domain images.gratipay.com is no longer accessible.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:32:05.835Z","updated_at":"2016-04-01T16:32:05.835Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Classifying as theoretical risk since it depends on MITM + phishing (sending a user to the unsecured proxy) to be actual. Awarding $1 per [our policy](https://hackerone.com/gratipay).","markdown_message":"\u003cp\u003eClassifying as theoretical risk since it depends on MITM + phishing (sending a user to the unsecured proxy) to be actual. Awarding $1 per \u003ca href=\"https://hackerone.com/gratipay\"\u003eour policy\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:32:18.549Z","updated_at":"2016-04-01T16:32:18.549Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883093,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T16:32:30.297Z","updated_at":"2016-04-01T16:32:30.297Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"bounty_amount":"1.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"ashesh","url":"/ashesh"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883096,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report! :-)","markdown_message":"\u003cp\u003eThanks for the report! :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:32:50.180Z","updated_at":"2016-04-01T16:32:50.180Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ashesh","url":"/ashesh"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883097,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T16:33:02.062Z","updated_at":"2016-04-01T16:33:02.062Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883101,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Glad to see the issue fixed, thanks for the bounty ;)","markdown_message":"\u003cp\u003eGlad to see the issue fixed, thanks for the bounty ;)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T16:34:06.056Z","updated_at":"2016-04-01T16:34:06.056Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883102,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T16:34:06.398Z","updated_at":"2016-04-01T16:34:06.398Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340054,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-04T18:30:40.476Z","updated_at":"2016-12-04T18:30:40.476Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":11520},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}