{"id":593712,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTM3MTI=","url":"https://hackerone.com/reports/593712","title":"Web cache deception attack on https://open.vanillaforums.com/messages/all","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-01T17:27:25.602Z","submitted_at":"2019-06-01T17:27:25.602Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ronr","url":"/ronr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-01T09:07:54.583Z","bug_reporter_agreed_on_going_public_at":"2019-11-01T09:07:41.379Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have found a Vulnerability in vanilla forums which called Web cache deception attack.\n\n#Web Cache Deception Attack\nWebsites often tend to use web cache functionality to store files that are often retrieved, to reduce latency from the web server.\n\nWebsites often tend to use web cache functionality (for example over a CDN, a load balancer, or simply a reverse proxy). The purpose is simple: store files that are often retrieved, to reduce latency from the web server.\nWhen accessing a URL like http://www.example.com/home.php/non-existent.css\nA GET request to that URL will be produced by the browser.  The server returns the content of http://www.example.com/home.php. And yes, the URL remains http://www.example.com/home.php/non-existent.css. The HTTP headers will be the same as for accessing http://www.example.com/home.php directly: same caching headers and same content type (text/html, in this case).\nThe web cache servre saves the returned page in the server's cache. Then the attacker can go to the url: http://www.example.com/home.php/non-existent.css and the page of the victim will be presented with the victim's sensitive information (The page content).\n\nThe dangerous part in this attack, unlike phishing attacks, is that the url isn't looks suspicious at all.  It looks like a normal url from the original website, so the victim thinks that it is ok to click on the link.\n\nSteps:\n1. The attacker sends the following link to the victim: https://open.vanillaforums.com/messages/all/non-existent.css\n2. The victim opens the link and the inbox page will be loaded normally. (The web cache server then saves this page)\n3. The attacker open the same link (https://open.vanillaforums.com/messages/all/non-existent.css), and the inbox page of the victim with all his private contant is loaded.\n\nIf you need a video to understand it better, ask me and I will send you one.\n\n## Impact\n\nThe attacker can achieve all the private content of a specific victim, without the victim knowing about it.","vulnerability_information_html":"\u003cp\u003eI have found a Vulnerability in vanilla forums which called Web cache deception attack.\u003c/p\u003e\n\n\u003ch1 id=\"web-cache-deception-attack\"\u003eWeb Cache Deception Attack\u003c/h1\u003e\n\n\u003cp\u003eWebsites often tend to use web cache functionality to store files that are often retrieved, to reduce latency from the web server.\u003c/p\u003e\n\n\u003cp\u003eWebsites often tend to use web cache functionality (for example over a CDN, a load balancer, or simply a reverse proxy). The purpose is simple: store files that are often retrieved, to reduce latency from the web server.\u003cbr\u003e\nWhen accessing a URL like \u003ca title=\"http://www.example.com/home.php/non-existent.css\" href=\"/redirect?url=http%3A%2F%2Fwww.example.com%2Fhome.php%2Fnon-existent.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.example.com/home.php/non-existent.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nA GET request to that URL will be produced by the browser.  The server returns the content of \u003ca title=\"http://www.example.com/home.php\" href=\"/redirect?url=http%3A%2F%2Fwww.example.com%2Fhome.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.example.com/home.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. And yes, the URL remains \u003ca title=\"http://www.example.com/home.php/non-existent.css\" href=\"/redirect?url=http%3A%2F%2Fwww.example.com%2Fhome.php%2Fnon-existent.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.example.com/home.php/non-existent.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The HTTP headers will be the same as for accessing \u003ca title=\"http://www.example.com/home.php\" href=\"/redirect?url=http%3A%2F%2Fwww.example.com%2Fhome.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.example.com/home.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e directly: same caching headers and same content type (text/html, in this case).\u003cbr\u003e\nThe web cache servre saves the returned page in the server\u0026#39;s cache. Then the attacker can go to the url: \u003ca title=\"http://www.example.com/home.php/non-existent.css\" href=\"/redirect?url=http%3A%2F%2Fwww.example.com%2Fhome.php%2Fnon-existent.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.example.com/home.php/non-existent.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and the page of the victim will be presented with the victim\u0026#39;s sensitive information (The page content).\u003c/p\u003e\n\n\u003cp\u003eThe dangerous part in this attack, unlike phishing attacks, is that the url isn\u0026#39;t looks suspicious at all.  It looks like a normal url from the original website, so the victim thinks that it is ok to click on the link.\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe attacker sends the following link to the victim: \u003ca title=\"https://open.vanillaforums.com/messages/all/non-existent.css\" href=\"/redirect?url=https%3A%2F%2Fopen.vanillaforums.com%2Fmessages%2Fall%2Fnon-existent.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://open.vanillaforums.com/messages/all/non-existent.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eThe victim opens the link and the inbox page will be loaded normally. (The web cache server then saves this page)\u003c/li\u003e\n\u003cli\u003eThe attacker open the same link (\u003ca title=\"https://open.vanillaforums.com/messages/all/non-existent.css\" href=\"/redirect?url=https%3A%2F%2Fopen.vanillaforums.com%2Fmessages%2Fall%2Fnon-existent.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://open.vanillaforums.com/messages/all/non-existent.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), and the inbox page of the victim with all his private contant is loaded.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIf you need a video to understand it better, ask me and I will send you one.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can achieve all the private content of a specific victim, without the victim knowing about it.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-12-01T09:07:41.440Z","allow_singular_disclosure_after":-34032085.578159936,"singular_disclosure_allowed":true,"vote_count":43,"voters":["spam404","mik317","sameerphad72","mygf","tulswani","aryan2808","ronr","eveeez","dmc3","sudi","and 33 more..."],"severity":{"rating":"medium","score":4.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":2101,"asset_type":"URL","asset_identifier":"*.vanillaforums.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4982579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":".","markdown_message":"\u003cp\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-03T15:04:48.848Z","updated_at":"2019-06-03T15:07:26.412Z","actor":{"username":"alex-vf","cleared":false,"url":"/alex-vf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4982656,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-03T15:10:38.082Z","updated_at":"2019-06-03T15:10:38.082Z","additional_data":{"old_severity":"High","new_severity":"Medium (4.3)","old_severity_id":405990,"new_severity_id":408495},"actor":{"username":"alex-vf","cleared":false,"url":"/alex-vf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4982680,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Howdy, thanks for submitting this issue. This has been triaged as a legitimate exploit by a developer on our team and we'll prepare a patch for future release.","markdown_message":"\u003cp\u003eHowdy, thanks for submitting this issue. This has been triaged as a legitimate exploit by a developer on our team and we\u0026#39;ll prepare a patch for future release.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-03T15:14:55.452Z","updated_at":"2019-06-03T15:14:55.452Z","actor":{"username":"alex-vf","cleared":false,"url":"/alex-vf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4982927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much, happy to help!","markdown_message":"\u003cp\u003eThank you very much, happy to help!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-03T15:56:22.593Z","updated_at":"2019-06-03T15:56:22.593Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4995836,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-04T19:01:55.712Z","updated_at":"2019-06-04T19:01:55.712Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"ronr","url":"/ronr"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5144826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I saw that the problem was fixed. Can we close this report?","markdown_message":"\u003cp\u003eI saw that the problem was fixed. Can we close this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-20T09:21:10.385Z","updated_at":"2019-06-20T09:21:10.385Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5201570,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its been a week since I wrote to you and you didn't replay to me... Anything new with the case?","markdown_message":"\u003cp\u003eIts been a week since I wrote to you and you didn\u0026#39;t replay to me... Anything new with the case?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T19:19:54.371Z","updated_at":"2019-06-26T19:19:54.371Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5546159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Team, any updates?","markdown_message":"\u003cp\u003eHey Team, any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-10T20:17:03.617Z","updated_at":"2019-08-10T20:17:03.617Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6102330,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"5 months passed and the vulnerability is not longer exist. Can you resolve and disclose the report?\nRegards,\nRon","markdown_message":"\u003cp\u003e5 months passed and the vulnerability is not longer exist. Can you resolve and disclose the report?\u003cbr\u003e\nRegards,\u003cbr\u003e\nRon\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-22T05:18:50.709Z","updated_at":"2019-10-22T05:18:50.709Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6108337,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-22T16:34:20.653Z","updated_at":"2019-10-22T16:34:20.653Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ronr","url":"/ronr"},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6108366,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, Can we disclose the report?","markdown_message":"\u003cp\u003eGreat, Can we disclose the report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-22T16:39:39.757Z","updated_at":"2019-10-22T16:39:39.757Z","actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6191393,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-01T09:07:41.402Z","updated_at":"2019-11-01T09:07:41.402Z","first_to_agree":true,"actor":{"username":"ronr","cleared":false,"url":"/ronr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/474/352/6b04113b238585a16a4423f7e15ffc268adbd4f4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6440833,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-01T09:07:54.614Z","updated_at":"2019-12-01T09:07:54.614Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}