{"id":163464,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM0NjQ=","url":"https://hackerone.com/reports/163464","title":"User Information sent to client through websockets","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-26T02:16:20.127Z","submitted_at":"2016-08-26T02:16:20.127Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-12T18:47:42.285Z","bug_reporter_agreed_on_going_public_at":"2016-08-31T23:18:51.789Z","team_member_agreed_on_going_public_at":"2016-09-12T18:47:42.220Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey,\n\nI noticed when monitoring the websocket requests that the account information of many users, including email address, is sent to the client. For example:\n\n```\n██████\n\n██████████\n\n█████████\n\n████████\n\n███████\n\n```\n\nThere's hundreds of these requests, each containing user information. Please let me know if this is meant to be happening, but I didn't see a list of users on the site.","vulnerability_information_html":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eI noticed when monitoring the websocket requests that the account information of many users, including email address, is sent to the client. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e██████\n\n██████████\n\n█████████\n\n████████\n\n███████\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThere\u0026#39;s hundreds of these requests, each containing user information. Please let me know if this is meant to be happening, but I didn\u0026#39;t see a list of users on the site.\u003c/p\u003e\n","bounty_amount":"120.0","formatted_bounty":"$120","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-30T23:18:51.882Z","allow_singular_disclosure_after":-133939135.30850707,"singular_disclosure_allowed":true,"vote_count":8,"voters":["spam404","cablej","ysx","eveeez","its_afolic","spetr0x","mohamedakees99","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1155010,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"No, that is certainly not intended behavior.\nTriaging this as critical.","markdown_message":"\u003cp\u003eNo, that is certainly not intended behavior.\u003cbr\u003e\nTriaging this as critical.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:20:34.410Z","updated_at":"2016-08-26T02:20:34.410Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the speedy response :)\n\nThis is quite an odd issue, I'd be curious to hear why it was happening.","markdown_message":"\u003cp\u003eThanks for the speedy response :)\u003c/p\u003e\n\n\u003cp\u003eThis is quite an odd issue, I\u0026#39;d be curious to hear why it was happening.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:23:39.888Z","updated_at":"2016-08-26T02:27:32.410Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem, we just publicly launched the program, so we're keeping an eye out for new reports. When we see an issue like this, we have to jump on it quick. Thanks for spotting this!\n\nSome background on the issue: we use a javascript framework called Meteor. In Meteor, data is sent to clients via websockets through publishing/subscribing. The server side rules for our publish method for the Users collection was overly broad and we were publishing everything. This should have been restricted to admin users only. So, we've put in the fix and our continuous integration build is running now. The issue should be patched in about 4-5 minutes.","markdown_message":"\u003cp\u003eNo problem, we just publicly launched the program, so we\u0026#39;re keeping an eye out for new reports. When we see an issue like this, we have to jump on it quick. Thanks for spotting this!\u003c/p\u003e\n\n\u003cp\u003eSome background on the issue: we use a javascript framework called Meteor. In Meteor, data is sent to clients via websockets through publishing/subscribing. The server side rules for our publish method for the Users collection was overly broad and we were publishing everything. This should have been restricted to admin users only. So, we\u0026#39;ve put in the fix and our continuous integration build is running now. The issue should be patched in about 4-5 minutes.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:30:08.759Z","updated_at":"2016-08-26T02:30:08.759Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is also happening with document information, leaking the titles, which makes sense based on what you said. For example:\n\n```\na[\"{\\\"msg\\\":\\\"added\\\",\\\"collection\\\":\\\"Classes\\\",\\\"id\\\":\\\"bGQyCPZiduE4sFnCF\\\",\\\"fields\\\":{\\\"name\\\":\\\"Remedy\\\",\\\"type\\\":\\\"Clause Type\\\",\\\"owner\\\":\\\"X6cmDJicRtsTpP6Av\\\",\\\"createdBy\\\":\\\"X6cmDJicRtsTpP6Av\\\",\\\"policy\\\":███████\n```","markdown_message":"\u003cp\u003eThis is also happening with document information, leaking the titles, which makes sense based on what you said. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ea[\u0026quot;{\\\u0026quot;msg\\\u0026quot;:\\\u0026quot;added\\\u0026quot;,\\\u0026quot;collection\\\u0026quot;:\\\u0026quot;Classes\\\u0026quot;,\\\u0026quot;id\\\u0026quot;:\\\u0026quot;bGQyCPZiduE4sFnCF\\\u0026quot;,\\\u0026quot;fields\\\u0026quot;:{\\\u0026quot;name\\\u0026quot;:\\\u0026quot;Remedy\\\u0026quot;,\\\u0026quot;type\\\u0026quot;:\\\u0026quot;Clause Type\\\u0026quot;,\\\u0026quot;owner\\\u0026quot;:\\\u0026quot;X6cmDJicRtsTpP6Av\\\u0026quot;,\\\u0026quot;createdBy\\\u0026quot;:\\\u0026quot;X6cmDJicRtsTpP6Av\\\u0026quot;,\\\u0026quot;policy\\\u0026quot;:███████\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-08-26T02:31:20.709Z","updated_at":"2016-08-31T22:49:43.366Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155024,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, the new build is in production. Could you verify that user data is no longer coming across via WS?","markdown_message":"\u003cp\u003eOk, the new build is in production. Could you verify that user data is no longer coming across via WS?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:38:58.030Z","updated_at":"2016-08-26T02:38:58.030Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, that's probably ok. Some information on the classes and clauses should be published - we have some standard categories for documents.","markdown_message":"\u003cp\u003eYeah, that\u0026#39;s probably ok. Some information on the classes and clauses should be published - we have some standard categories for documents.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:40:14.400Z","updated_at":"2016-08-26T02:40:14.400Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, I've looked through and can verify that no more user data is coming through.","markdown_message":"\u003cp\u003eGreat, I\u0026#39;ve looked through and can verify that no more user data is coming through.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:44:04.308Z","updated_at":"2016-08-26T02:44:04.308Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155028,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Awesome - that may be the quickest bounty we've ever awarded.","markdown_message":"\u003cp\u003eAwesome - that may be the quickest bounty we\u0026#39;ve ever awarded.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:45:04.580Z","updated_at":"2016-08-26T02:45:04.580Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155029,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T02:45:25.801Z","updated_at":"2016-08-26T02:45:25.801Z","actor":{"url":"/legalrobot","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Legal Robot"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"20.0","genius_execution_id":null,"team_handle":"legalrobot","collaborator":{"username":"cablej","url":"/cablej"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1155043,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Same on my end -- thanks for the EXTREMELY fast response and the reward. So:\n\nReported at 21:16:20.\n\nResponse at 21:20 (3 minutes 40 seconds)\n\nPatch live at 21:38 (22 minutes from report)\n\nThere's gotta be a bug bounty olympics for this :)","markdown_message":"\u003cp\u003eSame on my end -- thanks for the EXTREMELY fast response and the reward. So:\u003c/p\u003e\n\n\u003cp\u003eReported at 21:16:20.\u003c/p\u003e\n\n\u003cp\u003eResponse at 21:20 (3 minutes 40 seconds)\u003c/p\u003e\n\n\u003cp\u003ePatch live at 21:38 (22 minutes from report)\u003c/p\u003e\n\n\u003cp\u003eThere\u0026#39;s gotta be a bug bounty olympics for this :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T02:56:31.843Z","updated_at":"2016-08-26T02:56:31.843Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166503,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I've contacted Hackerone and they've redacted the sensitive information.","markdown_message":"\u003cp\u003eI\u0026#39;ve contacted Hackerone and they\u0026#39;ve redacted the sensitive information.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T23:18:51.818Z","updated_at":"2016-08-31T23:18:51.818Z","first_to_agree":true,"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189313,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Excellent, thanks!","markdown_message":"\u003cp\u003eExcellent, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T18:47:42.245Z","updated_at":"2016-09-12T18:47:42.245Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1189314,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T18:47:42.340Z","updated_at":"2016-09-12T18:47:42.340Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}