{"id":421009,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjEwMDk=","url":"https://hackerone.com/reports/421009","title":"H1514 Deanonymizing Exchange Marketplace private listings  ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-08T18:54:37.086Z","submitted_at":"2018-10-08T18:54:37.086Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fisher","url":"/fisher","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CB9zcyPs2KHYbTTPjQZGuo6x/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-03-10T20:38:45.947Z","bug_reporter_agreed_on_going_public_at":"2020-03-10T20:38:45.859Z","team_member_agreed_on_going_public_at":"2020-03-10T20:32:52.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n\n[Exchange Marketplace](https://exchangemarketplace.com/) allows Shop owners to sell their business in a easy way. When placing the shop in the listings, the owner has the option to place their store as a private listing - where only stats will be displayed, and no information about the actual Shop, domain name or shop owned are visible.\n\nInspecting the source code I discovered a \u003cscript\u003e element generated by [Hypernova](https://github.com/airbnb/hypernova) which discloses the aforementioned private data:\n- Shop ID\n- Shop Owner name\n- Shop owner email\n\n## Steps To Reproduce:\n\nTo find the script, first pick a private listing e.g. [930273](https://exchangemarketplace.com/shops/e834b11e056bd114f8262d0464a512c9). Then search the DOM for a \u003cscript\u003e element containing the 'data-hypernova-key' string:\n\n {F357502} \n\nWe'll have a long JSON available containing the variables mentioned:\n\n{F357509}\n\n{F357510} \n\nThis only discloses some data, but it's enough to pinpoint what the real Shop is, using some recon.\n\nThe first method is with open intel - we have the Shop owner name and email. Most of the business will be registered in Linkedin so, a search there or using Google should be suffice to have a match.\n\nThe second method is much more reliable and can be made via multiple ways, let's describe the easiest.  Firstly, an attacker downloads a dataset of all known websites using Shopify, using something like [Wappalyzer](https://www.wappalyzer.com) or [BuiltWith](https://builtwith.com):\n\n{F357514} \n\nWith that dataset he'll fetch every page and observe the response headers, where the X-ShopId header is present:\n\n{F357515} \n\nNow the attacker would have a direct match of Shop -\u003e ShopID, thus deanonymizing the private listing. \n\nI believe it's fair to assume that if a Shop is being sold on the Marketplace it will have a decent amount of traffic. Thus, it should definitely be present in any of these available datasets.\n\n## Impact\n\nAn attacker can deanonymize private listings in Marketplace, finding out who the Shop Owner/Seller is and what is the business.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fexchangemarketplace.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eExchange Marketplace\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e allows Shop owners to sell their business in a easy way. When placing the shop in the listings, the owner has the option to place their store as a private listing - where only stats will be displayed, and no information about the actual Shop, domain name or shop owned are visible.\u003c/p\u003e\n\n\u003cp\u003eInspecting the source code I discovered a \u0026lt;script\u0026gt; element generated by \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fairbnb%2Fhypernova\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHypernova\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which discloses the aforementioned private data:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eShop ID\u003c/li\u003e\n\u003cli\u003eShop Owner name\u003c/li\u003e\n\u003cli\u003eShop owner email\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eTo find the script, first pick a private listing e.g. \u003ca href=\"/redirect?url=https%3A%2F%2Fexchangemarketplace.com%2Fshops%2Fe834b11e056bd114f8262d0464a512c9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e930273\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Then search the DOM for a \u0026lt;script\u0026gt; element containing the \u0026#39;data-hypernova-key\u0026#39; string:\u003c/p\u003e\n\n\u003cp\u003e{F357502} \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll have a long JSON available containing the variables mentioned:\u003c/p\u003e\n\n\u003cp\u003e{F357509}\u003c/p\u003e\n\n\u003cp\u003e{F357510} \u003c/p\u003e\n\n\u003cp\u003eThis only discloses some data, but it\u0026#39;s enough to pinpoint what the real Shop is, using some recon.\u003c/p\u003e\n\n\u003cp\u003eThe first method is with open intel - we have the Shop owner name and email. Most of the business will be registered in Linkedin so, a search there or using Google should be suffice to have a match.\u003c/p\u003e\n\n\u003cp\u003eThe second method is much more reliable and can be made via multiple ways, let\u0026#39;s describe the easiest.  Firstly, an attacker downloads a dataset of all known websites using Shopify, using something like \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.wappalyzer.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWappalyzer\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or \u003ca href=\"/redirect?url=https%3A%2F%2Fbuiltwith.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eBuiltWith\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\n\u003cp\u003e{F357514} \u003c/p\u003e\n\n\u003cp\u003eWith that dataset he\u0026#39;ll fetch every page and observe the response headers, where the X-ShopId header is present:\u003c/p\u003e\n\n\u003cp\u003e{F357515} \u003c/p\u003e\n\n\u003cp\u003eNow the attacker would have a direct match of Shop -\u0026gt; ShopID, thus deanonymizing the private listing. \u003c/p\u003e\n\n\u003cp\u003eI believe it\u0026#39;s fair to assume that if a Shop is being sold on the Marketplace it will have a decent amount of traffic. Thus, it should definitely be present in any of these available datasets.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can deanonymize private listings in Marketplace, finding out who the Shop Owner/Seller is and what is the business.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":28,"voters":["daehee","jr0ch17","a_d_a_m","base_64","emitrani","0xc0ffee","mygf","haxta4ok00","cyberunit","exception","and 18 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":37198,"asset_type":"OTHER","asset_identifier":"Shopify Developed Apps","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3475451,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-13T14:34:15.288Z","updated_at":"2018-10-13T14:34:15.288Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"fisher","url":"/fisher"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475505,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi [@fisher](/fisher),\n\nThanks for the report! We've addressed this on our end by removing the `users` array from that object. We decided to award you with $1000 in the middle of our information disclosure scale.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/fisher\"\u003e@fisher\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report! We\u0026#39;ve addressed this on our end by removing the \u003ccode\u003eusers\u003c/code\u003e array from that object. We decided to award you with $1000 in the middle of our information disclosure scale.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-13T14:54:37.804Z","updated_at":"2018-10-13T15:03:10.001Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fisher","url":"/fisher"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475722,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@fisher - you ok to disclose this?","markdown_message":"\u003cp\u003e\u003ca href=\"/fisher\"\u003e@fisher\u003c/a\u003e - you ok to disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-13T16:03:17.070Z","updated_at":"2018-10-13T16:03:17.070Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup please do!","markdown_message":"\u003cp\u003eYup please do!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-13T16:06:07.333Z","updated_at":"2018-10-13T16:06:07.333Z","actor":{"username":"fisher","cleared":true,"url":"/fisher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CB9zcyPs2KHYbTTPjQZGuo6x/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3475733,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"Great - thanks!","markdown_message":"\u003cp\u003eGreat - thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-13T16:06:30.945Z","updated_at":"2018-10-13T16:06:30.945Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711573,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-26T19:44:33.989Z","updated_at":"2018-11-26T19:44:33.989Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.3)","old_severity_id":221646,"new_severity_id":249886},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7147472,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-25T14:55:59.985Z","updated_at":"2020-02-25T14:55:59.985Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"Shopify Developed Apps","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283106,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:32:33.860Z","updated_at":"2020-03-10T20:32:33.860Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:32:43.249Z","updated_at":"2020-03-10T20:32:43.249Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fisher","url":"/fisher"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283110,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:32:52.593Z","updated_at":"2020-03-10T20:32:52.593Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283178,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"🙏","markdown_message":"\u003cp\u003e🙏\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-10T20:38:45.878Z","updated_at":"2020-03-10T20:38:45.878Z","actor":{"username":"fisher","cleared":true,"url":"/fisher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CB9zcyPs2KHYbTTPjQZGuo6x/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7283179,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:38:45.971Z","updated_at":"2020-03-10T20:38:45.971Z","actor":{"username":"fisher","cleared":true,"url":"/fisher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CB9zcyPs2KHYbTTPjQZGuo6x/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}