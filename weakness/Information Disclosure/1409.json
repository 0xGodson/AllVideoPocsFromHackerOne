{"id":1409,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDA5","url":"https://hackerone.com/reports/1409","title":"Proxy discloses internal web servers","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-02-13T20:05:27.920Z","submitted_at":"2014-02-13T20:05:27.920Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3,"url":"https://hackerone.com/factlink","handle":"factlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Factlink","twitter_handle":"factlink","website":"https://factlink.com","about":"Share your knowledge with the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-04-08T08:37:00.766Z","bug_reporter_agreed_on_going_public_at":"2014-04-08T08:34:05.571Z","team_member_agreed_on_going_public_at":"2014-04-08T08:37:00.447Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi guys,\r\n\r\nI found a bug that allows users of your proxy to retrieve pages from your internal web servers -- in this case, the `172.16.64.0/24` subnet. As an example, please see [this link](http://fct.li/?url=https://172.18.64.13). As you will see, it returns the HTML of your Chef server (which, I assume, cannot be accessed from the internet). I wasn't able to access any of your systems. That being said, I didn't really spent time on it.\r\n\r\nPlease note that once your proxy is also able to follow redirects, it should reject redirects to internal hosts as well.","vulnerability_information_html":"\u003cp\u003eHi guys,\u003c/p\u003e\n\n\u003cp\u003eI found a bug that allows users of your proxy to retrieve pages from your internal web servers -- in this case, the \u003ccode\u003e172.16.64.0/24\u003c/code\u003e subnet. As an example, please see \u003ca href=\"/redirect?url=http%3A%2F%2Ffct.li%2F%3Furl%3Dhttps%3A%2F%2F172.18.64.13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis link\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. As you will see, it returns the HTML of your Chef server (which, I assume, cannot be accessed from the internet). I wasn\u0026#39;t able to access any of your systems. That being said, I didn\u0026#39;t really spent time on it.\u003c/p\u003e\n\n\u003cp\u003ePlease note that once your proxy is also able to follow redirects, it should reject redirects to internal hosts as well.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-07T22:07:45.314Z","allow_singular_disclosure_after":-209715624.91715735,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","realtess","spetr0x","cryptosector","sigma22"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6921,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Will fix!","markdown_message":"\u003cp\u003eWill fix!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-02-14T13:07:48.612Z","updated_at":"2014-02-14T13:07:48.612Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was a bit too enthousiastic. It's not easy to fix in our code, so we have to fix it in our network setup. We can fix it partially, but even then it's probably not easy to fix it fully (you need to be able to allow/deny network on process-level to do so). It's still on our backlog, but not with a high priority.","markdown_message":"\u003cp\u003eI was a bit too enthousiastic. It\u0026#39;s not easy to fix in our code, so we have to fix it in our network setup. We can fix it partially, but even then it\u0026#39;s probably not easy to fix it fully (you need to be able to allow/deny network on process-level to do so). It\u0026#39;s still on our backlog, but not with a high priority.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-03T10:39:36.872Z","updated_at":"2014-03-03T10:39:36.872Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, thanks for letting me know!","markdown_message":"\u003cp\u003eCool, thanks for letting me know!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-03T10:42:30.867Z","updated_at":"2014-03-03T10:42:30.867Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":25939,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The factlink proxy is now hosted in a VM outside of our other infrastructure to ensure no sensitive ports can be accessed regardless of the input to the proxy.\n\nFurthermore, some defense-in-depth measures help avoid particularly unwise user requests (e.g. http auth and access to private IP ranges), though such protections aren't more than a best-effort to avoid surprises.","markdown_message":"\u003cp\u003eThe factlink proxy is now hosted in a VM outside of our other infrastructure to ensure no sensitive ports can be accessed regardless of the input to the proxy.\u003c/p\u003e\n\n\u003cp\u003eFurthermore, some defense-in-depth measures help avoid particularly unwise user requests (e.g. http auth and access to private IP ranges), though such protections aren\u0026#39;t more than a best-effort to avoid surprises.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-07T22:07:45.559Z","updated_at":"2014-04-07T22:07:45.559Z","actor":{"username":"eamon","cleared":false,"url":"/eamon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":26319,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-08T08:34:05.587Z","updated_at":"2014-04-08T08:34:05.587Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":26320,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-08T08:37:00.462Z","updated_at":"2014-04-08T08:37:00.462Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":26321,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-08T08:37:00.783Z","updated_at":"2014-04-08T08:37:00.783Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}