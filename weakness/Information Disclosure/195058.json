{"id":195058,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUwNTg=","url":"https://hackerone.com/reports/195058","title":"Users can download old project exports due to unclaimed namespace","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-01T15:58:28.420Z","submitted_at":"2017-01-01T15:58:28.420Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-01-23T23:10:00.394Z","bug_reporter_agreed_on_going_public_at":"2017-01-23T20:47:30.697Z","team_member_agreed_on_going_public_at":"2017-01-23T23:10:00.313Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"TL;DR: Happy new year and happy birthday, @douwem!\n\n# Vulnerability details\nWhen a user renames its namespace, another user can claim the namespace and download old export files from the victim. The attack scenario here is that someone would scrape existing GitLab namespaces (users and groups, which are public) and see if they're renamed (freeing up the old namespace). The attacker can then claim the namespace the victim's old export files.\n\n# Impact\nThis may expose confidential project information, including the repository code, merge requests, issues, and snippets.\n\n# Proof of concept\nFollow the steps below to reproduce the vulnerability.\n\n**As the victim**\n1. Create a group called `test`\n2. Create a new private project in the `test` group called `test`\n3. Click the `Generate export` button in the project's settings page\n4. Now rename the group to `new-test`\n\n**As the attacker**\n1. Create a group called `test` (this is possible because the old group was renamed to `new-test`)\n2. Create a new private project in the `test` group called `test`\n3. Go to http://gitlab-instance/test/test/download_export\n4. Profit! The attacker will download the export file generated by the victim \n\n# Remediation\nExpire download links when the namespace OR project URL changes. This vulnerability also applies when changing the project URL, although that is less severe. This might grant users access to private repositories, although far less likely than the PoC outlined in this report.","vulnerability_information_html":"\u003cp\u003eTL;DR: Happy new year and happy birthday, \u003ca href=\"/douwem\"\u003e@douwem\u003c/a\u003e!\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability-details\"\u003eVulnerability details\u003c/h1\u003e\n\n\u003cp\u003eWhen a user renames its namespace, another user can claim the namespace and download old export files from the victim. The attack scenario here is that someone would scrape existing GitLab namespaces (users and groups, which are public) and see if they\u0026#39;re renamed (freeing up the old namespace). The attacker can then claim the namespace the victim\u0026#39;s old export files.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eThis may expose confidential project information, including the repository code, merge requests, issues, and snippets.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003eFollow the steps below to reproduce the vulnerability.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAs the victim\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a group called \u003ccode\u003etest\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a new private project in the \u003ccode\u003etest\u003c/code\u003e group called \u003ccode\u003etest\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eClick the \u003ccode\u003eGenerate export\u003c/code\u003e button in the project\u0026#39;s settings page\u003c/li\u003e\n\u003cli\u003eNow rename the group to \u003ccode\u003enew-test\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eAs the attacker\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a group called \u003ccode\u003etest\u003c/code\u003e (this is possible because the old group was renamed to \u003ccode\u003enew-test\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eCreate a new private project in the \u003ccode\u003etest\u003c/code\u003e group called \u003ccode\u003etest\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"http://gitlab-instance/test/test/download_export\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Ftest%2Ftest%2Fdownload_export\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/test/test/download_export\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eProfit! The attacker will download the export file generated by the victim \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"remediation\"\u003eRemediation\u003c/h1\u003e\n\n\u003cp\u003eExpire download links when the namespace OR project URL changes. This vulnerability also applies when changing the project URL, although that is less severe. This might grant users access to private repositories, although far less likely than the PoC outlined in this report.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-22T20:47:30.772Z","allow_singular_disclosure_after":-121421021.22303267,"singular_disclosure_allowed":true,"vote_count":10,"voters":["ayoubfathi_","mpz","eveeez","khizer47","japz","sumit7","secdoor","spetr0x","cryptosector","arice"],"severity":{"rating":"medium","score":4.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1393764,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks Jobert!\n\nI've opened confidential issue https://gitlab.com/gitlab-org/gitlab-ce/issues/26242 and will keep you updated as usual.","markdown_message":"\u003cp\u003eThanks Jobert!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve opened confidential issue \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/26242\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F26242\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/26242\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and will keep you updated as usual.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-01T18:40:16.169Z","updated_at":"2017-01-01T18:40:16.169Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1437144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A patch for this vulnerability is scheduled to go out in a security release tomorrow. I'll update the issue here when it does. Thanks for the report!","markdown_message":"\u003cp\u003eA patch for this vulnerability is scheduled to go out in a security release tomorrow. I\u0026#39;ll update the issue here when it does. Thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-22T18:10:30.953Z","updated_at":"2017-01-22T18:10:30.953Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1439306,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've released a patch for this vulnerability today: https://about.gitlab.com/2017/01/23/gitlab-8-dot-16-dot-1-security-release/\n\nThanks again!","markdown_message":"\u003cp\u003eWe\u0026#39;ve released a patch for this vulnerability today: \u003ca title=\"https://about.gitlab.com/2017/01/23/gitlab-8-dot-16-dot-1-security-release/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2F2017%2F01%2F23%2Fgitlab-8-dot-16-dot-1-security-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/2017/01/23/gitlab-8-dot-16-dot-1-security-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T20:44:48.118Z","updated_at":"2017-01-23T20:44:48.118Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1439323,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-23T20:47:30.720Z","updated_at":"2017-01-23T20:47:30.720Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1439700,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-23T23:10:00.339Z","updated_at":"2017-01-23T23:10:00.339Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1439701,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-23T23:10:00.412Z","updated_at":"2017-01-23T23:10:00.412Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}