{"id":155618,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTU2MTg=","url":"https://hackerone.com/reports/155618","title":"Watch any Password Video without password","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-31T15:41:44.639Z","submitted_at":"2016-07-31T15:41:44.639Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"opnsec","url":"/opnsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-18T09:41:06.126Z","bug_reporter_agreed_on_going_public_at":"2017-09-18T09:40:50.683Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Jeremy and Vimeo Security Team,\n\nThere is a vulnerability in Vimeo which allows any user to watch password video without the password.\nA user can like a passworded video without password, then the user can watch the video on Couchmode without the password.\n\nPOC link : http://opnsec.com/vimeo/PasswordBypass.html\n\nDescription : \nThis POC demonstrates how to watch my passworded Vimeo Video without password\nPassword Video : https://vimeo.com/176931370\n\nInstructions : \n1. You must be logged in Vimeo\n2. Open the POC link and follow instructions.\n3. You should be able to watch my \"Ski Movie\" video without password\n\n-----\nTechnical description :\n\nThere are 2 steps in this vulnerabilty :\nFirst, it is possible to like a password video without password. There is no need of password to open `https://player.vimeo.com/video/[VIDEO_ID]/config` which contains the tokens (session, signature, timestamp) required to like the video. Sending these tokens via a POST request to `https://player.vimeo.com/video/[VIDEO_ID]/like`\n(megaloop.swf uses this request to like a video) will make the video like in user profile. Note that there is the same vulnerability with \"watch_later\" (`https://player.vimeo.com/video/[VIDEO_ID]/like`)\n\nAfter that, the Couchmode allows to watch a \"liked\"/\"watch later\" video without asking for password.\n\n----\nMitigation :\n\nFor the \"liked\"/\"watch later\" vulnerability, the server should reject the like request until a valid password is provided. This could easily be done by asking the password automatically each time the video is liked for example.\n\nRegarding the Couchmode, it might be better to ask for password or not include any password video.\n\n---\n\nIf you need more info feel free to ask,\n\nEnguerran @opnsec","vulnerability_information_html":"\u003cp\u003eHello Jeremy and Vimeo Security Team,\u003c/p\u003e\n\n\u003cp\u003eThere is a vulnerability in Vimeo which allows any user to watch password video without the password.\u003cbr\u003e\nA user can like a passworded video without password, then the user can watch the video on Couchmode without the password.\u003c/p\u003e\n\n\u003cp\u003ePOC link : \u003ca title=\"http://opnsec.com/vimeo/PasswordBypass.html\" href=\"/redirect?url=http%3A%2F%2Fopnsec.com%2Fvimeo%2FPasswordBypass.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://opnsec.com/vimeo/PasswordBypass.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eDescription : \u003cbr\u003e\nThis POC demonstrates how to watch my passworded Vimeo Video without password\u003cbr\u003e\nPassword Video : \u003ca title=\"https://vimeo.com/176931370\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F176931370\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/176931370\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eInstructions : \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eYou must be logged in Vimeo\u003c/li\u003e\n\u003cli\u003eOpen the POC link and follow instructions.\u003c/li\u003e\n\u003cli\u003eYou should be able to watch my \u0026quot;Ski Movie\u0026quot; video without password\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eTechnical description :\u003c/p\u003e\n\n\u003cp\u003eThere are 2 steps in this vulnerabilty :\u003cbr\u003e\nFirst, it is possible to like a password video without password. There is no need of password to open \u003ccode\u003ehttps://player.vimeo.com/video/[VIDEO_ID]/config\u003c/code\u003e which contains the tokens (session, signature, timestamp) required to like the video. Sending these tokens via a POST request to \u003ccode\u003ehttps://player.vimeo.com/video/[VIDEO_ID]/like\u003c/code\u003e\u003cbr\u003e\n(megaloop.swf uses this request to like a video) will make the video like in user profile. Note that there is the same vulnerability with \u0026quot;watch_later\u0026quot; (\u003ccode\u003ehttps://player.vimeo.com/video/[VIDEO_ID]/like\u003c/code\u003e)\u003c/p\u003e\n\n\u003cp\u003eAfter that, the Couchmode allows to watch a \u0026quot;liked\u0026quot;/\u0026quot;watch later\u0026quot; video without asking for password.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eMitigation :\u003c/p\u003e\n\n\u003cp\u003eFor the \u0026quot;liked\u0026quot;/\u0026quot;watch later\u0026quot; vulnerability, the server should reject the like request until a valid password is provided. This could easily be done by asking the password automatically each time the video is liked for example.\u003c/p\u003e\n\n\u003cp\u003eRegarding the Couchmode, it might be better to ask for password or not include any password video.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eIf you need more info feel free to ask,\u003c/p\u003e\n\n\u003cp\u003eEnguerran \u003ca href=\"/opnsec\"\u003e@opnsec\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-18T09:40:50.733Z","allow_singular_disclosure_after":-100896853.38927765,"singular_disclosure_allowed":true,"vote_count":43,"voters":["jokebookservice1","sameerphad72","flashdisk","ysx","cuso4","ankitsingh","gamliel","mpz","r3y","khizer47","and 33 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1100443,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report! So, the only issue here is with couchmode. You're not able to like any video from the player. The player might say 200 OK, indicating the signature validation passed, but we do perform permission checks. \n\nThe couchmode issue has been resolved.","markdown_message":"\u003cp\u003eThanks for your report! So, the only issue here is with couchmode. You\u0026#39;re not able to like any video from the player. The player might say 200 OK, indicating the signature validation passed, but we do perform permission checks. \u003c/p\u003e\n\n\u003cp\u003eThe couchmode issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T18:31:58.351Z","updated_at":"2016-08-01T18:31:58.351Z","actor":{"username":"jayyspence7","cleared":false,"url":"/jayyspence7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"opnsec","url":"/opnsec"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1100480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I understand you but I just tested my PoC with a new account and the passworded videos was indeed liked. It appears in the user likes : https://vimeo.com/user54955866/likes. (It wasn't there before). when I open the video and put the password, the video appears liked.\n\nI understand that for private videos you are performing tests but for password videos it might fail to properly test because the server doesn't know who has the password and who doesn't.\n\nIf you give me the video ID of a password video (without giving me the password) and if I am able to like I believe it would prove my point. Would you do this ?\n\nAlso can you try to use my PoC and like the video and then check your likes list in https://vimeo.com/[YOUR_User_URL]/likes ? You can also then open the video at https://vimeo.com/176931370\nand provide the password : very$â‚¬cret!\nand see that the video is liked by yourself.","markdown_message":"\u003cp\u003eHi, I understand you but I just tested my PoC with a new account and the passworded videos was indeed liked. It appears in the user likes : \u003ca title=\"https://vimeo.com/user54955866/likes\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fuser54955866%2Flikes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/user54955866/likes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. (It wasn\u0026#39;t there before). when I open the video and put the password, the video appears liked.\u003c/p\u003e\n\n\u003cp\u003eI understand that for private videos you are performing tests but for password videos it might fail to properly test because the server doesn\u0026#39;t know who has the password and who doesn\u0026#39;t.\u003c/p\u003e\n\n\u003cp\u003eIf you give me the video ID of a password video (without giving me the password) and if I am able to like I believe it would prove my point. Would you do this ?\u003c/p\u003e\n\n\u003cp\u003eAlso can you try to use my PoC and like the video and then check your likes list in \u003ca title=\"https://vimeo.com/%5BYOUR_User_URL%5D/likes\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F%255BYOUR_User_URL%255D%2Flikes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/%5BYOUR_User_URL%5D/likes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ? You can also then open the video at \u003ca title=\"https://vimeo.com/176931370\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F176931370\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/176931370\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand provide the password : very$â‚¬cret!\u003cbr\u003e\nand see that the video is liked by yourself.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T18:46:38.204Z","updated_at":"2016-08-01T18:51:46.930Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1100662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ah, thanks. We're looking to resolve that, but is not as urgent since the couchmode bug has been fixed. Reduced severity as this wasn't liking ANY video, but certainly pw protected ones.","markdown_message":"\u003cp\u003eah, thanks. We\u0026#39;re looking to resolve that, but is not as urgent since the couchmode bug has been fixed. Reduced severity as this wasn\u0026#39;t liking ANY video, but certainly pw protected ones.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T19:58:39.181Z","updated_at":"2016-08-01T20:03:44.908Z","actor":{"username":"jayyspence7","cleared":false,"url":"/jayyspence7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1100668,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Vimeo more secure :)","markdown_message":"\u003cp\u003eThanks for helping make Vimeo more secure :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T20:03:15.436Z","updated_at":"2016-08-01T20:03:15.436Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"opnsec","url":"/opnsec"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1100695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks ! I didn't try many videos and I admit I went a little ahead of myself.\n\nBtw any chance to see you in Vegas this week for Defcon and all ?","markdown_message":"\u003cp\u003eThanks ! I didn\u0026#39;t try many videos and I admit I went a little ahead of myself.\u003c/p\u003e\n\n\u003cp\u003eBtw any chance to see you in Vegas this week for Defcon and all ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T20:17:50.453Z","updated_at":"2016-08-01T20:17:50.453Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2002982,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-18T09:40:50.707Z","updated_at":"2017-09-18T09:40:50.707Z","first_to_agree":true,"actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2077366,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-18T09:41:06.143Z","updated_at":"2017-10-18T09:41:06.143Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}