{"id":244434,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ0MzQ=","url":"https://hackerone.com/reports/244434","title":"Leaking password reset token via referrer from external Twitter share button","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-06-29T16:21:51.505Z","submitted_at":"2017-06-29T16:21:51.505Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"prateek_0490","url":"/prateek_0490","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/091/1ed302e84de48e3400ace67b5ea3928fb3c9d68e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-03T18:08:10.650Z","bug_reporter_agreed_on_going_public_at":"2017-07-03T04:34:16.017Z","team_member_agreed_on_going_public_at":"2017-07-03T18:08:10.586Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\n#Description\n\nIt has been identified that the application is leaking referrer token to third party sites. In this case it was found that the pasword reset token is being leaked to third party sites which is a issue knowing the fact that it can allow any malicious users to use the token and reset the passwords of the victim.\n\nPlus this issue becomes a bit more critical because I notice we can use the reset password tokens more then once which is another issue.\n\n#Proof of concept\n\n1) Request a password reset link for a valid account\n2) Click on the reset link \n3) before resetting the password click on the social media links like twitter available in footer section\n4) you wold notice the below request\n\n```\nGET /WakaTime HTTP/1.1\nHost: twitter.com\nConnection: close\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: https://wakatime.com/reset_password/4b4e9757-b66e-44e1-9b2e-898386cefe27/2017-06-29T16%3A41%3A37Z/eb4f3b8186b8385c71d6c9f715073177e2928c6c\nAccept-Language: en-US,en;q=0.8\nCookie: guest_id=v1%3A149433114446813234; privacy_2017=1; ads_prefs=\"HBERAAA=\"; kdt=siie8hORVuREtE5Z1i9Q4JG0CPtpkDz8NoF3SWGw; remember_checked_on=1; \n```\n\nAs you can see in the referrer the reset token is getting leaked to third party sites. So, the person who has the complete control over that particular third party site can compromise the user accounts easily.\n\nBest Regards,\nPrateek Tiwari\n","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eIt has been identified that the application is leaking referrer token to third party sites. In this case it was found that the pasword reset token is being leaked to third party sites which is a issue knowing the fact that it can allow any malicious users to use the token and reset the passwords of the victim.\u003c/p\u003e\n\n\u003cp\u003ePlus this issue becomes a bit more critical because I notice we can use the reset password tokens more then once which is another issue.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003e1) Request a password reset link for a valid account\u003cbr\u003e\n2) Click on the reset link \u003cbr\u003e\n3) before resetting the password click on the social media links like twitter available in footer section\u003cbr\u003e\n4) you wold notice the below request\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /WakaTime HTTP/1.1\nHost: twitter.com\nConnection: close\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: https://wakatime.com/reset_password/4b4e9757-b66e-44e1-9b2e-898386cefe27/2017-06-29T16%3A41%3A37Z/eb4f3b8186b8385c71d6c9f715073177e2928c6c\nAccept-Language: en-US,en;q=0.8\nCookie: guest_id=v1%3A149433114446813234; privacy_2017=1; ads_prefs=\u0026quot;HBERAAA=\u0026quot;; kdt=siie8hORVuREtE5Z1i9Q4JG0CPtpkDz8NoF3SWGw; remember_checked_on=1; \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see in the referrer the reset token is getting leaked to third party sites. So, the person who has the complete control over that particular third party site can compromise the user accounts easily.\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nPrateek Tiwari\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-02T04:34:16.071Z","allow_singular_disclosure_after":-107570105.16920201,"singular_disclosure_allowed":true,"vote_count":7,"voters":["cuso4","eveeez","r3y","kenziy","silv3rpoision","kinso","iamcoolcat"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1798253,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T04:11:08.219Z","updated_at":"2017-07-03T04:11:08.219Z","additional_data":{"duplicate_report_id":244540},"actor":{"username":"cache-money","cleared":true,"url":"/cache-money","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/736/f78da6d0fa17c4d39be1f8088656c23763451dc2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798256,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T04:12:47.355Z","updated_at":"2017-07-03T04:12:47.355Z","additional_data":{"duplicate_report_id":244617},"actor":{"username":"bcb08c9644b555ba22dddf8","cleared":false,"url":"/bcb08c9644b555ba22dddf8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798275,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you! This has been fixed by adding `rel=\"noopener noreferrer\"` to external links in the footer.","markdown_message":"\u003cp\u003eThank you! This has been fixed by adding \u003ccode\u003erel=\u0026quot;noopener noreferrer\u0026quot;\u003c/code\u003e to external links in the footer.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T04:28:18.611Z","updated_at":"2017-07-03T04:28:18.611Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"prateek_0490","url":"/prateek_0490"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1798283,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"that was quick thanks :) I've seen you've resolved quite a few reports till now from the day @wakatime launched the program. Great Job @alanhamlett :)\n\nBest Regards,\nPrateek Tiwari","markdown_message":"\u003cp\u003ethat was quick thanks :) I\u0026#39;ve seen you\u0026#39;ve resolved quite a few reports till now from the day \u003ca href=\"/wakatime\"\u003e@wakatime\u003c/a\u003e launched the program. Great Job \u003ca href=\"/alanhamlett\"\u003e@alanhamlett\u003c/a\u003e :)\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nPrateek Tiwari\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T04:34:16.040Z","updated_at":"2017-07-03T04:34:16.040Z","first_to_agree":true,"actor":{"username":"prateek_0490","cleared":true,"url":"/prateek_0490","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/091/1ed302e84de48e3400ace67b5ea3928fb3c9d68e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I hope you didn't forget to disclose this? Seeing many reports being disclosed but this one still isn't!\n\nPlease do so whenever you get a chance. Thanks :) and once again good job on getting these many reports resolved within 3-4 days. Awesome work!\n\nBest Regards,\nPrateek Tiwari","markdown_message":"\u003cp\u003eI hope you didn\u0026#39;t forget to disclose this? Seeing many reports being disclosed but this one still isn\u0026#39;t!\u003c/p\u003e\n\n\u003cp\u003ePlease do so whenever you get a chance. Thanks :) and once again good job on getting these many reports resolved within 3-4 days. Awesome work!\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nPrateek Tiwari\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T18:05:58.236Z","updated_at":"2017-07-03T18:05:58.236Z","actor":{"username":"prateek_0490","cleared":true,"url":"/prateek_0490","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/091/1ed302e84de48e3400ace67b5ea3928fb3c9d68e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799990,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for reminding, disclosing publicly now :)","markdown_message":"\u003cp\u003eThanks for reminding, disclosing publicly now :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T18:08:10.612Z","updated_at":"2017-07-03T18:08:10.612Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1799991,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T18:08:10.667Z","updated_at":"2017-07-03T18:08:10.667Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5613195,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T08:03:51.703Z","updated_at":"2019-08-20T08:03:51.703Z","additional_data":{"old_title":"[https://wakatime.com/reset_password/] Leaking password reset token via referrer","new_title":"Leaking password reset token via referrer from external Twitter share button"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}