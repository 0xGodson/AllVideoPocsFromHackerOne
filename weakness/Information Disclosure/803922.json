{"id":803922,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDM5MjI=","url":"https://hackerone.com/reports/803922","title":"Missing resource identifier encoding may lead to security vulnerabilities","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-02-24T20:41:03.367Z","submitted_at":"2020-02-24T20:41:03.367Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8151"],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-13T18:18:36.253Z","bug_reporter_agreed_on_going_public_at":"2020-05-05T22:43:56.784Z","team_member_agreed_on_going_public_at":"2020-05-13T18:18:36.146Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"(I initially submitted this to the GitHub repository because the ActiveResource repository is not listed in scope. I was redirected here by @rafaelfranca)\n\nA number of methods in the ActiveResource library, such as `ActiveResource::Base#find` and `ActiveResource::Base#exists?` don't URL encode the resource identifier that is passed to them. Consider the following code:\n\n```ruby\nrequire 'activeresource'\n \n class Test \u003c ActiveResource::Base\n   self.site = 'http://127.0.0.1:8080'\nend\n\nTest.exists? '?a=1'\n```\n\nThe code above is expected to make a request to `http://127.0.0.1:8080/tests/%3fa%3d1.json` by properly URL encoding the resource identifier. Instead, it makes a request to `http://127.0.0.1:8080/tests/?a=1.json`.\n\nThis was tested against ActiveResource 5.1.0 and 5.0.0, both have the same unexpected behavior.\n\n## Impact\n\nBecause the index `/tests/` returns an array of objects, the code will throw an exception. However, due to the time difference that could be observed, an attacker could potentially exploit this by injecting a filter parameter to index endpoint of the resource. E.g.\n\n| Resource identifier | Objects returned | RTT |\n| ---- | ---- | ---- |\n| `?type=a\u0026` | 1 | 500ms |\n| `?type=b\u0026` | 0 | 100ms |","vulnerability_information_html":"\u003cp\u003e(I initially submitted this to the GitHub repository because the ActiveResource repository is not listed in scope. I was redirected here by \u003ca href=\"/rafaelfranca\"\u003e@rafaelfranca\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eA number of methods in the ActiveResource library, such as \u003ccode\u003eActiveResource::Base#find\u003c/code\u003e and \u003ccode\u003eActiveResource::Base#exists?\u003c/code\u003e don\u0026#39;t URL encode the resource identifier that is passed to them. Consider the following code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;activeresource\u0026#39;\u003c/span\u003e\n\n \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTest\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveResource\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n   \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;http://127.0.0.1:8080\u0026#39;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eTest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexists?\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;?a=1\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe code above is expected to make a request to \u003ccode\u003ehttp://127.0.0.1:8080/tests/%3fa%3d1.json\u003c/code\u003e by properly URL encoding the resource identifier. Instead, it makes a request to \u003ccode\u003ehttp://127.0.0.1:8080/tests/?a=1.json\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis was tested against ActiveResource 5.1.0 and 5.0.0, both have the same unexpected behavior.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBecause the index \u003ccode\u003e/tests/\u003c/code\u003e returns an array of objects, the code will throw an exception. However, due to the time difference that could be observed, an attacker could potentially exploit this by injecting a filter parameter to index endpoint of the resource. E.g.\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResource identifier\u003c/th\u003e\n\u003cth\u003eObjects returned\u003c/th\u003e\n\u003cth\u003eRTT\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e?type=a\u0026amp;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003e500ms\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e?type=b\u0026amp;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e0\u003c/td\u003e\n\u003ctd\u003e100ms\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-06-04T22:43:56.883Z","allow_singular_disclosure_after":-17914305.82348647,"singular_disclosure_allowed":true,"vote_count":12,"voters":["mik317","sameerphad72","zeroxyele","haxta4ok00","what_web","3x3s","wannabe_hacker","0skar","bencode","mliege","and 2 more..."],"severity":{"rating":"medium","score":4.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":160,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rails/rails","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7142428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@turtle_shell","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T08:50:23.822Z","updated_at":"2020-02-25T08:50:23.822Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7142798,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @jobert and thanks for your report,\n\nUnfortunately, I am not an expert on Ruby on Rails. I will tell you all the steps I did so far to try to reproduce your bug\n\n1. `rails new site`\n1. install, update, etc.\n1.  Create a file `test_jobert.rb`  in `test` with\n\n```\nrequire 'activeresource'\n\n class Test \u003c ActiveResource::Base\n   self.site = 'http://127.0.0.1:3000'\nend\n\nTest.exists? '?a=1'\n```\n\n1. `irb -r ./test_jobert.rb`\n\nBut I have a route problem to `/tests/`, however I do see the unencoded request\n\n{F727817}\n\nCould you kindly guide me in the configuration of the test application to see the timing of the requests to `1` and `2`?\n\nThanks,\n\n@turtle_shell","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e and thanks for your report,\u003c/p\u003e\n\n\u003cp\u003eUnfortunately, I am not an expert on Ruby on Rails. I will tell you all the steps I did so far to try to reproduce your bug\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003erails new site\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003einstall, update, etc.\u003c/li\u003e\n\u003cli\u003e Create a file \u003ccode\u003etest_jobert.rb\u003c/code\u003e  in \u003ccode\u003etest\u003c/code\u003e with\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequire \u0026#39;activeresource\u0026#39;\n\n class Test \u0026lt; ActiveResource::Base\n   self.site = \u0026#39;http://127.0.0.1:3000\u0026#39;\nend\n\nTest.exists? \u0026#39;?a=1\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eirb -r ./test_jobert.rb\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eBut I have a route problem to \u003ccode\u003e/tests/\u003c/code\u003e, however I do see the unencoded request\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_2020-02-25_at_10.10.38.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bEuthb6utnTV7fJLV6sqk2WL?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-25_at_10.10.38.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-25_at_10.10.38.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065542Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=ab71a1cac4f3aa3a5e32d70260c32febee4d638d7f6868bc612c2de8530ab187\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bEuthb6utnTV7fJLV6sqk2WL?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-25_at_10.10.38.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-25_at_10.10.38.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065542Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=ab71a1cac4f3aa3a5e32d70260c32febee4d638d7f6868bc612c2de8530ab187\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCould you kindly guide me in the configuration of the test application to see the timing of the requests to \u003ccode\u003e1\u003c/code\u003e and \u003ccode\u003e2\u003c/code\u003e?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T09:11:56.996Z","updated_at":"2020-02-25T09:11:56.996Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"attachments":[{"id":727817,"filename":"Screenshot_2020-02-25_at_10.10.38.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bEuthb6utnTV7fJLV6sqk2WL?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-25_at_10.10.38.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-25_at_10.10.38.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065542Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=ab71a1cac4f3aa3a5e32d70260c32febee4d638d7f6868bc612c2de8530ab187"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7149526,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @turtle_shell - the timing idea was just an example of how this could potentially result in a security vulnerability (which it did at HackerOne itself, ironically). It was a hypothetical where the `tests` resource would return any kind of objects. In HackerOne's case, it hit our payments backend where an attacker could determine the existence of private programs. The `site` in the model just has to point to any REST interface, doesn't have to be the project itself. Does that make sense?\n\nPS ActiveResource is *not* part of Rails by default, but it's maintained by them. I initially reported this through GitHub because it's not part of their BBP scope, but I was redirected here.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e - the timing idea was just an example of how this could potentially result in a security vulnerability (which it did at HackerOne itself, ironically). It was a hypothetical where the \u003ccode\u003etests\u003c/code\u003e resource would return any kind of objects. In HackerOne\u0026#39;s case, it hit our payments backend where an attacker could determine the existence of private programs. The \u003ccode\u003esite\u003c/code\u003e in the model just has to point to any REST interface, doesn\u0026#39;t have to be the project itself. Does that make sense?\u003c/p\u003e\n\n\u003cp\u003ePS ActiveResource is \u003cem\u003enot\u003c/em\u003e part of Rails by default, but it\u0026#39;s maintained by them. I initially reported this through GitHub because it\u0026#39;s not part of their BBP scope, but I was redirected here.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T19:10:30.792Z","updated_at":"2020-02-25T19:11:51.306Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7155072,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @jobert,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@turtle_shell","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-26T13:12:29.698Z","updated_at":"2020-02-26T13:12:29.698Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7155075,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-26T13:13:28.865Z","updated_at":"2020-02-26T13:13:28.865Z","additional_data":{"old_severity":null,"new_severity":"Medium (4.8)","old_severity_id":null,"new_severity_id":643753},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7545496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @turtle_shell - I've written the patch for the vulnerability myself because this is currently affecting HackerOne. I've attached it to this comment and inlined it below. The root cause of the vulnerability lies in the `ActiveResource::Base.element_path` method. The given `id` parameter is currently encoded using `URI.parser.escape`. This encoding isn't sufficient, as won't encode characters like `?` and `/`. An alternative method, which is part of the default `URI` library, is `URI.encode_www_form_component`. This method will properly encode characters so that the backend will interpret them as the given ID rather than path components or query string.\n\nI'm happy to put this up in a PR, just say the word. All specs pass with the patch.\n\n```diff\ndiff --git a/lib/active_resource/base.rb b/lib/active_resource/base.rb\nindex 82cbc16..082f096 100644\n--- a/lib/active_resource/base.rb\n+++ b/lib/active_resource/base.rb\n@@ -774,7 +774,7 @@ module ActiveResource\n         check_prefix_options(prefix_options)\n \n         prefix_options, query_options = split_options(prefix_options) if query_options.nil?\n-        \"#{prefix(prefix_options)}#{collection_name}/#{URI.parser.escape id.to_s}#{format_extension}#{query_string(query_options)}\"\n+        \"#{prefix(prefix_options)}#{collection_name}/#{URI.encode_www_form_component(id.to_s)}#{format_extension}#{query_string(query_options)}\"\n       end\n \n       # Gets the element url for the given ID in +id+. If the +query_options+ parameter is omitted, Rails\ndiff --git a/test/cases/base_test.rb b/test/cases/base_test.rb\nindex e298b99..f95ae09 100644\n--- a/test/cases/base_test.rb\n+++ b/test/cases/base_test.rb\n@@ -688,7 +688,7 @@ class BaseTest \u003c ActiveSupport::TestCase\n     assert_equal \"/people/1/addresses/1.json\", StreetAddress.element_path(1, person_id: 1)\n     assert_equal \"/people/1/addresses/1.json\", StreetAddress.element_path(1, \"person_id\" =\u003e 1)\n     assert_equal \"/people/Greg/addresses/1.json\", StreetAddress.element_path(1, \"person_id\" =\u003e \"Greg\")\n-    assert_equal \"/people/ann%20mary/addresses/ann%20mary.json\", StreetAddress.element_path(:'ann mary', \"person_id\" =\u003e \"ann mary\")\n+    assert_equal \"/people/ann%20mary/addresses/ann+mary.json\", StreetAddress.element_path(:'ann mary', \"person_id\" =\u003e \"ann mary\")\n   end\n \n   def test_custom_element_path_without_required_prefix_param\ndiff --git a/test/cases/finder_test.rb b/test/cases/finder_test.rb\nindex cc49cd4..82e081d 100644\n--- a/test/cases/finder_test.rb\n+++ b/test/cases/finder_test.rb\n@@ -172,4 +172,20 @@ class FinderTest \u003c ActiveSupport::TestCase\n     david = Person.find(:one, from: :leader)\n     assert_equal \"David\", david.name\n   end\n+\n+  def test_find_identifier_encoding\n+    ActiveResource::HttpMock.respond_to { |m| m.get \"/people/%3F.json\", {}, @david }\n+\n+    david = Person.find(\"?\")\n+\n+    assert_equal \"David\", david.name\n+  end\n+\n+  def test_find_identifier_encoding_for_path_traversal\n+    ActiveResource::HttpMock.respond_to { |m| m.get \"/people/..%2F.json\", {}, @david }\n+\n+    david = Person.find(\"../\")\n+\n+    assert_equal \"David\", david.name\n+  end\n end\n```","markdown_message":"\u003cp\u003eHi \u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e - I\u0026#39;ve written the patch for the vulnerability myself because this is currently affecting HackerOne. I\u0026#39;ve attached it to this comment and inlined it below. The root cause of the vulnerability lies in the \u003ccode\u003eActiveResource::Base.element_path\u003c/code\u003e method. The given \u003ccode\u003eid\u003c/code\u003e parameter is currently encoded using \u003ccode\u003eURI.parser.escape\u003c/code\u003e. This encoding isn\u0026#39;t sufficient, as won\u0026#39;t encode characters like \u003ccode\u003e?\u003c/code\u003e and \u003ccode\u003e/\u003c/code\u003e. An alternative method, which is part of the default \u003ccode\u003eURI\u003c/code\u003e library, is \u003ccode\u003eURI.encode_www_form_component\u003c/code\u003e. This method will properly encode characters so that the backend will interpret them as the given ID rather than path components or query string.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m happy to put this up in a PR, just say the word. All specs pass with the patch.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/active_resource/base.rb b/lib/active_resource/base.rb\nindex 82cbc16..082f096 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/active_resource/base.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/active_resource/base.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -774,7 +774,7 @@\u003c/span\u003e module ActiveResource\n         check_prefix_options(prefix_options)\n\n         prefix_options, query_options = split_options(prefix_options) if query_options.nil?\n\u003cspan class=\"gd\"\u003e-        \u0026quot;#{prefix(prefix_options)}#{collection_name}/#{URI.parser.escape id.to_s}#{format_extension}#{query_string(query_options)}\u0026quot;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        \u0026quot;#{prefix(prefix_options)}#{collection_name}/#{URI.encode_www_form_component(id.to_s)}#{format_extension}#{query_string(query_options)}\u0026quot;\n\u003c/span\u003e       end\n\n       # Gets the element url for the given ID in +id+. If the +query_options+ parameter is omitted, Rails\n\u003cspan class=\"gh\"\u003ediff --git a/test/cases/base_test.rb b/test/cases/base_test.rb\nindex e298b99..f95ae09 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/cases/base_test.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/cases/base_test.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -688,7 +688,7 @@\u003c/span\u003e class BaseTest \u0026lt; ActiveSupport::TestCase\n     assert_equal \u0026quot;/people/1/addresses/1.json\u0026quot;, StreetAddress.element_path(1, person_id: 1)\n     assert_equal \u0026quot;/people/1/addresses/1.json\u0026quot;, StreetAddress.element_path(1, \u0026quot;person_id\u0026quot; =\u0026gt; 1)\n     assert_equal \u0026quot;/people/Greg/addresses/1.json\u0026quot;, StreetAddress.element_path(1, \u0026quot;person_id\u0026quot; =\u0026gt; \u0026quot;Greg\u0026quot;)\n\u003cspan class=\"gd\"\u003e-    assert_equal \u0026quot;/people/ann%20mary/addresses/ann%20mary.json\u0026quot;, StreetAddress.element_path(:\u0026#39;ann mary\u0026#39;, \u0026quot;person_id\u0026quot; =\u0026gt; \u0026quot;ann mary\u0026quot;)\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    assert_equal \u0026quot;/people/ann%20mary/addresses/ann+mary.json\u0026quot;, StreetAddress.element_path(:\u0026#39;ann mary\u0026#39;, \u0026quot;person_id\u0026quot; =\u0026gt; \u0026quot;ann mary\u0026quot;)\n\u003c/span\u003e   end\n\n   def test_custom_element_path_without_required_prefix_param\n\u003cspan class=\"gh\"\u003ediff --git a/test/cases/finder_test.rb b/test/cases/finder_test.rb\nindex cc49cd4..82e081d 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/cases/finder_test.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/cases/finder_test.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -172,4 +172,20 @@\u003c/span\u003e class FinderTest \u0026lt; ActiveSupport::TestCase\n     david = Person.find(:one, from: :leader)\n     assert_equal \u0026quot;David\u0026quot;, david.name\n   end\n\u003cspan class=\"gi\"\u003e+\n+  def test_find_identifier_encoding\n+    ActiveResource::HttpMock.respond_to { |m| m.get \u0026quot;/people/%3F.json\u0026quot;, {}, @david }\n+\n+    david = Person.find(\u0026quot;?\u0026quot;)\n+\n+    assert_equal \u0026quot;David\u0026quot;, david.name\n+  end\n+\n+  def test_find_identifier_encoding_for_path_traversal\n+    ActiveResource::HttpMock.respond_to { |m| m.get \u0026quot;/people/..%2F.json\u0026quot;, {}, @david }\n+\n+    david = Person.find(\u0026quot;../\u0026quot;)\n+\n+    assert_equal \u0026quot;David\u0026quot;, david.name\n+  end\n\u003c/span\u003e end\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-05T03:56:23.821Z","updated_at":"2020-04-05T04:00:36.223Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"attachments":[{"id":773991,"filename":"patch.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/HmfbzMeE8CZKYbN9S19kbPLV?response-content-disposition=attachment%3B%20filename%3D%22patch.diff%22%3B%20filename%2A%3DUTF-8%27%27patch.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065542Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=4e10288ac9a6a27ab753beb7ad5bf67b30d33ace3c616eb8691b14b795cc958f"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7701718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The patch looks good to me.  I can apply and release.  I guess we need a CVE?","markdown_message":"\u003cp\u003eThe patch looks good to me.  I can apply and release.  I guess we need a CVE?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-17T22:32:21.261Z","updated_at":"2020-04-17T22:32:21.261Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7701861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm writing the CVE report for this.  You wouldn't happen to have a monkey patch handy that I can provide people as a work-around?","markdown_message":"\u003cp\u003eI\u0026#39;m writing the CVE report for this.  You wouldn\u0026#39;t happen to have a monkey patch handy that I can provide people as a work-around?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-17T23:03:28.642Z","updated_at":"2020-04-17T23:03:28.642Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7702078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This monkey patch seems to do the job:\n\n```ruby\nmodule ActiveResource\n  class Base\n    class \u003c\u003c self\n      def element_path(id, prefix_options = {}, query_options = nil)\n        check_prefix_options(prefix_options)\n\n        prefix_options, query_options = split_options(prefix_options) if query_options.nil?\n        \"#{prefix(prefix_options)}#{collection_name}/#{URI.encode_www_form_component(id.to_s)}#{format_extension}#{query_string(query_options)}\"\n      end\n    end\n  end\nend\n```\n\nUnfortunately, because the encoding is part of the string returned from the method, it's a lot harder to leverage the gem method. Encoding and decoding the `id` parameter around the method is bound the introduce problems. Trying to parse the output again feels too error prone, too. Overwriting the method completely seems like the best solution here. Let me know if you have another idea on how to approach it.","markdown_message":"\u003cp\u003eThis monkey patch seems to do the job:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eActiveResource\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\n      \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eelement_path\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix_options\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"n\"\u003equery_options\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003echeck_prefix_options\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix_options\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eprefix_options\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equery_options\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esplit_options\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix_options\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003equery_options\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix_options\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"si\"\u003e}#{\u003c/span\u003e\u003cspan class=\"n\"\u003ecollection_name\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"no\"\u003eURI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eencode_www_form_component\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_s\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"si\"\u003e}#{\u003c/span\u003e\u003cspan class=\"n\"\u003eformat_extension\u003c/span\u003e\u003cspan class=\"si\"\u003e}#{\u003c/span\u003e\u003cspan class=\"n\"\u003equery_string\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equery_options\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUnfortunately, because the encoding is part of the string returned from the method, it\u0026#39;s a lot harder to leverage the gem method. Encoding and decoding the \u003ccode\u003eid\u003c/code\u003e parameter around the method is bound the introduce problems. Trying to parse the output again feels too error prone, too. Overwriting the method completely seems like the best solution here. Let me know if you have another idea on how to approach it.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-17T23:51:42.981Z","updated_at":"2020-04-17T23:51:42.981Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7708858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert I agree, overriding the method seems like the easiest way for a temporary fix","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e I agree, overriding the method seems like the easiest way for a temporary fix\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-18T20:54:18.546Z","updated_at":"2020-04-18T20:54:18.546Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7708883,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-18T20:58:19.295Z","updated_at":"2020-04-18T20:58:19.295Z","cve_ids":["CVE-2020-8151"],"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7904484,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm going to ship this now.  The master branch has changes that are not released, so I'm going to put this security patch on top of the current released version and release that.","markdown_message":"\u003cp\u003eI\u0026#39;m going to ship this now.  The master branch has changes that are not released, so I\u0026#39;m going to put this security patch on top of the current released version and release that.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-05T22:02:05.587Z","updated_at":"2020-05-05T22:02:05.587Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7904712,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is shipped, thank you!","markdown_message":"\u003cp\u003eThis is shipped, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-05T22:22:17.643Z","updated_at":"2020-05-05T22:22:17.643Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7904882,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great, thanks! We just updated the gem for HackerOne and removed the monkey patch. Seems like this is ready to be publicly disclosed. We'll also publicly disclose the security vulnerability we found in HackerOne that resulted in this report. For HackerOne, it resulted in information disclosure due to a timing attack, but at the end of the day, this seems like an HTTP parameter pollution vulnerability. It'll be available at https://hackerone.com/reports/800231 later this week.","markdown_message":"\u003cp\u003eGreat, thanks! We just updated the gem for HackerOne and removed the monkey patch. Seems like this is ready to be publicly disclosed. We\u0026#39;ll also publicly disclose the security vulnerability we found in HackerOne that resulted in this report. For HackerOne, it resulted in information disclosure due to a timing attack, but at the end of the day, this seems like an HTTP parameter pollution vulnerability. It\u0026#39;ll be available at \u003ca title=\"https://hackerone.com/reports/800231\" href=\"https://hackerone.com/reports/800231\"\u003ehttps://hackerone.com/reports/800231\u003c/a\u003e later this week.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-05T22:43:56.809Z","updated_at":"2020-05-05T22:43:56.809Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7992432,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T18:18:36.166Z","updated_at":"2020-05-13T18:18:36.166Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7992433,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T18:18:36.280Z","updated_at":"2020-05-13T18:18:36.280Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}