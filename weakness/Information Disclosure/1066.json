{"id":1066,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY2","url":"https://hackerone.com/reports/1066","title":"Bypass of anti-SSRF defenses in YahooCacheSystem (affecting at least YQL and Pipes)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-02-06T00:04:07.608Z","submitted_at":"2014-02-06T00:04:07.608Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"agarri_fr","url":"/agarri_fr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19,"url":"https://hackerone.com/verizonmedia","handle":"verizonmedia","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/019/0376827ddfc63924843165255c8d07e237fd3ae4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/019/0376827ddfc63924843165255c8d07e237fd3ae4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Verizon Media","twitter_handle":"verizonmedia","website":"https://www.verizonmedia.com","about":"Build Brands Members Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-08-14T20:05:51.380Z","bug_reporter_agreed_on_going_public_at":"2014-06-02T08:15:56.924Z","team_member_agreed_on_going_public_at":"2015-08-14T20:05:50.578Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-03-16T18:02:34.440Z","allow_singular_disclosure_after":-214222330.06900972,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","karthik86"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6945,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"","markdown_message":"","automated_response":false,"created_at":"2014-02-14T18:02:35.222Z","updated_at":"2014-02-14T18:02:35.222Z","actor":{"username":"schofield","cleared":false,"url":"/schofield","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/969/a5bdc5e7b77c5d3663d5a7a0b837653f25bd34e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":17196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-16T17:43:30.461Z","updated_at":"2014-03-16T17:43:30.461Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":17250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-16T23:12:07.843Z","updated_at":"2014-03-16T23:12:07.843Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":63420,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-02T08:15:56.949Z","updated_at":"2014-06-02T08:15:56.949Z","first_to_agree":true,"actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":89170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-15T18:07:40.869Z","updated_at":"2014-07-15T18:07:40.869Z","actor":{"username":"schofield","cleared":false,"url":"/schofield","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/969/a5bdc5e7b77c5d3663d5a7a0b837653f25bd34e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":89256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-15T20:24:46.901Z","updated_at":"2014-07-15T20:24:46.901Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":101598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-06T21:13:57.345Z","updated_at":"2014-08-06T21:13:57.345Z","actor":{"username":"schofield","cleared":false,"url":"/schofield","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/969/a5bdc5e7b77c5d3663d5a7a0b837653f25bd34e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":121621,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-05T01:30:49.454Z","updated_at":"2014-09-05T01:30:49.454Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":130379,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-20T21:31:07.669Z","updated_at":"2014-09-20T21:31:07.669Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":549167,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-14T20:05:50.605Z","updated_at":"2015-08-14T20:05:50.605Z","actor":{"username":"junot","cleared":false,"url":"/junot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/M5pzVfGfQwf2ibThc1LRahdB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":549168,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-14T20:05:51.409Z","updated_at":"2015-08-14T20:05:51.409Z","actor":{"username":"junot","cleared":false,"url":"/junot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/M5pzVfGfQwf2ibThc1LRahdB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":586,"category":"team","content":"Thank you for your submission to Yahoo’s Bug Bounty program. There were similar reports submitted, this report is marked as closed as the other reports will be triaged. We appreciate your adherence to responsible disclosure guidelines and look forward to your future participation in the program.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThank you for your submission to Yahoo’s Bug Bounty program. There were similar reports submitted, this report is marked as closed as the other reports will be triaged. We appreciate your adherence to responsible disclosure guidelines and look forward to your future participation in the program.\u003c/p\u003e\n"},{"id":687,"category":"researcher","content":"My initial report:\n\nBy design, the YQL and Pipes interfaces process URL submitted by users. The \"YahooCacheSystem\" servers will then access the given URL and retrieve its content. This feature could be used in SSRF attacks (CWE-918), for example to scan ports on external servers and access services listening on the loopback interface or located on the same network.\n\nHowever, loopback addresses and non HTTP ports are restricted by the application. But HTTP redirects are followed by the YahooCacheSystem scraper, and the blacklist checks are realized prior redirection. That means that it's possible to use YahooCacheSystem servers to connect to any port on any address, including loopback.\n\nSeveral YQL and Pipes modules are affected. Most of them will emit GET requests and not display any output. However, the Pipes \"Web Service\" module will emit POST requests, and the \"Fetch CSV\" one will disclose banners from non-HTTP services. Finally, YQL table \"uri.data\" sends back an Base64 encoded version of the fetched ressource (image, web page, ...)\n\nIn conclusion, bypassing anti-SSRF blacklists can be used, among others, to scan the loopback interface and enumerate running services and then interact with HTTP(s) ones. Given the bounty rules, I didn't attempt to identify and scan internal networks.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eMy initial report:\u003c/p\u003e\n\n\u003cp\u003eBy design, the YQL and Pipes interfaces process URL submitted by users. The \u0026quot;YahooCacheSystem\u0026quot; servers will then access the given URL and retrieve its content. This feature could be used in SSRF attacks (CWE-918), for example to scan ports on external servers and access services listening on the loopback interface or located on the same network.\u003c/p\u003e\n\n\u003cp\u003eHowever, loopback addresses and non HTTP ports are restricted by the application. But HTTP redirects are followed by the YahooCacheSystem scraper, and the blacklist checks are realized prior redirection. That means that it\u0026#39;s possible to use YahooCacheSystem servers to connect to any port on any address, including loopback.\u003c/p\u003e\n\n\u003cp\u003eSeveral YQL and Pipes modules are affected. Most of them will emit GET requests and not display any output. However, the Pipes \u0026quot;Web Service\u0026quot; module will emit POST requests, and the \u0026quot;Fetch CSV\u0026quot; one will disclose banners from non-HTTP services. Finally, YQL table \u0026quot;uri.data\u0026quot; sends back an Base64 encoded version of the fetched ressource (image, web page, ...)\u003c/p\u003e\n\n\u003cp\u003eIn conclusion, bypassing anti-SSRF blacklists can be used, among others, to scan the loopback interface and enumerate running services and then interact with HTTP(s) ones. Given the bounty rules, I didn\u0026#39;t attempt to identify and scan internal networks.\u003c/p\u003e\n"}]}