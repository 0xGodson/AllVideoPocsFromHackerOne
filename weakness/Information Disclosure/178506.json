{"id":178506,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzg1MDY=","url":"https://hackerone.com/reports/178506","title":"Access private list metadata","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-27T23:17:56.864Z","submitted_at":"2016-10-27T23:17:56.864Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sameoldstory","url":"/sameoldstory","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-24T08:35:09.037Z","bug_reporter_agreed_on_going_public_at":"2016-11-24T08:35:08.129Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Overview\n\nWhen user creates a list, they can choose to not make it public. However the attacker can still access the information that user chose to hide.\n\n# Steps to Reproduce\n\n1. Log in to Instacart.\n2. Choose a private list that you want to see, for example the one with id = 10.\n3. Go to https://www.instacart.com/api/v2/recipes/10\n4. Response reveals all metadata of the list including title, description and image.\n\n# Security Implications\n\nThe attacker can use this vulnerability to obtain metadata of any list regardless of what the visible flag is set to. Also, since list id is incremental it's easy to fetch metadata for all Instacart lists, both public and private.","vulnerability_information_html":"\u003ch1 id=\"overview\"\u003eOverview\u003c/h1\u003e\n\n\u003cp\u003eWhen user creates a list, they can choose to not make it public. However the attacker can still access the information that user chose to hide.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eLog in to Instacart.\u003c/li\u003e\n\u003cli\u003eChoose a private list that you want to see, for example the one with id = 10.\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.instacart.com/api/v2/recipes/10\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fapi%2Fv2%2Frecipes%2F10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/api/v2/recipes/10\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eResponse reveals all metadata of the list including title, description and image.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"security-implications\"\u003eSecurity Implications\u003c/h1\u003e\n\n\u003cp\u003eThe attacker can use this vulnerability to obtain metadata of any list regardless of what the visible flag is set to. Also, since list id is incremental it\u0026#39;s easy to fetch metadata for all Instacart lists, both public and private.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-24T08:35:08.175Z","allow_singular_disclosure_after":-126648542.8270443,"singular_disclosure_allowed":true,"vote_count":6,"voters":["madrobot","eveeez","jens","spetr0x","laulau123","sa_legion"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1273484,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hello @sameoldstory,\n\nThank you for the report. However this list is marked as visible: true. When creating a new list/recipe you can mark these as public/visible. \n\nI'll close this as non applicable.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/sameoldstory\"\u003e@sameoldstory\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. However this list is marked as visible: true. When creating a new list/recipe you can mark these as public/visible. \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll close this as non applicable.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T20:23:27.281Z","updated_at":"2016-10-28T20:23:27.281Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1273538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The thing is, this endpoint shows any list as `visible: true`. You need some other source of truth to verify the actual value of the flag. I use `/api/v2/lists/10` for this purpose, but you can look directly into the database.","markdown_message":"\u003cp\u003eThe thing is, this endpoint shows any list as \u003ccode\u003evisible: true\u003c/code\u003e. You need some other source of truth to verify the actual value of the flag. I use \u003ccode\u003e/api/v2/lists/10\u003c/code\u003e for this purpose, but you can look directly into the database.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T21:02:56.959Z","updated_at":"2016-10-28T21:02:56.959Z","actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1277126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry if I'm not making myself clear. What I want to say is that the list I referenced in the report is in fact a private list. It is one of the first lists on Instacart, created in 2013 by Apoorva himself. Also the one I leaked in #162822 and hacked in #173969.\n\nTry visit https://www.instacart.com/api/v2/lists/10 or https://www.instacart.com/store/giant/lists/7bHoerQ to see that you don't have access to it.","markdown_message":"\u003cp\u003eSorry if I\u0026#39;m not making myself clear. What I want to say is that the list I referenced in the report is in fact a private list. It is one of the first lists on Instacart, created in 2013 by Apoorva himself. Also the one I leaked in \u003ca href=\"/reports/162822\"\u003e#162822\u003c/a\u003e and hacked in \u003ca href=\"/reports/173969\"\u003e#173969\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eTry visit \u003ca title=\"https://www.instacart.com/api/v2/lists/10\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fapi%2Fv2%2Flists%2F10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/api/v2/lists/10\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or \u003ca title=\"https://www.instacart.com/store/giant/lists/7bHoerQ\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fstore%2Fgiant%2Flists%2F7bHoerQ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/store/giant/lists/7bHoerQ\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to see that you don\u0026#39;t have access to it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-31T21:25:52.940Z","updated_at":"2016-10-31T21:25:52.940Z","actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1280751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@cxmcc-instacart Maybe you can help me this time as well?","markdown_message":"\u003cp\u003e\u003ca href=\"/cxmcc-instacart\"\u003e@cxmcc-instacart\u003c/a\u003e Maybe you can help me this time as well?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-02T17:21:43.400Z","updated_at":"2016-11-02T17:21:43.400Z","actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1280920,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"@sameoldstory You are totally right, this is a real issue. Reopening the report.","markdown_message":"\u003cp\u003e\u003ca href=\"/sameoldstory\"\u003e@sameoldstory\u003c/a\u003e You are totally right, this is a real issue. Reopening the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-02T18:54:11.172Z","updated_at":"2016-11-02T18:54:11.172Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1280922,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T18:54:27.624Z","updated_at":"2016-11-02T18:54:27.624Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":5583},"actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1280923,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T18:54:35.267Z","updated_at":"2016-11-02T18:54:35.267Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1316684,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should now be fixed.","markdown_message":"\u003cp\u003eThis should now be fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-24T01:06:11.071Z","updated_at":"2016-11-24T01:06:11.071Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sameoldstory","url":"/sameoldstory"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1316685,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks a lot for the report!","markdown_message":"\u003cp\u003eThanks a lot for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-24T01:06:21.565Z","updated_at":"2016-11-24T01:06:21.565Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"sameoldstory","url":"/sameoldstory"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1317181,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-24T08:35:08.149Z","updated_at":"2016-11-24T08:35:08.149Z","first_to_agree":true,"actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1384557,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-24T08:35:09.060Z","updated_at":"2016-12-24T08:35:09.060Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}