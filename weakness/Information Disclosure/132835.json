{"id":132835,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzI4MzU=","url":"https://hackerone.com/reports/132835","title":"Cache-Control Misconfiguration Leads to Sensitive Information Leakage","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-20T09:16:30.163Z","submitted_at":"2016-04-20T09:16:30.163Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-18T01:47:58.812Z","bug_reporter_agreed_on_going_public_at":"2017-02-18T01:47:58.724Z","team_member_agreed_on_going_public_at":"2017-02-18T01:40:39.362Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis is a issue related with cache and information disclosure. Generally when a user is logged out, the session gets terminated and no data is of the previous session is accessible. But when cache control is not configured correctly, Sensitive data leak over browser even after user have logged out. \n\nNewrelic is not completely vulnerable to this issue and there are pages where cache-control is marked as no-store, however there were several pages containing sensitive info (EG: API KEYS, Billing Info) which are not secured against this vulnerability.\n\nReproduction Steps: (POC Attached)\n\n1) Login to Newrelic main-site \n2) Navigate to Any Vulnerable Page Containing Sensitive Info\n3) For Instance, these are some pages I could collect to easily explain you the issue,\n\ni) https://rpm.newrelic.com/accounts/1311363/integrations?page=api_keys\nii) https://rpm.newrelic.com/accounts/1311363/payments\niii) https://rpm.newrelic.com/accounts/1311363/integrations?page=data_sharing\niv) many more pages are vulnerable\n\nNote: After you're done, just log out directly from this page\n4) Once logged out, hit the 'Back' Button in browser\n\nNote: This issue supports all modern browsers\n\nObservation: You will notice you are landed back to the authenticated page, although it will look authenticated, it wont actually be but you will still be able to read/copy the sensitive info that page contains. This is just about sensitive data leakage as any attacker / malicious-user could do the same with the victim's account.\n\nAlthough the exploitation involves physical access to the victim's PC, I have several scenarios where you will find that this issue can't be left as the responsibility of the user to be taken care of.\n\n1) In a office scenario it is not very difficult to access someone's PC \n2) In a laptop case, someone can get their hands on to it quite easily\n\nAs Newrelic is all about data and analytics, I believe this this is a issue which definitely needs to be fixed. I'd like to help you to fix it so below are the remediation details.\n\nRemediation :\n\nYour devops can implement these headers to mitigate this issue, however there could be better alternatives also which they might want to fit instead of this one. This is just a suggestion :)\n\nheader(\"Cache-Control: no-store, no-cache, must-revalidate\");\n\nHere, \"no-store\" is most important to be implemented.\n\nRequest Note: Even after my explanation, if you believe this issue is not important to be addressed then please mark the report as 'Informative' and not 'N/A'.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis is a issue related with cache and information disclosure. Generally when a user is logged out, the session gets terminated and no data is of the previous session is accessible. But when cache control is not configured correctly, Sensitive data leak over browser even after user have logged out. \u003c/p\u003e\n\n\u003cp\u003eNewrelic is not completely vulnerable to this issue and there are pages where cache-control is marked as no-store, however there were several pages containing sensitive info (EG: API KEYS, Billing Info) which are not secured against this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eReproduction Steps: (POC Attached)\u003c/p\u003e\n\n\u003cp\u003e1) Login to Newrelic main-site \u003cbr\u003e\n2) Navigate to Any Vulnerable Page Containing Sensitive Info\u003cbr\u003e\n3) For Instance, these are some pages I could collect to easily explain you the issue,\u003c/p\u003e\n\n\u003cp\u003ei) \u003ca title=\"https://rpm.newrelic.com/accounts/1311363/integrations?page=api_keys\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2Faccounts%2F1311363%2Fintegrations%3Fpage%3Dapi_keys\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/accounts/1311363/integrations?page=api_keys\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nii) \u003ca title=\"https://rpm.newrelic.com/accounts/1311363/payments\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2Faccounts%2F1311363%2Fpayments\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/accounts/1311363/payments\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\niii) \u003ca title=\"https://rpm.newrelic.com/accounts/1311363/integrations?page=data_sharing\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2Faccounts%2F1311363%2Fintegrations%3Fpage%3Ddata_sharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/accounts/1311363/integrations?page=data_sharing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\niv) many more pages are vulnerable\u003c/p\u003e\n\n\u003cp\u003eNote: After you\u0026#39;re done, just log out directly from this page\u003cbr\u003e\n4) Once logged out, hit the \u0026#39;Back\u0026#39; Button in browser\u003c/p\u003e\n\n\u003cp\u003eNote: This issue supports all modern browsers\u003c/p\u003e\n\n\u003cp\u003eObservation: You will notice you are landed back to the authenticated page, although it will look authenticated, it wont actually be but you will still be able to read/copy the sensitive info that page contains. This is just about sensitive data leakage as any attacker / malicious-user could do the same with the victim\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003eAlthough the exploitation involves physical access to the victim\u0026#39;s PC, I have several scenarios where you will find that this issue can\u0026#39;t be left as the responsibility of the user to be taken care of.\u003c/p\u003e\n\n\u003cp\u003e1) In a office scenario it is not very difficult to access someone\u0026#39;s PC \u003cbr\u003e\n2) In a laptop case, someone can get their hands on to it quite easily\u003c/p\u003e\n\n\u003cp\u003eAs Newrelic is all about data and analytics, I believe this this is a issue which definitely needs to be fixed. I\u0026#39;d like to help you to fix it so below are the remediation details.\u003c/p\u003e\n\n\u003cp\u003eRemediation :\u003c/p\u003e\n\n\u003cp\u003eYour devops can implement these headers to mitigate this issue, however there could be better alternatives also which they might want to fit instead of this one. This is just a suggestion :)\u003c/p\u003e\n\n\u003cp\u003eheader(\u0026quot;Cache-Control: no-store, no-cache, must-revalidate\u0026quot;);\u003c/p\u003e\n\n\u003cp\u003eHere, \u0026quot;no-store\u0026quot; is most important to be implemented.\u003c/p\u003e\n\n\u003cp\u003eRequest Note: Even after my explanation, if you believe this issue is not important to be addressed then please mark the report as \u0026#39;Informative\u0026#39; and not \u0026#39;N/A\u0026#39;.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-20T01:40:39.384Z","allow_singular_disclosure_after":-119241879.32163776,"singular_disclosure_allowed":true,"vote_count":24,"voters":["whhackersbr","geekboy","bugdiscloseguys","mpz","eveeez","an0nym0us","vulnh0lic","securitybreaker","czd","t-4-y-m","and 14 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":921377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for reporting this issue. We have chosen to not apply caching prevention across all of rpm.newrelic.com for performance reasons but as you pointed out, we do have caching prevention in place across pages containing sensitive info. You've identified a few more pages that we agree probably should have caching prevention applied and we're going to file a ticket with the appropriate engineering team to do so. Thanks ! ","markdown_message":"\u003cp\u003eHi, thanks for reporting this issue. We have chosen to not apply caching prevention across all of rpm.newrelic.com for performance reasons but as you pointed out, we do have caching prevention in place across pages containing sensitive info. You\u0026#39;ve identified a few more pages that we agree probably should have caching prevention applied and we\u0026#39;re going to file a ticket with the appropriate engineering team to do so. Thanks ! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T21:14:28.984Z","updated_at":"2016-04-21T21:14:28.984Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great.. \nnice to hear that !","markdown_message":"\u003cp\u003eGreat.. \u003cbr\u003e\nnice to hear that !\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T21:24:14.032Z","updated_at":"2016-04-21T21:24:14.032Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@imelven As you have agreed to fix the issue wherever necessary, can you please mark this as 'triaged' on Hackerone. This will help me to earn points for a valid submission on H1 and might probably help you to track this issue as well :)\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/imelven\"\u003e@imelven\u003c/a\u003e As you have agreed to fix the issue wherever necessary, can you please mark this as \u0026#39;triaged\u0026#39; on Hackerone. This will help me to earn points for a valid submission on H1 and might probably help you to track this issue as well :)\u003cbr\u003e\nThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T22:05:43.206Z","updated_at":"2016-04-21T22:05:43.206Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi - sure ! Our internal process is to mark issues as triaged when we've filed the ticket in our bug tracker system. As soon as I can get to filing the ticket, I'll change the status. Thanks ! ","markdown_message":"\u003cp\u003eHi - sure ! Our internal process is to mark issues as triaged when we\u0026#39;ve filed the ticket in our bug tracker system. As soon as I can get to filing the ticket, I\u0026#39;ll change the status. Thanks ! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-21T23:03:23.765Z","updated_at":"2016-04-21T23:03:23.765Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921692,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-22T00:17:39.001Z","updated_at":"2016-04-22T00:17:39.001Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nIt has been quite a while since I reported this, could you please provide an update on this report?","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eIt has been quite a while since I reported this, could you please provide an update on this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T18:20:41.980Z","updated_at":"2016-05-05T18:20:41.980Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, it's in the queue for the appropriate Engineering team - no further updates at this time. ","markdown_message":"\u003cp\u003eHi, it\u0026#39;s in the queue for the appropriate Engineering team - no further updates at this time. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T18:34:26.793Z","updated_at":"2016-05-05T18:34:26.793Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":962123,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-17T20:31:23.183Z","updated_at":"2016-05-17T20:31:23.183Z","additional_data":{"duplicate_report_id":139185},"actor":{"username":"czd","cleared":false,"url":"/czd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/207/843971a1feaf4317fb2a95da63c5ffbf95447ae0_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1096662,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!","markdown_message":"\u003cp\u003eWe believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-30T00:22:53.967Z","updated_at":"2016-07-30T00:22:53.967Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-18T01:40:39.374Z","updated_at":"2017-02-18T01:40:39.374Z","first_to_agree":true,"actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492484,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-18T01:47:58.781Z","updated_at":"2017-02-18T01:47:58.781Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1492485,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-18T01:47:58.827Z","updated_at":"2017-02-18T01:47:58.827Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2694213,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-03T03:28:02.005Z","updated_at":"2018-05-03T03:28:02.005Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}