{"id":301526,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDE1MjY=","url":"https://hackerone.com/reports/301526","title":"Invitation token leaks to https://bat.bing.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-12-31T12:10:46.226Z","submitted_at":"2017-12-31T12:10:46.226Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zuriel","url":"/zuriel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-01-11T18:57:53.679Z","bug_reporter_agreed_on_going_public_at":"2018-01-11T18:57:53.023Z","team_member_agreed_on_going_public_at":"2018-01-11T17:15:38.431Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\n\nInvitation page contains iframes that points to https://b5s.hackerone-ext-content.com/#!/invitations/\u003cinvitation token\u003e and https://a4l.hackerone-ext-content.com/#!/invitations/\u003cinvitation token\u003e. A *GET* request to these endpoints executes a script that points to `https://bat.bing.com/bat.js`. The corresponding request to bing contains the invitation tokens.\n\n**Description**\n\nWhile checking the source code of an team invitation page (https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc), I found two iframe links - `https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc` and `https://a4l.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc` where `8e44119f60be8670d1e3f99a01359cbc`is the invitation token. {F250542}\n\n\nTo find out more about these endpoints,i issued a simple GET requests to these urls. GET requests to these endpoints returned a page that contains a script that points to - `https://bat.bing.com/bat.js`.\n\nThe response of the GET request to https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc looks as follows: \n\n```\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\u003c/head\u003e\n  \u003cbody style=\"background-color: transparent\"\u003e\n    \u003cscript\u003e\n      (function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:\"5295042\"};o.q=w[u],w[u]=new UET(o),w[u].push(\"pageLoad\")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s\u0026\u0026s!==\"loaded\"\u0026\u0026s!==\"complete\"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,\"script\",\"https://bat.bing.com/bat.js\",\"uetq\");\n    \u003c/script\u003e\n    \u003cnoscript\u003e\n      \u003cimg src=\"//bat.bing.com/action/0?ti=5295042\u0026Ver=2\" height=\"0\" width=\"0\" style=\"display:none; visibility: hidden;\" /\u003e\n    \u003c/noscript\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nAs we can see the page calls a script at `https://bat.bing.com/bat.js` and the script is executed. \n\nThe script fires a corresponding request to bat.bing.com that contains the invitation token. It looks as follows:\n\n```\nhttps://bat.bing.com/action/0?ti=5295042\u0026Ver=2\u0026mid=ab8e7bd3-541b-59ea-0551-7041b2ede6e3\u0026evt=pageLoad\u0026sid=bbebc657-0\u0026lt=127\u0026pi=1001431019\u0026lg=en-US\u0026sw=1366\u0026sh=768\u0026sc=24\u0026p=https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u0026r=\u0026msclkid=N\u0026rn=664767\n```\n\nThe `p` parameter contains the entire url along with the invitation token - `p=https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc` where `8e44119f60be8670d1e3f99a01359cbc`is the invitation token.\n\nThus the invitation token is sent to bat.bing.com as a part of the request.\n\n## Impact\n\n1. Leaking member invitation tokens can reveal pretty much everything about a program. \n1. Private programs could be adversely affected by leaking private invitation tokens.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eInvitation page contains iframes that points to \u003ca title=\"https://b5s.hackerone-ext-content.com/#!/invitations/\" href=\"/redirect?url=https%3A%2F%2Fb5s.hackerone-ext-content.com%2F%23%21%2Finvitations%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://b5s.hackerone-ext-content.com/#!/invitations/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;invitation token\u0026gt; and \u003ca title=\"https://a4l.hackerone-ext-content.com/#!/invitations/\" href=\"/redirect?url=https%3A%2F%2Fa4l.hackerone-ext-content.com%2F%23%21%2Finvitations%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://a4l.hackerone-ext-content.com/#!/invitations/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;invitation token\u0026gt;. A \u003cem\u003eGET\u003c/em\u003e request to these endpoints executes a script that points to \u003ccode\u003ehttps://bat.bing.com/bat.js\u003c/code\u003e. The corresponding request to bing contains the invitation tokens.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eWhile checking the source code of an team invitation page (\u003ca title=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\"\u003ehttps://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/a\u003e), I found two iframe links - \u003ccode\u003ehttps://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003e and \u003ccode\u003ehttps://a4l.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003e where \u003ccode\u003e8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003eis the invitation token. \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"bl1.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/542/3f971cfcde7ebce7a37941a9ab9805f7976ea13e/bl1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bl1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bl1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=6f3ddb2f3ccee61d30641744632797f05cc4d10649f01140e43c136f1afcdeeb\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/542/3f971cfcde7ebce7a37941a9ab9805f7976ea13e/bl1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bl1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bl1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=6f3ddb2f3ccee61d30641744632797f05cc4d10649f01140e43c136f1afcdeeb\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTo find out more about these endpoints,i issued a simple GET requests to these urls. GET requests to these endpoints returned a page that contains a script that points to - \u003ccode\u003ehttps://bat.bing.com/bat.js\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe response of the GET request to \u003ca title=\"https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"/redirect?url=https%3A%2F%2Fb5s.hackerone-ext-content.com%2F%23%21%2Finvitations%2F8e44119f60be8670d1e3f99a01359cbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e looks as follows: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u0026lt;/head\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;background-color: transparent\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"p\"\u003e[],\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003eti\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e5295042\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUET\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"nx\"\u003ew\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epageLoad\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)},\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003easync\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonload\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonreadystatechange\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereadyState\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e!==\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eloaded\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e!==\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ecomplete\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonload\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonreadystatechange\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)},\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementsByTagName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparentNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einsertBefore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)})(\u003c/span\u003e\u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003escript\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://bat.bing.com/bat.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003euetq\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;noscript\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;img\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;//bat.bing.com/action/0?ti=5295042\u0026amp;Ver=2\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;display:none; visibility: hidden;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/noscript\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs we can see the page calls a script at \u003ccode\u003ehttps://bat.bing.com/bat.js\u003c/code\u003e and the script is executed. \u003c/p\u003e\n\n\u003cp\u003eThe script fires a corresponding request to bat.bing.com that contains the invitation token. It looks as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://bat.bing.com/action/0?ti=5295042\u0026amp;Ver=2\u0026amp;mid=ab8e7bd3-541b-59ea-0551-7041b2ede6e3\u0026amp;evt=pageLoad\u0026amp;sid=bbebc657-0\u0026amp;lt=127\u0026amp;pi=1001431019\u0026amp;lg=en-US\u0026amp;sw=1366\u0026amp;sh=768\u0026amp;sc=24\u0026amp;p=https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u0026amp;r=\u0026amp;msclkid=N\u0026amp;rn=664767\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003ep\u003c/code\u003e parameter contains the entire url along with the invitation token - \u003ccode\u003ep=https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003e where \u003ccode\u003e8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003eis the invitation token.\u003c/p\u003e\n\n\u003cp\u003eThus the invitation token is sent to bat.bing.com as a part of the request.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLeaking member invitation tokens can reveal pretty much everything about a program. \u003c/li\u003e\n\u003cli\u003ePrivate programs could be adversely affected by leaking private invitation tokens.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":250542,"file_name":"bl1.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/542/3f971cfcde7ebce7a37941a9ab9805f7976ea13e/bl1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bl1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bl1.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052914Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=6f3ddb2f3ccee61d30641744632797f05cc4d10649f01140e43c136f1afcdeeb","file_size":95937,"type":"image/png"}],"allow_singular_disclosure_at":"2018-02-10T17:15:38.611Z","allow_singular_disclosure_after":-90936816.16886045,"singular_disclosure_allowed":true,"vote_count":33,"voters":["jokebookservice1","byq","europa","bl4de","flashdisk","dmatrix","asad0x01_","muhammad_uwais","eveeez","r3y","and 23 more..."],"severity":{"rating":"low","score":2.7,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2254340,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting @zuriel, we're looking into this and will get back to you shortly.\n\nKind regards,\n@asuka ","markdown_message":"\u003cp\u003eThanks for reporting \u003ca href=\"/zuriel\"\u003e@zuriel\u003c/a\u003e, we\u0026#39;re looking into this and will get back to you shortly.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/asuka\"\u003e@asuka\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-31T23:06:41.330Z","updated_at":"2017-12-31T23:06:41.330Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2256231,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @zuriel - thanks for your reporting. However, I have some trouble reproducing your report. When I go to the page, both authenticated and unauthenticated, I don't see any iframes. Perhaps this is a browser extension that does this. Can you help me reproduce the bug? Thanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zuriel\"\u003e@zuriel\u003c/a\u003e - thanks for your reporting. However, I have some trouble reproducing your report. When I go to the page, both authenticated and unauthenticated, I don\u0026#39;t see any iframes. Perhaps this is a browser extension that does this. Can you help me reproduce the bug? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-02T17:14:32.538Z","updated_at":"2018-01-02T17:14:32.538Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2256289,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jobert \n\n{F250542}\n\nAs you can see the screenshot I had attached, this is from the latest firefox quantum version 57.0.3.\n\nWell you could try these steps:\n\n 1. Visit https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\n 2. Click developer options and select network tab.\n \nI think you are probably looking at the inspector tab. \n\nActually there is no much significance to the iframe here. I just spotted the urls that was leaking the tokens in the iframes.  \n\nYou could simply visit any of these urls:\n\n+ https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\n+ https://a4l.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\n\n1. A simple GET request to any of these above  links should be enough. \n2. Capture the traffic following the GET request, \n3. Meanwhile you can inspect the source of above pages and find the script that points to bat.bing.com/bat.js\n4. A request to https://bat.bing.com should be recorded, that contains the above invitation tokens. \n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"bl1.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/542/3f971cfcde7ebce7a37941a9ab9805f7976ea13e/bl1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bl1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bl1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=6f3ddb2f3ccee61d30641744632797f05cc4d10649f01140e43c136f1afcdeeb\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/542/3f971cfcde7ebce7a37941a9ab9805f7976ea13e/bl1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bl1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bl1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=6f3ddb2f3ccee61d30641744632797f05cc4d10649f01140e43c136f1afcdeeb\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAs you can see the screenshot I had attached, this is from the latest firefox quantum version 57.0.3.\u003c/p\u003e\n\n\u003cp\u003eWell you could try these steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVisit \u003ca title=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\"\u003ehttps://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick developer options and select network tab.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI think you are probably looking at the inspector tab. \u003c/p\u003e\n\n\u003cp\u003eActually there is no much significance to the iframe here. I just spotted the urls that was leaking the tokens in the iframes.  \u003c/p\u003e\n\n\u003cp\u003eYou could simply visit any of these urls:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"/redirect?url=https%3A%2F%2Fb5s.hackerone-ext-content.com%2F%23%21%2Finvitations%2F8e44119f60be8670d1e3f99a01359cbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://a4l.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"/redirect?url=https%3A%2F%2Fa4l.hackerone-ext-content.com%2F%23%21%2Finvitations%2F8e44119f60be8670d1e3f99a01359cbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://a4l.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003col\u003e\n\u003cli\u003eA simple GET request to any of these above  links should be enough. \u003c/li\u003e\n\u003cli\u003eCapture the traffic following the GET request, \u003c/li\u003e\n\u003cli\u003eMeanwhile you can inspect the source of above pages and find the script that points to bat.bing.com/bat.js\u003c/li\u003e\n\u003cli\u003eA request to \u003ca title=\"https://bat.bing.com\" href=\"/redirect?url=https%3A%2F%2Fbat.bing.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bat.bing.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e should be recorded, that contains the above invitation tokens. \u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-01-02T17:35:51.541Z","updated_at":"2018-01-02T17:35:51.541Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2256301,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-02T17:38:23.147Z","updated_at":"2018-01-02T17:38:23.147Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":104909,"new_severity_id":105188},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2256302,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"My bad, I now see them. We'll get this fixed. Thanks for your follow up!","markdown_message":"\u003cp\u003eMy bad, I now see them. We\u0026#39;ll get this fixed. Thanks for your follow up!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-02T17:38:25.868Z","updated_at":"2018-01-02T17:38:25.868Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2256416,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert \n\n##IMPACT\n\n1. The invitation token link contains sensitive information like the invitee's **email address**. \n\n2. So we are indirectly disclosing the email address of a hackerone user by leaking invitation tokens. \n\n```\n{\n\t\"token\": \"8e44119f60be8670d1e3f99a01359cbc\",\n\t\"type\": \"Invitations::TeamMember\",\n\t\"auth_option\": \"use-existing-account\",\n\t\"email\": \"dedgesw@mailinator.com\",\n\t\"status\": \"never\",\n\t\"expires_at\": null,\n\t\"invited_by\": {\n\t\t\"username\": \"zuriel\",\n\t\t\"profile_picture\": \"https://profile-photos.hackerone-user-content.com/production/000/217/627/54b42b13cf3eb23bb53437284bf20b09c4281e03_emailmedium.jpg?1510843440\",\n\t\t\"url\": \"https://hackerone.com/zuriel\"\n\t},\n\t\"team\": {\n\t\t\"name\": \"zurieltest\",\n\t\t\"handle\": \"zurieltest\",\n\t\t\"state\": \"sandboxed\",\n\t\t\"profile_picture\": \"https://profile-photos.hackerone-user-content.com/production/000/025/196/f11ba319087149ad4d02df4d146dc290a321904c_emailmedium.png?1514530478\",\n\t\t\"url\": \"https://hackerone.com/zurieltest\",\n\t\t\"team_members\": [{\n\t\t\t\"username\": \"secret_api_token_identifier\"\n\t\t}, {\n\t\t\t\"username\": \"zuriel\"\n\t\t}, {\n\t\t\t\"username\": \"demo-member\"\n\t\t}]\n\t}\n}\n```\n\n As we can see the email address of the invitee team member is returned if we visit the invitation link - `https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc`\n\nHence, Anyone with invitation link can also see the **email id** of the new team member. \n\n**I request you to please reconsider the severity!**\n\nThanks","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e \u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eIMPACT\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eThe invitation token link contains sensitive information like the invitee\u0026#39;s \u003cstrong\u003eemail address\u003c/strong\u003e. \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSo we are indirectly disclosing the email address of a hackerone user by leaking invitation tokens. \u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026quot;token\u0026quot;: \u0026quot;8e44119f60be8670d1e3f99a01359cbc\u0026quot;,\n    \u0026quot;type\u0026quot;: \u0026quot;Invitations::TeamMember\u0026quot;,\n    \u0026quot;auth_option\u0026quot;: \u0026quot;use-existing-account\u0026quot;,\n    \u0026quot;email\u0026quot;: \u0026quot;dedgesw@mailinator.com\u0026quot;,\n    \u0026quot;status\u0026quot;: \u0026quot;never\u0026quot;,\n    \u0026quot;expires_at\u0026quot;: null,\n    \u0026quot;invited_by\u0026quot;: {\n        \u0026quot;username\u0026quot;: \u0026quot;zuriel\u0026quot;,\n        \u0026quot;profile_picture\u0026quot;: \u0026quot;https://profile-photos.hackerone-user-content.com/production/000/217/627/54b42b13cf3eb23bb53437284bf20b09c4281e03_emailmedium.jpg?1510843440\u0026quot;,\n        \u0026quot;url\u0026quot;: \u0026quot;https://hackerone.com/zuriel\u0026quot;\n    },\n    \u0026quot;team\u0026quot;: {\n        \u0026quot;name\u0026quot;: \u0026quot;zurieltest\u0026quot;,\n        \u0026quot;handle\u0026quot;: \u0026quot;zurieltest\u0026quot;,\n        \u0026quot;state\u0026quot;: \u0026quot;sandboxed\u0026quot;,\n        \u0026quot;profile_picture\u0026quot;: \u0026quot;https://profile-photos.hackerone-user-content.com/production/000/025/196/f11ba319087149ad4d02df4d146dc290a321904c_emailmedium.png?1514530478\u0026quot;,\n        \u0026quot;url\u0026quot;: \u0026quot;https://hackerone.com/zurieltest\u0026quot;,\n        \u0026quot;team_members\u0026quot;: [{\n            \u0026quot;username\u0026quot;: \u0026quot;secret_api_token_identifier\u0026quot;\n        }, {\n            \u0026quot;username\u0026quot;: \u0026quot;zuriel\u0026quot;\n        }, {\n            \u0026quot;username\u0026quot;: \u0026quot;demo-member\u0026quot;\n        }]\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs we can see the email address of the invitee team member is returned if we visit the invitation link - \u003ccode\u003ehttps://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eHence, Anyone with invitation link can also see the \u003cstrong\u003eemail id\u003c/strong\u003e of the new team member. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eI request you to please reconsider the severity!\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-02T18:26:17.667Z","updated_at":"2018-01-02T18:26:17.667Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2256718,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-02T20:12:17.366Z","updated_at":"2018-01-02T20:12:17.366Z","additional_data":{"old_severity":"None","new_severity":"Low (2.7)","old_severity_id":105188,"new_severity_id":105221},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2265018,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @zuriel - this would only be a problem for users that are not known in our database. When it's a known user, other users can't view the invitation. Since it could disclosed other people their email addresses, we're awarding our minimum bounty here. Thanks again and happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zuriel\"\u003e@zuriel\u003c/a\u003e - this would only be a problem for users that are not known in our database. When it\u0026#39;s a known user, other users can\u0026#39;t view the invitation. Since it could disclosed other people their email addresses, we\u0026#39;re awarding our minimum bounty here. Thanks again and happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-05T18:25:39.878Z","updated_at":"2018-01-05T18:25:39.878Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"zuriel","url":"/zuriel"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2267241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Update**\n\nNow when we click on https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc, following page:\n\n{F251795}\n\nThe corresponding json response is as follows:\n\n```\n{\n  \"token\": \"8e44119f60be8670d1e3f99a01359cbc\",\n  \"type\": \"Invitations::TeamMember\",\n  \"auth_option\": \"has-no-access\",\n  \"email\": \"dedgesw@mailinator.com\",\n  \"status\": \"never\",\n  \"expires_at\": null,\n  \"recipient\": {\n    \"username\": \"dedgesw\",\n    \"profile_picture\": \"https:\\/\\/profile-photos.hackerone-user-content.com\\/production\\/000\\/228\\/203\\/d47a48354413d3173f4d8a758f1592a2db33f94c_emaillarge.jpg?1514920190\",\n    \"url\": \"https:\\/\\/hackerone.com\\/dedgesw\"\n  }\n}\n```\n\nNow the `auth-option` is changed to `has-no-access`. - Fixed\n\n**But** , now the response also contains **username** of the recipient. Along with the **email-id** of the user. \n\n###IMPACT \n\n1. This  fix is brought about to  prevent misuse of invitation tokens even if an email was hacked. And only the genuine recipient would be able to access it.\n1. But the context of the current report does not involve a email hack. \n1. Now, the _username and email-id_ of users are both disclosed in the response. \n\n","markdown_message":"\u003cp\u003e\u003cstrong\u003eUpdate\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eNow when we click on \u003ca title=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"https://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\"\u003ehttps://hackerone.com/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/a\u003e, following page:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"bx1.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/251/795/4a4501a62c974a070a392a8d497fe375047b017d/bx1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bx1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bx1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=3ebb39ccc10e5dccc517ae56c3fa064fbc093ecfdef99d5be5751ea5b5e317f9\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/251/795/4a4501a62c974a070a392a8d497fe375047b017d/bx1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bx1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bx1.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052914Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026amp;X-Amz-Signature=3ebb39ccc10e5dccc517ae56c3fa064fbc093ecfdef99d5be5751ea5b5e317f9\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe corresponding json response is as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n  \u0026quot;token\u0026quot;: \u0026quot;8e44119f60be8670d1e3f99a01359cbc\u0026quot;,\n  \u0026quot;type\u0026quot;: \u0026quot;Invitations::TeamMember\u0026quot;,\n  \u0026quot;auth_option\u0026quot;: \u0026quot;has-no-access\u0026quot;,\n  \u0026quot;email\u0026quot;: \u0026quot;dedgesw@mailinator.com\u0026quot;,\n  \u0026quot;status\u0026quot;: \u0026quot;never\u0026quot;,\n  \u0026quot;expires_at\u0026quot;: null,\n  \u0026quot;recipient\u0026quot;: {\n    \u0026quot;username\u0026quot;: \u0026quot;dedgesw\u0026quot;,\n    \u0026quot;profile_picture\u0026quot;: \u0026quot;https:\\/\\/profile-photos.hackerone-user-content.com\\/production\\/000\\/228\\/203\\/d47a48354413d3173f4d8a758f1592a2db33f94c_emaillarge.jpg?1514920190\u0026quot;,\n    \u0026quot;url\u0026quot;: \u0026quot;https:\\/\\/hackerone.com\\/dedgesw\u0026quot;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow the \u003ccode\u003eauth-option\u003c/code\u003e is changed to \u003ccode\u003ehas-no-access\u003c/code\u003e. - Fixed\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eBut\u003c/strong\u003e , now the response also contains \u003cstrong\u003eusername\u003c/strong\u003e of the recipient. Along with the \u003cstrong\u003eemail-id\u003c/strong\u003e of the user. \u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eIMPACT\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eThis  fix is brought about to  prevent misuse of invitation tokens even if an email was hacked. And only the genuine recipient would be able to access it.\u003c/li\u003e\n\u003cli\u003eBut the context of the current report does not involve a email hack. \u003c/li\u003e\n\u003cli\u003eNow, the \u003cu\u003eusername and email-id\u003c/u\u003e of users are both disclosed in the response. \u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-01-06T08:53:03.635Z","updated_at":"2018-01-06T09:06:28.516Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":251795,"filename":"bx1.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/251/795/4a4501a62c974a070a392a8d497fe375047b017d/bx1.PNG?response-content-disposition=attachment%3B%20filename%3D%22bx1.PNG%22%3B%20filename%2A%3DUTF-8%27%27bx1.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052914Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=3ebb39ccc10e5dccc517ae56c3fa064fbc093ecfdef99d5be5751ea5b5e317f9"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2267271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nEarlier, the identity of the recipient on an invitation page was unknown. But now the presence of **username** discloses the recipient identity. Already mentioned [above](https://hackerone.com/reports/301526#activity-2267241)\n\nShould this be submitted as a new report?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eEarlier, the identity of the recipient on an invitation page was unknown. But now the presence of \u003cstrong\u003eusername\u003c/strong\u003e discloses the recipient identity. Already mentioned \u003ca href=\"https://hackerone.com/reports/301526#activity-2267241\"\u003eabove\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eShould this be submitted as a new report?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-06T09:46:22.911Z","updated_at":"2018-01-06T09:58:40.964Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2270365,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zuriel No, no need to file a new report. I'll check with some people on our side what the progress is. Thanks for your patience!","markdown_message":"\u003cp\u003e\u003ca href=\"/zuriel\"\u003e@zuriel\u003c/a\u003e No, no need to file a new report. I\u0026#39;ll check with some people on our side what the progress is. Thanks for your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-08T17:25:10.558Z","updated_at":"2018-01-08T17:25:10.558Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278165,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @zuriel - this should be fixed now. Can you confirm? Thanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zuriel\"\u003e@zuriel\u003c/a\u003e - this should be fixed now. Can you confirm? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T16:47:29.705Z","updated_at":"2018-01-11T16:47:29.705Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"zuriel","url":"/zuriel"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert, \n\nThe invitation page no more contains the iframe links. \n\nBut when I tried visiting the above link - https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc the request to bing still has the invitation tokens. \n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThe invitation page no more contains the iframe links. \u003c/p\u003e\n\n\u003cp\u003eBut when I tried visiting the above link - \u003ca title=\"https://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\" href=\"/redirect?url=https%3A%2F%2Fb5s.hackerone-ext-content.com%2F%23%21%2Finvitations%2F8e44119f60be8670d1e3f99a01359cbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://b5s.hackerone-ext-content.com/#!/invitations/8e44119f60be8670d1e3f99a01359cbc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the request to bing still has the invitation tokens. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T17:06:07.479Z","updated_at":"2018-01-11T17:06:07.479Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278227,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"That's intentional behavior. Before disclosing it, would you mind revoking the invitation? Thanks again, much appreciated!","markdown_message":"\u003cp\u003eThat\u0026#39;s intentional behavior. Before disclosing it, would you mind revoking the invitation? Thanks again, much appreciated!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T17:15:38.489Z","updated_at":"2018-01-11T17:17:39.040Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Invitation has been revoked. Thank you very much for the bounty! \n\nBut what about the presence of **username** and **email-id** on the invitation page? If the invitation token is leaked in a way similar to the scenario as of this report, the username and email-id would be leaked. \n\nCould you confirm whether this  can be tolerated before we disclose this?","markdown_message":"\u003cp\u003eInvitation has been revoked. Thank you very much for the bounty! \u003c/p\u003e\n\n\u003cp\u003eBut what about the presence of \u003cstrong\u003eusername\u003c/strong\u003e and \u003cstrong\u003eemail-id\u003c/strong\u003e on the invitation page? If the invitation token is leaked in a way similar to the scenario as of this report, the username and email-id would be leaked. \u003c/p\u003e\n\n\u003cp\u003eCould you confirm whether this  can be tolerated before we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T17:41:59.741Z","updated_at":"2018-01-11T17:41:59.741Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe that if someone has access to the token, which can only be obtained when someone has access to the user's email inbox, it is fine to show these attributes. We might change this in the future, but up until then, this is fine. Thanks for asking!","markdown_message":"\u003cp\u003eI believe that if someone has access to the token, which can only be obtained when someone has access to the user\u0026#39;s email inbox, it is fine to show these attributes. We might change this in the future, but up until then, this is fine. Thanks for asking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T18:55:51.436Z","updated_at":"2018-01-11T18:55:51.436Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278461,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the confirmation @jobert. Let us disclose this now!","markdown_message":"\u003cp\u003eThanks for the confirmation \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e. Let us disclose this now!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T18:57:53.508Z","updated_at":"2018-01-11T18:57:53.508Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T18:57:53.735Z","updated_at":"2018-01-11T18:57:53.735Z","actor":{"username":"zuriel","cleared":false,"url":"/zuriel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/627/50b5d3118d160c5d1d0728385de090f0567a6170_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}