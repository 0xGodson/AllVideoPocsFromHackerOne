{"id":78012,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODAxMg==","url":"https://hackerone.com/reports/78012","title":"Sensitive server-side/application information disclosure","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-23T02:38:19.517Z","submitted_at":"2015-07-23T02:38:19.517Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sarwar_jahan_m","url":"/sarwar_jahan_m","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-10-30T18:55:32.741Z","bug_reporter_agreed_on_going_public_at":"2015-10-30T18:55:32.582Z","team_member_agreed_on_going_public_at":"2015-10-30T15:42:55.981Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is an Information disclosure vulnerability present  in Keybase API request whenever an exception occurs.\r\n\r\nSteps to reproduce:\r\nOpen the following URL in any browser - https://keybase.io/_/api/1.0/user/lookup.json?twitter=john\u0026github=john\u0026usernames=john\u0026usernames=rock\r\n\r\nObserve that when we add multiple parameter in the query string, an exception occurs. In a result, Keybase throws the server side error message with all details about the exception which contains application specific sensitive information.\r\n\r\nPoC: refer the attached image\r\nThe Keybase application structure, Back-end program names, Events, Methods everything is getting displayed in the error message.","vulnerability_information_html":"\u003cp\u003eThere is an Information disclosure vulnerability present  in Keybase API request whenever an exception occurs.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\nOpen the following URL in any browser - \u003ca title=\"https://keybase.io/_/api/1.0/user/lookup.json?twitter=john\u0026amp;github=john\u0026amp;usernames=john\u0026amp;usernames=rock\" href=\"/redirect?url=https%3A%2F%2Fkeybase.io%2F_%2Fapi%2F1.0%2Fuser%2Flookup.json%3Ftwitter%3Djohn%26github%3Djohn%26usernames%3Djohn%26usernames%3Drock\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://keybase.io/_/api/1.0/user/lookup.json?twitter=john\u0026amp;github=john\u0026amp;usernames=john\u0026amp;usernames=rock\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eObserve that when we add multiple parameter in the query string, an exception occurs. In a result, Keybase throws the server side error message with all details about the exception which contains application specific sensitive information.\u003c/p\u003e\n\n\u003cp\u003ePoC: refer the attached image\u003cbr\u003e\nThe Keybase application structure, Back-end program names, Events, Methods everything is getting displayed in the error message.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":46624,"file_name":"InfoDisc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/624/6ba7108cbf58a9306e28c0d48c5bff166d8500ef/InfoDisc.png?response-content-disposition=attachment%3B%20filename%3D%22InfoDisc.png%22%3B%20filename%2A%3DUTF-8%27%27InfoDisc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065105Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=47ac776ca8201c4b957d0759f60579b13b4b6d597d62e0e41465f78bbd808370","file_size":132030,"type":"image/png"}],"allow_singular_disclosure_at":"2015-11-29T15:42:56.106Z","allow_singular_disclosure_after":-160412889.82586753,"singular_disclosure_allowed":true,"vote_count":1,"voters":["armansameer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":522160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note:\nMultiple parameter with same name, for example - I added same parameter \"usernames\" twice in the query string with different values to perform the attack.","markdown_message":"\u003cp\u003eNote:\u003cbr\u003e\nMultiple parameter with same name, for example - I added same parameter \u0026quot;usernames\u0026quot; twice in the query string with different values to perform the attack.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-23T10:07:07.794Z","updated_at":"2015-07-23T10:07:35.319Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":555812,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chriscoyne,\nIt seems the vulnerability is fixed. But i have not received any confirmation.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chriscoyne\"\u003e@chriscoyne\u003c/a\u003e,\u003cbr\u003e\nIt seems the vulnerability is fixed. But i have not received any confirmation.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-20T12:44:25.249Z","updated_at":"2015-08-20T12:50:04.002Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":557096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any Updates ??","markdown_message":"\u003cp\u003eAny Updates ??\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-21T07:20:00.516Z","updated_at":"2015-08-21T07:20:00.516Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":558290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chriscoyne: Waiting for your reply !!","markdown_message":"\u003cp\u003e\u003ca href=\"/chriscoyne\"\u003e@chriscoyne\u003c/a\u003e: Waiting for your reply !!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-22T04:22:47.947Z","updated_at":"2015-08-22T04:22:47.947Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":563688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any Updates ??","markdown_message":"\u003cp\u003eAny Updates ??\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-26T08:16:22.048Z","updated_at":"2015-08-26T08:16:22.048Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":578297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey guys.....:(\nCan I expect an update here !!!!","markdown_message":"\u003cp\u003eHey guys.....:(\u003cbr\u003e\nCan I expect an update here !!!!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-05T03:31:44.619Z","updated_at":"2015-09-05T03:31:44.619Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637471,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report, and sorry for the long delay in getting back to you! No sensitive information was being leaked here, but we've fixed errors to not display stack traces.","markdown_message":"\u003cp\u003eThanks for the report, and sorry for the long delay in getting back to you! No sensitive information was being leaked here, but we\u0026#39;ve fixed errors to not display stack traces.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-29T19:09:29.531Z","updated_at":"2015-10-29T19:09:29.531Z","actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sarwar_jahan_m","url":"/sarwar_jahan_m"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":638508,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-30T15:42:56.006Z","updated_at":"2015-10-30T15:42:56.006Z","first_to_agree":true,"actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":638928,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-30T18:55:32.631Z","updated_at":"2015-10-30T18:55:32.631Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":638929,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-30T18:55:32.763Z","updated_at":"2015-10-30T18:55:32.763Z","actor":{"username":"sarwar_jahan_m","cleared":false,"url":"/sarwar_jahan_m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/113/31066f9583304e3fa0005864e6b6737d5249e6cc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2458349,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T14:40:36.510Z","updated_at":"2018-03-05T14:40:36.510Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":341,"category":"researcher","content":"Keybase should not display Server side error messages to end-users. Whenever an exception occurs, Keybase should give a user friendly generic error message which does not contain any sensitive information.\n\nReference:\nhttps://cwe.mitre.org/data/definitions/209.html\nhttps://cwe.mitre.org/data/definitions/200.html","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eKeybase should not display Server side error messages to end-users. Whenever an exception occurs, Keybase should give a user friendly generic error message which does not contain any sensitive information.\u003c/p\u003e\n\n\u003cp\u003eReference:\u003cbr\u003e\n\u003ca title=\"https://cwe.mitre.org/data/definitions/209.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F209.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/209.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://cwe.mitre.org/data/definitions/200.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F200.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/200.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}