{"id":152669,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI2Njk=","url":"https://hackerone.com/reports/152669","title":"Users enumeration is possible through cycling through recurring[client_id] argument value.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-20T20:39:02.128Z","submitted_at":"2016-07-20T20:39:02.128Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xamir","url":"/0xamir","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/124/1b521ca60048e6145df498b397f6bd086667d18f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-10T15:54:53.060Z","bug_reporter_agreed_on_going_public_at":"2016-08-11T15:54:45.139Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Details:**  \nAn attacker can enumerate the names of companies on your site by going to the URL `https://harvesterxxx.harvestapp.com/recurring_invoices/new?utf8=%E2%9C%93\u0026recurring[client_id]=4677449\u0026new_client[name]=` and cycling through the numerical value of the `recurring[client_id]=` argument, which will view their names in the header of the page.  \n  \n**PoC:**  \n1. Visit the aforementioned URL `https://harvesterxxx.harvestapp.com/recurring_invoices/new?utf8=%E2%9C%93\u0026recurring[client_id]=4677449\u0026new_client[name]=`\n2. increase or decrease the numerical value of the argument `recurring[client_id]=`  \n3. Now you can enumerate through the names of companies on Harvestapp.com  \n  \n*PS: i couldn't really determine whether or not this behavior was intentional or not but when i tried to submit a recurring invoice on behalf of the enumerated users the server returned an error, which led me to think that the names weren't supposed to be shown in the first place since this would fall under \"information disclosure\"*","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDetails:\u003c/strong\u003e\u003cbr\u003e\u003cbr\u003e\nAn attacker can enumerate the names of companies on your site by going to the URL \u003ccode\u003ehttps://harvesterxxx.harvestapp.com/recurring_invoices/new?utf8=%E2%9C%93\u0026amp;recurring[client_id]=4677449\u0026amp;new_client[name]=\u003c/code\u003e and cycling through the numerical value of the \u003ccode\u003erecurring[client_id]=\u003c/code\u003e argument, which will view their names in the header of the page.  \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e  \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVisit the aforementioned URL \u003ccode\u003ehttps://harvesterxxx.harvestapp.com/recurring_invoices/new?utf8=%E2%9C%93\u0026amp;recurring[client_id]=4677449\u0026amp;new_client[name]=\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eincrease or decrease the numerical value of the argument \u003ccode\u003erecurring[client_id]=\u003c/code\u003e\u003cbr\u003e\n\u003c/li\u003e\n\u003cli\u003eNow you can enumerate through the names of companies on Harvestapp.com\u003cbr\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cem\u003ePS: i couldn\u0026#39;t really determine whether or not this behavior was intentional or not but when i tried to submit a recurring invoice on behalf of the enumerated users the server returned an error, which led me to think that the names weren\u0026#39;t supposed to be shown in the first place since this would fall under \u0026quot;information disclosure\u0026quot;\u003c/em\u003e\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-10T15:54:45.229Z","allow_singular_disclosure_after":-135693553.6604641,"singular_disclosure_allowed":true,"vote_count":18,"voters":["bogdantcaciuc","yaworsk","bugdiscloseguys","dilawer01","malcolmx","m16","ymy","exception","jens","fantam1","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1086109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report! We've already fixed this issue — can you check on your end?\n\nWe'll be awarding a bounty, just mind that it might take us a few days to process it.\n\nBest regards,\n\nLorenzo","markdown_message":"\u003cp\u003eThanks for your report! We\u0026#39;ve already fixed this issue — can you check on your end?\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be awarding a bounty, just mind that it might take us a few days to process it.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eLorenzo\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T16:34:07.957Z","updated_at":"2016-07-25T16:34:07.957Z","actor":{"username":"lorenzoplanas","cleared":false,"url":"/lorenzoplanas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/367/026d633e514b249c038c1680dee5e4fd1f17fac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0xamir","url":"/0xamir"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1086233,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fix confirmed!  \ni now get the message *\"You’re attempting to access an account for which you do not have access.\"* whenever i try to cycle through client numbers.  \nThanks for the quick reply! ","markdown_message":"\u003cp\u003eFix confirmed!\u003cbr\u003e\u003cbr\u003e\ni now get the message \u003cem\u003e\u0026quot;You’re attempting to access an account for which you do not have access.\u0026quot;\u003c/em\u003e whenever i try to cycle through client numbers.\u003cbr\u003e\u003cbr\u003e\nThanks for the quick reply! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T17:21:58.262Z","updated_at":"2016-07-25T17:21:58.262Z","actor":{"username":"0xamir","cleared":false,"url":"/0xamir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/124/1b521ca60048e6145df498b397f6bd086667d18f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119543,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:28:28.621Z","updated_at":"2016-08-11T15:28:28.621Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"350.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"0xamir","url":"/0xamir"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1119628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the quick reply!\nCare for a public disclosure? ","markdown_message":"\u003cp\u003eThanks for the quick reply!\u003cbr\u003e\nCare for a public disclosure? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:54:21.147Z","updated_at":"2016-08-11T15:54:21.147Z","actor":{"username":"0xamir","cleared":false,"url":"/0xamir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/124/1b521ca60048e6145df498b397f6bd086667d18f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119629,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T15:54:45.181Z","updated_at":"2016-08-11T15:54:45.181Z","first_to_agree":true,"actor":{"username":"0xamir","cleared":false,"url":"/0xamir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/124/1b521ca60048e6145df498b397f6bd086667d18f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1186441,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-10T15:54:53.165Z","updated_at":"2016-09-10T15:54:53.165Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}