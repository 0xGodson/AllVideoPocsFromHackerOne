{"id":212067,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTIwNjc=","url":"https://hackerone.com/reports/212067","title":"An “algobot”-s GitHub access token was leaked","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-09T20:27:36.572Z","submitted_at":"2017-03-09T20:27:36.572Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sainaen","url":"/sainaen","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":443,"url":"https://hackerone.com/algolia","handle":"algolia","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Algolia","twitter_handle":"algolia","website":"https://algolia.com","about":"Hosted search API that delivers instant and relevant results from the first keystroke"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-10T14:19:19.645Z","bug_reporter_agreed_on_going_public_at":"2017-05-11T14:19:14.480Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An access token of [algobot] account was first leaked 2015-12-02 in this [Travis CI job log] of [instantsearch.js] project due to incorrect handling of output from command `git clone` (or a `ghpages` module to be more specific.) Since then, the configuration of that project seems to have been changed not to perform this operation ([last build] with token found is from 2016-01-06), but the [docsearch] project still [uses it] and leaks algobot's token with every build of the master branch, here's for example [the latest one.]\n\nThis token has a `public_repo` scope, so it gives commit access to any public repositories its owner has access to. So both instantsearch.js and docsearch are affected.\n\nYou may want to verify that there were no suspicious changes since the first leak. Unfortunately I didn't find any way to check the token usage history, so cannot help with that.\n\nNote that I did use this token to get its owner info (GET call to endpoint `https://api.github.com/user`) and repositories that belong to them (GET call to `https://api.github.com/user/repos`), but I didn't attempt to perform any other operations.\n\nAlso, please be sure to avoid disclosing this issue accidentally (e.g. in commit messages), as I'm still working with others that have similar leaks. Revoking/rotating tokens without explanation with simple “updating the token” should be fine though, generally nobody pays attention to them.\n\n[algobot]: https://github.com/algobot\n[instantsearch.js]: https://github.com/algolia/instantsearch.js\n[docsearch]: https://github.com/algolia/docsearch\n[uses it]: https://github.com/algolia/docsearch/blob/master/scripts/docs/gh-pages.js#L10\n[Travis CI job log]: https://travis-ci.org/algolia/instantsearch.js/jobs/94408476/#L460\n[last build]: https://travis-ci.org/algolia/instantsearch.js/jobs/100608422#L462\n[the latest one.]: https://travis-ci.org/algolia/docsearch/builds/203760306#L419","vulnerability_information_html":"\u003cp\u003eAn access token of \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Falgobot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ealgobot\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e account was first leaked 2015-12-02 in this \u003ca href=\"/redirect?url=https%3A%2F%2Ftravis-ci.org%2Falgolia%2Finstantsearch.js%2Fjobs%2F94408476%2F%23L460\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eTravis CI job log\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e of \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Falgolia%2Finstantsearch.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003einstantsearch.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e project due to incorrect handling of output from command \u003ccode\u003egit clone\u003c/code\u003e (or a \u003ccode\u003eghpages\u003c/code\u003e module to be more specific.) Since then, the configuration of that project seems to have been changed not to perform this operation (\u003ca href=\"/redirect?url=https%3A%2F%2Ftravis-ci.org%2Falgolia%2Finstantsearch.js%2Fjobs%2F100608422%23L462\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003elast build\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with token found is from 2016-01-06), but the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Falgolia%2Fdocsearch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edocsearch\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e project still \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Falgolia%2Fdocsearch%2Fblob%2Fmaster%2Fscripts%2Fdocs%2Fgh-pages.js%23L10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euses it\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and leaks algobot\u0026#39;s token with every build of the master branch, here\u0026#39;s for example \u003ca href=\"/redirect?url=https%3A%2F%2Ftravis-ci.org%2Falgolia%2Fdocsearch%2Fbuilds%2F203760306%23L419\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe latest one.\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis token has a \u003ccode\u003epublic_repo\u003c/code\u003e scope, so it gives commit access to any public repositories its owner has access to. So both instantsearch.js and docsearch are affected.\u003c/p\u003e\n\n\u003cp\u003eYou may want to verify that there were no suspicious changes since the first leak. Unfortunately I didn\u0026#39;t find any way to check the token usage history, so cannot help with that.\u003c/p\u003e\n\n\u003cp\u003eNote that I did use this token to get its owner info (GET call to endpoint \u003ccode\u003ehttps://api.github.com/user\u003c/code\u003e) and repositories that belong to them (GET call to \u003ccode\u003ehttps://api.github.com/user/repos\u003c/code\u003e), but I didn\u0026#39;t attempt to perform any other operations.\u003c/p\u003e\n\n\u003cp\u003eAlso, please be sure to avoid disclosing this issue accidentally (e.g. in commit messages), as I\u0026#39;m still working with others that have similar leaks. Revoking/rotating tokens without explanation with simple “updating the token” should be fine though, generally nobody pays attention to them.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-10T14:19:14.563Z","allow_singular_disclosure_after":-112113470.65589176,"singular_disclosure_allowed":true,"vote_count":10,"voters":["eveeez","an0nym0us","byeu","khizer47","zerotoone","japz","sumit7","spetr0x","kelaaxhackers1","harpreet1"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1530978,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report @sainaen. We have revoked the access of algobot. Can you verify that it doesn't have access anymore?","markdown_message":"\u003cp\u003eThank you for the report \u003ca href=\"/sainaen\"\u003e@sainaen\u003c/a\u003e. We have revoked the access of algobot. Can you verify that it doesn\u0026#39;t have access anymore?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-09T21:15:37.518Z","updated_at":"2017-03-09T21:15:37.518Z","actor":{"username":"adams","cleared":false,"url":"/adams","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/053/f25684e04947d3756222aa2b2b7e43b62b4dfe96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1531000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@adams \nHmm, sorry, it appears to be working for me. Are you sure that it was the correct one?\n\nHere is how I check:\n```\n$ curl -v -H 'Authorization: token 7a0a6c1af6452082794068eafe2914a720b584d8' https://api.github.com/user -o /dev/null 2\u003e\u00261 | grep 'Status:'\n\u003eStatus: 200 OK\n```\nIt should print `Status: 401 Unauthorized`.\n","markdown_message":"\u003cp\u003e\u003ca href=\"/adams\"\u003e@adams\u003c/a\u003e \u003cbr\u003e\nHmm, sorry, it appears to be working for me. Are you sure that it was the correct one?\u003c/p\u003e\n\n\u003cp\u003eHere is how I check:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -v -H \u0026#39;Authorization: token 7a0a6c1af6452082794068eafe2914a720b584d8\u0026#39; https://api.github.com/user -o /dev/null 2\u0026gt;\u0026amp;1 | grep \u0026#39;Status:\u0026#39;\n\u0026gt;Status: 200 OK\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt should print \u003ccode\u003eStatus: 401 Unauthorized\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-09T21:28:49.241Z","updated_at":"2017-03-09T21:28:49.241Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1531004,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh! I'm sorry, you revoked access for algobot to your repositories, not the token.\nYes, GitHub returns an empty list when I ask for available repos.","markdown_message":"\u003cp\u003eOh! I\u0026#39;m sorry, you revoked access for algobot to your repositories, not the token.\u003cbr\u003e\nYes, GitHub returns an empty list when I ask for available repos.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-09T21:30:46.020Z","updated_at":"2017-03-09T21:32:49.987Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1551849,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-20T10:50:01.902Z","updated_at":"2017-03-20T10:50:01.902Z","actor":{"url":"/algolia","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Algolia"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"algolia","collaborator":{"username":"sainaen","url":"/sainaen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1551852,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your help.","markdown_message":"\u003cp\u003eThank you for your help.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T10:50:18.656Z","updated_at":"2017-03-20T10:50:18.656Z","actor":{"username":"adams","cleared":false,"url":"/adams","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/053/f25684e04947d3756222aa2b2b7e43b62b4dfe96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sainaen","url":"/sainaen"},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1559385,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem. Thanks for the bounty!","markdown_message":"\u003cp\u003eNo problem. Thanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-23T13:35:45.021Z","updated_at":"2017-03-23T13:35:45.021Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1668136,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This problem was addressed by Travis CI and then publicly disclosed: https://blog.travis-ci.com/2017-05-08-security-advisory\n\nI'm writing a blog post on this issue with more details, timeline and some analysis, but it'll show only generalized stats and list some high-profile affected repos, without naming users that had their tokens exposed. Basically I'd prefer to avoid blaming anyone (even accidentally) except, perhaps, `git` :) So I'd like to ask you to not make a summary public, or redact out the name of the owner and related links. Thanks!","markdown_message":"\u003cp\u003eThis problem was addressed by Travis CI and then publicly disclosed: \u003ca title=\"https://blog.travis-ci.com/2017-05-08-security-advisory\" href=\"/redirect?url=https%3A%2F%2Fblog.travis-ci.com%2F2017-05-08-security-advisory\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.travis-ci.com/2017-05-08-security-advisory\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m writing a blog post on this issue with more details, timeline and some analysis, but it\u0026#39;ll show only generalized stats and list some high-profile affected repos, without naming users that had their tokens exposed. Basically I\u0026#39;d prefer to avoid blaming anyone (even accidentally) except, perhaps, \u003ccode\u003egit\u003c/code\u003e :) So I\u0026#39;d like to ask you to not make a summary public, or redact out the name of the owner and related links. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-11T14:19:14.511Z","updated_at":"2017-05-11T14:19:14.511Z","first_to_agree":true,"actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1746668,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-10T14:19:19.670Z","updated_at":"2017-06-10T14:19:19.670Z","actor":{"url":"/algolia","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Algolia"}},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}