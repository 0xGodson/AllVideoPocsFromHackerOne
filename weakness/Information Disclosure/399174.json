{"id":399174,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTkxNzQ=","url":"https://hackerone.com/reports/399174","title":"Access MoPub Reports Data even after Company removed you from their MoPub Account.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-24T23:21:37.544Z","submitted_at":"2018-08-24T23:21:37.544Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"suyog","url":"/suyog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EWRjDSU9Qw1UQYg7z5Htub5s/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-05T18:08:15.483Z","bug_reporter_agreed_on_going_public_at":"2019-11-02T20:17:11.561Z","team_member_agreed_on_going_public_at":"2019-11-05T18:08:15.385Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description + Attacking approach\n\n**API Workflow** :\n\n- The MoPub Reporting API supports two separate CSV outputs where publishers can retrieve inventory or campaign performance data.\n\n- Publishers can retrieve daily reports via making a GET request using the request parameters.\n\n- This URL will return a 302 redirect response. The link to download the report will be returned in the response location header.\n\n-----\n\n**How you grab Report data even after company removed you**\n\n- If Publisher/Company invite you for their MoPub Account with any permissions \u0026 Roles.\n (\"administrators or Members\" - it doesn't matter, which permission company gives you while invitation)\n\n- After accept the invitation you have access to make all changes to the company account. \n\n-----\n\n**Attacking approach start from here**\n\n- In order to retrieve data, the API must first be enabled for company account.\n- So, you can Enable data access through API (just click on checkbox in the Reports page of the MoPub UI.)\nor it might be already enabled by publisher.\n- Note down the \"Reporting API access details\". [i.e. API key, Inventory report ID, Campaign report ID]\n- Also Note the Report ID of each MoPub Report present inside the Company Account.\n\n**!!!**\n\n- Now, the publisher/company doesn't want you with their MoPub account and they removed you from their Manage User settings.\n- But they forgot to Reset API key.\n- Now, you don't have any access of company account. \n\n\u003e NOTE! **You have the \"Reporting API access details (which you noted)\".**\n\n-----\n\n**Access the Reporting API :**\n\n- GET request using the request parameters.\n\n[report_key=[individual_report_id ; inventory_report_id ; campaign_report_id]\napi_key=[API_KEY]\ndate=Date of the report. Format YYYY-MM-DD]\nhttps://app.mopub.com/reports/custom/api/download_report?report_key=[REP_KEY]\u0026api_key=[API_KEY]\u0026date=[YYYY-MM-DD]\n\n- Sample Request:\n\n██████████\n\n-----\n\n##Remediation :\n\n1. API key must be auto-reset after the user removed from company.\n2. **(for 2nd condition in impact)** Once the Data access is disabled, user should not be able to access reports data via API.\n\n\n.\n\n\n**Thank you : )**\n\n## Impact\n\n- Attacker(removed user) able to access Organization Current as well as in Future created MoPub reports in 2 conditions :\n\n1. If API key is not reset and \"data access through API\" checkbox is enabled \n2. If API key is not reset and \"data access through API\" checkbox is disabled.","vulnerability_information_html":"\u003ch2 id=\"description-attacking-approach\"\u003eDescription + Attacking approach\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eAPI Workflow\u003c/strong\u003e :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eThe MoPub Reporting API supports two separate CSV outputs where publishers can retrieve inventory or campaign performance data.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ePublishers can retrieve daily reports via making a GET request using the request parameters.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThis URL will return a 302 redirect response. The link to download the report will be returned in the response location header.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cstrong\u003eHow you grab Report data even after company removed you\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eIf Publisher/Company invite you for their MoPub Account with any permissions \u0026amp; Roles.\u003cbr\u003e\n(\u0026quot;administrators or Members\u0026quot; - it doesn\u0026#39;t matter, which permission company gives you while invitation)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAfter accept the invitation you have access to make all changes to the company account. \u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cstrong\u003eAttacking approach start from here\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIn order to retrieve data, the API must first be enabled for company account.\u003c/li\u003e\n\u003cli\u003eSo, you can Enable data access through API (just click on checkbox in the Reports page of the MoPub UI.)\nor it might be already enabled by publisher.\u003c/li\u003e\n\u003cli\u003eNote down the \u0026quot;Reporting API access details\u0026quot;. [i.e. API key, Inventory report ID, Campaign report ID]\u003c/li\u003e\n\u003cli\u003eAlso Note the Report ID of each MoPub Report present inside the Company Account.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003e!!!\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNow, the publisher/company doesn\u0026#39;t want you with their MoPub account and they removed you from their Manage User settings.\u003c/li\u003e\n\u003cli\u003eBut they forgot to Reset API key.\u003c/li\u003e\n\u003cli\u003eNow, you don\u0026#39;t have any access of company account. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNOTE! \u003cstrong\u003eYou have the \u0026quot;Reporting API access details (which you noted)\u0026quot;.\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cstrong\u003eAccess the Reporting API :\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eGET request using the request parameters.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e[report_key=[individual_report_id ; inventory_report_id ; campaign_report_id]\u003cbr\u003e\napi_key=[API_KEY]\u003cbr\u003e\ndate=Date of the report. Format YYYY-MM-DD]\u003cbr\u003e\n\u003ca title=\"https://app.mopub.com/reports/custom/api/download_report?report_key=%5BREP_KEY%5D\u0026amp;api_key=%5BAPI_KEY%5D\u0026amp;date=%5BYYYY-MM-DD%5D\" href=\"/redirect?url=https%3A%2F%2Fapp.mopub.com%2Freports%2Fcustom%2Fapi%2Fdownload_report%3Freport_key%3D%255BREP_KEY%255D%26api_key%3D%255BAPI_KEY%255D%26date%3D%255BYYYY-MM-DD%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.mopub.com/reports/custom/api/download_report?report_key=%5BREP_KEY%5D\u0026amp;api_key=%5BAPI_KEY%5D\u0026amp;date=%5BYYYY-MM-DD%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSample Request:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e██████████\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch2 id=\"remediation\"\u003eRemediation :\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAPI key must be auto-reset after the user removed from company.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003e(for 2nd condition in impact)\u003c/strong\u003e Once the Data access is disabled, user should not be able to access reports data via API.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eThank you : )\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eAttacker(removed user) able to access Organization Current as well as in Future created MoPub reports in 2 conditions :\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003col\u003e\n\u003cli\u003eIf API key is not reset and \u0026quot;data access through API\u0026quot; checkbox is enabled \u003c/li\u003e\n\u003cli\u003eIf API key is not reset and \u0026quot;data access through API\u0026quot; checkbox is disabled.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"140.0","formatted_bounty":"$140","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-12-02T20:17:11.618Z","allow_singular_disclosure_after":-33903250.32473987,"singular_disclosure_allowed":true,"vote_count":11,"voters":["mygf","elmahdi","exception","sa1tama0","cryptographer","rudvan88","seebluecat","newfile","supernintenden","michaelsdavid","and 1 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":1074,"asset_type":"URL","asset_identifier":"mopub.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3260144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe are considering this, and we'll keep you updated when we have additional information.\n\nThank you for thinking of Twitter security.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eWe are considering this, and we\u0026#39;ll keep you updated when we have additional information.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-28T21:06:12.621Z","updated_at":"2018-08-28T21:06:12.621Z","actor":{"username":"bugtriage-michael","cleared":false,"url":"/bugtriage-michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3270411,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T16:11:34.143Z","updated_at":"2018-08-30T16:11:34.143Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3276073,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T16:51:47.805Z","updated_at":"2018-08-31T16:51:47.805Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"140.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"suyog","url":"/suyog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3282771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Team,\n\n\"You are not part of that company, but you can still access the report of that company\", isn't this serious issue?\nWouldn't this will come under \"Everything Else\" with High bounty amount category? \n\nIf not, happy : ) but then I would love to know why not.\n\nThank you.\nSuyog","markdown_message":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;You are not part of that company, but you can still access the report of that company\u0026quot;, isn\u0026#39;t this serious issue?\u003cbr\u003e\nWouldn\u0026#39;t this will come under \u0026quot;Everything Else\u0026quot; with High bounty amount category? \u003c/p\u003e\n\n\u003cp\u003eIf not, happy : ) but then I would love to know why not.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003cbr\u003e\nSuyog\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T07:18:08.219Z","updated_at":"2018-09-03T07:18:08.219Z","actor":{"username":"suyog","cleared":false,"url":"/suyog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EWRjDSU9Qw1UQYg7z5Htub5s/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3585002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Team,\nany updates?\n\n-----\nthank you,\n**Suyog (S.P.)**","markdown_message":"\u003cp\u003eHi Team,\u003cbr\u003e\nany updates?\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003ethank you,\u003cbr\u003e\n\u003cstrong\u003eSuyog (S.P.)\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-04T20:55:20.728Z","updated_at":"2018-11-04T20:55:20.728Z","actor":{"username":"suyog","cleared":false,"url":"/suyog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EWRjDSU9Qw1UQYg7z5Htub5s/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3975972,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now.\n\nRather than invalidate all existing API keys when a user is removed, we instead provide a warning to the admin that the API keys may still usable by users with prior access. This allows account admins to balance the need for a controlled update of the API keys that avoids breaking existing applications with the need to remind admins that former users will maintain access to long-lived secrets.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now.\u003c/p\u003e\n\n\u003cp\u003eRather than invalidate all existing API keys when a user is removed, we instead provide a warning to the admin that the API keys may still usable by users with prior access. This allows account admins to balance the need for a controlled update of the API keys that avoids breaking existing applications with the need to remind admins that former users will maintain access to long-lived secrets.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-14T23:18:32.459Z","updated_at":"2019-01-14T23:18:32.459Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"suyog","url":"/suyog"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4002422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\ni tested today\nn my admin account not received any warning after removing invited user(member). \nand even data is still available for public.\n██████\n","markdown_message":"\u003cp\u003eHi there,\u003cbr\u003e\ni tested today\u003cbr\u003e\nn my admin account not received any warning after removing invited user(member). \u003cbr\u003e\nand even data is still available for public.\u003cbr\u003e\n██████\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-18T20:33:13.660Z","updated_at":"2019-11-05T18:05:41.240Z","actor":{"username":"suyog","cleared":false,"url":"/suyog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EWRjDSU9Qw1UQYg7z5Htub5s/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6201048,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Working well...\n\nDisclosure?","markdown_message":"\u003cp\u003eWorking well...\u003c/p\u003e\n\n\u003cp\u003eDisclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-02T20:17:11.579Z","updated_at":"2019-11-02T20:17:11.579Z","first_to_agree":true,"actor":{"username":"suyog","cleared":false,"url":"/suyog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EWRjDSU9Qw1UQYg7z5Htub5s/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6223265,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-05T18:08:15.421Z","updated_at":"2019-11-05T18:08:15.421Z","actor":{"username":"ngholap","cleared":false,"url":"/ngholap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6223266,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-05T18:08:15.500Z","updated_at":"2019-11-05T18:08:15.500Z","actor":{"username":"ngholap","cleared":false,"url":"/ngholap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}