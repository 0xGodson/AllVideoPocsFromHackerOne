{"id":281597,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODE1OTc=","url":"https://hackerone.com/reports/281597","title":"Preferred language option fingerprinting issue in Tor Browser","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2017-10-22T02:53:01.305Z","submitted_at":"2017-10-22T02:53:01.305Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xiaoyinl","url":"/xiaoyinl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-24T06:57:45.395Z","bug_reporter_agreed_on_going_public_at":"2017-10-24T06:21:05.469Z","team_member_agreed_on_going_public_at":"2017-10-24T06:57:45.316Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I'm not so sure if this is an in-scope issue or by-design. But based on my understanding of [1], I feel that Tor doesn't want to make user configuration details of Tor Browser detectable by websites. But in about:preferences#content, there's a \"Languages\" section that allows users to \"choose your preferred language for displaying pages\". When users add a language here, there's no warning to tell them that this info will be sent to the websites. The language list will be available to websites in the \"Accept-Language\" HTTP request header, and in JavaScript API \"navigator.languages\".\n\nTo fix this issue, I think there're three options: 1) remove this option from the settings; 2) let users configure a list of domains for which the language list is sent; other sites get the default value; 3) add a warning in the setting page: \"the info of your added languages is sent to all sites, which may be used to fingerprint you\" or something like this.\n\n[1] https://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability, Sources of Fingerprinting Issues","vulnerability_information_html":"\u003cp\u003eI\u0026#39;m not so sure if this is an in-scope issue or by-design. But based on my understanding of [1], I feel that Tor doesn\u0026#39;t want to make user configuration details of Tor Browser detectable by websites. But in about:preferences#content, there\u0026#39;s a \u0026quot;Languages\u0026quot; section that allows users to \u0026quot;choose your preferred language for displaying pages\u0026quot;. When users add a language here, there\u0026#39;s no warning to tell them that this info will be sent to the websites. The language list will be available to websites in the \u0026quot;Accept-Language\u0026quot; HTTP request header, and in JavaScript API \u0026quot;navigator.languages\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eTo fix this issue, I think there\u0026#39;re three options: 1) remove this option from the settings; 2) let users configure a list of domains for which the language list is sent; other sites get the default value; 3) add a warning in the setting page: \u0026quot;the info of your added languages is sent to all sites, which may be used to fingerprint you\u0026quot; or something like this.\u003c/p\u003e\n\n\u003cp\u003e[1] \u003ca title=\"https://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability\" href=\"/redirect?url=https%3A%2F%2Fwww.torproject.org%2Fprojects%2Ftorbrowser%2Fdesign%2F%23fingerprinting-linkability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, Sources of Fingerprinting Issues\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":231531,"file_name":"Accept-Language_discloses_language_list.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/231/531/d28098dd26c5e6e4485fb2fefa91d7f1b23787cb/Accept-Language_discloses_language_list.png?response-content-disposition=attachment%3B%20filename%3D%22Accept-Language_discloses_language_list.png%22%3B%20filename%2A%3DUTF-8%27%27Accept-Language_discloses_language_list.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052232Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=6ccd36d1d0d6ac5fe7276d86bc8fc25ba7543534d2875da3da672ef84bdcbf76","file_size":33082,"type":"image/png"},{"id":231532,"file_name":"language_setting.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/231/532/3f86a552cc2075a23bc37dfa455b488af8644877/language_setting.png?response-content-disposition=attachment%3B%20filename%3D%22language_setting.png%22%3B%20filename%2A%3DUTF-8%27%27language_setting.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052232Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=96d0e73b318b7e417046138a7df6a20fb0a527de6791130d1be3593ffb64a1c8","file_size":45185,"type":"image/png"},{"id":231533,"file_name":"navigator.languages_return_language_list.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/231/533/46a64b45c48f151ac0210ba50496734bd583b658/navigator.languages_return_language_list.png?response-content-disposition=attachment%3B%20filename%3D%22navigator.languages_return_language_list.png%22%3B%20filename%2A%3DUTF-8%27%27navigator.languages_return_language_list.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052232Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=d3c10a228faa05a38340336bc296a8fe0d488c33c71335836bf98fbbf4c42d87","file_size":9465,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["xiaoyinl","hongen","yanis60"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2097866,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. There is a ton of options where users can shoot themselves in the foot in case they start to tweak browser preferences and options. This is one of them. I guess from the options you listed above I could get behind doing 3) but I am not sure whether it's worth the effort right now given that the user has to go quite deep into config settings and fiddle with some obscure settings. Anyway, I've filed https://trac.torproject.org/projects/tor/ticket/23967 for that.\n\nFor what it is worth: the tweaking and possible fingerprinting does not seem to work actually right now: https://blog.torproject.org/comment/269127#comment-269127.","markdown_message":"\u003cp\u003eThanks for the report. There is a ton of options where users can shoot themselves in the foot in case they start to tweak browser preferences and options. This is one of them. I guess from the options you listed above I could get behind doing 3) but I am not sure whether it\u0026#39;s worth the effort right now given that the user has to go quite deep into config settings and fiddle with some obscure settings. Anyway, I\u0026#39;ve filed \u003ca title=\"https://trac.torproject.org/projects/tor/ticket/23967\" href=\"/redirect?url=https%3A%2F%2Ftrac.torproject.org%2Fprojects%2Ftor%2Fticket%2F23967\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://trac.torproject.org/projects/tor/ticket/23967\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for that.\u003c/p\u003e\n\n\u003cp\u003eFor what it is worth: the tweaking and possible fingerprinting does not seem to work actually right now: \u003ca title=\"https://blog.torproject.org/comment/269127#comment-269127\" href=\"/redirect?url=https%3A%2F%2Fblog.torproject.org%2Fcomment%2F269127%23comment-269127\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.torproject.org/comment/269127#comment-269127\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-24T06:06:53.841Z","updated_at":"2017-10-24T06:06:53.841Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2097884,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I see. Thank you for your reply! Would you mind disclosing this report?","markdown_message":"\u003cp\u003eI see. Thank you for your reply! Would you mind disclosing this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-24T06:21:05.488Z","updated_at":"2017-10-24T06:21:05.488Z","first_to_agree":true,"actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2097915,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-24T06:57:45.347Z","updated_at":"2017-10-24T06:57:45.347Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2097916,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-24T06:57:45.421Z","updated_at":"2017-10-24T06:57:45.421Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}