{"id":509629,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDk2Mjk=","url":"https://hackerone.com/reports/509629","title":"Race condition in activating email resulting in infinite amount of diamonds received","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-14T11:06:57.123Z","submitted_at":"2019-03-14T11:06:57.123Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"batee5a","url":"/batee5a","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":36247,"url":"https://hackerone.com/innogames","handle":"innogames","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"InnoGames","twitter_handle":"","website":"https://www.innogames.com","about":"With around 150 million registered players, InnoGames is one of the worldwide leading developers and publishers of online games. "}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-18T06:19:34.006Z","bug_reporter_agreed_on_going_public_at":"2020-05-14T21:11:01.442Z","team_member_agreed_on_going_public_at":"2020-05-18T06:19:33.871Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":105,"name":"Time-of-check Time-of-use (TOCTOU) Race Condition"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":134,"voters":["megaknight","skr0x1c0","u3mur4","renniepak","zonduu","prophet","stealthy","johndoe1492","mygf","leonishan","and 124 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":{"databaseId":18220,"asset_type":"URL","asset_identifier":"xs0.forgeofempires.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4329190,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T10:40:55.418Z","updated_at":"2019-03-15T10:40:55.418Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4329191,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T10:41:29.850Z","updated_at":"2019-03-15T10:41:29.850Z","actor":{"url":"/innogames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"InnoGames"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"innogames","collaborator":{"username":"batee5a","url":"/batee5a"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4335461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-16T07:55:40.774Z","updated_at":"2019-03-16T08:03:40.110Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4351504,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-19T08:38:43.959Z","updated_at":"2019-03-19T08:38:43.959Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4351918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-19T09:46:06.614Z","updated_at":"2019-03-19T09:46:06.614Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4351935,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-19T09:49:52.513Z","updated_at":"2019-03-19T09:49:52.513Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4351951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-19T09:53:01.931Z","updated_at":"2019-03-19T09:53:01.931Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4394082,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T15:59:39.657Z","updated_at":"2019-03-26T15:59:39.657Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"batee5a","url":"/batee5a"},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8004440,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T21:11:01.478Z","updated_at":"2020-05-14T21:11:01.478Z","first_to_agree":true,"actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8004445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T21:11:40.175Z","updated_at":"2020-05-14T21:11:40.175Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8030389,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T06:14:15.704Z","updated_at":"2020-05-18T06:14:15.704Z","additional_data":{},"actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8030422,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T06:19:33.920Z","updated_at":"2020-05-18T06:20:30.199Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8030423,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T06:19:34.034Z","updated_at":"2020-05-18T06:19:34.034Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21743,"category":"team","content":"There was a race condition, in the registration process, that might have given the attacker an advantage in the game by gaining additional premium in-game currency without paying for it.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThere was a race condition, in the registration process, that might have given the attacker an advantage in the game by gaining additional premium in-game currency without paying for it.\u003c/p\u003e\n"},{"id":21691,"category":"researcher","content":"### Summary:\nThis is an interesting critical race condition that might give the attacker an advantage in the game by gaining additional premium in-game currency without paying for it.\n\n### Vulnerable Feature:\nWhen you register a new account at Forge of Empires, you can get 50 premium in-game currency as a reward after confirming your e-mail. The confirmation request was vulnerable to race condition. On submitting the confirmation request multiple times in parallel, it would let the attacker get (50 * amount of requests) as reward for confirming his e-mail. I added 800 Premium currency as a proof of concept.\n\n","can_view?":true,"can_edit?":false,"content_html":"\u003ch3 id=\"summary\"\u003eSummary:\u003c/h3\u003e\n\n\u003cp\u003eThis is an interesting critical race condition that might give the attacker an advantage in the game by gaining additional premium in-game currency without paying for it.\u003c/p\u003e\n\n\u003ch3 id=\"vulnerable-feature\"\u003eVulnerable Feature:\u003c/h3\u003e\n\n\u003cp\u003eWhen you register a new account at Forge of Empires, you can get 50 premium in-game currency as a reward after confirming your e-mail. The confirmation request was vulnerable to race condition. On submitting the confirmation request multiple times in parallel, it would let the attacker get (50 * amount of requests) as reward for confirming his e-mail. I added 800 Premium currency as a proof of concept.\u003c/p\u003e\n"}]}