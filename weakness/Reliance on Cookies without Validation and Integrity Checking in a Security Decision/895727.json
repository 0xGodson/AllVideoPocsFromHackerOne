{"id":895727,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTU3Mjc=","url":"https://hackerone.com/reports/895727","title":"Rack parses encoded cookie names allowing an attacker to send malicious `__Host-` and `__Secure-` prefixed cookies","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-06-10T23:58:33.703Z","submitted_at":"2020-06-10T23:58:33.703Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fletchto99","url":"/fletchto99","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8184"],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-16T13:27:52.001Z","bug_reporter_agreed_on_going_public_at":"2020-06-16T01:20:37.715Z","team_member_agreed_on_going_public_at":"2020-06-16T13:27:51.894Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The [rack cookie parser](https://github.com/rack/rack/blob/c9ff9709afa70ca0e427aa06643c851f498359dc/lib/rack/utils.rb#L215) parses the cookie string using [`unescape`](https://github.com/rack/rack/blob/c9ff9709afa70ca0e427aa06643c851f498359dc/lib/rack/utils.rb#L215). This allows a malicious attacker to set a second cookie with the name being percent encoded. Typically it would be expected that we cannot trust cookies and in _most_ cases that's true. However in a couple of cases certain expectations are set. Cookies allow for [cookie prefixes](https://textslashplain.com/2015/10/09/duct-tape-and-baling-wirecookie-prefixes/) on the cookie name to indicate to the browser certain attributes. In this case there are 2 special attributes we care about: `__Secure-` and `__Host-`. When the browser sends these cookies to the server certain [assumptions](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Attributes) are be made around these cookies:\n\n1. `__Secure-` prefix: Cookies names starting with `__Secure-` (dash is part of the prefix) must be set with the secure flag from a secure page (HTTPS).\n2. `__Host-` prefix: Cookies with names starting with `__Host-` must be set with the secure flag, must be from a secure page (HTTPS), must not have a domain specified (and therefore aren't sent to subdomains) and the path must be `/`\n\nThe flaw in Rack allows for a `__%48ost-` or `__%53ecure-` cookie to be set **without** the required attributes (I.e. set without HTTPS, from root domain, or from a secure page). This means a malicious cookie set by an attacker could set a `__%48ost-` cookie from a subdomain knowing that Rack would parse it as `__Host-`. Furthermore, since the browser won't enforce the `HostOnly` attribute to `__%48ost-` cookies an attacker could control the `__Host-` prefixed cookie from a subdomain by setting a wildcard domain on the `__%48ost-` cookie.\n\nIt should be noted that while the [cookie spec](https://tools.ietf.org/html/rfc6265#section-4.1.1) recommends encoding for the value of a cookie it doesn't make any suggestions around the encoding of the name of a cookie.\n\nHere's a simple PoC test case which fails :\n\n```ruby\n# frozen_string_literal: true\n\nrequire_relative 'helper'\n\ndescribe Rack::Utils, \"malicious cookie\" do\n  # Fails and __Host-evil reads the malicious value and sets it as the cookie\n  # rather than reading the actual __Host cookie\n  #\n  # Furthermore, browsers enforce HostOnly for `__Host-` cookies but they would\n  # not enforce it for \"__%48ost\" cookies so a malicious script could potentially\n  # set this cookie knowing it would be parsed as the `__Host-` cookie\n  #\n  # Lastly, when the cookie is made it could be set with the `.example.com` domain\n  # wildcard, thus a malicious script on a subdomain could set the cookie and it\n  # would be parsed by the root domain\n  #\n  # This is due to the cookie being unescaped, thus:\n  # URI.unescape(\"__%48ost-evil\") =\u003e \"__Host-evil\"\n  #\n  # Currently fails, should be passing\n  it \"doesnt parse malicious __Host cookie\" do\n    env = Rack::MockRequest.env_for(\"\", \"HTTP_COOKIE\" =\u003e \"__%48ost-evil=evil;__Host-evil=abc\")\n    cookies = Rack::Utils.parse_cookies(env)\n    cookies.must_equal({ \"__%48ost-evil\" =\u003e \"evil\", \"__Host-evil\" =\u003e \"abc\"  })\n  end\n\n  # Less of a security issue and more of a bug\n  it \"generic foo=bar example\" do\n    env = Rack::MockRequest.env_for(\"\", \"HTTP_COOKIE\" =\u003e \"%66oo=baz;foo=bar\")\n    cookies = Rack::Utils.parse_cookies(env)\n    cookies.must_equal({ \"%66oo\" =\u003e \"baz\", \"foo\" =\u003e \"bar\" })\n  end\nend\n```\n\nAn attacker could potentially set the cookie from a malicious script on a subdomain like so, bypassing any expectations around the attributes of the cookie:\n```\ndocument.cookie = \"__%48ost-evil=evil; domain=.example.com\";\n```\n\nI should note I work for GitHub, I'm not sure if there's any conflict with payouts in this case (and I certainly don't want/need a payout), however should you chose to payout for this I'd like the money to be donated to charity. If possible could it please be donated to [NAACP Legal Defense and Education Fund](https://www.naacpldf.org/support/fiscal-responsibility/) their donaiton page can be found [here](https://org2.salsalabs.com/o/6857/p/salsa/donation/common/public/?donate_page_KEY=15780\u0026_ga=2.63873391.1784282200.1591830687-771342060.1591210817).\n\n## Impact\n\nAn attacker can control cookies by encoding creating a second cookie with the name url encoded. This means that the `__Host-` and `__Secure-` prefixed cookies can be controlled. Furthermore, a malicious attacker could set this cookie from a subdomain and have it apply to the root domain, in which case the Rack would parse the attackers cookie.","vulnerability_information_html":"\u003cp\u003eThe \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frack%2Frack%2Fblob%2Fc9ff9709afa70ca0e427aa06643c851f498359dc%2Flib%2Frack%2Futils.rb%23L215\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erack cookie parser\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e parses the cookie string using \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frack%2Frack%2Fblob%2Fc9ff9709afa70ca0e427aa06643c851f498359dc%2Flib%2Frack%2Futils.rb%23L215\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003eunescape\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This allows a malicious attacker to set a second cookie with the name being percent encoded. Typically it would be expected that we cannot trust cookies and in \u003cu\u003emost\u003c/u\u003e cases that\u0026#39;s true. However in a couple of cases certain expectations are set. Cookies allow for \u003ca href=\"/redirect?url=https%3A%2F%2Ftextslashplain.com%2F2015%2F10%2F09%2Fduct-tape-and-baling-wirecookie-prefixes%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecookie prefixes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on the cookie name to indicate to the browser certain attributes. In this case there are 2 special attributes we care about: \u003ccode\u003e__Secure-\u003c/code\u003e and \u003ccode\u003e__Host-\u003c/code\u003e. When the browser sends these cookies to the server certain \u003ca href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FSet-Cookie%23Attributes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eassumptions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e are be made around these cookies:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003e__Secure-\u003c/code\u003e prefix: Cookies names starting with \u003ccode\u003e__Secure-\u003c/code\u003e (dash is part of the prefix) must be set with the secure flag from a secure page (HTTPS).\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e__Host-\u003c/code\u003e prefix: Cookies with names starting with \u003ccode\u003e__Host-\u003c/code\u003e must be set with the secure flag, must be from a secure page (HTTPS), must not have a domain specified (and therefore aren\u0026#39;t sent to subdomains) and the path must be \u003ccode\u003e/\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe flaw in Rack allows for a \u003ccode\u003e__%48ost-\u003c/code\u003e or \u003ccode\u003e__%53ecure-\u003c/code\u003e cookie to be set \u003cstrong\u003ewithout\u003c/strong\u003e the required attributes (I.e. set without HTTPS, from root domain, or from a secure page). This means a malicious cookie set by an attacker could set a \u003ccode\u003e__%48ost-\u003c/code\u003e cookie from a subdomain knowing that Rack would parse it as \u003ccode\u003e__Host-\u003c/code\u003e. Furthermore, since the browser won\u0026#39;t enforce the \u003ccode\u003eHostOnly\u003c/code\u003e attribute to \u003ccode\u003e__%48ost-\u003c/code\u003e cookies an attacker could control the \u003ccode\u003e__Host-\u003c/code\u003e prefixed cookie from a subdomain by setting a wildcard domain on the \u003ccode\u003e__%48ost-\u003c/code\u003e cookie.\u003c/p\u003e\n\n\u003cp\u003eIt should be noted that while the \u003ca href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6265%23section-4.1.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecookie spec\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e recommends encoding for the value of a cookie it doesn\u0026#39;t make any suggestions around the encoding of the name of a cookie.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s a simple PoC test case which fails :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003erequire_relative\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;helper\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;malicious cookie\u0026quot;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# Fails and __Host-evil reads the malicious value and sets it as the cookie\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# rather than reading the actual __Host cookie\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# Furthermore, browsers enforce HostOnly for `__Host-` cookies but they would\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# not enforce it for \u0026quot;__%48ost\u0026quot; cookies so a malicious script could potentially\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# set this cookie knowing it would be parsed as the `__Host-` cookie\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# Lastly, when the cookie is made it could be set with the `.example.com` domain\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# wildcard, thus a malicious script on a subdomain could set the cookie and it\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# would be parsed by the root domain\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# This is due to the cookie being unescaped, thus:\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# URI.unescape(\u0026quot;__%48ost-evil\u0026quot;) =\u0026gt; \u0026quot;__Host-evil\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# Currently fails, should be passing\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;doesnt parse malicious __Host cookie\u0026quot;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMockRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv_for\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;HTTP_COOKIE\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;__%48ost-evil=evil;__Host-evil=abc\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecookies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eparse_cookies\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecookies\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emust_equal\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;__%48ost-evil\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;evil\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;__Host-evil\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;abc\u0026quot;\u003c/span\u003e  \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# Less of a security issue and more of a bug\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;generic foo=bar example\u0026quot;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMockRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv_for\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;HTTP_COOKIE\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;%66oo=baz;foo=bar\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecookies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eparse_cookies\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecookies\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emust_equal\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;%66oo\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;baz\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAn attacker could potentially set the cookie from a malicious script on a subdomain like so, bypassing any expectations around the attributes of the cookie:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003edocument.cookie = \u0026quot;__%48ost-evil=evil; domain=.example.com\u0026quot;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI should note I work for GitHub, I\u0026#39;m not sure if there\u0026#39;s any conflict with payouts in this case (and I certainly don\u0026#39;t want/need a payout), however should you chose to payout for this I\u0026#39;d like the money to be donated to charity. If possible could it please be donated to \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.naacpldf.org%2Fsupport%2Ffiscal-responsibility%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eNAACP Legal Defense and Education Fund\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e their donaiton page can be found \u003ca href=\"/redirect?url=https%3A%2F%2Forg2.salsalabs.com%2Fo%2F6857%2Fp%2Fsalsa%2Fdonation%2Fcommon%2Fpublic%2F%3Fdonate_page_KEY%3D15780%26_ga%3D2.63873391.1784282200.1591830687-771342060.1591210817\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can control cookies by encoding creating a second cookie with the name url encoded. This means that the \u003ccode\u003e__Host-\u003c/code\u003e and \u003ccode\u003e__Secure-\u003c/code\u003e prefixed cookies can be controlled. Furthermore, a malicious attacker could set this cookie from a subdomain and have it apply to the root domain, in which case the Rack would parse the attackers cookie.\u003c/p\u003e\n","weakness":{"id":97,"name":"Reliance on Cookies without Validation and Integrity Checking in a Security Decision"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-07-16T01:20:37.826Z","allow_singular_disclosure_after":-14363249.642397016,"singular_disclosure_allowed":true,"vote_count":46,"voters":["jatindhankhar","brahim_boufakri01","amad3u6","mygf","prinzhorn","3x3s","authd0wn","sudoshekhar","d4rkm4tter","0619","and 36 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":160,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rails/rails","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8258674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wanted to follow up with a note, while the cookie spec didn't have any indication around the encoding of cookie names the [Mozilla documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#Attributes) indicates how browser would expect the cookies in these cases:\n\n\u003e A \u003ccookie-name\u003e can be any US-ASCII characters, except control characters, spaces, or tabs. It also must not contain a separator character like the following: ( ) \u003c \u003e @ , ; : \\ \" / [ ] ? = { }.","markdown_message":"\u003cp\u003eI wanted to follow up with a note, while the cookie spec didn\u0026#39;t have any indication around the encoding of cookie names the \u003ca href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FSet-Cookie%23Attributes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMozilla documentation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e indicates how browser would expect the cookies in these cases:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eA \u0026lt;cookie-name\u0026gt; can be any US-ASCII characters, except control characters, spaces, or tabs. It also must not contain a separator character like the following: ( ) \u0026lt; \u0026gt; @ , ; : \\ \u0026quot; / [ ] ? = { }.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2020-06-11T00:12:28.036Z","updated_at":"2020-06-11T00:12:28.036Z","actor":{"username":"fletchto99","cleared":false,"url":"/fletchto99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8266763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I had a go at attempting to patch the issue today. I'm not sure if it's the most performant solution but I figured I'd help out where possible. I'm not too sure what's required in terms of backports but hopefully this can help kickstart a fix.","markdown_message":"\u003cp\u003eI had a go at attempting to patch the issue today. I\u0026#39;m not sure if it\u0026#39;s the most performant solution but I figured I\u0026#39;d help out where possible. I\u0026#39;m not too sure what\u0026#39;s required in terms of backports but hopefully this can help kickstart a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T18:25:56.948Z","updated_at":"2020-06-11T18:25:56.948Z","actor":{"username":"fletchto99","cleared":false,"url":"/fletchto99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":864477,"filename":"fix.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hdNfiHZc8oRdctZ7rrEdB7Xj?response-content-disposition=attachment%3B%20filename%3D%22fix.patch%22%3B%20filename%2A%3DUTF-8%27%27fix.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=aebc1a8f15aec02c838cd6ffdc3187715b553d8c87ac61b476d31d7b8ff0037f"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8276426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@fletchto99 what do you think about this as a patch?  It's based off of your patch, but passes the test suite and should allocate fewer objects.  If you think it will work, can you send me a patch using `git format-patch` so I can retain your contribution information?","markdown_message":"\u003cp\u003e\u003ca href=\"/fletchto99\"\u003e@fletchto99\u003c/a\u003e what do you think about this as a patch?  It\u0026#39;s based off of your patch, but passes the test suite and should allocate fewer objects.  If you think it will work, can you send me a patch using \u003ccode\u003egit format-patch\u003c/code\u003e so I can retain your contribution information?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T18:48:23.952Z","updated_at":"2020-06-12T18:48:23.952Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":866010,"filename":"out.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Q1XGSZm3zAgRGTc7S3NKPwnA?response-content-disposition=attachment%3B%20filename%3D%22out.diff%22%3B%20filename%2A%3DUTF-8%27%27out.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=bf5fbfab75cf43e8159432b2bb1755074c2ecac9444393486f7495c0ac6a99b7"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8276680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @tenderlove, here's a patch file created via `format-patch`. Feel free to touch up the commit message if rack follows any guidelines around commit messages.\n\nCheers!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/tenderlove\"\u003e@tenderlove\u003c/a\u003e, here\u0026#39;s a patch file created via \u003ccode\u003eformat-patch\u003c/code\u003e. Feel free to touch up the commit message if rack follows any guidelines around commit messages.\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T19:03:27.600Z","updated_at":"2020-06-12T19:03:27.600Z","actor":{"username":"fletchto99","cleared":false,"url":"/fletchto99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":866020,"filename":"0001-When-parsing-cookies-only-decode-the-values.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vDzpGYavXou9mEt4rzKSCN3V?response-content-disposition=attachment%3B%20filename%3D%220001-When-parsing-cookies-only-decode-the-values.patch%22%3B%20filename%2A%3DUTF-8%27%270001-When-parsing-cookies-only-decode-the-values.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=21dc1bfe7ca24a5836bd9458718c4f2202afd6e812866fa5701345e90c5d290e"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8277598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @fletchto99,\n\nI've prepared the following advisory and final patchset. Let me know if you spot any errors.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/fletchto99\"\u003e@fletchto99\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve prepared the following advisory and final patchset. Let me know if you spot any errors.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T20:06:39.425Z","updated_at":"2020-06-12T20:06:39.425Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":866122,"filename":"895727_advisory.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6H2RCAUVSVTU8Nvfrjwtj6XD?response-content-disposition=attachment%3B%20filename%3D%22895727_advisory.txt%22%3B%20filename%2A%3DUTF-8%27%27895727_advisory.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=bcfe29db3a38de35d0a83e247bdeddd3bccb16cb3a15fd16369f3e789da73daf"},{"id":866115,"filename":"0001-2.2.2-When-parsing-cookies-only-decode-the-values.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Kuxgpxhef7Rr1sKDHnhVGVEY?response-content-disposition=attachment%3B%20filename%3D%220001-2.2.2-When-parsing-cookies-only-decode-the-values.patch%22%3B%20filename%2A%3DUTF-8%27%270001-2.2.2-When-parsing-cookies-only-decode-the-values.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=0e01fc947fb5c7f70cae7ab756a91da51d427b71735183a0d66701247d0ef87c"},{"id":866114,"filename":"0001-2.1.3-When-parsing-cookies-only-decode-the-values.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BzsMzgYPTo5fueNfiYRFFkSV?response-content-disposition=attachment%3B%20filename%3D%220001-2.1.3-When-parsing-cookies-only-decode-the-values.patch%22%3B%20filename%2A%3DUTF-8%27%270001-2.1.3-When-parsing-cookies-only-decode-the-values.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=e3d47af5f2165b51dd293c3ec848f1c6f673c6dca6ad80df9cbaf82f51f8e482"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8277732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Jack. The advisory looks good. I just noticed I used my GitHub email for the patches. I've updated them to use my personal email. Besides that everything looks good, thanks!","markdown_message":"\u003cp\u003eHey Jack. The advisory looks good. I just noticed I used my GitHub email for the patches. I\u0026#39;ve updated them to use my personal email. Besides that everything looks good, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T20:19:33.619Z","updated_at":"2020-06-12T20:19:33.619Z","actor":{"username":"fletchto99","cleared":false,"url":"/fletchto99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":866149,"filename":"0001-2.2.2-When-parsing-cookies-only-decode-the-values.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4oFQPzpFGirVyeaKhiJSZvGV?response-content-disposition=attachment%3B%20filename%3D%220001-2.2.2-When-parsing-cookies-only-decode-the-values.patch%22%3B%20filename%2A%3DUTF-8%27%270001-2.2.2-When-parsing-cookies-only-decode-the-values.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=2c7bae725eebfead51ce6d1839c1b3cb16f3fcf82e74754a54e01dad8975b2a5"},{"id":866148,"filename":"0001-2.1.3-When-parsing-cookies-only-decode-the-values.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cwo2fyf7no68vtQhs4XE2fgF?response-content-disposition=attachment%3B%20filename%3D%220001-2.1.3-When-parsing-cookies-only-decode-the-values.patch%22%3B%20filename%2A%3DUTF-8%27%270001-2.1.3-When-parsing-cookies-only-decode-the-values.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTSNB3IWO%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070807Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIB23JIypubPObPue5AlwRgwmOJOSHXd1Ba%2FBcKfGs1BWAiAcjn3BI7dDFAfaUFlKsjtU3eXUGE3Aunby45Zw7hxToCq0AwhYEAEaDDAxMzYxOTI3NDg0OSIMt8IMEb7e4YCohguuKpEDXJhnFErU6hEEoP5TFzz%2FTnWM2HbX91PL1fy1QJg1tb8dI33ObCKUAghjVOHv%2BupJ8mgpz9pv3Z23PPr0kdDnApz16MtbQ2l6bKPJEq3bEpIPtPuLBglG8b7gQBBgpfNt%2FOydsz9huFo0XBzFsWKK0dvMA%2B4m8%2FV1QKzvqzymcWCEAw20SrFC0M3BfbnTFqRKv3osnyo%2F1yKJu%2FSQu6eSqvVNyoXzKchO64U0M2SBY9Ge3mCrOP5rYQBzocoOG88A4O4diCYdBx6uwkcfBfYThRJlqgg9yJ2zaohh%2FlNsKZqoeRevSGylCMx5GjJIPiJIwlemqw7CZ9fj27gbg81DifwErG7yu7DSmfN9gV1gwC20mKGbHdWON5r3DYPlUa3JlPR%2F0ukBXknezrjnqfIOu0UX%2BtHKqF%2Fhie9FkgReJ2xA%2F0z%2B3g28W9aQuAPmqy7GrtTsDsqWulS96TcabOIjuPbVVgyJPAdEhgHpD%2BOwkRfpAKdrNJ5BHaMx%2B6KtR0xlGYVI2QKrOcGhs%2Fpt2eGBJKwwsKGr%2FwU67AH11AiiDz7NDZXxntIiOPwGru2lGVfkX75WyfSvTN9IbHbipzN4dR6jxsDfDzDujUvSZ%2FkfmzqHFNXknoWZGBEPLezuyFHbPtlK0855%2Bd%2FA66ZUrVL8vihP9WJyfE6o%2F5n%2BiHAWWZKIXuUYMLnUJAkxRmQisaMlCMxxoMZSgTRDzJw3Aih6oaYpcymb5usniX5mlj1dywmrFE4vcsBkTx%2BAqTX29GfR4s%2B%2FDE0n18p9hlCdQXsvdQjd8jP3N4Jd1iio%2FXT1OG2xDkgfPqslTGKK%2BFXzQz74PXHRluctG9tdSSPWzdkHfJ8rE3jSfQ%3D%3D\u0026X-Amz-Signature=303a72da78c0111fb0131a65ff92745a3523810f4362a11d19ce56e298f613fc"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8300381,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-15T22:32:01.840Z","updated_at":"2020-06-15T22:32:01.840Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":750474},"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8300383,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is shipped, thanks!","markdown_message":"\u003cp\u003eThis is shipped, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-15T22:32:06.208Z","updated_at":"2020-06-15T22:32:06.208Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fletchto99","url":"/fletchto99"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8301043,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @tenderlove and @jack_mccracken, unless there's any reservations any issues with disclosing?","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/tenderlove\"\u003e@tenderlove\u003c/a\u003e and \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e, unless there\u0026#39;s any reservations any issues with disclosing?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-16T01:20:37.735Z","updated_at":"2020-06-16T01:20:37.735Z","first_to_agree":true,"actor":{"username":"fletchto99","cleared":false,"url":"/fletchto99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/egeK1BGNaCNZkCgKcCQFvWHY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8306278,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-16T13:27:51.927Z","updated_at":"2020-06-16T13:27:51.927Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8306279,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-16T13:27:52.028Z","updated_at":"2020-06-16T13:27:52.028Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}