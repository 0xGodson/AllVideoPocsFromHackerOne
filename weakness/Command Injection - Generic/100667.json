{"id":100667,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA2Njc=","url":"https://hackerone.com/reports/100667","title":"CSV Excel Macro Injection Vulnerability in export list of current users - app.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-20T13:08:53.815Z","submitted_at":"2015-11-20T13:08:53.815Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-01T21:06:58.665Z","bug_reporter_agreed_on_going_public_at":"2015-12-01T21:05:36.369Z","team_member_agreed_on_going_public_at":"2015-12-01T21:06:58.454Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found that when a user tries to Export list of current users who installed his apps through: `https://app.shopify.com/services/partners/api_clients/\u003capp_id\u003e/export_installed_users`  the fields of the CSV file are not properly escaped. which makes them vulnerable to CSV Excel Macro Injection. \n#Scenario:\nAn attacker could change his shop name to a malicious function that executes malware on the user's PC. Since functions aren't escaped, the possibilities of using this can be limitless and can cause a severe impact. One example is having it execute malware on the user computer.\n#Steps to reproduce:\n1. Login to your partner account then go to https://app.shopify.com/services/partners/api_clients and create a new app.\n2. Go to `\u003cyour_store\u003e.myshopify.com/admin/oauth/authorize?client_id=\u003capp_api_key\u003e\u0026redirect_uri=\u003capp_redirect_uri\u003e\u0026response_type=code\u0026scope=read_products%2Cwrite_products`\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\n**where The `\u003capp_api_key\u003e` is the api key of the app you have created through the partner account and the `\u003capp_redirect_uri\u003e` is the redirect url of it.**\n3. Now click `Install app` \n4. Go to `\u003cyour_store\u003e.myshopify.com/admin/settings` and change the store name to `-2+3+cmd|' /C calc'!D2` \n5. Go to `https://app.shopify.com/services/partners/api_clients/\u003capp_id\u003e/` then scroll down and click the `Export list of current users` button . then A CSV file will be sent to your email , open that file and you'll see that the cell is active and the command will be executed.\n\n####References: \n- https://www.owasp.org/index.php/CSV_Excel_Macro_Injection\n- https://hackerone.com/reports/72785\n- https://hackerone.com/reports/90415\n\nThanks\n","vulnerability_information_html":"\u003cp\u003eHi , I have found that when a user tries to Export list of current users who installed his apps through: \u003ccode\u003ehttps://app.shopify.com/services/partners/api_clients/\u0026lt;app_id\u0026gt;/export_installed_users\u003c/code\u003e  the fields of the CSV file are not properly escaped. which makes them vulnerable to CSV Excel Macro Injection. \u003c/p\u003e\n\n\u003ch1 id=\"scenario\"\u003eScenario:\u003c/h1\u003e\n\n\u003cp\u003eAn attacker could change his shop name to a malicious function that executes malware on the user\u0026#39;s PC. Since functions aren\u0026#39;t escaped, the possibilities of using this can be limitless and can cause a severe impact. One example is having it execute malware on the user computer.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to your partner account then go to \u003ca title=\"https://app.shopify.com/services/partners/api_clients\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2Fservices%2Fpartners%2Fapi_clients\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com/services/partners/api_clients\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and create a new app.\u003c/li\u003e\n\u003cli\u003eGo to \u003ccode\u003e\u0026lt;your_store\u0026gt;.myshopify.com/admin/oauth/authorize?client_id=\u0026lt;app_api_key\u0026gt;\u0026amp;redirect_uri=\u0026lt;app_redirect_uri\u0026gt;\u0026amp;response_type=code\u0026amp;scope=read_products%2Cwrite_products\u003c/code\u003e                     \n\u003cstrong\u003ewhere The \u003ccode\u003e\u0026lt;app_api_key\u0026gt;\u003c/code\u003e is the api key of the app you have created through the partner account and the \u003ccode\u003e\u0026lt;app_redirect_uri\u0026gt;\u003c/code\u003e is the redirect url of it.\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eNow click \u003ccode\u003eInstall app\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003eGo to \u003ccode\u003e\u0026lt;your_store\u0026gt;.myshopify.com/admin/settings\u003c/code\u003e and change the store name to \u003ccode\u003e-2+3+cmd|\u0026#39; /C calc\u0026#39;!D2\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003eGo to \u003ccode\u003ehttps://app.shopify.com/services/partners/api_clients/\u0026lt;app_id\u0026gt;/\u003c/code\u003e then scroll down and click the \u003ccode\u003eExport list of current users\u003c/code\u003e button . then A CSV file will be sent to your email , open that file and you\u0026#39;ll see that the cell is active and the command will be executed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch4 id=\"references\"\u003eReferences:\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://www.owasp.org/index.php/CSV_Excel_Macro_Injection\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FCSV_Excel_Macro_Injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/CSV_Excel_Macro_Injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://hackerone.com/reports/72785\" href=\"https://hackerone.com/reports/72785\"\u003ehttps://hackerone.com/reports/72785\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://hackerone.com/reports/90415\" href=\"https://hackerone.com/reports/90415\"\u003ehttps://hackerone.com/reports/90415\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-31T21:05:38.286Z","allow_singular_disclosure_after":-157619135.71916035,"singular_disclosure_allowed":true,"vote_count":1,"voters":["spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":692915,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-11-20T13:08:54.762Z","updated_at":"2015-11-20T13:08:54.762Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":693092,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thank you for this disclosure. This issue is already known by our security team, and we are working on a fix.\n","markdown_message":"\u003cp\u003eThank you for this disclosure. This issue is already known by our security team, and we are working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-20T16:19:11.152Z","updated_at":"2015-11-20T16:19:11.152Z","original_report_id":96470,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":693101,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Sorry, I closed as a dup of the wrong report. Let me have another look.","markdown_message":"\u003cp\u003eSorry, I closed as a dup of the wrong report. Let me have another look.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-20T16:32:15.320Z","updated_at":"2015-11-20T16:32:15.320Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":693244,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This does appear to be a new issue. Our engineering team is investigating.","markdown_message":"\u003cp\u003eThis does appear to be a new issue. Our engineering team is investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-20T17:44:52.930Z","updated_at":"2015-11-20T17:44:52.930Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":693253,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome , thanks :-D ","markdown_message":"\u003cp\u003eAwesome , thanks :-D \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-20T17:50:10.303Z","updated_at":"2015-11-20T17:50:10.303Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":704949,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug was resolved today so I will close this issue as Resolved. Due to the low severity of this issue as well as the fact that this requires social engineering to exploit, this issue is not eligible for a bounty under our program rules. Thanks again for making this report!","markdown_message":"\u003cp\u003eThis bug was resolved today so I will close this issue as Resolved. Due to the low severity of this issue as well as the fact that this requires social engineering to exploit, this issue is not eligible for a bounty under our program rules. Thanks again for making this report!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-01T21:02:44.707Z","updated_at":"2015-12-01T21:02:44.707Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":704950,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-01T21:02:49.905Z","updated_at":"2015-12-01T21:02:49.905Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":704955,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No worries.\nCan we disclose it publicly ? ","markdown_message":"\u003cp\u003eNo worries.\u003cbr\u003e\nCan we disclose it publicly ? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-01T21:05:36.408Z","updated_at":"2015-12-01T21:07:11.732Z","first_to_agree":true,"actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":704957,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-01T21:06:58.485Z","updated_at":"2015-12-01T21:06:58.485Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":704958,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-01T21:06:58.707Z","updated_at":"2015-12-01T21:06:58.707Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1075,"category":"team","content":"A CSV formula injection issue when a Partner export the list of current users for one of their application.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA CSV formula injection issue when a Partner export the list of current users for one of their application.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}