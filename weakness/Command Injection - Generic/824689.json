{"id":824689,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjQ2ODk=","url":"https://hackerone.com/reports/824689","title":"Send arbitrary PUT requests when user clicks on a link","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-19T14:09:58.998Z","submitted_at":"2020-03-19T14:09:58.998Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yvvdwf","url":"/yvvdwf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-27T08:44:34.335Z","bug_reporter_agreed_on_going_public_at":"2020-07-27T08:39:58.419Z","team_member_agreed_on_going_public_at":"2020-07-27T08:44:34.259Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear teams,\n\n### Summary\n\nMermaid allows users to set class name of a block. This ability becomes vulnerable in Gitlab issues because of [issue.js#L90](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/issue.js#L90):\n\n```javascript\n    return $(document).on(\n      'click',\n      '.js-issuable-actions a.btn-close, .js-issuable-actions a.btn-reopen',\n      e =\u003e {\n...\n       const $button = $(e.currentTarget);\n...\n        const url = $button.attr('href');\n        return axios\n          .put(url)\n          .then(({ data }) =\u003e {\n...\n```\n\n### Steps to reproduce\n\n 1. Create any issue\n 2. Enter the following payload as the description of the issue:\n\n```\n```mermaid\ngraph TD;\n A[Click to send a PUT request];\n class A js-issuable-actions;\n class A btn-close;\n click A \"./put-destination\" \"click to PUT\"\n```\n\nAfter saving the issue, if you click on the block `Click to send a PUT request`, a `PUT` request will be sent to `./put-destination`\n\n### Impact\n\nSince attacker can control `./put-destination`, he can theoretically can perform any PUT requests on behalf of the current user.\nFor example, attacker can use the following url to update the description of issue #2:\n\n`/api/v4/projects/16210710/issues/2?description=a`\n\n### Examples\n\nAn example is available here: https://gitlab.com/yvvdwf/xss/-/issues/1 (it is private, pls let me know if you cannot access it)\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n## Impact\n\nWhen received click of user, attacker may perform arbitrary PUT requests of the behalf of the user","vulnerability_information_html":"\u003cp\u003eDear teams,\u003c/p\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eMermaid allows users to set class name of a block. This ability becomes vulnerable in Gitlab issues because of \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fblob%2Fmaster%2Fapp%2Fassets%2Fjavascripts%2Fissue.js%23L90\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eissue.js#L90\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.js-issuable-actions a.btn-close, .js-issuable-actions a.btn-reopen\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ee\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n       \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003e$button\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrentTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$button\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehref\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eaxios\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e\u003cspan class=\"p\"\u003e(({\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate any issue\u003c/li\u003e\n\u003cli\u003eEnter the following payload as the description of the issue:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e```mermaid\ngraph TD;\n A[Click to send a PUT request];\n class A js-issuable-actions;\n class A btn-close;\n click A \u0026quot;./put-destination\u0026quot; \u0026quot;click to PUT\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter saving the issue, if you click on the block \u003ccode\u003eClick to send a PUT request\u003c/code\u003e, a \u003ccode\u003ePUT\u003c/code\u003e request will be sent to \u003ccode\u003e./put-destination\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact\u003c/h3\u003e\n\n\u003cp\u003eSince attacker can control \u003ccode\u003e./put-destination\u003c/code\u003e, he can theoretically can perform any PUT requests on behalf of the current user.\u003cbr\u003e\nFor example, attacker can use the following url to update the description of issue #2:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e/api/v4/projects/16210710/issues/2?description=a\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3 id=\"examples\"\u003eExamples\u003c/h3\u003e\n\n\u003cp\u003eAn example is available here: \u003ca title=\"https://gitlab.com/yvvdwf/xss/-/issues/1\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fyvvdwf%2Fxss%2F-%2Fissues%2F1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/yvvdwf/xss/-/issues/1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (it is private, pls let me know if you cannot access it)\u003c/p\u003e\n\n\u003ch3 id=\"output-of-checks\"\u003eOutput of checks\u003c/h3\u003e\n\n\u003cp\u003eThis bug happens on GitLab.com\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWhen received click of user, attacker may perform arbitrary PUT requests of the behalf of the user\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":127,"voters":["sky003","overjt","kapytein","foobar7","everybodyhurts","holme","th4nu_0x0","miraclee","romesful","rahsec","and 117 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7370002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yvvdwf,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 10 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-19T15:05:54.294Z","updated_at":"2020-03-19T15:05:54.294Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7370782,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @yvvdwf,\n\nThank you for this report.\nYet when using the documented payload and clicking on the link, a GET request is executed by the browser (Chrome and Firefox)  to `/put-destination` \n\nCan you please confirm a GET query is executed and not a PUT ?\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report.\u003cbr\u003e\nYet when using the documented payload and clicking on the link, a GET request is executed by the browser (Chrome and Firefox)  to \u003ccode\u003e/put-destination\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eCan you please confirm a GET query is executed and not a PUT ?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-19T16:40:19.468Z","updated_at":"2020-03-19T16:40:19.468Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7371969,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jmatos_bgtvf ,\n\nThank you for the quick reply. Please put the payload into an issue's description or comment (not in a wiki page). Otherwise, I create a small video demo in the attached file.\n\nRegards,","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmatos_bgtvf\"\u003e@jmatos_bgtvf\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for the quick reply. Please put the payload into an issue\u0026#39;s description or comment (not in a wiki page). Otherwise, I create a small video demo in the attached file.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-19T19:26:51.068Z","updated_at":"2020-03-19T19:26:51.068Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":753562,"filename":"send-put-request.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Es2KmqqpyssDae4uth3SDYau?response-content-disposition=attachment%3B%20filename%3D%22send-put-request.mp4%22%3B%20filename%2A%3DUTF-8%27%27send-put-request.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVHABZQ6K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065811Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDLEUqN2OLO3OoArpAduXGS%2FnWvclGJ7L%2FhS7ZlCNuSFwIhAKgaDWYosUsMZYxmwMD0tSfLg1FWhbQHhU86z2hns38zKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgwVVQvbJjCbXZyRbMQqkQM9XNobju5ij3mHEd1PgXrpuzeU%2BCZaLl8s8%2FXPts8hYLholdRFqlYhDzTmecfnLqTs%2FH8df0Fzv8NVTOhsz9Cu3LtPJmYcyMM6%2BCttQ0%2F5YV36HpOoKx7YBCXq6g1wpqiR5h0NB8nCyNbtahjtqqfKrkQsAJtF0n6vty0Dy5dIMaKZufttk1eoYubwLgfaN4YAthfVEyCI75XoSBcWtozJGhmqio20Kggp%2Ff9ESWUDjkkVQkVc66j8SevucVwBZgdZjxbmMc3p%2B%2FrtliE8Di2Ov48U%2Bmiyzxgy0RsqgwBWQeuC1Vvrs6a5UgzB5X13VoO7Zw2O5pS1EKsi0EwbwxD1t1gkpOGC1X37B6qMMiSraZswcogi35QEMA8XAQhIC2z%2Byugz3gdhCR4lBTeHgZARRoRQvNYoLHEkvjD4clJ4fdfbD%2FRcWQb953U%2BunjxQu2802uN7zsOYAZ%2F1SufQ8paJbIHLgiZu%2FJLfuV6RY9q9hQTpnm6QoNT4fkLlHao602RIKkBGhLK4iU4VXdLBpw5JDCJiav%2FBTrqAW2UJwXizthXBPPIZ57e77V%2B1Jr9Up7MhIMK722MpJQ5S6y2sEj0IRzF6bBvFIGcuc7s5TvUPI3RoSg3%2BoRepHEHQDZpJfcEB%2FPh8Jr6a8ILTQYD91llJENl%2B%2FADn1n%2B0ihsitf2dEU%2F8Jff%2FNN3i9J2juS2OvqLeEbMdBuCToL%2BbYC8hsevJk6YzpVS0q2WxfTPUq4t7RHDwzTYfPmQnso8MCFcSKpUgp39ZmtjV4S1TWj23dyd7WkHgRbrIsNiFZci3GJYaEnzJmzKDIghO7k6z8NutfGp8Ayl%2FCKxt1goZhsy13ssETolsg%3D%3D\u0026X-Amz-Signature=88e02d20e55ee7474ddf8718f6f56c9ebedebdf128dfac9e0371517ec809df21"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7372417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the quick feedback.\n\nI confirm I can reproduce the issue on Gitlab 12.9.0-pre (gitlab.com and self-hosted), but not on the latest official self-hosted release (12.8.7).\nLet me come back to you once impact has been fully assessed.\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eThank you for the quick feedback.\u003c/p\u003e\n\n\u003cp\u003eI confirm I can reproduce the issue on Gitlab 12.9.0-pre (gitlab.com and self-hosted), but not on the latest official self-hosted release (12.8.7).\u003cbr\u003e\nLet me come back to you once impact has been fully assessed.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-19T20:30:25.707Z","updated_at":"2020-03-19T20:30:25.707Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378413,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @yvvdwf,\n\nThank you for submitting this report.\nFor your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/211949. This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nSecurity Team | GitLab Inc.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003cbr\u003e\nFor your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\u003c/p\u003e\n\n\u003cp\u003eWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/-/issues/211949\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fissues%2F211949\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/-/issues/211949\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This issue will be made public 30 days following the release of a patch.\u003c/p\u003e\n\n\u003cp\u003eGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe will continue to update you via HackerOne as a patch is scheduled for release.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T14:13:08.908Z","updated_at":"2020-03-20T14:13:08.908Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378421,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-20T14:13:54.800Z","updated_at":"2020-03-20T14:13:54.800Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378586,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","markdown_message":"\u003cp\u003eThank you for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T14:34:19.878Z","updated_at":"2020-03-20T14:34:19.878Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7382736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @yvvdwf,\n\nThe issue you reported is currently scheduled to be fixed by 2020-04-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe issue you reported is currently scheduled to be fixed by 2020-04-30.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-21T04:06:44.906Z","updated_at":"2020-03-21T04:06:44.906Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7468133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\u003e For your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\n\nYes, this is correct for the example above: `/api/v4/projects/16210710/issues/2?description=a`\n (if attackers want to change an issue's description **of the current project** (the one contains the issue))\n\nSince attacker can use any project id (in another attack), he may update any issues of any projects the victim has Reporter role.\n\nOtherwise, attacker can also use any API supporting PUT request, such as [`PUT /projects/:id`](https://docs.gitlab.com/ee/api/projects.html#edit-project) to update an existing project if the victim has permission to do that.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eFor your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes, this is correct for the example above: \u003ccode\u003e/api/v4/projects/16210710/issues/2?description=a\u003c/code\u003e\u003cbr\u003e\n (if attackers want to change an issue\u0026#39;s description \u003cstrong\u003eof the current project\u003c/strong\u003e (the one contains the issue))\u003c/p\u003e\n\n\u003cp\u003eSince attacker can use any project id (in another attack), he may update any issues of any projects the victim has Reporter role.\u003c/p\u003e\n\n\u003cp\u003eOtherwise, attacker can also use any API supporting PUT request, such as \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.gitlab.com%2Fee%2Fapi%2Fprojects.html%23edit-project\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ePUT /projects/:id\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to update an existing project if the victim has permission to do that.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-28T21:36:11.694Z","updated_at":"2020-03-28T21:36:11.694Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8145620,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @yvvdwf,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.0.1 and we will soon be warding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched in GitLab version 13.0.1 and we will soon be warding a bounty. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-29T14:19:47.224Z","updated_at":"2020-05-29T14:19:47.224Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yvvdwf","url":"/yvvdwf"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8175597,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T08:00:15.132Z","updated_at":"2020-06-02T08:00:15.132Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8175613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome! Thank you for the bounty!!","markdown_message":"\u003cp\u003eAwesome! Thank you for the bounty!!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T08:02:51.813Z","updated_at":"2020-06-02T08:02:51.813Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762183,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The internal issue has been public, so let's open this one also!","markdown_message":"\u003cp\u003eThe internal issue has been public, so let\u0026#39;s open this one also!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T08:39:58.444Z","updated_at":"2020-07-27T08:39:58.444Z","first_to_agree":true,"actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762241,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-27T08:44:34.277Z","updated_at":"2020-07-27T08:44:34.277Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762242,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-27T08:44:34.357Z","updated_at":"2020-07-27T08:44:34.357Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}