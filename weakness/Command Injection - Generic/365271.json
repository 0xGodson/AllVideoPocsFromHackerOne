{"id":365271,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjUyNzE=","url":"https://hackerone.com/reports/365271","title":"Remote code execution on Basecamp.com","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-06-13T07:27:51.328Z","submitted_at":"2018-06-13T07:27:51.328Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gammarex","url":"/gammarex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":67,"url":"https://hackerone.com/basecamp","handle":"basecamp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Basecamp","twitter_handle":"basecamp","website":"https://basecamp.com/about/policies/security/response","about":"Basecamp is the leading online project manager and the birthplace of Ruby on Rails."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-26T18:22:15.199Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-27T18:22:09.455Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A critical flaw in Basecamp's profile image upload function leads to remote command execution. Images are converted on the server side, but not only image files but also PostScript/EPS files are accepted (if renamed to .gif). This is probably due to ImageMagick / GraphicsMagick being used for image conversion, which calls a PostScript interpreter (Ghostscript) if the input file starts with '%!'. The used Ghostscript version however has a security bug (CVE-2017-8291) leading to remote command execution.\n\n/Proof of concept/: Upload the attached rce.gif file as profile image (change the `ping -c1 attacker.com' to some other shell command).\n\n/Mitigation/: Upgrade Ghostscript; also, before processing uploaded images make sure they are real image files (e.g. based on magic header)\n\n## Impact\n\nGain a remote shell; from here start exploitation/privilege escalation","vulnerability_information_html":"\u003cp\u003eA critical flaw in Basecamp\u0026#39;s profile image upload function leads to remote command execution. Images are converted on the server side, but not only image files but also PostScript/EPS files are accepted (if renamed to .gif). This is probably due to ImageMagick / GraphicsMagick being used for image conversion, which calls a PostScript interpreter (Ghostscript) if the input file starts with \u0026#39;%!\u0026#39;. The used Ghostscript version however has a security bug (CVE-2017-8291) leading to remote command execution.\u003c/p\u003e\n\n\u003cp\u003e/Proof of concept/: Upload the attached rce.gif file as profile image (change the `ping -c1 attacker.com\u0026#39; to some other shell command).\u003c/p\u003e\n\n\u003cp\u003e/Mitigation/: Upgrade Ghostscript; also, before processing uploaded images make sure they are real image files (e.g. based on magic header)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eGain a remote shell; from here start exploitation/privilege escalation\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":308414,"file_name":"rce.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/308/414/db10af4eb698996eda0c5ff9e0e16dc9d418caf2/rce.gif?response-content-disposition=attachment%3B%20filename%3D%22rce.gif%22%3B%20filename%2A%3DUTF-8%27%27rce.gif\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054429Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=05aab6a32c398d9af6dfd54e808aaae76e8369f19fff3d4a783a2700a748b4a8","file_size":1833,"type":"application/postscript"}],"allow_singular_disclosure_at":"2020-11-26T18:22:09.648Z","allow_singular_disclosure_after":-2805739.701745553,"singular_disclosure_allowed":true,"vote_count":318,"voters":["moloshy","pretorian","sgt_","r4d1kal","sw33tlie","hipotermia","abrahack","carbon61","excavator","najeh_halawani","and 308 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":4654,"asset_type":"URL","asset_identifier":"basecamp.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2879124,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks, Jens! We greatly appreciate you identifying this vulnerability and disclosing it responsibly. We’re awarding you $2,000—one of our largest bounties to date—because this is among the most serious vulnerabilities possible.","markdown_message":"\u003cp\u003eThanks, Jens! We greatly appreciate you identifying this vulnerability and disclosing it responsibly. We’re awarding you $2,000—one of our largest bounties to date—because this is among the most serious vulnerabilities possible.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T12:23:45.200Z","updated_at":"2018-06-13T12:23:45.200Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Basecamp"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"gammarex","url":"/gammarex"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879126,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We resolved this by disallowing the libgs-based PS and PDF coders in our ImageMagick security policy.","markdown_message":"\u003cp\u003eWe resolved this by disallowing the libgs-based PS and PDF coders in our ImageMagick security policy.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T12:25:07.706Z","updated_at":"2018-06-13T12:25:07.706Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gammarex","url":"/gammarex"},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for the bounty, appreciate it!","markdown_message":"\u003cp\u003eThanks a lot for the bounty, appreciate it!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T12:46:28.071Z","updated_at":"2018-06-13T12:46:28.071Z","actor":{"username":"gammarex","cleared":false,"url":"/gammarex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879530,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"After some discussion amongst our security and operations teams, we’re adding $3,000 to your bounty to better acknowledge the severity of this vulnerability. Thanks again!","markdown_message":"\u003cp\u003eAfter some discussion amongst our security and operations teams, we’re adding $3,000 to your bounty to better acknowledge the severity of this vulnerability. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T14:40:32.495Z","updated_at":"2018-06-13T14:50:00.767Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Basecamp"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"gammarex","url":"/gammarex"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2880257,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow, thanks again -- really appreciate it!","markdown_message":"\u003cp\u003eWow, thanks again -- really appreciate it!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T18:11:52.851Z","updated_at":"2018-06-13T18:11:52.851Z","actor":{"username":"gammarex","cleared":false,"url":"/gammarex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9651403,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-27T18:22:09.539Z","updated_at":"2020-10-27T18:22:09.539Z","first_to_agree":true,"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9937170,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-26T18:22:15.226Z","updated_at":"2020-11-26T18:22:15.226Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Basecamp"}},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}