{"id":146179,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDYxNzk=","url":"https://hackerone.com/reports/146179","title":"REG: Content provider information leakage","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-21T07:24:01.841Z","submitted_at":"2016-06-21T07:24:01.841Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zeroknife","url":"/zeroknife","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/542/b75f8924d65374016ee8a5b4969ef27fc4ff2675_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-24T08:48:39.291Z","bug_reporter_agreed_on_going_public_at":"2016-06-24T04:58:14.980Z","team_member_agreed_on_going_public_at":"2016-06-24T08:48:39.059Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Issue :\nWhile analyzing your code of manifest.xml i found a issue related to content provider information leakage .\n\nIssue description :\n\nYour content provider settings will allowing any other app on the device to access it (AndroidManifest.xml). You should modify the attribute to [exported=\"false\"] or set at least \"signature\" protectionalLevel permission if you don't want to.\n\nwhere i found the issue :\n\n provider =\u003e com.owncloud.android.providers.FileContentProvider\n provider =\u003e com.owncloud.android.ui.adapter.DiskLruImageCacheFileProvider\n\nWhats the impact : \n\nother apps can read the contents,the malformed application can be used to extract information from the content provider .\n\nCode from your manifest.xml kinldy note that **exported=true**  :\n\u003cservice\n            android:name=\".authentication.AccountAuthenticatorService\"\n            android:exported=\"true\" \u003e\n            \u003cintent-filter android:priority=\"100\" \u003e\n                \u003caction android:name=\"android.accounts.AccountAuthenticator\" /\u003e\n            \u003c/intent-filter\u003e\n  \u003cmeta-data\n                android:name=\"android.accounts.AccountAuthenticator\"\n                android:resource=\"@xml/authenticator\" /\u003e\n        \u003c/service\u003e\n        \u003cservice\n            android:name=\".syncadapter.FileSyncService\"\n            android:exported=\"true\" \u003e\n            \u003cintent-filter\u003e\n                \u003caction android:name=\"android.content.SyncAdapter\" /\u003e\n            \u003c/intent-filter\u003e\n    \u003cmeta-data\n                android:name=\"android.content.SyncAdapter\"\n                android:resource=\"@xml/syncadapter_files\" /\u003e\n        \u003c/service\u003e\n  \u003cprovider\n            android:name=\".providers.FileContentProvider\"\n            android:authorities=\"@string/authority\"\n            android:enabled=\"true\"\n            android:exported=\"false\"\n            android:label=\"@string/sync_string_files\"\n            android:syncable=\"true\" /\u003e\n\n\u003cprovider\n            android:name=\".providers.UsersAndGroupsSearchProvider\"\n            android:authorities=\"com.nextcloud.android.providers.UsersAndGroupsSearchProvider\"\n            android:enabled=\"true\"\n            android:exported=\"false\"\n            android:label=\"@string/search_users_and_groups_hint\" /\u003e\n\u003cactivity\n            android:name=\".authentication.AuthenticatorActivity\"\n            android:exported=\"true\"\n            android:launchMode=\"singleTask\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar\" \u003e\n            \u003cintent-filter\u003e\n                \u003caction android:name=\"android.intent.action.VIEW\" /\u003e\n \u003ccategory android:name=\"android.intent.category.DEFAULT\" /\u003e\n                \u003ccategory android:name=\"android.intent.category.BROWSABLE\" /\u003e\n\u003cdata android:scheme=\"@string/oauth2_redirect_scheme\" /\u003e\n            \u003c/intent-filter\u003e\n            \u003cintent-filter\u003e\n                \u003caction android:name=\"com.owncloud.android.workaround.accounts.CREATE\" /\u003e\n\u003ccategory android:name=\"android.intent.category.DEFAULT\" /\u003e\n            \u003c/intent-filter\u003e\n\u003c/activity\u003e\n\n\nreferences : \n\n(1)https://www.nowsecure.com/mobile-security/ebay-android-content-provider-injection-vulnerability.html\n(2)http://blog.trustlook.com/2013/10/23/ebay-android-content-provider-information-disclosure-vulnerability/\n(3)http://www.wooyun.org/bugs/wooyun-2010-039169\n\nLet me know incase of any other concerns\n\n\n","vulnerability_information_html":"\u003cp\u003eIssue :\u003cbr\u003e\nWhile analyzing your code of manifest.xml i found a issue related to content provider information leakage .\u003c/p\u003e\n\n\u003cp\u003eIssue description :\u003c/p\u003e\n\n\u003cp\u003eYour content provider settings will allowing any other app on the device to access it (AndroidManifest.xml). You should modify the attribute to [exported=\u0026quot;false\u0026quot;] or set at least \u0026quot;signature\u0026quot; protectionalLevel permission if you don\u0026#39;t want to.\u003c/p\u003e\n\n\u003cp\u003ewhere i found the issue :\u003c/p\u003e\n\n\u003cp\u003eprovider =\u0026gt; com.owncloud.android.providers.FileContentProvider\u003cbr\u003e\n provider =\u0026gt; com.owncloud.android.ui.adapter.DiskLruImageCacheFileProvider\u003c/p\u003e\n\n\u003cp\u003eWhats the impact : \u003c/p\u003e\n\n\u003cp\u003eother apps can read the contents,the malformed application can be used to extract information from the content provider .\u003c/p\u003e\n\n\u003cp\u003eCode from your manifest.xml kinldy note that \u003cstrong\u003eexported=true\u003c/strong\u003e  :\u003cbr\u003e\n\u0026lt;service\u003cbr\u003e\n            android:name=\u0026quot;.authentication.AccountAuthenticatorService\u0026quot;\u003cbr\u003e\n            android:exported=\u0026quot;true\u0026quot; \u0026gt;\u003cbr\u003e\n            \u0026lt;intent-filter android:priority=\u0026quot;100\u0026quot; \u0026gt;\u003cbr\u003e\n                \u0026lt;action android:name=\u0026quot;android.accounts.AccountAuthenticator\u0026quot; /\u0026gt;\u003cbr\u003e\n            \u0026lt;/intent-filter\u0026gt;\u003cbr\u003e\n  \u0026lt;meta-data\u003cbr\u003e\n                android:name=\u0026quot;android.accounts.AccountAuthenticator\u0026quot;\u003cbr\u003e\n                android:resource=\u0026quot;@xml/authenticator\u0026quot; /\u0026gt;\u003cbr\u003e\n        \u0026lt;/service\u0026gt;\u003cbr\u003e\n        \u0026lt;service\u003cbr\u003e\n            android:name=\u0026quot;.syncadapter.FileSyncService\u0026quot;\u003cbr\u003e\n            android:exported=\u0026quot;true\u0026quot; \u0026gt;\u003cbr\u003e\n            \u0026lt;intent-filter\u0026gt;\u003cbr\u003e\n                \u0026lt;action android:name=\u0026quot;android.content.SyncAdapter\u0026quot; /\u0026gt;\u003cbr\u003e\n            \u0026lt;/intent-filter\u0026gt;\u003cbr\u003e\n    \u0026lt;meta-data\u003cbr\u003e\n                android:name=\u0026quot;android.content.SyncAdapter\u0026quot;\u003cbr\u003e\n                android:resource=\u0026quot;@xml/syncadapter_files\u0026quot; /\u0026gt;\u003cbr\u003e\n        \u0026lt;/service\u0026gt;\u003cbr\u003e\n  \u0026lt;provider\u003cbr\u003e\n            android:name=\u0026quot;.providers.FileContentProvider\u0026quot;\u003cbr\u003e\n            android:authorities=\u0026quot;@string/authority\u0026quot;\u003cbr\u003e\n            android:enabled=\u0026quot;true\u0026quot;\u003cbr\u003e\n            android:exported=\u0026quot;false\u0026quot;\u003cbr\u003e\n            android:label=\u0026quot;@string/sync_string_files\u0026quot;\u003cbr\u003e\n            android:syncable=\u0026quot;true\u0026quot; /\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;provider\u003cbr\u003e\n            android:name=\u0026quot;.providers.UsersAndGroupsSearchProvider\u0026quot;\u003cbr\u003e\n            android:authorities=\u0026quot;com.nextcloud.android.providers.UsersAndGroupsSearchProvider\u0026quot;\u003cbr\u003e\n            android:enabled=\u0026quot;true\u0026quot;\u003cbr\u003e\n            android:exported=\u0026quot;false\u0026quot;\u003cbr\u003e\n            android:label=\u0026quot;@string/search_users_and_groups_hint\u0026quot; /\u0026gt;\u003cbr\u003e\n\u0026lt;activity\u003cbr\u003e\n            android:name=\u0026quot;.authentication.AuthenticatorActivity\u0026quot;\u003cbr\u003e\n            android:exported=\u0026quot;true\u0026quot;\u003cbr\u003e\n            android:launchMode=\u0026quot;singleTask\u0026quot;\u003cbr\u003e\n            android:theme=\u0026quot;@style/Theme.ownCloud.noActionBar\u0026quot; \u0026gt;\u003cbr\u003e\n            \u0026lt;intent-filter\u0026gt;\u003cbr\u003e\n                \u0026lt;action android:name=\u0026quot;android.intent.action.VIEW\u0026quot; /\u0026gt;\u003cbr\u003e\n \u0026lt;category android:name=\u0026quot;android.intent.category.DEFAULT\u0026quot; /\u0026gt;\u003cbr\u003e\n                \u0026lt;category android:name=\u0026quot;android.intent.category.BROWSABLE\u0026quot; /\u0026gt;\u003cbr\u003e\n\u0026lt;data android:scheme=\u0026quot;@string/oauth2_redirect_scheme\u0026quot; /\u0026gt;\u003cbr\u003e\n            \u0026lt;/intent-filter\u0026gt;\u003cbr\u003e\n            \u0026lt;intent-filter\u0026gt;\u003cbr\u003e\n                \u0026lt;action android:name=\u0026quot;com.owncloud.android.workaround.accounts.CREATE\u0026quot; /\u0026gt;\u003cbr\u003e\n\u0026lt;category android:name=\u0026quot;android.intent.category.DEFAULT\u0026quot; /\u0026gt;\u003cbr\u003e\n            \u0026lt;/intent-filter\u0026gt;\u003cbr\u003e\n\u0026lt;/activity\u0026gt;\u003c/p\u003e\n\n\u003cp\u003ereferences : \u003c/p\u003e\n\n\u003cp\u003e(1)\u003ca title=\"https://www.nowsecure.com/mobile-security/ebay-android-content-provider-injection-vulnerability.html\" href=\"/redirect?url=https%3A%2F%2Fwww.nowsecure.com%2Fmobile-security%2Febay-android-content-provider-injection-vulnerability.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.nowsecure.com/mobile-security/ebay-android-content-provider-injection-vulnerability.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(2)\u003ca title=\"http://blog.trustlook.com/2013/10/23/ebay-android-content-provider-information-disclosure-vulnerability/\" href=\"/redirect?url=http%3A%2F%2Fblog.trustlook.com%2F2013%2F10%2F23%2Febay-android-content-provider-information-disclosure-vulnerability%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.trustlook.com/2013/10/23/ebay-android-content-provider-information-disclosure-vulnerability/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(3)\u003ca title=\"http://www.wooyun.org/bugs/wooyun-2010-039169\" href=\"/redirect?url=http%3A%2F%2Fwww.wooyun.org%2Fbugs%2Fwooyun-2010-039169\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.wooyun.org/bugs/wooyun-2010-039169\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know incase of any other concerns\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["sreekanth123","zeroknife","antonio1","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1026090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-21T07:24:02.062Z","updated_at":"2016-06-21T07:24:02.062Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1026159,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Much appreciated!\n\nWe're considering this an accepted risk at the moment because as per our bounty brief and [threat model](https://nextcloud.com/security/threat-model/) we do not consider vulnerabilities involving malicious applications to be existent on the system. \n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re considering this an accepted risk at the moment because as per our bounty brief and \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethreat model\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e we do not consider vulnerabilities involving malicious applications to be existent on the system. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-21T08:53:09.841Z","updated_at":"2016-06-21T08:53:09.841Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1033444,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-24T04:58:15.009Z","updated_at":"2016-06-24T04:58:15.009Z","first_to_agree":true,"actor":{"username":"zeroknife","cleared":false,"url":"/zeroknife","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/542/b75f8924d65374016ee8a5b4969ef27fc4ff2675_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1033976,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosed by request of reporter.","markdown_message":"\u003cp\u003eDisclosed by request of reporter.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-24T08:48:39.180Z","updated_at":"2016-06-24T08:48:39.180Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1033977,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-24T08:48:39.325Z","updated_at":"2016-06-24T08:48:39.325Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke  just out of curiosity will it qualify for HOF of your program?","markdown_message":"\u003cp\u003e\u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e  just out of curiosity will it qualify for HOF of your program?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-21T13:18:06.596Z","updated_at":"2016-07-21T13:18:06.596Z","actor":{"username":"zeroknife","cleared":false,"url":"/zeroknife","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/542/b75f8924d65374016ee8a5b4969ef27fc4ff2675_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}