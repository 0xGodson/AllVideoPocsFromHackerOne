{"id":226335,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjYzMzU=","url":"https://hackerone.com/reports/226335","title":"Escape sequence injection in \"summary\" field","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-05T13:35:48.312Z","submitted_at":"2017-05-05T13:35:48.312Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mame","url":"/mame","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby community’s gem hosting service."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-0899"],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-30T23:20:55.044Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-08-28T16:42:31.637Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Seems we can include any escape sequence in the \"summary\" field of gemspec.  This allows attackers to inject escape sequences to a victim's terminal emulator.\n\n## How to attack\n\n1) An attacker creates a gem with summary string that includes malicious escape sequences, and push it to rubygems.org.\n2) A victim executes `gem search attackers-gem -d`, and the malicious string is printed in the terminal emulator.\n\nIn general, this is considered vulnerable.  I'd like you to read [Terminal Emulator Security Issues](http://marc.info/?l=bugtraq\u0026m=104612710031920\u0026w=2) in detail.  In short, an attacker can exploit this, not only to surprise a victim with a rainbow string, but also to inject malicious command to a victim's terminal, which may lead to abitrary code execution.  Ruby WEBrick also handled a similar issue as [a vulnerability](https://www.ruby-lang.org/en/news/2010/01/10/webrick-escape-sequence-injection/).\n\n\n## Proof of concept\n\n1) Prepare the following gemspec.\n\n~~~\nGem::Specification.new do |spec|\n  spec.name     = \"escape-sequence-injection-vulnerability\"\n  spec.version  = \"0.0.1\"\n  spec.authors  = [\"Yusuke Endoh\"]\n  spec.email    = [\"mame@ruby-lang.org\"]\n  spec.summary  = \"foo\\e[31mbar\\e[0mbaz \\e]2;BOOM!\\a\"\n  spec.homepage = \"http://example.com/\"\n  spec.license  = \"MIT\"\nend\n~~~\n\n2) Run the following commands\n\n~~~\ngem build escape-sequence-injection-vulnerability.gemspec\ngem install escape-sequence-injection-vulnerability-0.0.1.gem\n~~~\n\n3) Run the following command.\n\n~~~\ngem query escape-sequence-injection-vulnerability -d \u0026\u0026 sleep 10\n~~~\n\nYou will see a summary line \"foobarbaz\" (with \"bar\" red), and its window title changed \"BOOM!\".","vulnerability_information_html":"\u003cp\u003eSeems we can include any escape sequence in the \u0026quot;summary\u0026quot; field of gemspec.  This allows attackers to inject escape sequences to a victim\u0026#39;s terminal emulator.\u003c/p\u003e\n\n\u003ch2 id=\"how-to-attack\"\u003eHow to attack\u003c/h2\u003e\n\n\u003cp\u003e1) An attacker creates a gem with summary string that includes malicious escape sequences, and push it to rubygems.org.\u003cbr\u003e\n2) A victim executes \u003ccode\u003egem search attackers-gem -d\u003c/code\u003e, and the malicious string is printed in the terminal emulator.\u003c/p\u003e\n\n\u003cp\u003eIn general, this is considered vulnerable.  I\u0026#39;d like you to read \u003ca href=\"/redirect?url=http%3A%2F%2Fmarc.info%2F%3Fl%3Dbugtraq%26m%3D104612710031920%26w%3D2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eTerminal Emulator Security Issues\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in detail.  In short, an attacker can exploit this, not only to surprise a victim with a rainbow string, but also to inject malicious command to a victim\u0026#39;s terminal, which may lead to abitrary code execution.  Ruby WEBrick also handled a similar issue as \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.ruby-lang.org%2Fen%2Fnews%2F2010%2F01%2F10%2Fwebrick-escape-sequence-injection%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of concept\u003c/h2\u003e\n\n\u003cp\u003e1) Prepare the following gemspec.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGem::Specification.new do |spec|\n  spec.name     = \u0026quot;escape-sequence-injection-vulnerability\u0026quot;\n  spec.version  = \u0026quot;0.0.1\u0026quot;\n  spec.authors  = [\u0026quot;Yusuke Endoh\u0026quot;]\n  spec.email    = [\u0026quot;mame@ruby-lang.org\u0026quot;]\n  spec.summary  = \u0026quot;foo\\e[31mbar\\e[0mbaz \\e]2;BOOM!\\a\u0026quot;\n  spec.homepage = \u0026quot;http://example.com/\u0026quot;\n  spec.license  = \u0026quot;MIT\u0026quot;\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) Run the following commands\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003egem build escape-sequence-injection-vulnerability.gemspec\ngem install escape-sequence-injection-vulnerability-0.0.1.gem\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3) Run the following command.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003egem query escape-sequence-injection-vulnerability -d \u0026amp;\u0026amp; sleep 10\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou will see a summary line \u0026quot;foobarbaz\u0026quot; (with \u0026quot;bar\u0026quot; red), and its window title changed \u0026quot;BOOM!\u0026quot;.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-27T16:42:31.673Z","allow_singular_disclosure_after":-102687627.80921032,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sp1d3rs","ysx","eveeez","sa1tama0","sonalkr132"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1656440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-05-05T13:35:48.451Z","updated_at":"2017-05-05T13:35:48.451Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any progress?\n\nThis issue is exploitable when a victim executes `gem search`, not `gem install`.  So I think that this issue is relatively serious.","markdown_message":"\u003cp\u003eAny progress?\u003c/p\u003e\n\n\u003cp\u003eThis issue is exploitable when a victim executes \u003ccode\u003egem search\u003c/code\u003e, not \u003ccode\u003egem install\u003c/code\u003e.  So I think that this issue is relatively serious.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-15T12:35:09.943Z","updated_at":"2017-05-15T12:35:09.943Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1691400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is anyone there?","markdown_message":"\u003cp\u003eIs anyone there?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-22T13:20:10.875Z","updated_at":"2017-05-22T13:20:10.875Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1692261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi mame, sorry about the delay.\n\nHere is proposed patch to fix the issue, please review:\n\n```\nFrom 3b9379375fb24a2c8b7d261f9108f5d031016729 Mon Sep 17 00:00:00 2001\nFrom: Evan Phoenix \u003cevan@phx.io\u003e\nDate: Mon, 22 May 2017 09:44:08 -0700\nSubject: [PATCH] Clean any text present in gems before displaying it\n\nThis makes sure that any data pulled out of a gem spec is cleaned of all\nnon-printable characters before printing it. This prevents a gem from\ncausing havoc with a users terminal.\n---\n lib/rubygems/commands/query_command.rb           |  2 +-\n lib/rubygems/text.rb                             |  9 +++++-\n test/rubygems/test_gem_commands_query_command.rb | 40 ++++++++++++++++++++++++\n test/rubygems/test_gem_text.rb                   |  4 +++\n 4 files changed, 53 insertions(+), 2 deletions(-)\n\ndiff --git a/lib/rubygems/commands/query_command.rb b/lib/rubygems/commands/query_command.rb\nindex 0f58490e..7a436f76 100644\n--- a/lib/rubygems/commands/query_command.rb\n+++ b/lib/rubygems/commands/query_command.rb\n@@ -226,7 +226,7 @@ is too hard to use.\n         end\n       end\n \n-      output \u003c\u003c make_entry(matching_tuples, platforms)\n+      output \u003c\u003c clean_text(make_entry(matching_tuples, platforms))\n     end\n   end\n \ndiff --git a/lib/rubygems/text.rb b/lib/rubygems/text.rb\nindex 732f1b99..647e2cd4 100644\n--- a/lib/rubygems/text.rb\n+++ b/lib/rubygems/text.rb\n@@ -7,12 +7,19 @@ require 'rubygems'\n module Gem::Text\n \n   ##\n+  # Remove any non-printable characters and make the text suitable for\n+  # printing.\n+  def clean_text(text)\n+    text.gsub(/[^\\u0020-\\u007e\\r\\n\\t]/, \".\")\n+  end\n+\n+  ##\n   # Wraps +text+ to +wrap+ characters and optionally indents by +indent+\n   # characters\n \n   def format_text(text, wrap, indent=0)\n     result = []\n-    work = text.dup\n+    work = clean_text(text)\n \n     while work.length \u003e wrap do\n       if work =~ /^(.{0,#{wrap}})[ \\n]/ then\ndiff --git a/test/rubygems/test_gem_commands_query_command.rb b/test/rubygems/test_gem_commands_query_command.rb\nindex 84701d7c..20f4731c 100644\n--- a/test/rubygems/test_gem_commands_query_command.rb\n+++ b/test/rubygems/test_gem_commands_query_command.rb\n@@ -128,6 +128,46 @@ pl (1)\n     assert_equal '', @ui.error\n   end\n \n+  def test_execute_details_cleans_text\n+    spec_fetcher do |fetcher|\n+      fetcher.spec 'a', 2 do |s|\n+        s.summary = 'This is a lot of text. ' * 4\n+        s.authors = [\"Abraham Lincoln \\u0001\", \"\\u0002 Hirohito\"]\n+        s.homepage = \"http://a.example.com/\\u0003\"\n+      end\n+\n+      fetcher.legacy_platform\n+    end\n+\n+    @cmd.handle_options %w[-r -d]\n+\n+    use_ui @ui do\n+      @cmd.execute\n+    end\n+\n+    expected = \u003c\u003c-EOF\n+\n+*** REMOTE GEMS ***\n+\n+a (2)\n+    Authors: Abraham Lincoln ., . Hirohito\n+    Homepage: http://a.example.com/.\n+\n+    This is a lot of text. This is a lot of text. This is a lot of text.\n+    This is a lot of text.\n+\n+pl (1)\n+    Platform: i386-linux\n+    Author: A User\n+    Homepage: http://example.com\n+\n+    this is a summary\n+    EOF\n+\n+    assert_equal expected, @ui.output\n+    assert_equal '', @ui.error\n+  end\n+\n   def test_execute_installed\n     @cmd.handle_options %w[-n a --installed]\n \ndiff --git a/test/rubygems/test_gem_text.rb b/test/rubygems/test_gem_text.rb\nindex a6e22e04..4875f37c 100644\n--- a/test/rubygems/test_gem_text.rb\n+++ b/test/rubygems/test_gem_text.rb\n@@ -36,6 +36,10 @@ Without the wrapping, the text might not look good in the RSS feed.\n     assert_equal expected, format_text(text, 78)\n   end\n \n+  def test_format_removes_nonprintable_characters\n+    assert_equal \"text with weird .. stuff\", format_text(\"text with weird \\u001b\\u0002 stuff\", 40)\n+  end\n+\n   def test_min3\n     assert_equal 1, min3(1, 1, 1)\n     assert_equal 1, min3(1, 1, 2)\n-- \n2.11.0 (Apple Git-81)\n```","markdown_message":"\u003cp\u003eHi mame, sorry about the delay.\u003c/p\u003e\n\n\u003cp\u003eHere is proposed patch to fix the issue, please review:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003eFrom 3b9379375fb24a2c8b7d261f9108f5d031016729 Mon Sep 17 00:00:00 2001\nFrom: Evan Phoenix \u0026lt;evan@phx.io\u0026gt;\nDate: Mon, 22 May 2017 09:44:08 -0700\nSubject: [PATCH] Clean any text present in gems before displaying it\n\u003c/span\u003e\nThis makes sure that any data pulled out of a gem spec is cleaned of all\n\u003cspan class=\"p\"\u003enon-printable characters before printing it. This prevents a gem from\ncausing havoc with a users terminal.\n---\n\u003c/span\u003e lib/rubygems/commands/query_command.rb           |  2 +-\n lib/rubygems/text.rb                             |  9 +++++-\n test/rubygems/test_gem_commands_query_command.rb | 40 ++++++++++++++++++++++++\n test/rubygems/test_gem_text.rb                   |  4 +++\n 4 files changed, 53 insertions(+), 2 deletions(-)\n\ndiff --git a/lib/rubygems/commands/query_command.rb b/lib/rubygems/commands/query_command.rb\n\u003cspan class=\"gh\"\u003eindex 0f58490e..7a436f76 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/commands/query_command.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/commands/query_command.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -226,7 +226,7 @@\u003c/span\u003e is too hard to use.\n         end\n       end\n\n-      output \u0026lt;\u0026lt; make_entry(matching_tuples, platforms)\n\u003cspan class=\"gi\"\u003e+      output \u0026lt;\u0026lt; clean_text(make_entry(matching_tuples, platforms))\n\u003c/span\u003e     end\n   end\n\ndiff --git a/lib/rubygems/text.rb b/lib/rubygems/text.rb\n\u003cspan class=\"gh\"\u003eindex 732f1b99..647e2cd4 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/text.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/text.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -7,12 +7,19 @@\u003c/span\u003e require \u0026#39;rubygems\u0026#39;\n module Gem::Text\n\n   ##\n\u003cspan class=\"gi\"\u003e+  # Remove any non-printable characters and make the text suitable for\n+  # printing.\n+  def clean_text(text)\n+    text.gsub(/[^\\u0020-\\u007e\\r\\n\\t]/, \u0026quot;.\u0026quot;)\n+  end\n+\n+  ##\n\u003c/span\u003e   # Wraps +text+ to +wrap+ characters and optionally indents by +indent+\n   # characters\n\n   def format_text(text, wrap, indent=0)\n     result = []\n\u003cspan class=\"gd\"\u003e-    work = text.dup\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    work = clean_text(text)\n\u003c/span\u003e\n     while work.length \u0026gt; wrap do\n       if work =~ /^(.{0,#{wrap}})[ \\n]/ then\n\u003cspan class=\"gh\"\u003ediff --git a/test/rubygems/test_gem_commands_query_command.rb b/test/rubygems/test_gem_commands_query_command.rb\nindex 84701d7c..20f4731c 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_commands_query_command.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_commands_query_command.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -128,6 +128,46 @@\u003c/span\u003e pl (1)\n     assert_equal \u0026#39;\u0026#39;, @ui.error\n   end\n\n+  def test_execute_details_cleans_text\n\u003cspan class=\"gi\"\u003e+    spec_fetcher do |fetcher|\n+      fetcher.spec \u0026#39;a\u0026#39;, 2 do |s|\n+        s.summary = \u0026#39;This is a lot of text. \u0026#39; * 4\n+        s.authors = [\u0026quot;Abraham Lincoln \\u0001\u0026quot;, \u0026quot;\\u0002 Hirohito\u0026quot;]\n+        s.homepage = \u0026quot;http://a.example.com/\\u0003\u0026quot;\n+      end\n+\n+      fetcher.legacy_platform\n+    end\n+\n+    @cmd.handle_options %w[-r -d]\n+\n+    use_ui @ui do\n+      @cmd.execute\n+    end\n+\n+    expected = \u0026lt;\u0026lt;-EOF\n+\n+*** REMOTE GEMS ***\n+\n+a (2)\n+    Authors: Abraham Lincoln ., . Hirohito\n+    Homepage: http://a.example.com/.\n+\n+    This is a lot of text. This is a lot of text. This is a lot of text.\n+    This is a lot of text.\n+\n+pl (1)\n+    Platform: i386-linux\n+    Author: A User\n+    Homepage: http://example.com\n+\n+    this is a summary\n+    EOF\n+\n+    assert_equal expected, @ui.output\n+    assert_equal \u0026#39;\u0026#39;, @ui.error\n+  end\n+\n\u003c/span\u003e   def test_execute_installed\n     @cmd.handle_options %w[-n a --installed]\n\ndiff --git a/test/rubygems/test_gem_text.rb b/test/rubygems/test_gem_text.rb\n\u003cspan class=\"gh\"\u003eindex a6e22e04..4875f37c 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_text.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_text.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -36,6 +36,10 @@\u003c/span\u003e Without the wrapping, the text might not look good in the RSS feed.\n     assert_equal expected, format_text(text, 78)\n   end\n\n+  def test_format_removes_nonprintable_characters\n\u003cspan class=\"gi\"\u003e+    assert_equal \u0026quot;text with weird .. stuff\u0026quot;, format_text(\u0026quot;text with weird \\u001b\\u0002 stuff\u0026quot;, 40)\n+  end\n+\n\u003c/span\u003e   def test_min3\n     assert_equal 1, min3(1, 1, 1)\n     assert_equal 1, min3(1, 1, 2)\n\u003cspan class=\"gd\"\u003e-- \n\u003c/span\u003e\u003cspan class=\"p\"\u003e2.11.0 (Apple Git-81)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-05-22T16:46:55.576Z","updated_at":"2017-05-22T16:46:55.576Z","actor":{"username":"evanphx","cleared":false,"url":"/evanphx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1692381,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks good! 👍🏻","markdown_message":"\u003cp\u003eLooks good! 👍🏻\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-22T17:26:07.222Z","updated_at":"2017-05-22T17:26:07.222Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1693346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a version that allows unicode characters properly by using a black list:\n\n```\nFrom 6bc7ea37b391fe4b617bcc984f600677185c396e Mon Sep 17 00:00:00 2001\nFrom: Evan Phoenix \u003cevan@phx.io\u003e\nDate: Mon, 22 May 2017 09:44:08 -0700\nSubject: [PATCH] Clean any text present in gems before displaying it\n\nThis makes sure that any data pulled out of a gem spec is cleaned of all\nnon-printable characters before printing it. This prevents a gem from\ncausing havoc with a users terminal.\n---\n lib/rubygems/commands/query_command.rb           |  2 +-\n lib/rubygems/text.rb                             |  9 +++++-\n test/rubygems/test_gem_commands_query_command.rb | 40 ++++++++++++++++++++++++\n test/rubygems/test_gem_text.rb                   |  4 +++\n 4 files changed, 53 insertions(+), 2 deletions(-)\n\ndiff --git a/lib/rubygems/commands/query_command.rb b/lib/rubygems/commands/query_command.rb\nindex 0f58490e..7a436f76 100644\n--- a/lib/rubygems/commands/query_command.rb\n+++ b/lib/rubygems/commands/query_command.rb\n@@ -226,7 +226,7 @@ is too hard to use.\n         end\n       end\n \n-      output \u003c\u003c make_entry(matching_tuples, platforms)\n+      output \u003c\u003c clean_text(make_entry(matching_tuples, platforms))\n     end\n   end\n \ndiff --git a/lib/rubygems/text.rb b/lib/rubygems/text.rb\nindex 732f1b99..edb76340 100644\n--- a/lib/rubygems/text.rb\n+++ b/lib/rubygems/text.rb\n@@ -7,12 +7,19 @@ require 'rubygems'\n module Gem::Text\n \n   ##\n+  # Remove any non-printable characters and make the text suitable for\n+  # printing.\n+  def clean_text(text)\n+    text.gsub(/[\\u0000-\\u0008\\u000b-\\u000c\\u000e-\\u001F\\u007f]/, \".\".freeze)\n+  end\n+\n+  ##\n   # Wraps +text+ to +wrap+ characters and optionally indents by +indent+\n   # characters\n \n   def format_text(text, wrap, indent=0)\n     result = []\n-    work = text.dup\n+    work = clean_text(text)\n \n     while work.length \u003e wrap do\n       if work =~ /^(.{0,#{wrap}})[ \\n]/ then\ndiff --git a/test/rubygems/test_gem_commands_query_command.rb b/test/rubygems/test_gem_commands_query_command.rb\nindex 84701d7c..20f4731c 100644\n--- a/test/rubygems/test_gem_commands_query_command.rb\n+++ b/test/rubygems/test_gem_commands_query_command.rb\n@@ -128,6 +128,46 @@ pl (1)\n     assert_equal '', @ui.error\n   end\n \n+  def test_execute_details_cleans_text\n+    spec_fetcher do |fetcher|\n+      fetcher.spec 'a', 2 do |s|\n+        s.summary = 'This is a lot of text. ' * 4\n+        s.authors = [\"Abraham Lincoln \\u0001\", \"\\u0002 Hirohito\"]\n+        s.homepage = \"http://a.example.com/\\u0003\"\n+      end\n+\n+      fetcher.legacy_platform\n+    end\n+\n+    @cmd.handle_options %w[-r -d]\n+\n+    use_ui @ui do\n+      @cmd.execute\n+    end\n+\n+    expected = \u003c\u003c-EOF\n+\n+*** REMOTE GEMS ***\n+\n+a (2)\n+    Authors: Abraham Lincoln ., . Hirohito\n+    Homepage: http://a.example.com/.\n+\n+    This is a lot of text. This is a lot of text. This is a lot of text.\n+    This is a lot of text.\n+\n+pl (1)\n+    Platform: i386-linux\n+    Author: A User\n+    Homepage: http://example.com\n+\n+    this is a summary\n+    EOF\n+\n+    assert_equal expected, @ui.output\n+    assert_equal '', @ui.error\n+  end\n+\n   def test_execute_installed\n     @cmd.handle_options %w[-n a --installed]\n \ndiff --git a/test/rubygems/test_gem_text.rb b/test/rubygems/test_gem_text.rb\nindex a6e22e04..4875f37c 100644\n--- a/test/rubygems/test_gem_text.rb\n+++ b/test/rubygems/test_gem_text.rb\n@@ -36,6 +36,10 @@ Without the wrapping, the text might not look good in the RSS feed.\n     assert_equal expected, format_text(text, 78)\n   end\n \n+  def test_format_removes_nonprintable_characters\n+    assert_equal \"text with weird .. stuff\", format_text(\"text with weird \\u001b\\u0002 stuff\", 40)\n+  end\n+\n   def test_min3\n     assert_equal 1, min3(1, 1, 1)\n     assert_equal 1, min3(1, 1, 2)\n-- \n2.11.0 (Apple Git-81)\n\n```","markdown_message":"\u003cp\u003eHere is a version that allows unicode characters properly by using a black list:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003eFrom 6bc7ea37b391fe4b617bcc984f600677185c396e Mon Sep 17 00:00:00 2001\nFrom: Evan Phoenix \u0026lt;evan@phx.io\u0026gt;\nDate: Mon, 22 May 2017 09:44:08 -0700\nSubject: [PATCH] Clean any text present in gems before displaying it\n\u003c/span\u003e\nThis makes sure that any data pulled out of a gem spec is cleaned of all\n\u003cspan class=\"p\"\u003enon-printable characters before printing it. This prevents a gem from\ncausing havoc with a users terminal.\n---\n\u003c/span\u003e lib/rubygems/commands/query_command.rb           |  2 +-\n lib/rubygems/text.rb                             |  9 +++++-\n test/rubygems/test_gem_commands_query_command.rb | 40 ++++++++++++++++++++++++\n test/rubygems/test_gem_text.rb                   |  4 +++\n 4 files changed, 53 insertions(+), 2 deletions(-)\n\ndiff --git a/lib/rubygems/commands/query_command.rb b/lib/rubygems/commands/query_command.rb\n\u003cspan class=\"gh\"\u003eindex 0f58490e..7a436f76 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/commands/query_command.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/commands/query_command.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -226,7 +226,7 @@\u003c/span\u003e is too hard to use.\n         end\n       end\n\n-      output \u0026lt;\u0026lt; make_entry(matching_tuples, platforms)\n\u003cspan class=\"gi\"\u003e+      output \u0026lt;\u0026lt; clean_text(make_entry(matching_tuples, platforms))\n\u003c/span\u003e     end\n   end\n\ndiff --git a/lib/rubygems/text.rb b/lib/rubygems/text.rb\n\u003cspan class=\"gh\"\u003eindex 732f1b99..edb76340 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/text.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/text.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -7,12 +7,19 @@\u003c/span\u003e require \u0026#39;rubygems\u0026#39;\n module Gem::Text\n\n   ##\n\u003cspan class=\"gi\"\u003e+  # Remove any non-printable characters and make the text suitable for\n+  # printing.\n+  def clean_text(text)\n+    text.gsub(/[\\u0000-\\u0008\\u000b-\\u000c\\u000e-\\u001F\\u007f]/, \u0026quot;.\u0026quot;.freeze)\n+  end\n+\n+  ##\n\u003c/span\u003e   # Wraps +text+ to +wrap+ characters and optionally indents by +indent+\n   # characters\n\n   def format_text(text, wrap, indent=0)\n     result = []\n\u003cspan class=\"gd\"\u003e-    work = text.dup\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    work = clean_text(text)\n\u003c/span\u003e\n     while work.length \u0026gt; wrap do\n       if work =~ /^(.{0,#{wrap}})[ \\n]/ then\n\u003cspan class=\"gh\"\u003ediff --git a/test/rubygems/test_gem_commands_query_command.rb b/test/rubygems/test_gem_commands_query_command.rb\nindex 84701d7c..20f4731c 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_commands_query_command.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_commands_query_command.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -128,6 +128,46 @@\u003c/span\u003e pl (1)\n     assert_equal \u0026#39;\u0026#39;, @ui.error\n   end\n\n+  def test_execute_details_cleans_text\n\u003cspan class=\"gi\"\u003e+    spec_fetcher do |fetcher|\n+      fetcher.spec \u0026#39;a\u0026#39;, 2 do |s|\n+        s.summary = \u0026#39;This is a lot of text. \u0026#39; * 4\n+        s.authors = [\u0026quot;Abraham Lincoln \\u0001\u0026quot;, \u0026quot;\\u0002 Hirohito\u0026quot;]\n+        s.homepage = \u0026quot;http://a.example.com/\\u0003\u0026quot;\n+      end\n+\n+      fetcher.legacy_platform\n+    end\n+\n+    @cmd.handle_options %w[-r -d]\n+\n+    use_ui @ui do\n+      @cmd.execute\n+    end\n+\n+    expected = \u0026lt;\u0026lt;-EOF\n+\n+*** REMOTE GEMS ***\n+\n+a (2)\n+    Authors: Abraham Lincoln ., . Hirohito\n+    Homepage: http://a.example.com/.\n+\n+    This is a lot of text. This is a lot of text. This is a lot of text.\n+    This is a lot of text.\n+\n+pl (1)\n+    Platform: i386-linux\n+    Author: A User\n+    Homepage: http://example.com\n+\n+    this is a summary\n+    EOF\n+\n+    assert_equal expected, @ui.output\n+    assert_equal \u0026#39;\u0026#39;, @ui.error\n+  end\n+\n\u003c/span\u003e   def test_execute_installed\n     @cmd.handle_options %w[-n a --installed]\n\ndiff --git a/test/rubygems/test_gem_text.rb b/test/rubygems/test_gem_text.rb\n\u003cspan class=\"gh\"\u003eindex a6e22e04..4875f37c 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_text.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_text.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -36,6 +36,10 @@\u003c/span\u003e Without the wrapping, the text might not look good in the RSS feed.\n     assert_equal expected, format_text(text, 78)\n   end\n\n+  def test_format_removes_nonprintable_characters\n\u003cspan class=\"gi\"\u003e+    assert_equal \u0026quot;text with weird .. stuff\u0026quot;, format_text(\u0026quot;text with weird \\u001b\\u0002 stuff\u0026quot;, 40)\n+  end\n+\n\u003c/span\u003e   def test_min3\n     assert_equal 1, min3(1, 1, 1)\n     assert_equal 1, min3(1, 1, 2)\n\u003cspan class=\"gd\"\u003e-- \n\u003c/span\u003e\u003cspan class=\"p\"\u003e2.11.0 (Apple Git-81)\n\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-05-22T23:00:54.908Z","updated_at":"2017-05-22T23:00:54.908Z","actor":{"username":"evanphx","cleared":false,"url":"/evanphx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1700554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Evan, thank you for the patch!  Though I'm not familiar with RubyGems source code, it looks good to me.\n\nJust curious:\n\n~~~\n+        s.summary = 'This is a lot of text. ' * 4\n~~~\n\nWhy does the test string include no control character?","markdown_message":"\u003cp\u003eEvan, thank you for the patch!  Though I\u0026#39;m not familiar with RubyGems source code, it looks good to me.\u003c/p\u003e\n\n\u003cp\u003eJust curious:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e+        s.summary = \u0026#39;This is a lot of text. \u0026#39; * 4\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhy does the test string include no control character?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-25T13:28:40.601Z","updated_at":"2017-05-25T13:28:40.601Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1702774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This patch fails on 1.8.7","markdown_message":"\u003cp\u003eThis patch fails on 1.8.7\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-26T05:11:07.086Z","updated_at":"2017-05-26T05:11:07.086Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1702788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This regexp seems to work on 1.8.7 `[\\000-\\b\\v-\\f\\016-\\037\\127]`","markdown_message":"\u003cp\u003eThis regexp seems to work on 1.8.7 \u003ccode\u003e[\\000-\\b\\v-\\f\\016-\\037\\127]\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-26T05:31:01.819Z","updated_at":"2017-05-26T05:31:01.819Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1763335,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?","markdown_message":"\u003cp\u003eAny updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-17T16:55:28.761Z","updated_at":"2017-06-17T16:55:28.761Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1779113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think you have been busy, but please don't forget this issue :-)","markdown_message":"\u003cp\u003eI think you have been busy, but please don\u0026#39;t forget this issue :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-25T02:00:41.477Z","updated_at":"2017-06-25T02:00:41.477Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1779792,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mame thank you for the reminder :) I will do some following up.","markdown_message":"\u003cp\u003e\u003ca href=\"/mame\"\u003e@mame\u003c/a\u003e thank you for the reminder :) I will do some following up.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-25T23:35:43.284Z","updated_at":"2017-06-25T23:35:43.284Z","actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1799109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No one has commented on the validity of the replacement regexp that I suggested for 1.8.7 compatibility yet","markdown_message":"\u003cp\u003eNo one has commented on the validity of the replacement regexp that I suggested for 1.8.7 compatibility yet\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T12:09:23.220Z","updated_at":"2017-07-03T12:09:23.220Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1958767,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Released in http://blog.rubygems.org/2017/08/27/2.6.13-released.html","markdown_message":"\u003cp\u003eReleased in \u003ca title=\"http://blog.rubygems.org/2017/08/27/2.6.13-released.html\" href=\"/redirect?url=http%3A%2F%2Fblog.rubygems.org%2F2017%2F08%2F27%2F2.6.13-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.rubygems.org/2017/08/27/2.6.13-released.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T02:08:43.100Z","updated_at":"2017-08-28T02:08:43.100Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mame","url":"/mame"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1960611,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T16:42:31.656Z","updated_at":"2017-08-28T16:42:31.656Z","first_to_agree":true,"actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1965298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for fixing the issue and releasing new version!  I'm okay to disclose this ticket.  What should I do?\n\nAlso, may I have any bounty? :-)","markdown_message":"\u003cp\u003eThank you for fixing the issue and releasing new version!  I\u0026#39;m okay to disclose this ticket.  What should I do?\u003c/p\u003e\n\n\u003cp\u003eAlso, may I have any bounty? :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-30T09:35:47.834Z","updated_at":"2017-08-30T09:35:47.834Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1967665,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Based on the [guidelines posted on HackerOne](https://hackerone.com/rubygems#internet-bug-bounty-qualification), this vulnerability is low severity: does not guarantee arbitrary remote code execution, but does potentially allow it. The bounty for low severity is $500. Thank you for your report!","markdown_message":"\u003cp\u003eBased on the \u003ca href=\"https://hackerone.com/rubygems#internet-bug-bounty-qualification\"\u003eguidelines posted on HackerOne\u003c/a\u003e, this vulnerability is low severity: does not guarantee arbitrary remote code execution, but does potentially allow it. The bounty for low severity is $500. Thank you for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-30T23:08:01.433Z","updated_at":"2017-08-30T23:08:01.433Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rubygems","collaborator":{"username":"mame","url":"/mame"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967693,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T23:20:03.022Z","updated_at":"2017-08-30T23:20:03.022Z","cve_ids":["CVE-2017-0899"],"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967694,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T23:20:14.751Z","updated_at":"2017-08-30T23:20:14.751Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":72215},"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967695,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Disclosing ticket as agreed by reporter.","markdown_message":"\u003cp\u003eDisclosing ticket as agreed by reporter.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-30T23:20:55.013Z","updated_at":"2017-08-30T23:20:55.013Z","actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1969954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much!","markdown_message":"\u003cp\u003eThank you very much!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T23:15:08.618Z","updated_at":"2017-08-31T23:15:08.618Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}