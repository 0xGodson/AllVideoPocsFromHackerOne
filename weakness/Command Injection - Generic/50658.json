{"id":50658,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDY1OA==","url":"https://hackerone.com/reports/50658","title":"Reflected File Download attack allows attacker to 'upload' executables to hackerone.com domain","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-09T10:20:23.347Z","submitted_at":"2015-03-09T10:20:23.347Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rickypaipie","url":"/rickypaipie","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-16T10:21:21.121Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-03-17T10:21:15.569Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi hackerone team,\r\n\r\nI'm a friend of Peiying and am looking for a position at hackerone. While playing around with your product, I found a serious vulnerability in your application: it allows attackers to craft executables on the hackerone.com domain rather than the sandboxed one on S3.\r\n\r\n1. attacker reports a bug titled `hackerone\\\"||calc||`\r\n2. attacker can then direct victim to [https://hackerone.com/notifications.bat](https://hackerone.com/notifications.bat)\r\n3. when downloaded and executed, it will open calculator on victim's windows environment\r\n\r\nThe potentials of this vector is outlined in [Reflected File Download: A New Web Attack Vector](https://www.trustwave.com/Resources/SpiderLabs-Blog/Reflected-File-Download---A-New-Web-Attack-Vector/), which does not limit to executing commands on victim's machines.\r\n\r\nTo fix, since hackerone is a Rails deployment, at the rendering step of the notifications action:\r\n\r\ninstead of:\r\n\r\n`render json: notifications`\r\n\r\ndo:\r\n\r\n    respond_to do |format|\r\n        format.json do\r\n            render json: notifications\r\n        end\r\n    end\r\n\r\nso requests of non-json formats would return a 406 Not Acceptable. see [respond_to](http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to).\r\n\r\nLook forward to hearing back from you soon,\r\n\r\nRicky","vulnerability_information_html":"\u003cp\u003eHi hackerone team,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m a friend of Peiying and am looking for a position at hackerone. While playing around with your product, I found a serious vulnerability in your application: it allows attackers to craft executables on the hackerone.com domain rather than the sandboxed one on S3.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eattacker reports a bug titled \u003ccode\u003ehackerone\\\u0026quot;||calc||\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eattacker can then direct victim to \u003ca href=\"https://hackerone.com/notifications.bat\"\u003ehttps://hackerone.com/notifications.bat\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ewhen downloaded and executed, it will open calculator on victim\u0026#39;s windows environment\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe potentials of this vector is outlined in \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.trustwave.com%2FResources%2FSpiderLabs-Blog%2FReflected-File-Download---A-New-Web-Attack-Vector%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eReflected File Download: A New Web Attack Vector\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which does not limit to executing commands on victim\u0026#39;s machines.\u003c/p\u003e\n\n\u003cp\u003eTo fix, since hackerone is a Rails deployment, at the rendering step of the notifications action:\u003c/p\u003e\n\n\u003cp\u003einstead of:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003erender json: notifications\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003edo:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erespond_to do |format|\n    format.json do\n        render json: notifications\n    end\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eso requests of non-json formats would return a 406 Not Acceptable. see \u003ca href=\"/redirect?url=http%3A%2F%2Fapidock.com%2Frails%2FActionController%2FMimeResponds%2FInstanceMethods%2Frespond_to\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erespond_to\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eLook forward to hearing back from you soon,\u003c/p\u003e\n\n\u003cp\u003eRicky\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":31223,"file_name":"rfd.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/031/223/c0e8ad2bb3d94f1ae1051e18281df5ff1d2709c3/rfd.jpg?response-content-disposition=attachment%3B%20filename%3D%22rfd.jpg%22%3B%20filename%2A%3DUTF-8%27%27rfd.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061112Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=bdd890ac1de10d8a064ebb22de87c2e0a7661265881e0922faf25088c2e327d1","file_size":153754,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2015-04-16T10:21:16.599Z","allow_singular_disclosure_after":-180042596.05944628,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":348940,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @rickypaipie, we're looking into this.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/rickypaipie\"\u003e@rickypaipie\u003c/a\u003e, we\u0026#39;re looking into this.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-09T10:26:47.119Z","updated_at":"2015-03-09T10:26:47.119Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348943,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks, for your ~~application~~ report. We will investigate this issue.","markdown_message":"\u003cp\u003eThanks, for your \u003cdel\u003eapplication\u003c/del\u003e report. We will investigate this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-09T10:27:22.303Z","updated_at":"2015-03-09T10:27:22.303Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":348947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"wow fast response. I hope I didn't wake you two up!","markdown_message":"\u003cp\u003ewow fast response. I hope I didn\u0026#39;t wake you two up!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-09T10:34:41.428Z","updated_at":"2015-03-09T10:34:41.428Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`Time Zone: Europe/Amsterdam`","markdown_message":"\u003cp\u003e\u003ccode\u003eTime Zone: Europe/Amsterdam\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-09T10:42:51.802Z","updated_at":"2015-03-09T10:42:51.802Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":351180,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've recently pushed a fix to production that should solve this behavior. Could you please verify that the behavior you described is changed for this endpoint?","markdown_message":"\u003cp\u003eWe\u0026#39;ve recently pushed a fix to production that should solve this behavior. Could you please verify that the behavior you described is changed for this endpoint?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-11T15:39:17.326Z","updated_at":"2015-03-11T15:39:17.326Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rickypaipie","url":"/rickypaipie"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It returns a 406 now with a .bat extension. This should prevent future RFD attacks","markdown_message":"\u003cp\u003eIt returns a 406 now with a .bat extension. This should prevent future RFD attacks\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-13T16:00:00.500Z","updated_at":"2015-03-13T16:00:00.500Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":356650,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-17T10:21:05.255Z","updated_at":"2015-03-17T10:21:05.255Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":356651,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-17T10:21:15.607Z","updated_at":"2015-03-17T10:21:15.607Z","first_to_agree":true,"actor":{"username":"mvgijssel","cleared":false,"url":"/mvgijssel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/630/800fef8d03ef6911255da0e4bad8b7a4eee5d6da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":357195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rickypaipie Thanks again for your report and verifying the fix. We just wanted to follow-up that this isn't consider a viable security issue due to both the high barrier to entry (\"To affect a user, he/she must be in a team with the attacker\") and who our customers and clients are, so this won't be eligible for a bounty (only hall of fame).","markdown_message":"\u003cp\u003e\u003ca href=\"/rickypaipie\"\u003e@rickypaipie\u003c/a\u003e Thanks again for your report and verifying the fix. We just wanted to follow-up that this isn\u0026#39;t consider a viable security issue due to both the high barrier to entry (\u0026quot;To affect a user, he/she must be in a team with the attacker\u0026quot;) and who our customers and clients are, so this won\u0026#39;t be eligible for a bounty (only hall of fame).\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-17T22:28:49.694Z","updated_at":"2015-03-17T22:28:49.694Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":359833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem. For a clarification. When an external party reports a new bug, does a notification item gets added? I couldn't test this scenario because I didn't have a live bounty program to test. That said, as soon as the bug was created, any activity including comments from other team members, would trigger the notification being generated and hence the payload being active. This would have allowed attackers to target any users who is part of an active bounty program.","markdown_message":"\u003cp\u003eNo problem. For a clarification. When an external party reports a new bug, does a notification item gets added? I couldn\u0026#39;t test this scenario because I didn\u0026#39;t have a live bounty program to test. That said, as soon as the bug was created, any activity including comments from other team members, would trigger the notification being generated and hence the payload being active. This would have allowed attackers to target any users who is part of an active bounty program.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-21T03:31:43.181Z","updated_at":"2015-03-21T03:31:43.181Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":381762,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-16T10:21:21.266Z","updated_at":"2015-04-16T10:21:21.266Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delayed response! Yes, you are correct that a bug report does generate a notification. An attacker could target a bounty program, but given that they still have to download and run the bat file this is still a high barrier issue.\n\nHappy hacking!","markdown_message":"\u003cp\u003eSorry for the delayed response! Yes, you are correct that a bug report does generate a notification. An attacker could target a bounty program, but given that they still have to download and run the bat file this is still a high barrier issue.\u003c/p\u003e\n\n\u003cp\u003eHappy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T18:58:14.024Z","updated_at":"2015-04-16T18:58:14.024Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}