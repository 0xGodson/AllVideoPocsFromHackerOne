{"id":291057,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTEwNTc=","url":"https://hackerone.com/reports/291057","title":"MySQL username and password leaked in developer.valvesoftware.com via source code dislosure","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-11-17T02:02:14.122Z","submitted_at":"2017-11-17T02:02:14.122Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nahamsec","url":"/nahamsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-07T21:26:56.816Z","bug_reporter_agreed_on_going_public_at":"2018-05-07T21:10:11.225Z","team_member_agreed_on_going_public_at":"2018-05-07T21:26:56.738Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey there it looks like you are relying on a script that cleans up your backup process on developer.valvesoftware.com:\n\n`/scripts/final_cleanup.sh`:\n\n```\n# Remove files post cleanup\nrm -r ${SITEPATH}/data\nrm ${SITEPATH}/*.sql\nrm ${SITEPATH}/*.sql.gz\nrm ${SITEPATH}/*.tgz\nrm ${SITEPATH}/*.tar.gz\nrm ${SITEPATH}/*.log\nrm -r ${SITEPATH}/w_${OLD_VER}\nrm ${SITEPATH}/*.sh\n```\n\nBut they forgot about `/scripts/`itself where it's also allowing a directory listing to see it contents. \n\nhttps://developer.valvesoftware.com/scripts/:\n\n```\n[TXT]\tcontent_fixes.sh\t2009-01-15 23:19\t2.3K\t \n[TXT]\tcreate_current_xml_dump.sh\t2009-01-14 04:08\t775\t \n[TXT]\tcustom_settings.sh\t2009-01-16 09:48\t1.1K\t \n[TXT]\tdatabase_drop_all_tables.sh\t2009-01-16 03:35\t355\t \n[TXT]\tdatabase_export_dump.sh\t2009-06-10 21:55\t353\t \n[TXT]\tdatabase_export_latin1_gz_dump.sh\t2009-06-10 23:36\t363\t \n[TXT]\tdatabase_import_dump.sh\t2009-06-11 00:19\t267\t \n[   ]\tdatabase_rebuildrecentchanges.php\t2009-06-17 21:46\t374\t \n[TXT]\tdatabase_set_priv.sh\t2009-06-11 20:28\t665\t \n[TXT]\tdatabase_test_backup.sh\t2009-06-10 21:44\t741\t \n[TXT]\tdatabase_test_export.sh\t2009-01-16 03:35\t362\t \n[TXT]\tdatabase_test_import.sh\t2009-01-16 03:36\t293\t \n[TXT]\tfilesystem_copy_new_version.sh\t2009-06-18 19:38\t1.0K\t \n[TXT]\tfilesystem_create_backup.sh\t2009-06-10 21:40\t473\t \n[TXT]\tfilesystem_restore_backup.sh\t2009-06-10 22:34\t1.1K\t \n[TXT]\tfinal_cleanup.sh\t2009-01-13 00:52\t665\t \n[TXT]\timport_temp.sh\t2009-06-11 00:17\t4.8K\t \n[TXT]\timport_wiki.sh\t2009-06-11 20:19\t5.0K\t \n[TXT]\tinterwiki_update.sh\t2009-01-12 03:08\t1.2K\t \n[TXT]\tupdate_wiki.sh\t2009-06-18 19:43\t2.0K\t \n[TXT]\twiki_setup.sh\t2011-04-29 01:19\t1.7K\t \n```\n\nFrom `scripts/wiki_setup.sh`:\n\n```\n# mysql\nDBUSER='█████████'\t\t\t# SQL user to do the work\nDBPASS='██████████'\t\t# Password for the SQL user\nHOSTNAME='██████████'\t\t# Name of the SQL database host\nWIKIDB='███'\t\t\t# When making backups, export this database name, like ██████████\nWIKIDBSRC='████████'\t\t# When restoring backups from another wiki, use this database, like ██████████\nWIKIUSER='████████'\t\t# Name of the wiki db user specified in LocalSettings.php\nWIKIPASS='██████████'\t# Wiki db user password\n```\n\nThanks,\nBen","vulnerability_information_html":"\u003cp\u003eHey there it looks like you are relying on a script that cleans up your backup process on developer.valvesoftware.com:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e/scripts/final_cleanup.sh\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# Remove files post cleanup\nrm -r ${SITEPATH}/data\nrm ${SITEPATH}/*.sql\nrm ${SITEPATH}/*.sql.gz\nrm ${SITEPATH}/*.tgz\nrm ${SITEPATH}/*.tar.gz\nrm ${SITEPATH}/*.log\nrm -r ${SITEPATH}/w_${OLD_VER}\nrm ${SITEPATH}/*.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut they forgot about \u003ccode\u003e/scripts/\u003c/code\u003eitself where it\u0026#39;s also allowing a directory listing to see it contents. \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://developer.valvesoftware.com/scripts/:\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.valvesoftware.com%2Fscripts%2F%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.valvesoftware.com/scripts/:\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[TXT]   content_fixes.sh    2009-01-15 23:19    2.3K     \n[TXT]   create_current_xml_dump.sh  2009-01-14 04:08    775  \n[TXT]   custom_settings.sh  2009-01-16 09:48    1.1K     \n[TXT]   database_drop_all_tables.sh 2009-01-16 03:35    355  \n[TXT]   database_export_dump.sh 2009-06-10 21:55    353  \n[TXT]   database_export_latin1_gz_dump.sh   2009-06-10 23:36    363  \n[TXT]   database_import_dump.sh 2009-06-11 00:19    267  \n[   ]   database_rebuildrecentchanges.php   2009-06-17 21:46    374  \n[TXT]   database_set_priv.sh    2009-06-11 20:28    665  \n[TXT]   database_test_backup.sh 2009-06-10 21:44    741  \n[TXT]   database_test_export.sh 2009-01-16 03:35    362  \n[TXT]   database_test_import.sh 2009-01-16 03:36    293  \n[TXT]   filesystem_copy_new_version.sh  2009-06-18 19:38    1.0K     \n[TXT]   filesystem_create_backup.sh 2009-06-10 21:40    473  \n[TXT]   filesystem_restore_backup.sh    2009-06-10 22:34    1.1K     \n[TXT]   final_cleanup.sh    2009-01-13 00:52    665  \n[TXT]   import_temp.sh  2009-06-11 00:17    4.8K     \n[TXT]   import_wiki.sh  2009-06-11 20:19    5.0K     \n[TXT]   interwiki_update.sh 2009-01-12 03:08    1.2K     \n[TXT]   update_wiki.sh  2009-06-18 19:43    2.0K     \n[TXT]   wiki_setup.sh   2011-04-29 01:19    1.7K     \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFrom \u003ccode\u003escripts/wiki_setup.sh\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# mysql\nDBUSER=\u0026#39;█████████\u0026#39;            # SQL user to do the work\nDBPASS=\u0026#39;██████████\u0026#39;     # Password for the SQL user\nHOSTNAME=\u0026#39;██████████\u0026#39;       # Name of the SQL database host\nWIKIDB=\u0026#39;███\u0026#39;          # When making backups, export this database name, like ██████████\nWIKIDBSRC=\u0026#39;████████\u0026#39;        # When restoring backups from another wiki, use this database, like ██████████\nWIKIUSER=\u0026#39;████████\u0026#39;     # Name of the wiki db user specified in LocalSettings.php\nWIKIPASS=\u0026#39;██████████\u0026#39;   # Wiki db user password\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks,\u003cbr\u003e\nBen\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":24,"name":"Password in Configuration File"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":91,"voters":["njbooher","sp1d3rs","europa","mvc","mszustak","mashoud1122","muon4","ramsexy","bogdantcaciuc","spam404","and 81 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2165807,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T17:22:32.672Z","updated_at":"2017-11-17T17:22:32.672Z","actor":{"username":"alfredr","cleared":false,"url":"/alfredr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @nahamsec,\n\nThank you for your efforts! We have filed a bug internally and are working on fixing this issue. \nWe will let you know as soon as we have any updates.\n\nThanks,\n@dukefleed","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your efforts! We have filed a bug internally and are working on fixing this issue. \u003cbr\u003e\nWe will let you know as soon as we have any updates.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\n\u003ca href=\"/dukefleed\"\u003e@dukefleed\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T17:29:15.995Z","updated_at":"2017-11-17T17:29:15.995Z","actor":{"username":"dukefleed","cleared":false,"url":"/dukefleed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/358/4957a9bf08fe3fed492a5def8b2afd61e032c96f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165910,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, fixed deployed. I've protected the scripts directory, disabled indexes, and changed the database password. @nahamsec, can you confirm the issue is resolved? Thanks.","markdown_message":"\u003cp\u003eOkay, fixed deployed. I\u0026#39;ve protected the scripts directory, disabled indexes, and changed the database password. \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, can you confirm the issue is resolved? Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T17:57:49.311Z","updated_at":"2017-11-17T17:57:49.311Z","actor":{"username":"gvengel","cleared":false,"url":"/gvengel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/199/826/35e49ceb67ff71e42ffd6e76893001380912ff98_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2165952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@gvengel - Yep! Looks good.","markdown_message":"\u003cp\u003e\u003ca href=\"/gvengel\"\u003e@gvengel\u003c/a\u003e - Yep! Looks good.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T18:10:25.319Z","updated_at":"2017-11-17T18:10:25.319Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165956,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T18:11:01.688Z","updated_at":"2017-11-17T18:11:01.688Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Valve"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"nahamsec","url":"/nahamsec"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165957,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report, we have deployed a fix for the issue.","markdown_message":"\u003cp\u003eThanks for the report, we have deployed a fix for the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-17T18:11:19.625Z","updated_at":"2017-11-17T18:11:19.625Z","actor":{"username":"alfredr","cleared":false,"url":"/alfredr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nahamsec","url":"/nahamsec"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2710644,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-07T21:10:11.252Z","updated_at":"2018-05-07T21:10:11.252Z","first_to_agree":true,"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2710687,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-07T21:26:56.765Z","updated_at":"2018-05-07T21:26:56.765Z","actor":{"username":"alfredr","cleared":false,"url":"/alfredr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2710688,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-07T21:26:56.844Z","updated_at":"2018-05-07T21:26:56.844Z","actor":{"username":"alfredr","cleared":false,"url":"/alfredr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}