{"id":604120,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MDQxMjA=","url":"https://hackerone.com/reports/604120","title":"Chaining Bugs: Leakage of CSRF token which leads to Stored XSS and Account Takeover (xs1.tribalwars.cash)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-06-08T14:50:16.291Z","submitted_at":"2019-06-08T14:50:16.291Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"batee5a","url":"/batee5a","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":36247,"url":"https://hackerone.com/innogames","handle":"innogames","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"InnoGames","twitter_handle":"","website":"https://www.innogames.com","about":"With around 150 million registered players, InnoGames is one of the worldwide leading developers and publishers of online games. "}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-18T06:29:13.911Z","bug_reporter_agreed_on_going_public_at":"2020-05-14T21:38:04.068Z","team_member_agreed_on_going_public_at":"2020-05-18T06:29:13.821Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1100.0","formatted_bounty":"$1,100","weakness":{"id":101,"name":"Insecure Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":182,"voters":["skr0x1c0","megaknight","kekkegenkai","hackerontwowheels","mygf","0xxl","aeswagyewgyes","minometidji","mainteemoforfun","co0nan","and 172 more..."],"severity":{"rating":"high","score":7.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":22810,"asset_type":"URL","asset_identifier":"xs1.tribalwars.cash","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5032411,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-08T15:02:09.455Z","updated_at":"2019-06-08T15:02:09.455Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5032447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-08T15:19:17.862Z","updated_at":"2019-06-08T15:19:17.862Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5041808,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-10T14:54:31.916Z","updated_at":"2019-06-10T14:54:31.916Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5048700,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-11T12:44:45.052Z","updated_at":"2019-06-11T12:44:45.052Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5048913,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-11T13:23:02.187Z","updated_at":"2019-06-11T13:23:02.187Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5064056,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T09:43:53.754Z","updated_at":"2019-06-12T09:43:53.754Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5064812,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T11:40:40.805Z","updated_at":"2019-06-12T11:40:40.805Z","additional_data":{},"actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5064826,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T11:42:32.955Z","updated_at":"2019-06-12T11:42:32.955Z","additional_data":{},"actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5064831,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T11:43:25.003Z","updated_at":"2019-06-12T11:43:25.003Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5065331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T12:37:24.045Z","updated_at":"2019-06-12T12:37:24.045Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5092845,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-14T10:13:47.496Z","updated_at":"2019-06-14T10:13:47.496Z","additional_data":{},"actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5093240,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-14T11:07:28.823Z","updated_at":"2019-06-14T11:07:28.823Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5093241,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-14T11:08:03.164Z","updated_at":"2019-06-14T11:08:03.164Z","actor":{"url":"/innogames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"InnoGames"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"innogames","collaborator":{"username":"batee5a","url":"/batee5a"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5147414,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-20T16:00:38.208Z","updated_at":"2019-06-20T16:00:38.208Z","actor":{"url":"/innogames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"InnoGames"}},"reporter":{"username":"batee5a","url":"/batee5a"},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5149578,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-20T18:02:36.040Z","updated_at":"2019-06-20T18:02:36.040Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5155245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-21T07:53:21.156Z","updated_at":"2019-06-21T07:53:21.156Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5157065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-21T09:37:00.250Z","updated_at":"2019-06-21T09:37:00.250Z","actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5196852,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-26T07:34:18.085Z","updated_at":"2019-06-26T07:34:18.085Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"batee5a","url":"/batee5a"},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8004652,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T21:38:04.102Z","updated_at":"2020-05-14T21:38:04.102Z","first_to_agree":true,"actor":{"username":"batee5a","cleared":true,"url":"/batee5a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/739/f0fb0cc19968e72cb36ea439b4a874bc2fcf012f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8030485,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T06:29:13.840Z","updated_at":"2020-05-18T06:29:13.840Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8030486,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T06:29:13.933Z","updated_at":"2020-05-18T06:29:13.933Z","actor":{"username":"inno_kevin","cleared":false,"url":"/inno_kevin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21744,"category":"team","content":"The referrer leaked the CSRF code, when opening an embedded PHP file set by the images function in tribe forums. \nDue to a premium function, which allows players to store and run Javascript scripts during the game, the session ID could be grabbed, as it was mistakenly embedded into the DOM. \n\nThis could have lead to an account takeover.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe referrer leaked the CSRF code, when opening an embedded PHP file set by the images function in tribe forums. \u003cbr\u003e\nDue to a premium function, which allows players to store and run Javascript scripts during the game, the session ID could be grabbed, as it was mistakenly embedded into the DOM. \u003c/p\u003e\n\n\u003cp\u003eThis could have lead to an account takeover.\u003c/p\u003e\n"},{"id":21692,"category":"researcher","content":"### Summary:\nThere is a forum that is used in-game for guild members to communicate with each other in ease, inputting a url of a php file instead of an image file allows the attacker to fetch the referrer header of other players. This was the first issue as the player CSRF token was exposed in the URL. \n\nAnother part of the game is quick links which makes it easier for the player to navigate through the game interface, this is vulnerable to self-XSS. Using the leaked CSRF token, an attacker can place a malicious script to be automatically executed. But the session cookie is HTTPOnly, so how do we get it?\n\nLuckily for us, the SID was exposed in a tag in the HTML body of any page, so an XSS can easily fetch it for us from the DOM, resulting in Session Hijacking and account takeover.","can_view?":true,"can_edit?":false,"content_html":"\u003ch3 id=\"summary\"\u003eSummary:\u003c/h3\u003e\n\n\u003cp\u003eThere is a forum that is used in-game for guild members to communicate with each other in ease, inputting a url of a php file instead of an image file allows the attacker to fetch the referrer header of other players. This was the first issue as the player CSRF token was exposed in the URL. \u003c/p\u003e\n\n\u003cp\u003eAnother part of the game is quick links which makes it easier for the player to navigate through the game interface, this is vulnerable to self-XSS. Using the leaked CSRF token, an attacker can place a malicious script to be automatically executed. But the session cookie is HTTPOnly, so how do we get it?\u003c/p\u003e\n\n\u003cp\u003eLuckily for us, the SID was exposed in a tag in the HTML body of any page, so an XSS can easily fetch it for us from the DOM, resulting in Session Hijacking and account takeover.\u003c/p\u003e\n"}]}