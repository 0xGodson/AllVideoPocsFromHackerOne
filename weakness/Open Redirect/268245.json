{"id":268245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjgyNDU=","url":"https://hackerone.com/reports/268245","title":"XSS in biz.mail.ru/error","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-14T07:00:55.053Z","submitted_at":"2017-09-14T07:00:55.053Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chaosbolt","url":"/chaosbolt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-09T12:23:01.934Z","bug_reporter_agreed_on_going_public_at":"2017-10-04T15:15:19.771Z","team_member_agreed_on_going_public_at":"2017-10-09T12:23:01.880Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again! I've found an open redirect issue and possibility to bypass your filters to add direct links in \u003ca href=\"#user input\"\u003e tag\n\nDomain, site, application: biz.mail.ru/error\n\nTesting environment: latest Chrome\n\nSteps to reproduce:\n1) go to https://biz.mail.ru/error/500/?from=%20https://www.google.com\n2) click Refresh\n\nActual results: you will be redirected to google. And as always, there might be different website that will steal user login credentials or run scripts\n\nExpected results, security impact description and recommendations: redirects are not allowed\n\nPoC, exploit code, screenshots, video, references, additional resources\n\nAs i said, go to https://biz.mail.ru/error/500/?from=%20https://www.google.com and click Refresh\n\n","vulnerability_information_html":"\u003cp\u003eHello again! I\u0026#39;ve found an open redirect issue and possibility to bypass your filters to add direct links in \u0026lt;a href=\u0026quot;#user input\u0026quot;\u0026gt; tag\u003c/p\u003e\n\n\u003cp\u003eDomain, site, application: biz.mail.ru/error\u003c/p\u003e\n\n\u003cp\u003eTesting environment: latest Chrome\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\n1) go to \u003ca title=\"https://biz.mail.ru/error/500/?from=%20https://www.google.com\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2Ferror%2F500%2F%3Ffrom%3D%2520https%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/error/500/?from=%20https://www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) click Refresh\u003c/p\u003e\n\n\u003cp\u003eActual results: you will be redirected to google. And as always, there might be different website that will steal user login credentials or run scripts\u003c/p\u003e\n\n\u003cp\u003eExpected results, security impact description and recommendations: redirects are not allowed\u003c/p\u003e\n\n\u003cp\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/p\u003e\n\n\u003cp\u003eAs i said, go to \u003ca title=\"https://biz.mail.ru/error/500/?from=%20https://www.google.com\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2Ferror%2F500%2F%3Ffrom%3D%2520https%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/error/500/?from=%20https://www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and click Refresh\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-03T15:15:19.872Z","allow_singular_disclosure_after":-99496960.2593049,"singular_disclosure_allowed":true,"vote_count":32,"voters":["jokebookservice1","jensec","danila","bogdantcaciuc","s_p_q_r","emitrani","003random","0x01alka","michan","eveeez","and 22 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":250,"asset_type":"URL","asset_identifier":"biz.mail.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1996115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"let me explain the problem:\nAt first i got this 500 external error link (at first it looked like \"biz.mail.ru/error/500/?from=https://biz.mail.ru/\") and parameter ?from seemed dangerous to me, so i looked deeper into page. after quick research i found our that ?from is using in \"\u003ca href=\"?from\" class=\"btn\"\u003ebutton\u003c/a\u003e\" element so i started to add payloads. Simple ?from=https://www.google.com didn't work due to sanitize, so i found a way to avoid it - if we add nullbyte before our malicious link (%00https://www.google.com) and press button to refresh, we will be redirected to that address, but %00 can not be converted by url and we get 404 error inside mail.ru, so i decided to add %20 before malicious link and it worked out.","markdown_message":"\u003cp\u003elet me explain the problem:\u003cbr\u003e\nAt first i got this 500 external error link (at first it looked like \u0026quot;biz.mail.ru/error/500/?from=\u003ca title=\"https://biz.mail.ru/%22\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2F%2522\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/%22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and parameter ?from seemed dangerous to me, so i looked deeper into page. after quick research i found our that ?from is using in \u0026quot;\u0026lt;a href=\u0026quot;?from\u0026quot; class=\u0026quot;btn\u0026quot;\u0026gt;button\u0026lt;/a\u0026gt;\u0026quot; element so i started to add payloads. Simple ?from=\u003ca title=\"https://www.google.com\" href=\"/redirect?url=https%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e didn\u0026#39;t work due to sanitize, so i found a way to avoid it - if we add nullbyte before our malicious link (%00\u003ca title=\"https://www.google.com\" href=\"/redirect?url=https%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and press button to refresh, we will be redirected to that address, but %00 can not be converted by url and we get 404 error inside mail.ru, so i decided to add %20 before malicious link and it worked out.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T07:06:43.504Z","updated_at":"2017-09-14T07:20:33.689Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1996143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This also leads to dangerous XSS: https://biz.mail.ru/error/500/?from=%20javascript:alert() after you click Refresh it will be executed as javascript . Additional info: %09 in ?from= before payload also works.\ninteresting payloads that are working out too:\nhttps://biz.mail.ru/error/500/?from=javascript:javascript:alert(1)\nhttps://biz.mail.ru/error/500/?from=https://www.google.comhttps://www.google.com","markdown_message":"\u003cp\u003eThis also leads to dangerous XSS: \u003ca title=\"https://biz.mail.ru/error/500/?from=%20javascript:alert()\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2Ferror%2F500%2F%3Ffrom%3D%2520javascript%3Aalert%28%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/error/500/?from=%20javascript:alert()\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e after you click Refresh it will be executed as javascript . Additional info: %09 in ?from= before payload also works.\u003cbr\u003e\ninteresting payloads that are working out too:\u003cbr\u003e\n\u003ca title=\"https://biz.mail.ru/error/500/?from=javascript:javascript:alert(1)\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2Ferror%2F500%2F%3Ffrom%3Djavascript%3Ajavascript%3Aalert%281%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/error/500/?from=javascript:javascript:alert(1)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://biz.mail.ru/error/500/?from=https://www.google.comhttps://www.google.com\" href=\"/redirect?url=https%3A%2F%2Fbiz.mail.ru%2Ferror%2F500%2F%3Ffrom%3Dhttps%3A%2F%2Fwww.google.comhttps%3A%2F%2Fwww.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://biz.mail.ru/error/500/?from=https://www.google.comhttps://www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T07:26:15.088Z","updated_at":"2017-09-14T07:38:51.049Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1996273,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T09:17:07.288Z","updated_at":"2017-09-14T09:17:07.288Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1996434,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-14T11:28:54.044Z","updated_at":"2018-02-28T13:11:24.020Z","additional_data":{"added_weaknesses":[{"id":63,"name":"Cross-site Scripting (XSS) - DOM"}],"removed_weaknesses":[{"id":53,"name":"Open Redirect"}]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2008450,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T12:19:16.304Z","updated_at":"2017-09-20T12:19:16.304Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"chaosbolt","url":"/chaosbolt"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2008461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thank you for the bounty!","markdown_message":"\u003cp\u003ethank you for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T12:24:15.577Z","updated_at":"2017-09-20T12:24:15.577Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2009252,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-20T16:03:43.274Z","updated_at":"2017-09-20T16:03:43.274Z","additional_data":{"old_title":"Open redirect at biz.mail.ru/error","new_title":"XSS in biz.mail.ru/error"},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2043404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","markdown_message":"\u003cp\u003eThis bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-04T14:31:53.082Z","updated_at":"2017-10-04T14:31:53.082Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chaosbolt","url":"/chaosbolt"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2043526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, seems cool","markdown_message":"\u003cp\u003eYes, seems cool\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-04T15:14:44.844Z","updated_at":"2017-10-04T15:14:44.844Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2043531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"may we disclose that one?","markdown_message":"\u003cp\u003emay we disclose that one?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-04T15:15:19.815Z","updated_at":"2017-10-04T15:15:19.815Z","first_to_agree":true,"actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2053221,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-09T12:23:01.905Z","updated_at":"2017-10-09T12:23:01.905Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2053222,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-09T12:23:01.955Z","updated_at":"2017-10-09T12:23:01.955Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":6250,"category":"researcher","content":"XSS via invocking javascript in \u003ca\u003e tag ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eXSS via invocking javascript in \u0026lt;a\u0026gt; tag \u003c/p\u003e\n"}]}