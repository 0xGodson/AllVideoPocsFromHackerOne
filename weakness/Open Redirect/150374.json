{"id":150374,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTAzNzQ=","url":"https://hackerone.com/reports/150374","title":"https://windsor.shopify.com/ takeover","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-10T16:32:35.797Z","submitted_at":"2016-07-10T16:32:35.797Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zseano","url":"/zseano","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/p5Ap5pB7ykW79dUP5kMSkP4j/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-18T23:36:07.183Z","bug_reporter_agreed_on_going_public_at":"2016-07-18T23:36:06.989Z","team_member_agreed_on_going_public_at":"2016-07-18T23:31:23.425Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Shopify,\n\nSo I was doing some scanning for another client and saw a ton of *.shopify.com appear and thought to myself \"Huh? I thought shopify.com hosted shops on myshopify.com.. weird, lets check this out\".\n\nAn example is this: http://khanbot.shopify.com/password - as you can see it's a store opening soon, but it's on *.shopify.com. However when I try my own store: http://imjusttesting8.shopify.com/password then it will give me the generic, \"Did you mean etc etc\". Very weird. I tried looking around and playing as much as possible, but I wasn't unable to actually get a *.shopify.com url. (If this is actually possible could you let me know how?)\n\nI found these via this BTW: https://crt.sh/?q=%25.shopify.com (there's quite a few more).\n\nOne that caught my eye was windsor.shopify.com. It's set to auto redirect to another domain (aislingofwindsor.com) which had actually expired. I purchased it and now when you visit windsor.shopify.com your redirected to a site I control. (yay for owning a shopify.com sub domain)\n\nPoC: https://windsor.shopify.com/ (can even use https to make it even more 'trustworthy')\n\nAn attack idea would be saying to users \"New product released by shopify! Increase your sales by using Windsor. Read more: https://windsor.shopify.com\" (users will see shopify.com and trust. Plus the fact it's a cool name like 'Windsor', may get users attention). \n\nWe could then in theory create a domain similar to shopify and redirect aislingofwindsor.com straight to another domain. Add all the HTTPS stuff to make it look even more real, and we have a pretty good attack surface!\n\nNote: I've done a lot of internal phishing for clients and had a 100% success rate every time, hence why i'm reporting this as I feel this url could be used to easily phish users.\n","vulnerability_information_html":"\u003cp\u003eHi Shopify,\u003c/p\u003e\n\n\u003cp\u003eSo I was doing some scanning for another client and saw a ton of *.shopify.com appear and thought to myself \u0026quot;Huh? I thought shopify.com hosted shops on myshopify.com.. weird, lets check this out\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eAn example is this: \u003ca title=\"http://khanbot.shopify.com/password\" href=\"/redirect?url=http%3A%2F%2Fkhanbot.shopify.com%2Fpassword\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://khanbot.shopify.com/password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - as you can see it\u0026#39;s a store opening soon, but it\u0026#39;s on *.shopify.com. However when I try my own store: \u003ca title=\"http://imjusttesting8.shopify.com/password\" href=\"/redirect?url=http%3A%2F%2Fimjusttesting8.shopify.com%2Fpassword\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://imjusttesting8.shopify.com/password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e then it will give me the generic, \u0026quot;Did you mean etc etc\u0026quot;. Very weird. I tried looking around and playing as much as possible, but I wasn\u0026#39;t unable to actually get a *.shopify.com url. (If this is actually possible could you let me know how?)\u003c/p\u003e\n\n\u003cp\u003eI found these via this BTW: \u003ca title=\"https://crt.sh/?q=%25.shopify.com\" href=\"/redirect?url=https%3A%2F%2Fcrt.sh%2F%3Fq%3D%2525.shopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://crt.sh/?q=%25.shopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (there\u0026#39;s quite a few more).\u003c/p\u003e\n\n\u003cp\u003eOne that caught my eye was windsor.shopify.com. It\u0026#39;s set to auto redirect to another domain (aislingofwindsor.com) which had actually expired. I purchased it and now when you visit windsor.shopify.com your redirected to a site I control. (yay for owning a shopify.com sub domain)\u003c/p\u003e\n\n\u003cp\u003ePoC: \u003ca title=\"https://windsor.shopify.com/\" href=\"/redirect?url=https%3A%2F%2Fwindsor.shopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://windsor.shopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (can even use https to make it even more \u0026#39;trustworthy\u0026#39;)\u003c/p\u003e\n\n\u003cp\u003eAn attack idea would be saying to users \u0026quot;New product released by shopify! Increase your sales by using Windsor. Read more: \u003ca title=\"https://windsor.shopify.com\" href=\"/redirect?url=https%3A%2F%2Fwindsor.shopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://windsor.shopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; (users will see shopify.com and trust. Plus the fact it\u0026#39;s a cool name like \u0026#39;Windsor\u0026#39;, may get users attention). \u003c/p\u003e\n\n\u003cp\u003eWe could then in theory create a domain similar to shopify and redirect aislingofwindsor.com straight to another domain. Add all the HTTPS stuff to make it look even more real, and we have a pretty good attack surface!\u003c/p\u003e\n\n\u003cp\u003eNote: I\u0026#39;ve done a lot of internal phishing for clients and had a 100% success rate every time, hence why i\u0026#39;m reporting this as I feel this url could be used to easily phish users.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["yaworsk","bugdiscloseguys","powerjacobb1","muhammad_uwais","sumit7","spetr0x","dyabla","no-longer-with-company","safisec","bupnup","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1061649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2016-07-10T16:32:36.185Z","updated_at":"2016-07-10T16:32:36.185Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1062847,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your report.\n\nShops can only be placed on the shopify.com domain by Shopify staff. The shop at windsor.shopify.com was left there by mistake, and has been removed.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eShops can only be placed on the shopify.com domain by Shopify staff. The shop at windsor.shopify.com was left there by mistake, and has been removed.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T14:01:15.696Z","updated_at":"2016-07-11T14:01:15.696Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zseano","url":"/zseano"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1075062,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify! This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T23:31:15.626Z","updated_at":"2016-07-18T23:31:15.626Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zseano","url":"/zseano"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1075063,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T23:31:23.470Z","updated_at":"2016-07-18T23:31:23.470Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1075066,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! :)","markdown_message":"\u003cp\u003eThanks! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T23:36:07.021Z","updated_at":"2016-07-18T23:36:07.021Z","actor":{"username":"zseano","cleared":false,"url":"/zseano","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/p5Ap5pB7ykW79dUP5kMSkP4j/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075067,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T23:36:07.217Z","updated_at":"2016-07-18T23:36:07.217Z","actor":{"username":"zseano","cleared":false,"url":"/zseano","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/p5Ap5pB7ykW79dUP5kMSkP4j/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}