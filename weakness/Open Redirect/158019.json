{"id":158019,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTgwMTk=","url":"https://hackerone.com/reports/158019","title":"Host Header Injection/Redirection in: https://www.instacart.com/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-10T00:13:32.757Z","submitted_at":"2016-08-10T00:13:32.757Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"clarckowen_","url":"/clarckowen_","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-11T10:24:58.832Z","bug_reporter_agreed_on_going_public_at":"2016-08-12T10:24:43.982Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nYour website is vulnerable to Host Header Injection because the host header can be changed to something outside the target domain\n\nIn many cases, developers are trusting the HTTP Host header value and using it to generate links, import scripts and even generate password resets links with its value. This is a very bad idea, because the HTTP Host header can be controlled by an attacker. This can be exploited using web-cache poisoning and by abusing alternative channels like password reset emails.\n\nGET / HTTP/1.1\nHost: google.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\n\nHTTP/1.1 301 Moved Permanently\nDate: Tue, 09 Aug 2016 23:55:09 GMT\nLocation: https://google.com/\nServer: nginx\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nConnection: Close\nContent-Type: text/html\nContent-Length: 178\n\nReference: https://www.acunetix.com/vulnerabilities/web/host-header-attack\n\nRegards,\nClarck","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYour website is vulnerable to Host Header Injection because the host header can be changed to something outside the target domain\u003c/p\u003e\n\n\u003cp\u003eIn many cases, developers are trusting the HTTP Host header value and using it to generate links, import scripts and even generate password resets links with its value. This is a very bad idea, because the HTTP Host header can be controlled by an attacker. This can be exploited using web-cache poisoning and by abusing alternative channels like password reset emails.\u003c/p\u003e\n\n\u003cp\u003eGET / HTTP/1.1\u003cbr\u003e\nHost: google.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 301 Moved Permanently\u003cbr\u003e\nDate: Tue, 09 Aug 2016 23:55:09 GMT\u003cbr\u003e\nLocation: \u003ca title=\"https://google.com/\" href=\"/redirect?url=https%3A%2F%2Fgoogle.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://google.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nServer: nginx\u003cbr\u003e\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\u003cbr\u003e\nConnection: Close\u003cbr\u003e\nContent-Type: text/html\u003cbr\u003e\nContent-Length: 178\u003c/p\u003e\n\n\u003cp\u003eReference: \u003ca title=\"https://www.acunetix.com/vulnerabilities/web/host-header-attack\" href=\"/redirect?url=https%3A%2F%2Fwww.acunetix.com%2Fvulnerabilities%2Fweb%2Fhost-header-attack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.acunetix.com/vulnerabilities/web/host-header-attack\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nClarck\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":110937,"file_name":"request.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/110/937/f24e5e3334d96f20ae1bf833536bd3d4a3f67db7/request.png?response-content-disposition=attachment%3B%20filename%3D%22request.png%22%3B%20filename%2A%3DUTF-8%27%27request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043549Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=80880e8e35643a7f9949bc54bd2c91282f606be552813b05f29e62e28932ff36","file_size":11790,"type":"image/png"},{"id":110938,"file_name":"responseinstacart.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/110/938/481617415e43f17a05805cd51d89b466b3dbd6a6/responseinstacart.png?response-content-disposition=attachment%3B%20filename%3D%22responseinstacart.png%22%3B%20filename%2A%3DUTF-8%27%27responseinstacart.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043549Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=b47045638e11a7da4e01dc23a874df06f7ae9fd63be28e14f5a187784087ffcc","file_size":18753,"type":"image/png"}],"allow_singular_disclosure_at":"2016-09-11T10:24:44.090Z","allow_singular_disclosure_after":-135627065.84601274,"singular_disclosure_allowed":true,"vote_count":15,"voters":["zayn1337","footstep","ymy","ak1t4","jens","mr_sharma_","fantam1","mefkan","japz","spetr0x","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1116241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Don't you qualify bug since it is a working header injection?","markdown_message":"\u003cp\u003eDon\u0026#39;t you qualify bug since it is a working header injection?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T01:16:16.462Z","updated_at":"2016-08-10T01:16:16.462Z","actor":{"username":"clarckowen_","cleared":false,"url":"/clarckowen_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi! Any update for this?","markdown_message":"\u003cp\u003eHi! Any update for this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T14:27:51.529Z","updated_at":"2016-08-11T14:27:51.529Z","actor":{"username":"clarckowen_","cleared":false,"url":"/clarckowen_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120590,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T22:23:41.841Z","updated_at":"2016-08-11T22:23:41.841Z","additional_data":{"duplicate_report_id":158189},"actor":{"username":"ng1","cleared":false,"url":"/ng1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/098/fbc0fd19ad82652257c8ef5af49f1e2db62ef895_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120593,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T22:24:39.031Z","updated_at":"2016-08-11T22:24:39.031Z","additional_data":{"duplicate_report_id":158201},"actor":{"username":"jigarthakkar39","cleared":false,"url":"/jigarthakkar39","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/350/77f22bc34ca72e2054bde5ccbe21970a6a28539f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120598,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T22:25:17.492Z","updated_at":"2016-08-11T22:25:17.492Z","additional_data":{"duplicate_report_id":158022},"actor":{"username":"aaron_costello","cleared":true,"url":"/aaron_costello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/89cpgLpC5JjJB9H6NtWYW3wJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120602,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report!","markdown_message":"\u003cp\u003eThank you for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T22:26:57.829Z","updated_at":"2016-08-11T22:26:57.829Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"clarckowen_","url":"/clarckowen_"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120603,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T22:27:46.510Z","updated_at":"2016-08-11T22:27:46.510Z","actor":{"username":"cxmcc-instacart","cleared":false,"url":"/cxmcc-instacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"clarckowen_","url":"/clarckowen_"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1121586,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No problem! It's my first bounty, thanks for the bounty :)\n\nCheers,\nClarck","markdown_message":"\u003cp\u003eNo problem! It\u0026#39;s my first bounty, thanks for the bounty :)\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nClarck\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-12T10:24:44.033Z","updated_at":"2016-08-12T10:24:44.033Z","first_to_agree":true,"actor":{"username":"clarckowen_","cleared":false,"url":"/clarckowen_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1187105,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-11T10:24:58.885Z","updated_at":"2016-09-11T10:24:58.885Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1188753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To readers of this disclosed report:\nWe started to consider similar vulnerabilities low impact and no longer accept them.\nThis include host header injection on other subdomains, use of `X-Forwarded-Host` header, etc.\nPlease do not report any more unless an issue can lead to higher impact exploits.","markdown_message":"\u003cp\u003eTo readers of this disclosed report:\u003cbr\u003e\nWe started to consider similar vulnerabilities low impact and no longer accept them.\u003cbr\u003e\nThis include host header injection on other subdomains, use of \u003ccode\u003eX-Forwarded-Host\u003c/code\u003e header, etc.\u003cbr\u003e\nPlease do not report any more unless an issue can lead to higher impact exploits.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-12T15:04:46.821Z","updated_at":"2016-09-12T15:04:46.821Z","actor":{"username":"cxmcc-instacart","cleared":false,"url":"/cxmcc-instacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2764,"category":"team","content":"We NO LONGER accept similar reports about Host header Injections (including `X-Forwarded-Host`, etc)","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe NO LONGER accept similar reports about Host header Injections (including \u003ccode\u003eX-Forwarded-Host\u003c/code\u003e, etc)\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}