{"id":23386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzM4Ng==","url":"https://hackerone.com/reports/23386","title":"Redirect while opening links in new tabs","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-08-09T23:53:26.688Z","submitted_at":"2014-08-09T23:53:26.688Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thetime","url":"/thetime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/TnAfBz7i2sbjZciRMXTV6yBo/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-09-12T22:26:42.694Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-08-13T22:26:31.090Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello HackerOne,\r\n\r\nI'd like to report to you a nice little bug about opening links in new tabs.\r\n\r\nWhen you open a link in a new tab ( target=\"_blank\" ), the page that opens in a new tab can access the initial tab and change it's location using the window.opener property.\r\n\r\nPOC: \r\nhttp://daniel-tomescu.com/hackerone/landpage.php (just click on the link, don't worry, no harm will be done). \r\n\r\nDon't right-click it and open it in new tab, don't use the mouse wheel to open it, don't Ctrl+Click, just do a normal click on the link.\r\n\r\nThe javascript code that does all the magic:\r\nwindow.opener.location.replace(newURL);\r\n\r\nWays to solve this:\r\n1. Don't open links from hackerone.com in new tabs using the  target=\"_blank\";\r\n2. Set the window.opener attribute to null on the new tab before redirecting to the landing page, like this:\r\na) open in a new tab hackerone.com/redirect?link=landingpage\r\nb) use a javascript code: \u003cscript\u003ewindow.opener = null; \u003c/script\u003e\r\nc) redirect to the landing page: \u003cscript\u003ewindow.location.reload(landingpage)\u003c/script\u003e\r\n\r\nI hope you see why this is dangerous: this method has huge potential for tricking hackerone.com that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\r\n\r\nMore then that, some browsers like Mozilla for Android don't even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\r\n\r\nIf an attacker uses this trick while submitting a bug on hackerone.com/someTarget, he may obtain the logon credentials for a representative of \"someTarget\" and gain access to his account, private reports submitted by other researchers etc.\r\n\r\nTested on Chrome version 36 (latest version), Firefox for Windows and Android (latest versions). Websites that protect themselves against this kind of attack: google.com websites, twitter.com (they open links in new tabs, but the window.opener property is set to null)\r\n\r\nThank you!\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHello HackerOne,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;d like to report to you a nice little bug about opening links in new tabs.\u003c/p\u003e\n\n\u003cp\u003eWhen you open a link in a new tab ( target=\u0026quot;_blank\u0026quot; ), the page that opens in a new tab can access the initial tab and change it\u0026#39;s location using the window.opener property.\u003c/p\u003e\n\n\u003cp\u003ePOC: \u003cbr\u003e\n\u003ca title=\"http://daniel-tomescu.com/hackerone/landpage.php\" href=\"/redirect?url=http%3A%2F%2Fdaniel-tomescu.com%2Fhackerone%2Flandpage.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://daniel-tomescu.com/hackerone/landpage.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (just click on the link, don\u0026#39;t worry, no harm will be done). \u003c/p\u003e\n\n\u003cp\u003eDon\u0026#39;t right-click it and open it in new tab, don\u0026#39;t use the mouse wheel to open it, don\u0026#39;t Ctrl+Click, just do a normal click on the link.\u003c/p\u003e\n\n\u003cp\u003eThe javascript code that does all the magic:\u003cbr\u003e\nwindow.opener.location.replace(newURL);\u003c/p\u003e\n\n\u003cp\u003eWays to solve this:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDon\u0026#39;t open links from hackerone.com in new tabs using the  target=\u0026quot;_blank\u0026quot;;\u003c/li\u003e\n\u003cli\u003eSet the window.opener attribute to null on the new tab before redirecting to the landing page, like this:\na) open in a new tab hackerone.com/redirect?link=landingpage\nb) use a javascript code: \u0026lt;script\u0026gt;window.opener = null; \u0026lt;/script\u0026gt;\nc) redirect to the landing page: \u0026lt;script\u0026gt;window.location.reload(landingpage)\u0026lt;/script\u0026gt;\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI hope you see why this is dangerous: this method has huge potential for tricking hackerone.com that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\u003c/p\u003e\n\n\u003cp\u003eMore then that, some browsers like Mozilla for Android don\u0026#39;t even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\u003c/p\u003e\n\n\u003cp\u003eIf an attacker uses this trick while submitting a bug on hackerone.com/someTarget, he may obtain the logon credentials for a representative of \u0026quot;someTarget\u0026quot; and gain access to his account, private reports submitted by other researchers etc.\u003c/p\u003e\n\n\u003cp\u003eTested on Chrome version 36 (latest version), Firefox for Windows and Android (latest versions). Websites that protect themselves against this kind of attack: google.com websites, twitter.com (they open links in new tabs, but the window.opener property is set to null)\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-12T22:26:31.554Z","allow_singular_disclosure_after":-198657588.52055347,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sourc7","arifmkhls","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":104374,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Excellent report, thank you! I can confirm that your proof of concept works. We will do further investigating to determine priority and will get this issue fixed. ","markdown_message":"\u003cp\u003eExcellent report, thank you! I can confirm that your proof of concept works. We will do further investigating to determine priority and will get this issue fixed. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-11T00:11:28.302Z","updated_at":"2014-08-11T00:11:28.302Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":104588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! \n\nLet me know if you'll need my help in the process, I'll be glad to help.\n\nThank you!","markdown_message":"\u003cp\u003eGreat! \u003c/p\u003e\n\n\u003cp\u003eLet me know if you\u0026#39;ll need my help in the process, I\u0026#39;ll be glad to help.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-11T11:59:56.992Z","updated_at":"2014-08-11T11:59:56.992Z","actor":{"username":"thetime","cleared":false,"url":"/thetime","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TnAfBz7i2sbjZciRMXTV6yBo/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":106660,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @thetime, thanks again for your report.\n\nI have just deployed a fix to production. Can your confirm this fixes the issue?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/thetime\"\u003e@thetime\u003c/a\u003e, thanks again for your report.\u003c/p\u003e\n\n\u003cp\u003eI have just deployed a fix to production. Can your confirm this fixes the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-13T15:51:13.727Z","updated_at":"2014-08-13T15:51:13.727Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":106723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tomdev,\n\nI can't reproduce the issue, the window.opener is \"null\" on the new tab. So I consider it fixed.\n\nOn the other hand, I would like to congratulate your team for reacting really quick about this bug. I don't see very often security issues repaired in less then a week.\n\nCheers!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI can\u0026#39;t reproduce the issue, the window.opener is \u0026quot;null\u0026quot; on the new tab. So I consider it fixed.\u003c/p\u003e\n\n\u003cp\u003eOn the other hand, I would like to congratulate your team for reacting really quick about this bug. I don\u0026#39;t see very often security issues repaired in less then a week.\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-13T17:04:40.307Z","updated_at":"2014-08-13T17:04:40.307Z","actor":{"username":"thetime","cleared":false,"url":"/thetime","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TnAfBz7i2sbjZciRMXTV6yBo/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":107144,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again @thetime — very good write up and great PoC!","markdown_message":"\u003cp\u003eThanks again \u003ca href=\"/thetime\"\u003e@thetime\u003c/a\u003e — very good write up and great PoC!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-13T22:26:13.593Z","updated_at":"2014-08-13T22:26:13.593Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"thetime","url":"/thetime"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":107145,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-13T22:26:26.576Z","updated_at":"2014-08-13T22:26:26.576Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"thetime","url":"/thetime"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":107146,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-13T22:26:31.370Z","updated_at":"2014-08-13T22:26:31.370Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":126176,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-12T22:26:42.718Z","updated_at":"2014-09-12T22:26:42.718Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}