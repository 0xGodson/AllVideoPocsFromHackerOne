{"id":400982,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDA5ODI=","url":"https://hackerone.com/reports/400982","title":"Open redirect in securegatewayaccess.com / secure.chaturbate.com via prejoin_data parameter","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-27T13:13:21.961Z","submitted_at":"2018-08-27T13:13:21.961Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-19T23:46:03.983Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T23:46:03.809Z","team_member_agreed_on_going_public_at":"2018-09-19T22:32:41.356Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary##\nHello, I have found that if there is a valid `weg_digest` parameter in the in the GET request to https://secure.chaturbate.com/post and other parameters are invalid, a Location header will be automatically constructor based on the contents of the `prejoin_data` parameter. This allows someone to change the base root and create an open redirect.\n\nEven more, it has been observed that this specific request also works under the https://securegatewayaccess.com domain and an open redirect can also be created from that domain.\n\nPS : Because this affects both URL's and `securegatewayaccess.com` seems to be a critical I have marked this as medium instead of low.\n\n## Steps To Reproduce:\n- Call in browser this URL :\n\n```\nhttps://securegatewayaccess.com/post?prejoin_data=domain%2Fevil.com/?=\u0026weg_digest=eacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n```\n\n- Or under the secure.chaturbate domain this URL :\n\n```\nhttps://secure.chaturbate.com/post?prejoin_data=domain%2Fevil.com/?=\u0026weg_digest=eacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n```\n\n- This can also be linked with the /external_link request from the root url to create a chained redirect :\n\n```\nhttps://chaturbate.com/external_link/?url=https%3A%2F%2Fsecure.chaturbate.com%2Fpost%3Fprejoin_data%3Ddomain%252Fevil.com%2F%3F%3D%26weg_digest%3Deacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n```\n\nAll requests will have as answer this header :\n\n```\nLocation: http://evil.com/?=/tipping/purchase_tokens/\n```\n\n## Supporting Material/References:\nN/A\n\n## Impact\n\nOpen redirect that facilitate potential phishing attacks.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eHello, I have found that if there is a valid \u003ccode\u003eweg_digest\u003c/code\u003e parameter in the in the GET request to \u003ca title=\"https://secure.chaturbate.com/post\" href=\"/redirect?url=https%3A%2F%2Fsecure.chaturbate.com%2Fpost\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.chaturbate.com/post\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and other parameters are invalid, a Location header will be automatically constructor based on the contents of the \u003ccode\u003eprejoin_data\u003c/code\u003e parameter. This allows someone to change the base root and create an open redirect.\u003c/p\u003e\n\n\u003cp\u003eEven more, it has been observed that this specific request also works under the \u003ca title=\"https://securegatewayaccess.com\" href=\"/redirect?url=https%3A%2F%2Fsecuregatewayaccess.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://securegatewayaccess.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e domain and an open redirect can also be created from that domain.\u003c/p\u003e\n\n\u003cp\u003ePS : Because this affects both URL\u0026#39;s and \u003ccode\u003esecuregatewayaccess.com\u003c/code\u003e seems to be a critical I have marked this as medium instead of low.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eCall in browser this URL :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://securegatewayaccess.com/post?prejoin_data=domain%2Fevil.com/?=\u0026amp;weg_digest=eacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eOr under the secure.chaturbate domain this URL :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://secure.chaturbate.com/post?prejoin_data=domain%2Fevil.com/?=\u0026amp;weg_digest=eacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eThis can also be linked with the /external_link request from the root url to create a chained redirect :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://chaturbate.com/external_link/?url=https%3A%2F%2Fsecure.chaturbate.com%2Fpost%3Fprejoin_data%3Ddomain%252Fevil.com%2F%3F%3D%26weg_digest%3Deacde2b0b10379e9848390da67ed883666fe083a9ad892fae85c590ddd354e8c\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAll requests will have as answer this header :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eLocation: http://evil.com/?=/tipping/purchase_tokens/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eN/A\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eOpen redirect that facilitate potential phishing attacks.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-19T22:32:41.458Z","allow_singular_disclosure_after":-69232730.40478174,"singular_disclosure_allowed":true,"vote_count":10,"voters":["mygf","eveeez","realtess","mefkan","cryptographer","youssef-xf7","v13rsba","jatacheers","realme","sebserra"],"severity":{"rating":"medium","score":6.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":11784,"asset_type":"URL","asset_identifier":"*.securegatewayaccess.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3254907,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-27T20:28:14.171Z","updated_at":"2018-08-27T20:28:14.171Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (6.4)","old_severity_id":201321,"new_severity_id":201613},"actor":{"username":"pooyammllc","cleared":false,"url":"/pooyammllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3254913,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report! We'll get this fixed.","markdown_message":"\u003cp\u003eThank you for the report! We\u0026#39;ll get this fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-27T20:34:14.867Z","updated_at":"2018-08-27T20:34:14.867Z","actor":{"username":"pooyammllc","cleared":false,"url":"/pooyammllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3254914,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-27T20:34:40.833Z","updated_at":"2018-08-27T20:34:40.833Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Chaturbate"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3254935,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@inhibitor181  this issue should now be resolved. Could you confirm for us? Thank you","markdown_message":"\u003cp\u003e\u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e  this issue should now be resolved. Could you confirm for us? Thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-27T20:43:09.955Z","updated_at":"2018-08-27T20:43:09.955Z","actor":{"username":"pooyammllc","cleared":false,"url":"/pooyammllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360419,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T22:32:41.399Z","updated_at":"2018-09-19T22:32:41.399Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360602,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"It looks fixed, I must have somehow missed the reply.","markdown_message":"\u003cp\u003eIt looks fixed, I must have somehow missed the reply.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T23:46:03.860Z","updated_at":"2018-09-19T23:46:03.860Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360603,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T23:46:04.024Z","updated_at":"2018-09-19T23:46:04.024Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}