{"id":94637,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NDYzNw==","url":"https://hackerone.com/reports/94637","title":"Host Header Injection/Redirection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-19T15:45:56.807Z","submitted_at":"2015-10-19T15:45:56.807Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"1n3","url":"/1n3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":569,"url":"https://hackerone.com/whisper","handle":"whisper","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/569/3652e25f9292ac76674319422f1fc9ce1a79283b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/569/3652e25f9292ac76674319422f1fc9ce1a79283b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Whisper","twitter_handle":null,"website":"http://whisper.sh/","about":"Whisper is an anonymous social network that lets people share confessions, express themselves, and meet new people."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-01-06T19:42:36.579Z","bug_reporter_agreed_on_going_public_at":"2015-12-07T19:42:22.052Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"whisper.sh is vulnerable to host header injection because the host header can be changed to something outside the target domain (ie. whisper.sh) and cause it to redirect to to that domain instead (see below). \n\nAttack vectors are somewhat limited but depends on how the host header is used by the back-end application code. If code references the hostname used in the URL such as password reset pages, an attacker could spoof the host header of the request in order to trick the application to forwarding the password reset email to the attackers domain instead, etc. Other attack vectors may also be possible through manipulation of hyperlinks or other misc. code that relies on the host/domain of the request.\n\nGET / HTTP/1.1\nHost: crowdshield.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\n\nHTTP/1.1 301 Moved Permanently\nContent-length: 0\nLocation: https://crowdshield.com/\nConnection: close\n\nIf you search Google for this vulnerability, there are many, many blogs, articles and white papers describing this vulnerability and associated attack vectors. Every major commercial web application scanner like Accunetix will report this same vulnerability. \n\nFor more details, please read: https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/.\n\nNormally, most apps will reject any request that doesn't originate from the same origin (ie. whisper.sh). To fix, the application should reject anything that doesn't match the target domain. This may also be an error in the rewrite functions of the back-end web server as well.\n","vulnerability_information_html":"\u003cp\u003ewhisper.sh is vulnerable to host header injection because the host header can be changed to something outside the target domain (ie. whisper.sh) and cause it to redirect to to that domain instead (see below). \u003c/p\u003e\n\n\u003cp\u003eAttack vectors are somewhat limited but depends on how the host header is used by the back-end application code. If code references the hostname used in the URL such as password reset pages, an attacker could spoof the host header of the request in order to trick the application to forwarding the password reset email to the attackers domain instead, etc. Other attack vectors may also be possible through manipulation of hyperlinks or other misc. code that relies on the host/domain of the request.\u003c/p\u003e\n\n\u003cp\u003eGET / HTTP/1.1\u003cbr\u003e\nHost: crowdshield.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 301 Moved Permanently\u003cbr\u003e\nContent-length: 0\u003cbr\u003e\nLocation: \u003ca title=\"https://crowdshield.com/\" href=\"/redirect?url=https%3A%2F%2Fcrowdshield.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://crowdshield.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003eIf you search Google for this vulnerability, there are many, many blogs, articles and white papers describing this vulnerability and associated attack vectors. Every major commercial web application scanner like Accunetix will report this same vulnerability. \u003c/p\u003e\n\n\u003cp\u003eFor more details, please read: \u003ca title=\"https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/\" href=\"/redirect?url=https%3A%2F%2Fwww.acunetix.com%2Fblog%2Farticles%2Fautomated-detection-of-host-header-attacks%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eNormally, most apps will reject any request that doesn\u0026#39;t originate from the same origin (ie. whisper.sh). To fix, the application should reject anything that doesn\u0026#39;t match the target domain. This may also be an error in the rewrite functions of the back-end web server as well.\u003c/p\u003e\n","bounty_amount":"30.0","formatted_bounty":"$30","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":57992,"file_name":"Host_Header_Injection.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/057/992/2265384e15f612340b4110e92a758741a7b5656a/Host_Header_Injection.png?response-content-disposition=attachment%3B%20filename%3D%22Host_Header_Injection.png%22%3B%20filename%2A%3DUTF-8%27%27Host_Header_Injection.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071319Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=8895ce21c15a0f7d9f673d6ae43a2dc50a1932298ecf7d1a9ef29ac90cdf69e8","file_size":30858,"type":"image/png"}],"allow_singular_disclosure_at":"2016-01-06T19:42:22.227Z","allow_singular_disclosure_after":-157116657.2007787,"singular_disclosure_allowed":true,"vote_count":1,"voters":["jayateertha043"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":711735,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, fixed.","markdown_message":"\u003cp\u003eThanks, fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-07T19:18:14.612Z","updated_at":"2015-12-07T19:18:14.612Z","actor":{"username":"cidan","cleared":false,"url":"/cidan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"1n3","url":"/1n3"},"genius_execution_id":null,"team_handle":"whisper","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":711736,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-07T19:18:24.081Z","updated_at":"2015-12-07T19:18:24.081Z","actor":{"url":"/whisper","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/569/3652e25f9292ac76674319422f1fc9ce1a79283b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Whisper"}},"bounty_amount":"30.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"whisper","collaborator":{"username":"1n3","url":"/1n3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":711781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-07T19:41:59.174Z","updated_at":"2015-12-07T19:41:59.174Z","actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"whisper","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":711782,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Okay to disclose?","markdown_message":"\u003cp\u003eOkay to disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-07T19:42:22.077Z","updated_at":"2015-12-07T19:42:22.077Z","first_to_agree":true,"actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"whisper","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":744659,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-06T19:42:36.632Z","updated_at":"2016-01-06T19:42:36.632Z","actor":{"url":"/whisper","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/569/3652e25f9292ac76674319422f1fc9ce1a79283b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Whisper"}},"genius_execution_id":null,"team_handle":"whisper","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}