{"id":179568,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzk1Njg=","url":"https://hackerone.com/reports/179568","title":"Tab nabbing via window.opener","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-02T08:25:12.063Z","submitted_at":"2016-11-02T08:25:12.063Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haquaman","url":"/haquaman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-28T01:41:57.680Z","bug_reporter_agreed_on_going_public_at":"2016-11-28T01:41:56.523Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Details:\nWhen you open a link in a new tab ( target=\"_blank\" ), the page that opens in a new tab can access the initial tab and change it's location using the window.opener property.\n\nPOC: \nEdit your contact details, with the website URL of http://davenport.net.nz/test.html, which has the following html\n```\n\n\u003chtml\u003e\n\u003cscript\u003e\nif (window.opener) window.opener.parent.location.replace('http://allthethings.co.nz');\nif (window.parent != window) window.parent.location.replace('http://allthethings.co.nz');\n\u003c/script\u003e\nblah\n\n\u003c/html\u003e\n``` \n\nCreate a document, and add a comment from this user, when you click on that user, you should see the full details (one of many ways to get to the hyperlink), you can then click on the link to my website. This opens in a new tab, and the existing tab is *silently* redirected to my company website *without asking the user*. In a real life example, this would redirect to a phishing site to try gain credentials for users.\n\nThe javascript code that does all the magic: \n`window.opener.location.replace(newURL);`\n\nWays to solve this:\n\nDon't open links in new tabs using the target=\"_blank\"\nAdd attribute rel=\"noreferrer\" which also disables referrer\nSet the window.opener attribute to null on the new tab before redirecting, like this: \u003cscript\u003evar w=window.open(url, \"target=_blank\");w.opener=null;\u003c/script\u003e\nI hope you see why this is dangerous: this method has huge potential for tricking users that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\n\nMore then that, some browsers like Mozilla for Android don't even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\n\nNote that the target page doesn't have to be in the same-origin policy, so can be an entirely different domain, and the redirect happens silently while user is viewing another page.\n\nHope that all helps, let me know if you need more information. I can provide screenshots and/or screencasts if necessary.\n\nCheers,\n\nHugh","vulnerability_information_html":"\u003cp\u003eDetails:\u003cbr\u003e\nWhen you open a link in a new tab ( target=\u0026quot;_blank\u0026quot; ), the page that opens in a new tab can access the initial tab and change it\u0026#39;s location using the window.opener property.\u003c/p\u003e\n\n\u003cp\u003ePOC: \u003cbr\u003e\nEdit your contact details, with the website URL of \u003ca title=\"http://davenport.net.nz/test.html\" href=\"/redirect?url=http%3A%2F%2Fdavenport.net.nz%2Ftest.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://davenport.net.nz/test.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which has the following html\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopener\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopener\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttp://allthethings.co.nz\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparent\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttp://allthethings.co.nz\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\nblah\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCreate a document, and add a comment from this user, when you click on that user, you should see the full details (one of many ways to get to the hyperlink), you can then click on the link to my website. This opens in a new tab, and the existing tab is \u003cem\u003esilently\u003c/em\u003e redirected to my company website \u003cem\u003ewithout asking the user\u003c/em\u003e. In a real life example, this would redirect to a phishing site to try gain credentials for users.\u003c/p\u003e\n\n\u003cp\u003eThe javascript code that does all the magic: \u003cbr\u003e\n\u003ccode\u003ewindow.opener.location.replace(newURL);\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWays to solve this:\u003c/p\u003e\n\n\u003cp\u003eDon\u0026#39;t open links in new tabs using the target=\u0026quot;_blank\u0026quot;\u003cbr\u003e\nAdd attribute rel=\u0026quot;noreferrer\u0026quot; which also disables referrer\u003cbr\u003e\nSet the window.opener attribute to null on the new tab before redirecting, like this: \u0026lt;script\u0026gt;var w=window.open(url, \u0026quot;target=_blank\u0026quot;);w.opener=null;\u0026lt;/script\u0026gt;\u003cbr\u003e\nI hope you see why this is dangerous: this method has huge potential for tricking users that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\u003c/p\u003e\n\n\u003cp\u003eMore then that, some browsers like Mozilla for Android don\u0026#39;t even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\u003c/p\u003e\n\n\u003cp\u003eNote that the target page doesn\u0026#39;t have to be in the same-origin policy, so can be an entirely different domain, and the redirect happens silently while user is viewing another page.\u003c/p\u003e\n\n\u003cp\u003eHope that all helps, let me know if you need more information. I can provide screenshots and/or screencasts if necessary.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eHugh\u003c/p\u003e\n","bounty_amount":"666.0","formatted_bounty":"$666","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-28T01:41:56.573Z","allow_singular_disclosure_after":-126327755.99553955,"singular_disclosure_allowed":true,"vote_count":28,"voters":["sameerphad72","man4bob","dmatrix","ankitsingh","madrobot","muhammad_uwais","mpz","eveeez","r3y","m16","and 18 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1279861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-02T08:51:16.481Z","updated_at":"2016-11-02T08:51:16.481Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1279863,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T08:53:23.363Z","updated_at":"2016-11-02T08:53:23.363Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1299904,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T07:38:51.245Z","updated_at":"2016-11-15T07:38:51.245Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"666.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"haquaman","url":"/haquaman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300040,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved. Note however that we do tracking and release management outside of H1. The issue will be posted to bugtraq after some grace period.","markdown_message":"\u003cp\u003eClosing as resolved. Note however that we do tracking and release management outside of H1. The issue will be posted to bugtraq after some grace period.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T09:44:12.729Z","updated_at":"2016-11-15T09:44:12.729Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"haquaman","url":"/haquaman"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1322149,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose?","markdown_message":"\u003cp\u003eCan we disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-28T01:41:56.543Z","updated_at":"2016-11-28T01:41:56.543Z","first_to_agree":true,"actor":{"username":"haquaman","cleared":false,"url":"/haquaman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1388314,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-28T01:41:57.707Z","updated_at":"2016-12-28T01:41:57.707Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4917022,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:20:36.073Z","updated_at":"2019-05-24T12:20:36.073Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":401116},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}