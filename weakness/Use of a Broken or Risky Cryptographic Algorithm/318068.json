{"id":318068,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTgwNjg=","url":"https://hackerone.com/reports/318068","title":"SSH server compatible with several vulnerable cryptographic algorithms","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-21T02:23:21.045Z","submitted_at":"2018-02-21T02:23:21.045Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"northivanastan","url":"/northivanastan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-02T20:44:31.260Z","bug_reporter_agreed_on_going_public_at":"2018-02-25T17:32:03.920Z","team_member_agreed_on_going_public_at":"2018-03-02T20:44:31.165Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An ssh-audit scan found that ssh.fr.cloud.gov supports sha1 for various purposes(including exclusively for MAC addresses), as well as arcfour. Both of these are outdated and known vulnerable.\n\nThe algorithms used are also indicative of an outdated SSH version (OpenSSH 6 or Dropbear 2013). It's probably a good idea to upgrade.\n\nThe output of ssh-audit is attached.\n\n## Impact\n\nA man-in-the-middle attack may expose data encrypted with arcfour and/or hashed with sha1, which can then be decrypted to find things like passwords or payloads sent over SSH.","vulnerability_information_html":"\u003cp\u003eAn ssh-audit scan found that ssh.fr.cloud.gov supports sha1 for various purposes(including exclusively for MAC addresses), as well as arcfour. Both of these are outdated and known vulnerable.\u003c/p\u003e\n\n\u003cp\u003eThe algorithms used are also indicative of an outdated SSH version (OpenSSH 6 or Dropbear 2013). It\u0026#39;s probably a good idea to upgrade.\u003c/p\u003e\n\n\u003cp\u003eThe output of ssh-audit is attached.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA man-in-the-middle attack may expose data encrypted with arcfour and/or hashed with sha1, which can then be decrypted to find things like passwords or payloads sent over SSH.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":41,"name":"Use of a Broken or Risky Cryptographic Algorithm"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":265408,"file_name":"ssh-audit-out.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/408/f70a2bc580dfb4f992b9c8c5824bce580d51841c/ssh-audit-out.txt?response-content-disposition=attachment%3B%20filename%3D%22ssh-audit-out.txt%22%3B%20filename%2A%3DUTF-8%27%27ssh-audit-out.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053357Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=4005ca491131f30faa13912fbfbfa0e3965be42064dc89945bb7d863aea6f0bc","file_size":5278,"type":"text/plain"}],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["base_64","eveeez","apapedulimu","an0nym0us","t-4-y-m","cr4xerbik4sh","silv3rpoision","0x08","spetr0x","edercofebe"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6282,"asset_type":"URL","asset_identifier":"ssh.fr.cloud.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2409924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Further testing: this isn't OpenSSH 6, but the poor choice of algorithms is still evident.","markdown_message":"\u003cp\u003eFurther testing: this isn\u0026#39;t OpenSSH 6, but the poor choice of algorithms is still evident.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-21T03:47:41.986Z","updated_at":"2018-02-21T03:47:41.986Z","actor":{"username":"northivanastan","cleared":false,"url":"/northivanastan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2412147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @northivanastan \n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/northivanastan\"\u003e@northivanastan\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-21T17:09:00.183Z","updated_at":"2018-02-21T17:09:00.183Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2412344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for acknowledging the report.","markdown_message":"\u003cp\u003eThank you for acknowledging the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-21T18:10:20.113Z","updated_at":"2018-02-21T18:10:20.113Z","actor":{"username":"northivanastan","cleared":false,"url":"/northivanastan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2426045,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T16:07:19.372Z","updated_at":"2018-02-23T16:07:19.372Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2426049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again @northivanastan,\n\nWe've validated your report and have rolled out [updated SSH config](https://github.com/18F/cg-deploy-cf/pull/335) based on your recommendations.","markdown_message":"\u003cp\u003eHi again \u003ca href=\"/northivanastan\"\u003e@northivanastan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve validated your report and have rolled out \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Fcg-deploy-cf%2Fpull%2F335\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eupdated SSH config\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e based on your recommendations.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T16:10:26.573Z","updated_at":"2018-02-23T16:10:26.573Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2426474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will test the server again once I get home. Thanks","markdown_message":"\u003cp\u003eI will test the server again once I get home. Thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T18:00:09.579Z","updated_at":"2018-02-23T18:00:09.579Z","actor":{"username":"northivanastan","cleared":false,"url":"/northivanastan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2427235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that highly insecure algorithms are no longer used, and thus this can be marked as resolved.","markdown_message":"\u003cp\u003eI can confirm that highly insecure algorithms are no longer used, and thus this can be marked as resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T22:39:09.522Z","updated_at":"2018-02-23T22:39:09.522Z","actor":{"username":"northivanastan","cleared":false,"url":"/northivanastan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2431911,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for this report @northivanastan. I'm going to mark as resolved and recommend a `Medium` severity bounty.\n\nWe appreciate your work and encourage you to continue to research cloud.gov and other TTS Bug Bounty systems!","markdown_message":"\u003cp\u003eThanks again for this report \u003ca href=\"/northivanastan\"\u003e@northivanastan\u003c/a\u003e. I\u0026#39;m going to mark as resolved and recommend a \u003ccode\u003eMedium\u003c/code\u003e severity bounty.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your work and encourage you to continue to research cloud.gov and other TTS Bug Bounty systems!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-25T17:08:16.028Z","updated_at":"2018-02-25T17:08:16.028Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"northivanastan","url":"/northivanastan"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2431912,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-25T17:09:30.095Z","updated_at":"2018-02-25T17:09:30.095Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"northivanastan","url":"/northivanastan"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2431930,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we schedule disclosure for this bug now that this has been fixed? And yes, I enjoyed the experience and plan to do more research on your systems. Thank you very much","markdown_message":"\u003cp\u003eCan we schedule disclosure for this bug now that this has been fixed? And yes, I enjoyed the experience and plan to do more research on your systems. Thank you very much\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-25T17:32:03.949Z","updated_at":"2018-02-25T17:32:03.949Z","first_to_agree":true,"actor":{"username":"northivanastan","cleared":false,"url":"/northivanastan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/242/570/ef1d996ff6cb978f8658dc71274b52b5f2b6e8a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2451212,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-02T20:44:31.199Z","updated_at":"2018-03-02T20:44:31.199Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2451213,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-02T20:44:31.295Z","updated_at":"2018-03-02T20:44:31.295Z","actor":{"username":"willw","cleared":false,"url":"/willw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/612/0536a6a496faaf2bb96526e11da30023d4283ff9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":6693,"category":"researcher","content":"As soon as ssh.fr.cloud.gov was added to scope, I decided to test the server for security issues. Three SSH ports were open, so I checked the algorithms that were in use. I found that the server used RC4 for secure transmission and SHA1 for MAC addresses. These are algorithms for which attacks are known that are thousands of times faster than brute force.\nApparently this was the default configuration of cloud.gov's cloudfoundry installation. This was fixed by manually configuring AES, SHA2, and curve25516.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAs soon as ssh.fr.cloud.gov was added to scope, I decided to test the server for security issues. Three SSH ports were open, so I checked the algorithms that were in use. I found that the server used RC4 for secure transmission and SHA1 for MAC addresses. These are algorithms for which attacks are known that are thousands of times faster than brute force.\u003cbr\u003e\nApparently this was the default configuration of cloud.gov\u0026#39;s cloudfoundry installation. This was fixed by manually configuring AES, SHA2, and curve25516.\u003c/p\u003e\n"}]}