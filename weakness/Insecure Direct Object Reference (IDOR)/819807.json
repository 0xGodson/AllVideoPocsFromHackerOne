{"id":819807,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MTk4MDc=","url":"https://hackerone.com/reports/819807","title":"Missing ownership check on remote wipe endpoint","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-15T21:55:05.955Z","submitted_at":"2020-03-15T21:55:05.955Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hitman_47","url":"/hitman_47","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8154"],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-19T13:15:25.770Z","bug_reporter_agreed_on_going_public_at":"2020-03-20T13:15:24.064Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"On settings/user/security\n\nYou can mark a device for wipe out that does not belong to you.\n\nSteps:\n\n1. Create 2 accounts one for the hacker and one for the victim\n2. On both accounts add devices with different names\n3.  On the hacker account, while intercepting with burpsuite, select the option to wipe out a device\n4.  Forward with burpsuite and in the url that looks like settings/personal/authtokens/wipe/{data-id}, change the data-id to the id of the device of the victim\n5. Stop intercepting or forward again and the device of the victim will be marked for wipe out. \n\nHere is a video demo \n{F748890}\n\n## Impact\n\nAttacker can wipe out the device of another user by using the device ID","vulnerability_information_html":"\u003cp\u003eOn settings/user/security\u003c/p\u003e\n\n\u003cp\u003eYou can mark a device for wipe out that does not belong to you.\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate 2 accounts one for the hacker and one for the victim\u003c/li\u003e\n\u003cli\u003eOn both accounts add devices with different names\u003c/li\u003e\n\u003cli\u003e On the hacker account, while intercepting with burpsuite, select the option to wipe out a device\u003c/li\u003e\n\u003cli\u003e Forward with burpsuite and in the url that looks like settings/personal/authtokens/wipe/{data-id}, change the data-id to the id of the device of the victim\u003c/li\u003e\n\u003cli\u003eStop intercepting or forward again and the device of the victim will be marked for wipe out. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHere is a video demo \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"IDORNextCloud.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ghq1dGTeVsM2Xp5U4vMi1pUP?response-content-disposition=attachment%3B%20filename%3D%22IDORNextCloud.mp4%22%3B%20filename%2A%3DUTF-8%27%27IDORNextCloud.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065750Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=876865ec5227423e07cba03ed9c096a32672166cf5e3f5924ec3711a4a174eb7\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ghq1dGTeVsM2Xp5U4vMi1pUP?response-content-disposition=attachment%3B%20filename%3D%22IDORNextCloud.mp4%22%3B%20filename%2A%3DUTF-8%27%27IDORNextCloud.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065750Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=876865ec5227423e07cba03ed9c096a32672166cf5e3f5924ec3711a4a174eb7\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can wipe out the device of another user by using the device ID\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":748890,"file_name":"IDORNextCloud.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ghq1dGTeVsM2Xp5U4vMi1pUP?response-content-disposition=attachment%3B%20filename%3D%22IDORNextCloud.mp4%22%3B%20filename%2A%3DUTF-8%27%27IDORNextCloud.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065750Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=876865ec5227423e07cba03ed9c096a32672166cf5e3f5924ec3711a4a174eb7","file_size":6844992,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-04-19T13:15:24.116Z","allow_singular_disclosure_after":-21922946.7600275,"singular_disclosure_allowed":true,"vote_count":123,"voters":["jimmy-doe","r3b00t_","refu","secator","a_d_a_m","mik317","dipa996","what_web","its_afolic","b039f6018eb9056011859b0","and 113 more..."],"severity":{"rating":"high","score":7.7,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7323562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-15T21:55:06.232Z","updated_at":"2020-03-15T21:55:06.232Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7323605,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-15T22:11:14.348Z","updated_at":"2020-03-15T22:11:14.348Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":660111},"actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7325283,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Confirmed, thanks for the report","markdown_message":"\u003cp\u003eConfirmed, thanks for the report\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-16T07:47:41.760Z","updated_at":"2020-03-16T07:47:41.760Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7325342,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-16T08:05:01.748Z","updated_at":"2020-03-16T08:05:01.748Z","additional_data":{"old_severity":"High","new_severity":"High (7.7)","old_severity_id":660111,"new_severity_id":660291},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7325366,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are currently working on the patch and the following one seems to solve it:\n\n```diff\ndiff --git a/apps/settings/lib/Controller/AuthSettingsController.php b/apps/settings/lib/Controller/AuthSettingsController.php\nindex 7248127fd6..ccd1d370a1 100644\n--- a/apps/settings/lib/Controller/AuthSettingsController.php\n+++ b/apps/settings/lib/Controller/AuthSettingsController.php\n@@ -289,7 +289,7 @@ private function findTokenByIdAndUser(int $id): IToken {\n \t * @throws \\OC\\Authentication\\Exceptions\\ExpiredTokenException\n \t */\n \tpublic function wipe(int $id): JSONResponse {\n-\t\tif (!$this-\u003eremoteWipe-\u003emarkTokenForWipe($id)) {\n+\t\tif (!$this-\u003eremoteWipe-\u003emarkTokenForWipe($id, $this-\u003euid)) {\n \t\t\treturn new JSONResponse([], Http::STATUS_BAD_REQUEST);\n \t\t}\n \ndiff --git a/lib/private/Authentication/Token/RemoteWipe.php b/lib/private/Authentication/Token/RemoteWipe.php\nindex 2285ccd2cd..b3555203c6 100644\n--- a/lib/private/Authentication/Token/RemoteWipe.php\n+++ b/lib/private/Authentication/Token/RemoteWipe.php\n@@ -58,17 +58,17 @@ public function __construct(IProvider $tokenProvider,\n \n \t/**\n \t * @param int $id\n-\t *\n+\t * @param string $userId\n \t * @return bool\n \t *\n \t * @throws InvalidTokenException\n \t * @throws WipeTokenException\n \t * @throws ExpiredTokenException\n \t */\n-\tpublic function markTokenForWipe(int $id): bool {\n+\tpublic function markTokenForWipe(int $id, string $userId): bool {\n \t\t$token = $this-\u003etokenProvider-\u003egetTokenById($id);\n \n-\t\tif (!($token instanceof IWipeableToken)) {\n+\t\tif (!$token instanceof IWipeableToken || $token-\u003egetUID() !== $userId) {\n \t\t\treturn false;\n \t\t}\n \n```\n\nIn case you want to confirm it","markdown_message":"\u003cp\u003eWe are currently working on the patch and the following one seems to solve it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/apps/settings/lib/Controller/AuthSettingsController.php b/apps/settings/lib/Controller/AuthSettingsController.php\nindex 7248127fd6..ccd1d370a1 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/apps/settings/lib/Controller/AuthSettingsController.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/apps/settings/lib/Controller/AuthSettingsController.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -289,7 +289,7 @@\u003c/span\u003e private function findTokenByIdAndUser(int $id): IToken {\n     * @throws \\OC\\Authentication\\Exceptions\\ExpiredTokenException\n     */\n    public function wipe(int $id): JSONResponse {\n\u003cspan class=\"gd\"\u003e-       if (!$this-\u0026gt;remoteWipe-\u0026gt;markTokenForWipe($id)) {\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+       if (!$this-\u0026gt;remoteWipe-\u0026gt;markTokenForWipe($id, $this-\u0026gt;uid)) {\n\u003c/span\u003e            return new JSONResponse([], Http::STATUS_BAD_REQUEST);\n        }\n\ndiff --git a/lib/private/Authentication/Token/RemoteWipe.php b/lib/private/Authentication/Token/RemoteWipe.php\n\u003cspan class=\"gh\"\u003eindex 2285ccd2cd..b3555203c6 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/private/Authentication/Token/RemoteWipe.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/private/Authentication/Token/RemoteWipe.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -58,17 +58,17 @@\u003c/span\u003e public function __construct(IProvider $tokenProvider,\n\n    /**\n     * @param int $id\n\u003cspan class=\"gd\"\u003e-    *\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    * @param string $userId\n\u003c/span\u003e     * @return bool\n     *\n     * @throws InvalidTokenException\n     * @throws WipeTokenException\n     * @throws ExpiredTokenException\n     */\n\u003cspan class=\"gd\"\u003e-   public function markTokenForWipe(int $id): bool {\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+   public function markTokenForWipe(int $id, string $userId): bool {\n\u003c/span\u003e        $token = $this-\u0026gt;tokenProvider-\u0026gt;getTokenById($id);\n\n-       if (!($token instanceof IWipeableToken)) {\n\u003cspan class=\"gi\"\u003e+       if (!$token instanceof IWipeableToken || $token-\u0026gt;getUID() !== $userId) {\n\u003c/span\u003e            return false;\n        }\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn case you want to confirm it\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-16T08:06:40.435Z","updated_at":"2020-03-16T08:06:40.435Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7328633,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great!, thanks for the quick follow up","markdown_message":"\u003cp\u003eGreat!, thanks for the quick follow up\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-16T12:02:25.981Z","updated_at":"2020-03-16T12:02:25.981Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7347969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So I tested again and I can confirm this vulnerability has been patched. Great job on fixing it so quickly. ","markdown_message":"\u003cp\u003eSo I tested again and I can confirm this vulnerability has been patched. Great job on fixing it so quickly. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T21:43:48.637Z","updated_at":"2020-03-17T21:43:48.637Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7375092,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our next maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our next maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-03-20T07:52:00.258Z","updated_at":"2020-03-20T07:52:00.258Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hitman_47","url":"/hitman_47"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7375158,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-20T07:58:22.792Z","updated_at":"2020-03-20T07:58:22.792Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"hitman_47","url":"/hitman_47"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7377589,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you so much for the Bounty :). I can be credited as Tommy Suriel.","markdown_message":"\u003cp\u003eThank you so much for the Bounty :). I can be credited as Tommy Suriel.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T12:09:57.742Z","updated_at":"2020-03-20T12:09:57.742Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7377983,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can you disclose this report?","markdown_message":"\u003cp\u003eCan you disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T13:15:24.084Z","updated_at":"2020-03-20T13:15:24.084Z","first_to_agree":true,"actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378468,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will with the normal 4 weeks delay between release (monday) and disclosure (20th of april).\nTogether with an advisory on https://nextcloud.com/security/advisories and a CVE.\n\nCVE will be requested soon, the advisory will be published under the id 2020-018: https://nextcloud.com/security/advisory/?id=NC-SA-2020-018","markdown_message":"\u003cp\u003eWe will with the normal 4 weeks delay between release (monday) and disclosure (20th of april).\u003cbr\u003e\nTogether with an advisory on \u003ca title=\"https://nextcloud.com/security/advisories\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisories\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisories\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and a CVE.\u003c/p\u003e\n\n\u003cp\u003eCVE will be requested soon, the advisory will be published under the id 2020-018: \u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-018\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-018\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-018\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T14:18:46.388Z","updated_at":"2020-03-20T14:18:46.388Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7378482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect, I look forward to those releases. Thank you again. ","markdown_message":"\u003cp\u003ePerfect, I look forward to those releases. Thank you again. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-20T14:20:21.840Z","updated_at":"2020-03-20T14:20:52.482Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7714062,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-19T13:15:25.863Z","updated_at":"2020-04-19T13:15:25.863Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7748920,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T07:45:22.268Z","updated_at":"2020-04-22T07:45:22.268Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Desktop Client","new_scope":"nextcloud/server","genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7748941,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T07:47:25.994Z","updated_at":"2020-04-22T07:47:25.994Z","additional_data":{"old_title":"IDOR allows me to mark devices of another user for remote wipe out","new_title":"Missing ownership check on remote wipe endpoint"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}