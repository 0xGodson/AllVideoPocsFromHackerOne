{"id":788375,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODgzNzU=","url":"https://hackerone.com/reports/788375","title":"A user can view the name and number of a customer in another company if the GUID is known","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-02-03T17:32:51.135Z","submitted_at":"2020-02-03T17:32:51.135Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"spaceraccoon","url":"/spaceraccoon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":45331,"url":"https://hackerone.com/visma","handle":"visma","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/w8z2NGfiWDuCmJxS1RwwDtE5/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/w8z2NGfiWDuCmJxS1RwwDtE5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Visma Public","twitter_handle":"","website":"","about":"Visma delivers software that simplifies and digitizes core business processes in the private and public sector."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-27T12:20:09.359Z","bug_reporter_agreed_on_going_public_at":"2020-02-27T12:20:09.289Z","team_member_agreed_on_going_public_at":"2020-02-27T12:16:47.852Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":48,"voters":["kekkegenkai","daehee","tzrj","a_d_a_m","mashoud1122","base_64","prophet","enixium","johndoe1492","romesful","and 38 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":43522,"asset_type":"URL","asset_identifier":"eaccounting.stage.vismaonline.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6952500,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T17:35:37.503Z","updated_at":"2020-02-03T17:35:37.503Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6958553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-04T09:58:02.282Z","updated_at":"2020-02-04T09:58:02.282Z","actor":{"username":"daniel-visma","cleared":false,"url":"/daniel-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6958562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-04T09:59:11.108Z","updated_at":"2020-02-04T09:59:11.108Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6966110,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T07:52:23.245Z","updated_at":"2020-02-05T07:52:23.245Z","additional_data":{},"actor":{"username":"daniel-visma","cleared":false,"url":"/daniel-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6966215,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T08:14:25.806Z","updated_at":"2020-02-05T08:14:25.806Z","actor":{"username":"daniel-visma","cleared":false,"url":"/daniel-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6968867,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T11:36:09.333Z","updated_at":"2020-02-05T11:36:09.333Z","actor":{"url":"/visma","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/w8z2NGfiWDuCmJxS1RwwDtE5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Visma Public"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"visma","collaborator":{"username":"spaceraccoon","url":"/spaceraccoon"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6968895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T11:39:17.506Z","updated_at":"2020-02-05T11:39:17.506Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7163431,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T08:15:47.538Z","updated_at":"2020-02-27T08:15:47.538Z","actor":{"username":"daniel-visma","cleared":false,"url":"/daniel-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"spaceraccoon","url":"/spaceraccoon"},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165588,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:09:03.165Z","updated_at":"2020-02-27T12:09:03.165Z","additional_data":{},"actor":{"username":"martin-visma","cleared":false,"url":"/martin-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165649,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:16:47.882Z","updated_at":"2020-02-27T12:16:47.882Z","first_to_agree":true,"actor":{"username":"martin-visma","cleared":false,"url":"/martin-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165652,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:17:51.994Z","updated_at":"2020-02-27T12:17:51.994Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:18:38.886Z","updated_at":"2020-02-27T12:18:38.886Z","actor":{"username":"martin-visma","cleared":false,"url":"/martin-visma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165662,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:20:09.329Z","updated_at":"2020-02-27T12:20:09.329Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7165663,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T12:20:09.383Z","updated_at":"2020-02-27T12:20:09.383Z","actor":{"username":"spaceraccoon","cleared":true,"url":"/spaceraccoon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c5zYRQsvGPQP6MxHYYN4r5Jp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"visma","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20443,"category":"team","content":"An IDOR vulnerability exists in /api/internal/customerlabels/, allowing an attacker to add a label to a customer in a another company if he has previous knowledge about the UUID. The result is that the name and number of the customer is shown in the attackers context.\n\nAs all objects in the API are referenced by UUID (which is impossible to brute-force), IDOR attacks assume some prior knowledge of the UUID, such as a read-only user of a company who wants to execute write actions from their own company.\n\n__Steps To Reproduce:__\nAs victim, go to Customers and select a customer you want to be the victim. Take note of the UUID in the URL e.g. https://eaccounting.stage.vismaonline.com/#/sales/customer/01234567-890a-bcde-f012-34567890abcd\nAs attacker, go to Settings \u003e Customer Labels \u003e Add/Edit a label. Enter valid data, then intercept requests. Click Save. In the intercepted PUT /api/internal/customerlabels request, change the value of connectedCustomers to include the victim UUID. Forward; the request will succeed.\nAs attacker, edit the label again. The victim customer name and number, which were unknown previously, are now displayed.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAn IDOR vulnerability exists in /api/internal/customerlabels/, allowing an attacker to add a label to a customer in a another company if he has previous knowledge about the UUID. The result is that the name and number of the customer is shown in the attackers context.\u003c/p\u003e\n\n\u003cp\u003eAs all objects in the API are referenced by UUID (which is impossible to brute-force), IDOR attacks assume some prior knowledge of the UUID, such as a read-only user of a company who wants to execute write actions from their own company.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps To Reproduce:\u003c/strong\u003e\u003cbr\u003e\nAs victim, go to Customers and select a customer you want to be the victim. Take note of the UUID in the URL e.g. \u003ca title=\"https://eaccounting.stage.vismaonline.com/#/sales/customer/01234567-890a-bcde-f012-34567890abcd\" href=\"/redirect?url=https%3A%2F%2Feaccounting.stage.vismaonline.com%2F%23%2Fsales%2Fcustomer%2F01234567-890a-bcde-f012-34567890abcd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://eaccounting.stage.vismaonline.com/#/sales/customer/01234567-890a-bcde-f012-34567890abcd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nAs attacker, go to Settings \u0026gt; Customer Labels \u0026gt; Add/Edit a label. Enter valid data, then intercept requests. Click Save. In the intercepted PUT /api/internal/customerlabels request, change the value of connectedCustomers to include the victim UUID. Forward; the request will succeed.\u003cbr\u003e\nAs attacker, edit the label again. The victim customer name and number, which were unknown previously, are now displayed.\u003c/p\u003e\n"},{"id":20444,"category":"researcher","content":"The Visma team was quick to respond, triage, and reward. I appreciate Daniel and Martin's responsiveness that made reporting a seamless process.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe Visma team was quick to respond, triage, and reward. I appreciate Daniel and Martin\u0026#39;s responsiveness that made reporting a seamless process.\u003c/p\u003e\n"}]}