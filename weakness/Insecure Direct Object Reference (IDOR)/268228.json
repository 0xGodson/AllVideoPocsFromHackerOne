{"id":268228,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjgyMjg=","url":"https://hackerone.com/reports/268228","title":"A manager of a determinate group of users still might have access to any user account from any group that he doesn't administrate anymore.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-09-14T04:36:46.613Z","submitted_at":"2017-09-14T04:36:46.613Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chaosbolt","url":"/chaosbolt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-27T14:26:13.865Z","bug_reporter_agreed_on_going_public_at":"2017-12-27T14:26:13.782Z","team_member_agreed_on_going_public_at":"2017-12-27T14:23:24.311Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application: biz.mail.ru\n\nTesting environment: Lastest Chrome\n\nSteps to reproduce:\n\nOk, this one is pretty much depending on scenario, so lets assume that there is the Evil Manager exists with network knowledge on higher than medium level.\nAt first lets say that there is such role as \"Group administrator\" which is granted to us by Superadministrator. Same with this permission there are defined groups of users that this particular administrator able to administrate. \nLets assume that the Evil Manager got invite from our superviser to administrate group \"Cats\" and group \"Doggies\". There are users in each group with Id written directly in html-page (example in attachments below), so we can collect all the id's of all users from page code. Then after some time he got demoted and can not administrate group \"Doggies\" anymore. All users of \"Doggies\" group changed their passwords so the Evil Manager can not login with password that he set up for them when he was adding them to group as Group administrator. But the Evil Manager can still get access to user accounts from group \"Doggies\" by completing following steps:\n1. Go to Users \n2. Choose any user you can administrate\n3. Change his password via e-mail link, in \"email\" type your own mailbox.\n4. Modify POST request: in URI change userId(7-digit number goes after /users/) to userId from group that you do not administrate anymore;\nIn body Delete everything but \"id\" and \"email\", set \"Id\" to userId from step 4, set \"email\" to your own mailbox, send it to server.\n\nActual results\n--\nOn your own mailbox you will get link to choose new password for user that you dont have access to administrate. \n\nExpected results, security impact description and recommendations\n--\nI expected some error like \"Not Allowed\" which happens when you trying to edit data of Domain administrator when you are just a Group administrator.\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\nthere is a large .gif in attachments that shows everything (little delay between sending a request and receiving a message to email box, sorry for that)\n\n","vulnerability_information_html":"\u003cp\u003eDomain, site, application: biz.mail.ru\u003c/p\u003e\n\n\u003cp\u003eTesting environment: Lastest Chrome\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003cp\u003eOk, this one is pretty much depending on scenario, so lets assume that there is the Evil Manager exists with network knowledge on higher than medium level.\u003cbr\u003e\nAt first lets say that there is such role as \u0026quot;Group administrator\u0026quot; which is granted to us by Superadministrator. Same with this permission there are defined groups of users that this particular administrator able to administrate. \u003cbr\u003e\nLets assume that the Evil Manager got invite from our superviser to administrate group \u0026quot;Cats\u0026quot; and group \u0026quot;Doggies\u0026quot;. There are users in each group with Id written directly in html-page (example in attachments below), so we can collect all the id\u0026#39;s of all users from page code. Then after some time he got demoted and can not administrate group \u0026quot;Doggies\u0026quot; anymore. All users of \u0026quot;Doggies\u0026quot; group changed their passwords so the Evil Manager can not login with password that he set up for them when he was adding them to group as Group administrator. But the Evil Manager can still get access to user accounts from group \u0026quot;Doggies\u0026quot; by completing following steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to Users \u003c/li\u003e\n\u003cli\u003eChoose any user you can administrate\u003c/li\u003e\n\u003cli\u003eChange his password via e-mail link, in \u0026quot;email\u0026quot; type your own mailbox.\u003c/li\u003e\n\u003cli\u003eModify POST request: in URI change userId(7-digit number goes after /users/) to userId from group that you do not administrate anymore;\nIn body Delete everything but \u0026quot;id\u0026quot; and \u0026quot;email\u0026quot;, set \u0026quot;Id\u0026quot; to userId from step 4, set \u0026quot;email\u0026quot; to your own mailbox, send it to server.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"actual-results\"\u003eActual results\u003c/h2\u003e\n\n\u003cp\u003eOn your own mailbox you will get link to choose new password for user that you dont have access to administrate. \u003c/p\u003e\n\n\u003ch2 id=\"expected-results-security-impact-description-and-recommendations\"\u003eExpected results, security impact description and recommendations\u003c/h2\u003e\n\n\u003cp\u003eI expected some error like \u0026quot;Not Allowed\u0026quot; which happens when you trying to edit data of Domain administrator when you are just a Group administrator.\u003c/p\u003e\n\n\u003ch2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\"\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/h2\u003e\n\n\u003cp\u003ethere is a large .gif in attachments that shows everything (little delay between sending a request and receiving a message to email box, sorry for that)\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":102,"name":"Client-Side Enforcement of Server-Side Security"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":220775,"file_name":"id_collect.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/220/775/49b05761cef3854df87aeb741a2224118550231d/id_collect.jpg?response-content-disposition=attachment%3B%20filename%3D%22id_collect.jpg%22%3B%20filename%2A%3DUTF-8%27%27id_collect.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3BIZ4JTU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051759Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDCqQsLMvYqK8Fn0GTGiLsXz5M8tY4soJZygdoXv5QEQAIgCyKzbKJdYVXE7%2F2vaqKKjTCLEh%2Fh%2BJKa%2B0XuR0hsEFUqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDLR6kgVshwHIKyeb6iqRA2MFJpPkZrhx3t6AejIGud%2FxGIWTN2PoGCZioXicg1VZZgMq5uaPSAxNNXocaSomclyhf%2B4rJe2NLnNAFrXhEGbulvXBmkmO3c%2BD1qqEXyp6qcE41xoYCshBNytJdSH%2BZLTkpaCox4H3NJ6CH%2Bfflh7STpyLJOhPOuoFBY2ARN4mLdeBNYSs61C8zzgM1WQDBhFMxgMb7vKIJ1dmuPynnD4cKxw%2FWKOaq4NfJudL5XP2lTarTb4xTPf3vkoagtHONFoVfop3fmgabccyD5073szNTxXapdwAVZzs9R7zo8NryIyGlYETmxKma4s0cUHjxtmLxK48pLT0PIi7RZmyxoES3J9QTPpynp9iBtI5QalJxwB2tncxj9MMn9FCqJ1bzmYGaodAVxgE3jvslHp5jSM%2Fa1ljSf8SmNJrP91wkWRf4uVZMFej6WQDf8glru%2BoEB1%2FYut3mcF783rDVabhOcofZMw%2BHz6ACFg0WnuWtpGqDpIcX0PQQ%2FoYL%2BmsAiBEElGWlx6CHhWkYkEEJRUVb4ZXMK38qf8FOusBe7etUydbe6JZ8fKykaXtOPxCu8iTA%2FElzyhp13PbtTDj33DNPynSKOmKukTuY24fr3DCAPr5hsRSqBR1%2Ba8d9PI2IvIU4Avj2sJzGWzPQZqC0yDuDhW7b1Hlw1obEAxs3X5bDEbon1OT%2FNhVXLOjpX6Tgp0e%2FX9uw%2FNELi9ZDp%2F4R20Hnj3eXjNGpomDVtKhE43xUUHq1cwYK5VNgPoPIFeCXGybJOtMWcGWoFDEfI0CPBvkCnoRsX0aaemkRB8e4CYE0aYJNO%2BizSsaZzOxO9oeciDAN9toV%2BloBz7WYCb61lChRw6E6vCQyg%3D%3D\u0026X-Amz-Signature=308c2c489fec58d070de7295623968063c64ce31daf7d9633bf4e659a9159cd2","file_size":392381,"type":"image/jpeg"},{"id":220776,"file_name":"accesstouserswhichwecantadministrate.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/220/776/5bf98426f0d04acf7d153135af4075135b58ecf8/accesstouserswhichwecantadministrate.gif?response-content-disposition=attachment%3B%20filename%3D%22accesstouserswhichwecantadministrate.gif%22%3B%20filename%2A%3DUTF-8%27%27accesstouserswhichwecantadministrate.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3BIZ4JTU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051759Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDCqQsLMvYqK8Fn0GTGiLsXz5M8tY4soJZygdoXv5QEQAIgCyKzbKJdYVXE7%2F2vaqKKjTCLEh%2Fh%2BJKa%2B0XuR0hsEFUqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDLR6kgVshwHIKyeb6iqRA2MFJpPkZrhx3t6AejIGud%2FxGIWTN2PoGCZioXicg1VZZgMq5uaPSAxNNXocaSomclyhf%2B4rJe2NLnNAFrXhEGbulvXBmkmO3c%2BD1qqEXyp6qcE41xoYCshBNytJdSH%2BZLTkpaCox4H3NJ6CH%2Bfflh7STpyLJOhPOuoFBY2ARN4mLdeBNYSs61C8zzgM1WQDBhFMxgMb7vKIJ1dmuPynnD4cKxw%2FWKOaq4NfJudL5XP2lTarTb4xTPf3vkoagtHONFoVfop3fmgabccyD5073szNTxXapdwAVZzs9R7zo8NryIyGlYETmxKma4s0cUHjxtmLxK48pLT0PIi7RZmyxoES3J9QTPpynp9iBtI5QalJxwB2tncxj9MMn9FCqJ1bzmYGaodAVxgE3jvslHp5jSM%2Fa1ljSf8SmNJrP91wkWRf4uVZMFej6WQDf8glru%2BoEB1%2FYut3mcF783rDVabhOcofZMw%2BHz6ACFg0WnuWtpGqDpIcX0PQQ%2FoYL%2BmsAiBEElGWlx6CHhWkYkEEJRUVb4ZXMK38qf8FOusBe7etUydbe6JZ8fKykaXtOPxCu8iTA%2FElzyhp13PbtTDj33DNPynSKOmKukTuY24fr3DCAPr5hsRSqBR1%2Ba8d9PI2IvIU4Avj2sJzGWzPQZqC0yDuDhW7b1Hlw1obEAxs3X5bDEbon1OT%2FNhVXLOjpX6Tgp0e%2FX9uw%2FNELi9ZDp%2F4R20Hnj3eXjNGpomDVtKhE43xUUHq1cwYK5VNgPoPIFeCXGybJOtMWcGWoFDEfI0CPBvkCnoRsX0aaemkRB8e4CYE0aYJNO%2BizSsaZzOxO9oeciDAN9toV%2BloBz7WYCb61lChRw6E6vCQyg%3D%3D\u0026X-Amz-Signature=136ff193bb922c47509a9cb22500bf9baeead563dbc8bdfd0d0b08e5a4d89699","file_size":15819078,"type":"image/gif"}],"allow_singular_disclosure_at":"2018-01-26T14:23:24.400Z","allow_singular_disclosure_after":-92242474.92725797,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","r3y","khizer47","cr4xerbik4sh","fantam1","3apa3a","when_im_sad","socal_steven"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":250,"asset_type":"URL","asset_identifier":"biz.mail.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1996280,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T09:19:23.066Z","updated_at":"2017-09-14T09:19:23.066Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1996283,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-14T09:20:39.259Z","updated_at":"2018-02-28T13:11:23.989Z","additional_data":{"added_weaknesses":[{"id":102,"name":"Client-Side Enforcement of Server-Side Security"}],"removed_weaknesses":[{"id":55,"name":"Insecure Direct Object Reference (IDOR)"}]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2008481,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T12:33:52.911Z","updated_at":"2017-09-20T12:33:52.911Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"chaosbolt","url":"/chaosbolt"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2043412,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","markdown_message":"\u003cp\u003eThis bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-04T14:37:13.989Z","updated_at":"2017-10-04T14:37:13.989Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chaosbolt","url":"/chaosbolt"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2045482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed","markdown_message":"\u003cp\u003eConfirmed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T10:02:00.640Z","updated_at":"2017-10-05T10:02:49.074Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248418,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T14:23:24.342Z","updated_at":"2017-12-27T14:23:24.342Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2248425,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T14:26:13.813Z","updated_at":"2017-12-27T14:26:13.813Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248426,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T14:26:13.897Z","updated_at":"2017-12-27T14:26:13.897Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6176,"category":"team","content":"Privilege escalation bug in biz.mail.ru web interface allowed user with group manager rights to manage users from different groups of the same organization due to missed server side check.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ePrivilege escalation bug in biz.mail.ru web interface allowed user with group manager rights to manage users from different groups of the same organization due to missed server side check.\u003c/p\u003e\n"},{"id":6247,"category":"researcher","content":"Unauthorized access to actions that shouldn't be accessible for a user via changing parameters directly in http request","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eUnauthorized access to actions that shouldn\u0026#39;t be accessible for a user via changing parameters directly in http request\u003c/p\u003e\n"}]}