{"id":145745,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU3NDU=","url":"https://hackerone.com/reports/145745","title":"Business/Functional logic bypass: Remove admins from admin group.","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-18T18:48:23.878Z","submitted_at":"2016-06-18T18:48:23.878Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paglababa","url":"/paglababa","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-19T12:43:16.017Z","bug_reporter_agreed_on_going_public_at":"2016-06-18T19:52:45.029Z","team_member_agreed_on_going_public_at":"2016-06-19T12:43:15.923Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In nextcloud the default admin can not be removed from his admin group. The group toggle request looks like this:\n\n```\nPOST /nextcloud/index.php/settings/ajax/togglegroups.php HTTP/1.1\nHost: 139.59.9.184\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: JQB5F2pqZwh8OUNVRzwVPxdmKCEbJDssbAUcORtfTVM=:bIHyZZPyIV67tsLPsWgrxCInGdOC40f2yD61Qn4HrTw=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nCookie: oc1jzqgvx8b9=e6gprie4u2ffkq83ivm68ccp80; oc_sessionPassphrase=BL2ccA7kLG%2FpxKWf5znZSBLWSvARKK%2Bv3oLuCFyGd8a5SAqPeeBjIaD88AVnwnMS8ompIL7tN45YiZeeODdFHyPBYZrZAavWsHJqMKZdvU3U6eZUW%2FHCGLMd62y6ty7P; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\nConnection: close\nContent-Length: 25\n\nusername=test\u0026group=test\n```\n\nIf we use **admin** as the value of username and **admin ** as the value of group ( admin with a trailing space), the admin will be removed from the admin group.\n\n","vulnerability_information_html":"\u003cp\u003eIn nextcloud the default admin can not be removed from his admin group. The group toggle request looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /nextcloud/index.php/settings/ajax/togglegroups.php HTTP/1.1\nHost: 139.59.9.184\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: JQB5F2pqZwh8OUNVRzwVPxdmKCEbJDssbAUcORtfTVM=:bIHyZZPyIV67tsLPsWgrxCInGdOC40f2yD61Qn4HrTw=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nCookie: oc1jzqgvx8b9=e6gprie4u2ffkq83ivm68ccp80; oc_sessionPassphrase=BL2ccA7kLG%2FpxKWf5znZSBLWSvARKK%2Bv3oLuCFyGd8a5SAqPeeBjIaD88AVnwnMS8ompIL7tN45YiZeeODdFHyPBYZrZAavWsHJqMKZdvU3U6eZUW%2FHCGLMd62y6ty7P; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\nConnection: close\nContent-Length: 25\n\nusername=test\u0026amp;group=test\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf we use \u003cstrong\u003eadmin\u003c/strong\u003e as the value of username and *\u003cem\u003eadmin *\u003c/em\u003e as the value of group ( admin with a trailing space), the admin will be removed from the admin group.\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["siddiki","noob1234","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1022699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-18T18:48:24.225Z","updated_at":"2016-06-18T18:48:24.225Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1022708,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Removing an admin from the admin group should be possible for other admins but not for group admins.\n\nWhat is blocked in the user interface is the ability for admins to remove themselves from the admin section.\n\nI'm thus closing this as informative. If you figure out a creative way to exploit this, please let us know and we'll happily reopen this :)","markdown_message":"\u003cp\u003eThanks a lot for your report. Removing an admin from the admin group should be possible for other admins but not for group admins.\u003c/p\u003e\n\n\u003cp\u003eWhat is blocked in the user interface is the ability for admins to remove themselves from the admin section.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m thus closing this as informative. If you figure out a creative way to exploit this, please let us know and we\u0026#39;ll happily reopen this :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-18T18:56:41.766Z","updated_at":"2016-06-18T18:56:41.766Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1022711,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"*What is blocked in the user interface is the ability for admins to remove themselves from the admin section*\n\nAn admin can not remove himself from the admin group and this is not just blocked in the ui. There is server side restriction also. Thats why when an admin submits the following request:\n```http\nPOST /nextcloud/index.php/settings/ajax/togglegroups.php HTTP/1.1\nHost: 139.59.9.184\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: NgteIVtTXhhcQBgacR8LOQNXeAksCRVtZRB4LnY6eRY=:qBoOkciii/mxBPRVgf7ZOng/Nq+TYURwo8LFicyxGsw=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nContent-Length: 26\nCookie: oc1jzqgvx8b9=e6gprie4u2ffkq83ivm68ccp80; oc_sessionPassphrase=BL2ccA7kLG%2FpxKWf5znZSBLWSvARKK%2Bv3oLuCFyGd8a5SAqPeeBjIaD88AVnwnMS8ompIL7tN45YiZeeODdFHyPBYZrZAavWsHJqMKZdvU3U6eZUW%2FHCGLMd62y6ty7P; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\nConnection: close\n\nusername=admin\u0026group=admin\n```\n\nIn the response he receives:\n\n```http\nHTTP/1.1 200 OK\nDate: Sat, 18 Jun 2016 18:59:10 GMT\nServer: Apache/2.4.7 (Ubuntu)\nX-Powered-By: PHP/5.5.9-1ubuntu4.14\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nPragma: no-cache\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; frame-src *; img-src * data: blob:; font-src 'self' data:; media-src *; connect-src *\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Frame-Options: Sameorigin\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nContent-Length: 89\nConnection: close\nContent-Type: application/json; charset=utf-8\n\n{\"data\":{\"message\":\"Admins can't remove themself from the admin group\"},\"status\":\"error\"}\n```\n\nHere is the bypass of this feature, when `admin ` (with trailing whitespace) is submitted to the server, the server assumes it different thn `admin` (without whitespace) but process the request as `admin` group. As a result a malformed (admin with trailing whitespace) will return this:\n\n```http\nHTTP/1.1 200 OK\nDate: Sat, 18 Jun 2016 19:01:19 GMT\nServer: Apache/2.4.7 (Ubuntu)\nX-Powered-By: PHP/5.5.9-1ubuntu4.14\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nPragma: no-cache\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; frame-src *; img-src * data: blob:; font-src 'self' data:; media-src *; connect-src *\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Frame-Options: Sameorigin\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nContent-Length: 87\nConnection: close\nContent-Type: application/json; charset=utf-8\n\n{\"data\":{\"username\":\"admin\",\"action\":\"remove\",\"groupname\":\"admin \"},\"status\":\"success\"}\n```\n\n\nThis is a solid bypass of a application security feature. Rest depends on your decision.","markdown_message":"\u003cp\u003e\u003cem\u003eWhat is blocked in the user interface is the ability for admins to remove themselves from the admin section\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eAn admin can not remove himself from the admin group and this is not just blocked in the ui. There is server side restriction also. Thats why when an admin submits the following request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/nextcloud/index.php/settings/ajax/togglegroups.php\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e139.59.9.184\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e*/*\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003erequesttoken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eNgteIVtTXhhcQBgacR8LOQNXeAksCRVtZRB4LnY6eRY=:qBoOkciii/mxBPRVgf7ZOng/Nq+TYURwo8LFicyxGsw=\u003c/span\u003e\n\u003cspan class=\"na\"\u003eOCS-APIREQUEST\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e26\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eoc1jzqgvx8b9=e6gprie4u2ffkq83ivm68ccp80; oc_sessionPassphrase=BL2ccA7kLG%2FpxKWf5znZSBLWSvARKK%2Bv3oLuCFyGd8a5SAqPeeBjIaD88AVnwnMS8ompIL7tN45YiZeeODdFHyPBYZrZAavWsHJqMKZdvU3U6eZUW%2FHCGLMd62y6ty7P; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\nusername=admin\u0026amp;group=admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn the response he receives:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"ne\"\u003eOK\u003c/span\u003e\n\u003cspan class=\"na\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eSat, 18 Jun 2016 18:59:10 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eApache/2.4.7 (Ubuntu)\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Powered-By\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ePHP/5.5.9-1ubuntu4.14\u003c/span\u003e\n\u003cspan class=\"na\"\u003eExpires\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eThu, 19 Nov 1981 08:52:00 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCache-Control\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-store, no-cache, must-revalidate, post-check=0, pre-check=0\u003c/span\u003e\n\u003cspan class=\"na\"\u003ePragma\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-cache\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003edefault-src \u0026#39;self\u0026#39;; script-src \u0026#39;self\u0026#39; \u0026#39;unsafe-eval\u0026#39;; style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;; frame-src *; img-src * data: blob:; font-src \u0026#39;self\u0026#39; data:; media-src *; connect-src *\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-XSS-Protection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e1; mode=block\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Content-Type-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enosniff\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Frame-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eSameorigin\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Robots-Tag\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Download-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enoopen\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Permitted-Cross-Domain-Policies\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e89\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json; charset=utf-8\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;message\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Admins can\u0026#39;t remove themself from the admin group\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;status\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;error\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere is the bypass of this feature, when \u003ccode\u003eadmin\u003c/code\u003e (with trailing whitespace) is submitted to the server, the server assumes it different thn \u003ccode\u003eadmin\u003c/code\u003e (without whitespace) but process the request as \u003ccode\u003eadmin\u003c/code\u003e group. As a result a malformed (admin with trailing whitespace) will return this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"ne\"\u003eOK\u003c/span\u003e\n\u003cspan class=\"na\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eSat, 18 Jun 2016 19:01:19 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eApache/2.4.7 (Ubuntu)\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Powered-By\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ePHP/5.5.9-1ubuntu4.14\u003c/span\u003e\n\u003cspan class=\"na\"\u003eExpires\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eThu, 19 Nov 1981 08:52:00 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCache-Control\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-store, no-cache, must-revalidate, post-check=0, pre-check=0\u003c/span\u003e\n\u003cspan class=\"na\"\u003ePragma\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-cache\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003edefault-src \u0026#39;self\u0026#39;; script-src \u0026#39;self\u0026#39; \u0026#39;unsafe-eval\u0026#39;; style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;; frame-src *; img-src * data: blob:; font-src \u0026#39;self\u0026#39; data:; media-src *; connect-src *\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-XSS-Protection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e1; mode=block\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Content-Type-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enosniff\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Frame-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eSameorigin\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Robots-Tag\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Download-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enoopen\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Permitted-Cross-Domain-Policies\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e87\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json; charset=utf-8\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;admin\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;action\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;remove\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;groupname\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;admin \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;status\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;success\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is a solid bypass of a application security feature. Rest depends on your decision.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-18T19:02:07.079Z","updated_at":"2016-06-18T19:02:07.079Z","actor":{"username":"paglababa","cleared":false,"url":"/paglababa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1022737,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You should have mentioned that any vulnerability related to \"admin\" group user will be disregarded. As because an admin can do RCE, he can do anything. ","markdown_message":"\u003cp\u003eYou should have mentioned that any vulnerability related to \u0026quot;admin\u0026quot; group user will be disregarded. As because an admin can do RCE, he can do anything. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-18T19:52:45.078Z","updated_at":"2016-06-18T19:52:45.078Z","first_to_agree":true,"actor":{"username":"paglababa","cleared":false,"url":"/paglababa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1023190,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any decision on this yet?","markdown_message":"\u003cp\u003eAny decision on this yet?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-19T11:30:21.419Z","updated_at":"2016-06-19T11:30:21.419Z","actor":{"username":"paglababa","cleared":false,"url":"/paglababa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1023263,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Generally speaking we're happy to disclose all reported issues, so are we with this.\n\nWe want to note the following however:\n\n\u003e You should have mentioned that any vulnerability related to \"admin\" group user will be disregarded. \n\nHere we disagree with using the term \"vulnerability\". If we take the definition of the word \"vulnerability\" from https://en.wikipedia.org/wiki/Vulnerability_(computing)#Definitions the general consensus is that a vulnerability is something that allows somebody to escalate their permission.\n\nHackerOne defines a vulnerability in their [Disclosure Guidelines](https://hackerone.com/disclosure-guidelines) the following:\n\n\u003e **Vulnerability:** A software bug that would allow an attacker to perform an action in violation of an expressed security policy. *A bug that enables escalated access or privilege is a vulnerability.* Design flaws and failures to adhere to security best practices may qualify as vulnerabilities. Weaknesses exploited by viruses, malicious code, and social engineering are not considered vulnerabilities unless the Security Team says otherwise in the program's policy.\n\nOur belief is that that this specific issue may qualify as regular functional bug but not as vulnerability per se. As per our [threat model](https://nextcloud.com/security/threat-model/) (which is [tracked in Git](https://github.com/nextcloud/nextcloud.com/blob/master/page-threat-model.php)) an administrator is considered an ultimate trusted unit. \n\nConsidering that administrators can for example execute arbitrary code by applying some theming settings, mounting local storage and so on this is simply not part of our documented threat model.\n\n--- \nAnyhow, we'd like to thank you for reporting this back to us. We hope our response didn't disappoint you and we're looking forward to your next submission.","markdown_message":"\u003cp\u003eGenerally speaking we\u0026#39;re happy to disclose all reported issues, so are we with this.\u003c/p\u003e\n\n\u003cp\u003eWe want to note the following however:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eYou should have mentioned that any vulnerability related to \u0026quot;admin\u0026quot; group user will be disregarded. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eHere we disagree with using the term \u0026quot;vulnerability\u0026quot;. If we take the definition of the word \u0026quot;vulnerability\u0026quot; from \u003ca title=\"https://en.wikipedia.org/wiki/Vulnerability_(computing)#Definitions\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FVulnerability_%28computing%29%23Definitions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Vulnerability_(computing)#Definitions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the general consensus is that a vulnerability is something that allows somebody to escalate their permission.\u003c/p\u003e\n\n\u003cp\u003eHackerOne defines a vulnerability in their \u003ca href=\"https://hackerone.com/disclosure-guidelines\"\u003eDisclosure Guidelines\u003c/a\u003e the following:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eVulnerability:\u003c/strong\u003e A software bug that would allow an attacker to perform an action in violation of an expressed security policy. \u003cem\u003eA bug that enables escalated access or privilege is a vulnerability.\u003c/em\u003e Design flaws and failures to adhere to security best practices may qualify as vulnerabilities. Weaknesses exploited by viruses, malicious code, and social engineering are not considered vulnerabilities unless the Security Team says otherwise in the program\u0026#39;s policy.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eOur belief is that that this specific issue may qualify as regular functional bug but not as vulnerability per se. As per our \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethreat model\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (which is \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fnextcloud.com%2Fblob%2Fmaster%2Fpage-threat-model.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etracked in Git\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) an administrator is considered an ultimate trusted unit. \u003c/p\u003e\n\n\u003cp\u003eConsidering that administrators can for example execute arbitrary code by applying some theming settings, mounting local storage and so on this is simply not part of our documented threat model.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eAnyhow, we\u0026#39;d like to thank you for reporting this back to us. We hope our response didn\u0026#39;t disappoint you and we\u0026#39;re looking forward to your next submission.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-19T12:43:15.970Z","updated_at":"2016-06-19T12:43:15.970Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1023264,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-19T12:43:16.037Z","updated_at":"2016-06-19T12:43:16.037Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}