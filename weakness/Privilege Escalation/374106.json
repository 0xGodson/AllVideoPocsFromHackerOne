{"id":374106,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzQxMDY=","url":"https://hackerone.com/reports/374106","title":"Lack of quarantine meta-attribute for downloaded files leads to GateKeeper bypass","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-06-30T01:04:45.729Z","submitted_at":"2018-06-30T01:04:45.729Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-12T16:34:06.053Z","bug_reporter_agreed_on_going_public_at":"2019-09-11T20:12:51.328Z","team_member_agreed_on_going_public_at":"2019-09-12T16:34:05.922Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nExecutable files downloaded through Brave don't have quarantine attribute. \nThat means it's possible to launch any executable bypassing codesigning + quarantine.\n\nHowever, later I found that Brave has already [tracked similar report](https://github.com/brave/browser-laptop/issues/13088) but only in the context of `.pkg` files. \n\nAdditionally, Brave is allowed to run apps in Terminal. It was already shown in [369185](https://hackerone.com/reports/369185) that Brave has more permissions on Terminal than it should have =\u003e It is possible to execute downloaded files in Terminal by click(double click) in Brave \"Downloads\" toolbar.\n\nmacOS doesn't have executable files that could be launched without installation after downloading from the web. Files like `.command` and `.tool` could be executed in Terminal and only if they have `-x`, but these files downloaded from the web have only `-rw`.\n\nHowever, it's possible to download and launch Java archives, because they're archives =\u003e executable after downloading.\n\n\u003e As far as I know, Java isn't installed by default. That means only macOS users with Java installed are affected by this problem.\n\n## Products affected: \n\nBrave: 0.23.19 \nV8: 6.7.288.46 \nrev: 178c3fbc045a0cbdbe098db08307503cce952081 \nMuon: 7.1.3 \nOS Release: 17.6.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nTor: 0.3.3.7 (git-035a35178c92da94) \nBrave Sync: v1.4.2 \nlibchromiumcontent: 67.0.3396.87\n\n## Steps To Reproduce:\n\n### Chrome/\u003cetc\u003e\n\n#### Apps from unknown publishers disallowed (screencast):\n\nDownload `test.jar` using Chrome -\u003e launch it from Downloads toolbar -\u003e macOS warns that this executable published by an unknown developer -\u003e manually allow running the app from Settings-\u003e app launches.\n\n#### Apps from anywhere allowed:\n\nDownload `test.jar` using Chrome -\u003e launch it from Downloads toolbar -\u003e macOS warns that this Java archive was downloaded from the web  -\u003e allow -\u003e app launches.\n\n#### Apps from anywhere + downloaded executables allowed:\n\nDownload `test.jar` using Chrome -\u003e launch it from Downloads toolbar -\u003e macOS warns that Chrome can't run files in Terminal.\n\n### Brave (unknown publishers disallowed, screencast)\n\nDownload `test.jar` using Brave -\u003e launch it from Downloads toolbar (double click) -\u003e no warnings, Java archive launches.\n\n## Supporting Material/References:\n\n[Live PoC + jar + screencast](https://brave-jar-nqzdybbsgw.now.sh/)\n\n## Impact\n\n\u003e Java isn't installed on macOS by default (as I know), that's why it's not critical.\n\nUsers with installed Java could run any downloaded through Brave java archive from Downloads toolbar bypassing quarantine + code-signing checks in one click (double click).\n\nI think this isn't a duplicate, because this attack scenario leverages two vulnerabilities (quarantine + Brave permissions over Terminal).\n\n\u003e The fact that downloaded files aren't in quarantine by itself doesn't show that it's possible to execute any app by click. However, Brave's permissions over Terminal introduce that.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eExecutable files downloaded through Brave don\u0026#39;t have quarantine attribute. \u003cbr\u003e\nThat means it\u0026#39;s possible to launch any executable bypassing codesigning + quarantine.\u003c/p\u003e\n\n\u003cp\u003eHowever, later I found that Brave has already \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F13088\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etracked similar report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e but only in the context of \u003ccode\u003e.pkg\u003c/code\u003e files. \u003c/p\u003e\n\n\u003cp\u003eAdditionally, Brave is allowed to run apps in Terminal. It was already shown in \u003ca href=\"https://hackerone.com/reports/369185\"\u003e369185\u003c/a\u003e that Brave has more permissions on Terminal than it should have =\u0026gt; It is possible to execute downloaded files in Terminal by click(double click) in Brave \u0026quot;Downloads\u0026quot; toolbar.\u003c/p\u003e\n\n\u003cp\u003emacOS doesn\u0026#39;t have executable files that could be launched without installation after downloading from the web. Files like \u003ccode\u003e.command\u003c/code\u003e and \u003ccode\u003e.tool\u003c/code\u003e could be executed in Terminal and only if they have \u003ccode\u003e-x\u003c/code\u003e, but these files downloaded from the web have only \u003ccode\u003e-rw\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eHowever, it\u0026#39;s possible to download and launch Java archives, because they\u0026#39;re archives =\u0026gt; executable after downloading.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAs far as I know, Java isn\u0026#39;t installed by default. That means only macOS users with Java installed are affected by this problem.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.23.19 \u003cbr\u003e\nV8: 6.7.288.46 \u003cbr\u003e\nrev: 178c3fbc045a0cbdbe098db08307503cce952081 \u003cbr\u003e\nMuon: 7.1.3 \u003cbr\u003e\nOS Release: 17.6.0 \u003cbr\u003e\nUpdate Channel: Release \u003cbr\u003e\nOS Architecture: x64 \u003cbr\u003e\nOS Platform: macOS \u003cbr\u003e\nNode.js: 7.9.0 \u003cbr\u003e\nTor: 0.3.3.7 (git-035a35178c92da94) \u003cbr\u003e\nBrave Sync: v1.4.2 \u003cbr\u003e\nlibchromiumcontent: 67.0.3396.87\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003ch3 id=\"chrome-etc\"\u003eChrome/\u0026lt;etc\u0026gt;\u003c/h3\u003e\n\n\u003ch4 id=\"apps-from-unknown-publishers-disallowed-screencast\"\u003eApps from unknown publishers disallowed (screencast):\u003c/h4\u003e\n\n\u003cp\u003eDownload \u003ccode\u003etest.jar\u003c/code\u003e using Chrome -\u0026gt; launch it from Downloads toolbar -\u0026gt; macOS warns that this executable published by an unknown developer -\u0026gt; manually allow running the app from Settings-\u0026gt; app launches.\u003c/p\u003e\n\n\u003ch4 id=\"apps-from-anywhere-allowed\"\u003eApps from anywhere allowed:\u003c/h4\u003e\n\n\u003cp\u003eDownload \u003ccode\u003etest.jar\u003c/code\u003e using Chrome -\u0026gt; launch it from Downloads toolbar -\u0026gt; macOS warns that this Java archive was downloaded from the web  -\u0026gt; allow -\u0026gt; app launches.\u003c/p\u003e\n\n\u003ch4 id=\"apps-from-anywhere-downloaded-executables-allowed\"\u003eApps from anywhere + downloaded executables allowed:\u003c/h4\u003e\n\n\u003cp\u003eDownload \u003ccode\u003etest.jar\u003c/code\u003e using Chrome -\u0026gt; launch it from Downloads toolbar -\u0026gt; macOS warns that Chrome can\u0026#39;t run files in Terminal.\u003c/p\u003e\n\n\u003ch3 id=\"brave-unknown-publishers-disallowed-screencast\"\u003eBrave (unknown publishers disallowed, screencast)\u003c/h3\u003e\n\n\u003cp\u003eDownload \u003ccode\u003etest.jar\u003c/code\u003e using Brave -\u0026gt; launch it from Downloads toolbar (double click) -\u0026gt; no warnings, Java archive launches.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fbrave-jar-nqzdybbsgw.now.sh%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLive PoC + jar + screencast\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eJava isn\u0026#39;t installed on macOS by default (as I know), that\u0026#39;s why it\u0026#39;s not critical.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eUsers with installed Java could run any downloaded through Brave java archive from Downloads toolbar bypassing quarantine + code-signing checks in one click (double click).\u003c/p\u003e\n\n\u003cp\u003eI think this isn\u0026#39;t a duplicate, because this attack scenario leverages two vulnerabilities (quarantine + Brave permissions over Terminal).\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe fact that downloaded files aren\u0026#39;t in quarantine by itself doesn\u0026#39;t show that it\u0026#39;s possible to execute any app by click. However, Brave\u0026#39;s permissions over Terminal introduce that.\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":313860,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/313/860/7ef45526f8ae460eaf0cb2c73313efbf71c306de/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=d28945a70f2b0aafabb1142e44224f1ed113cb2f63fdf211c3be1eba65933324","file_size":90,"type":"text/html"},{"id":313861,"file_name":"brave-jar.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/313/861/4c363bf0f0f2e24c6c1b99810d5046dd35b237f7/brave-jar.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-jar.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-jar.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=caf416ed7c984455801a8e9c5456c3baf5984ee28bfcbe8d449e82aef38965e0","file_size":426135,"type":"video/mp4"},{"id":313862,"file_name":"hello.jar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/313/862/59c61826b3bfd04064cba4166af483fe1910fe10/hello.jar?response-content-disposition=attachment%3B%20filename%3D%22hello.jar%22%3B%20filename%2A%3DUTF-8%27%27hello.jar\u0026response-content-type=application%2Fjava-archive\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=9c789d302452fb1af4fa0dc8faf11c0588ced49686d392cf251752332d22cb7e","file_size":847,"type":"application/java-archive"}],"allow_singular_disclosure_at":null,"vote_count":51,"voters":["m0chan","sameerphad72","metnew","mygf","eveeez","hodkasia_sachin","cyberunit","exception","codeanddecode","cryptographer","and 41 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2960860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Typo: on Terminal -\u003e over Terminal","markdown_message":"\u003cp\u003eTypo: on Terminal -\u0026gt; over Terminal\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T01:06:09.013Z","updated_at":"2018-06-30T01:06:09.013Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2963270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Also, download of binary files could be initiated using `\u003ciframe src=\"path/to/binary\"\u003e\u003c/iframe\u003e`","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eAlso, download of binary files could be initiated using \u003ccode\u003e\u0026lt;iframe src=\u0026quot;path/to/binary\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-06-30T06:05:15.837Z","updated_at":"2018-06-30T06:05:15.837Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2965871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Apps from anywhere + downloaded executables allowed:\n\nThis case probably needs some explanation. \"Downloaded executables allowed\" - that means the downloaded file is marked as executable. You could reproduce this case by adding `+x` to the file and trying to run it from Chrome.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eApps from anywhere + downloaded executables allowed:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis case probably needs some explanation. \u0026quot;Downloaded executables allowed\u0026quot; - that means the downloaded file is marked as executable. You could reproduce this case by adding \u003ccode\u003e+x\u003c/code\u003e to the file and trying to run it from Chrome.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T11:36:41.221Z","updated_at":"2018-06-30T11:36:41.221Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2967002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**UPD:** I've accidentally made few incorrect suggestions in the report:\n### `.jar`\nI said that the problem is that Brave has more permissions over **Terminal** than it should have. That's not so correct. The actual problem is that **Brave has permission to open executables in their default handlers**.\n\nBecause `.jar` isn't handled by Terminal on macOS. \n\nAlso, typo in \"Apps from anywhere + downloaded executables allowed\" section:  \"macOS warns that Chrome can't **open Java archives**\".\n\n### `#369185`\nThis bug (probably) isn't connected to #369185. #369185 only pointed me to this problem.\n\n### Title\n\nMaybe changing the title to \"Brave has permission to open executables in their default handlers\" would be more descriptive.","markdown_message":"\u003cp\u003e\u003cstrong\u003eUPD:\u003c/strong\u003e I\u0026#39;ve accidentally made few incorrect suggestions in the report:\u003c/p\u003e\n\n\u003ch3 id=\"jar\"\u003e\u003ccode\u003e.jar\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eI said that the problem is that Brave has more permissions over \u003cstrong\u003eTerminal\u003c/strong\u003e than it should have. That\u0026#39;s not so correct. The actual problem is that \u003cstrong\u003eBrave has permission to open executables in their default handlers\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eBecause \u003ccode\u003e.jar\u003c/code\u003e isn\u0026#39;t handled by Terminal on macOS. \u003c/p\u003e\n\n\u003cp\u003eAlso, typo in \u0026quot;Apps from anywhere + downloaded executables allowed\u0026quot; section:  \u0026quot;macOS warns that Chrome can\u0026#39;t \u003cstrong\u003eopen Java archives\u003c/strong\u003e\u0026quot;.\u003c/p\u003e\n\n\u003ch3 id=\"369185\"\u003e\u003ccode\u003e#369185\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eThis bug (probably) isn\u0026#39;t connected to \u003ca href=\"/reports/369185\"\u003e#369185\u003c/a\u003e. \u003ca href=\"/reports/369185\"\u003e#369185\u003c/a\u003e only pointed me to this problem.\u003c/p\u003e\n\n\u003ch3 id=\"title\"\u003eTitle\u003c/h3\u003e\n\n\u003cp\u003eMaybe changing the title to \u0026quot;Brave has permission to open executables in their default handlers\u0026quot; would be more descriptive.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T02:19:34.673Z","updated_at":"2018-07-01T02:19:34.673Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2968469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e sorry, mistake in the comment above: suggestions -\u003e statements","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003esorry, mistake in the comment above: suggestions -\u0026gt; statements\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-01T13:33:26.771Z","updated_at":"2018-07-01T13:33:26.771Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2969185,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"From my understanding this happens, because:\n\n1. `Muon` [sends AppleEvent to the Finder to open a file](https://github.com/brave/muon/blob/master/atom/common/platform_util_mac.mm#L49) =\u003e Brave -\u003e Finder -\u003e Terminal/\u003cetc\u003e.\n\n2. Chromium [opens files using `NSWorkspace `](https://cs.chromium.org/chromium/src/chrome/browser/platform_util_mac.mm?q=platform_util_mac\u0026dr\u0026l=30) =\u003e Chromium doesn't have access to Terminal/\u003cetc\u003e.","markdown_message":"\u003cp\u003eFrom my understanding this happens, because:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eMuon\u003c/code\u003e \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fmuon%2Fblob%2Fmaster%2Fatom%2Fcommon%2Fplatform_util_mac.mm%23L49\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esends AppleEvent to the Finder to open a file\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e =\u0026gt; Brave -\u0026gt; Finder -\u0026gt; Terminal/\u0026lt;etc\u0026gt;.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eChromium \u003ca href=\"/redirect?url=https%3A%2F%2Fcs.chromium.org%2Fchromium%2Fsrc%2Fchrome%2Fbrowser%2Fplatform_util_mac.mm%3Fq%3Dplatform_util_mac%26dr%26l%3D30\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eopens files using \u003ccode\u003eNSWorkspace\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e =\u0026gt; Chromium doesn\u0026#39;t have access to Terminal/\u0026lt;etc\u0026gt;.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-07-01T22:02:30.554Z","updated_at":"2018-07-01T22:02:30.554Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2969196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e It also makes sense to take a look at Linux/Win implementation, because they differ from Chromium's.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eIt also makes sense to take a look at Linux/Win implementation, because they differ from Chromium\u0026#39;s.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-01T22:15:55.546Z","updated_at":"2018-07-01T22:15:55.546Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2969205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Implementation of `OpenItem` [in Electron](https://github.com/electron/electron/blob/master/atom/common/platform_util_mac.mm) is identical with Chromium's implementation. \nSo this is a Muon bug.","markdown_message":"\u003cp\u003eImplementation of \u003ccode\u003eOpenItem\u003c/code\u003e \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Felectron%2Felectron%2Fblob%2Fmaster%2Fatom%2Fcommon%2Fplatform_util_mac.mm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ein Electron\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is identical with Chromium\u0026#39;s implementation. \u003cbr\u003e\nSo this is a Muon bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T22:26:44.414Z","updated_at":"2018-07-01T22:27:54.708Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2969419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Probably, it makes sense to change the severity of this bug to \"high\"?","markdown_message":"\u003cp\u003eProbably, it makes sense to change the severity of this bug to \u0026quot;high\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-02T01:16:11.087Z","updated_at":"2018-07-02T01:16:11.087Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2973939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[#375259](https://hackerone.com/reports/375259) definitely makes this vulnerability more severe.","markdown_message":"\u003cp\u003e\u003ca href=\"https://hackerone.com/reports/375259\"\u003e#375259\u003c/a\u003e definitely makes this vulnerability more severe.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-02T10:29:27.944Z","updated_at":"2018-07-02T10:29:27.944Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We have received your report.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have received your report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/thefrog\"\u003e@thefrog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSecurity Analyst\u003cbr\u003e\n\u003cstrong\u003eHackerOne\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T13:24:29.688Z","updated_at":"2018-07-03T13:24:29.688Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980701,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/thefrog\"\u003e@thefrog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSecurity Analyst\u003cbr\u003e\n\u003cstrong\u003eHackerOne\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T13:45:32.442Z","updated_at":"2018-07-03T13:45:32.442Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003621,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-06T22:37:05.099Z","updated_at":"2018-07-06T22:37:05.099Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":175789,"new_severity_id":180074},"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003627,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report. Since Java installed by default, this only poses an exploit potential on systems where the user has installed a JRE. In that case, one would hope that they could recognize that `.jar` are executable files — though this isn't guaranteed. ","markdown_message":"\u003cp\u003eThanks for the report. Since Java installed by default, this only poses an exploit potential on systems where the user has installed a JRE. In that case, one would hope that they could recognize that \u003ccode\u003e.jar\u003c/code\u003e are executable files — though this isn\u0026#39;t guaranteed. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:39:19.335Z","updated_at":"2018-07-06T22:39:19.335Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003630,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-06T22:40:34.001Z","updated_at":"2018-07-06T22:40:34.001Z","additional_data":{"added_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}],"removed_weaknesses":[{"id":75,"name":"Privilege Escalation"}]},"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003637,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We anticipate resolving this issue in Brave 1.0. We will not be tracking it separately since the issue is not present in that codebase.","markdown_message":"\u003cp\u003eWe anticipate resolving this issue in Brave 1.0. We will not be tracking it separately since the issue is not present in that codebase.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:43:59.866Z","updated_at":"2018-07-06T22:43:59.866Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3012019,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-08T00:46:08.701Z","updated_at":"2018-07-08T00:46:08.701Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @brave @diracdeltas @toml Could you cancel public disclosure of this bug?\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e Could you cancel public disclosure of this bug?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-03T23:24:49.218Z","updated_at":"2018-08-03T23:24:49.218Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139468,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:57:55.072Z","updated_at":"2018-08-04T02:57:55.072Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139469,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:58:12.406Z","updated_at":"2018-08-04T02:58:12.406Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @taraffic ","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/taraffic\"\u003e@taraffic\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-04T02:59:18.637Z","updated_at":"2018-08-04T02:59:18.637Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3387931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e The issue is still available in the current codebase.\n\u003e Brave: v 0.24.*\n\n@toml \nI was able to escalate this issue using default macOS file policies.\n`.terminal` files allow configuring `Terminal.app` appearance and setting startup commands, which will be executed on `.terminal` file opening.\n\n## Attack Scenario\n\n1. User downloads `exploit.terminal`\n2. Brave doesn't apply quarantine policy -\u003e `exploit.terminal` could be launched bypassing GateKeeper\n3. Brave opens files in unsafe way -\u003e Brave could open files in `Terminal.app`\n4. `Terminal.app` starts with the config from `exploit.terminal`\n5. `Terminal.app` executes \"startup\" command\n\nAttaching a sample `.terminal` file with \"startup\" commands (`echo` + `ls`)","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eThe issue is still available in the current codebase.\u003cbr\u003e\nBrave: v 0.24.*\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e \u003cbr\u003e\nI was able to escalate this issue using default macOS file policies.\u003cbr\u003e\n\u003ccode\u003e.terminal\u003c/code\u003e files allow configuring \u003ccode\u003eTerminal.app\u003c/code\u003e appearance and setting startup commands, which will be executed on \u003ccode\u003e.terminal\u003c/code\u003e file opening.\u003c/p\u003e\n\n\u003ch2 id=\"attack-scenario\"\u003eAttack Scenario\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eUser downloads \u003ccode\u003eexploit.terminal\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eBrave doesn\u0026#39;t apply quarantine policy -\u0026gt; \u003ccode\u003eexploit.terminal\u003c/code\u003e could be launched bypassing GateKeeper\u003c/li\u003e\n\u003cli\u003eBrave opens files in unsafe way -\u0026gt; Brave could open files in \u003ccode\u003eTerminal.app\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTerminal.app\u003c/code\u003e starts with the config from \u003ccode\u003eexploit.terminal\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eTerminal.app\u003c/code\u003e executes \u0026quot;startup\u0026quot; command\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAttaching a sample \u003ccode\u003e.terminal\u003c/code\u003e file with \u0026quot;startup\u0026quot; commands (\u003ccode\u003eecho\u003c/code\u003e + \u003ccode\u003els\u003c/code\u003e)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-25T20:21:36.456Z","updated_at":"2018-09-25T20:21:48.636Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":351042,"filename":"exploit.terminal","type":"application/xml","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/042/ae8fad066aa749f13822394a78613257ebce2780/exploit.terminal?response-content-disposition=attachment%3B%20filename%3D%22exploit.terminal%22%3B%20filename%2A%3DUTF-8%27%27exploit.terminal\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=f46f1bd31f229c7ca5153942292735fdaf8e91ad06e5f0857a8e550b297a6cd3"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3389609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"quarantine issue is https://github.com/brave/browser-laptop/issues/13088. unfortunately it broke updates so had to be reverted :(.\n\ni believe the next-generation brave will have quarantine on by default","markdown_message":"\u003cp\u003equarantine issue is \u003ca title=\"https://github.com/brave/browser-laptop/issues/13088\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F13088\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/13088\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. unfortunately it broke updates so had to be reverted :(.\u003c/p\u003e\n\n\u003cp\u003ei believe the next-generation brave will have quarantine on by default\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-26T06:23:43.881Z","updated_at":"2018-09-26T06:23:43.881Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3390745,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"agree with @diracdeltas, I think this is WAI, since fixing Quarantine and file opening mechanism is annoying and Brave has much more important things to work on\n\u003e Just saying that the vuln could be escalated without Java","markdown_message":"\u003cp\u003eagree with \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, I think this is WAI, since fixing Quarantine and file opening mechanism is annoying and Brave has much more important things to work on\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eJust saying that the vuln could be escalated without Java\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-09-26T11:59:34.893Z","updated_at":"2018-09-26T11:59:34.893Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5782189,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @brave,\n\n@diracdeltas Can we disclose this, please?\n\nThanks in advance :)","markdown_message":"\u003cp\u003eHey \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Can we disclose this, please?\u003c/p\u003e\n\n\u003cp\u003eThanks in advance :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-11T20:12:51.355Z","updated_at":"2019-09-11T20:12:51.355Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5790771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas @brave Please, change the title to \"Lack of quarantine meta-attribute for downloaded files leads to GateKeeper bypass\" or something like that","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e Please, change the title to \u0026quot;Lack of quarantine meta-attribute for downloaded files leads to GateKeeper bypass\u0026quot; or something like that\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-12T12:08:14.346Z","updated_at":"2019-09-12T12:08:14.346Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5792701,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-12T16:33:45.092Z","updated_at":"2019-09-12T16:33:45.092Z","additional_data":{"old_title":"Downloaded Java archives are executable through Downloads toolbar in one click. ","new_title":"Lack of quarantine meta-attribute for downloaded files leads to GateKeeper bypass"},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5792704,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-12T16:34:05.954Z","updated_at":"2019-09-12T16:34:05.954Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5792705,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-12T16:34:06.078Z","updated_at":"2019-09-12T16:34:06.078Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}