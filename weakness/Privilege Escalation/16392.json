{"id":16392,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM5Mg==","url":"https://hackerone.com/reports/16392","title":"Abusing daemon logs for Privilege escalation under certain scenarios","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-06-14T03:09:35.523Z","submitted_at":"2014-06-14T03:09:35.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunnelshade","url":"/tunnelshade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-06-18T13:44:53.500Z","bug_reporter_agreed_on_going_public_at":"2014-06-18T13:44:53.406Z","team_member_agreed_on_going_public_at":"2014-06-18T12:40:24.138Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Setup Needed\r\n\r\n+ A normal user account\r\n+ A momentary disruption of mail services\r\n\r\n# Replication steps\r\n\r\n+ Login as **normal user**\r\n+ Wait for **momentary disruption** of mail services\r\n+ Use **Password Reset Link** for admin mail address\r\n+ BOOM!!!\r\n+ You can see the password reset link in the daemon logs because of interrupted mail service (check the screenshot)\r\n+ Click on the link and upgrade to **Admin**\r\n\r\n# Attack Scenarios\r\n\r\n(Virtually unlimited) \r\nA moment misconfiguration of \r\n+ Mail configuration\r\n+ Firewall settings\r\n+ Mail Service down\r\netc.. etc.. (we just need a moment :P)\r\n\r\nI actually discovered this bug when gmail rejected my smtp credentials to prevent suspicious login :P.\r\n\r\n","vulnerability_information_html":"\u003ch1 id=\"setup-needed\"\u003eSetup Needed\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eA normal user account\u003c/li\u003e\n\u003cli\u003eA momentary disruption of mail services\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"replication-steps\"\u003eReplication steps\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eLogin as \u003cstrong\u003enormal user\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eWait for \u003cstrong\u003emomentary disruption\u003c/strong\u003e of mail services\u003c/li\u003e\n\u003cli\u003eUse \u003cstrong\u003ePassword Reset Link\u003c/strong\u003e for admin mail address\u003c/li\u003e\n\u003cli\u003eBOOM!!!\u003c/li\u003e\n\u003cli\u003eYou can see the password reset link in the daemon logs because of interrupted mail service (check the screenshot)\u003c/li\u003e\n\u003cli\u003eClick on the link and upgrade to \u003cstrong\u003eAdmin\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"attack-scenarios\"\u003eAttack Scenarios\u003c/h1\u003e\n\n\u003cp\u003e(Virtually unlimited) \u003cbr\u003e\nA moment misconfiguration of \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMail configuration\u003c/li\u003e\n\u003cli\u003eFirewall settings\u003c/li\u003e\n\u003cli\u003eMail Service down\netc.. etc.. (we just need a moment :P)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI actually discovered this bug when gmail rejected my smtp credentials to prevent suspicious login :P.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":11310,"file_name":"daemon-log.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/011/310/ec99a49702274bb318c374bf0126da733d40409c/daemon-log.png?response-content-disposition=attachment%3B%20filename%3D%22daemon-log.png%22%3B%20filename%2A%3DUTF-8%27%27daemon-log.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043809Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=e199ceabd3371e5b620de546aa2d7ba8d630288fbf6e89d35b7c5fcf8d9b46bf","file_size":92043,"type":"image/png"}],"allow_singular_disclosure_at":"2014-07-18T12:40:24.218Z","allow_singular_disclosure_after":-203529465.68652797,"singular_disclosure_allowed":true,"vote_count":1,"voters":["zonestc"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":73262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed by this change, which censors values from logs:\n\nhttps://secure.phabricator.com/D9540\n\nHowever, we probably need to remove logs from the web UI entirely to really fix this. This is unfortunate because they're very useful for debugging and troubleshooting, but we can't realistically ever blacklist all of the sensitive stuff that can end up there.","markdown_message":"\u003cp\u003eThis should be fixed by this change, which censors values from logs:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/D9540\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FD9540\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/D9540\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHowever, we probably need to remove logs from the web UI entirely to really fix this. This is unfortunate because they\u0026#39;re very useful for debugging and troubleshooting, but we can\u0026#39;t realistically ever blacklist all of the sensitive stuff that can end up there.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-15T02:20:35.382Z","updated_at":"2014-06-15T02:20:35.382Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":74006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, logs leak too much info and it is practically difficult to blacklist everything, so you can either keep log access for just **admins** or make it an admin **granted privilege**. Triage?","markdown_message":"\u003cp\u003eYes, logs leak too much info and it is practically difficult to blacklist everything, so you can either keep log access for just \u003cstrong\u003eadmins\u003c/strong\u003e or make it an admin \u003cstrong\u003egranted privilege\u003c/strong\u003e. Triage?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-16T17:06:07.056Z","updated_at":"2014-06-16T17:12:19.537Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75214,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed in HEAD:\n\nhttps://secure.phabricator.com/rPHUe57d872cbe61686bf215520b0158cdf1f5dce26a\n\nI've filed this to keep track of removing the UI entirely:\n\nhttps://secure.phabricator.com/T5405","markdown_message":"\u003cp\u003eThis has been fixed in HEAD:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/rPHUe57d872cbe61686bf215520b0158cdf1f5dce26a\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FrPHUe57d872cbe61686bf215520b0158cdf1f5dce26a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/rPHUe57d872cbe61686bf215520b0158cdf1f5dce26a\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve filed this to keep track of removing the UI entirely:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/T5405\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT5405\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T5405\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T12:36:35.185Z","updated_at":"2014-06-18T12:36:35.185Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tunnelshade","url":"/tunnelshade"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75215,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This attack requires an account, depends on an external service failure, requires an install have username/password authentication configured, indirectly alerts administrators by sending them password reset emails, and is mitigated by two-factor auth if it's in use.","markdown_message":"\u003cp\u003eThis attack requires an account, depends on an external service failure, requires an install have username/password authentication configured, indirectly alerts administrators by sending them password reset emails, and is mitigated by two-factor auth if it\u0026#39;s in use.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T12:39:22.379Z","updated_at":"2014-06-18T12:39:22.379Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"tunnelshade","url":"/tunnelshade"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75216,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This can be disclosed at any time, the fix is in public version control.","markdown_message":"\u003cp\u003eThis can be disclosed at any time, the fix is in public version control.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T12:40:24.154Z","updated_at":"2014-06-18T12:40:24.154Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75231,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Keep it up guys, you rock \u0026 phabricator too :)","markdown_message":"\u003cp\u003eKeep it up guys, you rock \u0026amp; phabricator too :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T13:44:53.422Z","updated_at":"2014-06-18T13:44:53.422Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75232,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-18T13:44:53.515Z","updated_at":"2014-06-18T13:44:53.515Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}