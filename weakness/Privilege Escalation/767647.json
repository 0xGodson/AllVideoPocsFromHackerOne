{"id":767647,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Njc2NDc=","url":"https://hackerone.com/reports/767647","title":"Vulnerabilities chain leading to privilege escalation","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-01-03T14:32:12.526Z","submitted_at":"2020-01-03T14:32:12.526Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"r3ggi-on-h1","url":"/r3ggi-on-h1","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17173,"url":"https://hackerone.com/nordvpn","handle":"nordvpn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"NordVPN","twitter_handle":"","website":"https://www.nordvpn.com","about":"The worldâ€™s most advanced VPN"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-22T13:05:50.575Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-04-22T13:05:47.487Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-05-22T13:05:47.571Z","allow_singular_disclosure_after":-19071779.746842075,"singular_disclosure_allowed":true,"vote_count":35,"voters":["miszczyk","keshavkejriwal","mygf","sodium_","0xdd","sa1tama0","b69fb2ebda43240ece9dbeb","arezthehopebuster_","sam_16","flavius_mad","and 25 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":46627,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"MacOS Executable","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6696862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-06T09:35:10.465Z","updated_at":"2020-01-06T09:35:10.465Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6772133,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T22:53:57.602Z","updated_at":"2020-01-14T22:53:57.602Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6783653,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-16T06:59:44.905Z","updated_at":"2020-01-16T06:59:44.905Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6784941,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-16T09:03:07.204Z","updated_at":"2020-01-16T09:03:07.204Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6935975,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T19:40:15.844Z","updated_at":"2020-01-31T19:40:15.844Z","additional_data":{"duplicate_report_id":774683},"actor":{"username":"yilmazcanyigit","cleared":false,"url":"/yilmazcanyigit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6960270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-04T13:15:51.529Z","updated_at":"2020-02-04T13:15:51.529Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6981794,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T20:29:25.425Z","updated_at":"2020-02-06T20:29:25.425Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7066285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-16T20:59:01.394Z","updated_at":"2020-02-16T20:59:01.394Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7110877,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-21T11:40:14.078Z","updated_at":"2020-02-21T11:40:14.078Z","actor":{"url":"/nordvpn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"NordVPN"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nordvpn","collaborator":{"username":"r3ggi-on-h1","url":"/r3ggi-on-h1"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7121724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-22T09:15:27.251Z","updated_at":"2020-02-22T09:15:27.251Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7225429,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-04T13:57:04.047Z","updated_at":"2020-03-04T13:57:04.047Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7725010,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-20T13:00:53.601Z","updated_at":"2020-04-20T13:00:53.601Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Windows Executable","new_scope":"MacOS Executable","genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7754367,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T13:03:39.967Z","updated_at":"2020-04-22T13:03:39.967Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"r3ggi-on-h1","url":"/r3ggi-on-h1"},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7754383,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T13:05:34.981Z","updated_at":"2020-04-22T13:05:34.981Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7754385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T13:05:47.513Z","updated_at":"2020-04-22T13:05:47.513Z","first_to_agree":true,"actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7956972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T07:10:43.450Z","updated_at":"2020-05-11T07:10:43.450Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7957074,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T07:25:33.501Z","updated_at":"2020-05-11T07:25:33.501Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8031049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T07:48:13.058Z","updated_at":"2020-05-18T07:48:13.058Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8032305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T09:38:42.979Z","updated_at":"2020-05-18T09:40:36.333Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8032469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T09:54:07.076Z","updated_at":"2020-05-18T09:54:07.076Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8048495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-19T14:14:43.727Z","updated_at":"2020-05-19T14:14:43.727Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8079695,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-22T13:05:50.618Z","updated_at":"2020-05-22T13:05:50.618Z","actor":{"url":"/nordvpn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KxF7vPvwgWhQmAsPpFjrK2Eb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"NordVPN"}},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8088319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-23T19:50:42.591Z","updated_at":"2020-05-23T19:50:42.591Z","actor":{"username":"r3ggi-on-h1","cleared":false,"url":"/r3ggi-on-h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8103381,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-26T08:33:00.526Z","updated_at":"2020-05-26T08:33:00.526Z","actor":{"username":"fixed_zero","cleared":false,"url":"/fixed_zero","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AvW9fqpFzmQqj8ZsU6TMKf3K/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordvpn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21405,"category":"team","content":"The researcher provided us with a chain of 5 vulnerabilities. By chaining all of them together, the attacker is able to establish a valid XPC connection with the privileged helper. Then, the attacker is able to send a message to open a binary located in the controlled location that has a symlink. Since the privileged helper resolves a tiny symlink, by constantly swapping the symlink to NordVPN and malicious file, the attacker is able to win a race condition (TOCTOU) and execute a malicious file within the scope of root permissions.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe researcher provided us with a chain of 5 vulnerabilities. By chaining all of them together, the attacker is able to establish a valid XPC connection with the privileged helper. Then, the attacker is able to send a message to open a binary located in the controlled location that has a symlink. Since the privileged helper resolves a tiny symlink, by constantly swapping the symlink to NordVPN and malicious file, the attacker is able to win a race condition (TOCTOU) and execute a malicious file within the scope of root permissions.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}