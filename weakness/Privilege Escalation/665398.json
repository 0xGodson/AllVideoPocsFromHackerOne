{"id":665398,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjUzOTg=","url":"https://hackerone.com/reports/665398","title":"Subdomain takeover of datacafe-cert.starbucks.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-01T10:49:53.145Z","submitted_at":"2019-08-01T10:49:53.145Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"parzel","url":"/parzel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-28T16:43:06.664Z","bug_reporter_agreed_on_going_public_at":"2019-08-26T17:03:36.473Z","team_member_agreed_on_going_public_at":"2019-08-28T16:43:06.498Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe subdomain datacafe-cert.starbucks.com had an CNAME record pointing to an unclaimed Azure webservice. This is a high severity security issue because an attacker can register the subdomain on Azure and therefore can own the subdomain datacafe-cert.starbucks.com.\n\n**Description:**\nThe dangling CNAME record of datacafe-cert.starbucks.com is pointing to s00397nasv101-datacafe-cert.azurewebsites.net which was not claimed by you. I registered a service with this name and therefore was able to takeover the subdomain. Every attacker doing this has afterwords full control over the contents served on this subdomain.\n\n**Platform(s) Affected:** \nhttp://datacafe-cert.starbucks.com/\nhttps://datacafe-cert.starbucks.com/\n\n## Supporting Material/References:\nview-source:http://datacafe-cert.starbucks.com/\n\n## How can the system be exploited with this bug?\nThe full domain can be taken over. Arbitrary content can be served under it.\n\n## How did you come across this bug ?\nI noticed the dangling CNAME record of datacafe-cert.starbucks.com.\n\n## Recommendations for fix\n1) Remove the dangling CNAME record from datacafe-cert.starbucks.com\n2) I release s00397nasv101-datacafe-cert.azurewebsites.net\n3) You can reclaim it if you want\n\n## Impact\n\nThis issue can be exploited in several ways, for example but not limited to: XSS, Phishing, Session Hijacking due to bypassing of SOP","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nThe subdomain datacafe-cert.starbucks.com had an CNAME record pointing to an unclaimed Azure webservice. This is a high severity security issue because an attacker can register the subdomain on Azure and therefore can own the subdomain datacafe-cert.starbucks.com.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThe dangling CNAME record of datacafe-cert.starbucks.com is pointing to s00397nasv101-datacafe-cert.azurewebsites.net which was not claimed by you. I registered a service with this name and therefore was able to takeover the subdomain. Every attacker doing this has afterwords full control over the contents served on this subdomain.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePlatform(s) Affected:\u003c/strong\u003e \u003cbr\u003e\n\u003ca title=\"http://datacafe-cert.starbucks.com/\" href=\"/redirect?url=http%3A%2F%2Fdatacafe-cert.starbucks.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://datacafe-cert.starbucks.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://datacafe-cert.starbucks.com/\" href=\"/redirect?url=https%3A%2F%2Fdatacafe-cert.starbucks.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://datacafe-cert.starbucks.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eview-source:\u003ca title=\"http://datacafe-cert.starbucks.com/\" href=\"/redirect?url=http%3A%2F%2Fdatacafe-cert.starbucks.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://datacafe-cert.starbucks.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"how-can-the-system-be-exploited-with-this-bug\"\u003eHow can the system be exploited with this bug?\u003c/h2\u003e\n\n\u003cp\u003eThe full domain can be taken over. Arbitrary content can be served under it.\u003c/p\u003e\n\n\u003ch2 id=\"how-did-you-come-across-this-bug\"\u003eHow did you come across this bug ?\u003c/h2\u003e\n\n\u003cp\u003eI noticed the dangling CNAME record of datacafe-cert.starbucks.com.\u003c/p\u003e\n\n\u003ch2 id=\"recommendations-for-fix\"\u003eRecommendations for fix\u003c/h2\u003e\n\n\u003cp\u003e1) Remove the dangling CNAME record from datacafe-cert.starbucks.com\u003cbr\u003e\n2) I release s00397nasv101-datacafe-cert.azurewebsites.net\u003cbr\u003e\n3) You can reclaim it if you want\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis issue can be exploited in several ways, for example but not limited to: XSS, Phishing, Session Hijacking due to bypassing of SOP\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-09-25T17:03:36.613Z","allow_singular_disclosure_after":-39792708.5053942,"singular_disclosure_allowed":true,"vote_count":295,"voters":["daehee","ikuamike","karma7","c1phy","mashoud1122","un4gi","v0lck3r","spam404","base_64","mik317","and 285 more..."],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13008,"asset_type":"OTHER","asset_identifier":"Other non domain specific items","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5481465,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, @parzel - thanks for finding and submitting this.\nI can confirm it's a good subdomain takeover, and that we will be rewarding you for this find.\nCan I ask you for a little extra detail on the finding? I'd like to know when you found and exploited the issue, and how you detected it. This will help me in determining how we can best prevent and detect these issues in future.","markdown_message":"\u003cp\u003eHi, \u003ca href=\"/parzel\"\u003e@parzel\u003c/a\u003e - thanks for finding and submitting this.\u003cbr\u003e\nI can confirm it\u0026#39;s a good subdomain takeover, and that we will be rewarding you for this find.\u003cbr\u003e\nCan I ask you for a little extra detail on the finding? I\u0026#39;d like to know when you found and exploited the issue, and how you detected it. This will help me in determining how we can best prevent and detect these issues in future.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-01T17:32:25.994Z","updated_at":"2019-08-01T17:32:25.994Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5481560,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-01T17:33:17.348Z","updated_at":"2019-08-01T17:33:17.348Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"parzel","url":"/parzel"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5482668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tealeaf,\nthanks for the reward! Sure - I will try answer your questions. I found and exploited the issue today. First I enumerated different subdomains for starbucks.com. Then I checked if these domains have a cname record pointing to azurewebsites.net. For every domain that matched I performed a DNS query for the CNAME record entry. If this returns a NXDOMAIN, the subdomain can usually be taken over and it is possible to register a domain that matches the NXDOMAIN CNAME entry. Does this answer your questions?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tealeaf\"\u003e@tealeaf\u003c/a\u003e,\u003cbr\u003e\nthanks for the reward! Sure - I will try answer your questions. I found and exploited the issue today. First I enumerated different subdomains for starbucks.com. Then I checked if these domains have a cname record pointing to azurewebsites.net. For every domain that matched I performed a DNS query for the CNAME record entry. If this returns a NXDOMAIN, the subdomain can usually be taken over and it is possible to register a domain that matches the NXDOMAIN CNAME entry. Does this answer your questions?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-01T20:40:09.480Z","updated_at":"2019-08-01T20:40:09.480Z","actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5482696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was hoping you could give me a specific time, so that I can compare it against internal logs. If you don't have that information, no problem.","markdown_message":"\u003cp\u003eI was hoping you could give me a specific time, so that I can compare it against internal logs. If you don\u0026#39;t have that information, no problem.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-01T20:48:42.361Z","updated_at":"2019-08-01T20:48:42.361Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5482727,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh sure. I found the subdomain takeover at 12:01 PM CEST and exploited it maybe half an hour afterwards.","markdown_message":"\u003cp\u003eOh sure. I found the subdomain takeover at 12:01 PM CEST and exploited it maybe half an hour afterwards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-01T20:58:21.626Z","updated_at":"2019-08-01T20:58:21.626Z","actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5493784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just checked and noticed you removed the dangling cname record. I will release the domain now :-)","markdown_message":"\u003cp\u003eI just checked and noticed you removed the dangling cname record. I will release the domain now :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-03T11:22:14.760Z","updated_at":"2019-08-03T11:22:14.760Z","actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5611096,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for reporting this, @parzel, and for giving us information we can use in helping to prevent this kind of issue in future! I hope you'll share any future issues you find with us.","markdown_message":"\u003cp\u003eThanks again for reporting this, \u003ca href=\"/parzel\"\u003e@parzel\u003c/a\u003e, and for giving us information we can use in helping to prevent this kind of issue in future! I hope you\u0026#39;ll share any future issues you find with us.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-19T21:18:50.338Z","updated_at":"2019-08-19T21:18:50.338Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"parzel","url":"/parzel"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5612808,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad I could help you. Can you disclose this?","markdown_message":"\u003cp\u003eGlad I could help you. Can you disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T06:53:31.205Z","updated_at":"2019-08-20T06:53:31.205Z","actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5667969,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-26T17:03:36.513Z","updated_at":"2019-08-26T17:03:36.513Z","first_to_agree":true,"actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5684876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-28T16:43:06.534Z","updated_at":"2019-08-28T16:43:06.534Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5684877,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-28T16:43:06.691Z","updated_at":"2019-08-28T16:43:06.691Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}