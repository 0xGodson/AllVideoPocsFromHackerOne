{"id":388622,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODg2MjI=","url":"https://hackerone.com/reports/388622","title":"Subdomain takeover on wfmnarptpc.starbucks.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-30T22:20:33.463Z","submitted_at":"2018-07-30T22:20:33.463Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xpatrik","url":"/0xpatrik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-09T21:09:10.902Z","bug_reporter_agreed_on_going_public_at":"2018-08-03T03:54:41.643Z","team_member_agreed_on_going_public_at":"2018-08-09T21:09:10.480Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nthis is pretty serious security issue in some context, so please act as fast as possible.\n\nOverview:\nOne of the starbucks.com subdomains is pointing to Azure, which has unclaimed CNAME record. ANYONE is able to own starbucks.com subdomain at the moment.\n\nThis vulnerability is called subdomain takeover. You can read more about it here:\n\nhttps://0xpatrik.com/subdomain-takeover-basics/\n\nDetails:\nwfmnarptpc.starbucks.com has CNAME to s00149tmppcrpt.trafficmanager.net. However, s00149tmppcrpt.trafficmanager.net is not registered in Azure cloud anymore and thus can be registered by anyone. After registering the TrafficManager Profile in Azure portal, the person doing so has full control over content on wfmnarptpc.starbucks.com.\n\nPoC:\nhttp://wfmnarptpc.starbucks.com/poc.html\n\n Mitigation:\nRemove the CNAME record from starbucks.com DNS zone completely.\nClaim it back in Azure portal after I release it\nRegards,\n\nPatrik Hudak\n\n## Impact\n\nSubdomain takeover is abused for several purposes:\n\nMalware distribution\nPhishing / Spear phishing\nXSS\nAuthentication bypass\n...\nList goes on and on. Since some certificate authorities (Let's Encrypt) require only domain verification, SSL certificate can be easily generated.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003ethis is pretty serious security issue in some context, so please act as fast as possible.\u003c/p\u003e\n\n\u003cp\u003eOverview:\u003cbr\u003e\nOne of the starbucks.com subdomains is pointing to Azure, which has unclaimed CNAME record. ANYONE is able to own starbucks.com subdomain at the moment.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability is called subdomain takeover. You can read more about it here:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://0xpatrik.com/subdomain-takeover-basics/\" href=\"/redirect?url=https%3A%2F%2F0xpatrik.com%2Fsubdomain-takeover-basics%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://0xpatrik.com/subdomain-takeover-basics/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eDetails:\u003cbr\u003e\nwfmnarptpc.starbucks.com has CNAME to s00149tmppcrpt.trafficmanager.net. However, s00149tmppcrpt.trafficmanager.net is not registered in Azure cloud anymore and thus can be registered by anyone. After registering the TrafficManager Profile in Azure portal, the person doing so has full control over content on wfmnarptpc.starbucks.com.\u003c/p\u003e\n\n\u003cp\u003ePoC:\u003cbr\u003e\n\u003ca title=\"http://wfmnarptpc.starbucks.com/poc.html\" href=\"/redirect?url=http%3A%2F%2Fwfmnarptpc.starbucks.com%2Fpoc.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://wfmnarptpc.starbucks.com/poc.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMitigation:\u003cbr\u003e\nRemove the CNAME record from starbucks.com DNS zone completely.\u003cbr\u003e\nClaim it back in Azure portal after I release it\u003cbr\u003e\nRegards,\u003c/p\u003e\n\n\u003cp\u003ePatrik Hudak\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSubdomain takeover is abused for several purposes:\u003c/p\u003e\n\n\u003cp\u003eMalware distribution\u003cbr\u003e\nPhishing / Spear phishing\u003cbr\u003e\nXSS\u003cbr\u003e\nAuthentication bypass\u003cbr\u003e\n...\u003cbr\u003e\nList goes on and on. Since some certificate authorities (Let\u0026#39;s Encrypt) require only domain verification, SSL certificate can be easily generated.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":326554,"file_name":"Screen_Shot_2018-07-31_at_00.19.53.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/326/554/b48a033bdde923485cd413390893a01b8db6b7bb/Screen_Shot_2018-07-31_at_00.19.53.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-07-31_at_00.19.53.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-07-31_at_00.19.53.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054843Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=3437608b29b676b076d5a3384689155c9c60cd5e22f42db5b489ca5d740d21bb","file_size":16342,"type":"image/png"}],"allow_singular_disclosure_at":"2018-09-02T03:54:41.862Z","allow_singular_disclosure_after":-73360441.8652016,"singular_disclosure_allowed":true,"vote_count":83,"voters":["0xpatrik","badf00d","checkm50","sultancad","michiel","zisec","muon4","s_p_q_r","vavkamil","mygf","and 73 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":13008,"asset_type":"OTHER","asset_identifier":"Other non domain specific items","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3121525,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We have received your report.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have received your report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/thefrog\"\u003e@thefrog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSecurity Analyst\u003cbr\u003e\n\u003cstrong\u003eHackerOne\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-31T10:22:36.502Z","updated_at":"2018-07-31T10:22:36.502Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3123994,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @0xpatrik , Thanks for your report. We are following up with our internal team to remove the DNS record as a fix to the issue. We will get back once we receive an update so you can release the claimed traffic manager name. Once again, Thanks for your submission!\n\n@ristretto","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xpatrik\"\u003e@0xpatrik\u003c/a\u003e , Thanks for your report. We are following up with our internal team to remove the DNS record as a fix to the issue. We will get back once we receive an update so you can release the claimed traffic manager name. Once again, Thanks for your submission!\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ristretto\"\u003e@ristretto\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-31T22:17:44.718Z","updated_at":"2018-07-31T22:17:44.718Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3123997,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-31T22:17:59.335Z","updated_at":"2018-07-31T22:17:59.335Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"0xpatrik","url":"/0xpatrik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3135322,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @0xpatrik , We have confirmed that the issue has been fixed, so the report is being closed. Please let us know if you find any further issues. Thanks for your report!\n\n@ristretto","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xpatrik\"\u003e@0xpatrik\u003c/a\u003e , We have confirmed that the issue has been fixed, so the report is being closed. Please let us know if you find any further issues. Thanks for your report!\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ristretto\"\u003e@ristretto\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-03T00:32:06.314Z","updated_at":"2018-08-03T00:32:06.314Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"0xpatrik","url":"/0xpatrik"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3135607,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-03T03:54:41.738Z","updated_at":"2018-08-03T03:54:41.738Z","first_to_agree":true,"actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3158359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","markdown_message":"\u003cp\u003eCan we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-07T23:11:53.357Z","updated_at":"2018-08-07T23:11:53.357Z","actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168310,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xpatrik, We will disclose the report, Can you please release the \"s00149tmppcrpt\" traffic manager account that you have claimed?\n\nThanks!\n@ristretto","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xpatrik\"\u003e@0xpatrik\u003c/a\u003e, We will disclose the report, Can you please release the \u0026quot;s00149tmppcrpt\u0026quot; traffic manager account that you have claimed?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\n\u003ca href=\"/ristretto\"\u003e@ristretto\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T18:35:20.666Z","updated_at":"2018-08-09T18:35:20.666Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I released that last week.","markdown_message":"\u003cp\u003eI released that last week.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T18:45:12.855Z","updated_at":"2018-08-09T18:45:12.855Z","actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, Thanks for confirming!\n\n@ristretto","markdown_message":"\u003cp\u003eOk, Thanks for confirming!\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ristretto\"\u003e@ristretto\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T21:09:02.194Z","updated_at":"2018-08-09T21:09:02.194Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168999,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-09T21:09:10.574Z","updated_at":"2018-08-09T21:09:10.574Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3169000,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-09T21:09:10.949Z","updated_at":"2018-08-09T21:09:10.949Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3701897,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-23T20:12:56.140Z","updated_at":"2018-11-23T20:12:56.140Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"Other non domain specific items","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":9758,"category":"researcher","content":"Subdomain takeover possible on one of Starbucks's subdomain. The subdomain pointed to Microsoft Azure Traffic Manager which was no longer registered under Azure.\n\nDetailed write-up: https://0xpatrik.com/subdomain-takeover-starbucks-ii/","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eSubdomain takeover possible on one of Starbucks\u0026#39;s subdomain. The subdomain pointed to Microsoft Azure Traffic Manager which was no longer registered under Azure.\u003c/p\u003e\n\n\u003cp\u003eDetailed write-up: \u003ca title=\"https://0xpatrik.com/subdomain-takeover-starbucks-ii/\" href=\"/redirect?url=https%3A%2F%2F0xpatrik.com%2Fsubdomain-takeover-starbucks-ii%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://0xpatrik.com/subdomain-takeover-starbucks-ii/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}