{"id":174896,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQ4OTY=","url":"https://hackerone.com/reports/174896","title":"Dav sharing permissions issue","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-10T07:55:37.422Z","submitted_at":"2016-10-10T07:55:37.422Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nickvergessen","url":"/nickvergessen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-20T21:57:21.170Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-04-20T21:57:09.148Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Steps\n\n1. Create users \"Test 1\" and \"Test 2\", make \"Test 1\" member of \"Group A\"\n2. Share a calendar with group \"Group A\" editable\n3. Share the same calendar with user \"Test 2\" readonly\n4. As \"Test 1\" open the calendar app and unshare the calendar from \"Test 2\" - works\n5. As \"Test 1\" open the calendar app and remove edit permissions for \"Group A\" - works\n\nIn my opinion steps 4 and 5 should not be possible. The shares should not even be visible in my opinion.","vulnerability_information_html":"\u003ch3 id=\"steps\"\u003eSteps\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate users \u0026quot;Test 1\u0026quot; and \u0026quot;Test 2\u0026quot;, make \u0026quot;Test 1\u0026quot; member of \u0026quot;Group A\u0026quot;\u003c/li\u003e\n\u003cli\u003eShare a calendar with group \u0026quot;Group A\u0026quot; editable\u003c/li\u003e\n\u003cli\u003eShare the same calendar with user \u0026quot;Test 2\u0026quot; readonly\u003c/li\u003e\n\u003cli\u003eAs \u0026quot;Test 1\u0026quot; open the calendar app and unshare the calendar from \u0026quot;Test 2\u0026quot; - works\u003c/li\u003e\n\u003cli\u003eAs \u0026quot;Test 1\u0026quot; open the calendar app and remove edit permissions for \u0026quot;Group A\u0026quot; - works\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn my opinion steps 4 and 5 should not be possible. The shares should not even be visible in my opinion.\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-20T21:57:09.189Z","allow_singular_disclosure_after":-113899517.54863532,"singular_disclosure_allowed":true,"vote_count":5,"voters":["lukasreschke","eveeez","japz","spetr0x","000310"],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1239660,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-10-10T07:55:37.563Z","updated_at":"2016-10-10T07:55:37.563Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1239663,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T07:58:24.644Z","updated_at":"2016-10-10T07:58:24.644Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.6)","old_severity_id":1248,"new_severity_id":1249},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1239665,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T07:59:16.299Z","updated_at":"2016-10-10T07:59:16.299Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1624987,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The [relevant pull request](https://github.com/nextcloud/server/pull/3595) has been just merged and will be included with the next major release Nextcloud 12. As of now, we don't have backported this patch due to the potential breakage by it and the limited exploitability here.\n\nNice catch again, @nickvergessen.","markdown_message":"\u003cp\u003eThe \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F3595\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erelevant pull request\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has been just merged and will be included with the next major release Nextcloud 12. As of now, we don\u0026#39;t have backported this patch due to the potential breakage by it and the limited exploitability here.\u003c/p\u003e\n\n\u003cp\u003eNice catch again, \u003ca href=\"/nickvergessen\"\u003e@nickvergessen\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-20T21:56:45.674Z","updated_at":"2017-04-20T21:56:45.674Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nickvergessen","url":"/nickvergessen"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1624988,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As an internal finding this does not qualify for a monetary reward.","markdown_message":"\u003cp\u003eAs an internal finding this does not qualify for a monetary reward.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-20T21:57:01.637Z","updated_at":"2017-04-20T21:57:01.637Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1624989,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-20T21:57:09.165Z","updated_at":"2017-04-20T21:57:09.165Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1689257,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-20T21:57:21.186Z","updated_at":"2017-05-20T21:57:21.186Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}