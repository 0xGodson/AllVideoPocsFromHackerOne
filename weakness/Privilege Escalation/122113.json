{"id":122113,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjIxMTM=","url":"https://hackerone.com/reports/122113","title":"OpenSSH / dropbearSSHd xauth command injection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-10T17:49:34.074Z","submitted_at":"2016-03-10T17:49:34.074Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hxd","url":"/hxd","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-12T09:45:23.558Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-13T09:45:16.308Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"* OpenSSH \n * affects all version \u003c= 7.2p1 with `X11Forwarding yes` (acc. to OpenSSH this bug is 20 years old and affects all versions back to openssh v1)\n * status: fixed, vendor advisory: http://www.openssh.com/txt/x11fwd.adv\n* dropbearSSHd\n * affects \u003c= 2015.71 (basically all versions that come with x11 support; dates back 12 years [1])\n * status: fixed, vendor info: https://matt.ucc.asn.au/dropbear/CHANGES\n* other\n * mobaSSH; they're just based on openssh but for windows - mobassh.mobatek.net\n\nallows to bypass ssh-forced-commands and login-shell restrictions (/bin/false, specific binary) by injecting xauth commands. The latter only affects OpenSSH. Capabilities: arbitr. file read/write, info disclosure (xauth env. info), initiate outbound X connections\n\nreported to OpenSSH first, provided detailed vulnerability analysis, PoC and a simple patch. OpenSSH kindly coordinated patch and release with dropbearSSHd. fixed within a few days (first contact march 3rd. coordinated release with dropbear 10th)\n\ndetails and the actual research material that was securely disclosed to OpenSSH will be pushed to the following repo (note this llink is subject to change once there's a cve assigned for that issue):\nhttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-xxxx-openssh-dropbearsshd\n\n[1] https://github.com/mkj/dropbear/blob/790726519e69f5d93b579a21951d78f8f777a5cb/svr-x11fwd.c\n","vulnerability_information_html":"\u003cul\u003e\n\u003cli\u003eOpenSSH \n\n\u003cul\u003e\n\u003cli\u003eaffects all version \u0026lt;= 7.2p1 with \u003ccode\u003eX11Forwarding yes\u003c/code\u003e (acc. to OpenSSH this bug is 20 years old and affects all versions back to openssh v1)\u003c/li\u003e\n\u003cli\u003estatus: fixed, vendor advisory: \u003ca title=\"http://www.openssh.com/txt/x11fwd.adv\" href=\"/redirect?url=http%3A%2F%2Fwww.openssh.com%2Ftxt%2Fx11fwd.adv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.openssh.com/txt/x11fwd.adv\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003edropbearSSHd\n\n\u003cul\u003e\n\u003cli\u003eaffects \u0026lt;= 2015.71 (basically all versions that come with x11 support; dates back 12 years [1])\u003c/li\u003e\n\u003cli\u003estatus: fixed, vendor info: \u003ca title=\"https://matt.ucc.asn.au/dropbear/CHANGES\" href=\"/redirect?url=https%3A%2F%2Fmatt.ucc.asn.au%2Fdropbear%2FCHANGES\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://matt.ucc.asn.au/dropbear/CHANGES\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eother\n\n\u003cul\u003e\n\u003cli\u003emobaSSH; they\u0026#39;re just based on openssh but for windows - mobassh.mobatek.net\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eallows to bypass ssh-forced-commands and login-shell restrictions (/bin/false, specific binary) by injecting xauth commands. The latter only affects OpenSSH. Capabilities: arbitr. file read/write, info disclosure (xauth env. info), initiate outbound X connections\u003c/p\u003e\n\n\u003cp\u003ereported to OpenSSH first, provided detailed vulnerability analysis, PoC and a simple patch. OpenSSH kindly coordinated patch and release with dropbearSSHd. fixed within a few days (first contact march 3rd. coordinated release with dropbear 10th)\u003c/p\u003e\n\n\u003cp\u003edetails and the actual research material that was securely disclosed to OpenSSH will be pushed to the following repo (note this llink is subject to change once there\u0026#39;s a cve assigned for that issue):\u003cbr\u003e\n\u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-xxxx-openssh-dropbearsshd\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-xxxx-openssh-dropbearsshd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-xxxx-openssh-dropbearsshd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[1] \u003ca title=\"https://github.com/mkj/dropbear/blob/790726519e69f5d93b579a21951d78f8f777a5cb/svr-x11fwd.c\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmkj%2Fdropbear%2Fblob%2F790726519e69f5d93b579a21951d78f8f777a5cb%2Fsvr-x11fwd.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mkj/dropbear/blob/790726519e69f5d93b579a21951d78f8f777a5cb/svr-x11fwd.c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-12T09:45:16.375Z","allow_singular_disclosure_after":-35663740.26485634,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sourc7","bl4de","kwalberg"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":833590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OpenSSH: CVE-2016-3115\nDropbear: CVE-2016-3116\n\nhttp://seclists.org/oss-sec/2016/q1/593","markdown_message":"\u003cp\u003eOpenSSH: CVE-2016-3115\u003cbr\u003e\nDropbear: CVE-2016-3116\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://seclists.org/oss-sec/2016/q1/593\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Foss-sec%2F2016%2Fq1%2F593\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/oss-sec/2016/q1/593\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-10T18:02:58.285Z","updated_at":"2016-03-10T18:02:58.285Z","actor":{"username":"hxd","cleared":false,"url":"/hxd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":833647,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"final links; research material (info,poc,patch,...)\nhttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115\nhttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3116","markdown_message":"\u003cp\u003efinal links; research material (info,poc,patch,...)\u003cbr\u003e\n\u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-3115\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3116\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-3116\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3116\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-10T18:32:45.387Z","updated_at":"2016-03-10T18:32:45.387Z","actor":{"username":"hxd","cleared":false,"url":"/hxd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":873582,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-27T22:50:10.533Z","updated_at":"2016-03-27T22:50:10.533Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"hxd","url":"/hxd"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":873583,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-27T22:50:18.734Z","updated_at":"2016-03-27T22:50:18.734Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hxd","url":"/hxd"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6026643,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-13T09:45:16.322Z","updated_at":"2019-10-13T09:45:16.322Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6285931,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-12T09:45:23.583Z","updated_at":"2019-11-12T09:45:23.583Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1568,"category":"team","content":"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-3115\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-3115\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}