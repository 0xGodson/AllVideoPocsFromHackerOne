{"id":50776,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDc3Ng==","url":"https://hackerone.com/reports/50776","title":"A user can edit comments even after video comments are disabled","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-10T09:12:26.084Z","submitted_at":"2015-03-10T09:12:26.084Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-11T14:37:33.636Z","bug_reporter_agreed_on_going_public_at":"2015-03-11T02:47:19.616Z","team_member_agreed_on_going_public_at":"2015-03-11T14:37:32.691Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A user can escalate privileges and edit his previous comments, when comments are disabled for a video.\r\n\r\nSteps to verify:\r\n1. Log into vimeo.com as Alice. Upload a video (say, video id - 118026546) and allow anyone to leave comments for that video .\r\n2. Login as Bob and navigate to the video URL - https://vimeo.com/118026546.\r\n3. Leave a comment. Edit that comment and capture the request using burp proxy. Captured request looks like -\r\n\r\n    POST /118026546 HTTP/1.1\r\n    Host: vimeo.com\r\n    [...]\r\n    \r\n    text=abcd\u0026action=edit_comment\u0026comment_id=12984882\u0026token=[...]\r\n\r\n4. From Alice account, change the video settings and do not allow anyone to comment.\r\n5. From Bob account, access the video url (https://vimeo.com/118026546) and it displays 'Sorry,     comments have been disabled by the owner of this video' message. At this point Bob can't add new comments or edit previous comments. However, Bob can edit his previous comments by replaying the request captured in step 3.","vulnerability_information_html":"\u003cp\u003eA user can escalate privileges and edit his previous comments, when comments are disabled for a video.\u003c/p\u003e\n\n\u003cp\u003eSteps to verify:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into vimeo.com as Alice. Upload a video (say, video id - 118026546) and allow anyone to leave comments for that video .\u003c/li\u003e\n\u003cli\u003eLogin as Bob and navigate to the video URL - \u003ca title=\"https://vimeo.com/118026546\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F118026546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/118026546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLeave a comment. Edit that comment and capture the request using burp proxy. Captured request looks like -\u003c/p\u003e\n\n\u003cp\u003ePOST /118026546 HTTP/1.1\u003cbr\u003e\nHost: vimeo.com\u003cbr\u003e\n[...]\u003c/p\u003e\n\n\u003cp\u003etext=abcd\u0026amp;action=edit_comment\u0026amp;comment_id=12984882\u0026amp;token=[...]\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFrom Alice account, change the video settings and do not allow anyone to comment.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFrom Bob account, access the video url (\u003ca title=\"https://vimeo.com/118026546\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F118026546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/118026546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and it displays \u0026#39;Sorry,     comments have been disabled by the owner of this video\u0026#39; message. At this point Bob can\u0026#39;t add new comments or edit previous comments. However, Bob can edit his previous comments by replaying the request captured in step 3.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-10T02:47:20.335Z","allow_singular_disclosure_after":-180588272.5591365,"singular_disclosure_allowed":true,"vote_count":1,"voters":["eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":350240,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-10T17:10:34.261Z","updated_at":"2015-03-10T17:10:34.261Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350245,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-10T17:10:42.183Z","updated_at":"2015-03-10T17:10:42.183Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T02:47:19.672Z","updated_at":"2015-03-11T02:47:19.672Z","first_to_agree":true,"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351106,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:37:32.783Z","updated_at":"2015-03-11T14:37:32.783Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351107,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:37:33.677Z","updated_at":"2015-03-11T14:37:33.677Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}