{"id":394861,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTQ4NjE=","url":"https://hackerone.com/reports/394861","title":"Incorrect Permission Assignment for Critical Resource","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-14T10:20:51.773Z","submitted_at":"2018-08-14T10:20:51.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dhiraj-mishra","url":"/dhiraj-mishra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8724,"url":"https://hackerone.com/mariadb","handle":"mariadb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"MariaDB","twitter_handle":"mariadb_org","website":"https://mariadb.org","about":"MariaDB is a high performance, open source database that helps the world's busiest websites deliver more content, faster."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-14T09:03:30.215Z","bug_reporter_agreed_on_going_public_at":"2018-11-14T09:03:30.147Z","team_member_agreed_on_going_public_at":"2018-10-22T08:31:51.244Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Team, \n\nProduct Affected: https://github.com/MariaDB/server\n\nFile:\n /server/blob/10.3/sql/mysqld.cc#L2761\n\n```\n}\n    if (!SetSecurityDescriptorDacl(\u0026sdPipeDescriptor, TRUE, NULL, FALSE))\n{\n```\n\nThis was purely identified on code review, Never create NULL ACLs.\n\nA mail was sent to security@mariadb.org and MariaDB team is working on this and a fix will be pushed in next version, attached mail headers for your reference.\n\n## Impact\n\nAn attacker can set it to Everyone (Deny All  Access), which would even forbid administrator access and may lead to privilege escalation.","vulnerability_information_html":"\u003cp\u003eDear Team, \u003c/p\u003e\n\n\u003cp\u003eProduct Affected: \u003ca title=\"https://github.com/MariaDB/server\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FMariaDB%2Fserver\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/MariaDB/server\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFile:\u003cbr\u003e\n /server/blob/10.3/sql/mysqld.cc#L2761\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e}\n    if (!SetSecurityDescriptorDacl(\u0026amp;sdPipeDescriptor, TRUE, NULL, FALSE))\n{\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis was purely identified on code review, Never create NULL ACLs.\u003c/p\u003e\n\n\u003cp\u003eA mail was sent to \u003ca title=\"security@mariadb.org\" href=\"mailto:security@mariadb.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@mariadb.org\u003c/a\u003e and MariaDB team is working on this and a fix will be pushed in next version, attached mail headers for your reference.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can set it to Everyone (Deny All  Access), which would even forbid administrator access and may lead to privilege escalation.\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":333259,"file_name":"MailFrom-security_mariadb.org.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/259/4e1260e6f461c1f9f4b7282c09c1ed11e0491fd7/MailFrom-security_mariadb.org.txt?response-content-disposition=attachment%3B%20filename%3D%22MailFrom-security_mariadb.org.txt%22%3B%20filename%2A%3DUTF-8%27%27MailFrom-security_mariadb.org.txt\u0026response-content-type=message%2Frfc822\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055017Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=fd5bcd8c1422c24018983a66bfde8fc3716660a072ba5ceec237bce57e4014c2","file_size":11782,"type":"message/rfc822"},{"id":333261,"file_name":"MariaDB.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/261/4300336c079b7d9911daac12d985ee24259723bd/MariaDB.png?response-content-disposition=attachment%3B%20filename%3D%22MariaDB.png%22%3B%20filename%2A%3DUTF-8%27%27MariaDB.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055017Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=23b757843aa9cc691f6cbbc56186a42835b948446f9688b058408e5983651703","file_size":212987,"type":"image/png"},{"id":333262,"file_name":"MariaDB-2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/262/a65e957dedf73e2a770fd80ce5a38fa5f8732306/MariaDB-2.png?response-content-disposition=attachment%3B%20filename%3D%22MariaDB-2.png%22%3B%20filename%2A%3DUTF-8%27%27MariaDB-2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055017Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=2c28bac8f437d9aee2e09e1fb5a29fd682dfb8c7ffb3c2d8fc2584f910ab8201","file_size":19622,"type":"image/png"}],"allow_singular_disclosure_at":"2018-11-21T08:31:51.312Z","allow_singular_disclosure_after":-66431906.23507673,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sameerphad72","mygf","eveeez","cryptographer","yaaya"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":10335,"asset_type":"SOURCE_CODE","asset_identifier":"MariaDB Server \u0026 Connectors - Access control bypass","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3193661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue is been patched.\nFYI: https://jira.mariadb.org/browse/MDEV-16963","markdown_message":"\u003cp\u003eThis issue is been patched.\u003cbr\u003e\nFYI: \u003ca title=\"https://jira.mariadb.org/browse/MDEV-16963\" href=\"/redirect?url=https%3A%2F%2Fjira.mariadb.org%2Fbrowse%2FMDEV-16963\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://jira.mariadb.org/browse/MDEV-16963\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-14T10:43:37.196Z","updated_at":"2018-08-14T10:53:00.128Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3193680,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-14T10:55:07.266Z","updated_at":"2018-08-14T10:55:07.266Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":196309},"actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3193681,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @dhiraj-mishra,\n\nThanks for your report!\n\nAs you sent this to the security list first, it has been resolved in MDEV-16963 that you linked, I'll close this here with resolved so you receive the H1 thank you points. :)\n\nThis was not a critical issue, thus we won't release patch versions outside the normal release schedule. The fix will be available in the next scheduled version release 5.5.62 and 10.0.37, respectively.\n\nCheers,\nMariaDB Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dhiraj-mishra\"\u003e@dhiraj-mishra\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report!\u003c/p\u003e\n\n\u003cp\u003eAs you sent this to the security list first, it has been resolved in MDEV-16963 that you linked, I\u0026#39;ll close this here with resolved so you receive the H1 thank you points. :)\u003c/p\u003e\n\n\u003cp\u003eThis was not a critical issue, thus we won\u0026#39;t release patch versions outside the normal release schedule. The fix will be available in the next scheduled version release 5.5.62 and 10.0.37, respectively.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nMariaDB Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-14T10:55:57.347Z","updated_at":"2018-08-14T10:59:55.355Z","actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dhiraj-mishra","url":"/dhiraj-mishra"},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3512617,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\n\nIn accordance with our Responsible Disclosure Policy we are now publicly disclosing the details of this report and its resolution.\n\nThank you,\nMariaDB Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIn accordance with our Responsible Disclosure Policy we are now publicly disclosing the details of this report and its resolution.\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\nMariaDB Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T08:31:51.266Z","updated_at":"2018-10-22T08:31:51.266Z","first_to_agree":true,"actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3641208,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T09:03:30.177Z","updated_at":"2018-11-14T09:03:30.177Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3641209,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T09:03:30.236Z","updated_at":"2018-11-14T09:03:30.236Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}