{"id":200576,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA1NzY=","url":"https://hackerone.com/reports/200576","title":"Logic flaw enables restricted account to access account license key","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-23T18:30:19.956Z","submitted_at":"2017-01-23T18:30:19.956Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-04T17:08:57.158Z","bug_reporter_agreed_on_going_public_at":"2020-08-20T02:50:46.284Z","team_member_agreed_on_going_public_at":"2020-09-04T17:08:57.034Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello - this is a resubmission of my report #197071 that was sent to the public NewRelic program.\n\nYou have a serious logic flaw which results in a restricted account being able to view the account license key. This is able to be performed by logging into a restricted account, clicking on the \"Infrastructure\" tab, then going through the process of setting up a windows platform.\n\n##Step by step instructions\n\n1. Admin creates a New Relic account, invites User1 as a restricted user to join the team\n2. User2 joins the team, then clicks on \"Infrastructure\" tab\n3. User2 clicks on \"Start my 30 day free trial\", then they are directed to this url: https://infrastructure.newrelic.com/accounts/1523936/install\n4. At this URL, User2 then clicks on \"Windows\" platform\n5. License key is in plain view on this page (see screenshots)\n\nThe application on this page believes that the restricted user has an elevated privilege on this page, when in reality User2 is still a restricted user.\n\nPlease let me know if you have any additional questions, thanks.\n\nJon Bottarini\n\n2 attachments:\nF151037: Expected_behavior.png\nF151038: Visible_key.png","vulnerability_information_html":"\u003cp\u003eHello - this is a resubmission of my report \u003ca href=\"/reports/197071\"\u003e#197071\u003c/a\u003e that was sent to the public NewRelic program.\u003c/p\u003e\n\n\u003cp\u003eYou have a serious logic flaw which results in a restricted account being able to view the account license key. This is able to be performed by logging into a restricted account, clicking on the \u0026quot;Infrastructure\u0026quot; tab, then going through the process of setting up a windows platform.\u003c/p\u003e\n\n\u003ch2 id=\"step-by-step-instructions\"\u003eStep by step instructions\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAdmin creates a New Relic account, invites User1 as a restricted user to join the team\u003c/li\u003e\n\u003cli\u003eUser2 joins the team, then clicks on \u0026quot;Infrastructure\u0026quot; tab\u003c/li\u003e\n\u003cli\u003eUser2 clicks on \u0026quot;Start my 30 day free trial\u0026quot;, then they are directed to this url: \u003ca title=\"https://infrastructure.newrelic.com/accounts/1523936/install\" href=\"/redirect?url=https%3A%2F%2Finfrastructure.newrelic.com%2Faccounts%2F1523936%2Finstall\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://infrastructure.newrelic.com/accounts/1523936/install\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAt this URL, User2 then clicks on \u0026quot;Windows\u0026quot; platform\u003c/li\u003e\n\u003cli\u003eLicense key is in plain view on this page (see screenshots)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe application on this page believes that the restricted user has an elevated privilege on this page, when in reality User2 is still a restricted user.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you have any additional questions, thanks.\u003c/p\u003e\n\n\u003cp\u003eJon Bottarini\u003c/p\u003e\n\n\u003cp\u003e2 attachments:\u003cbr\u003e\nF151037: Expected_behavior.png\u003cbr\u003e\nF151038: Visible_key.png\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":154485,"file_name":"Expected_behavior.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/154/485/0e5bb9139c11d9c6383acfb8beea99492e363a86/Expected_behavior.png?response-content-disposition=attachment%3B%20filename%3D%22Expected_behavior.png%22%3B%20filename%2A%3DUTF-8%27%27Expected_behavior.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045312Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=db9e20064b1bc6819d2ab0097f7e818e65743b734ed833c3eb0d7c11a3a9b0c2","file_size":241757,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-19T02:50:46.356Z","allow_singular_disclosure_after":-8733746.513043433,"singular_disclosure_allowed":true,"vote_count":7,"voters":["wi11","mygf","aliasnotallowed","hacker_hack5968","xtoxicscriptx","heermohit","furi0us_root"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1439106,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-23T19:29:21.132Z","updated_at":"2017-01-23T19:29:21.132Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":21148,"new_severity_id":21169},"actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1439113,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jon_bottarini,\n\nThanks for resubmitting this issue. We'll reach out if we have any updates.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for resubmitting this issue. We\u0026#39;ll reach out if we have any updates.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T19:30:23.827Z","updated_at":"2017-01-23T19:30:23.827Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1439131,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @jon_bottarini,\n\nWe've determined that this bug is eligible for a bounty.\n\nThank you for helping to keep New Relic secure!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve determined that this bug is eligible for a bounty.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping to keep New Relic secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T19:37:29.710Z","updated_at":"2017-01-23T19:40:07.298Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1439136,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dmcmahon  @newrelic-vip  Thank you very much! Pleasure working with you guys! ","markdown_message":"\u003cp\u003e\u003ca href=\"/dmcmahon\"\u003e@dmcmahon\u003c/a\u003e  \u003ca href=\"/newrelic-vip\"\u003e@newrelic-vip\u003c/a\u003e  Thank you very much! Pleasure working with you guys! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T19:40:38.998Z","updated_at":"2017-01-23T19:40:38.998Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1717222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there @newrelic-vip - just wanted to check up and see if this was going to be resolved anytime soon? Thanks! ","markdown_message":"\u003cp\u003eHi there \u003ca href=\"/newrelic-vip\"\u003e@newrelic-vip\u003c/a\u003e - just wanted to check up and see if this was going to be resolved anytime soon? Thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-31T18:09:56.470Z","updated_at":"2017-05-31T18:09:56.470Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1750116,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @jon_bottarini,\n\nSorry for the delay, we believe this issue to be fixed now.\n\nPlease let us know if you have confirmed on your end that this issue is corrected, and we can mark this as Resolved.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay, we believe this issue to be fixed now.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you have confirmed on your end that this issue is corrected, and we can mark this as Resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-12T17:43:33.779Z","updated_at":"2017-06-12T17:43:33.779Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1750409,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"This doesn't look resolved to me. Using an account with restricted access, I'm still able to see the license key during the setup process for NR Infrastructure. \n\n{F193636}","markdown_message":"\u003cp\u003eThis doesn\u0026#39;t look resolved to me. Using an account with restricted access, I\u0026#39;m still able to see the license key during the setup process for NR Infrastructure. \u003c/p\u003e\n\n\u003cp\u003e{F193636}\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-12T19:13:40.455Z","updated_at":"2017-06-12T19:13:40.455Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1750897,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jon_bottarini,\n\nThanks for checking into that. I've been able to confirm it on my end as well.\n\nI've reached out to the team in question and, while the fix itself is in flight, it has yet to be deployed. That may apply to the other issue you reported as well which falls under the same root cause.\n\nI'll keep an eye on that internal issue and reach out again when we have an update. Thank you for your help!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for checking into that. I\u0026#39;ve been able to confirm it on my end as well.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve reached out to the team in question and, while the fix itself is in flight, it has yet to be deployed. That may apply to the other issue you reported as well which falls under the same root cause.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll keep an eye on that internal issue and reach out again when we have an update. Thank you for your help!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-12T21:56:12.151Z","updated_at":"2017-06-12T21:56:12.151Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1883722,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jon_bottarini,\n\nWe have enabled the fix for this issue and we should be all done here. Please let us know if you continue to be able to reproduce this issue.\n\nThank you for your report(s)!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe have enabled the fix for this issue and we should be all done here. Please let us know if you continue to be able to reproduce this issue.\u003c/p\u003e\n\n\u003cp\u003eThank you for your report(s)!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-01T21:30:50.338Z","updated_at":"2017-08-01T21:30:50.338Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8984374,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Could we remove the screenshots of the license key? Thanks! ","markdown_message":"\u003cp\u003eCould we remove the screenshots of the license key? Thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-20T02:50:46.308Z","updated_at":"2020-08-20T02:50:46.308Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9132315,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-04T17:08:57.066Z","updated_at":"2020-09-04T17:08:57.066Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9132316,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-04T17:08:57.194Z","updated_at":"2020-09-04T17:08:57.194Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}