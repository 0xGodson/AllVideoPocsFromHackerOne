{"id":480883,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODA4ODM=","url":"https://hackerone.com/reports/480883","title":"Stack overflow in XML Parsing","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-16T11:03:23.213Z","submitted_at":"2019-01-16T11:03:23.213Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ammm","url":"/ammm","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/095/536/9f2ee41793a33985a2a764fddd0a15f218820b2e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":36721,"url":"https://hackerone.com/notepad-plus-plus","handle":"notepad-plus-plus","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Notepad++","twitter_handle":"notepad_plus","website":"https://notepad-plus-plus.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-25T12:50:13.333Z","bug_reporter_agreed_on_going_public_at":"2019-07-26T12:50:12.426Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n\nA stack buffer overflow vulnerability has been detected in XML parsing functionality  on Notepad++.\n\nThat's due to the fact that _invisibleEditView.getText function doesn't check buffer boundaries.\n\n**Description:** \nVulnerability src file: notepad-plus-plus/PowerEditor/src/Notepad_plus.cpp\nVulnerability line: line 1008\nVariable affected: char encodingStr[128];\nFunction that overflows buffer: _invisibleEditView.getText\n\n## Steps To Reproduce:\n\n  1. Create a .xml file with a correct XML format\n  2. Introduce a big XML field that overflows \"encodingStr\" buffer.\n  3. Open the file with Notepad++ and application should crash.\n\n## Supporting Material/References:\n\n  * BoF_example1.xml -\u003e Exploit example\n\n## Impact\n\nAn attacker could create a malicious .xml file that triggers a stack buffer overflow on victim machine.\n\nYou only need to open attached .xml file example with Notepad++ to reproduce the exploit.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eA stack buffer overflow vulnerability has been detected in XML parsing functionality  on Notepad++.\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s due to the fact that _invisibleEditView.getText function doesn\u0026#39;t check buffer boundaries.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nVulnerability src file: notepad-plus-plus/PowerEditor/src/Notepad_plus.cpp\u003cbr\u003e\nVulnerability line: line 1008\u003cbr\u003e\nVariable affected: char encodingStr[128];\u003cbr\u003e\nFunction that overflows buffer: _invisibleEditView.getText\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a .xml file with a correct XML format\u003c/li\u003e\n\u003cli\u003eIntroduce a big XML field that overflows \u0026quot;encodingStr\u0026quot; buffer.\u003c/li\u003e\n\u003cli\u003eOpen the file with Notepad++ and application should crash.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eBoF_example1.xml -\u0026gt; Exploit example\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could create a malicious .xml file that triggers a stack buffer overflow on victim machine.\u003c/p\u003e\n\n\u003cp\u003eYou only need to open attached .xml file example with Notepad++ to reproduce the exploit.\u003c/p\u003e\n","bounty_amount":"2862.23","formatted_bounty":"$2,862.23","weakness":{"id":4,"name":"Stack Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":407247,"file_name":"BoF_Example1.xml","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/407/247/d33f5c4346a468e7ebc04e8d8a14c40f5261faa7/BoF_Example1.xml?response-content-disposition=attachment%3B%20filename%3D%22BoF_Example1.xml%22%3B%20filename%2A%3DUTF-8%27%27BoF_Example1.xml\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060459Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=e331ef37118afeec946b969001ff2ff0ded8f074ffcc863badf9c5f8194de30c","file_size":119650,"type":"application/xml"}],"allow_singular_disclosure_at":"2019-08-25T12:50:12.593Z","allow_singular_disclosure_after":-42484486.607074186,"singular_disclosure_allowed":true,"vote_count":98,"voters":["sp1d3rs","sultancad","karma7","secator","mashoud1122","bl4de","un4gi","spam404","mik317","sameerphad72","and 88 more..."],"severity":{"rating":"high","score":8.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3986632,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ammm,\n\nThanks for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@lasagna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ammm\"\u003e@ammm\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/lasagna\"\u003e@lasagna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T12:22:38.775Z","updated_at":"2019-01-16T12:22:38.775Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3986724,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @ammm \n\nThanks for your report. I can see in the source code that the buffers are not properly checked, but I'm unable to reproduce the crashing of Notepad when I open the file. The file just opens and I'm able to edit it. Is there any other interaction needed to achieve this?\n\n@lasagna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ammm\"\u003e@ammm\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your report. I can see in the source code that the buffers are not properly checked, but I\u0026#39;m unable to reproduce the crashing of Notepad when I open the file. The file just opens and I\u0026#39;m able to edit it. Is there any other interaction needed to achieve this?\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/lasagna\"\u003e@lasagna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T12:45:55.818Z","updated_at":"2019-01-16T12:45:55.818Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3987155,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi lasagna,\n\nexploit has been tested on my machine running Notepad++  v7.6.2 (32 bits).\n\nIf you open the file with 32 bits version it should works :)\n\nhttps://notepad-plus-plus.org/repository/7.x/7.6.2/npp.7.6.2.Installer.exe","markdown_message":"\u003cp\u003eHi lasagna,\u003c/p\u003e\n\n\u003cp\u003eexploit has been tested on my machine running Notepad++  v7.6.2 (32 bits).\u003c/p\u003e\n\n\u003cp\u003eIf you open the file with 32 bits version it should works :)\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://notepad-plus-plus.org/repository/7.x/7.6.2/npp.7.6.2.Installer.exe\" href=\"/redirect?url=https%3A%2F%2Fnotepad-plus-plus.org%2Frepository%2F7.x%2F7.6.2%2Fnpp.7.6.2.Installer.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://notepad-plus-plus.org/repository/7.x/7.6.2/npp.7.6.2.Installer.exe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T14:49:22.340Z","updated_at":"2019-01-16T15:01:50.326Z","actor":{"username":"ammm","cleared":false,"url":"/ammm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/536/9f2ee41793a33985a2a764fddd0a15f218820b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3987539,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @ammm,\n\nThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@lasagna ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ammm\"\u003e@ammm\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/lasagna\"\u003e@lasagna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T16:04:26.745Z","updated_at":"2019-01-16T16:04:26.745Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3987548,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-16T16:06:26.851Z","updated_at":"2019-01-16T16:06:26.851Z","additional_data":{"old_severity":"High","new_severity":"High (8.1)","old_severity_id":280732,"new_severity_id":280836},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3990653,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-17T07:37:49.430Z","updated_at":"2019-01-17T07:37:49.430Z","additional_data":{"duplicate_report_id":481161},"actor":{"username":"pendrek","cleared":false,"url":"/pendrek","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075548,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @ammm \n\nIncredible find thank you!!\n\nThe team have confirmed your vulnerability as a 8.1 High severity impact and are awarding you €2500!\n\nThe H1 platform doesn't allow €URO payments, hence the funky $2,862.23 amount.\n\nThe USD$ conversion for today is 1 United States Dollar equals 0.87 Euro.\n\nThanks for your help and participating in this program.\n\nKind Regards\nHackerOne","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ammm\"\u003e@ammm\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eIncredible find thank you!!\u003c/p\u003e\n\n\u003cp\u003eThe team have confirmed your vulnerability as a 8.1 High severity impact and are awarding you €2500!\u003c/p\u003e\n\n\u003cp\u003eThe H1 platform doesn\u0026#39;t allow €URO payments, hence the funky $2,862.23 amount.\u003c/p\u003e\n\n\u003cp\u003eThe USD$ conversion for today is 1 United States Dollar equals 0.87 Euro.\u003c/p\u003e\n\n\u003cp\u003eThanks for your help and participating in this program.\u003c/p\u003e\n\n\u003cp\u003eKind Regards\u003cbr\u003e\nHackerOne\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T01:27:55.273Z","updated_at":"2019-02-01T01:27:55.273Z","actor":{"url":"/notepad-plus-plus","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Notepad++"}},"bounty_amount":"2862.23","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"notepad-plus-plus","collaborator":{"username":"ammm","url":"/ammm"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4079126,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-01T10:56:25.707Z","updated_at":"2019-02-01T10:56:25.707Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ammm","url":"/ammm"},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5438312,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-26T12:50:12.466Z","updated_at":"2019-07-26T12:50:12.466Z","first_to_agree":true,"actor":{"username":"ammm","cleared":false,"url":"/ammm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/536/9f2ee41793a33985a2a764fddd0a15f218820b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5660562,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-25T12:50:13.348Z","updated_at":"2019-08-25T12:50:13.348Z","actor":{"url":"/notepad-plus-plus","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Notepad++"}},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}