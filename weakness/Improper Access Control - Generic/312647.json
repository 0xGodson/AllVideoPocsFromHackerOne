{"id":312647,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTI2NDc=","url":"https://hackerone.com/reports/312647","title":"Gaining access to private topics using quoting feature","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-02-05T21:45:55.181Z","submitted_at":"2018-02-05T21:45:55.181Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"mishre","url":"/mishre","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16893,"url":"https://hackerone.com/discourse","handle":"discourse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Discourse","twitter_handle":"discourse","website":"https://discourse.org","about":"Discourse is JavaScript (ember.js) and Ruby on Rails based 100% open source discussion software -- https://github.com/discourse/discourse"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-03-17T18:27:00.122Z","bug_reporter_agreed_on_going_public_at":"2018-02-15T18:26:47.246Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nSome topics have limited access to certain groups and users, and while there exists a validation for access on this topic, it can be bypassed by abusing a vulnerability in the \"onebox\" quoting feature. \nWhen pasting a link in a reply, if this link happens to be a link to another topic on Discourse a small preview is shown which includes the topic content or the post content where the link is pointing to. Also there are some protections in place to make sure that the user can view the linked content, the said protections can be bypassed by adding a query string parameter to the link containing the value \n```\n?source_topic_id={victim-topic-id}\n```\n\n## Steps to reproduce\n1. Login as an administrator to Discourse and create a topic which can only be viewed by the staff.\n2. Copy the topic's id from the topic's page. the topic id can be found by browsing the topic and then copying the number in the end of the url (`http://localhost:4000/t/{topic-name}/{topic-id}`)\n3. Login with a non-admin user.\n4. Go to any topic you have access to, and type in the following reply:\n```\nhttp://localhost:80/t/blablabla/?source_topic_id=29\n```\nplease note that the port should 80 or 443 even if the url of your local installation is a different (probably some software bug)\n5. Wait for the preview to load and see that you can see topic's content.\n\n## Root cause\nThe following piece of code determines if the logged-in user is capable of viewing the post/topic :\n\n```\n        def can_see_post?(post, source_topic)\n          return false if post.nil? || post.hidden || post.trashed? || post.topic.nil?\n          Guardian.new.can_see_post?(post) || same_category?(post.topic.category, source_topic)\n        end\n\n        def can_see_topic?(topic, source_topic)\n          return false if topic.nil? || topic.trashed? || topic.private_message?\n          Guardian.new.can_see_topic?(topic) || same_category?(topic.category, source_topic)\n        end\n```\nas can be seen here: https://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L113\n\nHowever, the source_topic parameter is controlled directly by user input:\n```\nsource_topic_id = @url[/[\u0026?]source_topic_id=(\\d+)/, 1].to_i\n```\nas can be seen here: \nhttps://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L47\nSo if we pass in the same topic id as the one we are trying to view, basically the function same_category will always return true, effectively bypassing any protection in place.\n\n## Impact\n\nAn attacker will be able to access all private topics and posts on Discourse.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eSome topics have limited access to certain groups and users, and while there exists a validation for access on this topic, it can be bypassed by abusing a vulnerability in the \u0026quot;onebox\u0026quot; quoting feature. \u003cbr\u003e\nWhen pasting a link in a reply, if this link happens to be a link to another topic on Discourse a small preview is shown which includes the topic content or the post content where the link is pointing to. Also there are some protections in place to make sure that the user can view the linked content, the said protections can be bypassed by adding a query string parameter to the link containing the value \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e?source_topic_id={victim-topic-id}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin as an administrator to Discourse and create a topic which can only be viewed by the staff.\u003c/li\u003e\n\u003cli\u003eCopy the topic\u0026#39;s id from the topic\u0026#39;s page. the topic id can be found by browsing the topic and then copying the number in the end of the url (\u003ccode\u003ehttp://localhost:4000/t/{topic-name}/{topic-id}\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eLogin with a non-admin user.\u003c/li\u003e\n\u003cli\u003eGo to any topic you have access to, and type in the following reply:\n\u003ccode\u003e\nhttp://localhost:80/t/blablabla/?source_topic_id=29\n\u003c/code\u003e\nplease note that the port should 80 or 443 even if the url of your local installation is a different (probably some software bug)\u003c/li\u003e\n\u003cli\u003eWait for the preview to load and see that you can see topic\u0026#39;s content.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"root-cause\"\u003eRoot cause\u003c/h2\u003e\n\n\u003cp\u003eThe following piece of code determines if the logged-in user is capable of viewing the post/topic :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        def can_see_post?(post, source_topic)\n          return false if post.nil? || post.hidden || post.trashed? || post.topic.nil?\n          Guardian.new.can_see_post?(post) || same_category?(post.topic.category, source_topic)\n        end\n\n        def can_see_topic?(topic, source_topic)\n          return false if topic.nil? || topic.trashed? || topic.private_message?\n          Guardian.new.can_see_topic?(topic) || same_category?(topic.category, source_topic)\n        end\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eas can be seen here: \u003ca title=\"https://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L113\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdiscourse%2Fdiscourse%2Fblob%2Fmaster%2Flib%2Fonebox%2Fengine%2Fdiscourse_local_onebox.rb%23L113\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L113\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHowever, the source_topic parameter is controlled directly by user input:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003esource_topic_id = @url[/[\u0026amp;?]source_topic_id=(\\d+)/, 1].to_i\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eas can be seen here: \u003cbr\u003e\n\u003ca title=\"https://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L47\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdiscourse%2Fdiscourse%2Fblob%2Fmaster%2Flib%2Fonebox%2Fengine%2Fdiscourse_local_onebox.rb%23L47\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/discourse/discourse/blob/master/lib/onebox/engine/discourse_local_onebox.rb#L47\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nSo if we pass in the same topic id as the one we are trying to view, basically the function same_category will always return true, effectively bypassing any protection in place.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker will be able to access all private topics and posts on Discourse.\u003c/p\u003e\n","bounty_amount":"256.0","formatted_bounty":"$256","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-03-17T18:26:47.394Z","allow_singular_disclosure_after":-87908747.0939732,"singular_disclosure_allowed":true,"vote_count":17,"voters":["sp1d3rs","kapytein","hunter","muon4","spam404","emitrani","asad0x01_","eveeez","malcolmx","apapedulimu","and 7 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2353607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oups, I have posted an incorrect link in step 4. The link should have been:\n```\nhttp://localhost:80/t/blablabla/{copied-topic-id}?source_topic_id={copied-topic-id}\n```\nfor example:\nhttp://localhost:80/t/blablabla/29?source_topic_id=29","markdown_message":"\u003cp\u003eOups, I have posted an incorrect link in step 4. The link should have been:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:80/t/blablabla/{copied-topic-id}?source_topic_id={copied-topic-id}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003efor example:\u003cbr\u003e\n\u003ca title=\"http://localhost/t/blablabla/29?source_topic_id=29\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Ft%2Fblablabla%2F29%3Fsource_topic_id%3D29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/t/blablabla/29?source_topic_id=29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-05T21:56:13.261Z","updated_at":"2018-02-05T21:56:13.261Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2358719,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@mishre \n\nThanks for the submission. I was not able to reproduce the issue. If I got your report correct, there's no need to have a link between both accounts...right? Basically, any account should be able to see any topic using this bug, is that correct? \n\nI'm trying to reproduce this on the live demo site with a random topic id, but the preview never opened:\n{F261075}\n\nCan you double check you PoC and the permissions/groups for both IDs you've used in your PoC?\n\nBest Regards.","markdown_message":"\u003cp\u003e\u003ca href=\"/mishre\"\u003e@mishre\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for the submission. I was not able to reproduce the issue. If I got your report correct, there\u0026#39;s no need to have a link between both accounts...right? Basically, any account should be able to see any topic using this bug, is that correct? \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m trying to reproduce this on the live demo site with a random topic id, but the preview never opened:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-02-07_at_10.57.30_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/075/c0c252f8589281fa2f10939226dd64c4a7dbd79f/Screen_Shot_2018-02-07_at_10.57.30_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-07_at_10.57.30_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-07_at_10.57.30_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053234Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026amp;X-Amz-Signature=827d6d408e7555031ceb1791e369e531e6df8ca0468d32aa7c0c2d40c5971c93\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/075/c0c252f8589281fa2f10939226dd64c4a7dbd79f/Screen_Shot_2018-02-07_at_10.57.30_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-07_at_10.57.30_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-07_at_10.57.30_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053234Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026amp;X-Amz-Signature=827d6d408e7555031ceb1791e369e531e6df8ca0468d32aa7c0c2d40c5971c93\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCan you double check you PoC and the permissions/groups for both IDs you\u0026#39;ve used in your PoC?\u003c/p\u003e\n\n\u003cp\u003eBest Regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-07T13:01:37.426Z","updated_at":"2018-02-07T13:01:37.426Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"attachments":[{"id":261075,"filename":"Screen_Shot_2018-02-07_at_10.57.30_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/075/c0c252f8589281fa2f10939226dd64c4a7dbd79f/Screen_Shot_2018-02-07_at_10.57.30_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-07_at_10.57.30_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-07_at_10.57.30_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053234Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=827d6d408e7555031ceb1791e369e531e6df8ca0468d32aa7c0c2d40c5971c93"}],"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2358738,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey,\n\nI have tested this on my local deployment with a topic id that I know exists and it seems to work. Are you sure that a topic with this id exists on the live demo site? (the topic could have been deleted, or it could actually be a private-message which is also represented by a topic object). \n\nAnd yes, anyone can view any private topic using this bug.","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eI have tested this on my local deployment with a topic id that I know exists and it seems to work. Are you sure that a topic with this id exists on the live demo site? (the topic could have been deleted, or it could actually be a private-message which is also represented by a topic object). \u003c/p\u003e\n\n\u003cp\u003eAnd yes, anyone can view any private topic using this bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-07T13:11:47.869Z","updated_at":"2018-02-07T13:14:14.740Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2359166,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@mishre \n\nCan you record a video of the exploitation in motion?","markdown_message":"\u003cp\u003e\u003ca href=\"/mishre\"\u003e@mishre\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eCan you record a video of the exploitation in motion?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-07T16:11:06.994Z","updated_at":"2018-02-07T16:11:06.994Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2360862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The repro steps are off, the URL is incorrect.. try this one:\n\n`https://try.discourse.org/t/blah/128?source_topic_id=128`\n\nThere is a topic 128 on try.discourse.org that you shouldn't have visibility into, and you can repro that way.","markdown_message":"\u003cp\u003eThe repro steps are off, the URL is incorrect.. try this one:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://try.discourse.org/t/blah/128?source_topic_id=128\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThere is a topic 128 on try.discourse.org that you shouldn\u0026#39;t have visibility into, and you can repro that way.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T01:06:05.238Z","updated_at":"2018-02-08T01:06:05.238Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2361151,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nIt seems I can view this topic. The title of topic is: \"Secret assets that should not be removed\". From some reason I cannot seem to be able to embed different images in it, However I do seem to see the text inside. I can also see that there is a single comment in the topic which was written by the user codinghorror and contains an image.\nSee attached images.\n\nIf you are still not able to reproduce I'll record a video.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIt seems I can view this topic. The title of topic is: \u0026quot;Secret assets that should not be removed\u0026quot;. From some reason I cannot seem to be able to embed different images in it, However I do seem to see the text inside. I can also see that there is a single comment in the topic which was written by the user codinghorror and contains an image.\u003cbr\u003e\nSee attached images.\u003c/p\u003e\n\n\u003cp\u003eIf you are still not able to reproduce I\u0026#39;ll record a video.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T04:43:59.787Z","updated_at":"2018-02-08T04:43:59.787Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":261310,"filename":"first.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/310/db32d2b62051162348408e9ed1efb59e8af6652d/first.png?response-content-disposition=attachment%3B%20filename%3D%22first.png%22%3B%20filename%2A%3DUTF-8%27%27first.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053234Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=4fa062a57c15b928e519f84fcbe29746273af6b54b04242f68c96ec6fe56f27b"},{"id":261309,"filename":"second.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/261/309/af376cde23cd440321a944d2470d39fe27b65304/second.png?response-content-disposition=attachment%3B%20filename%3D%22second.png%22%3B%20filename%2A%3DUTF-8%27%27second.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053234Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=6ed7577c6804d6020ada1d59646e9b174d0d8e62b58d885e7ce314f219fc68a9"}],"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2362740,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-08T14:11:23.928Z","updated_at":"2018-02-08T14:11:23.928Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2362744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @mishre for the report. We're working on a fix.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/mishre\"\u003e@mishre\u003c/a\u003e for the report. We\u0026#39;re working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T14:13:27.672Z","updated_at":"2018-02-08T14:13:27.672Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2384406,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"OK, thanks for this repro excellent as usual!","markdown_message":"\u003cp\u003eOK, thanks for this repro excellent as usual!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-14T22:18:44.903Z","updated_at":"2018-02-14T22:18:44.903Z","actor":{"url":"/discourse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Discourse"}},"bounty_amount":"256.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"discourse","collaborator":{"username":"mishre","url":"/mishre"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2384407,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-14T22:18:56.131Z","updated_at":"2018-02-14T22:18:56.131Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mishre","url":"/mishre"},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2387416,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"That was a pretty interesting bug, mind disclosing?","markdown_message":"\u003cp\u003eThat was a pretty interesting bug, mind disclosing?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-15T18:26:47.305Z","updated_at":"2018-02-15T18:26:47.305Z","first_to_agree":true,"actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2502014,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-17T18:27:00.143Z","updated_at":"2018-03-17T18:27:00.143Z","actor":{"url":"/discourse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Discourse"}},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}