{"id":304386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQzODY=","url":"https://hackerone.com/reports/304386","title":"Unrestricted access to https://██████.█████myteksi.net/","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-12T22:26:21.523Z","submitted_at":"2018-01-12T22:26:21.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reptou","url":"/reptou","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-12T07:09:58.517Z","bug_reporter_agreed_on_going_public_at":"2018-02-12T07:09:58.437Z","team_member_agreed_on_going_public_at":"2018-02-12T06:03:27.760Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again Grab Security Team !\n\nFollowing my previous research, it seems that your Microservices architecture you are currently running on *.█████myteksi.net is publicly exposed on another endpoint : https://█████████.█████myteksi.net. \n\n**Summary:** \n\nWhen researching and starting a new enumeration of your different subdomains, I found that https://███.████████myteksi.net is related to your Eureka / Zuul environment and is reachable without any filtering. \n\n**Description:**\n\nThis is a quite complex architecture, but I think that it reveals a lot of debug information that could help an attack find a vector, and certainly enables him to do some actions on this infrastructure without any control (this has to be confirmed as I do not want to perform any modification on your curent environment). \n\nIn order to understand the way this infrastructure works, I read the following documentation to discover some endpoints and see what could be achieved : http://cloud.spring.io/spring-cloud-static/Finchley.M5/single/spring-cloud.html#_health_indicator_2\n\nRegarding information gathering, there are different endpoints reachable for example :\n\n* https://█████.███████myteksi.net/info\n* https://████.██████myteksi.net/dump\n* https://███████.█████████myteksi.net/trace\n* https://████████.██████████myteksi.net/configprops\n* https://████████.███myteksi.net/env (from this one you got the eureka username and I guess the password too even if this is hidden ;-))\n* https://█████.████myteksi.net/beans\n* https://█████.█████myteksi.net/metrics\n* https://███.████myteksi.net/autoconfig\n* https://███.█████████myteksi.net/routes\n* https://██████████.█████████myteksi.net/features\n\nFor the action to be done, we may notice the following (extract from the documentation) :\n\n```\nFor a Spring Boot Actuator application there are some additional management endpoints:\n\n* POST to /env to update the Environment and rebind @ConfigurationProperties and log levels\n* /refresh for re-loading the boot strap context and refreshing the @RefreshScope beans\n* /restart for closing the ApplicationContext and restarting it (disabled by default)\n* /pause and /resume for calling the Lifecycle methods (stop() and start() on the ApplicationContext) \n```\nAs stated previously, I did not try these actions, but I have a good confidence that it will be executed without any restriction. \n\nFrom my point of view, this is an internal infrastructure that should not be exposed to any Internet user (as for the eureka endpoint previously reported). \n\n## Browsers Verified In:\n\nN/A\n\n## Steps To Reproduce:\n\n  1. Just try previous URL with correct HTTP Verb if necessary (GET / POST...)\n\nPlease let me know your thoughts on this,\n\nThank you !\n\nReptou\n\n## Impact\n\nThis is quite difficult to know exactly what could be achieved as the infrastructure is complex. However, I would say that it could first enable an attacker to understand better your infrastructure and identify weaknesses. The other point is that if the attacker is able to perform some actions, this could lead to DoS of this service in some cases and, of course, unexpected behaviour (modfying env properties ...)","vulnerability_information_html":"\u003cp\u003eHello again Grab Security Team !\u003c/p\u003e\n\n\u003cp\u003eFollowing my previous research, it seems that your Microservices architecture you are currently running on *.█████myteksi.net is publicly exposed on another endpoint : https://█████████.█████myteksi.net. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eWhen researching and starting a new enumeration of your different subdomains, I found that https://███.████████myteksi.net is related to your Eureka / Zuul environment and is reachable without any filtering. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is a quite complex architecture, but I think that it reveals a lot of debug information that could help an attack find a vector, and certainly enables him to do some actions on this infrastructure without any control (this has to be confirmed as I do not want to perform any modification on your curent environment). \u003c/p\u003e\n\n\u003cp\u003eIn order to understand the way this infrastructure works, I read the following documentation to discover some endpoints and see what could be achieved : \u003ca title=\"http://cloud.spring.io/spring-cloud-static/Finchley.M5/single/spring-cloud.html#_health_indicator_2\" href=\"/redirect?url=http%3A%2F%2Fcloud.spring.io%2Fspring-cloud-static%2FFinchley.M5%2Fsingle%2Fspring-cloud.html%23_health_indicator_2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://cloud.spring.io/spring-cloud-static/Finchley.M5/single/spring-cloud.html#_health_indicator_2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegarding information gathering, there are different endpoints reachable for example :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ehttps://█████.███████myteksi.net/info\u003c/li\u003e\n\u003cli\u003ehttps://████.██████myteksi.net/dump\u003c/li\u003e\n\u003cli\u003ehttps://███████.█████████myteksi.net/trace\u003c/li\u003e\n\u003cli\u003ehttps://████████.██████████myteksi.net/configprops\u003c/li\u003e\n\u003cli\u003ehttps://████████.███myteksi.net/env (from this one you got the eureka username and I guess the password too even if this is hidden ;-))\u003c/li\u003e\n\u003cli\u003ehttps://█████.████myteksi.net/beans\u003c/li\u003e\n\u003cli\u003ehttps://█████.█████myteksi.net/metrics\u003c/li\u003e\n\u003cli\u003ehttps://███.████myteksi.net/autoconfig\u003c/li\u003e\n\u003cli\u003ehttps://███.█████████myteksi.net/routes\u003c/li\u003e\n\u003cli\u003ehttps://██████████.█████████myteksi.net/features\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFor the action to be done, we may notice the following (extract from the documentation) :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eFor a Spring Boot Actuator application there are some additional management endpoints:\n\n* POST to /env to update the Environment and rebind [@ConfigurationProperties](/configurationproperties) and log levels\n* /refresh for re-loading the boot strap context and refreshing the [@RefreshScope](/refreshscope) beans\n* /restart for closing the ApplicationContext and restarting it (disabled by default)\n* /pause and /resume for calling the Lifecycle methods (stop() and start() on the ApplicationContext) \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs stated previously, I did not try these actions, but I have a good confidence that it will be executed without any restriction. \u003c/p\u003e\n\n\u003cp\u003eFrom my point of view, this is an internal infrastructure that should not be exposed to any Internet user (as for the eureka endpoint previously reported). \u003c/p\u003e\n\n\u003ch2 id=\"browsers-verified-in\"\u003eBrowsers Verified In:\u003c/h2\u003e\n\n\u003cp\u003eN/A\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eJust try previous URL with correct HTTP Verb if necessary (GET / POST...)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePlease let me know your thoughts on this,\u003c/p\u003e\n\n\u003cp\u003eThank you !\u003c/p\u003e\n\n\u003cp\u003eReptou\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis is quite difficult to know exactly what could be achieved as the infrastructure is complex. However, I would say that it could first enable an attacker to understand better your infrastructure and identify weaknesses. The other point is that if the attacker is able to perform some actions, this could lead to DoS of this service in some cases and, of course, unexpected behaviour (modfying env properties ...)\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":17,"voters":["europa","bugdiscloseguys","eveeez","khizer47","t-4-y-m","linkks","cr4xerbik4sh","japz","scraps","mr_unkn0n","and 7 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":1668,"asset_type":"URL","asset_identifier":"*.myteksi.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2281851,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @reptou, \n\nWe're looking into this one. Thank you. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/reptou\"\u003e@reptou\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re looking into this one. Thank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-13T01:30:37.374Z","updated_at":"2018-01-13T01:30:37.374Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have deployed a fix to address the issue. Can you verify if this has been fixed and you're no longer able to reproduce the behaviour ?\n","markdown_message":"\u003cp\u003eWe have deployed a fix to address the issue. Can you verify if this has been fixed and you\u0026#39;re no longer able to reproduce the behaviour ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-14T05:32:27.128Z","updated_at":"2018-01-14T05:32:27.128Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prakharprasad-grab \n\nThank you for the update ! It looks like you set maybe ip filtering at the tengine web server level as i get 403 forbidden error now when testing ? It looks good for me now. \n\nCould you please tell me if this was related to your production infrastructure ?\n\nI will keep you updated if I find something that could bypass this security control of course.\n\nThank you !\n\nReptou ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/prakharprasad-grab\"\u003e@prakharprasad-grab\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for the update ! It looks like you set maybe ip filtering at the tengine web server level as i get 403 forbidden error now when testing ? It looks good for me now. \u003c/p\u003e\n\n\u003cp\u003eCould you please tell me if this was related to your production infrastructure ?\u003c/p\u003e\n\n\u003cp\u003eI will keep you updated if I find something that could bypass this security control of course.\u003c/p\u003e\n\n\u003cp\u003eThank you !\u003c/p\u003e\n\n\u003cp\u003eReptou \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-14T05:45:46.957Z","updated_at":"2018-01-14T05:45:46.957Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283175,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the confirmation. \n\nMy sincere apologies but we cannot share more information at this time.  We'll be more than happy to know if you can bypass the controls :)\n\nThank you for working with us to keep Grab safe. \n\n\n","markdown_message":"\u003cp\u003eThanks for the confirmation. \u003c/p\u003e\n\n\u003cp\u003eMy sincere apologies but we cannot share more information at this time.  We\u0026#39;ll be more than happy to know if you can bypass the controls :)\u003c/p\u003e\n\n\u003cp\u003eThank you for working with us to keep Grab safe. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-14T06:18:20.773Z","updated_at":"2018-01-14T06:18:59.264Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"reptou","url":"/reptou"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok no problem I understand :) thank you and maybe see you on another report ;)\n\nReptou","markdown_message":"\u003cp\u003eOk no problem I understand :) thank you and maybe see you on another report ;)\u003c/p\u003e\n\n\u003cp\u003eReptou\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-14T07:47:01.501Z","updated_at":"2018-01-14T07:47:01.501Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2299502,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-19T06:01:41.541Z","updated_at":"2018-01-19T06:01:41.541Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grab"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"reptou","url":"/reptou"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2299519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty :)","markdown_message":"\u003cp\u003eThanks for the bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-19T06:20:07.367Z","updated_at":"2018-01-19T06:20:07.367Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373647,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-12T06:03:27.800Z","updated_at":"2018-02-12T06:03:27.800Z","first_to_agree":true,"actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373698,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-12T07:09:58.480Z","updated_at":"2018-02-12T07:09:58.480Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373699,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-12T07:09:58.547Z","updated_at":"2018-02-12T07:09:58.547Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}