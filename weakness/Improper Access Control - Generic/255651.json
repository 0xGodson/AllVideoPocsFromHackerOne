{"id":255651,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTU2NTE=","url":"https://hackerone.com/reports/255651","title":"Unauthorized update of merchants' information via /php/merchant_details.php","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-08-02T00:18:29.320Z","submitted_at":"2017-08-02T00:18:29.320Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"adibou","url":"/adibou","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/090/138/6c208ce8f7b366b90c297c39a409bb7dabca6ead_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-19T06:14:42.259Z","bug_reporter_agreed_on_going_public_at":"2017-09-06T15:19:16.974Z","team_member_agreed_on_going_public_at":"2017-09-19T06:14:42.219Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello!\n\nI discovered an interesting file : \n`https://www.zomato.com/php/merchant_details.php`\n\nIf I add in post content :\n`action=update-merchant\u0026merchant_id=95292\u0026type=1\u0026email=update@hotmail.fr\u0026contact=update@hotmail.fr\u0026name=update`\n\nWith the report #255648, I was able to create a merchant, I should use this merchant to provide a screenshot like in a real situation.\n\n\nI'm also able to change :\n`address, pincode, city, email, phone tan_number, bank account name, company_id, payu_id, contact, restaurants` and more...\n\n\nAn attacker would change the mail to receive confidential mails it may can be leading to an merchant takeover if you use the mail to bound it with the account of the user. I couldn't try this scenario due to your rules about users data.\n\nDo you have a test merchant_id i can play with to test that before you resolve the report?\n\nScreenshot : updatehttp.png\n\nIf you have any questions...\nnbsp\n","vulnerability_information_html":"\u003cp\u003eHello!\u003c/p\u003e\n\n\u003cp\u003eI discovered an interesting file : \u003cbr\u003e\n\u003ccode\u003ehttps://www.zomato.com/php/merchant_details.php\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIf I add in post content :\u003cbr\u003e\n\u003ccode\u003eaction=update-merchant\u0026amp;merchant_id=95292\u0026amp;type=1\u0026amp;email=update@hotmail.fr\u0026amp;contact=update@hotmail.fr\u0026amp;name=update\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWith the report \u003ca href=\"/reports/255648\"\u003e#255648\u003c/a\u003e, I was able to create a merchant, I should use this merchant to provide a screenshot like in a real situation.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m also able to change :\u003cbr\u003e\n\u003ccode\u003eaddress, pincode, city, email, phone tan_number, bank account name, company_id, payu_id, contact, restaurants\u003c/code\u003e and more...\u003c/p\u003e\n\n\u003cp\u003eAn attacker would change the mail to receive confidential mails it may can be leading to an merchant takeover if you use the mail to bound it with the account of the user. I couldn\u0026#39;t try this scenario due to your rules about users data.\u003c/p\u003e\n\n\u003cp\u003eDo you have a test merchant_id i can play with to test that before you resolve the report?\u003c/p\u003e\n\n\u003cp\u003eScreenshot : updatehttp.png\u003c/p\u003e\n\n\u003cp\u003eIf you have any questions...\u003cbr\u003e\nnbsp\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":209087,"file_name":"updatehttp.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/209/087/7858aaf445ff118f4c1dcebbb48503cb17d0636b/updatehttp.png?response-content-disposition=attachment%3B%20filename%3D%22updatehttp.png%22%3B%20filename%2A%3DUTF-8%27%27updatehttp.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051321Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=9ad9e0c8da832b274f141a9b96429569afbb1a32b101da2373ae43aa18dc24c6","file_size":81577,"type":"image/png"}],"allow_singular_disclosure_at":"2017-10-06T15:19:17.027Z","allow_singular_disclosure_after":-101915644.76043312,"singular_disclosure_allowed":true,"vote_count":11,"voters":["bl4de","flashdisk","eveeez","leet-boy","r3y","khizer47","mr_r3boot","japz","alxbrsn","r3dl3y","and 1 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1884232,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-02T02:24:43.543Z","updated_at":"2017-08-02T02:24:43.543Z","additional_data":{"old_title":"Arbitrary update of merchant's informations on https://www.zomato.com/php/merchant_details.php !","new_title":"Unauthorized update of merchants' information via /php/merchant_details.php"},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1884552,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should be fixed now. Marking this as resolved.\n\nThanks.","markdown_message":"\u003cp\u003eThis should be fixed now. Marking this as resolved.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-02T06:51:23.208Z","updated_at":"2017-08-02T06:51:23.208Z","actor":{"username":"shreysinha","cleared":false,"url":"/shreysinha","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"adibou","url":"/adibou"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1884830,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-02T10:03:07.740Z","updated_at":"2017-08-02T10:03:07.740Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"adibou","url":"/adibou"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1979883,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty, can we disclose? :')","markdown_message":"\u003cp\u003eThanks for the bounty, can we disclose? :\u0026#39;)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-06T15:19:16.996Z","updated_at":"2017-09-06T15:19:16.996Z","first_to_agree":true,"actor":{"username":"adibou","cleared":false,"url":"/adibou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/138/6c208ce8f7b366b90c297c39a409bb7dabca6ead_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2005190,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-19T06:14:42.239Z","updated_at":"2017-09-19T06:14:42.239Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2005191,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-19T06:14:42.278Z","updated_at":"2017-09-19T06:14:42.278Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}