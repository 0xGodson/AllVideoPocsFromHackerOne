{"id":360825,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjA4MjU=","url":"https://hackerone.com/reports/360825","title":"Origin IP found, Cloudflare bypassed","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-01T15:24:15.021Z","submitted_at":"2018-06-01T15:24:15.021Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"europa","url":"/europa","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-02T12:54:49.236Z","bug_reporter_agreed_on_going_public_at":"2018-06-02T12:54:49.159Z","team_member_agreed_on_going_public_at":"2018-06-02T12:53:56.466Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team,\nduring the initial assessment of your assets I've come across what seems to be the unprotected origin server for **www.liberapay.com**.\n\n### Description\nThe frontend currently resolves to `████` and `███`, both owned by Cloudflare, which act as your reverse proxy and WAF. By correlating your SSL Certificates to other hosts on the internet that serve the same content I was able to determine the current Origin Server as `██████████` and `██████`, both operated by Amazon's AWS services in the **EU-WEST-1** region.\n\nBy using these IP address as a resolver instead of the intended addresses I'm able to access the service without going through the WAF, thus I'm able to forward unfiltered payloads to the service, as well as avoiding the common protections offered by Cloudflare, also being able to perform crippling denial-of-services towards the origin.\n\n### Suggestions\nMy recommendations fall in line with [Cloudflare's own guidelines](https://support.cloudflare.com/hc/en-us/articles/201897700-Step-4-Recommended-First-Steps-for-all-Cloudflare-users): the Origin server _must_ communicate exclusively with Cloudflare's IP address ranges, otherwise—as reported in [this post on Cloudflare's blog](https://blog.cloudflare.com/ddos-prevention-protecting-the-origin/), the protection offered by having a reverse proxy basically becomes useless.\n\n## Impact\n\nAs reported in many other submissions, Cloudflare bypasses can have a significant impact, as any adversary is now able to communicate with the origin server directly, enabling them to perform unfiltered attacks (such as denial-of-service), and data retrieval.","vulnerability_information_html":"\u003cp\u003eHello team,\u003cbr\u003e\nduring the initial assessment of your assets I\u0026#39;ve come across what seems to be the unprotected origin server for \u003cstrong\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.liberapay.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.liberapay.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e\n\n\u003ch3 id=\"description\"\u003eDescription\u003c/h3\u003e\n\n\u003cp\u003eThe frontend currently resolves to \u003ccode\u003e████\u003c/code\u003e and \u003ccode\u003e███\u003c/code\u003e, both owned by Cloudflare, which act as your reverse proxy and WAF. By correlating your SSL Certificates to other hosts on the internet that serve the same content I was able to determine the current Origin Server as \u003ccode\u003e██████████\u003c/code\u003e and \u003ccode\u003e██████\u003c/code\u003e, both operated by Amazon\u0026#39;s AWS services in the \u003cstrong\u003eEU-WEST-1\u003c/strong\u003e region.\u003c/p\u003e\n\n\u003cp\u003eBy using these IP address as a resolver instead of the intended addresses I\u0026#39;m able to access the service without going through the WAF, thus I\u0026#39;m able to forward unfiltered payloads to the service, as well as avoiding the common protections offered by Cloudflare, also being able to perform crippling denial-of-services towards the origin.\u003c/p\u003e\n\n\u003ch3 id=\"suggestions\"\u003eSuggestions\u003c/h3\u003e\n\n\u003cp\u003eMy recommendations fall in line with \u003ca href=\"/redirect?url=https%3A%2F%2Fsupport.cloudflare.com%2Fhc%2Fen-us%2Farticles%2F201897700-Step-4-Recommended-First-Steps-for-all-Cloudflare-users\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCloudflare\u0026#39;s own guidelines\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e: the Origin server \u003cu\u003emust\u003c/u\u003e communicate exclusively with Cloudflare\u0026#39;s IP address ranges, otherwise—as reported in \u003ca href=\"/redirect?url=https%3A%2F%2Fblog.cloudflare.com%2Fddos-prevention-protecting-the-origin%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis post on Cloudflare\u0026#39;s blog\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the protection offered by having a reverse proxy basically becomes useless.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAs reported in many other submissions, Cloudflare bypasses can have a significant impact, as any adversary is now able to communicate with the origin server directly, enabling them to perform unfiltered attacks (such as denial-of-service), and data retrieval.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-02T12:53:56.555Z","allow_singular_disclosure_after":-78684546.77290915,"singular_disclosure_allowed":true,"vote_count":23,"voters":["jokebookservice1","europa","muon4","mik317","sameerphad72","romesful","emitrani","ankitsingh","eveeez","an0nym0us","and 13 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2829816,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. I am currently looking into this report and will report back in a bit.","markdown_message":"\u003cp\u003eThank you for your submission. I am currently looking into this report and will report back in a bit.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-01T15:29:00.121Z","updated_at":"2018-06-01T15:29:00.121Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2829936,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We already have a GitHub issue concerning this issue (https://github.com/liberapay/liberapay.com/issues/1093), but instead of closing this as a duplicate, I have decided to at least reward you with some reputation. Keep up the good work, @europa!","markdown_message":"\u003cp\u003eWe already have a GitHub issue concerning this issue (\u003ca title=\"https://github.com/liberapay/liberapay.com/issues/1093\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fissues%2F1093\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/liberapay/liberapay.com/issues/1093\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), but instead of closing this as a duplicate, I have decided to at least reward you with some reputation. Keep up the good work, \u003ca href=\"/europa\"\u003e@europa\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-01T16:03:48.447Z","updated_at":"2018-06-01T16:03:48.447Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"europa","url":"/europa"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2832816,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"This is a known issue, the report did not reveal the existence of a specific vulnerability that could be exploited by bypassing Cloudflare.","markdown_message":"\u003cp\u003eThis is a known issue, the report did not reveal the existence of a specific vulnerability that could be exploited by bypassing Cloudflare.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T09:17:47.639Z","updated_at":"2018-06-02T09:17:47.639Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833062,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-02T12:53:56.499Z","updated_at":"2018-06-02T12:53:56.499Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833063,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":" ༼ つ ◕_◕ ༽つ","markdown_message":"\u003cp\u003e༼ つ ◕_◕ ༽つ\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T12:54:49.190Z","updated_at":"2018-06-02T12:54:49.190Z","actor":{"username":"europa","cleared":true,"url":"/europa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2833064,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-02T12:54:49.266Z","updated_at":"2018-06-02T12:54:49.266Z","actor":{"username":"europa","cleared":true,"url":"/europa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7601,"category":"team","content":"Although this was a duplicate report of a [GitHub issue](https://github.com/liberapay/liberapay.com/issues/1093) that we had created previously, we decided to close this report as \"resolved\" to award a couple of points to @europa and all the similar submissions that we received after this report.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAlthough this was a duplicate report of a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fissues%2F1093\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGitHub issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that we had created previously, we decided to close this report as \u0026quot;resolved\u0026quot; to award a couple of points to \u003ca href=\"/europa\"\u003e@europa\u003c/a\u003e and all the similar submissions that we received after this report.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}