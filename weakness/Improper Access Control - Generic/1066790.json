{"id":1066790,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY2Nzkw","url":"https://hackerone.com/reports/1066790","title":"Internal API endpoint is accesible for everyone","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-12-26T21:55:14.561Z","submitted_at":"2020-12-26T21:55:14.606Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"arnonymous","url":"/arnonymous","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/115/966/039e3ef33791903eef67a80ca6a255b9cc7601de_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":51543,"url":"https://hackerone.com/who-covid-19-mobile-app","handle":"who-covid-19-mobile-app","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/wz2z6d5e6ox7n48beetcuc5kewkx/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22covidAssassinBadge_web_smaller.png%22%3B%20filename%2A%3DUTF-8%27%27covidAssassinBadge_web_smaller.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041447Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=197072f34fb4a566aec6d3ddaa278d87f94a1e2339feef35a2500a8a37ad3937","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/wz2z6d5e6ox7n48beetcuc5kewkx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22covidAssassinBadge_web_smaller.png%22%3B%20filename%2A%3DUTF-8%27%27covidAssassinBadge_web_smaller.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041447Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=e95c7be461828c0e5e9b09f1a7f397546464439eb5678cf682a50942ad3616de"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WHO COVID-19 Mobile App","twitter_handle":"","website":"","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-28T08:48:55.752Z","bug_reporter_agreed_on_going_public_at":"2020-12-28T08:48:55.679Z","team_member_agreed_on_going_public_at":"2020-12-28T07:57:17.303Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nIt looks like the endpoint **/internal/cron/refreshCaseStats** as configured in [cron.yaml]  (https://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/webapp/WEB-INF/cron.yaml#L3) is accesible for everyone. Since it is configured as a cronjob to run every 5 minutes and starts with internal, this should not be the case, and could worst case lead to DoS if it's a costly operation.\n\n## Steps To Reproduce:\n\n  1. Go to https://hack.whocoronavirus.org/internal/cron/refreshCaseStats\n```time curl -v https://hack.whocoronavirus.org/internal/cron/refreshCaseStats```\n\n{F1130894}\nShow that it takes about 20 seconds, before a 200 OK response returns (with a single request).\n\n## Supporting Material/References:\nhttps://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/webapp/WEB-INF/cron.yaml#L3\n\n## Impact\n\nDepending on the impact / performance of the action 'refresh case stats'  this could lead to unnecesarry load on the backend (and charges) or even DoS.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eIt looks like the endpoint \u003cstrong\u003e/internal/cron/refreshCaseStats\u003c/strong\u003e as configured in \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWorldHealthOrganization%2Fapp%2Fblob%2Fmaster%2Fserver%2Fappengine%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fcron.yaml%23L3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecron.yaml\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is accesible for everyone. Since it is configured as a cronjob to run every 5 minutes and starts with internal, this should not be the case, and could worst case lead to DoS if it\u0026#39;s a costly operation.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://hack.whocoronavirus.org/internal/cron/refreshCaseStats\" href=\"/redirect?url=https%3A%2F%2Fhack.whocoronavirus.org%2Finternal%2Fcron%2FrefreshCaseStats\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hack.whocoronavirus.org/internal/cron/refreshCaseStats\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003ccode\u003etime curl -v https://hack.whocoronavirus.org/internal/cron/refreshCaseStats\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"curl-corona.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bqc29qhw2vy3cliaacz7hlk8xuft?response-content-disposition=attachment%3B%20filename%3D%22curl-corona.png%22%3B%20filename%2A%3DUTF-8%27%27curl-corona.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041447Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=50f959c14aa55fba9086efdcbd13451923d31690ede48bb2c08fd2d6cba39d66\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bqc29qhw2vy3cliaacz7hlk8xuft?response-content-disposition=attachment%3B%20filename%3D%22curl-corona.png%22%3B%20filename%2A%3DUTF-8%27%27curl-corona.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041447Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=50f959c14aa55fba9086efdcbd13451923d31690ede48bb2c08fd2d6cba39d66\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nShow that it takes about 20 seconds, before a 200 OK response returns (with a single request).\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/webapp/WEB-INF/cron.yaml#L3\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWorldHealthOrganization%2Fapp%2Fblob%2Fmaster%2Fserver%2Fappengine%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fcron.yaml%23L3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/webapp/WEB-INF/cron.yaml#L3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDepending on the impact / performance of the action \u0026#39;refresh case stats\u0026#39;  this could lead to unnecesarry load on the backend (and charges) or even DoS.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1130894,"file_name":"curl-corona.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bqc29qhw2vy3cliaacz7hlk8xuft?response-content-disposition=attachment%3B%20filename%3D%22curl-corona.png%22%3B%20filename%2A%3DUTF-8%27%27curl-corona.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041447Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=50f959c14aa55fba9086efdcbd13451923d31690ede48bb2c08fd2d6cba39d66","file_size":28119,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":13,"voters":["jub0bs","doompwn","sa1tama0","eabesh","asusrog","orin2421","devouraq","mukund_bhuva","incy","phamine","and 3 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":59495,"asset_type":"URL","asset_identifier":"hack.whocoronavirus.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":10208031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nI just checked [RefreshCaseStatsServlet.java] (https://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/java/who/RefreshCaseStatsServlet.java) (below snippet), and it looks like there is an additional check in production, but the policy is to test in this environment, and not in production.\n\nI would suggest to change the below code, regarding removing or extending the **Environment.isProduction()** check, to make it possible to test this functionality in a non-production environment.\n``` java\n    // App Engine strips all external X-* request headers, so we can trust this is set by App Engine.\n    // https://cloud.google.com/appengine/docs/flexible/java/scheduling-jobs-with-cron-yaml#validating_cron_requests\n    if (Environment.isProduction() \u0026\u0026 !\"true\".equals(request.getHeader(\"X-Appengine-Cron\"))) {\n        response.sendError(\n                HttpServletResponse.SC_UNAUTHORIZED,\n                \"Cron access only\"\n        );\n        return;\n    }\n```","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nI just checked \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWorldHealthOrganization%2Fapp%2Fblob%2Fmaster%2Fserver%2Fappengine%2Fsrc%2Fmain%2Fjava%2Fwho%2FRefreshCaseStatsServlet.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eRefreshCaseStatsServlet.java\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (below snippet), and it looks like there is an additional check in production, but the policy is to test in this environment, and not in production.\u003c/p\u003e\n\n\u003cp\u003eI would suggest to change the below code, regarding removing or extending the \u003cstrong\u003eEnvironment.isProduction()\u003c/strong\u003e check, to make it possible to test this functionality in a non-production environment.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e    \u003cspan class=\"c1\"\u003e// App Engine strips all external X-* request headers, so we can trust this is set by App Engine.\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// https://cloud.google.com/appengine/docs/flexible/java/scheduling-jobs-with-cron-yaml#validating_cron_requests\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eEnvironment\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisProduction\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;true\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetHeader\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;X-Appengine-Cron\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e)))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esendError\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\n                \u003cspan class=\"nc\"\u003eHttpServletResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eSC_UNAUTHORIZED\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"s\"\u003e\u0026quot;Cron access only\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-12-26T22:44:35.268Z","updated_at":"2020-12-26T22:44:35.268Z","actor":{"username":"arnonymous","cleared":false,"url":"/arnonymous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/966/039e3ef33791903eef67a80ca6a255b9cc7601de_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10208045,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Good catch.\n\nWe have logic to reject external requests:\nhttps://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/java/who/RefreshCaseStatsServlet.java#L194-L198\n\nBut those requests are only rejected based on `isProduction`, which is in turn based on the `applicationId` or Google Cloud Platform (GCP) Project name. We migrated our GCP projects recently which changed their names.... and broke the protections. I hope to have this fixed later today. I'd welcome any more reports you can find.\n\nRight now this could lead to a DoS.... but more importantly it could become a lot more sensitive as we added other cron jobs.","markdown_message":"\u003cp\u003eGood catch.\u003c/p\u003e\n\n\u003cp\u003eWe have logic to reject external requests:\u003cbr\u003e\n\u003ca title=\"https://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/java/who/RefreshCaseStatsServlet.java#L194-L198\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWorldHealthOrganization%2Fapp%2Fblob%2Fmaster%2Fserver%2Fappengine%2Fsrc%2Fmain%2Fjava%2Fwho%2FRefreshCaseStatsServlet.java%23L194-L198\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WorldHealthOrganization/app/blob/master/server/appengine/src/main/java/who/RefreshCaseStatsServlet.java#L194-L198\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBut those requests are only rejected based on \u003ccode\u003eisProduction\u003c/code\u003e, which is in turn based on the \u003ccode\u003eapplicationId\u003c/code\u003e or Google Cloud Platform (GCP) Project name. We migrated our GCP projects recently which changed their names.... and broke the protections. I hope to have this fixed later today. I\u0026#39;d welcome any more reports you can find.\u003c/p\u003e\n\n\u003cp\u003eRight now this could lead to a DoS.... but more importantly it could become a lot more sensitive as we added other cron jobs.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-26T22:51:22.971Z","updated_at":"2020-12-26T22:51:22.971Z","actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10208048,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonymous - we potentially want developers to be able to test this locally... but the dependency on the applicationId name is very fragile and that's not acceptable. It should be disable anytime it's deployed in the cloud.","markdown_message":"\u003cp\u003e\u003ca href=\"/anonymous\"\u003e@anonymous\u003c/a\u003e - we potentially want developers to be able to test this locally... but the dependency on the applicationId name is very fragile and that\u0026#39;s not acceptable. It should be disable anytime it\u0026#39;s deployed in the cloud.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-26T22:52:49.195Z","updated_at":"2020-12-26T22:52:49.195Z","actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10208049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonymous - looks like a race condition on our responses! You're absolutely on the right track though.","markdown_message":"\u003cp\u003e\u003ca href=\"/anonymous\"\u003e@anonymous\u003c/a\u003e - looks like a race condition on our responses! You\u0026#39;re absolutely on the right track though.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-26T22:53:37.856Z","updated_at":"2020-12-26T22:53:37.856Z","actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10215440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fix pushed: https://github.com/WorldHealthOrganization/app/pull/1891\n\nVerified on hack and production servers.\n```\n% time curl -i https://hack.whocoronavirus.org/internal/cron/refreshCaseStats\nHTTP/2 401 \ncontent-type: text/html;charset=utf-8\nx-cloud-trace-context: d69261050c5b355cf09528737eef7b75;o=1\ndate: Mon, 28 Dec 2020 07:51:07 GMT\nserver: Google Frontend\ncontent-length: 208\nvia: 1.1 google\nalt-svc: clear\n\n\u003chtml\u003e\u003chead\u003e\n\u003cmeta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"\u003e\n\u003ctitle\u003e401 Cron access only\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody text=#000000 bgcolor=#ffffff\u003e\n\u003ch1\u003eError: Cron access only\u003c/h1\u003e\n\u003c/body\u003e\u003c/html\u003e\ncurl -i https://hack.whocoronavirus.org/internal/cron/refreshCaseStats  0.01s user 0.00s system 4% cpu 0.333 total\n```","markdown_message":"\u003cp\u003eFix pushed: \u003ca title=\"https://github.com/WorldHealthOrganization/app/pull/1891\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWorldHealthOrganization%2Fapp%2Fpull%2F1891\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WorldHealthOrganization/app/pull/1891\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVerified on hack and production servers.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e% time curl -i https://hack.whocoronavirus.org/internal/cron/refreshCaseStats\nHTTP/2 401 \ncontent-type: text/html;charset=utf-8\nx-cloud-trace-context: d69261050c5b355cf09528737eef7b75;o=1\ndate: Mon, 28 Dec 2020 07:51:07 GMT\nserver: Google Frontend\ncontent-length: 208\nvia: 1.1 google\nalt-svc: clear\n\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u0026lt;head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;meta\u003c/span\u003e \u003cspan class=\"na\"\u003ehttp-equiv=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003econtent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text/html;charset=utf-8\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003e401 Cron access only\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003etext=\u003c/span\u003e\u003cspan class=\"s\"\u003e#000000\u003c/span\u003e \u003cspan class=\"na\"\u003ebgcolor=\u003c/span\u003e\u003cspan class=\"s\"\u003e#ffffff\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003eError: Cron access only\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u003c/span\u003e\ncurl -i https://hack.whocoronavirus.org/internal/cron/refreshCaseStats  0.01s user 0.00s system 4% cpu 0.333 total\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-12-28T07:56:36.001Z","updated_at":"2020-12-28T07:56:36.001Z","actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10215443,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"All resolved. Thanks for the report.","markdown_message":"\u003cp\u003eAll resolved. Thanks for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-28T07:57:04.083Z","updated_at":"2020-12-28T07:57:04.083Z","actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"arnonymous","url":"/arnonymous"},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10215444,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-28T07:57:17.324Z","updated_at":"2020-12-28T07:57:17.324Z","first_to_agree":true,"actor":{"username":"bruno-bowden","cleared":false,"url":"/bruno-bowden","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/017/43c43a51fe988519ab02ac5467279b2d32a5fd0f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10215721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the quick fix!","markdown_message":"\u003cp\u003eThanks for the quick fix!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-28T08:36:10.389Z","updated_at":"2020-12-28T08:36:10.389Z","actor":{"username":"arnonymous","cleared":false,"url":"/arnonymous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/966/039e3ef33791903eef67a80ca6a255b9cc7601de_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10216135,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-28T08:48:55.702Z","updated_at":"2020-12-28T08:48:55.702Z","actor":{"username":"arnonymous","cleared":false,"url":"/arnonymous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/966/039e3ef33791903eef67a80ca6a255b9cc7601de_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10216136,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-28T08:48:55.777Z","updated_at":"2020-12-28T08:48:55.777Z","actor":{"username":"arnonymous","cleared":false,"url":"/arnonymous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/966/039e3ef33791903eef67a80ca6a255b9cc7601de_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"who-covid-19-mobile-app","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}