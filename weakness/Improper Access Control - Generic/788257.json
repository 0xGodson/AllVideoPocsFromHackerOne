{"id":788257,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODgyNTc=","url":"https://hackerone.com/reports/788257","title":"\"Secure View\" aka \"Hide Download\" can be bypassed easily","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-02-03T13:18:19.732Z","submitted_at":"2020-02-03T13:18:19.732Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"at5djl3pwjmunyutnoatp","url":"/at5djl3pwjmunyutnoatp","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8139"],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-10T09:12:36.773Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-03-11T09:12:32.866Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The mid-2019 announced feature \"Secure view\" (https://nextcloud.com/blog/secure-view-prevent-your-shared-files-from-getting-downloaded/) allows for hiding the Download button on public shares.\nEven though the announcement admits that there are always workarounds out there to get hands on the file anyway, the workaround for this one is way too simple: Just add **/download** to the URL (like you used to for every public share) and your browser starts downloading unhesitently.\n\nFor the sharee, the checkbox \"Hide Download\" is therefore very deceptive, since they very likely weigh themselves in false safety.\n\n## Impact\n\nDownload a copy of a file or folder that's not supposed to be downloaded whatsoever","vulnerability_information_html":"\u003cp\u003eThe mid-2019 announced feature \u0026quot;Secure view\u0026quot; (\u003ca title=\"https://nextcloud.com/blog/secure-view-prevent-your-shared-files-from-getting-downloaded/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fblog%2Fsecure-view-prevent-your-shared-files-from-getting-downloaded%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/blog/secure-view-prevent-your-shared-files-from-getting-downloaded/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) allows for hiding the Download button on public shares.\u003cbr\u003e\nEven though the announcement admits that there are always workarounds out there to get hands on the file anyway, the workaround for this one is way too simple: Just add \u003cstrong\u003e/download\u003c/strong\u003e to the URL (like you used to for every public share) and your browser starts downloading unhesitently.\u003c/p\u003e\n\n\u003cp\u003eFor the sharee, the checkbox \u0026quot;Hide Download\u0026quot; is therefore very deceptive, since they very likely weigh themselves in false safety.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDownload a copy of a file or folder that\u0026#39;s not supposed to be downloaded whatsoever\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-10T09:12:32.918Z","allow_singular_disclosure_after":-22714818.43449953,"singular_disclosure_allowed":true,"vote_count":20,"voters":["dhakal_ananda","mygf","what_web","clarckowen_","b69fb2ebda43240ece9dbeb","t2pd","s4phiredrag0n","bennjj_","rainz","jezwebb","and 10 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6950213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-02-03T13:18:20.687Z","updated_at":"2020-02-03T13:18:20.687Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6968656,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Which version did you test against? We fixed this in November/December for 18.0.0, 17.0.3 and its siblings.","markdown_message":"\u003cp\u003eWhich version did you test against? We fixed this in November/December for 18.0.0, 17.0.3 and its siblings.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-05T11:07:53.001Z","updated_at":"2020-02-05T11:07:53.001Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6982639,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"18.0.0 and 18.0.1 RC1","markdown_message":"\u003cp\u003e18.0.0 and 18.0.1 RC1\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-06T23:14:04.488Z","updated_at":"2020-02-06T23:14:04.488Z","actor":{"username":"at5djl3pwjmunyutnoatp","cleared":false,"url":"/at5djl3pwjmunyutnoatp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6986806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, I was thinking about the wrong feature (secure drop instead of secure view):\nThe following patch should fix the issue: https://github.com/nextcloud/server/pull/19349","markdown_message":"\u003cp\u003eAh, I was thinking about the wrong feature (secure drop instead of secure view):\u003cbr\u003e\nThe following patch should fix the issue: \u003ca title=\"https://github.com/nextcloud/server/pull/19349\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F19349\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/19349\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-07T11:49:39.526Z","updated_at":"2020-02-07T11:49:39.526Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6986812,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-07T11:50:03.258Z","updated_at":"2020-02-07T11:50:03.258Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7002295,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"looks good, thank you","markdown_message":"\u003cp\u003elooks good, thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-10T04:37:03.647Z","updated_at":"2020-02-10T04:37:03.647Z","actor":{"username":"at5djl3pwjmunyutnoatp","cleared":false,"url":"/at5djl3pwjmunyutnoatp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7027548,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-02-12T07:03:10.118Z","updated_at":"2020-02-12T07:03:10.118Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"at5djl3pwjmunyutnoatp","url":"/at5djl3pwjmunyutnoatp"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7039586,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-13T09:08:36.080Z","updated_at":"2020-02-13T09:08:36.080Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"at5djl3pwjmunyutnoatp","url":"/at5djl3pwjmunyutnoatp"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7287212,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-11T09:12:32.879Z","updated_at":"2020-03-11T09:12:32.879Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7612409,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-10T09:12:36.795Z","updated_at":"2020-04-10T09:12:36.795Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}