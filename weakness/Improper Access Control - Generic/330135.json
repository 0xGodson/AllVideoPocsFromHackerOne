{"id":330135,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzAxMzU=","url":"https://hackerone.com/reports/330135","title":"S3 bucket unnecessarily discloses permissions","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2018-03-27T02:41:38.028Z","submitted_at":"2018-03-27T02:41:38.028Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"salmon","url":"/salmon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1566,"url":"https://hackerone.com/udemy","handle":"udemy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Udemy","twitter_handle":"","website":"http://udemy.com","about":"We’re the world’s online learning marketplace, with courses in everything from programming to yoga to photography."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-26T13:10:58.399Z","bug_reporter_agreed_on_going_public_at":"2019-03-27T13:10:56.247Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The 'udemy-images' bucket allows the 'AllUsers' group to list ACLs that are applied to the bucket. By navigating to: [https://udemy-images.udemy.com](https://udemy-images.udemy.com) or by using the `aws-cli` tool an attacker can see which users have `READ`, `WRITE`, `READ_ACP`, and `WRITE_ACP` rights. Doing this now we can see one user who has these rights (see attached screenshot). We can see their ID and DisplayName (hi [@caglaroktay!](https://twitter.com/caglaroktay))\n\n## Impact\n\nWhile this doesn't give public users write access to the bucket, a motivated attacker can gather a lot of information from this. If one were targeting the Udemy AWS infrastructure, this information would give them all they need to know to start gathering intel on an authorized user (like @caglaroktay). An easy way to do this would be  to look for breached passwords belonging to the authorized user to try logging into their AWS console with.\n\nThis public permission is unnecessary as it is not needed for the site to run properly and should be removed immediately.","vulnerability_information_html":"\u003cp\u003eThe \u0026#39;udemy-images\u0026#39; bucket allows the \u0026#39;AllUsers\u0026#39; group to list ACLs that are applied to the bucket. By navigating to: \u003ca href=\"/redirect?url=https%3A%2F%2Fudemy-images.udemy.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://udemy-images.udemy.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or by using the \u003ccode\u003eaws-cli\u003c/code\u003e tool an attacker can see which users have \u003ccode\u003eREAD\u003c/code\u003e, \u003ccode\u003eWRITE\u003c/code\u003e, \u003ccode\u003eREAD_ACP\u003c/code\u003e, and \u003ccode\u003eWRITE_ACP\u003c/code\u003e rights. Doing this now we can see one user who has these rights (see attached screenshot). We can see their ID and DisplayName (hi \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fcaglaroktay\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e@caglaroktay!\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWhile this doesn\u0026#39;t give public users write access to the bucket, a motivated attacker can gather a lot of information from this. If one were targeting the Udemy AWS infrastructure, this information would give them all they need to know to start gathering intel on an authorized user (like \u003ca href=\"/caglaroktay\"\u003e@caglaroktay\u003c/a\u003e). An easy way to do this would be  to look for breached passwords belonging to the authorized user to try logging into their AWS console with.\u003c/p\u003e\n\n\u003cp\u003eThis public permission is unnecessary as it is not needed for the site to run properly and should be removed immediately.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":278980,"file_name":"udemy.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/278/980/67b3ae53560cba8110891ffac7af3697c942c6a2/udemy.png?response-content-disposition=attachment%3B%20filename%3D%22udemy.png%22%3B%20filename%2A%3DUTF-8%27%27udemy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053641Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=bb12c1ecb2b3c6b75fc55b4356c9b1916ced1daf62f6470f1c95362a7bdd1362","file_size":198341,"type":"image/png"}],"allow_singular_disclosure_at":"2019-04-26T13:10:56.304Z","allow_singular_disclosure_after":-52935945.57262763,"singular_disclosure_allowed":true,"vote_count":25,"voters":["kickino","dhakal_ananda","an0nym0us","khizer47","escrow","bb00x","salmon","cryptographer","klau5","gr4ndm45t3erfl45h","and 15 more..."],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2541038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report. We are looking into it.","markdown_message":"\u003cp\u003eThanks for your report. We are looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-28T17:04:33.261Z","updated_at":"2018-03-28T17:04:33.261Z","actor":{"username":"kmeta4","cleared":false,"url":"/kmeta4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2548479,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. We have forwarded this to engineering.","markdown_message":"\u003cp\u003eThanks for your report. We have forwarded this to engineering.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-30T21:12:00.484Z","updated_at":"2018-03-30T21:12:00.484Z","actor":{"username":"kmeta4","cleared":false,"url":"/kmeta4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2548485,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-30T21:13:15.618Z","updated_at":"2018-03-30T21:13:15.618Z","additional_data":{"old_severity":"Medium (5.3)","new_severity":"Medium (5.8)","old_severity_id":132723,"new_severity_id":133987},"actor":{"username":"kmeta4","cleared":false,"url":"/kmeta4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2563034,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-04T01:25:34.576Z","updated_at":"2018-04-04T01:25:34.576Z","additional_data":{"old_severity":"Medium (5.8)","new_severity":"None (0.0)","old_severity_id":133987,"new_severity_id":135603},"actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2563035,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Small bounty as the revealed information was so small - one of the founders of the company can be googled and his account was disabled years ago.  Thanks for the report though - we will fix it.","markdown_message":"\u003cp\u003eSmall bounty as the revealed information was so small - one of the founders of the company can be googled and his account was disabled years ago.  Thanks for the report though - we will fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-04T01:27:31.765Z","updated_at":"2018-04-04T01:27:31.765Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"udemy","collaborator":{"username":"salmon","url":"/salmon"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2564616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, the bounty seems fair.","markdown_message":"\u003cp\u003eThanks for the update, the bounty seems fair.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-04T13:00:43.612Z","updated_at":"2018-04-04T13:00:43.612Z","actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2700244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, is there any update on this? ","markdown_message":"\u003cp\u003eHi there, is there any update on this? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-04T12:51:55.251Z","updated_at":"2018-05-04T12:51:55.251Z","actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3032684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry for the delay in response. We believe this is fixed now. Can you verify it.","markdown_message":"\u003cp\u003esorry for the delay in response. We believe this is fixed now. Can you verify it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-11T23:38:07.520Z","updated_at":"2018-07-11T23:38:07.520Z","actor":{"username":"kmeta4","cleared":false,"url":"/kmeta4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3034479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, but it still looks unfixed from here. Verify by visiting the affected URL listed in the original report. ","markdown_message":"\u003cp\u003eSorry, but it still looks unfixed from here. Verify by visiting the affected URL listed in the original report. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-12T11:26:02.155Z","updated_at":"2018-07-12T11:26:02.155Z","actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3187963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kmeta4 This looks fixed now. Can we mark this as resolved and disclose?","markdown_message":"\u003cp\u003e\u003ca href=\"/kmeta4\"\u003e@kmeta4\u003c/a\u003e This looks fixed now. Can we mark this as resolved and disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-13T15:55:19.194Z","updated_at":"2018-08-13T15:55:19.194Z","actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3323497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@udemy @kmeta4 Can we resolve this one? ","markdown_message":"\u003cp\u003e\u003ca href=\"/udemy\"\u003e@udemy\u003c/a\u003e \u003ca href=\"/kmeta4\"\u003e@kmeta4\u003c/a\u003e Can we resolve this one? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-11T19:14:28.738Z","updated_at":"2018-09-11T19:14:28.738Z","actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4398142,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-27T00:45:21.730Z","updated_at":"2019-03-27T00:45:21.730Z","actor":{"username":"eric_8n6oy","cleared":false,"url":"/eric_8n6oy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"salmon","url":"/salmon"},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4402091,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-27T13:10:56.272Z","updated_at":"2019-03-27T13:10:56.272Z","first_to_agree":true,"actor":{"username":"salmon","cleared":false,"url":"/salmon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/352/da4673819d4fbc17a107328808b808c2b8221c2a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4648462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-26T13:10:58.441Z","updated_at":"2019-04-26T13:10:58.441Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}