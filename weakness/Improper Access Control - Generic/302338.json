{"id":302338,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDIzMzg=","url":"https://hackerone.com/reports/302338","title":"The possibility that unintended file operation may be performed because some methods of `Dir` do not check NULL characters.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-01-04T10:03:14.309Z","submitted_at":"2018-01-04T10:03:14.309Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-8780"],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-01T09:11:40.963Z","bug_reporter_agreed_on_going_public_at":"2018-04-01T09:11:40.873Z","team_member_agreed_on_going_public_at":"2018-04-01T02:43:34.082Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It seems that `entries`,`new`, and `empty?` do not check NULL characters in methods of `Dir`.\n\n```log\n[vagrant@localhost ~]$ ls\ntest\n[vagrant@localhost ~]$ irb\nirb(main):001:0\u003e Dir.open(\"/home/vagrant\\0xxx\") do |d|\nirb(main):002:1* p d.read   # =\u003e \".\"\nirb(main):003:1\u003e p d.read   # =\u003e \"..\"\nirb(main):004:1\u003e p d.read\nirb(main):005:1\u003e p d.read\nirb(main):006:1\u003e end\n\".\"\n\"..\"\n\".bash_logout\"\n\".bash_profile\"\n=\u003e \".bash_profile\"\n\nirb(main):007:0\u003e d = Dir.new(\"/home/vagrant\\0xxx\")\n=\u003e #\u003cDir:/home/vagrantxxx\u003e\nirb(main):008:0\u003e p d.read   # =\u003e \".\"\n\".\"\n=\u003e \".\"\nirb(main):009:0\u003e p d.read   # =\u003e \"..\"\n\"..\"\n=\u003e \"..\"\nirb(main):010:0\u003e p d.read\n\".bash_logout\"\n=\u003e \".bash_logout\"\nirb(main):011:0\u003e p d.read\n\".bash_profile\"\n=\u003e \".bash_profile\"\n\nirb(main):012:0\u003e Dir.entries(\"/home/vagrant\\0yyy\")\n=\u003e [\".\", \"..\", \".bash_logout\", \".bash_profile\", \".bashrc\", \".ssh\", \".rbenv\", \".pki\", \".bash_history\", \"test\"]\n\nirb(main):013:0\u003e Dir.empty?(\"/home/vagrant\\0zzz\")\n=\u003e false\n```\n\n## Impact\n\nWhen using the corresponding method, unintended file operation may be performed.","vulnerability_information_html":"\u003cp\u003eIt seems that \u003ccode\u003eentries\u003c/code\u003e,\u003ccode\u003enew\u003c/code\u003e, and \u003ccode\u003eempty?\u003c/code\u003e do not check NULL characters in methods of \u003ccode\u003eDir\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[vagrant@localhost ~]$ ls\ntest\n[vagrant@localhost ~]$ irb\nirb(main):001:0\u0026gt; Dir.open(\u0026quot;/home/vagrant\\0xxx\u0026quot;) do |d|\nirb(main):002:1* p d.read   # =\u0026gt; \u0026quot;.\u0026quot;\nirb(main):003:1\u0026gt; p d.read   # =\u0026gt; \u0026quot;..\u0026quot;\nirb(main):004:1\u0026gt; p d.read\nirb(main):005:1\u0026gt; p d.read\nirb(main):006:1\u0026gt; end\n\u0026quot;.\u0026quot;\n\u0026quot;..\u0026quot;\n\u0026quot;.bash_logout\u0026quot;\n\u0026quot;.bash_profile\u0026quot;\n=\u0026gt; \u0026quot;.bash_profile\u0026quot;\n\nirb(main):007:0\u0026gt; d = Dir.new(\u0026quot;/home/vagrant\\0xxx\u0026quot;)\n=\u0026gt; #\u0026lt;Dir:/home/vagrantxxx\u0026gt;\nirb(main):008:0\u0026gt; p d.read   # =\u0026gt; \u0026quot;.\u0026quot;\n\u0026quot;.\u0026quot;\n=\u0026gt; \u0026quot;.\u0026quot;\nirb(main):009:0\u0026gt; p d.read   # =\u0026gt; \u0026quot;..\u0026quot;\n\u0026quot;..\u0026quot;\n=\u0026gt; \u0026quot;..\u0026quot;\nirb(main):010:0\u0026gt; p d.read\n\u0026quot;.bash_logout\u0026quot;\n=\u0026gt; \u0026quot;.bash_logout\u0026quot;\nirb(main):011:0\u0026gt; p d.read\n\u0026quot;.bash_profile\u0026quot;\n=\u0026gt; \u0026quot;.bash_profile\u0026quot;\n\nirb(main):012:0\u0026gt; Dir.entries(\u0026quot;/home/vagrant\\0yyy\u0026quot;)\n=\u0026gt; [\u0026quot;.\u0026quot;, \u0026quot;..\u0026quot;, \u0026quot;.bash_logout\u0026quot;, \u0026quot;.bash_profile\u0026quot;, \u0026quot;.bashrc\u0026quot;, \u0026quot;.ssh\u0026quot;, \u0026quot;.rbenv\u0026quot;, \u0026quot;.pki\u0026quot;, \u0026quot;.bash_history\u0026quot;, \u0026quot;test\u0026quot;]\n\nirb(main):013:0\u0026gt; Dir.empty?(\u0026quot;/home/vagrant\\0zzz\u0026quot;)\n=\u0026gt; false\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWhen using the corresponding method, unintended file operation may be performed.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-01T02:43:34.157Z","allow_singular_disclosure_after":-84077162.18805142,"singular_disclosure_allowed":true,"vote_count":12,"voters":["bl4de","akaash_pantherdefence","eveeez","apapedulimu","kunal94","khizer47","t-4-y-m","japz","666reda","rafapantojo","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2262318,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found another pattern in `glob`.\n\n```\n[vagrant@localhost ~]$ irb\nirb(main):001:0\u003e Dir.glob([\"/tmp\\0/home\"])\n=\u003e [\"/tmp\"]\nirb(main):002:0\u003e Dir.glob([\"/home\"])\n=\u003e [\"/home\"]\nirb(main):003:0\u003e Dir.glob(\"/tmp\\0/home\")\n=\u003e [\"/tmp\", \"/home\"]\n```","markdown_message":"\u003cp\u003eI found another pattern in \u003ccode\u003eglob\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[vagrant@localhost ~]$ irb\nirb(main):001:0\u0026gt; Dir.glob([\u0026quot;/tmp\\0/home\u0026quot;])\n=\u0026gt; [\u0026quot;/tmp\u0026quot;]\nirb(main):002:0\u0026gt; Dir.glob([\u0026quot;/home\u0026quot;])\n=\u0026gt; [\u0026quot;/home\u0026quot;]\nirb(main):003:0\u0026gt; Dir.glob(\u0026quot;/tmp\\0/home\u0026quot;)\n=\u0026gt; [\u0026quot;/tmp\u0026quot;, \u0026quot;/home\u0026quot;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-01-04T17:28:30.133Z","updated_at":"2018-01-04T17:28:30.133Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2263732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ack, Thanks too.\n\nWe are investigating this now.","markdown_message":"\u003cp\u003eAck, Thanks too.\u003c/p\u003e\n\n\u003cp\u003eWe are investigating this now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-05T06:53:41.388Z","updated_at":"2018-01-05T06:53:41.388Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2445238,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-01T07:44:59.557Z","updated_at":"2018-03-01T07:44:59.557Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2471815,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ooooooo_q Can you review attached patch?","markdown_message":"\u003cp\u003e\u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e Can you review attached patch?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-08T02:14:36.418Z","updated_at":"2018-03-08T02:14:36.418Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":270479,"filename":"check-nul-dir.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/270/479/3a4796f1e594c3525fe1a00eed98bafa62d31e45/check-nul-dir.patch?response-content-disposition=attachment%3B%20filename%3D%22check-nul-dir.patch%22%3B%20filename%2A%3DUTF-8%27%27check-nul-dir.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052936Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=6ebb9f156e8894bbd6e3da721bc2b86b08d692c3dca7bdeab2a00ded6fc08c49"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2474029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hsbt I checked the patch. I have no experience in C language so I am not confident, but it seems there are no problems.","markdown_message":"\u003cp\u003e\u003ca href=\"/hsbt\"\u003e@hsbt\u003c/a\u003e I checked the patch. I have no experience in C language so I am not confident, but it seems there are no problems.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-08T15:24:35.595Z","updated_at":"2018-03-08T15:24:35.595Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2508051,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-20T00:18:10.032Z","updated_at":"2018-03-20T00:18:10.032Z","cve_ids":["CVE-2018-8780"],"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2542434,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We fixed this report with Ruby 2.2.10, 2.3.7, 2.4.4, 2.5.1","markdown_message":"\u003cp\u003eWe fixed this report with Ruby 2.2.10, 2.3.7, 2.4.4, 2.5.1\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-29T01:45:35.182Z","updated_at":"2018-03-29T01:45:35.182Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2551041,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-01T02:43:27.698Z","updated_at":"2018-04-01T02:43:27.698Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2551042,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-01T02:43:34.110Z","updated_at":"2018-04-01T02:43:34.110Z","first_to_agree":true,"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2551849,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-01T09:11:40.905Z","updated_at":"2018-04-01T09:11:40.905Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2551850,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-01T09:11:40.989Z","updated_at":"2018-04-01T09:11:40.989Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2551851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks","markdown_message":"\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-01T09:11:48.642Z","updated_at":"2018-04-01T09:11:48.642Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}