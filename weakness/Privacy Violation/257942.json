{"id":257942,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTc5NDI=","url":"https://hackerone.com/reports/257942","title":"languagechange event fires simultaneously on all tabs","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-08-08T17:18:57.475Z","submitted_at":"2017-08-08T17:18:57.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomvg","url":"/tomvg","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/088/bcadc0a4a87f5627226b724ae0dcacbee32cc3e7_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-19T13:16:55.023Z","bug_reporter_agreed_on_going_public_at":"2017-10-19T13:16:54.962Z","team_member_agreed_on_going_public_at":"2017-10-19T11:55:28.510Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The `languagechange` event, which fires when the user modifies the browser's language settings fires simultaneously on all tabs. This would allow an adversary to link multiple visits to a single user: the adversary (e.g. a malicious ad provider) has a script that listens for this event, and when fired sends a signal to the adversary's server which includes the timestamp of the event. Since this is an event that does not occur very often (only when the user changes the browser's language), so the chances that this event occurs at the exact same millisecond on with multiple users is very small.\nI believe this has been a small oversight, since the `online` and `offline` events do seem to be disabled because of this threat.\n\n### PoC\n\nAs a proof-of-concept, you can open http://192.31.23.250/_events/get-event-values.html and https://poc.tom.vg/events-session-associate/get-event-values.html in different tabs (these are from different origins), select `onlanguagechange` from the dropdown and press the \"Start\" button. Next, change the language of the browser in the \"Content\" tab of the preferences (`about:preferences#content`): just add/remove one of change the order. Afterwards you should see an event logged on both tabs with approximately the same timestamp (the value might slightly differ because of the timer resolution).","vulnerability_information_html":"\u003cp\u003eThe \u003ccode\u003elanguagechange\u003c/code\u003e event, which fires when the user modifies the browser\u0026#39;s language settings fires simultaneously on all tabs. This would allow an adversary to link multiple visits to a single user: the adversary (e.g. a malicious ad provider) has a script that listens for this event, and when fired sends a signal to the adversary\u0026#39;s server which includes the timestamp of the event. Since this is an event that does not occur very often (only when the user changes the browser\u0026#39;s language), so the chances that this event occurs at the exact same millisecond on with multiple users is very small.\u003cbr\u003e\nI believe this has been a small oversight, since the \u003ccode\u003eonline\u003c/code\u003e and \u003ccode\u003eoffline\u003c/code\u003e events do seem to be disabled because of this threat.\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003cp\u003eAs a proof-of-concept, you can open \u003ca title=\"http://192.31.23.250/_events/get-event-values.html\" href=\"/redirect?url=http%3A%2F%2F192.31.23.250%2F_events%2Fget-event-values.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://192.31.23.250/_events/get-event-values.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"https://poc.tom.vg/events-session-associate/get-event-values.html\" href=\"/redirect?url=https%3A%2F%2Fpoc.tom.vg%2Fevents-session-associate%2Fget-event-values.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://poc.tom.vg/events-session-associate/get-event-values.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in different tabs (these are from different origins), select \u003ccode\u003eonlanguagechange\u003c/code\u003e from the dropdown and press the \u0026quot;Start\u0026quot; button. Next, change the language of the browser in the \u0026quot;Content\u0026quot; tab of the preferences (\u003ccode\u003eabout:preferences#content\u003c/code\u003e): just add/remove one of change the order. Afterwards you should see an event logged on both tabs with approximately the same timestamp (the value might slightly differ because of the timer resolution).\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":46,"name":"Privacy Violation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-18T11:55:28.569Z","allow_singular_disclosure_after":-98212703.86661528,"singular_disclosure_allowed":true,"vote_count":10,"voters":["jensec","yumi","cuso4","xiaoyinl","japz","spetr0x","lidyghost","hongen","b4155f7c29acd42c27d007a","hasani"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1921562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for this report and the PoC. While I think the risk of cross-origin tracking with that method is quite minimal, you are right we should fix it. I've opened https://trac.torproject.org/projects/tor/ticket/23216.","markdown_message":"\u003cp\u003eThanks for this report and the PoC. While I think the risk of cross-origin tracking with that method is quite minimal, you are right we should fix it. I\u0026#39;ve opened \u003ca title=\"https://trac.torproject.org/projects/tor/ticket/23216\" href=\"/redirect?url=https%3A%2F%2Ftrac.torproject.org%2Fprojects%2Ftor%2Fticket%2F23216\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://trac.torproject.org/projects/tor/ticket/23216\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-11T12:52:09.372Z","updated_at":"2017-08-11T12:52:09.372Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1921564,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-11T12:54:57.596Z","updated_at":"2017-08-11T12:54:57.596Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tomvg","url":"/tomvg"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1921565,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-11T12:56:02.465Z","updated_at":"2017-08-11T12:56:02.465Z","actor":{"url":"/torproject","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Tor"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"torproject","collaborator":{"username":"tomvg","url":"/tomvg"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083914,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T11:55:28.534Z","updated_at":"2017-10-19T11:55:28.534Z","first_to_agree":true,"actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2084020,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T13:16:54.987Z","updated_at":"2017-10-19T13:16:54.987Z","actor":{"username":"tomvg","cleared":false,"url":"/tomvg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/088/bcadc0a4a87f5627226b724ae0dcacbee32cc3e7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2084021,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T13:16:55.039Z","updated_at":"2017-10-19T13:16:55.039Z","actor":{"username":"tomvg","cleared":false,"url":"/tomvg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/088/bcadc0a4a87f5627226b724ae0dcacbee32cc3e7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}