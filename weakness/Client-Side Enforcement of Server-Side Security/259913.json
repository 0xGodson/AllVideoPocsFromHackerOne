{"id":259913,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTk5MTM=","url":"https://hackerone.com/reports/259913","title":"File Upload Restriction Bypass","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-14T18:12:51.725Z","submitted_at":"2017-08-14T18:12:51.725Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ok_bye_now","url":"/ok_bye_now","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/098/032/f92ff914c868b5465992b352e10bcfbc8587141a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://www.dc3.mil/vulnerability-disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-14T16:49:59.519Z","bug_reporter_agreed_on_going_public_at":"2019-10-15T04:36:26.682Z","team_member_agreed_on_going_public_at":"2020-05-14T16:49:59.437Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nA file upload function allows users to specify their own file name on the server, which allows a user to upload as many images as they would like, potentially causing an Application Denial of Service.\n\n**Description:**\nThe listserv 16.0 server at http://████████ allows users to upload their own logos for their own newsletter. The user can upload up to 10 logos. If you capture the request in a proxy such as Burp Suite Pro, you can examine the POST request and see that imgnum parameter is set at 1-10 based on what logo the user specified. It is possible to modify that parameter to whatever you want. For example; any word or number and that image can be retrieved by browsing to the link provided after it is uploaded. This would allow a user to upload as many images/logos as they want to potentially causing a Application Denial of Service if they were able to fill up the server hard drive. \n\n## Impact\nDenial of Service\n\n## Step-by-step Reproduction Instructions\n\n1. Navigate to http://█████████ and create an account.\n2.  Go to Preferences after you login and choose the \"Newsletter Profile\" tab.\n3. On the logos option, keep the default \"Slot 1\" selected and hit browse to choose an image to upload. \n4.  No go to the bottom and choose Update.\n5. In your proxy tool, replay the request with the imgnum paramter changed to \"cow\" or 50 or whatever you want. \n6. Append the same value to the end of the image data (logo parameter) in the POST request. \n7. Replay the modified request.\n8. Navigate to http://█████/scripts/wa.cgi?VL\u0026Y=9e44b517\u0026imgnum=\u003cINSERT MODIFIED VALUE HERE\u003e \n9. For example, if you used \"cow\", you would navigate to http://█████████/scripts/wa.cgi?VL\u0026Y=9e44b517\u0026imgnum=cow\n10. To verify, download the image and look at the image in a text editor, you should see the appended value at the end of the image file.\n\nYou many need to change the Y parameter in the URI for your account, this will be displayed after you upload your logo through the web interface.\n\n## Product, Version, and Configuration (If applicable)\nLISTSERV 16.0\n## Suggested Mitigation/Remediation Actions\nOnly allow values 1-10 for the imgnum parameter and overwrite images if there is one with that number already.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nA file upload function allows users to specify their own file name on the server, which allows a user to upload as many images as they would like, potentially causing an Application Denial of Service.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThe listserv 16.0 server at http://████████ allows users to upload their own logos for their own newsletter. The user can upload up to 10 logos. If you capture the request in a proxy such as Burp Suite Pro, you can examine the POST request and see that imgnum parameter is set at 1-10 based on what logo the user specified. It is possible to modify that parameter to whatever you want. For example; any word or number and that image can be retrieved by browsing to the link provided after it is uploaded. This would allow a user to upload as many images/logos as they want to potentially causing a Application Denial of Service if they were able to fill up the server hard drive. \u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of Service\u003c/p\u003e\n\n\u003ch2 id=\"step-by-step-reproduction-instructions\"\u003eStep-by-step Reproduction Instructions\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to http://█████████ and create an account.\u003c/li\u003e\n\u003cli\u003e Go to Preferences after you login and choose the \u0026quot;Newsletter Profile\u0026quot; tab.\u003c/li\u003e\n\u003cli\u003eOn the logos option, keep the default \u0026quot;Slot 1\u0026quot; selected and hit browse to choose an image to upload. \u003c/li\u003e\n\u003cli\u003e No go to the bottom and choose Update.\u003c/li\u003e\n\u003cli\u003eIn your proxy tool, replay the request with the imgnum paramter changed to \u0026quot;cow\u0026quot; or 50 or whatever you want. \u003c/li\u003e\n\u003cli\u003eAppend the same value to the end of the image data (logo parameter) in the POST request. \u003c/li\u003e\n\u003cli\u003eReplay the modified request.\u003c/li\u003e\n\u003cli\u003eNavigate to http://█████/scripts/wa.cgi?VL\u0026amp;Y=9e44b517\u0026amp;imgnum=\u0026lt;INSERT MODIFIED VALUE HERE\u0026gt; \u003c/li\u003e\n\u003cli\u003eFor example, if you used \u0026quot;cow\u0026quot;, you would navigate to http://█████████/scripts/wa.cgi?VL\u0026amp;Y=9e44b517\u0026amp;imgnum=cow\u003c/li\u003e\n\u003cli\u003eTo verify, download the image and look at the image in a text editor, you should see the appended value at the end of the image file.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou many need to change the Y parameter in the URI for your account, this will be displayed after you upload your logo through the web interface.\u003c/p\u003e\n\n\u003ch2 id=\"product-version-and-configuration-if-applicable\"\u003eProduct, Version, and Configuration (If applicable)\u003c/h2\u003e\n\n\u003cp\u003eLISTSERV 16.0\u003c/p\u003e\n\n\u003ch2 id=\"suggested-mitigation-remediation-actions\"\u003eSuggested Mitigation/Remediation Actions\u003c/h2\u003e\n\n\u003cp\u003eOnly allow values 1-10 for the imgnum parameter and overwrite images if there is one with that number already.\u003c/p\u003e\n","weakness":{"id":102,"name":"Client-Side Enforcement of Server-Side Security"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["eveeez","ok_bye_now","rrivera","sl33pyp0t4t0","badbrain"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1927547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings from the Department of Defense (DoD),\u003c/p\u003e\n\n\u003cp\u003eThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\u003c/p\u003e\n\n\u003cp\u003eBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at \u003ca href=\"/deptofdefense\"\u003e@DeptofDefense\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\u003c/p\u003e\n\n\u003cp\u003eWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\u003c/p\u003e\n\n\u003cp\u003eOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-08-14T18:12:51.917Z","updated_at":"2017-08-14T18:12:51.917Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1933532,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-16T14:49:31.278Z","updated_at":"2017-08-16T14:49:31.278Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":68555},"actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1933533,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this vulnerability to our attention!\u003c/p\u003e\n\n\u003cp\u003eWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks again for supporting the DoD Vulnerability Disclosure Program.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-16T14:49:33.500Z","updated_at":"2017-08-16T14:49:33.500Z","actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2234863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings,\n\nWe have been advised that the vulnerability you reported has been resolved. Before we close this report, we would appreciate it if you could confirm that the vulnerability no longer exists.\n\nIf we do not receive a response within two weeks, we will send you a second request. If we do not receive a response from you within two weeks of the second notice, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe have been advised that the vulnerability you reported has been resolved. Before we close this report, we would appreciate it if you could confirm that the vulnerability no longer exists.\u003c/p\u003e\n\n\u003cp\u003eIf we do not receive a response within two weeks, we will send you a second request. If we do not receive a response from you within two weeks of the second notice, we will close this report as resolved.\u003c/p\u003e\n\n\u003cp\u003eIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-19T16:12:57.093Z","updated_at":"2017-12-19T16:12:57.093Z","actor":{"username":"mqoliver","cleared":false,"url":"/mqoliver","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/138/137/cee21f0c3d393f4656fe770b7da019e6193fcf3f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2275288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings,\n\nWe previously sent a request asking you to confirm that the vulnerability you reported has been resolved. We would like your confirmation before closing this report.\n\nIf we do not receive a response to this second request within two weeks, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe previously sent a request asking you to confirm that the vulnerability you reported has been resolved. We would like your confirmation before closing this report.\u003c/p\u003e\n\n\u003cp\u003eIf we do not receive a response to this second request within two weeks, we will close this report as resolved.\u003c/p\u003e\n\n\u003cp\u003eIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-10T16:42:58.345Z","updated_at":"2018-01-10T16:42:58.345Z","actor":{"username":"mqoliver","cleared":false,"url":"/mqoliver","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/138/137/cee21f0c3d393f4656fe770b7da019e6193fcf3f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2322154,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGood news!\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-26T21:24:24.697Z","updated_at":"2018-01-26T21:24:24.697Z","actor":{"username":"mqoliver","cleared":false,"url":"/mqoliver","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/138/137/cee21f0c3d393f4656fe770b7da019e6193fcf3f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ok_bye_now","url":"/ok_bye_now"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6040432,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-15T04:36:26.697Z","updated_at":"2019-10-15T04:36:26.697Z","first_to_agree":true,"actor":{"username":"ok_bye_now","cleared":false,"url":"/ok_bye_now","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/032/f92ff914c868b5465992b352e10bcfbc8587141a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6467175,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will put it in the queue for disclosure.","markdown_message":"\u003cp\u003eWe will put it in the queue for disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-04T15:51:18.339Z","updated_at":"2019-12-04T15:51:18.339Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8002130,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","markdown_message":"\u003cp\u003eThanks for participating in the DoD Vulnerability Disclosure Program. We\u0026#39;re publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at \u003ca title=\"VDP-Questions@dc3.mil\" href=\"mailto:VDP-Questions@dc3.mil\" rel=\"nofollow noopener noreferrer\"\u003eVDP-Questions@dc3.mil\u003c/a\u003e if there are any questions, concerns or issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-14T16:49:59.451Z","updated_at":"2020-05-14T16:49:59.451Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002131,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T16:49:59.543Z","updated_at":"2020-05-14T16:49:59.543Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002132,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T16:50:06.395Z","updated_at":"2020-05-14T16:50:06.395Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}