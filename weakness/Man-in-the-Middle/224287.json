{"id":224287,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQyODc=","url":"https://hackerone.com/reports/224287","title":"Email verification over an unencrypted channel","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-27T11:00:52.313Z","submitted_at":"2017-04-27T11:00:52.313Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pavanw3b","url":"/pavanw3b","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-17T14:08:06.226Z","bug_reporter_agreed_on_going_public_at":"2017-04-27T12:59:24.694Z","team_member_agreed_on_going_public_at":"2017-05-17T14:08:06.181Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey guys,\n\nWhen registered for an account, the confirmation email sent out, has a http link (refer the attachment) and allows a man-in-the-middle attacker to take over the account. He can do the following:\n- Obtain the confirmation tokens while transmitting to the weblate infra and redirect the user to a fake site.\n- On clicking the link, the user is auto logged in to the account. The attacker can take over the account if he obtains the tokens in the transmission.\n\n**Steps to reproduce:**\n- Navigate to https://hosted.weblate.org/accounts/register/\n- Fill up the form and submit\n- Open the email inbox\n- See the link contains http://. Verify both the visible text as well as the actually link is http://.\n- Note that all other links are http:// too\n\n**Suggested Fix:**\n- Change the confirmation link sent through the email, to *https://*. Both the text visible as well as the actual link.\n- Avoid automatic logging into the account when the link is clicked. Display a message saying *Your account is verified. Please login to continue.\n\n\n**Affected area:** https://hosted.weblate.org/accounts/register/\n","vulnerability_information_html":"\u003cp\u003eHey guys,\u003c/p\u003e\n\n\u003cp\u003eWhen registered for an account, the confirmation email sent out, has a http link (refer the attachment) and allows a man-in-the-middle attacker to take over the account. He can do the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eObtain the confirmation tokens while transmitting to the weblate infra and redirect the user to a fake site.\u003c/li\u003e\n\u003cli\u003eOn clicking the link, the user is auto logged in to the account. The attacker can take over the account if he obtains the tokens in the transmission.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNavigate to \u003ca title=\"https://hosted.weblate.org/accounts/register/\" href=\"/redirect?url=https%3A%2F%2Fhosted.weblate.org%2Faccounts%2Fregister%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hosted.weblate.org/accounts/register/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eFill up the form and submit\u003c/li\u003e\n\u003cli\u003eOpen the email inbox\u003c/li\u003e\n\u003cli\u003eSee the link contains http://. Verify both the visible text as well as the actually link is http://.\u003c/li\u003e\n\u003cli\u003eNote that all other links are http:// too\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eSuggested Fix:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eChange the confirmation link sent through the email, to \u003cem\u003ehttps://\u003c/em\u003e. Both the text visible as well as the actual link.\u003c/li\u003e\n\u003cli\u003eAvoid automatic logging into the account when the link is clicked. Display a message saying *Your account is verified. Please login to continue.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eAffected area:\u003c/strong\u003e \u003ca title=\"https://hosted.weblate.org/accounts/register/\" href=\"/redirect?url=https%3A%2F%2Fhosted.weblate.org%2Faccounts%2Fregister%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hosted.weblate.org/accounts/register/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":179952,"file_name":"weblate-confirm-email-http.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/179/952/25077ded45202623e064a3b0146429f2eb72ee6c/weblate-confirm-email-http.png?response-content-disposition=attachment%3B%20filename%3D%22weblate-confirm-email-http.png%22%3B%20filename%2A%3DUTF-8%27%27weblate-confirm-email-http.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050219Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=8307873120458562adaac519f22669b303e64845be0d4d056cca6dad41da332d","file_size":163495,"type":"image/png"}],"allow_singular_disclosure_at":"2017-05-27T12:59:24.729Z","allow_singular_disclosure_after":-113328174.70400901,"singular_disclosure_allowed":true,"vote_count":2,"voters":["pavanw3b","spetr0x"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1639760,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Oops, looks like I've messed up configuration on some recent deploy, thanks for noticing. Fix will be out on next deploy.","markdown_message":"\u003cp\u003eOops, looks like I\u0026#39;ve messed up configuration on some recent deploy, thanks for noticing. Fix will be out on next deploy.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T12:07:02.358Z","updated_at":"2017-04-27T12:07:02.358Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pavanw3b","url":"/pavanw3b"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1639852,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the quick response!","markdown_message":"\u003cp\u003eThanks for the quick response!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T12:59:24.709Z","updated_at":"2017-04-27T12:59:24.709Z","first_to_agree":true,"actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1680126,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-17T14:08:06.201Z","updated_at":"2017-05-17T14:08:06.201Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1680127,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-17T14:08:06.245Z","updated_at":"2017-05-17T14:08:06.245Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}