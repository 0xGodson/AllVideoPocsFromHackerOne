{"id":879740,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Nzk3NDA=","url":"https://hackerone.com/reports/879740","title":"Repositories of datanucleus are fetched over insecure protocol (http insted of https)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-05-21T13:47:19.033Z","submitted_at":"2020-05-21T13:47:19.033Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"keval_j","url":"/keval_j","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35524,"url":"https://hackerone.com/central-security-project","handle":"central-security-project","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Central Security Project","twitter_handle":"SaferOpenSource","website":"https://www.sonatype.com/central-security-project","about":"Ensuring Safer Open Source Across Ecosystems"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-05T16:46:01.731Z","bug_reporter_agreed_on_going_public_at":"2020-10-05T16:46:01.497Z","team_member_agreed_on_going_public_at":"2020-10-05T16:39:42.430Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-04T16:39:42.512Z","allow_singular_disclosure_after":-4717525.997611697,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"severity":{"rating":"high","score":8.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":17122,"asset_type":"SOURCE_CODE","asset_identifier":"Java Component in search.maven.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8069091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-21T13:53:45.555Z","updated_at":"2020-05-21T13:55:53.824Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8171137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-01T18:50:38.121Z","updated_at":"2020-06-01T18:50:38.121Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8174756,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T06:17:46.649Z","updated_at":"2020-06-02T06:17:46.649Z","actor":{"username":"sonatypeax","cleared":false,"url":"/sonatypeax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/542/650/edae36fe99afb268133dfec921555bb37f18e509_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8183105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T20:50:11.821Z","updated_at":"2020-06-02T20:50:11.821Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8194573,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-03T20:20:45.490Z","updated_at":"2020-06-03T20:20:45.490Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8260915,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-11T08:44:39.148Z","updated_at":"2020-06-11T08:44:39.148Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8266639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-11T18:12:59.041Z","updated_at":"2020-06-11T18:12:59.041Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8269590,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T06:42:47.770Z","updated_at":"2020-06-12T06:42:47.770Z","actor":{"username":"datanucleus","cleared":false,"url":"/datanucleus","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8269612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T06:47:51.360Z","updated_at":"2020-06-12T06:47:51.360Z","actor":{"username":"datanucleus","cleared":false,"url":"/datanucleus","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8269647,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T06:54:02.698Z","updated_at":"2020-06-12T06:54:02.698Z","actor":{"username":"datanucleus","cleared":false,"url":"/datanucleus","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8276318,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T18:36:02.031Z","updated_at":"2020-06-12T18:36:02.031Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8276493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T18:51:34.717Z","updated_at":"2020-06-12T18:51:34.717Z","actor":{"username":"datanucleus","cleared":false,"url":"/datanucleus","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8280191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-13T04:58:52.117Z","updated_at":"2020-06-13T04:58:52.117Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8339381,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-19T07:47:21.456Z","updated_at":"2020-06-19T07:47:21.456Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8391668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-24T06:12:14.260Z","updated_at":"2020-06-24T06:12:14.260Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8490610,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-03T10:40:46.613Z","updated_at":"2020-07-03T10:40:46.613Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8514826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-06T13:56:42.476Z","updated_at":"2020-07-06T13:56:42.476Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9096328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T08:04:21.257Z","updated_at":"2020-09-01T08:04:21.257Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9124962,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-04T03:07:57.445Z","updated_at":"2020-09-04T03:07:57.445Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9136323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-05T08:59:23.796Z","updated_at":"2020-09-05T08:59:23.796Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9411213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-04T06:45:50.546Z","updated_at":"2020-10-04T06:45:50.546Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9423338,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T16:38:55.040Z","updated_at":"2020-10-05T16:38:55.040Z","actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"keval_j","url":"/keval_j"},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9423350,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T16:39:42.451Z","updated_at":"2020-10-05T16:39:42.451Z","first_to_agree":true,"actor":{"username":"abrinkman","cleared":false,"url":"/abrinkman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9423519,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T16:46:01.526Z","updated_at":"2020-10-05T16:46:01.526Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9423520,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T16:46:01.817Z","updated_at":"2020-10-05T16:46:01.817Z","actor":{"username":"keval_j","cleared":false,"url":"/keval_j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24723,"category":"team","content":"Maven artifact\ngroupId: org.datanucleus\nartifactId: datanucleus-maven-parent\nversion: 4.0.0\n\nVulnerability\nthe jar files inside repositories are fetched using insecure protocol (http instead of https). This allows these artifacts to be potentially MITMed to maliciously compromise them and infect the build artifacts that are produced. Additionally, if any of these JARs or other dependencies were compromised, any developers or production servers using these could continue to be infected past updating to fix this.\n\nAdditional Details\nSource File and Line Number: https://search.maven.org/artifact/org.datanucleus/datanucleus-maven-parent/4.0.0/pom (line : 21)\nVulnerable File(s): http://www.datanucleus.org/downloads/maven2/\nVulnerability Introduction: the above mentioned repo is fetched over http and can be exploited by MITM attack.\n\nSteps To Reproduce:\nDue to complexity of these bug i avoided to attempt to genereate POC because it could possibly affected existing users. but the detailed POC is in the link below which was the same case back in 2014 please Refer the article to reproduce.\nhttps://medium.com/bugbountywriteup/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\nhowever steps to reproduce are as follows:\nClone the Impacted Project\nChange this line in Dilettante so it is targeting the repository used in the build. https://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\nStart Dilettante on your local machine.\nProxy the HTTP traffic for the build through Dilettante\nExecute the Build's tests.\nYou should be greeted with the image of a cat\n\nPatch\nForce https insted of http.\n\nIn short the jar files in http://www.datanucleus.org/downloads/maven2/ repos are fetched over http which can be intercepted by MITM and could cause severe damage to the existing users.\n\nThis isn't just theoretical\n\nA proof of concept for performing this MITM and infecting JAR files on the fly has existed since 2014:\nHere's the blog post link:\nhttps://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\nHere's the GitHub repository with the POC code:\nhttps://github.com/mveytsman/dilettante\n\nImpact\nBy insecurely downloading code over an untrusted connection HTTP and executing the untrusted code inside of these JAR files as part of the unit/integration tests before a release opens these artifacts up to being maliciously compromised.\nRemote code execution on a production server. Malicious compromise of build artifacts.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eMaven artifact\u003cbr\u003e\ngroupId: org.datanucleus\u003cbr\u003e\nartifactId: datanucleus-maven-parent\u003cbr\u003e\nversion: 4.0.0\u003c/p\u003e\n\n\u003cp\u003eVulnerability\u003cbr\u003e\nthe jar files inside repositories are fetched using insecure protocol (http instead of https). This allows these artifacts to be potentially MITMed to maliciously compromise them and infect the build artifacts that are produced. Additionally, if any of these JARs or other dependencies were compromised, any developers or production servers using these could continue to be infected past updating to fix this.\u003c/p\u003e\n\n\u003cp\u003eAdditional Details\u003cbr\u003e\nSource File and Line Number: \u003ca title=\"https://search.maven.org/artifact/org.datanucleus/datanucleus-maven-parent/4.0.0/pom\" href=\"/redirect?url=https%3A%2F%2Fsearch.maven.org%2Fartifact%2Forg.datanucleus%2Fdatanucleus-maven-parent%2F4.0.0%2Fpom\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://search.maven.org/artifact/org.datanucleus/datanucleus-maven-parent/4.0.0/pom\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (line : 21)\u003cbr\u003e\nVulnerable File(s): \u003ca title=\"http://www.datanucleus.org/downloads/maven2/\" href=\"/redirect?url=http%3A%2F%2Fwww.datanucleus.org%2Fdownloads%2Fmaven2%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.datanucleus.org/downloads/maven2/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVulnerability Introduction: the above mentioned repo is fetched over http and can be exploited by MITM attack.\u003c/p\u003e\n\n\u003cp\u003eSteps To Reproduce:\u003cbr\u003e\nDue to complexity of these bug i avoided to attempt to genereate POC because it could possibly affected existing users. but the detailed POC is in the link below which was the same case back in 2014 please Refer the article to reproduce.\u003cbr\u003e\n\u003ca title=\"https://medium.com/bugbountywriteup/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fbugbountywriteup%2Fwant-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/bugbountywriteup/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nhowever steps to reproduce are as follows:\u003cbr\u003e\nClone the Impacted Project\u003cbr\u003e\nChange this line in Dilettante so it is targeting the repository used in the build. \u003ca title=\"https://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmveytsman%2Fdilettante%2Fblob%2Fmaster%2Fdilettante.py%23L143\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nStart Dilettante on your local machine.\u003cbr\u003e\nProxy the HTTP traffic for the build through Dilettante\u003cbr\u003e\nExecute the Build\u0026#39;s tests.\u003cbr\u003e\nYou should be greeted with the image of a cat\u003c/p\u003e\n\n\u003cp\u003ePatch\u003cbr\u003e\nForce https insted of http.\u003c/p\u003e\n\n\u003cp\u003eIn short the jar files in \u003ca title=\"http://www.datanucleus.org/downloads/maven2/\" href=\"/redirect?url=http%3A%2F%2Fwww.datanucleus.org%2Fdownloads%2Fmaven2%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.datanucleus.org/downloads/maven2/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e repos are fetched over http which can be intercepted by MITM and could cause severe damage to the existing users.\u003c/p\u003e\n\n\u003cp\u003eThis isn\u0026#39;t just theoretical\u003c/p\u003e\n\n\u003cp\u003eA proof of concept for performing this MITM and infecting JAR files on the fly has existed since 2014:\u003cbr\u003e\nHere\u0026#39;s the blog post link:\u003cbr\u003e\n\u003ca title=\"https://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\" href=\"/redirect?url=https%3A%2F%2Fmax.computer%2Fblog%2Fhow-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nHere\u0026#39;s the GitHub repository with the POC code:\u003cbr\u003e\n\u003ca title=\"https://github.com/mveytsman/dilettante\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmveytsman%2Fdilettante\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mveytsman/dilettante\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eImpact\u003cbr\u003e\nBy insecurely downloading code over an untrusted connection HTTP and executing the untrusted code inside of these JAR files as part of the unit/integration tests before a release opens these artifacts up to being maliciously compromised.\u003cbr\u003e\nRemote code execution on a production server. Malicious compromise of build artifacts.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}