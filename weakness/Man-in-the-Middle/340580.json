{"id":340580,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDA1ODA=","url":"https://hackerone.com/reports/340580","title":"registry.nodejs.org Subdomain Takeover","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-04-19T16:17:44.299Z","submitted_at":"2018-04-19T16:17:44.299Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dade","url":"/dade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/144/266/64b6c19cc78366e05c80e34c57f2abf0a6984e0b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-04T17:11:18.503Z","bug_reporter_agreed_on_going_public_at":"2018-05-04T09:03:23.175Z","team_member_agreed_on_going_public_at":"2018-05-04T17:11:18.411Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I recently found an abandoned and/or overlooked nodejs.org subdomain that was indirectly pointing to Fastly. Fastly doesn't require any proof of DNS ownership to register new distributions that use a given domain, so I was able to effectively take it over.\n\nVulnerability: Subdomain Takeover via Fastly\nHost: http://registry.nodejs.org\n\nSolution:\nThere are two possible solutions to remediate this issue:\n\n1.) If you no longer wish to use registry.nodejs.org, you can simply delete the registry.nodejs.org CNAME record that is currently pointing to registry.npmjs.org.\n\n2.) Alternatively, if you would like to continue using and/or supporting registry.nodejs.org, you can coordinate with me, I will delete my Fastly service so that someone from nodejs.org can add the registry.nodejs.org domain to the \"Domains\" field in the related Fastly service.  This should be done in a timely and coordinated fashion to prevent another researcher (or less savory type) from registering it before you are able to.\n\n## Impact\n\nSince discovering this vulnerability I have received more than 300 requests for various npm packages. A malicious attacker could have used this access to begin delivering backdoored (or otherwise malicious) packages to users who were not using the correct registry setting of registry.npmjs.org.","vulnerability_information_html":"\u003cp\u003eI recently found an abandoned and/or overlooked nodejs.org subdomain that was indirectly pointing to Fastly. Fastly doesn\u0026#39;t require any proof of DNS ownership to register new distributions that use a given domain, so I was able to effectively take it over.\u003c/p\u003e\n\n\u003cp\u003eVulnerability: Subdomain Takeover via Fastly\u003cbr\u003e\nHost: \u003ca title=\"http://registry.nodejs.org\" href=\"/redirect?url=http%3A%2F%2Fregistry.nodejs.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://registry.nodejs.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSolution:\u003cbr\u003e\nThere are two possible solutions to remediate this issue:\u003c/p\u003e\n\n\u003cp\u003e1.) If you no longer wish to use registry.nodejs.org, you can simply delete the registry.nodejs.org CNAME record that is currently pointing to registry.npmjs.org.\u003c/p\u003e\n\n\u003cp\u003e2.) Alternatively, if you would like to continue using and/or supporting registry.nodejs.org, you can coordinate with me, I will delete my Fastly service so that someone from nodejs.org can add the registry.nodejs.org domain to the \u0026quot;Domains\u0026quot; field in the related Fastly service.  This should be done in a timely and coordinated fashion to prevent another researcher (or less savory type) from registering it before you are able to.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince discovering this vulnerability I have received more than 300 requests for various npm packages. A malicious attacker could have used this access to begin delivering backdoored (or otherwise malicious) packages to users who were not using the correct registry setting of registry.npmjs.org.\u003c/p\u003e\n","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-03T09:03:23.284Z","allow_singular_disclosure_after":-81203729.75659174,"singular_disclosure_allowed":true,"vote_count":33,"voters":["sat0shi","jokebookservice1","chalker","kapytein","muon4","bl4de","spam404","fpatrik","bugdiscloseguys","eveeez","and 23 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2639506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\n\nKind regards.","markdown_message":"\u003cp\u003eThanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\u003c/p\u003e\n\n\u003cp\u003eKind regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-19T22:14:42.924Z","updated_at":"2018-04-19T22:14:42.924Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2639574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"1. registry.nodejs.org is a CNAME record that points to registry.npmjs.org\n2. registry.npmjs.org is a cname that points to a.sni.fastly.net\n3. Fastly was configured to listen to registry.npmjs.org, but not configured to listen for registry.nodejs.org\n4. I was able to create a Fastly service that listens for registry.nodejs.org\n5. Requests to registry.nodejs.org get routed to me now, instead of to registry.npmjs.org\n6. You can confirm this by visiting registry.nodejs.org and seeing my HTML comment \"\u003c!--You probably meant registry.npmjs.org--\u003e\" at the top of the page.","markdown_message":"\u003col\u003e\n\u003cli\u003eregistry.nodejs.org is a CNAME record that points to registry.npmjs.org\u003c/li\u003e\n\u003cli\u003eregistry.npmjs.org is a cname that points to a.sni.fastly.net\u003c/li\u003e\n\u003cli\u003eFastly was configured to listen to registry.npmjs.org, but not configured to listen for registry.nodejs.org\u003c/li\u003e\n\u003cli\u003eI was able to create a Fastly service that listens for registry.nodejs.org\u003c/li\u003e\n\u003cli\u003eRequests to registry.nodejs.org get routed to me now, instead of to registry.npmjs.org\u003c/li\u003e\n\u003cli\u003eYou can confirm this by visiting registry.nodejs.org and seeing my HTML comment \u0026quot;\u0026lt;!--You probably meant registry.npmjs.org--\u0026gt;\u0026quot; at the top of the page.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-04-19T22:50:21.434Z","updated_at":"2018-04-19T22:50:21.434Z","actor":{"username":"dade","cleared":false,"url":"/dade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/144/266/64b6c19cc78366e05c80e34c57f2abf0a6984e0b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2648380,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Will pass this on to the team responsible for managing the domains. Thank you.","markdown_message":"\u003cp\u003eWill pass this on to the team responsible for managing the domains. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-20T17:26:51.750Z","updated_at":"2018-04-20T17:26:51.750Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2672843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jasnell, any update on this? I've been sitting on this for nearly a month trying to get someone from Nodejs to respond to it via email.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jasnell\"\u003e@jasnell\u003c/a\u003e, any update on this? I\u0026#39;ve been sitting on this for nearly a month trying to get someone from Nodejs to respond to it via email.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-27T15:33:45.082Z","updated_at":"2018-04-27T15:33:45.082Z","actor":{"username":"dade","cleared":false,"url":"/dade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/144/266/64b6c19cc78366e05c80e34c57f2abf0a6984e0b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2678455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"cname deleted","markdown_message":"\u003cp\u003ecname deleted\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T04:24:20.476Z","updated_at":"2018-04-30T04:24:20.476Z","actor":{"username":"rvagg","cleared":false,"url":"/rvagg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2678465,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-30T04:32:37.523Z","updated_at":"2018-04-30T04:32:37.523Z","actor":{"username":"rvagg","cleared":false,"url":"/rvagg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dade","url":"/dade"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2699807,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-04T09:03:23.254Z","updated_at":"2018-05-04T09:03:23.254Z","first_to_agree":true,"actor":{"username":"dade","cleared":false,"url":"/dade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/144/266/64b6c19cc78366e05c80e34c57f2abf0a6984e0b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2701268,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-04T17:11:18.440Z","updated_at":"2018-05-04T17:11:18.440Z","actor":{"username":"rvagg","cleared":false,"url":"/rvagg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2701269,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-04T17:11:18.531Z","updated_at":"2018-05-04T17:11:18.531Z","actor":{"username":"rvagg","cleared":false,"url":"/rvagg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2932062,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-25T17:24:54.070Z","updated_at":"2018-06-25T17:24:54.070Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}