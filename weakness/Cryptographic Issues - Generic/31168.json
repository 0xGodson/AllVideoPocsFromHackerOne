{"id":31168,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTE2OA==","url":"https://hackerone.com/reports/31168","title":"Cryptographic Side Channel in OAuth Library","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-12T18:27:30.330Z","submitted_at":"2014-10-12T18:27:30.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"voodookobra","url":"/voodookobra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":297,"url":"https://hackerone.com/wp-api","handle":"wp-api","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WP API","twitter_handle":null,"website":"http://wp-api.org/","about":"Access your WordPress siteâ€™s data through an easy-to-use HTTP REST API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-10-29T19:57:02.804Z","bug_reporter_agreed_on_going_public_at":"2014-10-29T19:50:07.082Z","team_member_agreed_on_going_public_at":"2014-10-29T19:57:02.696Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Because hashes and tokens are compared with the `!==` and `===` operators, these checks may be susceptible to timing attacks. More info: http://codahale.com/a-lesson-in-timing-attacks/\r\n\r\nAffected code:\r\n\r\nhttps://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L562\r\nhttps://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L290","vulnerability_information_html":"\u003cp\u003eBecause hashes and tokens are compared with the \u003ccode\u003e!==\u003c/code\u003e and \u003ccode\u003e===\u003c/code\u003e operators, these checks may be susceptible to timing attacks. More info: \u003ca title=\"http://codahale.com/a-lesson-in-timing-attacks/\" href=\"/redirect?url=http%3A%2F%2Fcodahale.com%2Fa-lesson-in-timing-attacks%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://codahale.com/a-lesson-in-timing-attacks/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAffected code:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L562\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWP-API%2FOAuth1%2Fblob%2F45197eca2925f5022192903d3639decd0ae1811c%2Flib%2Fclass-wp-json-authentication-oauth1.php%23L562\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L562\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L290\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWP-API%2FOAuth1%2Fblob%2F45197eca2925f5022192903d3639decd0ae1811c%2Flib%2Fclass-wp-json-authentication-oauth1.php%23L290\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WP-API/OAuth1/blob/45197eca2925f5022192903d3639decd0ae1811c/lib/class-wp-json-authentication-oauth1.php#L290\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-11-28T19:50:07.199Z","allow_singular_disclosure_after":-192015727.15111533,"singular_disclosure_allowed":true,"vote_count":1,"voters":["thanh"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":148126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, has anyone in the WP API team had a chance to even acknowledge that this was submitted here? Radio silence does not make me feel confident about pursuing a resolution. Even a \"we got it, we'll have time to review it within $timeframe_estimate\" would be great.","markdown_message":"\u003cp\u003eSo, has anyone in the WP API team had a chance to even acknowledge that this was submitted here? Radio silence does not make me feel confident about pursuing a resolution. Even a \u0026quot;we got it, we\u0026#39;ll have time to review it within $timeframe_estimate\u0026quot; would be great.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-25T03:30:09.405Z","updated_at":"2014-10-25T03:30:09.405Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":148813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"More examples of the same problem:\n\nhttps://github.com/WP-API/Key-Auth/blob/f9b74b3e4df667cfb44baba556eafde65fa3aec9/key-auth.php#L50","markdown_message":"\u003cp\u003eMore examples of the same problem:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/WP-API/Key-Auth/blob/f9b74b3e4df667cfb44baba556eafde65fa3aec9/key-auth.php#L50\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWP-API%2FKey-Auth%2Fblob%2Ff9b74b3e4df667cfb44baba556eafde65fa3aec9%2Fkey-auth.php%23L50\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WP-API/Key-Auth/blob/f9b74b3e4df667cfb44baba556eafde65fa3aec9/key-auth.php#L50\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-27T15:33:19.083Z","updated_at":"2014-10-27T15:33:19.083Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the last one:\nhttps://eval.in/108854\n\nYou're comparing it with `!=` here which is also vulnerable to type confusion issues. \n\nSee also:\nhttps://github.com/KnightSwarm/Envoy/blob/develop/src/api/public_html/cphp-rest/api.php#L709-L712","markdown_message":"\u003cp\u003eFor the last one:\u003cbr\u003e\n\u003ca title=\"https://eval.in/108854\" href=\"/redirect?url=https%3A%2F%2Feval.in%2F108854\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://eval.in/108854\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou\u0026#39;re comparing it with \u003ccode\u003e!=\u003c/code\u003e here which is also vulnerable to type confusion issues. \u003c/p\u003e\n\n\u003cp\u003eSee also:\u003cbr\u003e\n\u003ca title=\"https://github.com/KnightSwarm/Envoy/blob/develop/src/api/public_html/cphp-rest/api.php#L709-L712\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FKnightSwarm%2FEnvoy%2Fblob%2Fdevelop%2Fsrc%2Fapi%2Fpublic_html%2Fcphp-rest%2Fapi.php%23L709-L712\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/KnightSwarm/Envoy/blob/develop/src/api/public_html/cphp-rest/api.php#L709-L712\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-28T16:47:51.448Z","updated_at":"2014-10-28T16:56:59.602Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149769,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please respond by 8 PM Eastern Time today, or I will disclose these bugs publicly.","markdown_message":"\u003cp\u003ePlease respond by 8 PM Eastern Time today, or I will disclose these bugs publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-28T16:54:48.371Z","updated_at":"2014-10-28T16:54:48.371Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":150179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://gist.github.com/sarciszewski/41dff863601ea7f45d51","markdown_message":"\u003cp\u003e\u003ca title=\"https://gist.github.com/sarciszewski/41dff863601ea7f45d51\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2Fsarciszewski%2F41dff863601ea7f45d51\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/sarciszewski/41dff863601ea7f45d51\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T00:50:02.146Z","updated_at":"2014-10-29T00:50:02.146Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":150756,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey, my apologies for this. We've had huge problems using HackerOne due to the large number of invalid reports that we get, so we had started only reading this on an infrequent basis. Obviously, this sucks, especially because we didn't communicate that.\n\nThis bug is totally valid, and something we need to fix. Thanks for reporting this responsibly, and sorry again for our lack of response here. WordPress has a `hash_equals()` function that we can use, and it's trivial for us to do so.\n\nI'll push a fix for this in a moment and credit you appropriately. Happy also to issue the bounty to either you or to a registered charity.","markdown_message":"\u003cp\u003eHey, my apologies for this. We\u0026#39;ve had huge problems using HackerOne due to the large number of invalid reports that we get, so we had started only reading this on an infrequent basis. Obviously, this sucks, especially because we didn\u0026#39;t communicate that.\u003c/p\u003e\n\n\u003cp\u003eThis bug is totally valid, and something we need to fix. Thanks for reporting this responsibly, and sorry again for our lack of response here. WordPress has a \u003ccode\u003ehash_equals()\u003c/code\u003e function that we can use, and it\u0026#39;s trivial for us to do so.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll push a fix for this in a moment and credit you appropriately. Happy also to issue the bounty to either you or to a registered charity.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:12:13.229Z","updated_at":"2014-10-29T19:12:13.229Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":150765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in https://github.com/WP-API/OAuth1/commit/827e43a1cb7d375786fea442f03bf82f0a9bb75e\n\nI'll close and resolve this pending your response re: bounty.","markdown_message":"\u003cp\u003eFixed in \u003ca title=\"https://github.com/WP-API/OAuth1/commit/827e43a1cb7d375786fea442f03bf82f0a9bb75e\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWP-API%2FOAuth1%2Fcommit%2F827e43a1cb7d375786fea442f03bf82f0a9bb75e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WP-API/OAuth1/commit/827e43a1cb7d375786fea442f03bf82f0a9bb75e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll close and resolve this pending your response re: bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:27:29.179Z","updated_at":"2014-10-29T19:27:29.179Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":150768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Feel free to send it to http://www.gofundme.com/PayPal14 or, if that is not acceptable, feel free to send it to me and I'll just donate it myself. Either way works for me. :)","markdown_message":"\u003cp\u003eFeel free to send it to \u003ca title=\"http://www.gofundme.com/PayPal14\" href=\"/redirect?url=http%3A%2F%2Fwww.gofundme.com%2FPayPal14\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.gofundme.com/PayPal14\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or, if that is not acceptable, feel free to send it to me and I\u0026#39;ll just donate it myself. Either way works for me. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:44:02.359Z","updated_at":"2014-10-29T19:44:02.359Z","actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":150770,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-10-29T19:46:08.801Z","updated_at":"2014-10-29T19:46:08.801Z","actor":{"url":"/wp-api","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WP API"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"wp-api","collaborator":{"username":"voodookobra","url":"/voodookobra"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":150773,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks; rewarded to you now. Sorry again for the delay.","markdown_message":"\u003cp\u003eThanks; rewarded to you now. Sorry again for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:48:09.744Z","updated_at":"2014-10-29T19:48:09.744Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"voodookobra","url":"/voodookobra"},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":150774,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"It happens. I'm glad this had a happy ending. Hopefully HackerOne can address the deluge problem you experienced?","markdown_message":"\u003cp\u003eIt happens. I\u0026#39;m glad this had a happy ending. Hopefully HackerOne can address the deluge problem you experienced?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:50:07.101Z","updated_at":"2014-10-29T19:50:07.101Z","first_to_agree":true,"actor":{"username":"voodookobra","cleared":false,"url":"/voodookobra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/876/5af7ec493ab376ef166693fadb83e0e0d419cc61_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":150783,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Agreed; they've reached out, and I'll be talking with them. Thanks for being so understanding.","markdown_message":"\u003cp\u003eAgreed; they\u0026#39;ve reached out, and I\u0026#39;ll be talking with them. Thanks for being so understanding.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-29T19:57:02.711Z","updated_at":"2014-10-29T19:57:02.711Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":150784,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-10-29T19:57:02.819Z","updated_at":"2014-10-29T19:57:02.819Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}