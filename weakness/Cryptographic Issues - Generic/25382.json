{"id":25382,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTM4Mg==","url":"https://hackerone.com/reports/25382","title":"Apache mod_negotiation filename bruteforcing","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-08-20T11:57:25.763Z","submitted_at":"2014-08-20T11:57:25.763Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"jpsecurityresearch","url":"/jpsecurityresearch","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-09-19T17:22:27.808Z","bug_reporter_agreed_on_going_public_at":"2014-08-20T17:22:13.027Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Vulnerability description\r\nmod_negotiation is an Apache module responsible for selecting the document that best matches the clients capabilities, from one of several available documents. If the client provides an invalid Accept header, the server will respond with a 406 Not Acceptable error containing a pseudo directory listing. This behaviour can help an attacker to learn more about his target, for example, generate a list of base names, generate a list of interesting extensions, look for backup files and so on.\r\n\r\nVULN AFFECTS WEBSERVER\r\n\r\nIMPACT - Possible information disclosure: directory listing, filename bruteforcing, backup files.\r\n\r\nFIX - Disable the MultiViews directive from Apache's configuration file and restart Apache.\r\nYou can disable MultiViews by creating a .htaccess file containing the following line:\r\n\r\nOptions -Multiviews\r\n\r\nHTTP HEADER RESULTS~\r\n\r\nResponse\r\nHTTP/1.1 406 Not Acceptable\r\nDate: Wed, 20 Aug 2014 11:50:24 GMT\r\nContent-Type: text/html; charset=iso-8859-1\r\nConnection: keep-alive\r\nAlternates: {\"index.html\" 1 {type text/html}}\r\nVary: negotiate,Accept-Encoding\r\nServer: cloudflare-nginx\r\nCF-RAY: 15ce5f817c840bb1-HKG\r\nContent-Length: 1020\r\n","vulnerability_information_html":"\u003cp\u003eVulnerability description\u003cbr\u003e\nmod_negotiation is an Apache module responsible for selecting the document that best matches the clients capabilities, from one of several available documents. If the client provides an invalid Accept header, the server will respond with a 406 Not Acceptable error containing a pseudo directory listing. This behaviour can help an attacker to learn more about his target, for example, generate a list of base names, generate a list of interesting extensions, look for backup files and so on.\u003c/p\u003e\n\n\u003cp\u003eVULN AFFECTS WEBSERVER\u003c/p\u003e\n\n\u003cp\u003eIMPACT - Possible information disclosure: directory listing, filename bruteforcing, backup files.\u003c/p\u003e\n\n\u003cp\u003eFIX - Disable the MultiViews directive from Apache\u0026#39;s configuration file and restart Apache.\u003cbr\u003e\nYou can disable MultiViews by creating a .htaccess file containing the following line:\u003c/p\u003e\n\n\u003cp\u003eOptions -Multiviews\u003c/p\u003e\n\n\u003cp\u003eHTTP HEADER RESULTS~\u003c/p\u003e\n\n\u003cp\u003eResponse\u003cbr\u003e\nHTTP/1.1 406 Not Acceptable\u003cbr\u003e\nDate: Wed, 20 Aug 2014 11:50:24 GMT\u003cbr\u003e\nContent-Type: text/html; charset=iso-8859-1\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nAlternates: {\u0026quot;index.html\u0026quot; 1 {type text/html}}\u003cbr\u003e\nVary: negotiate,Accept-Encoding\u003cbr\u003e\nServer: cloudflare-nginx\u003cbr\u003e\nCF-RAY: 15ce5f817c840bb1-HKG\u003cbr\u003e\nContent-Length: 1020\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-19T17:22:13.184Z","allow_singular_disclosure_after":-198071429.21825808,"singular_disclosure_allowed":true,"vote_count":1,"voters":["lazy_kasi"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":112685,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Automated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.","markdown_message":"\u003cp\u003eAutomated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:49:37.216Z","updated_at":"2014-08-20T16:49:37.216Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112691,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Anyone can bruteforce your directories. it can be used a  payload with other vulnerabilities like lfi and rfi... it will help the attacker to find out the structure of the site\nInfo -http://www.rapid7.com/db/modules/auxiliary/scanner/http/mod_negotiation_brute/","markdown_message":"\u003cp\u003eAnyone can bruteforce your directories. it can be used a  payload with other vulnerabilities like lfi and rfi... it will help the attacker to find out the structure of the site\u003cbr\u003e\nInfo -\u003ca title=\"http://www.rapid7.com/db/modules/auxiliary/scanner/http/mod_negotiation_brute/\" href=\"/redirect?url=http%3A%2F%2Fwww.rapid7.com%2Fdb%2Fmodules%2Fauxiliary%2Fscanner%2Fhttp%2Fmod_negotiation_brute%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.rapid7.com/db/modules/auxiliary/scanner/http/mod_negotiation_brute/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:54:28.743Z","updated_at":"2014-08-20T16:54:28.743Z","actor":{"username":"jpsecurityresearch","cleared":false,"url":"/jpsecurityresearch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112696,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Based on our internal review and discussion, there does not appear to be any security implications as a direct result of this behavior. We have taken steps internally to mitigate any potential issues with Apache's MultiViews feature and we don't consider this to be a security risk based on these steps we've taken.\n\nIf you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.","markdown_message":"\u003cp\u003eBased on our internal review and discussion, there does not appear to be any security implications as a direct result of this behavior. We have taken steps internally to mitigate any potential issues with Apache\u0026#39;s MultiViews feature and we don\u0026#39;t consider this to be a security risk based on these steps we\u0026#39;ve taken.\u003c/p\u003e\n\n\u003cp\u003eIf you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:57:41.831Z","updated_at":"2014-08-20T16:57:41.831Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112698,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"please check this attack poc. - http://keralacybersquad.blogspot.com/2013/12/apache-modnegotiation-filename.html\n\nThanks./~","markdown_message":"\u003cp\u003eplease check this attack poc. - \u003ca title=\"http://keralacybersquad.blogspot.com/2013/12/apache-modnegotiation-filename.html\" href=\"/redirect?url=http%3A%2F%2Fkeralacybersquad.blogspot.com%2F2013%2F12%2Fapache-modnegotiation-filename.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://keralacybersquad.blogspot.com/2013/12/apache-modnegotiation-filename.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks./~\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:58:37.297Z","updated_at":"2014-08-20T16:58:37.297Z","actor":{"username":"jpsecurityresearch","cleared":false,"url":"/jpsecurityresearch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nUnderstood, but as mentioned we have taken steps to mitigate potential issues, such as the one indicated. If you still believe that a vulnerability remains please indicate that, otherwise we do believe this report has been resolved.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eUnderstood, but as mentioned we have taken steps to mitigate potential issues, such as the one indicated. If you still believe that a vulnerability remains please indicate that, otherwise we do believe this report has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:13:12.868Z","updated_at":"2014-08-20T17:13:12.868Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thats good. i do believed that this is resolved. is it valid for bounty?","markdown_message":"\u003cp\u003ethats good. i do believed that this is resolved. is it valid for bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:17:46.807Z","updated_at":"2014-08-20T17:17:46.807Z","actor":{"username":"jpsecurityresearch","cleared":false,"url":"/jpsecurityresearch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nUnfortunately this does not qualify for the reward as we had already addressed this before we received your report.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eUnfortunately this does not qualify for the reward as we had already addressed this before we received your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:20:28.653Z","updated_at":"2014-08-20T17:20:28.653Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112737,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"ok thanks. public disclosure?","markdown_message":"\u003cp\u003eok thanks. public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:22:13.041Z","updated_at":"2014-08-20T17:22:13.041Z","actor":{"username":"jpsecurityresearch","cleared":false,"url":"/jpsecurityresearch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112756,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nYes that would be OK  as we don't consider this to be a vulnerability.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYes that would be OK  as we don\u0026#39;t consider this to be a vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:31:54.336Z","updated_at":"2014-08-20T17:31:54.336Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":129805,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-19T17:22:27.820Z","updated_at":"2014-09-19T17:22:27.820Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}