{"id":49357,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTM1Nw==","url":"https://hackerone.com/reports/49357","title":"Substantially weakened authenticity verification when using 'Remember me for a week'","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-02-27T03:48:46.203Z","submitted_at":"2015-02-27T03:48:46.203Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"guido","url":"/guido","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-12T16:29:30.505Z","bug_reporter_agreed_on_going_public_at":"2015-03-12T16:29:29.591Z","team_member_agreed_on_going_public_at":"2015-03-12T15:58:34.046Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello HackerOne,\r\n\r\nI noticed that in order to access data bound to a user's permissions, say their own bug reports, or CSRF-token, you only need one certain cookie, which is ```remember_user_token```, and although it is sent when the user uses HackerOne in a normal fashion, the ```session``` cookie is ignored and thus not required. This only works if the user has the \"Remember me for a week\" option ticked when logging in.\r\n\r\nBoth cookies are values base64-encoded values. Decoding the ```session``` cookie value results in a binary sequence of 602 bytes, and the ```remember_user_token``` results in a sequence 38 bytes wide.\r\n\r\nBoth cookies also include a trailing 20 byte value, presumably a hash value. So ```session``` comprises 602 + 20 = 622 bytes, and ```remember_user_token``` 38+20 = 58.\r\n\r\nBeing able to see confidential data with the 58 bytes rather than 622 bytes obviously lowers the amount of computing power, the number of tries in a brute-force attack, or any way you want to see it, significantly. Presupposing that both values are uniformly random data, then:\r\n\r\n```python\r\nmath.log10((256**622) / (256**58))\r\n1358.2473404358832\r\n```\r\n\r\nIn other words, that is 1358 orders of magnitude of difference, which is substantial.\r\n\r\nI furthermore noticed that the various ```remember_user_token``` values that I yielded upon subsequent logins did not look random at all, but they instead looked quite similar to each other. Suspecting that the login date and time were encoded in this value, I did some statistical tests to see if I could reliably correlate the cookie value with the date and time it was set. Calculations involving these data ( cookie value -\u003e base64 decode -\u003e value of binary sequence as integer on one axis, login date/time as number of seconds since epoch on the other axis), eventually yielded me a 0.93 Pearson correlation coefficient for the last 8 bytes of the binary sequence in my (admittedly limited) test data. It follows that if my test data was sufficiently large to establish this degree of correlation, then knowing when a user logged in can further lower the amount of computation required to successfully guess the ```remember_user_token```. Even if the login time is not known, an attacker can user their common sense and assume no one logged in prior to the inception of HackerOne ( \u003c 2013 ? ) nor in the future ( say \u003e March 2015).\r\n\r\nFinally, it looks to me that ```session``` is frequently updated with a new value whereas ```remember_user_token``` remains constant for the remainder of the session.\r\n\r\nTo reproduce:\r\n\r\n```\r\ncurl https://hackerone.com/current_user -H 'Cookie: remember_user_token={{REMEMBER_USER_TOKEN}}'\r\n```\r\n\r\nWhere {{REMEMBER_USER_TOKEN}} is the value that you copy from your browser once you are logged in. This also works for bug reports in the form\r\n\r\n```\r\nhttps://hackerone.com/reports/[0-9]\\+.json\r\n```\r\n\r\nGuido","vulnerability_information_html":"\u003cp\u003eHello HackerOne,\u003c/p\u003e\n\n\u003cp\u003eI noticed that in order to access data bound to a user\u0026#39;s permissions, say their own bug reports, or CSRF-token, you only need one certain cookie, which is \u003ccode\u003eremember_user_token\u003c/code\u003e, and although it is sent when the user uses HackerOne in a normal fashion, the \u003ccode\u003esession\u003c/code\u003e cookie is ignored and thus not required. This only works if the user has the \u0026quot;Remember me for a week\u0026quot; option ticked when logging in.\u003c/p\u003e\n\n\u003cp\u003eBoth cookies are values base64-encoded values. Decoding the \u003ccode\u003esession\u003c/code\u003e cookie value results in a binary sequence of 602 bytes, and the \u003ccode\u003eremember_user_token\u003c/code\u003e results in a sequence 38 bytes wide.\u003c/p\u003e\n\n\u003cp\u003eBoth cookies also include a trailing 20 byte value, presumably a hash value. So \u003ccode\u003esession\u003c/code\u003e comprises 602 + 20 = 622 bytes, and \u003ccode\u003eremember_user_token\u003c/code\u003e 38+20 = 58.\u003c/p\u003e\n\n\u003cp\u003eBeing able to see confidential data with the 58 bytes rather than 622 bytes obviously lowers the amount of computing power, the number of tries in a brute-force attack, or any way you want to see it, significantly. Presupposing that both values are uniformly random data, then:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003emath\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog10\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"mi\"\u003e256\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"mi\"\u003e622\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e256\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"mi\"\u003e58\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"mf\"\u003e1358.2473404358832\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn other words, that is 1358 orders of magnitude of difference, which is substantial.\u003c/p\u003e\n\n\u003cp\u003eI furthermore noticed that the various \u003ccode\u003eremember_user_token\u003c/code\u003e values that I yielded upon subsequent logins did not look random at all, but they instead looked quite similar to each other. Suspecting that the login date and time were encoded in this value, I did some statistical tests to see if I could reliably correlate the cookie value with the date and time it was set. Calculations involving these data ( cookie value -\u0026gt; base64 decode -\u0026gt; value of binary sequence as integer on one axis, login date/time as number of seconds since epoch on the other axis), eventually yielded me a 0.93 Pearson correlation coefficient for the last 8 bytes of the binary sequence in my (admittedly limited) test data. It follows that if my test data was sufficiently large to establish this degree of correlation, then knowing when a user logged in can further lower the amount of computation required to successfully guess the \u003ccode\u003eremember_user_token\u003c/code\u003e. Even if the login time is not known, an attacker can user their common sense and assume no one logged in prior to the inception of HackerOne ( \u0026lt; 2013 ? ) nor in the future ( say \u0026gt; March 2015).\u003c/p\u003e\n\n\u003cp\u003eFinally, it looks to me that \u003ccode\u003esession\u003c/code\u003e is frequently updated with a new value whereas \u003ccode\u003eremember_user_token\u003c/code\u003e remains constant for the remainder of the session.\u003c/p\u003e\n\n\u003cp\u003eTo reproduce:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl https://hackerone.com/current_user -H \u0026#39;Cookie: remember_user_token={{REMEMBER_USER_TOKEN}}\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere {{REMEMBER_USER_TOKEN}} is the value that you copy from your browser once you are logged in. This also works for bug reports in the form\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://hackerone.com/reports/[0-9]\\+.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGuido\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-11T15:58:35.060Z","allow_singular_disclosure_after":-180454141.8230329,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":343786,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Some additional notes:\n\nI have been able to augment my data set with more data and some more variance in the dates/times plane. I currently get a correlation coefficient of 0.92, P = 0.0012 for the range s[23:-10], where s is the 38 byte string that base64 decoding the cookie produces. I am setting out from a big  endian interpretation of the bytes, that is to say:\n\n```\n   number = s[27] + s[26] \u003c\u003c 8 + s[25] \u003c\u003c 16 + s[24] \u003c\u003c 24 + s[23] \u003c\u003c 32\n```\n\n```number``` is computed for every cookie and this array is subsequently correlated against the array of times when the cookie was set (actually the login time).\n\nTo cut this story short, I'd say you're almost certainly storing the login date in the cookie, which has the side effect of enhancing the predictability of the cookie value as explained in my initial post.\n\nGiven the context of the issue at play (ie. the 'Remember me for 2 weeks' feature), my remark that ```an attacker can user their common sense and assume no one logged in prior to the inception of HackerOne ( \u003c 2013 ? ) nor in the future ( say \u003e March 2015).``` can of course be more precisely formulated as\n\n```(current time - 2 weeks) \u003c= number in cookie \u003c= current time)```\n\n","markdown_message":"\u003cp\u003eSome additional notes:\u003c/p\u003e\n\n\u003cp\u003eI have been able to augment my data set with more data and some more variance in the dates/times plane. I currently get a correlation coefficient of 0.92, P = 0.0012 for the range s[23:-10], where s is the 38 byte string that base64 decoding the cookie produces. I am setting out from a big  endian interpretation of the bytes, that is to say:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e   number = s[27] + s[26] \u0026lt;\u0026lt; 8 + s[25] \u0026lt;\u0026lt; 16 + s[24] \u0026lt;\u0026lt; 24 + s[23] \u0026lt;\u0026lt; 32\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003enumber\u003c/code\u003e is computed for every cookie and this array is subsequently correlated against the array of times when the cookie was set (actually the login time).\u003c/p\u003e\n\n\u003cp\u003eTo cut this story short, I\u0026#39;d say you\u0026#39;re almost certainly storing the login date in the cookie, which has the side effect of enhancing the predictability of the cookie value as explained in my initial post.\u003c/p\u003e\n\n\u003cp\u003eGiven the context of the issue at play (ie. the \u0026#39;Remember me for 2 weeks\u0026#39; feature), my remark that \u003ccode\u003ean attacker can user their common sense and assume no one logged in prior to the inception of HackerOne ( \u0026lt; 2013 ? ) nor in the future ( say \u0026gt; March 2015).\u003c/code\u003e can of course be more precisely formulated as\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e(current time - 2 weeks) \u0026lt;= number in cookie \u0026lt;= current time)\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-01T18:48:18.076Z","updated_at":"2015-03-01T18:48:18.076Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":345207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! We will investigate the issue you're describing.","markdown_message":"\u003cp\u003eThanks for your report! We will investigate the issue you\u0026#39;re describing.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-03T16:40:40.872Z","updated_at":"2015-03-03T16:40:40.872Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":349988,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for this very detailed report. We'll be looking into this, and carefully check whether all of your statements are correct.","markdown_message":"\u003cp\u003eThank you for this very detailed report. We\u0026#39;ll be looking into this, and carefully check whether all of your statements are correct.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-10T10:03:20.404Z","updated_at":"2015-03-10T10:03:20.404Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.\n\nI would like to add that I have not managed to conclusively isolate a range of bits that would constitute a time stamp or another kind of value that is reliably proportionate to the time that the cookie was set. I did, however, find out that the two bytes at\n\nbase64.b64decode( base64_value_in_cookie )[8:10]\n\nare exactly the current user's user ID, which is another 'known' for a potential attacker.\n\nAt any rate, my core argument that, as contrasted with a regular, transient session, 'remember me for a week' substantially narrows the pool of values that an attacker would have to brute-force or otherwise retrieve in order to take over a user's account, still holds, namely because (to recap):\n\n- The size, and thus presumbly the amount of random data, of the session cookie is significantly larger than of a remember_user_token\n- There are 'knowns' that further enhance the predictability of the remember_user_token: the user id at [8:10], possibly a (part of a) time stamp, and I've identified other parts that are seemingly constant (the first 10 bytes of the cookie are always the same, even across different users and browsers, though my test data is limited..)\n- A session cookie is periodically updated whereas the remember_user_token cookie remains constant for the remainder of the week of its validity (or after a user manually logs out)\n- Multiple sessions springing from the same remember_user_token does not alert your system that something is amiss; it would make more sense to only allow a single concurrent connection/session per remember_user_token, since normal use of the website will only ever store one such cookie per browser installation.\n- If an attacker is not concerned with taking over one particular account but ANY account will suffice for them, then running\n\n```\ncurl https://hackerone.com/current_user -H 'Cookie: remember_user_token={{REMEMBER_USER_TOKEN}}'\n```\n\nwith random or semi-random values for {{REMEMBER_USER_TOKEN}} further increases the likelihood of their success (your user ID counter is approaching 19000, a percentage of these has 'remember me' enabled.. you do the math).\n\nGuido","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n\n\u003cp\u003eI would like to add that I have not managed to conclusively isolate a range of bits that would constitute a time stamp or another kind of value that is reliably proportionate to the time that the cookie was set. I did, however, find out that the two bytes at\u003c/p\u003e\n\n\u003cp\u003ebase64.b64decode( base64_value_in_cookie )[8:10]\u003c/p\u003e\n\n\u003cp\u003eare exactly the current user\u0026#39;s user ID, which is another \u0026#39;known\u0026#39; for a potential attacker.\u003c/p\u003e\n\n\u003cp\u003eAt any rate, my core argument that, as contrasted with a regular, transient session, \u0026#39;remember me for a week\u0026#39; substantially narrows the pool of values that an attacker would have to brute-force or otherwise retrieve in order to take over a user\u0026#39;s account, still holds, namely because (to recap):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe size, and thus presumbly the amount of random data, of the session cookie is significantly larger than of a remember_user_token\u003c/li\u003e\n\u003cli\u003eThere are \u0026#39;knowns\u0026#39; that further enhance the predictability of the remember_user_token: the user id at [8:10], possibly a (part of a) time stamp, and I\u0026#39;ve identified other parts that are seemingly constant (the first 10 bytes of the cookie are always the same, even across different users and browsers, though my test data is limited..)\u003c/li\u003e\n\u003cli\u003eA session cookie is periodically updated whereas the remember_user_token cookie remains constant for the remainder of the week of its validity (or after a user manually logs out)\u003c/li\u003e\n\u003cli\u003eMultiple sessions springing from the same remember_user_token does not alert your system that something is amiss; it would make more sense to only allow a single concurrent connection/session per remember_user_token, since normal use of the website will only ever store one such cookie per browser installation.\u003c/li\u003e\n\u003cli\u003eIf an attacker is not concerned with taking over one particular account but ANY account will suffice for them, then running\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl https://hackerone.com/current_user -H \u0026#39;Cookie: remember_user_token={{REMEMBER_USER_TOKEN}}\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewith random or semi-random values for {{REMEMBER_USER_TOKEN}} further increases the likelihood of their success (your user ID counter is approaching 19000, a percentage of these has \u0026#39;remember me\u0026#39; enabled.. you do the math).\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-11T03:07:47.470Z","updated_at":"2015-03-11T03:07:47.470Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352213,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey @guido,\n\nAgain, thank you for your report.\n\nWe've looked into the issue, and while you definitely have a point in that the keyspace is significantly smaller, your challenge to 'do the math' has definitely not fallen on deaf ears ;)\n\nOur 'remember me' functionality is powered by the Devise library. The specific line of code responsible for the generation is [this one](https://github.com/plataformatec/devise/blob/c19f1f27cecd7024df0ff8b4ace400d665dd9576/lib/devise.rb#L485). Let's assume that all data other than this random string is known.\n\nIf we assume SecureRandom is generating properly random numbers, we have 15*8 bits of entropy. This means there are 2^(8*15) possible keys [(approximately 1,3 * 10^36)](http://www.wolframalpha.com/input/?i=2%5E%288*15%29). \n\nOur most basic rate limiting is done in our load-balancer. What we do (basically), is allow every IP-address to make a maximum of 10 requests per second. This means that the minimal (average) time taken for each request would be 0.1 second. At this rate it would take a single computer 1,3 * 10^36 * 0.1 seconds to brute-force the entire key-space. On average you would expect to have found your key by the time you're halfway through the keyspace, so let's make that 1,3 * 10^36 * 0.1 second / 2. As you [can see](http://www.wolframalpha.com/input/?i=%282%5E%288*15%29+*+0.1+second%29+%2F+2), this would take 1,5 * 10^17 times the age of the universe. \n\nLet's say you're quite dedicated to steal someone's account. You take 5 years to plot your ultimate revenge. You're going to use every single internet connected device to try to brute-force your way to victory. [It is estimated](http://www.gartner.com/newsroom/id/2905717) that there will be around 25 billion devices connected to the internet by 2020. Unfortunately this still means that brute-forcing the token will take on average [6.100.000 years](http://www.wolframalpha.com/input/?i=%28%282%5E%288*15%29+*+0.1+second%29+%2F+2%29+%2F+25+billion) to gain access.\n\nFun fact: using `curl https://hackerone.com/current_user -H 'Cookie: remember_user_token=[..redacted..]' -w '%{size_request}'` we can determine that during the request 215 bytes have been sent to HackerOne. During the high-point of your attack, you will be sending 430 Terrabits per second to HackerOne, doubling the global IP traffic rate (and probably melting our load-balancer).\n\nWhile you have a point in the severely reduced size of the keyspace, I think you'll agree that it's still quite formidable.\n\nKind regards","markdown_message":"\u003cp\u003eHey \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAgain, thank you for your report.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve looked into the issue, and while you definitely have a point in that the keyspace is significantly smaller, your challenge to \u0026#39;do the math\u0026#39; has definitely not fallen on deaf ears ;)\u003c/p\u003e\n\n\u003cp\u003eOur \u0026#39;remember me\u0026#39; functionality is powered by the Devise library. The specific line of code responsible for the generation is \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fplataformatec%2Fdevise%2Fblob%2Fc19f1f27cecd7024df0ff8b4ace400d665dd9576%2Flib%2Fdevise.rb%23L485\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis one\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Let\u0026#39;s assume that all data other than this random string is known.\u003c/p\u003e\n\n\u003cp\u003eIf we assume SecureRandom is generating properly random numbers, we have 15*8 bits of entropy. This means there are 2^(8*15) possible keys \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.wolframalpha.com%2Finput%2F%3Fi%3D2%255E%25288%2A15%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e(approximately 1,3 * 10^36)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eOur most basic rate limiting is done in our load-balancer. What we do (basically), is allow every IP-address to make a maximum of 10 requests per second. This means that the minimal (average) time taken for each request would be 0.1 second. At this rate it would take a single computer 1,3 * 10^36 * 0.1 seconds to brute-force the entire key-space. On average you would expect to have found your key by the time you\u0026#39;re halfway through the keyspace, so let\u0026#39;s make that 1,3 * 10^36 * 0.1 second / 2. As you \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.wolframalpha.com%2Finput%2F%3Fi%3D%25282%255E%25288%2A15%2529%2B%2A%2B0.1%2Bsecond%2529%2B%252F%2B2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecan see\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, this would take 1,5 * 10^17 times the age of the universe. \u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s say you\u0026#39;re quite dedicated to steal someone\u0026#39;s account. You take 5 years to plot your ultimate revenge. You\u0026#39;re going to use every single internet connected device to try to brute-force your way to victory. \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.gartner.com%2Fnewsroom%2Fid%2F2905717\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIt is estimated\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that there will be around 25 billion devices connected to the internet by 2020. Unfortunately this still means that brute-forcing the token will take on average \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.wolframalpha.com%2Finput%2F%3Fi%3D%2528%25282%255E%25288%2A15%2529%2B%2A%2B0.1%2Bsecond%2529%2B%252F%2B2%2529%2B%252F%2B25%2Bbillion\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e6.100.000 years\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to gain access.\u003c/p\u003e\n\n\u003cp\u003eFun fact: using \u003ccode\u003ecurl https://hackerone.com/current_user -H \u0026#39;Cookie: remember_user_token=[..redacted..]\u0026#39; -w \u0026#39;%{size_request}\u0026#39;\u003c/code\u003e we can determine that during the request 215 bytes have been sent to HackerOne. During the high-point of your attack, you will be sending 430 Terrabits per second to HackerOne, doubling the global IP traffic rate (and probably melting our load-balancer).\u003c/p\u003e\n\n\u003cp\u003eWhile you have a point in the severely reduced size of the keyspace, I think you\u0026#39;ll agree that it\u0026#39;s still quite formidable.\u003c/p\u003e\n\n\u003cp\u003eKind regards\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T15:58:03.933Z","updated_at":"2015-03-12T15:58:03.933Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":352215,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-12T15:58:34.113Z","updated_at":"2015-03-12T15:58:34.113Z","first_to_agree":true,"actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":352252,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for your response and analysis.\n\nI understand your point, but by that kind of reasoning you might as well dispose of your regular session cookies since it offers an amount of entropy superfluous in regard to the premise of your cryptographic protections, i.e., that it should be strong enough to deter a successful brute-force attack established within the bounds of a reasonable span of time and bandwidth.\n\nBut if this is your decision, I respect it.","markdown_message":"\u003cp\u003eThanks for your response and analysis.\u003c/p\u003e\n\n\u003cp\u003eI understand your point, but by that kind of reasoning you might as well dispose of your regular session cookies since it offers an amount of entropy superfluous in regard to the premise of your cryptographic protections, i.e., that it should be strong enough to deter a successful brute-force attack established within the bounds of a reasonable span of time and bandwidth.\u003c/p\u003e\n\n\u003cp\u003eBut if this is your decision, I respect it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T16:29:29.629Z","updated_at":"2015-03-12T16:29:29.629Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352253,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-12T16:29:30.545Z","updated_at":"2015-03-12T16:29:30.545Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @guido,\n\nAs with the remember me cookie, our session cookie contains more information than just the session token. \n\nWhat you're seeing is a very long encoded string, that contains, among other things: A randomly generated session id (with enough entropy to make brute-force infeasible) and [flash messages](http://apidock.com/rails/ActionDispatch/Request/flash). \n\nThe length of the session cookie is therefore not a good measure of the entropy contained therein. \n\nThank you for your report,","markdown_message":"\u003cp\u003eHey \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs with the remember me cookie, our session cookie contains more information than just the session token. \u003c/p\u003e\n\n\u003cp\u003eWhat you\u0026#39;re seeing is a very long encoded string, that contains, among other things: A randomly generated session id (with enough entropy to make brute-force infeasible) and \u003ca href=\"/redirect?url=http%3A%2F%2Fapidock.com%2Frails%2FActionDispatch%2FRequest%2Fflash\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eflash messages\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eThe length of the session cookie is therefore not a good measure of the entropy contained therein. \u003c/p\u003e\n\n\u003cp\u003eThank you for your report,\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-13T10:12:02.298Z","updated_at":"2015-03-13T10:12:02.298Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}