{"id":166629,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY2Mjk=","url":"https://hackerone.com/reports/166629","title":"Cross-protocol attack on TLS using SSLv2 (DROWN) (CVE-2016-0800)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-07T17:34:32.879Z","submitted_at":"2016-09-07T17:34:32.879Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nimia","url":"/nimia","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24,"url":"https://hackerone.com/ibb-openssl","handle":"ibb-openssl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OpenSSL (IBB)","twitter_handle":"","website":"https://www.openssl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-21T17:50:33.692Z","bug_reporter_agreed_on_going_public_at":"2016-09-21T17:50:33.480Z","team_member_agreed_on_going_public_at":"2016-09-20T02:55:45.040Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"General DROWN was responsibly disclosed to the OpenSSL team prior to the public disclosure.\nThis OpenSSL blog post, by Viktor Dukhovni and Emilia Käsper, describes the vulnerability:\nhttps://www.openssl.org/blog/blog/2016/03/01/an-openssl-users-guide-to-drown/\n\nThis is probably a good opportunity to again thank everyone who helped with the disclosure process :-)","vulnerability_information_html":"\u003cp\u003eGeneral DROWN was responsibly disclosed to the OpenSSL team prior to the public disclosure.\u003cbr\u003e\nThis OpenSSL blog post, by Viktor Dukhovni and Emilia Käsper, describes the vulnerability:\u003cbr\u003e\n\u003ca title=\"https://www.openssl.org/blog/blog/2016/03/01/an-openssl-users-guide-to-drown/\" href=\"/redirect?url=https%3A%2F%2Fwww.openssl.org%2Fblog%2Fblog%2F2016%2F03%2F01%2Fan-openssl-users-guide-to-drown%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.openssl.org/blog/blog/2016/03/01/an-openssl-users-guide-to-drown/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is probably a good opportunity to again thank everyone who helped with the disclosure process :-)\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-10-20T02:55:45.126Z","allow_singular_disclosure_after":-132284608.33569838,"singular_disclosure_allowed":true,"vote_count":13,"voters":["ymy","jens","bountypls","nillbit","spetr0x","roshanpty","filepicker","aaronpaul","dyabla","mathijsk93","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1181300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just saw that the blog post omits the severity.\nDROWN was classified as high severity in the OpenSSL advisory:\nhttps://www.openssl.org/news/secadv/20160301.txt\n","markdown_message":"\u003cp\u003eI just saw that the blog post omits the severity.\u003cbr\u003e\nDROWN was classified as high severity in the OpenSSL advisory:\u003cbr\u003e\n\u003ca title=\"https://www.openssl.org/news/secadv/20160301.txt\" href=\"/redirect?url=https%3A%2F%2Fwww.openssl.org%2Fnews%2Fsecadv%2F20160301.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.openssl.org/news/secadv/20160301.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-07T23:05:07.158Z","updated_at":"2016-09-07T23:05:07.158Z","actor":{"username":"nimia","cleared":false,"url":"/nimia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1205605,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-20T02:55:06.929Z","updated_at":"2016-09-20T02:55:06.929Z","additional_data":{"old_title":"General DROWN: CVE-2016-0800","new_title":"Cross-protocol attack on TLS using SSLv2 (DROWN) (CVE-2016-0800)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1205606,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-20T02:55:23.923Z","updated_at":"2016-09-20T02:55:23.923Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"nimia","url":"/nimia"},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1205607,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-20T02:55:34.736Z","updated_at":"2016-09-20T02:55:34.736Z","actor":{"url":"/ibb-openssl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OpenSSL (IBB)"}},"bounty_amount":"2500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-openssl","collaborator":{"username":"nimia","url":"/nimia"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1205608,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-20T02:55:45.068Z","updated_at":"2016-09-20T02:55:45.068Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209322,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! Much appreciated :-)","markdown_message":"\u003cp\u003eThanks! Much appreciated :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-21T17:50:33.520Z","updated_at":"2016-09-21T17:50:33.520Z","actor":{"username":"nimia","cleared":false,"url":"/nimia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209323,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-21T17:50:33.736Z","updated_at":"2016-09-21T17:50:33.736Z","actor":{"username":"nimia","cleared":false,"url":"/nimia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2670,"category":"team","content":"Severity: High\n\nA cross-protocol attack was discovered that could lead to decryption of TLS sessions by using a server supporting SSLv2 and EXPORT cipher suites as a Bleichenbacher RSA padding oracle.  Note that traffic between clients and non-vulnerable servers can be decrypted provided another server supporting SSLv2 and EXPORT ciphers (even with a different protocol such as SMTP, IMAP or POP) shares the RSA keys of the non-vulnerable server. This vulnerability is known as DROWN (CVE-2016-0800).\n\nRecovering one session key requires the attacker to perform approximately 2^50 computation, as well as thousands of connections to the affected server. A more efficient variant of the DROWN attack exists against unpatched OpenSSL servers using versions that predate 1.0.2a, 1.0.1m, 1.0.0r and 0.9.8zf released on 19/Mar/2015 (see CVE-2016-0703).\n\nUsers can avoid this issue by disabling the SSLv2 protocol in all their SSL/TLS servers, if they've not done so already. Disabling all SSLv2 ciphers is also sufficient, provided the patches for CVE-2015-3197 (fixed in OpenSSL 1.0.1r and 1.0.2f) have been deployed.  Servers that have not disabled the SSLv2 protocol, and are not patched for CVE-2015-3197 are vulnerable to DROWN even if all SSLv2 ciphers are nominally disabled, because malicious clients can force the use of SSLv2 with EXPORT ciphers.\n\nOpenSSL 1.0.2g and 1.0.1s deploy the following mitigation against DROWN:\n\nSSLv2 is now by default disabled at build-time.  Builds that are not configured with \"enable-ssl2\" will not support SSLv2.  Even if \"enable-ssl2\" is used, users who want to negotiate SSLv2 via the version-flexible SSLv23_method() will need to explicitly call either of:\n\n   SSL_CTX_clear_options(ctx, SSL_OP_NO_SSLv2);\n   or\n   SSL_clear_options(ssl, SSL_OP_NO_SSLv2);\n\nas appropriate.  Even if either of those is used, or the application explicitly uses the version-specific SSLv2_method() or its client or server variants, SSLv2 ciphers vulnerable to exhaustive search key recovery have been removed. Specifically, the SSLv2 40-bit EXPORT ciphers, and SSLv2 56-bit DES are no longer available.\n\nIn addition, weak ciphers in SSLv3 and up are now disabled in default builds of OpenSSL.  Builds that are not configured with \"enable-weak-ssl-ciphers\" will not provide any \"EXPORT\" or \"LOW\" strength ciphers.\n\nOpenSSL 1.0.2 users should upgrade to 1.0.2g\nOpenSSL 1.0.1 users should upgrade to 1.0.1s\n\nThis issue was reported to OpenSSL on December 29th 2015 by Nimrod Aviram and Sebastian Schinzel. The fix was developed by Viktor Dukhovni and Matt Caswell of OpenSSL.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eSeverity: High\u003c/p\u003e\n\n\u003cp\u003eA cross-protocol attack was discovered that could lead to decryption of TLS sessions by using a server supporting SSLv2 and EXPORT cipher suites as a Bleichenbacher RSA padding oracle.  Note that traffic between clients and non-vulnerable servers can be decrypted provided another server supporting SSLv2 and EXPORT ciphers (even with a different protocol such as SMTP, IMAP or POP) shares the RSA keys of the non-vulnerable server. This vulnerability is known as DROWN (CVE-2016-0800).\u003c/p\u003e\n\n\u003cp\u003eRecovering one session key requires the attacker to perform approximately 2^50 computation, as well as thousands of connections to the affected server. A more efficient variant of the DROWN attack exists against unpatched OpenSSL servers using versions that predate 1.0.2a, 1.0.1m, 1.0.0r and 0.9.8zf released on 19/Mar/2015 (see CVE-2016-0703).\u003c/p\u003e\n\n\u003cp\u003eUsers can avoid this issue by disabling the SSLv2 protocol in all their SSL/TLS servers, if they\u0026#39;ve not done so already. Disabling all SSLv2 ciphers is also sufficient, provided the patches for CVE-2015-3197 (fixed in OpenSSL 1.0.1r and 1.0.2f) have been deployed.  Servers that have not disabled the SSLv2 protocol, and are not patched for CVE-2015-3197 are vulnerable to DROWN even if all SSLv2 ciphers are nominally disabled, because malicious clients can force the use of SSLv2 with EXPORT ciphers.\u003c/p\u003e\n\n\u003cp\u003eOpenSSL 1.0.2g and 1.0.1s deploy the following mitigation against DROWN:\u003c/p\u003e\n\n\u003cp\u003eSSLv2 is now by default disabled at build-time.  Builds that are not configured with \u0026quot;enable-ssl2\u0026quot; will not support SSLv2.  Even if \u0026quot;enable-ssl2\u0026quot; is used, users who want to negotiate SSLv2 via the version-flexible SSLv23_method() will need to explicitly call either of:\u003c/p\u003e\n\n\u003cp\u003eSSL_CTX_clear_options(ctx, SSL_OP_NO_SSLv2);\u003cbr\u003e\n   or\u003cbr\u003e\n   SSL_clear_options(ssl, SSL_OP_NO_SSLv2);\u003c/p\u003e\n\n\u003cp\u003eas appropriate.  Even if either of those is used, or the application explicitly uses the version-specific SSLv2_method() or its client or server variants, SSLv2 ciphers vulnerable to exhaustive search key recovery have been removed. Specifically, the SSLv2 40-bit EXPORT ciphers, and SSLv2 56-bit DES are no longer available.\u003c/p\u003e\n\n\u003cp\u003eIn addition, weak ciphers in SSLv3 and up are now disabled in default builds of OpenSSL.  Builds that are not configured with \u0026quot;enable-weak-ssl-ciphers\u0026quot; will not provide any \u0026quot;EXPORT\u0026quot; or \u0026quot;LOW\u0026quot; strength ciphers.\u003c/p\u003e\n\n\u003cp\u003eOpenSSL 1.0.2 users should upgrade to 1.0.2g\u003cbr\u003e\nOpenSSL 1.0.1 users should upgrade to 1.0.1s\u003c/p\u003e\n\n\u003cp\u003eThis issue was reported to OpenSSL on December 29th 2015 by Nimrod Aviram and Sebastian Schinzel. The fix was developed by Viktor Dukhovni and Matt Caswell of OpenSSL.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}