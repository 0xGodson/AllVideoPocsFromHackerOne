{"id":223435,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjM0MzU=","url":"https://hackerone.com/reports/223435","title":"Open SMTP port can let anyone send email from mail.chihar.com","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2017-04-24T13:07:36.985Z","submitted_at":"2017-04-24T13:07:36.985Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"str33","url":"/str33","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-20T12:34:24.535Z","bug_reporter_agreed_on_going_public_at":"2017-05-20T12:34:24.488Z","team_member_agreed_on_going_public_at":"2017-05-17T18:50:10.312Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An open SMTP port 587 can let anyone connect and send emails impersonating someone in your the company if he could enumerate the email addresses.\n\nPOC - \n1.  I performed an nmap scan and was able to find an open port 587 for SMTP\n2. I did a netcat connection to it and was able to run commands such as HELO and EHLO(which is harmless)\n3. I could even use commands STARTTLS and MAIL TO.\n4. I can impersonate the support team of weblate and send an email to one of the employees asking them to visit a link and even though they know about phishing they might do it and hence stealing their sessionID.\n\nThe image shows few commands which I was able to run on the server.\n\nPretty much all the companies have strong email security policies and hence you should implement it and deny end user access to the SMTP server.\n\n\n","vulnerability_information_html":"\u003cp\u003eAn open SMTP port 587 can let anyone connect and send emails impersonating someone in your the company if he could enumerate the email addresses.\u003c/p\u003e\n\n\u003cp\u003ePOC - \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e I performed an nmap scan and was able to find an open port 587 for SMTP\u003c/li\u003e\n\u003cli\u003eI did a netcat connection to it and was able to run commands such as HELO and EHLO(which is harmless)\u003c/li\u003e\n\u003cli\u003eI could even use commands STARTTLS and MAIL TO.\u003c/li\u003e\n\u003cli\u003eI can impersonate the support team of weblate and send an email to one of the employees asking them to visit a link and even though they know about phishing they might do it and hence stealing their sessionID.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe image shows few commands which I was able to run on the server.\u003c/p\u003e\n\n\u003cp\u003ePretty much all the companies have strong email security policies and hence you should implement it and deny end user access to the SMTP server.\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":178845,"file_name":"Capture2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/178/845/18242f75b979c78a9be98bff8ce022f2b65aaa4e/Capture2.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture2.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050145Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=363687da80325a81fa4d2534a0df6c1370c51ed3974294c059c63b48b3fa3ee1","file_size":48768,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["khizer47","spetr0x","klau5","arundhanush4"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1630679,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Can you please provide example of sending such mail? The server will only accept mail for addresses it servers, it's not open relay.","markdown_message":"\u003cp\u003eCan you please provide example of sending such mail? The server will only accept mail for addresses it servers, it\u0026#39;s not open relay.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-24T13:55:21.333Z","updated_at":"2017-04-24T13:55:21.333Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1630717,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Since I couldn't enumerate the user ID or email, I couldn't actually perform the attack myself. I've added a screenshot of how far I was able to reach. If a malicious user can enumerate the users, he could send the email from one user to another.","markdown_message":"\u003cp\u003eSince I couldn\u0026#39;t enumerate the user ID or email, I couldn\u0026#39;t actually perform the attack myself. I\u0026#39;ve added a screenshot of how far I was able to reach. If a malicious user can enumerate the users, he could send the email from one user to another.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-24T14:07:33.414Z","updated_at":"2017-04-24T14:07:33.414Z","actor":{"username":"str33","cleared":false,"url":"/str33","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":178886,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/178/886/016da5bc500db6156bec7cbd5b0a5cde30e842d1/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050145Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=24c34d3062c81cd7fe47fbcfc042a974fd3b4db6813c31f221397992d33a6557"}],"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1630793,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Sorry, but I don't see any problem here. The server is IMHO configured properly and you have not shown anything what would indicate otherwise.\n\n* The server only accepts mail for addresses which it's configured to deliver.\n* The sender address is checked (eg. by SPF), so you can not send from untrusted host.\n\nSee following communication for example:\n\n```\n$ nc weblate.org 587\n220 mail.cihar.com ESMTP Exim 4.89 Mon, 24 Apr 2017 16:24:50 +0200\nHELO testing\n250 mail.cihar.com Hello testing [8.8.8.8]\nMAIL FROM: info@weblate.org\n250 OK\nRCPT TO: info@weblate.org\n550-[SPF] 8.8.8.8 is not allowed to send mail from weblate.org.  Please\n550 see http://www.openspf.org/Why?scope=mfrom;identity=info@weblate.org;ip=8.8.8.8\n```\n","markdown_message":"\u003cp\u003eSorry, but I don\u0026#39;t see any problem here. The server is IMHO configured properly and you have not shown anything what would indicate otherwise.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe server only accepts mail for addresses which it\u0026#39;s configured to deliver.\u003c/li\u003e\n\u003cli\u003eThe sender address is checked (eg. by SPF), so you can not send from untrusted host.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSee following communication for example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ nc weblate.org 587\n220 mail.cihar.com ESMTP Exim 4.89 Mon, 24 Apr 2017 16:24:50 +0200\nHELO testing\n250 mail.cihar.com Hello testing [8.8.8.8]\nMAIL FROM: info@weblate.org\n250 OK\nRCPT TO: info@weblate.org\n550-[SPF] 8.8.8.8 is not allowed to send mail from weblate.org.  Please\n550 see http://www.openspf.org/Why?scope=mfrom;identity=info@weblate.org;ip=8.8.8.8\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-04-24T14:27:22.350Z","updated_at":"2017-04-24T14:27:22.350Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1681427,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-17T18:50:10.329Z","updated_at":"2017-05-17T18:50:10.329Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1688425,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-20T12:34:24.515Z","updated_at":"2017-05-20T12:34:24.515Z","actor":{"username":"str33","cleared":false,"url":"/str33","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1688426,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-20T12:34:24.550Z","updated_at":"2017-05-20T12:34:24.550Z","actor":{"username":"str33","cleared":false,"url":"/str33","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}