{"id":20873,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDg3Mw==","url":"https://hackerone.com/reports/20873","title":"rsync hash collisions may allow an attacker to corrupt or modify files","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-07-20T22:42:52.832Z","submitted_at":"2014-07-20T22:42:52.832Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mik","url":"/mik","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-11-17T23:54:19.088Z","bug_reporter_agreed_on_going_public_at":"2014-11-17T23:52:49.874Z","team_member_agreed_on_going_public_at":"2014-11-17T23:54:18.800Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The rsync algorithm synchronizes remote files in 3 steps:\r\n- The receiver divides the basis file into 700-byte blocks, performing two checksums on each block (a rolling checksum based on Addler32) and an md5 sum\r\n- The sender then scans it's version of the file byte-by-byte looking for matches against both sums, transmitting either literal data, or a copy command (copy offset length)\r\n- The receiver makes a copy of the file by applying the delta commands from the sender\r\n\r\nWhile it is known that md5 doesn't offer much collision resistance, it is perhaps unknown that the fast md5 collisions can be combined with a collision against the rolling sum.  They can.\r\n\r\nFor files where all of the data is in the same privilege domain, this may allow bypassing validation rules.\r\n\r\nMore critically, for files where data for the system and other users is mixed with untrusted data (VM images, databases), this could allow privilege escalation.\r\n\r\nThere are two different classes of attack on md5 - collisions and chosen-prefix collisions:\r\n- Collisions are very quick to generate on a normal PC, but require a fully crafted file to work (the original demo was a postscript file).  This is what I have attached.\r\n- Chosen-prefix attacks are more serious, but require more work to generate (approx 2^50) - I do not have an example of one of these yet.\r\n\r\nAlso note that rsync does a final full-file hash, which will fail.  This reduces this to just a DoS attack unless --inplace is used (common for syncing large files).\r\n\r\nSince rsync is used for mirroring large open-source projects, and is used in the background for many open source, closed-source and in-house systems, I believe this may qualify for an internet bug bounty.","vulnerability_information_html":"\u003cp\u003eThe rsync algorithm synchronizes remote files in 3 steps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe receiver divides the basis file into 700-byte blocks, performing two checksums on each block (a rolling checksum based on Addler32) and an md5 sum\u003c/li\u003e\n\u003cli\u003eThe sender then scans it\u0026#39;s version of the file byte-by-byte looking for matches against both sums, transmitting either literal data, or a copy command (copy offset length)\u003c/li\u003e\n\u003cli\u003eThe receiver makes a copy of the file by applying the delta commands from the sender\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWhile it is known that md5 doesn\u0026#39;t offer much collision resistance, it is perhaps unknown that the fast md5 collisions can be combined with a collision against the rolling sum.  They can.\u003c/p\u003e\n\n\u003cp\u003eFor files where all of the data is in the same privilege domain, this may allow bypassing validation rules.\u003c/p\u003e\n\n\u003cp\u003eMore critically, for files where data for the system and other users is mixed with untrusted data (VM images, databases), this could allow privilege escalation.\u003c/p\u003e\n\n\u003cp\u003eThere are two different classes of attack on md5 - collisions and chosen-prefix collisions:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCollisions are very quick to generate on a normal PC, but require a fully crafted file to work (the original demo was a postscript file).  This is what I have attached.\u003c/li\u003e\n\u003cli\u003eChosen-prefix attacks are more serious, but require more work to generate (approx 2^50) - I do not have an example of one of these yet.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlso note that rsync does a final full-file hash, which will fail.  This reduces this to just a DoS attack unless --inplace is used (common for syncing large files).\u003c/p\u003e\n\n\u003cp\u003eSince rsync is used for mirroring large open-source projects, and is used in the background for many open source, closed-source and in-house systems, I believe this may qualify for an internet bug bounty.\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":13479,"file_name":"block1a.bin","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/013/479/aba5bb972cf35314515dec1828365f5c0c44fb55/block1a.bin?response-content-disposition=attachment%3B%20filename%3D%22block1a.bin%22%3B%20filename%2A%3DUTF-8%27%27block1a.bin\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXJYPBHFQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDu4%2FXsLbLXL64kN0gTqrVP%2B6YQy0aFrAsl8mmpM3A02gIhAMCTWiWTqJYsWHj2mR6ExJkLtM%2BAer5nJ1p6uJxIO04QKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgyKVAfpOTinzYsPSPkqkQMwQonGdI9p7CuN4bjSzjzCvtK%2FWWqz3YU8bTMgRxd1lvP8n%2BmQUW%2FPjx22yWgMPRHSApDfLhipeKY57Ywk6GpNSLkFsR4mWXVTUZ3fv%2BFpIecsA7FNlVffsWQFQL1hvyVhQXlfUb877oYsLHI7rvsdEl2oxxoNNBVppK7LLDUZ5Hszb5rUUqEs3JeInglYJgHEk0JqpQ59Rfq6iusCJYxnpCRnEk4ATJ3WPY0fYnF5%2BrjplwvF9jvrWA8ORsehD7OObtIyHgdE%2BeHQJDIwKM12S2Z3doq1C1frQwXKFiUX0Y9ZT6Dew0nqLavJd23CiqxMaeH6L8Dme7K0ES6LXhVDxzX5ZM48Lw97Faf%2BmTRwYynJlpTsMle9l6X4AISAwVe8d6Y3lMwIoUf05EQESF56DAXqAPPLzIguWqYse43Fu3rR0Kod4SRKI9ETYrP01wRz5xVgd2auQ8kejiA8344efyhQxkc3iBze4UukBtqzk604geJ6wyBSmoicpk9XqO8dvlhwhYEGoL4EWTozQffflzDAr6r%2FBTrqAb3yz5skpTmfiHh2mY%2FhHGiWzvhaSmhQ5tEgt4YCDEprvoxeYWkvlaxqdLXcMfRTr89qs4wuii5IpOn31c13IIFZzpa09Cs%2BExrDUX44ykH0g1zxLN374%2BwiIK3wd5v3201Stw8drFGqAKHIFBpAjuZIFF37RxSxGgAxlHskSrBBA1YzTX1SQV7r%2FcyXcvsAXO99Rr3E6FQFka96boq3PmqqeaoYxAs03IbehGcOPJ%2F3Ih7ebkxTDLG%2B75tCeMz1g%2BKNymUDx9%2B0KJfzKzXbCzi5TX8vNPGUyjZh2Y7SNRHBl7hFmGgXNktN5w%3D%3D\u0026X-Amz-Signature=05f99dedba9a9ff495db269713c49f23e517a3253aa4f7e8eb0f431b8d330110","file_size":700,"type":"application/octet-stream"},{"id":13480,"file_name":"block1b.bin","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/013/480/427be8b7b835e51926dbb103d4c5904bb947d6ea/block1b.bin?response-content-disposition=attachment%3B%20filename%3D%22block1b.bin%22%3B%20filename%2A%3DUTF-8%27%27block1b.bin\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXJYPBHFQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDu4%2FXsLbLXL64kN0gTqrVP%2B6YQy0aFrAsl8mmpM3A02gIhAMCTWiWTqJYsWHj2mR6ExJkLtM%2BAer5nJ1p6uJxIO04QKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgyKVAfpOTinzYsPSPkqkQMwQonGdI9p7CuN4bjSzjzCvtK%2FWWqz3YU8bTMgRxd1lvP8n%2BmQUW%2FPjx22yWgMPRHSApDfLhipeKY57Ywk6GpNSLkFsR4mWXVTUZ3fv%2BFpIecsA7FNlVffsWQFQL1hvyVhQXlfUb877oYsLHI7rvsdEl2oxxoNNBVppK7LLDUZ5Hszb5rUUqEs3JeInglYJgHEk0JqpQ59Rfq6iusCJYxnpCRnEk4ATJ3WPY0fYnF5%2BrjplwvF9jvrWA8ORsehD7OObtIyHgdE%2BeHQJDIwKM12S2Z3doq1C1frQwXKFiUX0Y9ZT6Dew0nqLavJd23CiqxMaeH6L8Dme7K0ES6LXhVDxzX5ZM48Lw97Faf%2BmTRwYynJlpTsMle9l6X4AISAwVe8d6Y3lMwIoUf05EQESF56DAXqAPPLzIguWqYse43Fu3rR0Kod4SRKI9ETYrP01wRz5xVgd2auQ8kejiA8344efyhQxkc3iBze4UukBtqzk604geJ6wyBSmoicpk9XqO8dvlhwhYEGoL4EWTozQffflzDAr6r%2FBTrqAb3yz5skpTmfiHh2mY%2FhHGiWzvhaSmhQ5tEgt4YCDEprvoxeYWkvlaxqdLXcMfRTr89qs4wuii5IpOn31c13IIFZzpa09Cs%2BExrDUX44ykH0g1zxLN374%2BwiIK3wd5v3201Stw8drFGqAKHIFBpAjuZIFF37RxSxGgAxlHskSrBBA1YzTX1SQV7r%2FcyXcvsAXO99Rr3E6FQFka96boq3PmqqeaoYxAs03IbehGcOPJ%2F3Ih7ebkxTDLG%2B75tCeMz1g%2BKNymUDx9%2B0KJfzKzXbCzi5TX8vNPGUyjZh2Y7SNRHBl7hFmGgXNktN5w%3D%3D\u0026X-Amz-Signature=bf4f5a62c2abd94cf90370b426ee57592a7e134f2d0c6bf09a20e6e9c0d48ca3","file_size":700,"type":"application/octet-stream"}],"allow_singular_disclosure_at":"2014-12-17T23:52:50.375Z","allow_singular_disclosure_after":-190357393.06830075,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":92494,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Forgot to attach utility to calculate rsync compatible checksums.\n\nYou can validate these blocks by running:\n```\nmd5sum block1*.bin\n./rsync-checksum.py block1*.bin\nsha256sum block1*.bin\n```\n","markdown_message":"\u003cp\u003eForgot to attach utility to calculate rsync compatible checksums.\u003c/p\u003e\n\n\u003cp\u003eYou can validate these blocks by running:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emd5sum block1*.bin\n./rsync-checksum.py block1*.bin\nsha256sum block1*.bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2014-07-21T08:18:57.148Z","updated_at":"2014-07-21T08:18:57.148Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":13486,"filename":"rsync-checksum.py","type":"text/x-java","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/013/486/b70ff1fdd4a1634850a825fdf50309befa54defe/rsync-checksum.py?response-content-disposition=attachment%3B%20filename%3D%22rsync-checksum.py%22%3B%20filename%2A%3DUTF-8%27%27rsync-checksum.py\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXJYPBHFQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDu4%2FXsLbLXL64kN0gTqrVP%2B6YQy0aFrAsl8mmpM3A02gIhAMCTWiWTqJYsWHj2mR6ExJkLtM%2BAer5nJ1p6uJxIO04QKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgyKVAfpOTinzYsPSPkqkQMwQonGdI9p7CuN4bjSzjzCvtK%2FWWqz3YU8bTMgRxd1lvP8n%2BmQUW%2FPjx22yWgMPRHSApDfLhipeKY57Ywk6GpNSLkFsR4mWXVTUZ3fv%2BFpIecsA7FNlVffsWQFQL1hvyVhQXlfUb877oYsLHI7rvsdEl2oxxoNNBVppK7LLDUZ5Hszb5rUUqEs3JeInglYJgHEk0JqpQ59Rfq6iusCJYxnpCRnEk4ATJ3WPY0fYnF5%2BrjplwvF9jvrWA8ORsehD7OObtIyHgdE%2BeHQJDIwKM12S2Z3doq1C1frQwXKFiUX0Y9ZT6Dew0nqLavJd23CiqxMaeH6L8Dme7K0ES6LXhVDxzX5ZM48Lw97Faf%2BmTRwYynJlpTsMle9l6X4AISAwVe8d6Y3lMwIoUf05EQESF56DAXqAPPLzIguWqYse43Fu3rR0Kod4SRKI9ETYrP01wRz5xVgd2auQ8kejiA8344efyhQxkc3iBze4UukBtqzk604geJ6wyBSmoicpk9XqO8dvlhwhYEGoL4EWTozQffflzDAr6r%2FBTrqAb3yz5skpTmfiHh2mY%2FhHGiWzvhaSmhQ5tEgt4YCDEprvoxeYWkvlaxqdLXcMfRTr89qs4wuii5IpOn31c13IIFZzpa09Cs%2BExrDUX44ykH0g1zxLN374%2BwiIK3wd5v3201Stw8drFGqAKHIFBpAjuZIFF37RxSxGgAxlHskSrBBA1YzTX1SQV7r%2FcyXcvsAXO99Rr3E6FQFka96boq3PmqqeaoYxAs03IbehGcOPJ%2F3Ih7ebkxTDLG%2B75tCeMz1g%2BKNymUDx9%2B0KJfzKzXbCzi5TX8vNPGUyjZh2Y7SNRHBl7hFmGgXNktN5w%3D%3D\u0026X-Amz-Signature=c29bd3f3b968faca3a0770274ae50bc6a0338a6e3b79d2278cd5b439d5a9e348"}],"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":93248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The full-file checksum can be worked around by only changing block 0.  Note that the collision doesn't need to be at offset 0 of block 0 - any 64-byte aligned chunk with 256 bytes spare will work.\n\nI have made contact with the rsync maintainer (Wayne Davison).  He has taken a defensive stance to the vulnerability report.\n\nHe made the claim that if a full-file checksum fails it retries with a different block size - this is not a mitigating factor  - simply ensure that the collision is placed at an offset that is a multiple of both block sizes and pad it out to the larger block size with an identical suffix.\n\nI must admit that I cannot find the code that does this in the rsync source.","markdown_message":"\u003cp\u003eThe full-file checksum can be worked around by only changing block 0.  Note that the collision doesn\u0026#39;t need to be at offset 0 of block 0 - any 64-byte aligned chunk with 256 bytes spare will work.\u003c/p\u003e\n\n\u003cp\u003eI have made contact with the rsync maintainer (Wayne Davison).  He has taken a defensive stance to the vulnerability report.\u003c/p\u003e\n\n\u003cp\u003eHe made the claim that if a full-file checksum fails it retries with a different block size - this is not a mitigating factor  - simply ensure that the collision is placed at an offset that is a multiple of both block sizes and pad it out to the larger block size with an identical suffix.\u003c/p\u003e\n\n\u003cp\u003eI must admit that I cannot find the code that does this in the rsync source.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-22T01:09:31.403Z","updated_at":"2014-07-22T01:09:31.403Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":93280,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"lol bug in the rsync-checksum.py script, main() should be:\n```python\ndef main():\n        for fn in sys.argv[1:]:\n                data = list(map(ord, open(fn, \"rb\").read())) # fn, not sys.argv[1]\n                rollsum = faster_rollsum(0, 0, data)\n                print \"%08x %s\" % (rollsum, fn)\n```","markdown_message":"\u003cp\u003elol bug in the rsync-checksum.py script, main() should be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003efn\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e:]:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eord\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;rb\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e()))\u003c/span\u003e \u003cspan class=\"c1\"\u003e# fn, not sys.argv[1]\n\u003c/span\u003e                \u003cspan class=\"n\"\u003erollsum\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efaster_rollsum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"si\"\u003e%08\u003c/span\u003e\u003cspan class=\"s\"\u003ex \u003c/span\u003e\u003cspan class=\"si\"\u003e%\u003c/span\u003e\u003cspan class=\"s\"\u003es\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erollsum\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2014-07-22T03:46:44.917Z","updated_at":"2014-07-22T03:46:44.917Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":95884,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another minor note - the --checksum-seed parameter does not prevent these collisions, as it's appended when md5 is used.\n\nThis is a bug - with rsync protocol \u003c30 (using md4) it's prepended and would make finding a deliberate collision harder/less reliable.","markdown_message":"\u003cp\u003eAnother minor note - the --checksum-seed parameter does not prevent these collisions, as it\u0026#39;s appended when md5 is used.\u003c/p\u003e\n\n\u003cp\u003eThis is a bug - with rsync protocol \u0026lt;30 (using md4) it\u0026#39;s prepended and would make finding a deliberate collision harder/less reliable.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-25T05:50:53.218Z","updated_at":"2014-07-25T05:50:53.218Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":97982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reported (sans exploit details) to oss-security: http://www.openwall.com/lists/oss-security/2014/07/28/1\n\nAlso provided colliding blocks to RedHat security response team.\n\nI understand this may violate the rules of the bounty,  but would rather that it just got fixed.","markdown_message":"\u003cp\u003eReported (sans exploit details) to oss-security: \u003ca title=\"http://www.openwall.com/lists/oss-security/2014/07/28/1\" href=\"/redirect?url=http%3A%2F%2Fwww.openwall.com%2Flists%2Foss-security%2F2014%2F07%2F28%2F1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.openwall.com/lists/oss-security/2014/07/28/1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAlso provided colliding blocks to RedHat security response team.\u003c/p\u003e\n\n\u003cp\u003eI understand this may violate the rules of the bounty,  but would rather that it just got fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-30T01:15:45.253Z","updated_at":"2014-07-30T01:15:45.253Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mik - sorry for the delay here, catching up on a backlog. You haven't violated any rules of the bounty as we don't require or ask for early disclosure: you're even welcome to contact us after public disclosure has occurred.\n\nWith this class of vulnerability, we generally prefer to hold off on a bounty decision until an advisory or patch is available. Sounds like you've already taken all the right disclosure steps here. Have you had any process with the rsync or RedHat maintainers? Do you need any additional disclosure assistance? ","markdown_message":"\u003cp\u003e\u003ca href=\"/mik\"\u003e@mik\u003c/a\u003e - sorry for the delay here, catching up on a backlog. You haven\u0026#39;t violated any rules of the bounty as we don\u0026#39;t require or ask for early disclosure: you\u0026#39;re even welcome to contact us after public disclosure has occurred.\u003c/p\u003e\n\n\u003cp\u003eWith this class of vulnerability, we generally prefer to hold off on a bounty decision until an advisory or patch is available. Sounds like you\u0026#39;ve already taken all the right disclosure steps here. Have you had any process with the rsync or RedHat maintainers? Do you need any additional disclosure assistance? \u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-31T00:32:38.585Z","updated_at":"2014-07-31T00:32:38.585Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I haven't heard further from the rsync maintainers, although the librsync maintainer is making progress: https://github.com/librsync/librsync/issues/5\n\nRedHat have picked up my report, and they generally get things fixed fairly fast - I don't think any more assistance with disclosure is needed at this point.","markdown_message":"\u003cp\u003eI haven\u0026#39;t heard further from the rsync maintainers, although the librsync maintainer is making progress: \u003ca title=\"https://github.com/librsync/librsync/issues/5\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Flibrsync%2Flibrsync%2Fissues%2F5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/librsync/librsync/issues/5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRedHat have picked up my report, and they generally get things fixed fairly fast - I don\u0026#39;t think any more assistance with disclosure is needed at this point.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-31T01:04:36.917Z","updated_at":"2014-07-31T01:04:36.917Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":100715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additional discoveries:\n- RedHat confirmed that one of their products has reimplemented the rsync algorithm and is vulnerable.  They are working on a fix.\n- SFTP has an extension check-file-handle/copy-file-handle which can be used to do rsync-like file synchronization.  Hopefully nobody's putting md5 at the start of the list (eg. copying the ietf draft!)  See draft-ietf-secsh-filexfer-extensions-00 -- md5 and sha1 should be removed from future versions of the draft and implementations.  Not sure how to go about this.\n- You could almost certainly craft a file that wouldn't work with zsync, but that would be silly (not a security bug IMO)","markdown_message":"\u003cp\u003eAdditional discoveries:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eRedHat confirmed that one of their products has reimplemented the rsync algorithm and is vulnerable.  They are working on a fix.\u003c/li\u003e\n\u003cli\u003eSFTP has an extension check-file-handle/copy-file-handle which can be used to do rsync-like file synchronization.  Hopefully nobody\u0026#39;s putting md5 at the start of the list (eg. copying the ietf draft!)  See draft-ietf-secsh-filexfer-extensions-00 -- md5 and sha1 should be removed from future versions of the draft and implementations.  Not sure how to go about this.\u003c/li\u003e\n\u003cli\u003eYou could almost certainly craft a file that wouldn\u0026#39;t work with zsync, but that would be silly (not a security bug IMO)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2014-08-06T00:12:34.981Z","updated_at":"2014-08-06T00:12:34.981Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":100724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also crafted a birthday attack against librsync, allowing easy chosen-prefix/suffix attacks.  This will stamp a copy of the first instance of a collision in a file over future instances.\n\nAffects rdiff, duplicity and probably Dropbox.","markdown_message":"\u003cp\u003eAlso crafted a birthday attack against librsync, allowing easy chosen-prefix/suffix attacks.  This will stamp a copy of the first instance of a collision in a file over future instances.\u003c/p\u003e\n\n\u003cp\u003eAffects rdiff, duplicity and probably Dropbox.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-06T00:23:42.755Z","updated_at":"2014-08-06T00:23:42.755Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":128343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Dropbox have reported that they fixed it.\n\nI submitted an experimental patch to librsync: https://github.com/therealmik/librsync/tree/blake2\n\nI think the rsync (not librsync) exploit should go public soon.  People concerned about syncing files containing untrusted data (VM images, databases) should use the -W option as a workaround.","markdown_message":"\u003cp\u003eDropbox have reported that they fixed it.\u003c/p\u003e\n\n\u003cp\u003eI submitted an experimental patch to librsync: \u003ca title=\"https://github.com/therealmik/librsync/tree/blake2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftherealmik%2Flibrsync%2Ftree%2Fblake2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/therealmik/librsync/tree/blake2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI think the rsync (not librsync) exploit should go public soon.  People concerned about syncing files containing untrusted data (VM images, databases) should use the -W option as a workaround.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-17T06:35:57.068Z","updated_at":"2014-09-17T06:35:57.068Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":129573,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Exploit for rsync is now public: https://github.com/therealmik/rsync-collision\n\nWaiting a bit longer for librsync.","markdown_message":"\u003cp\u003eExploit for rsync is now public: \u003ca title=\"https://github.com/therealmik/rsync-collision\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftherealmik%2Frsync-collision\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/therealmik/rsync-collision\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWaiting a bit longer for librsync.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-19T01:24:51.164Z","updated_at":"2014-09-19T01:24:51.164Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":139281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"librsync birthday attack code:\nhttps://github.com/therealmik/librsync-collision\n\nThis is not md4-specific, but a generic birthday attack.  This gives more control over the prefixes (you just have to make them collide under the weak sum).  There's no whole-file checksum, so it just overwrites all future collisions with the first instance.","markdown_message":"\u003cp\u003elibrsync birthday attack code:\u003cbr\u003e\n\u003ca title=\"https://github.com/therealmik/librsync-collision\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftherealmik%2Flibrsync-collision\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/therealmik/librsync-collision\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is not md4-specific, but a generic birthday attack.  This gives more control over the prefixes (you just have to make them collide under the weak sum).  There\u0026#39;s no whole-file checksum, so it just overwrites all future collisions with the first instance.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-08T23:05:09.826Z","updated_at":"2014-10-08T23:05:09.826Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":158388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"librsync has nearly finished merging the blake2 branch:\nhttps://github.com/sourcefrog/librsync/compare/therealmik:blake2...blake2\n\nCVE CVE-2014-8242 was assigned for librsync (but not rsync - radio silence there still)","markdown_message":"\u003cp\u003elibrsync has nearly finished merging the blake2 branch:\u003cbr\u003e\n\u003ca title=\"https://github.com/sourcefrog/librsync/compare/therealmik:blake2...blake2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsourcefrog%2Flibrsync%2Fcompare%2Ftherealmik%3Ablake2...blake2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/sourcefrog/librsync/compare/therealmik:blake2...blake2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCVE CVE-2014-8242 was assigned for librsync (but not rsync - radio silence there still)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-11T01:28:56.397Z","updated_at":"2014-11-11T01:28:56.397Z","actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":158416,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @mik - nominating to the panel for a bounty.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/mik\"\u003e@mik\u003c/a\u003e - nominating to the panel for a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-11T02:04:38.302Z","updated_at":"2014-11-11T02:04:38.302Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161654,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T05:23:02.599Z","updated_at":"2014-11-17T05:23:02.599Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"mik","url":"/mik"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161655,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T05:23:41.165Z","updated_at":"2014-11-17T05:23:41.165Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"mik","url":"/mik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please request disclosure on this thread when you're comfortable. Holding off in case you'd prefer to wait for the remaining fixes to land.","markdown_message":"\u003cp\u003ePlease request disclosure on this thread when you\u0026#39;re comfortable. Holding off in case you\u0026#39;d prefer to wait for the remaining fixes to land.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T05:25:18.032Z","updated_at":"2014-11-17T05:25:18.032Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":162952,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I think everyone I've notified is comfortable with it being public","markdown_message":"\u003cp\u003eI think everyone I\u0026#39;ve notified is comfortable with it being public\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T23:52:49.892Z","updated_at":"2014-11-17T23:52:49.892Z","first_to_agree":true,"actor":{"username":"mik","cleared":false,"url":"/mik","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":162954,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T23:54:18.816Z","updated_at":"2014-11-17T23:54:18.816Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":162955,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T23:54:19.103Z","updated_at":"2014-11-17T23:54:19.103Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}