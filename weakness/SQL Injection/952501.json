{"id":952501,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTI1MDE=","url":"https://hackerone.com/reports/952501","title":"Solr Injection in `user_id` parameter at :/v2/leaderboard_v2.json","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-08-06T12:48:16.278Z","submitted_at":"2020-08-06T12:48:16.328Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zzzhacker13","url":"/zzzhacker13","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-10T07:50:05.409Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-08-07T06:59:19.892Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":127,"voters":["jensec","mvc","mashoud1122","base_64","kapkan","sameerphad72","newbipath12","n4sty","rahsec","zeroxyele","and 117 more..."],"severity":{"rating":"critical","score":9.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8864900,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T12:48:26.693Z","updated_at":"2020-08-06T12:48:26.693Z","additional_data":{},"actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8864926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T12:50:47.804Z","updated_at":"2020-08-06T12:50:47.804Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8864936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T12:52:00.598Z","updated_at":"2020-08-06T12:52:00.598Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8865339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T13:26:28.140Z","updated_at":"2020-08-06T13:26:28.140Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8865508,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T13:42:30.208Z","updated_at":"2020-08-06T13:42:30.208Z","additional_data":{},"actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8865512,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T13:42:41.811Z","updated_at":"2020-08-06T13:42:41.811Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8867930,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:21:14.309Z","updated_at":"2020-08-06T17:21:14.309Z","additional_data":{},"actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8867954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:23:01.269Z","updated_at":"2020-08-06T17:23:01.269Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868071,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:36:02.475Z","updated_at":"2020-08-06T17:36:02.475Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8868089,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:39:31.032Z","updated_at":"2020-08-06T17:39:31.032Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868116,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:42:59.410Z","updated_at":"2020-08-06T17:42:59.410Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"zzzhacker13","url":"/zzzhacker13"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-06T17:46:36.425Z","updated_at":"2020-08-06T17:46:36.425Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871716,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-07T06:41:54.609Z","updated_at":"2020-08-07T06:41:54.609Z","additional_data":{},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871801,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-07T06:58:27.686Z","updated_at":"2020-08-07T06:58:27.686Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zzzhacker13","url":"/zzzhacker13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871806,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-07T06:59:19.911Z","updated_at":"2020-08-07T06:59:19.911Z","first_to_agree":true,"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8890708,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-10T07:50:05.336Z","updated_at":"2020-08-10T07:50:05.336Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":23937,"category":"team","content":"@zzzhacker13 identified a Solr Injection on the `user_id` parameter at `:/v2/leaderboard_v2.json`. Our team analyzed internally and found that only `fq={injection}` was possible on the `Solr` endpoint, hence the `Solr injection` was of low impact since there was no way to escalate it to exfiltrate data, one could have just changed the filter query but it wasn't possible to update the fields or anything with these methods.\n\nAfter the report from @zzzhacker13, the team started analyzing the endpoint and discovered an `SQLi` (boolean based blind SQLi) on another parameter in the same codebase. We went ahead and fixed the issue. The `SQL injection`, however, was critical as per our internal metrics, hence we considered this to be critical because it was discovered as an indirect effect of this report and rewarded the max bounty as per our policies.\n\n|  Action | Timeline (6 Aug, 2020)  |\n|---|---|\n|  Reported |  18:18 IST  |  \n|  Investigation started | 18:23 IST   |  \n|  Report validated |   18:30 IST  |\n|  Initial contact |   18:56 IST  |\n|  SQLi identified (internally) |    19:08 IST  |\n|  Triaged |   19:12 IST   |\n| Patch PR released and merged |   19:40 IST  |\n|  Patch deployed |   22:00 IST  |\n|  Severity updated |   22:51 IST  |\n|  Rewarded |   23:12 IST  |\n\nThanks,\nZomato Security Team","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/zzzhacker13\"\u003e@zzzhacker13\u003c/a\u003e identified a Solr Injection on the \u003ccode\u003euser_id\u003c/code\u003e parameter at \u003ccode\u003e:/v2/leaderboard_v2.json\u003c/code\u003e. Our team analyzed internally and found that only \u003ccode\u003efq={injection}\u003c/code\u003e was possible on the \u003ccode\u003eSolr\u003c/code\u003e endpoint, hence the \u003ccode\u003eSolr injection\u003c/code\u003e was of low impact since there was no way to escalate it to exfiltrate data, one could have just changed the filter query but it wasn\u0026#39;t possible to update the fields or anything with these methods.\u003c/p\u003e\n\n\u003cp\u003eAfter the report from \u003ca href=\"/zzzhacker13\"\u003e@zzzhacker13\u003c/a\u003e, the team started analyzing the endpoint and discovered an \u003ccode\u003eSQLi\u003c/code\u003e (boolean based blind SQLi) on another parameter in the same codebase. We went ahead and fixed the issue. The \u003ccode\u003eSQL injection\u003c/code\u003e, however, was critical as per our internal metrics, hence we considered this to be critical because it was discovered as an indirect effect of this report and rewarded the max bounty as per our policies.\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eAction\u003c/th\u003e\n\u003cth\u003eTimeline (6 Aug, 2020)\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eReported\u003c/td\u003e\n\u003ctd\u003e18:18 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eInvestigation started\u003c/td\u003e\n\u003ctd\u003e18:23 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eReport validated\u003c/td\u003e\n\u003ctd\u003e18:30 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eInitial contact\u003c/td\u003e\n\u003ctd\u003e18:56 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSQLi identified (internally)\u003c/td\u003e\n\u003ctd\u003e19:08 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTriaged\u003c/td\u003e\n\u003ctd\u003e19:12 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePatch PR released and merged\u003c/td\u003e\n\u003ctd\u003e19:40 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePatch deployed\u003c/td\u003e\n\u003ctd\u003e22:00 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSeverity updated\u003c/td\u003e\n\u003ctd\u003e22:51 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRewarded\u003c/td\u003e\n\u003ctd\u003e23:12 IST\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nZomato Security Team\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}