{"id":508228,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDgyMjg=","url":"https://hackerone.com/reports/508228","title":"Seven DOM-Based XSS Vulnerabilities | Execution in Login Sequence","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-12T07:06:38.547Z","submitted_at":"2019-03-12T07:06:38.547Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stealthy","url":"/stealthy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-13T15:24:03.351Z","bug_reporter_agreed_on_going_public_at":"2019-04-28T22:45:40.252Z","team_member_agreed_on_going_public_at":"2019-05-13T15:24:03.188Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-05-28T22:45:40.320Z","allow_singular_disclosure_after":-50138782.82727277,"singular_disclosure_allowed":true,"vote_count":8,"voters":["ta8ahi","stealthy","brodie_codie","eveeez","bb00x","authprivate","openrobin","reading"],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":292,"asset_type":"OTHER","asset_identifier":"*.mail.ru / Mail.Ru - another project (except subdomains delegated to external entities)","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4306806,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T10:57:36.298Z","updated_at":"2019-03-12T10:57:36.298Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4306808,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T10:57:43.814Z","updated_at":"2019-03-12T10:57:43.814Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4306869,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T11:05:31.268Z","updated_at":"2019-03-12T11:05:31.268Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"e.mail.ru","new_scope":"*.mail.ru / Mail.Ru - another project (except subdomains delegated to external entities)","genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4306892,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T11:08:19.951Z","updated_at":"2019-03-12T11:08:19.951Z","additional_data":{},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4326602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T00:37:32.235Z","updated_at":"2019-03-15T00:37:32.235Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4328766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T08:54:02.703Z","updated_at":"2019-03-15T08:54:02.703Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4328771,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T08:54:32.164Z","updated_at":"2019-03-15T08:54:32.164Z","additional_data":{},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4328981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T09:32:21.909Z","updated_at":"2019-03-15T09:33:13.545Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4347140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-18T15:43:35.855Z","updated_at":"2019-03-18T15:43:35.855Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4393654,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T14:34:07.633Z","updated_at":"2019-03-26T14:34:07.633Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4395243,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T17:47:26.259Z","updated_at":"2019-03-26T17:47:26.259Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4395283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T17:54:38.332Z","updated_at":"2019-03-26T18:04:19.123Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4401473,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-27T10:26:00.717Z","updated_at":"2019-03-27T10:26:00.717Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4517296,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-09T09:11:24.285Z","updated_at":"2019-04-09T09:11:24.285Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stealthy","url":"/stealthy"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4519036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-09T14:34:43.383Z","updated_at":"2019-04-09T14:34:43.383Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4654505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-27T23:12:44.452Z","updated_at":"2019-04-27T23:12:44.452Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4657179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T18:50:12.129Z","updated_at":"2019-04-28T18:50:12.129Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4657792,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T22:45:40.274Z","updated_at":"2019-04-28T22:45:40.274Z","first_to_agree":true,"actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4828328,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-13T15:24:03.235Z","updated_at":"2019-05-13T15:24:03.235Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4828330,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-13T15:24:03.408Z","updated_at":"2019-05-13T15:24:03.408Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":15791,"category":"team","content":"DOM based XSS in tz.mail.ru\n\ntz.mail.ru belongs to extended scope","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eDOM based XSS in tz.mail.ru\u003c/p\u003e\n\n\u003cp\u003etz.mail.ru belongs to extended scope\u003c/p\u003e\n"},{"id":15929,"category":"researcher","content":"I was able to exploit DOM XSS at the following endpoints. The vulnerability was exploitable on forbidden pages and the root cause lies in jquery.\n```text\nhttps://tz.mail.ru/a/\nhttps://tz.mail.ru/a/js/\nhttps://tz.mail.ru/www/\nhttps://tz.mail.ru/www/js/\nhttps://tz.mail.ru/cgi-bin/\nhttps://tz.mail.ru/promo/js/\nhttps://tz.mail.ru/www/styles/\n```\nExploitation required a user to use the login functionality on the website. After submitting credentials, the javascript would execute. A sample link is below.\n\n    https://tz.mail.ru/promo/js/#\u003csvg onload=confirm(cookie)\u003e","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI was able to exploit DOM XSS at the following endpoints. The vulnerability was exploitable on forbidden pages and the root cause lies in jquery.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://tz.mail.ru/a/\nhttps://tz.mail.ru/a/js/\nhttps://tz.mail.ru/www/\nhttps://tz.mail.ru/www/js/\nhttps://tz.mail.ru/cgi-bin/\nhttps://tz.mail.ru/promo/js/\nhttps://tz.mail.ru/www/styles/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eExploitation required a user to use the login functionality on the website. After submitting credentials, the javascript would execute. A sample link is below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://tz.mail.ru/promo/js/#\u0026lt;svg onload=confirm(cookie)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}]}