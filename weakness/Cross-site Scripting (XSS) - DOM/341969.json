{"id":341969,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE5Njk=","url":"https://hackerone.com/reports/341969","title":"DOM XSS in edoverflow.com/tools/respond due to unsafe usage of the innerHTML property.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-04-23T11:01:15.691Z","submitted_at":"2018-04-23T11:01:15.691Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"karel_origin","url":"/karel_origin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24342,"url":"https://hackerone.com/ed","handle":"ed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ed","twitter_handle":"EdOverflow","website":"https://edoverflow.com","about":"This is a vulnerability disclosure program for all of my personal projects and code that I publish."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-23T11:28:11.422Z","bug_reporter_agreed_on_going_public_at":"2018-04-23T11:25:05.505Z","team_member_agreed_on_going_public_at":"2018-04-23T11:28:11.321Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThere's a DOM XSS vulnerability on [edoverflow.com](https://edoverflow.com/tools/respond/). This cannot be exploited without user-interaction so I had to make a clickjacking PoC to trick the user in triggering the payload her/himself.\n\n#Reproduction Steps\n1. Open the attached HTML document in FireFox.\n2. Drag Frog 1 to the other (two) frogs.\n3. Click on the \"Make friends!\" button.\n\nResult: \n{F289573}\n\n# Vulnerable JavaScript\n\n```\n\u003chtml\u003e\n\u003cscript\u003e\n/* ===========================================\n  Allow users to submit usernames and store \n  them in localStorage for future use.\n============================================*/\ndocument.getElementById(\"form\").addEventListener(\"submit\", function(){\n    var triager = document.getElementById(\"triager\").value;\n    var hacker = document.getElementById(\"hacker\").value;\n    console.log(hacker); // Why is this not executing?\n    document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n    document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n    //localStorage.setItem(\"triager\", triager);\n\n//var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n//document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retriev\ndocument.getElementById(\"remove\").addEventListener(\"click\", function(){\n    localStorage.removeItem(\"triager\");\n});\n\u003c/script\u003e\n\u003c/html\u003e\n```\n\n#Fix\n\n~~~diff\n- \u003cinput type=\"submit\" name=\"submit\" class=\"button\"\u003e\n+ \u003cinput type=\"button\" class=\"button\" id=\"submit\"\u003e\n~~~\n\n~~~diff\n       Allow users to submit usernames and store \n       them in localStorage for future use.\n     ============================================*/\n-    document.getElementById(\"form\").addEventListener(\"submit\", function(){\n-        var triager = document.getElementById(\"triager\").value;\n-        var hacker = document.getElementById(\"hacker\").value;\n+       elem = document.getElementsByTagName(\"pre\")[0].children[0];\n+\n+    document.getElementById(\"submit\").addEventListener(\"click\", function(){\n+        var trger = document.getElementById(\"triager\").value;\n+        var hckr = document.getElementById(\"hacker\").value;\n         console.log(hacker); // Why is this not executing?\n-        document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n-        document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n-        //localStorage.setItem(\"triager\", triager);\n+               elem.innerText = elem.innerText.replace(\"{{username}}\", trger).replace(\"{{triager}}\", hckr);\n+        localStorage.setItem(\"triager\", trger);\n     });\n \n-    //var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n-    //document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retrieve);\n+    if(localStorage.getItem(\"triager\") != null) {\n+       var trger = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n+       elem.innerText = elem.innerText.replace(\"{{triager}}\", trger);\n+    }\n \n     document.getElementById(\"remove\").addEventListener(\"click\", function(){\n         localStorage.removeItem(\"triager\");\n     });\n\n~~~\n\nRaw (JS attached)\n\n## Impact\n\nThere is not much that can be done because it looks like most pages don't require authentication, I also don't think that the owner of this website would fall for something like this. ;)\n\n\nThanks,\nKarel.\n\nThe hacker selected the **Cross-site Scripting (XSS) - DOM** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://edoverflow.com/tools/respond/\n\n**Verified**\nYes\n\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThere\u0026#39;s a DOM XSS vulnerability on \u003ca href=\"/redirect?url=https%3A%2F%2Fedoverflow.com%2Ftools%2Frespond%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eedoverflow.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This cannot be exploited without user-interaction so I had to make a clickjacking PoC to trick the user in triggering the payload her/himself.\u003c/p\u003e\n\n\u003ch1 id=\"reproduction-steps\"\u003eReproduction Steps\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen the attached HTML document in FireFox.\u003c/li\u003e\n\u003cli\u003eDrag Frog 1 to the other (two) frogs.\u003c/li\u003e\n\u003cli\u003eClick on the \u0026quot;Make friends!\u0026quot; button.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eResult: \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"screenshot.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/573/8a479c91cbb947ed405a2649ab4cbd49179c3b37/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053917Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=2a2e8adfbc843959915da49cc09f841c70575e883ca9a0b476c2e6c0426568c0\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/573/8a479c91cbb947ed405a2649ab4cbd49179c3b37/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053917Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=2a2e8adfbc843959915da49cc09f841c70575e883ca9a0b476c2e6c0426568c0\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"vulnerable-javascript\"\u003eVulnerable JavaScript\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/* ===========================================\n  Allow users to submit usernames and store \n  them in localStorage for future use.\n============================================*/\u003c/span\u003e\n\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eform\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003esubmit\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003etriager\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etriager\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehacker\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehacker\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehacker\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Why is this not executing?\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{{triager}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etriager\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{{username}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ehacker\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e//localStorage.setItem(\u0026quot;triager\u0026quot;, triager);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//var retrieve = localStorage.getItem(\u0026quot;triager\u0026quot;); // Why does this return \u0026quot;null\u0026quot;?\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//document.body.innerHTML = document.body.innerHTML.replace(\u0026#39;{{triager}}\u0026#39;, retriev\u003c/span\u003e\n\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eremove\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eremoveItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etriager\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"fix\"\u003eFix\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gd\"\u003e- \u0026lt;input type=\u0026quot;submit\u0026quot; name=\u0026quot;submit\u0026quot; class=\u0026quot;button\u0026quot;\u0026gt;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ \u0026lt;input type=\u0026quot;button\u0026quot; class=\u0026quot;button\u0026quot; id=\u0026quot;submit\u0026quot;\u0026gt;\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e       Allow users to submit usernames and store \n       them in localStorage for future use.\n     ============================================*/\n\u003cspan class=\"gd\"\u003e-    document.getElementById(\u0026quot;form\u0026quot;).addEventListener(\u0026quot;submit\u0026quot;, function(){\n-        var triager = document.getElementById(\u0026quot;triager\u0026quot;).value;\n-        var hacker = document.getElementById(\u0026quot;hacker\u0026quot;).value;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+       elem = document.getElementsByTagName(\u0026quot;pre\u0026quot;)[0].children[0];\n+\n+    document.getElementById(\u0026quot;submit\u0026quot;).addEventListener(\u0026quot;click\u0026quot;, function(){\n+        var trger = document.getElementById(\u0026quot;triager\u0026quot;).value;\n+        var hckr = document.getElementById(\u0026quot;hacker\u0026quot;).value;\n\u003c/span\u003e         console.log(hacker); // Why is this not executing?\n\u003cspan class=\"gd\"\u003e-        document.body.innerHTML = document.body.innerHTML.replace(\u0026#39;{{triager}}\u0026#39;, triager);\n-        document.body.innerHTML = document.body.innerHTML.replace(\u0026#39;{{username}}\u0026#39;, hacker);\n-        //localStorage.setItem(\u0026quot;triager\u0026quot;, triager);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+               elem.innerText = elem.innerText.replace(\u0026quot;{{username}}\u0026quot;, trger).replace(\u0026quot;{{triager}}\u0026quot;, hckr);\n+        localStorage.setItem(\u0026quot;triager\u0026quot;, trger);\n\u003c/span\u003e     });\n\n-    //var retrieve = localStorage.getItem(\u0026quot;triager\u0026quot;); // Why does this return \u0026quot;null\u0026quot;?\n\u003cspan class=\"gd\"\u003e-    //document.body.innerHTML = document.body.innerHTML.replace(\u0026#39;{{triager}}\u0026#39;, retrieve);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    if(localStorage.getItem(\u0026quot;triager\u0026quot;) != null) {\n+       var trger = localStorage.getItem(\u0026quot;triager\u0026quot;); // Why does this return \u0026quot;null\u0026quot;?\n+       elem.innerText = elem.innerText.replace(\u0026quot;{{triager}}\u0026quot;, trger);\n+    }\n\u003c/span\u003e\n     document.getElementById(\u0026quot;remove\u0026quot;).addEventListener(\u0026quot;click\u0026quot;, function(){\n         localStorage.removeItem(\u0026quot;triager\u0026quot;);\n     });\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRaw (JS attached)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThere is not much that can be done because it looks like most pages don\u0026#39;t require authentication, I also don\u0026#39;t think that the owner of this website would fall for something like this. ;)\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKarel.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-site Scripting (XSS) - DOM\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://edoverflow.com/tools/respond/\" href=\"/redirect?url=https%3A%2F%2Fedoverflow.com%2Ftools%2Frespond%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://edoverflow.com/tools/respond/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":289572,"file_name":"fix.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/572/b7a4940a2bba2e2f36116c8b531a4aeba81e7d26/fix.js?response-content-disposition=attachment%3B%20filename%3D%22fix.js%22%3B%20filename%2A%3DUTF-8%27%27fix.js\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053917Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=fc5d1d1bd105f2a0bb0d72dfcd613db51bc3de2b863958741d68b620c1ed4bc9","file_size":950,"type":"text/plain"},{"id":289573,"file_name":"screenshot.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/573/8a479c91cbb947ed405a2649ab4cbd49179c3b37/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053917Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=2a2e8adfbc843959915da49cc09f841c70575e883ca9a0b476c2e6c0426568c0","file_size":139116,"type":"image/png"},{"id":289579,"file_name":"Clickjacking-XSS.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/579/eb14ac71e4fc0411158af50c3a7810682b938944/Clickjacking-XSS.html?response-content-disposition=attachment%3B%20filename%3D%22Clickjacking-XSS.html%22%3B%20filename%2A%3DUTF-8%27%27Clickjacking-XSS.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053917Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=bd64143a51350fccc6e423e28de6bdde27d8498bbb3e0b79baf76a048add0cbc","file_size":1769,"type":"text/html"}],"allow_singular_disclosure_at":"2018-05-23T11:25:05.634Z","allow_singular_disclosure_after":-82145652.17245612,"singular_disclosure_allowed":true,"vote_count":27,"voters":["jokebookservice1","sp1d3rs","filedescriptor","kapytein","europa","secator","muon4","bl4de","sameerphad72","emitrani","and 17 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":3524,"asset_type":"URL","asset_identifier":"https://edoverflow.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2653059,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is a valid report! Fantastic work, @karel_origin. I will apply the patch and notify you when everything has been resolved properly.\n\n\\- Ed","markdown_message":"\u003cp\u003eThis is a valid report! Fantastic work, \u003ca href=\"/karel_origin\"\u003e@karel_origin\u003c/a\u003e. I will apply the patch and notify you when everything has been resolved properly.\u003c/p\u003e\n\n\u003cp\u003e- Ed\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T11:04:43.222Z","updated_at":"2018-04-23T11:04:43.222Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653067,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I have pushed a fix to production. Would you mind taking a quick look and making sure it has been fixed properly?","markdown_message":"\u003cp\u003eI have pushed a fix to production. Would you mind taking a quick look and making sure it has been fixed properly?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T11:10:47.795Z","updated_at":"2018-04-23T11:10:47.795Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"karel_origin","url":"/karel_origin"},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653094,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @edoverflow,\n\nIt looks like the fix is working as planned.\n\nThank you for the quick fix and response!\nKarel.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/edoverflow\"\u003e@edoverflow\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIt looks like the fix is working as planned.\u003c/p\u003e\n\n\u003cp\u003eThank you for the quick fix and response!\u003cbr\u003e\nKarel.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T11:25:05.560Z","updated_at":"2018-04-23T11:25:05.560Z","first_to_agree":true,"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2653099,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you so much for your help, @karel_origin. It is always a pleasure to work with you. I hope other programs reading this will see how much effort you put into your reports and fight to get you to participate on their programs. :P\n\nOn a side note, that was the best proof of concept I have ever received on this program. 10/10 would hack again with you.","markdown_message":"\u003cp\u003eThank you so much for your help, \u003ca href=\"/karel_origin\"\u003e@karel_origin\u003c/a\u003e. It is always a pleasure to work with you. I hope other programs reading this will see how much effort you put into your reports and fight to get you to participate on their programs. :P\u003c/p\u003e\n\n\u003cp\u003eOn a side note, that was the best proof of concept I have ever received on this program. 10/10 would hack again with you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T11:28:11.355Z","updated_at":"2018-04-23T11:28:11.355Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653100,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-23T11:28:11.456Z","updated_at":"2018-04-23T11:28:11.456Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2659488,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"🎁","markdown_message":"\u003cp\u003e🎁\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T11:34:27.892Z","updated_at":"2018-04-24T11:34:27.892Z","actor":{"url":"/ed","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ed"}},"reporter":{"username":"karel_origin","url":"/karel_origin"},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}