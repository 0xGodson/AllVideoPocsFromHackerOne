{"id":363845,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjM4NDU=","url":"https://hackerone.com/reports/363845","title":"Cross site scripting (content-sniffing)","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2018-06-10T01:18:04.447Z","submitted_at":"2018-06-10T01:18:04.447Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"said778","url":"/said778","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-10T09:25:13.334Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-06-10T05:43:15.765Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This type of XSS can only be triggered on (and affects) content sniffing browsers.\n\nThis script is possibly vulnerable to Cross Site Scripting (XSS) attacks.\n\nThis vulnerability affects /sign-up\nURL encoded POST input sign-in.currency was set to USD\u003cWDILR9\u003eG8OAI[!+!]\u003c/WDILR9\u003e\nThe input is reflected inside a text element\n\nput this URL https://liberapay.com/about/me/edit\u0026sign-in.currency=USD%3CWDILR9%3EG8OAI%5b%21%2b%21%5d%3C/WDILR9%3E\n\nnow put \n\ncsrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I \u0026 form.repost=false\u0026sign-in.back-to=/about/me/edit \u0026 sign-in.currency=USD\u003cWDILR9\u003eG8OAI%5b%21%2b%21%5d\u003c/WDILR9\u003e \u0026 sign-in.email=sample%40email.tst\n\nyou will see the email sent \nand that is allowing the attacker to access any cookies or session tokens retained by the browser. \n\nResponse\n\nHTTP/1.1 400 Bad Request\nContent-Type: application/json; charset=UTF-8\nContent-Length: 196\nConnection: keep-alive\nX-Xss-Protection: 1; mode=block\nContent-Security-Policy: default-src 'self' liberapay.com;connect-src 'self' *.liberapay.org *.mangopay.com *.payline.com;form-action 'self';img-src * blob: data:;object-src 'none';report-uri https://liberapay.report-uri.com/r/d/csp/enforce;upgrade-insecure-requests;\nCache-Control: no-cache\nX-Frame-Options: SAMEORIGIN\nReferrer-Policy: strict-origin-when-cross-origin\nSet-Cookie: csrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I; Domain=.liberapay.com; expires=Sun, 17 Jun 2018 00:42:27 GMT; Path=/; SameSite=lax; secure\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Content-Type-Options: nosniff\nExpect-CT: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\nServer: cloudflare\nCF-RAY: 4287cc50ea852744-FRA\n\n## Impact\n\nCross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user. Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser.","vulnerability_information_html":"\u003cp\u003eThis type of XSS can only be triggered on (and affects) content sniffing browsers.\u003c/p\u003e\n\n\u003cp\u003eThis script is possibly vulnerable to Cross Site Scripting (XSS) attacks.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability affects /sign-up\u003cbr\u003e\nURL encoded POST input sign-in.currency was set to USD\u0026lt;WDILR9\u0026gt;G8OAI[!+!]\u0026lt;/WDILR9\u0026gt;\u003cbr\u003e\nThe input is reflected inside a text element\u003c/p\u003e\n\n\u003cp\u003eput this URL \u003ca title=\"https://liberapay.com/about/me/edit\u0026amp;sign-in.currency=USD%3CWDILR9%3EG8OAI%5b%21%2b%21%5d%3C/WDILR9%3E\" href=\"/redirect?url=https%3A%2F%2Fliberapay.com%2Fabout%2Fme%2Fedit%26sign-in.currency%3DUSD%253CWDILR9%253EG8OAI%255b%2521%252b%2521%255d%253C%2FWDILR9%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://liberapay.com/about/me/edit\u0026amp;sign-in.currency=USD%3CWDILR9%3EG8OAI%5b%21%2b%21%5d%3C/WDILR9%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003enow put \u003c/p\u003e\n\n\u003cp\u003ecsrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I \u0026amp; form.repost=false\u0026amp;sign-in.back-to=/about/me/edit \u0026amp; sign-in.currency=USD\u0026lt;WDILR9\u0026gt;G8OAI%5b%21%2b%21%5d\u0026lt;/WDILR9\u0026gt; \u0026amp; sign-in.email=sample%40email.tst\u003c/p\u003e\n\n\u003cp\u003eyou will see the email sent \u003cbr\u003e\nand that is allowing the attacker to access any cookies or session tokens retained by the browser. \u003c/p\u003e\n\n\u003cp\u003eResponse\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 400 Bad Request\u003cbr\u003e\nContent-Type: application/json; charset=UTF-8\u003cbr\u003e\nContent-Length: 196\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nX-Xss-Protection: 1; mode=block\u003cbr\u003e\nContent-Security-Policy: default-src \u0026#39;self\u0026#39; liberapay.com;connect-src \u0026#39;self\u0026#39; *.liberapay.org *.mangopay.com *.payline.com;form-action \u0026#39;self\u0026#39;;img-src * blob: data:;object-src \u0026#39;none\u0026#39;;report-uri \u003ca title=\"https://liberapay.report-uri.com/r/d/csp/enforce;upgrade-insecure-requests\" href=\"/redirect?url=https%3A%2F%2Fliberapay.report-uri.com%2Fr%2Fd%2Fcsp%2Fenforce%3Bupgrade-insecure-requests\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://liberapay.report-uri.com/r/d/csp/enforce;upgrade-insecure-requests\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003cbr\u003e\nCache-Control: no-cache\u003cbr\u003e\nX-Frame-Options: SAMEORIGIN\u003cbr\u003e\nReferrer-Policy: strict-origin-when-cross-origin\u003cbr\u003e\nSet-Cookie: csrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I; Domain=.liberapay.com; expires=Sun, 17 Jun 2018 00:42:27 GMT; Path=/; SameSite=lax; secure\u003cbr\u003e\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\u003cbr\u003e\nX-Content-Type-Options: nosniff\u003cbr\u003e\nExpect-CT: max-age=604800, report-uri=\u0026quot;\u003ca title=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\" href=\"/redirect?url=https%3A%2F%2Freport-uri.cloudflare.com%2Fcdn-cgi%2Fbeacon%2Fexpect-ct\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;\u003cbr\u003e\nServer: cloudflare\u003cbr\u003e\nCF-RAY: 4287cc50ea852744-FRA\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user. Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser.\u003c/p\u003e\n","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["praskhar_pk","said778"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2862893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! We have received your report and a security analyst will respond shortly.","markdown_message":"\u003cp\u003eThank you for your submission! We have received your report and a security analyst will respond shortly.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-06-10T03:19:55.951Z","updated_at":"2018-06-10T03:19:55.951Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2862967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"your welcome ... take your time ","markdown_message":"\u003cp\u003eyour welcome ... take your time \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T04:54:41.217Z","updated_at":"2018-06-10T04:54:41.217Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2862981,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @said778,\n\nThere are a few things I noticed that I'd like to point out. Your XSS payload doesn't actually demonstrate anything even if we were vulnerable, this endpoint is protected with CSRF tokens and the `Content-Type` (`application/json`) is correctly set. Not to mention that we are indeed using the `X-Content-Type-Options: nosniff` header as seen in your report.\n\nWe appreciate your time and effort,\nKarel.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/said778\"\u003e@said778\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThere are a few things I noticed that I\u0026#39;d like to point out. Your XSS payload doesn\u0026#39;t actually demonstrate anything even if we were vulnerable, this endpoint is protected with CSRF tokens and the \u003ccode\u003eContent-Type\u003c/code\u003e (\u003ccode\u003eapplication/json\u003c/code\u003e) is correctly set. Not to mention that we are indeed using the \u003ccode\u003eX-Content-Type-Options: nosniff\u003c/code\u003e header as seen in your report.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your time and effort,\u003cbr\u003e\nKarel.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T05:42:45.454Z","updated_at":"2018-06-10T05:42:45.454Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2862984,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-10T05:43:07.820Z","updated_at":"2018-06-10T05:43:07.820Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":165730,"new_severity_id":165752},"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2862985,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-10T05:43:15.804Z","updated_at":"2018-06-10T05:43:15.804Z","first_to_agree":true,"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2863047,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi \nthis is not exactly the (XSS) \nbut this issue is classified actually under the xss .\nthis issue is content-sniffing and it is there . \nand when you try that you will see how we can send any email and that is enable us to sniffing . \nso the browser must not accept that and  An attacker can trick older browsers into guessing the wrong Content-Type .\n\nplease look at that again and check ,\nthank you for your time .","markdown_message":"\u003cp\u003ehi \u003cbr\u003e\nthis is not exactly the (XSS) \u003cbr\u003e\nbut this issue is classified actually under the xss .\u003cbr\u003e\nthis issue is content-sniffing and it is there . \u003cbr\u003e\nand when you try that you will see how we can send any email and that is enable us to sniffing . \u003cbr\u003e\nso the browser must not accept that and  An attacker can trick older browsers into guessing the wrong Content-Type .\u003c/p\u003e\n\n\u003cp\u003eplease look at that again and check ,\u003cbr\u003e\nthank you for your time .\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T06:51:06.791Z","updated_at":"2018-06-10T06:51:06.791Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2863093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @said778,\n\n\u003e Content sniffing, also known as media type sniffing or MIME sniffing, is the practice of inspecting the content of a byte stream to attempt to deduce the file format of the data within it. Content sniffing is generally used to compensate for a lack of accurate metadata that would otherwise be required to enable the file to be interpreted correctly.\n\nSource: [wikipedia](https://en.wikipedia.org/wiki/Content_sniffing)\n\nYou can see here that Content sniffing only occurs when there's no content-type given in the response, the response does actually return the correct content-type which is `application/json`. We also have the `X-Content-Type-Options` set to `nosniff` which means that this feature gets disabled.\n\nWe would appreciate it if you could disclose the report.\n\nThanks,\nKarel. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/said778\"\u003e@said778\u003c/a\u003e,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eContent sniffing, also known as media type sniffing or MIME sniffing, is the practice of inspecting the content of a byte stream to attempt to deduce the file format of the data within it. Content sniffing is generally used to compensate for a lack of accurate metadata that would otherwise be required to enable the file to be interpreted correctly.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSource: \u003ca href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FContent_sniffing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewikipedia\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou can see here that Content sniffing only occurs when there\u0026#39;s no content-type given in the response, the response does actually return the correct content-type which is \u003ccode\u003eapplication/json\u003c/code\u003e. We also have the \u003ccode\u003eX-Content-Type-Options\u003c/code\u003e set to \u003ccode\u003enosniff\u003c/code\u003e which means that this feature gets disabled.\u003c/p\u003e\n\n\u003cp\u003eWe would appreciate it if you could disclose the report.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKarel. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T07:28:27.070Z","updated_at":"2018-06-10T07:30:22.310Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2863198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"okay ... thanks","markdown_message":"\u003cp\u003eokay ... thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T09:05:52.935Z","updated_at":"2018-06-10T09:05:52.935Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2863208,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-10T09:25:13.222Z","updated_at":"2018-06-10T09:25:13.222Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}