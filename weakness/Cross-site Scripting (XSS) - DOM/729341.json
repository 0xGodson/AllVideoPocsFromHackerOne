{"id":729341,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MjkzNDE=","url":"https://hackerone.com/reports/729341","title":"Double linking cause XSS (but blokeced by CSP in gitlab.com)","state":"Closed","substate":"not-applicable","severity_rating":"low","readable_substate":"N/A","created_at":"2019-11-04T21:17:49.157Z","submitted_at":"2019-11-04T21:17:49.157Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-20T12:40:04.087Z","bug_reporter_agreed_on_going_public_at":"2019-12-17T22:24:24.009Z","team_member_agreed_on_going_public_at":"2020-01-20T12:40:03.999Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nURL display on Gitlab.com is currently broken.\n\nThere is a risk of XSS due to double conversion of URLs into links.\nHowever, 12.5 incorporating the fix has not yet been released and is blocked by CSP at gitlab.com.\n\n\n### Steps to reproduce\n\n1. Login to gitlab.com\n2. Create new project\n3. Create a file with the following contents as `Gemfile`\n4. Previe the  `Gemfile`\n5. You can see in the developer tool that javascript execution has been blocked by CSP.\n\n```ruby\ngem '\u003cimg/src/onerror=alert(location)\u003e', '2'\n```\n\n\n### Examples\n\nThe above code is converted to HTML as shown below and connected to XSS via the img tag.\n\n```html\n\u003cspan class=\"s1\"\u003e'\u003ca href=\"\u003ca href=\" https:=\"\" rubygems.org=\"\" gems=\"\" \"=\"\"\u003ehttps://rubygems.org/gems/\u003c/a\u003e\u003cimg src=\"\" onerror=\"alert(location)\"\u003e\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"\u0026gt;\u0026lt;img/src/onerror=alert(location)\u0026gt;'\u003c/span\u003e\n```\n\n### What is the current *bug* behavior?\n\nThere is a problem with this MR (https://gitlab.com/gitlab-org/gitlab/merge_requests/18305/diffs) that was captured by Milestone 12.5.\n\nThe issue is here. https://gitlab.com/gitlab-org/gitlab/issues/35120\n\n### What is the expected *correct* behavior?\n\nIt is expected that there will be no processing that links the URL in the screen twice.\nProbably this MR. https://gitlab.com/gitlab-org/gitlab/merge_requests/19464\n\n\n### Relevant logs and/or screenshots\n\n{F625771}\n\nscreenshots https://gitlab.com/gitlab-org/gitlab/blob/master/Gemfile\n\n### Output of checks\n\nThis bug only occurs on GitLab.com .\n\n#### Results of GitLab environment info\n\nThe 12.5 version has not yet been released and will not occur in other environments.\n\n## Impact\n\nSince gitlab.com is blocked by CSP, there is almost no risk as XSS.\nThere are dangers of HTML injection and CSS injection.\n\nIf this issue is not fixed and a 12.5 release is made, XSS can occur in Gitlab CE / EE.","vulnerability_information_html":"\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eURL display on Gitlab.com is currently broken.\u003c/p\u003e\n\n\u003cp\u003eThere is a risk of XSS due to double conversion of URLs into links.\u003cbr\u003e\nHowever, 12.5 incorporating the fix has not yet been released and is blocked by CSP at gitlab.com.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to gitlab.com\u003c/li\u003e\n\u003cli\u003eCreate new project\u003c/li\u003e\n\u003cli\u003eCreate a file with the following contents as \u003ccode\u003eGemfile\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003ePrevie the  \u003ccode\u003eGemfile\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eYou can see in the developer tool that javascript execution has been blocked by CSP.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;img/src/onerror=alert(location)\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;2\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"examples\"\u003eExamples\u003c/h3\u003e\n\n\u003cp\u003eThe above code is converted to HTML as shown below and connected to XSS via the img tag.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;span\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;s1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\u0026#39;\u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;a href=\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehttps:=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003erubygems.org=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003egems=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026quot;=\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ehttps://rubygems.org/gems/\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u0026lt;img\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonerror=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;alert(location)\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\u0026quot; rel=\u0026quot;nofollow noreferrer noopener\u0026quot; target=\u0026quot;_blank\u0026quot;\u003cspan class=\"ni\"\u003e\u0026amp;gt;\u0026amp;lt;\u003c/span\u003eimg/src/onerror=alert(location)\u003cspan class=\"ni\"\u003e\u0026amp;gt;\u003c/span\u003e\u0026#39;\u003cspan class=\"nt\"\u003e\u0026lt;/span\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"what-is-the-current-bug-behavior\"\u003eWhat is the current \u003cem\u003ebug\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eThere is a problem with this MR (\u003ca title=\"https://gitlab.com/gitlab-org/gitlab/merge_requests/18305/diffs\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fmerge_requests%2F18305%2Fdiffs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/merge_requests/18305/diffs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) that was captured by Milestone 12.5.\u003c/p\u003e\n\n\u003cp\u003eThe issue is here. \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/issues/35120\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fissues%2F35120\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/issues/35120\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eIt is expected that there will be no processing that links the URL in the screen twice.\u003cbr\u003e\nProbably this MR. \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/merge_requests/19464\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fmerge_requests%2F19464\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/merge_requests/19464\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"relevant-logs-and-or-screenshots\"\u003eRelevant logs and/or screenshots\u003c/h3\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"__________2019-11-05_6.10.27.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WVahpHZKginPoxYyFGZEGhLY?response-content-disposition=attachment%3B%20filename%3D%22__________2019-11-05_6.10.27.png%22%3B%20filename%2A%3DUTF-8%27%27__________2019-11-05_6.10.27.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064250Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026amp;X-Amz-Signature=fc4b12f89386c7fa1c1322b367df050ab09cbb291358d8cee7f917ece4930045\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WVahpHZKginPoxYyFGZEGhLY?response-content-disposition=attachment%3B%20filename%3D%22__________2019-11-05_6.10.27.png%22%3B%20filename%2A%3DUTF-8%27%27__________2019-11-05_6.10.27.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064250Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026amp;X-Amz-Signature=fc4b12f89386c7fa1c1322b367df050ab09cbb291358d8cee7f917ece4930045\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003escreenshots \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/blob/master/Gemfile\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fblob%2Fmaster%2FGemfile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/blob/master/Gemfile\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"output-of-checks\"\u003eOutput of checks\u003c/h3\u003e\n\n\u003cp\u003eThis bug only occurs on GitLab.com .\u003c/p\u003e\n\n\u003ch4 id=\"results-of-gitlab-environment-info\"\u003eResults of GitLab environment info\u003c/h4\u003e\n\n\u003cp\u003eThe 12.5 version has not yet been released and will not occur in other environments.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince gitlab.com is blocked by CSP, there is almost no risk as XSS.\u003cbr\u003e\nThere are dangers of HTML injection and CSS injection.\u003c/p\u003e\n\n\u003cp\u003eIf this issue is not fixed and a 12.5 release is made, XSS can occur in Gitlab CE / EE.\u003c/p\u003e\n","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":625771,"file_name":"__________2019-11-05_6.10.27.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WVahpHZKginPoxYyFGZEGhLY?response-content-disposition=attachment%3B%20filename%3D%22__________2019-11-05_6.10.27.png%22%3B%20filename%2A%3DUTF-8%27%27__________2019-11-05_6.10.27.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064250Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=fc4b12f89386c7fa1c1322b367df050ab09cbb291358d8cee7f917ece4930045","file_size":575319,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["0xelkomy","mygf","dark_warlord14","exception","zimmer75","root_hunterho"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6216162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ooooooo_q,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 14 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 14 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-11-04T22:10:32.669Z","updated_at":"2019-11-04T22:10:32.669Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6225000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I noticed that MR diff (https://gitlab.com/gitlab-org/gitlab/merge_requests/19464/diffs) is insufficient as a vulnerability countermeasure.\n\n```javascript\nblobLinkRegex = /(?\u003c!\u003ca href=\")https?:\\/\\/[^\"\u003c\u003e\\\\^`{|}\\s]+/g;\n\nblobLinkRegex.test('\u003ca href=\"https://aa')\n\u003e false\n\nblobLinkRegex.test('\u003ca href=\"https://aahttps://aaa\"')\n\u003e true\n```\n\nThe following code may be able to attack\n\n```ruby\ngem 'rails/https://example.com/\u003cimg/src/onerror=alert(location)\u003e', '5.2.3'\n```","markdown_message":"\u003cp\u003eI noticed that MR diff (\u003ca title=\"https://gitlab.com/gitlab-org/gitlab/merge_requests/19464/diffs\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fmerge_requests%2F19464%2Fdiffs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/merge_requests/19464/diffs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) is insufficient as a vulnerability countermeasure.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eblobLinkRegex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e(?\u0026lt;\u003c/span\u003e\u003cspan class=\"sr\"\u003e!\u0026lt;a href=\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e)\u003c/span\u003e\u003cspan class=\"sr\"\u003ehttps\u003c/span\u003e\u003cspan class=\"se\"\u003e?\u003c/span\u003e\u003cspan class=\"sr\"\u003e:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/[^\u003c/span\u003e\u003cspan class=\"sr\"\u003e\u0026quot;\u0026lt;\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"sr\"\u003e^`{|}\u003c/span\u003e\u003cspan class=\"se\"\u003e\\s]\u003c/span\u003e\u003cspan class=\"sr\"\u003e+/g\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eblobLinkRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;a href=\u0026quot;https://aa\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eblobLinkRegex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;a href=\u0026quot;https://aahttps://aaa\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following code may be able to attack\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;rails/https://example.com/\u0026lt;img/src/onerror=alert(location)\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;5.2.3\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-11-05T21:57:34.260Z","updated_at":"2019-11-05T21:57:34.260Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6331777,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @ooooooo_q,\n\nThank you for this report.\nI have been trying to reproduce this issue with the latest nightly Docker image (12.5.0-pre e2a1b56cdc5), but when  previewing the Gemfile the XSS doesn't trigger nor creates CSP alerts in Firefox 70.0.1 web Console.\n\nCould you try reproducing it on your side with the `gitlab/gitlab-ee:nightly` Docker omnibus image ?\n\nBest regards,\nGitLab Security Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report.\u003cbr\u003e\nI have been trying to reproduce this issue with the latest nightly Docker image (12.5.0-pre e2a1b56cdc5), but when  previewing the Gemfile the XSS doesn\u0026#39;t trigger nor creates CSP alerts in Firefox 70.0.1 web Console.\u003c/p\u003e\n\n\u003cp\u003eCould you try reproducing it on your side with the \u003ccode\u003egitlab/gitlab-ee:nightly\u003c/code\u003e Docker omnibus image ?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-18T09:41:33.079Z","updated_at":"2019-11-18T09:41:33.079Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6332565,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @jmatos_bgtvf,\n\nThe problem commits have been reverted, so there seems to be no problem now.\nhttps://gitlab.com/gitlab-org/gitlab/merge_requests/19887\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jmatos_bgtvf\"\u003e@jmatos_bgtvf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe problem commits have been reverted, so there seems to be no problem now.\u003cbr\u003e\n\u003ca title=\"https://gitlab.com/gitlab-org/gitlab/merge_requests/19887\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fmerge_requests%2F19887\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/merge_requests/19887\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-18T11:01:46.963Z","updated_at":"2019-11-18T11:01:46.963Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6332729,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the quick and detailed feedback.\nWouldn't you mind self-closing the report and opening it again if this issue finally makes its way through ?\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eThank you very much for the quick and detailed feedback.\u003cbr\u003e\nWouldn\u0026#39;t you mind self-closing the report and opening it again if this issue finally makes its way through ?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-18T11:25:59.305Z","updated_at":"2019-11-18T11:25:59.305Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6332767,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-18T11:38:21.339Z","updated_at":"2019-11-18T11:38:21.339Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6574285,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-17T22:24:24.023Z","updated_at":"2019-12-17T22:24:24.023Z","first_to_agree":true,"actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6816792,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-20T12:40:04.016Z","updated_at":"2020-01-20T12:40:04.016Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6816793,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-20T12:40:04.104Z","updated_at":"2020-01-20T12:40:04.104Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}