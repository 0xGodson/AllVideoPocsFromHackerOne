{"id":76713,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjcxMw==","url":"https://hackerone.com/reports/76713","title":"XSS - Gallery Search Listing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-19T09:28:07.837Z","submitted_at":"2015-07-19T09:28:07.837Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugs3ra","url":"/bugs3ra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":695,"url":"https://hackerone.com/zaption","handle":"zaption","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/695/b8975893f4c9838f55b4f656bc93528666fa68ba_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/695/b8975893f4c9838f55b4f656bc93528666fa68ba_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zaption","twitter_handle":"zaption","website":"http://www.zaption.com","about":"Interactive video for learning."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-12T17:13:16.483Z","bug_reporter_agreed_on_going_public_at":"2015-07-20T16:17:26.044Z","team_member_agreed_on_going_public_at":"2015-08-12T17:13:16.380Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"HI.\r\nIf you upload video having title with XSS payload. and search for the video, the dropdown listing will execute the payload.\r\n\r\nhttps://www.zaption.com/gallery/search?q=%3E%3Cimg\r\n\r\nI need not to upload the payload, I utilized already uploaded videos.\r\n\r\n\r\nYou can also execute the payload by just start typing into the search box with\r\n\"\u003e\u003cimg\r\n\r\nThat's it, XSS will be executed.","vulnerability_information_html":"\u003cp\u003eHI.\u003cbr\u003e\nIf you upload video having title with XSS payload. and search for the video, the dropdown listing will execute the payload.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.zaption.com/gallery/search?q=%3E%3Cimg\" href=\"/redirect?url=https%3A%2F%2Fwww.zaption.com%2Fgallery%2Fsearch%3Fq%3D%253E%253Cimg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zaption.com/gallery/search?q=%3E%3Cimg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI need not to upload the payload, I utilized already uploaded videos.\u003c/p\u003e\n\n\u003cp\u003eYou can also execute the payload by just start typing into the search box with\u003cbr\u003e\n\u0026quot;\u0026gt;\u0026lt;img\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s it, XSS will be executed.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-08-19T16:17:26.134Z","allow_singular_disclosure_after":-169223474.02179232,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":515921,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@bugs3ra thanks for the report. This does appear to be an issue and we'll investigate further to find an appropriate resolution.","markdown_message":"\u003cp\u003e\u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e thanks for the report. This does appear to be an issue and we\u0026#39;ll investigate further to find an appropriate resolution.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-19T09:53:35.766Z","updated_at":"2015-07-19T09:53:35.766Z","actor":{"username":"cstigler","cleared":false,"url":"/cstigler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/092/bb7e2e9669c2b2acf7be03a3632b7fd3e906932a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":515940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FOR POC check out this video\n\nSorry its the Tour Title form where this XSS payload is stored.\nSo you need to patch this out at two places\n1. The search suggestions for gallery search box\n2. Gallery search result","markdown_message":"\u003cp\u003eFOR POC check out this video\u003c/p\u003e\n\n\u003cp\u003eSorry its the Tour Title form where this XSS payload is stored.\u003cbr\u003e\nSo you need to patch this out at two places\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe search suggestions for gallery search box\u003c/li\u003e\n\u003cli\u003eGallery search result\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2015-07-19T10:08:55.048Z","updated_at":"2015-07-19T10:08:55.048Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":45773,"filename":"XSS_in_gallery_seach_result_and_drop_down_suggestions_.webm","type":"video/webm","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/045/773/eb928a0cb54a503aa65f5e12ff20000e5749dca8/XSS_in_gallery_seach_result_and_drop_down_suggestions_.webm?response-content-disposition=attachment%3B%20filename%3D%22XSS_in_gallery_seach_result_and_drop_down_suggestions_.webm%22%3B%20filename%2A%3DUTF-8%27%27XSS_in_gallery_seach_result_and_drop_down_suggestions_.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064840Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=7343a3e30aa7c36f6013f9396b6ee6f316c4a318ec7d4b82a6bbe5c2b133b73e"}],"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":516211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For Proper POC\n1.  Search for you video from gallery.\n2.  Select you video, and click edit Info.(For Gallery Info)\n3.  Now, In the box for Edit Gallery Info,\n4.  Enter tile as xyz123\"\u003e\u003cimg src=x onerror=prompt(\"XSS\")\u003e\n5.  Now click Done.\n\nPOC - To Execute\n\n1.EXECUTION FROM SEARCH BOX\nGo to Gallery and start typing tiltle of you tour, here xyz123 and wait for the suggestions to load you tour, that's it the XSS gets executed.\n\n2. Execution from URL\nhttps://www.zaption.com/gallery/search?q=xyz123\n\n3. Working POC\nhttps://www.zaption.com/gallery/search?q=the%20dot\n","markdown_message":"\u003cp\u003eFor Proper POC\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e Search for you video from gallery.\u003c/li\u003e\n\u003cli\u003e Select you video, and click edit Info.(For Gallery Info)\u003c/li\u003e\n\u003cli\u003e Now, In the box for Edit Gallery Info,\u003c/li\u003e\n\u003cli\u003e Enter tile as xyz123\u0026quot;\u0026gt;\u0026lt;img src=x onerror=prompt(\u0026quot;XSS\u0026quot;)\u0026gt;\u003c/li\u003e\n\u003cli\u003e Now click Done.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOC - To Execute\u003c/p\u003e\n\n\u003cp\u003e1.EXECUTION FROM SEARCH BOX\u003cbr\u003e\nGo to Gallery and start typing tiltle of you tour, here xyz123 and wait for the suggestions to load you tour, that\u0026#39;s it the XSS gets executed.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eExecution from URL\u003cbr\u003e\n\u003ca title=\"https://www.zaption.com/gallery/search?q=xyz123\" href=\"/redirect?url=https%3A%2F%2Fwww.zaption.com%2Fgallery%2Fsearch%3Fq%3Dxyz123\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zaption.com/gallery/search?q=xyz123\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWorking POC\u003cbr\u003e\n\u003ca title=\"https://www.zaption.com/gallery/search?q=the%20dot\" href=\"/redirect?url=https%3A%2F%2Fwww.zaption.com%2Fgallery%2Fsearch%3Fq%3Dthe%2520dot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zaption.com/gallery/search?q=the%20dot\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2015-07-19T13:24:52.108Z","updated_at":"2015-07-19T13:25:17.458Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":516247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note, this one is bigger as there is no need to ask user to visit our link, \nWhenever user starts typing any word related to my video title, my video will be in suggestion and thus XSS get executed.\nAlso If any one goes to Recent Tour in gallery, there are many videos with XSS payload which gets executed automatically.","markdown_message":"\u003cp\u003eNote, this one is bigger as there is no need to ask user to visit our link, \u003cbr\u003e\nWhenever user starts typing any word related to my video title, my video will be in suggestion and thus XSS get executed.\u003cbr\u003e\nAlso If any one goes to Recent Tour in gallery, there are many videos with XSS payload which gets executed automatically.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-19T14:20:52.813Z","updated_at":"2015-07-19T14:23:20.927Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":516457,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bugs3ra thanks for the help, I believe we've fixed this bug and it is no longer an issue. Can you please confirm our fix?","markdown_message":"\u003cp\u003e\u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e thanks for the help, I believe we\u0026#39;ve fixed this bug and it is no longer an issue. Can you please confirm our fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-19T19:20:34.418Z","updated_at":"2015-07-19T19:20:34.418Z","actor":{"username":"cstigler","cleared":false,"url":"/cstigler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/092/bb7e2e9669c2b2acf7be03a3632b7fd3e906932a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":516913,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Congrats, Fix working at both places.....","markdown_message":"\u003cp\u003eCongrats, Fix working at both places.....\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T09:31:13.597Z","updated_at":"2015-07-20T09:31:13.597Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":517187,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Great, thank you!","markdown_message":"\u003cp\u003eGreat, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T13:25:39.237Z","updated_at":"2015-07-20T13:25:39.237Z","actor":{"username":"cstigler","cleared":false,"url":"/cstigler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/092/bb7e2e9669c2b2acf7be03a3632b7fd3e906932a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugs3ra","url":"/bugs3ra"},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":517189,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-20T13:25:53.281Z","updated_at":"2015-07-20T13:25:53.281Z","actor":{"url":"/zaption","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/695/b8975893f4c9838f55b4f656bc93528666fa68ba_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zaption"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zaption","collaborator":{"username":"bugs3ra","url":"/bugs3ra"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":517424,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for bounty.","markdown_message":"\u003cp\u003eThanks for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T16:17:26.069Z","updated_at":"2015-07-20T16:17:26.069Z","first_to_agree":true,"actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":545953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-12T17:13:16.408Z","updated_at":"2015-08-12T17:13:16.408Z","actor":{"username":"cstigler","cleared":false,"url":"/cstigler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/092/bb7e2e9669c2b2acf7be03a3632b7fd3e906932a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":545954,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-12T17:13:16.505Z","updated_at":"2015-08-12T17:13:16.505Z","actor":{"username":"cstigler","cleared":false,"url":"/cstigler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/092/bb7e2e9669c2b2acf7be03a3632b7fd3e906932a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zaption","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":306,"category":"researcher","content":"{URGENT} Global Stored XSS in GALLERY Search result and suggestion drop down and Recent Tours","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e{URGENT} Global Stored XSS in GALLERY Search result and suggestion drop down and Recent Tours\u003c/p\u003e\n"}]}