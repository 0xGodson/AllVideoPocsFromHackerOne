{"id":150083,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTAwODM=","url":"https://hackerone.com/reports/150083","title":"Cross Site Scripting(XSS) on IRCCloud Badges Page (using Parameter Pollution)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-08T19:55:20.685Z","submitted_at":"2016-07-08T19:55:20.685Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rohitdua","url":"/rohitdua","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-08T23:50:49.161Z","bug_reporter_agreed_on_going_public_at":"2016-07-08T23:39:53.890Z","team_member_agreed_on_going_public_at":"2016-07-08T23:50:49.062Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Vulnerability\n---------------------\nIRCCloud is affected by Cross Site Scripting vulnerability in its badges page. (www.irccloud.com/badges)\n\nII. Description\n---------------------\nIRCCloud is open to parameter pollution attacks ie. a parameter passed more than once with different values results in varying different results.\nThis bug is used to leverage an XSS in the badges page.\n\n####POC link:\n```\nwww.irccloud.com/badges?hostname=hostname\" type=\"text/javascript\"\u003e /*\u0026hostname=*/alert('XSS\\n-Rohit Dua'); //\n```\nIf  you visit the link a javascript pops up showing the message 'XSS - Rohit Dua'. (screenshot_irccloud.png)\n\nEven after parameter pollution, the attack is ineffective due to strong XSS filters(possibly firewall)\nThe _filter evasion_ is possible due a certain combination of javascript comments in the url that combine and comment out the unneeded part.\n\n#####[Attached]\nPOC source code screenshot\nPOC alert box screenshot\n\nPlease verify and fix the same.","vulnerability_information_html":"\u003ch2 id=\"i-vulnerability\"\u003eI. Vulnerability\u003c/h2\u003e\n\n\u003cp\u003eIRCCloud is affected by Cross Site Scripting vulnerability in its badges page. (\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.irccloud.com%2Fbadges\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.irccloud.com/badges\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003ch2 id=\"ii-description\"\u003eII. Description\u003c/h2\u003e\n\n\u003cp\u003eIRCCloud is open to parameter pollution attacks ie. a parameter passed more than once with different values results in varying different results.\u003cbr\u003e\nThis bug is used to leverage an XSS in the badges page.\u003c/p\u003e\n\n\u003ch4 id=\"poc-link\"\u003ePOC link:\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ewww.irccloud.com/badges?hostname=hostname\u0026quot; type=\u0026quot;text/javascript\u0026quot;\u0026gt; /*\u0026amp;hostname=*/alert(\u0026#39;XSS\\n-Rohit Dua\u0026#39;); //\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf  you visit the link a javascript pops up showing the message \u0026#39;XSS - Rohit Dua\u0026#39;. (screenshot_irccloud.png)\u003c/p\u003e\n\n\u003cp\u003eEven after parameter pollution, the attack is ineffective due to strong XSS filters(possibly firewall)\u003cbr\u003e\nThe \u003cu\u003efilter evasion\u003c/u\u003e is possible due a certain combination of javascript comments in the url that combine and comment out the unneeded part.\u003c/p\u003e\n\n\u003ch5 id=\"attached\"\u003e[Attached]\u003c/h5\u003e\n\n\u003cp\u003ePOC source code screenshot\u003cbr\u003e\nPOC alert box screenshot\u003c/p\u003e\n\n\u003cp\u003ePlease verify and fix the same.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":103965,"file_name":"irccloud.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/103/965/b237dc41bafc6acbdbe7fe8c3fd25b7f5405a5a8/irccloud.png?response-content-disposition=attachment%3B%20filename%3D%22irccloud.png%22%3B%20filename%2A%3DUTF-8%27%27irccloud.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043239Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=3cdb930c584162b6f2fa6796200cf2226ad07361ffebd8b216aa0334467d4218","file_size":38056,"type":"image/png"},{"id":103966,"file_name":"screenshot_irccloud.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/103/966/336955500f5ad61340046d3a7b6b8608f1518893/screenshot_irccloud.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot_irccloud.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot_irccloud.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043239Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=3956478af38e1804db991a4608d856af927292024f35c4e288e3cf0fb28c95b8","file_size":222390,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-07T23:39:54.027Z","allow_singular_disclosure_after":-138603165.22924292,"singular_disclosure_allowed":true,"vote_count":47,"voters":["fern","lukasreschke","michiel","wkcaj","bogdantcaciuc","nahamsec","lucky_sen","try_to_hack","mdv","bugdiscloseguys","and 37 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1060375,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks very much for this report. We've fixed the multiple parameter vulnerability and our XSS filtering should be working properly again. Please confirm the fix from your end.","markdown_message":"\u003cp\u003eThanks very much for this report. We\u0026#39;ve fixed the multiple parameter vulnerability and our XSS filtering should be working properly again. Please confirm the fix from your end.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T22:13:42.354Z","updated_at":"2016-07-08T22:13:42.354Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1060434,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems to be fixed. No more XSS there.\n","markdown_message":"\u003cp\u003eIt seems to be fixed. No more XSS there.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T22:55:06.688Z","updated_at":"2016-07-08T22:55:06.688Z","actor":{"username":"rohitdua","cleared":false,"url":"/rohitdua","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060468,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for the report.","markdown_message":"\u003cp\u003eThanks again for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T23:23:14.616Z","updated_at":"2016-07-08T23:23:14.616Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rohitdua","url":"/rohitdua"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1060469,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T23:23:20.898Z","updated_at":"2016-07-08T23:23:20.898Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"rohitdua","url":"/rohitdua"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1060480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the reward. \nWill see you with more bugs.(if any)","markdown_message":"\u003cp\u003eThank you for the reward. \u003cbr\u003e\nWill see you with more bugs.(if any)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-08T23:28:18.007Z","updated_at":"2016-07-08T23:28:18.007Z","actor":{"username":"rohitdua","cleared":false,"url":"/rohitdua","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060499,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T23:39:53.955Z","updated_at":"2016-07-08T23:39:53.955Z","first_to_agree":true,"actor":{"username":"rohitdua","cleared":false,"url":"/rohitdua","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060517,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T23:50:49.114Z","updated_at":"2016-07-08T23:50:49.114Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1060518,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-08T23:50:49.186Z","updated_at":"2016-07-08T23:50:49.186Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1076649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":".","markdown_message":"\u003cp\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-19T20:20:06.989Z","updated_at":"2016-07-19T20:20:42.875Z","actor":{"username":"rohitdua","cleared":false,"url":"/rohitdua","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}