{"id":136600,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzY2MDA=","url":"https://hackerone.com/reports/136600","title":"Reflected XSS in Backend search","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-05T19:02:16.499Z","submitted_at":"2016-05-05T19:02:16.499Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"krankopwnz","url":"/krankopwnz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1361,"url":"https://hackerone.com/moneybird","handle":"moneybird","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/361/739e6ad9792a2ead9d1fdc718c653da55fba83df_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/361/739e6ad9792a2ead9d1fdc718c653da55fba83df_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Moneybird","twitter_handle":"moneybird","website":"https://www.moneybird.com","about":"Cloud accounting"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-11T12:41:38.277Z","bug_reporter_agreed_on_going_public_at":"2016-05-12T12:41:37.058Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The backend suffers from a reflected XSS because of missing filtering.\n\nA prerequisite for this vuln is, that you enable the option to view invoices online ( this is just to see the id of the account to craft the payload. Maybe you can also find this number anywhere else... )\n\nSteps to reproduce:\nLogin\nCreate an invoice\nEnter the string \"test\" in the details of the invoice ( this is possible to get a search result back. the attacker later knows what is in his invoice and can use any word from within )\nFill the other required fields with any values\nSend the invoice to a valid email address\nWhen you receive the invoice, there is a link to view it online, like\nhttps://moneybird.com/[id]/sales_invoices/29362c563a6eb7bfedad55cc0985d97a77202d65f6089ea54a6718910ce58108/5e5b5ac093069aa9657d87206c38919586b8f235c132175973c3b1a3a86c25fd\nnow copy the [id] ( should be your ID of course ) from the link and paste it into that one: \nhttps://moneybird.com/[id]/search?search_query=test%22%20onclick%3Dalert%28document.domain%29\nNow call it in any browser\nYou will see the search of moneybird with one result\nIf you click on that result, a javascript popup showing the current domain appears ( see screenshot 1 )\n\nThis is possible, because the searchvalue is not enclosed in Quotes ( see screenshot2 ), so it is possible to inject any eventhandler into the html code.\n\nThe worst thing that you can do with this vulnerability, is to redirect a moneybird user to a phishing page where he is prompted to enter his login credentials, or an attacker could even add hisself to the admins of the account and take it over completely. He could also mark his own invoice as paid and so do a financial loss to the victim.\n\n\n","vulnerability_information_html":"\u003cp\u003eThe backend suffers from a reflected XSS because of missing filtering.\u003c/p\u003e\n\n\u003cp\u003eA prerequisite for this vuln is, that you enable the option to view invoices online ( this is just to see the id of the account to craft the payload. Maybe you can also find this number anywhere else... )\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\nLogin\u003cbr\u003e\nCreate an invoice\u003cbr\u003e\nEnter the string \u0026quot;test\u0026quot; in the details of the invoice ( this is possible to get a search result back. the attacker later knows what is in his invoice and can use any word from within )\u003cbr\u003e\nFill the other required fields with any values\u003cbr\u003e\nSend the invoice to a valid email address\u003cbr\u003e\nWhen you receive the invoice, there is a link to view it online, like\u003cbr\u003e\n\u003ca title=\"https://moneybird.com/%5Bid%5D/sales_invoices/29362c563a6eb7bfedad55cc0985d97a77202d65f6089ea54a6718910ce58108/5e5b5ac093069aa9657d87206c38919586b8f235c132175973c3b1a3a86c25fd\" href=\"/redirect?url=https%3A%2F%2Fmoneybird.com%2F%255Bid%255D%2Fsales_invoices%2F29362c563a6eb7bfedad55cc0985d97a77202d65f6089ea54a6718910ce58108%2F5e5b5ac093069aa9657d87206c38919586b8f235c132175973c3b1a3a86c25fd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://moneybird.com/%5Bid%5D/sales_invoices/29362c563a6eb7bfedad55cc0985d97a77202d65f6089ea54a6718910ce58108/5e5b5ac093069aa9657d87206c38919586b8f235c132175973c3b1a3a86c25fd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nnow copy the [id] ( should be your ID of course ) from the link and paste it into that one: \u003cbr\u003e\n\u003ca title=\"https://moneybird.com/%5Bid%5D/search?search_query=test%22%20onclick%3Dalert%28document.domain%29\" href=\"/redirect?url=https%3A%2F%2Fmoneybird.com%2F%255Bid%255D%2Fsearch%3Fsearch_query%3Dtest%2522%2520onclick%253Dalert%2528document.domain%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://moneybird.com/%5Bid%5D/search?search_query=test%22%20onclick%3Dalert%28document.domain%29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nNow call it in any browser\u003cbr\u003e\nYou will see the search of moneybird with one result\u003cbr\u003e\nIf you click on that result, a javascript popup showing the current domain appears ( see screenshot 1 )\u003c/p\u003e\n\n\u003cp\u003eThis is possible, because the searchvalue is not enclosed in Quotes ( see screenshot2 ), so it is possible to inject any eventhandler into the html code.\u003c/p\u003e\n\n\u003cp\u003eThe worst thing that you can do with this vulnerability, is to redirect a moneybird user to a phishing page where he is prompted to enter his login credentials, or an attacker could even add hisself to the admins of the account and take it over completely. He could also mark his own invoice as paid and so do a financial loss to the victim.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":91735,"file_name":"screenshot1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/735/502f31c2f99ffcb9000799bf9f784a5b8f2c82e7/screenshot1.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot1.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042632Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=34cc9a3b72b05526ab1306e03bbc17de286e9cbb45d36381a8c1899c67793d10","file_size":253526,"type":"image/png"},{"id":91736,"file_name":"screenshot2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/736/b3d07b0138d86f6f818156c7178d3fe64bd16f3c/screenshot2.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot2.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042632Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=534cbf19077bbf58bae85414b44d0a365171667ff06957579469da740f7c0563","file_size":86171,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-11T12:41:37.139Z","allow_singular_disclosure_after":-143567095.6980071,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":943543,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We have confirmed this issue and it has been passed to our engineers for further analysis.","markdown_message":"\u003cp\u003eThank you for your report. We have confirmed this issue and it has been passed to our engineers for further analysis.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-06T07:37:04.847Z","updated_at":"2016-05-06T07:37:04.847Z","actor":{"username":"oliverj","cleared":false,"url":"/oliverj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/069/586/4d73b28a1210d50817ac76e148825d54b0ba4127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"moneybird","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":950662,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have deployed a patch for this problem. Can you confirm?","markdown_message":"\u003cp\u003eWe have deployed a patch for this problem. Can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-11T13:28:32.636Z","updated_at":"2016-05-11T13:28:32.636Z","actor":{"username":"oliverj","cleared":false,"url":"/oliverj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/069/586/4d73b28a1210d50817ac76e148825d54b0ba4127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"krankopwnz","url":"/krankopwnz"},"genius_execution_id":null,"team_handle":"moneybird","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":951266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that this is fixed, thanks.","markdown_message":"\u003cp\u003eI can confirm that this is fixed, thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-11T17:37:09.169Z","updated_at":"2016-05-11T17:37:09.169Z","actor":{"username":"krankopwnz","cleared":false,"url":"/krankopwnz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"moneybird","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":952517,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-12T07:05:27.501Z","updated_at":"2016-05-12T07:05:27.501Z","actor":{"url":"/moneybird","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/361/739e6ad9792a2ead9d1fdc718c653da55fba83df_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Moneybird"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"moneybird","collaborator":{"username":"krankopwnz","url":"/krankopwnz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953068,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-12T12:41:37.089Z","updated_at":"2016-05-12T12:41:37.089Z","first_to_agree":true,"actor":{"username":"krankopwnz","cleared":false,"url":"/krankopwnz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"moneybird","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1009261,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-11T12:41:38.395Z","updated_at":"2016-06-11T12:41:38.395Z","actor":{"url":"/moneybird","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/361/739e6ad9792a2ead9d1fdc718c653da55fba83df_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Moneybird"}},"genius_execution_id":null,"team_handle":"moneybird","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}