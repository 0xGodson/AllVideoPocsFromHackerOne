{"id":141463,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDE0NjM=","url":"https://hackerone.com/reports/141463","title":"Stored XSS via AngularJS Injection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-27T16:01:41.237Z","submitted_at":"2016-05-27T16:01:41.237Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1492,"url":"https://hackerone.com/drchrono","handle":"drchrono","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"drchrono","twitter_handle":"drchrono","website":"https://www.drchrono.com","about":"EHR, Practice Management, Medical Billing \u0026 Revenue Cycle Management available on iPad, iPhone, web ... and a healthcare API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-13T19:02:06.315Z","bug_reporter_agreed_on_going_public_at":"2016-06-13T18:16:48.528Z","team_member_agreed_on_going_public_at":"2016-06-13T19:02:06.205Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI've found a stored XSS vulnerability via an Angular Template Injection in the messages referral address field.\n\n##Description\nAfter visiting ``https://1337test.drchrono.com/messages/referrals/contacts/```, you can enter new contact information. In the field for the address, if enter [[5*5]], when the referrals contact overview will show the address as 25. This indicates an injection. \n\nOpening the browser console and using the command angular.version, we can see you are using 1.1.5. So, entering the address for a contact as ```[[constructor.constructor('alert(document.cookie)')()]]```, saving and reloading the page, an stored XSS is executed {F96481}\n\n##Steps to reproduce\n1. Create a doctors account\n2. Visit ```https://1337test.drchrono.com/messages/referrals/contacts/```\n3. Add a new contact\n4. In the address field, enter ```[[constructor.constructor('alert(1)')()]]```\n\nConfirm the alert pop up with **1** in it.\n\n##Vulnerability\nThe stored xss could be used for a complete account take over if an admin visited this contact page. An attacker only needs permission to create a referral contact to store the payload. In the example image, I've printed all cookies to the screen but this could easily be sent to a remote endpoint.\n\nPlease let me know if you have any questions.\nPete","vulnerability_information_html":"\u003cp\u003eHi All,\u003cbr\u003e\nI\u0026#39;ve found a stored XSS vulnerability via an Angular Template Injection in the messages referral address field.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eAfter visiting \u003ccode\u003ehttps://1337test.drchrono.com/messages/referrals/contacts/\u003c/code\u003e`, you can enter new contact information. In the field for the address, if enter [[5*5]], when the referrals contact overview will show the address as 25. This indicates an injection. \u003c/p\u003e\n\n\u003cp\u003eOpening the browser console and using the command angular.version, we can see you are using 1.1.5. So, entering the address for a contact as \u003ccode\u003e[[constructor.constructor(\u0026#39;alert(document.cookie)\u0026#39;)()]]\u003c/code\u003e, saving and reloading the page, an stored XSS is executed \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"angular_injection_contacts.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/481/99058a96bf24c5d76fe7b2f559160e4722315a94/angular_injection_contacts.png?response-content-disposition=attachment%3B%20filename%3D%22angular_injection_contacts.png%22%3B%20filename%2A%3DUTF-8%27%27angular_injection_contacts.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042832Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=68452b7ed16339dfd0effa944e9f5303c94aa76e87e63932055e880b5f8f3b59\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/481/99058a96bf24c5d76fe7b2f559160e4722315a94/angular_injection_contacts.png?response-content-disposition=attachment%3B%20filename%3D%22angular_injection_contacts.png%22%3B%20filename%2A%3DUTF-8%27%27angular_injection_contacts.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042832Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=68452b7ed16339dfd0effa944e9f5303c94aa76e87e63932055e880b5f8f3b59\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a doctors account\u003c/li\u003e\n\u003cli\u003eVisit \u003ccode\u003ehttps://1337test.drchrono.com/messages/referrals/contacts/\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eAdd a new contact\u003c/li\u003e\n\u003cli\u003eIn the address field, enter \u003ccode\u003e[[constructor.constructor(\u0026#39;alert(1)\u0026#39;)()]]\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eConfirm the alert pop up with \u003cstrong\u003e1\u003c/strong\u003e in it.\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability\"\u003eVulnerability\u003c/h2\u003e\n\n\u003cp\u003eThe stored xss could be used for a complete account take over if an admin visited this contact page. An attacker only needs permission to create a referral contact to store the payload. In the example image, I\u0026#39;ve printed all cookies to the screen but this could easily be sent to a remote endpoint.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you have any questions.\u003cbr\u003e\nPete\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":96481,"file_name":"angular_injection_contacts.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/481/99058a96bf24c5d76fe7b2f559160e4722315a94/angular_injection_contacts.png?response-content-disposition=attachment%3B%20filename%3D%22angular_injection_contacts.png%22%3B%20filename%2A%3DUTF-8%27%27angular_injection_contacts.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042832Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=68452b7ed16339dfd0effa944e9f5303c94aa76e87e63932055e880b5f8f3b59","file_size":137866,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-13T18:17:03.298Z","allow_singular_disclosure_after":-140782289.36518356,"singular_disclosure_allowed":true,"vote_count":11,"voters":["tomdev","muon4","spam404","yaworsk","eboda","peeper35","absshax","temmyscript","swaysthinking","dyabla","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":993315,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-31T18:39:49.770Z","updated_at":"2016-05-31T18:39:49.770Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995320,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T18:25:38.997Z","updated_at":"2016-06-01T18:25:38.997Z","actor":{"url":"/drchrono","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"drchrono"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"drchrono","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011482,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T18:14:52.561Z","updated_at":"2016-06-13T18:14:52.561Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Mind if we disclose @kgarcia?","markdown_message":"\u003cp\u003eMind if we disclose \u003ca href=\"/kgarcia\"\u003e@kgarcia\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-13T18:16:48.557Z","updated_at":"2016-06-13T18:16:48.557Z","first_to_agree":true,"actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011612,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T19:02:06.247Z","updated_at":"2016-06-13T19:02:06.247Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011613,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T19:02:06.343Z","updated_at":"2016-06-13T19:02:06.343Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}