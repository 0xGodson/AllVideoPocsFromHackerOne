{"id":96229,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjIyOQ==","url":"https://hackerone.com/reports/96229","title":"XSS on player.vimeo.com without user interaction and vimeo.com with user interaction","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-27T23:50:31.471Z","submitted_at":"2015-10-27T23:50:31.471Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-31T10:24:45.611Z","bug_reporter_agreed_on_going_public_at":"2017-08-01T10:24:36.887Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I reported this one in the report #87854, but I was asked to report it again in a separate report.\n\n__Description__\n\nAt the end of each video appears the thumbnail of other video from the same user. This thumbnail has the title _More from [name_of_the_user]_.\nThe problem is that the name of the user is not escaped, which allows to execute Javascript code. \nThere is a limit for the length of characters that you can use for the name of the user, but it's enough to exploit it. The way I used for the proof of concept is setting the `window.name` to the Javascript code, and then put `\u003csvg onload=eval(name)\u003e\u003c/svg\u003e` as the name of the user.\n\n__Proof of concept__\n1. Download the file _name_xss_iframe.html_ that I attached.\n2. Wait 10 seconds.\n3. `prompt(document.domain,document.cookie)` is executed on https://player.vimeo.com.\n4. Download the file _name_xss.html_ that I attached.\n5. Click on _Watch video_.\n6. Click on the button to play the video.\n6. Wait 10 seconds.\n7. `prompt(document.domain, document.cookie)` is executed on https://vimeo.com.","vulnerability_information_html":"\u003cp\u003eI reported this one in the report \u003ca href=\"/reports/87854\"\u003e#87854\u003c/a\u003e, but I was asked to report it again in a separate report.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAt the end of each video appears the thumbnail of other video from the same user. This thumbnail has the title \u003cu\u003eMore from [name_of_the_user]\u003c/u\u003e.\u003cbr\u003e\nThe problem is that the name of the user is not escaped, which allows to execute Javascript code. \u003cbr\u003e\nThere is a limit for the length of characters that you can use for the name of the user, but it\u0026#39;s enough to exploit it. The way I used for the proof of concept is setting the \u003ccode\u003ewindow.name\u003c/code\u003e to the Javascript code, and then put \u003ccode\u003e\u0026lt;svg onload=eval(name)\u0026gt;\u0026lt;/svg\u0026gt;\u003c/code\u003e as the name of the user.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof of concept\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload the file \u003cu\u003ename_xss_iframe.html\u003c/u\u003e that I attached.\u003c/li\u003e\n\u003cli\u003eWait 10 seconds.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eprompt(document.domain,document.cookie)\u003c/code\u003e is executed on \u003ca title=\"https://player.vimeo.com\" href=\"/redirect?url=https%3A%2F%2Fplayer.vimeo.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://player.vimeo.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eDownload the file \u003cu\u003ename_xss.html\u003c/u\u003e that I attached.\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eWatch video\u003c/u\u003e.\u003c/li\u003e\n\u003cli\u003eClick on the button to play the video.\u003c/li\u003e\n\u003cli\u003eWait 10 seconds.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eprompt(document.domain, document.cookie)\u003c/code\u003e is executed on \u003ca title=\"https://vimeo.com\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":59165,"file_name":"name_xss_iframe.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/165/8b7afff78c1868179b234f3a458beb3bf999fa70/name_xss_iframe.html?response-content-disposition=attachment%3B%20filename%3D%22name_xss_iframe.html%22%3B%20filename%2A%3DUTF-8%27%27name_xss_iframe.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071512Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=7b0a8855fc1829896a9d3dcc90b958db371ebb7f5a852aa2a6bfb38c84715f4a","file_size":263,"type":"text/html"},{"id":59166,"file_name":"name_xss.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/166/a2d2907f6cf4521a8e1dd94cebf7a503f1f09886/name_xss.html?response-content-disposition=attachment%3B%20filename%3D%22name_xss.html%22%3B%20filename%2A%3DUTF-8%27%27name_xss.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071512Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=3a7bd7b6d2247ad0819c9e541645bfec6f2a3ba6d208099d01439eee2b20684b","file_size":175,"type":"text/html"}],"allow_singular_disclosure_at":"2017-08-31T10:24:36.967Z","allow_singular_disclosure_after":-105051035.99943246,"singular_disclosure_allowed":true,"vote_count":4,"voters":["flamezzz","eveeez","r3y","hacklad"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":640966,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Still working on this.","markdown_message":"\u003cp\u003eStill working on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T14:08:37.604Z","updated_at":"2015-11-02T14:08:37.604Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":641597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay. Thanks for the update.","markdown_message":"\u003cp\u003eOkay. Thanks for the update.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T20:32:02.688Z","updated_at":"2015-11-02T20:32:02.688Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been fixed. Can you please confirm?","markdown_message":"\u003cp\u003eThis has been fixed. Can you please confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T19:34:30.282Z","updated_at":"2015-11-03T19:34:30.282Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it's fixed. The name of the owner of the video is escaped correctly.","markdown_message":"\u003cp\u003eYes, it\u0026#39;s fixed. The name of the owner of the video is escaped correctly.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T21:38:07.932Z","updated_at":"2015-11-03T21:38:07.932Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645148,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you","markdown_message":"\u003cp\u003eThank you\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T14:17:15.246Z","updated_at":"2015-11-04T14:17:15.246Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645151,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-04T14:20:51.088Z","updated_at":"2015-11-04T14:20:51.088Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645756,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the reward.","markdown_message":"\u003cp\u003eThank you for the reward.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T20:17:02.975Z","updated_at":"2015-11-04T20:17:02.975Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881901,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I hope it's okay for you to disclose this one too. Thanks!","markdown_message":"\u003cp\u003eI hope it\u0026#39;s okay for you to disclose this one too. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-01T10:24:36.917Z","updated_at":"2017-08-01T10:24:36.917Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968367,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-31T10:24:45.643Z","updated_at":"2017-08-31T10:24:45.643Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}