{"id":106293,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDYyOTM=","url":"https://hackerone.com/reports/106293","title":"Reflective XSS on wholesale.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-21T10:15:55.716Z","submitted_at":"2015-12-21T10:15:55.716Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"krankopwnz","url":"/krankopwnz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-21T23:26:59.805Z","bug_reporter_agreed_on_going_public_at":"2015-12-21T23:26:59.625Z","team_member_agreed_on_going_public_at":"2015-12-21T23:25:16.720Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is a reflected XSS issue on wholesale.shopify.com\n\nSteps to reproduce:\nCall the following URL in Mozilla Firefox:\nhttps://wholesale.shopify.com/asd%27%3Balert%28%27XSS%27%29%3B%27\n\nAn alert box with \"XSS\" appears. This means that an attacker has full control of the scripts, that are executed in the victims browser.\n\nAn attack vector would be sending an evil link via e-mail, messenger, etc. As the victim trusts the domain wholesale.shopify.com, it will click the link and could be redirected to a site hosting a browser exploit kit.\nThis abuses the trust of shopify.com\n\nThe main problem with that XSS is, that in script context the quotes, double quotes and \"\u003e\" + \"\u003c\" are not encoded at all.\n\nI suggest to convert them either to hex values or escape them.\n","vulnerability_information_html":"\u003cp\u003eThere is a reflected XSS issue on wholesale.shopify.com\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\nCall the following URL in Mozilla Firefox:\u003cbr\u003e\n\u003ca title=\"https://wholesale.shopify.com/asd%27%3Balert%28%27XSS%27%29%3B%27\" href=\"/redirect?url=https%3A%2F%2Fwholesale.shopify.com%2Fasd%2527%253Balert%2528%2527XSS%2527%2529%253B%2527\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wholesale.shopify.com/asd%27%3Balert%28%27XSS%27%29%3B%27\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAn alert box with \u0026quot;XSS\u0026quot; appears. This means that an attacker has full control of the scripts, that are executed in the victims browser.\u003c/p\u003e\n\n\u003cp\u003eAn attack vector would be sending an evil link via e-mail, messenger, etc. As the victim trusts the domain wholesale.shopify.com, it will click the link and could be redirected to a site hosting a browser exploit kit.\u003cbr\u003e\nThis abuses the trust of shopify.com\u003c/p\u003e\n\n\u003cp\u003eThe main problem with that XSS is, that in script context the quotes, double quotes and \u0026quot;\u0026gt;\u0026quot; + \u0026quot;\u0026lt;\u0026quot; are not encoded at all.\u003c/p\u003e\n\n\u003cp\u003eI suggest to convert them either to hex values or escape them.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":66302,"file_name":"shopify2.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/066/302/ccee3e1e250aa81d46c2ebb8073e8534f4b20e1a/shopify2.jpg?response-content-disposition=attachment%3B%20filename%3D%22shopify2.jpg%22%3B%20filename%2A%3DUTF-8%27%27shopify2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041433Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=12b39f237b10a91a3161f5052d118334d044ebc45d45f1e44e548a53d93c8a1d","file_size":85814,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-01-20T23:25:16.892Z","allow_singular_disclosure_after":-155882956.78677818,"singular_disclosure_allowed":true,"vote_count":5,"voters":["booghi","alt-glitch","bhumeswarreddy","0x7d7b","safisec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":727923,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-21T13:54:17.858Z","updated_at":"2015-12-21T13:54:17.858Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728751,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has now been resolved. We'll be in touch again soon during our next round of bounty decisions.","markdown_message":"\u003cp\u003eThanks again for your report. This issue has now been resolved. We\u0026#39;ll be in touch again soon during our next round of bounty decisions.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-21T21:15:29.575Z","updated_at":"2015-12-21T21:15:29.575Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"krankopwnz","url":"/krankopwnz"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728885,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-21T23:25:08.532Z","updated_at":"2015-12-21T23:25:08.532Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"krankopwnz","url":"/krankopwnz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728886,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-21T23:25:16.751Z","updated_at":"2015-12-21T23:25:16.751Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728888,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-21T23:26:59.666Z","updated_at":"2015-12-21T23:26:59.666Z","actor":{"username":"krankopwnz","cleared":false,"url":"/krankopwnz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":728889,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-21T23:26:59.829Z","updated_at":"2015-12-21T23:26:59.829Z","actor":{"username":"krankopwnz","cleared":false,"url":"/krankopwnz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}