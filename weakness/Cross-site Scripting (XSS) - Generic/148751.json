{"id":148751,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg3NTE=","url":"https://hackerone.com/reports/148751","title":"Stored XSS in comments","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T20:48:22.410Z","submitted_at":"2016-07-01T20:48:22.410Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kelunik","url":"/kelunik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-01T22:18:55.990Z","bug_reporter_agreed_on_going_public_at":"2016-07-01T22:18:55.918Z","team_member_agreed_on_going_public_at":"2016-07-01T22:16:23.865Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Comments can contain an author's website. This website is used in the href attribute of link elements and isn't filtered. Thus it allows URLs like `javascript:alert(1)` to be used. These URLs must be filtered by protocol, e.g. only allow http and https.\n\nThese attacks are blocked by the default CSP, but clients not supporting CSP or changed CSPs may be affected.\n\nThis issue affects [Airship](https://github.com/paragonie/airship) Version 1.1.2 and lower.","vulnerability_information_html":"\u003cp\u003eComments can contain an author\u0026#39;s website. This website is used in the href attribute of link elements and isn\u0026#39;t filtered. Thus it allows URLs like \u003ccode\u003ejavascript:alert(1)\u003c/code\u003e to be used. These URLs must be filtered by protocol, e.g. only allow http and https.\u003c/p\u003e\n\n\u003cp\u003eThese attacks are blocked by the default CSP, but clients not supporting CSP or changed CSPs may be affected.\u003c/p\u003e\n\n\u003cp\u003eThis issue affects \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eAirship\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e Version 1.1.2 and lower.\u003c/p\u003e\n","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102860,"file_name":"Airship_Stored_Comment_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/860/3926829deb47cf05da993fb27411f85bdda292fc/Airship_Stored_Comment_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Airship_Stored_Comment_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Airship_Stored_Comment_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043156Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=1ab52993f79bd7c92873b2c7028477bf5a60a88774cf04b97f466cba3d356598","file_size":29371,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-31T22:16:23.937Z","allow_singular_disclosure_after":-139212932.06596375,"singular_disclosure_allowed":true,"vote_count":6,"voters":["michiel","klau5","paragonie-scott","dyabla","rfkrishnan","kelunik"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1049939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not sure how to classify this one. In one regard, it sort of is a \"stored XSS\" because it's stored in the URL and causes Javascript to execute. However, it's also not the sort of thing that pwns the user who lands on the page.\n\nEither way, it ought to be fixed.","markdown_message":"\u003cp\u003eI\u0026#39;m not sure how to classify this one. In one regard, it sort of is a \u0026quot;stored XSS\u0026quot; because it\u0026#39;s stored in the URL and causes Javascript to execute. However, it\u0026#39;s also not the sort of thing that pwns the user who lands on the page.\u003c/p\u003e\n\n\u003cp\u003eEither way, it ought to be fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T21:28:41.482Z","updated_at":"2016-07-01T21:28:41.482Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049950,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://github.com/paragonie/airship/commit/4e14bc54ae76ff32f4edb448d5741d99176921f2 should fix it.","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/paragonie/airship/commit/4e14bc54ae76ff32f4edb448d5741d99176921f2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2F4e14bc54ae76ff32f4edb448d5741d99176921f2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/4e14bc54ae76ff32f4edb448d5741d99176921f2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e should fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T21:33:08.461Z","updated_at":"2016-07-01T21:33:08.461Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kelunik","url":"/kelunik"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049952,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T21:34:31.090Z","updated_at":"2016-07-01T21:34:31.090Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Paragon Initiative Enterprises"}},"bounty_amount":"25.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"paragonie","collaborator":{"username":"kelunik","url":"/kelunik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're right, it's not executing immediately at least and is usually blocked by the CSP as well.","markdown_message":"\u003cp\u003eYou\u0026#39;re right, it\u0026#39;s not executing immediately at least and is usually blocked by the CSP as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T21:35:40.297Z","updated_at":"2016-07-01T21:35:40.297Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just verified that the same doesn't apply to the Bridge, but it's not a link there, just plain text.","markdown_message":"\u003cp\u003eJust verified that the same doesn\u0026#39;t apply to the Bridge, but it\u0026#39;s not a link there, just plain text.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T21:46:56.998Z","updated_at":"2016-07-01T21:46:56.998Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049999,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T22:16:23.889Z","updated_at":"2016-07-01T22:16:23.889Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050004,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T22:18:55.944Z","updated_at":"2016-07-01T22:18:55.944Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1050005,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T22:18:56.009Z","updated_at":"2016-07-01T22:18:56.009Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2154,"category":"team","content":"This one was a grey area. One one hand, it's literally stored and it's literally a Javascript payload that a user could accidentally execute. On the other hand, it pushes the envelope of what counts as a vulnerability or not. (We decided to award a bounty as per our stated policy to err on the side of generosity when in doubt.) That being said, there's no real world use-case for a guest to share a non-HTTP(S) URL in their attribution for blog comments.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis one was a grey area. One one hand, it\u0026#39;s literally stored and it\u0026#39;s literally a Javascript payload that a user could accidentally execute. On the other hand, it pushes the envelope of what counts as a vulnerability or not. (We decided to award a bounty as per our stated policy to err on the side of generosity when in doubt.) That being said, there\u0026#39;s no real world use-case for a guest to share a non-HTTP(S) URL in their attribution for blog comments.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}