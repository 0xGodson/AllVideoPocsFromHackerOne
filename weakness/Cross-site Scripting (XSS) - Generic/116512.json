{"id":116512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY1MTI=","url":"https://hackerone.com/reports/116512","title":"Markdown parsing issue enables insertion of malicious tags","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-02-15T08:08:07.472Z","submitted_at":"2016-02-15T08:08:07.472Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ru94mb","url":"/ru94mb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-21T13:28:46.303Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-15T16:30:55.679Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Markdown tags and event handlers can be used to load malicious URLs in user's profile statement.\n\nHere is the payload that when entered in user's profile statement leads to the following HTML:\n\nPayload: _www.attacker.com/malicious.exe_\n\nResulting HTML:  \"html\": \"\u003cp\u003e\u003cem\u003e\u003ca href=\\\"http://www.attacker.com/malicious.exe\\\"\u003ewww.attacker.com/malicious.exe\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\\n\"\n\nSee the following screenshots for more details:\n\n\"Profile.jpg\"\n\"request.jpg\"\n\"response.jpg\"\n\nUser can be redirected to malicious URLs and malware can be hosted on gratipay.com using this vulnerability.\n\nFix:\n\nDisable the functionality for these markdown tags.\n","vulnerability_information_html":"\u003cp\u003eMarkdown tags and event handlers can be used to load malicious URLs in user\u0026#39;s profile statement.\u003c/p\u003e\n\n\u003cp\u003eHere is the payload that when entered in user\u0026#39;s profile statement leads to the following HTML:\u003c/p\u003e\n\n\u003cp\u003ePayload: \u003cu\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.attacker.com%2Fmalicious.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.attacker.com/malicious.exe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/u\u003e\u003c/p\u003e\n\n\u003cp\u003eResulting HTML:  \u0026quot;html\u0026quot;: \u0026quot;\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u0026lt;a href=\\\u0026quot;http://www.attacker.com/malicious.exe\\\u0026quot;\u0026gt;\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.attacker.com%2Fmalicious.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.attacker.com/malicious.exe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\\n\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eSee the following screenshots for more details:\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;Profile.jpg\u0026quot;\u003cbr\u003e\n\u0026quot;request.jpg\u0026quot;\u003cbr\u003e\n\u0026quot;response.jpg\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eUser can be redirected to malicious URLs and malware can be hosted on gratipay.com using this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eFix:\u003c/p\u003e\n\n\u003cp\u003eDisable the functionality for these markdown tags.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":73541,"file_name":"Response.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/541/612ca1fb9ea213f848793cb0627a46390177e2c2/Response.JPG?response-content-disposition=attachment%3B%20filename%3D%22Response.JPG%22%3B%20filename%2A%3DUTF-8%27%27Response.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXUI3A3EU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041840Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3FYvBYleEBKlcR4U813JIy2bW57CnBEMYNVUklmu%2F8AiEAkmkT5udE997pW9%2Brdr3EQcAl90OKeowQeNnY5PWn0FMqtAMIURABGgwwMTM2MTkyNzQ4NDkiDPawt2AQxXBDYjcx8SqRAxeHaKWteeUxrUqlkoufMMEA5gt7fGuPc%2FQ8XlAC6if7%2BAN3DuxhIczuGXyMD3AZ2gCh%2FbZPPmpgHCvQzYSuMsyxNOfy9tQQ9EROgfRZPXLMRN4%2FpGSWQ6gHtJdtsCmudNYzECf0IUxf6i1g4hXbPb8e6uzX6I5SZyEPqw%2FdP5dI%2B7b%2BDigifeXhq7w45BRg7OT6J5Hjnta4dbkMBMlp%2F0My8pTlWcFC%2FtnydbIhcmv1iJ8l95%2F9k94nFAe%2Ba9K%2FrHhmRp1vXXtcV%2BSQt6Rt%2Bu9YekgMLRnk0t7iG06rQosuJAYyNQ5VLHP0y7Er6mta9IsRvuhX6JEymQLINEVYOKl4jLRAGGtRfn3IK51oSd5rvwzW9bUUr3cyd%2BFYucpmBfuGecFvEV3om2Ix3tQasywRnnB62D3IHtj9H24%2FqVsVjkf0L%2F4%2FrQZzEGfgTaW36SNg%2FtrmWuqHdaU5MphbfdTO0b4QE1Pbvbabbhzj9jepApBj3PzTEDZ1kgeqfWrh2Y%2B9xqcsXMr0oBM4TwawREfeMPfnqf8FOusBlr0EVcM7s3rMsU4cJiAYmagVYoLJLjHWikxkoiN1XJ1GdOFn4TYDAV84a%2FYZUsjHIpo1bNZZb6ByP3ITgSDq61DodRCfnMKxgWrSPnBLf52FhVTepY72JjNLMG5brQjaYkRqUh04T73%2Fl%2Fiucs1oIBFG5Z2EGc36AkTTr9yU97IX104KaNmwKYu0EWIgdWFFzzEJwuPd5oFDLiKVdAk%2BAcyr9ckpYQNcGr22oQCogaF2%2FYE6z9TV8XI3hPksjavj%2Fsub6%2BtFMy%2Fv0CnmvZqSmN%2Be%2FmBVeEq4rFmi6qzkLBuzYAopi6n90EQDGg%3D%3D\u0026X-Amz-Signature=960e658feb04d0a0c7bb4610edcd1b205ce1ab0d6acac47624b85223d0ec7097","file_size":74318,"type":"image/jpeg"},{"id":73542,"file_name":"Request.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/542/3a60916bc70bf4ccb38d91ef996ed962b10a237d/Request.JPG?response-content-disposition=attachment%3B%20filename%3D%22Request.JPG%22%3B%20filename%2A%3DUTF-8%27%27Request.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXUI3A3EU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041840Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3FYvBYleEBKlcR4U813JIy2bW57CnBEMYNVUklmu%2F8AiEAkmkT5udE997pW9%2Brdr3EQcAl90OKeowQeNnY5PWn0FMqtAMIURABGgwwMTM2MTkyNzQ4NDkiDPawt2AQxXBDYjcx8SqRAxeHaKWteeUxrUqlkoufMMEA5gt7fGuPc%2FQ8XlAC6if7%2BAN3DuxhIczuGXyMD3AZ2gCh%2FbZPPmpgHCvQzYSuMsyxNOfy9tQQ9EROgfRZPXLMRN4%2FpGSWQ6gHtJdtsCmudNYzECf0IUxf6i1g4hXbPb8e6uzX6I5SZyEPqw%2FdP5dI%2B7b%2BDigifeXhq7w45BRg7OT6J5Hjnta4dbkMBMlp%2F0My8pTlWcFC%2FtnydbIhcmv1iJ8l95%2F9k94nFAe%2Ba9K%2FrHhmRp1vXXtcV%2BSQt6Rt%2Bu9YekgMLRnk0t7iG06rQosuJAYyNQ5VLHP0y7Er6mta9IsRvuhX6JEymQLINEVYOKl4jLRAGGtRfn3IK51oSd5rvwzW9bUUr3cyd%2BFYucpmBfuGecFvEV3om2Ix3tQasywRnnB62D3IHtj9H24%2FqVsVjkf0L%2F4%2FrQZzEGfgTaW36SNg%2FtrmWuqHdaU5MphbfdTO0b4QE1Pbvbabbhzj9jepApBj3PzTEDZ1kgeqfWrh2Y%2B9xqcsXMr0oBM4TwawREfeMPfnqf8FOusBlr0EVcM7s3rMsU4cJiAYmagVYoLJLjHWikxkoiN1XJ1GdOFn4TYDAV84a%2FYZUsjHIpo1bNZZb6ByP3ITgSDq61DodRCfnMKxgWrSPnBLf52FhVTepY72JjNLMG5brQjaYkRqUh04T73%2Fl%2Fiucs1oIBFG5Z2EGc36AkTTr9yU97IX104KaNmwKYu0EWIgdWFFzzEJwuPd5oFDLiKVdAk%2BAcyr9ckpYQNcGr22oQCogaF2%2FYE6z9TV8XI3hPksjavj%2Fsub6%2BtFMy%2Fv0CnmvZqSmN%2Be%2FmBVeEq4rFmi6qzkLBuzYAopi6n90EQDGg%3D%3D\u0026X-Amz-Signature=6958b0bfeb9b0360b3089342656f86cc3719b2c81bc4337f62e62119d27efdec","file_size":91323,"type":"image/jpeg"},{"id":73543,"file_name":"profile.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/543/6615e0b3db9034a3d7e4aa9cb1a4dc0bd3be39f9/profile.JPG?response-content-disposition=attachment%3B%20filename%3D%22profile.JPG%22%3B%20filename%2A%3DUTF-8%27%27profile.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXUI3A3EU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041840Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3FYvBYleEBKlcR4U813JIy2bW57CnBEMYNVUklmu%2F8AiEAkmkT5udE997pW9%2Brdr3EQcAl90OKeowQeNnY5PWn0FMqtAMIURABGgwwMTM2MTkyNzQ4NDkiDPawt2AQxXBDYjcx8SqRAxeHaKWteeUxrUqlkoufMMEA5gt7fGuPc%2FQ8XlAC6if7%2BAN3DuxhIczuGXyMD3AZ2gCh%2FbZPPmpgHCvQzYSuMsyxNOfy9tQQ9EROgfRZPXLMRN4%2FpGSWQ6gHtJdtsCmudNYzECf0IUxf6i1g4hXbPb8e6uzX6I5SZyEPqw%2FdP5dI%2B7b%2BDigifeXhq7w45BRg7OT6J5Hjnta4dbkMBMlp%2F0My8pTlWcFC%2FtnydbIhcmv1iJ8l95%2F9k94nFAe%2Ba9K%2FrHhmRp1vXXtcV%2BSQt6Rt%2Bu9YekgMLRnk0t7iG06rQosuJAYyNQ5VLHP0y7Er6mta9IsRvuhX6JEymQLINEVYOKl4jLRAGGtRfn3IK51oSd5rvwzW9bUUr3cyd%2BFYucpmBfuGecFvEV3om2Ix3tQasywRnnB62D3IHtj9H24%2FqVsVjkf0L%2F4%2FrQZzEGfgTaW36SNg%2FtrmWuqHdaU5MphbfdTO0b4QE1Pbvbabbhzj9jepApBj3PzTEDZ1kgeqfWrh2Y%2B9xqcsXMr0oBM4TwawREfeMPfnqf8FOusBlr0EVcM7s3rMsU4cJiAYmagVYoLJLjHWikxkoiN1XJ1GdOFn4TYDAV84a%2FYZUsjHIpo1bNZZb6ByP3ITgSDq61DodRCfnMKxgWrSPnBLf52FhVTepY72JjNLMG5brQjaYkRqUh04T73%2Fl%2Fiucs1oIBFG5Z2EGc36AkTTr9yU97IX104KaNmwKYu0EWIgdWFFzzEJwuPd5oFDLiKVdAk%2BAcyr9ckpYQNcGr22oQCogaF2%2FYE6z9TV8XI3hPksjavj%2Fsub6%2BtFMy%2Fv0CnmvZqSmN%2Be%2FmBVeEq4rFmi6qzkLBuzYAopi6n90EQDGg%3D%3D\u0026X-Amz-Signature=24d84152ecab48a902ba442ad06d9b4ff89cf879cab2aadd96ba1cd648e12f4e","file_size":98164,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-03-16T16:30:55.893Z","allow_singular_disclosure_after":-151069664.33098832,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":798045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A similar publicly disclosed issue can be found here https://hackerone.com/reports/46916","markdown_message":"\u003cp\u003eA similar publicly disclosed issue can be found here \u003ca title=\"https://hackerone.com/reports/46916\" href=\"https://hackerone.com/reports/46916\"\u003ehttps://hackerone.com/reports/46916\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T08:11:11.742Z","updated_at":"2016-02-15T08:11:11.742Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":798565,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"@ru94mb The behavior you describe looks like simple linking, a basic feature of Markdown.\n\nThe example you reference in #46916 uses a different payload, `_http://danlec_@.1 foo=bar`, which in Gratipay's case does not appear to trigger the behavior that was observed in HackerOne via Sundown 1.16.0:\n\n```html\n\u003cp\u003e\u003cem\u003ehttp://danl\u003ca href=\"mailto:danlec_@.1\"\u003edanlec_@.1\u003c/a\u003e foo=bar\u003c/em\u003e\u003c/p\u003e\n```\n\nGratipay uses [Misaka v1.0.2](https://github.com/FSX/misaka/tree/v1.0.2), which [appears](https://github.com/FSX/misaka/tree/v1.0.2/vendor) to bundle [Sundown@8e5b0d1](https://github.com/vmg/sundown/blob/8e5b0d14c9021981dbad364c6860c2ab18a40666/). The `parse_inline` [code](https://github.com/vmg/sundown/blob/8e5b0d14c9021981dbad364c6860c2ab18a40666/src/markdown.c#L351-L388) in that version of Sundown does look similar to the unfixed code at https://hackerone.com/reports/46916#activity-358814, so I'm not exactly sure *why* we're not vulnerable.\n\nClosing as informative to avoid reputational damage. Please provide further information if there's something I'm missing. Thanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/ru94mb\"\u003e@ru94mb\u003c/a\u003e The behavior you describe looks like simple linking, a basic feature of Markdown.\u003c/p\u003e\n\n\u003cp\u003eThe example you reference in \u003ca href=\"/reports/46916\"\u003e#46916\u003c/a\u003e uses a different payload, \u003ccode\u003e_http://danlec_@.1 foo=bar\u003c/code\u003e, which in Gratipay\u0026#39;s case does not appear to trigger the behavior that was observed in HackerOne via Sundown 1.16.0:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;\u003c/span\u003ehttp://danl\u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;mailto:danlec_@.1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003edanlec_@.1\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e foo=bar\u003cspan class=\"nt\"\u003e\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGratipay uses \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFSX%2Fmisaka%2Ftree%2Fv1.0.2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMisaka v1.0.2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FFSX%2Fmisaka%2Ftree%2Fv1.0.2%2Fvendor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eappears\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to bundle \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvmg%2Fsundown%2Fblob%2F8e5b0d14c9021981dbad364c6860c2ab18a40666%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSundown@8e5b0d1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The \u003ccode\u003eparse_inline\u003c/code\u003e \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvmg%2Fsundown%2Fblob%2F8e5b0d14c9021981dbad364c6860c2ab18a40666%2Fsrc%2Fmarkdown.c%23L351-L388\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecode\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in that version of Sundown does look similar to the unfixed code at \u003ca title=\"https://hackerone.com/reports/46916#activity-358814\" href=\"https://hackerone.com/reports/46916#activity-358814\"\u003ehttps://hackerone.com/reports/46916#activity-358814\u003c/a\u003e, so I\u0026#39;m not exactly sure \u003cem\u003ewhy\u003c/em\u003e we\u0026#39;re not vulnerable.\u003c/p\u003e\n\n\u003cp\u003eClosing as informative to avoid reputational damage. Please provide further information if there\u0026#39;s something I\u0026#39;m missing. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:29:36.003Z","updated_at":"2016-02-15T16:29:36.003Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798568,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-15T16:30:55.717Z","updated_at":"2016-02-15T16:30:55.717Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798596,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @whit537 I have observed the same behaviour and I was surprised too. But I could find a way to initiate automatic linking feature of markdown and create a PoC with malware download to show the impact. \n\nI suggest there is still a fix required. Disabling automatic linking should fix all potential issues. I checked my payload on Hackerone (where the original bug was logged) and it remains plaintext and don't get converted to a link.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e I have observed the same behaviour and I was surprised too. But I could find a way to initiate automatic linking feature of markdown and create a PoC with malware download to show the impact. \u003c/p\u003e\n\n\u003cp\u003eI suggest there is still a fix required. Disabling automatic linking should fix all potential issues. I checked my payload on Hackerone (where the original bug was logged) and it remains plaintext and don\u0026#39;t get converted to a link.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:41:08.388Z","updated_at":"2016-02-15T16:41:08.388Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":798607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"_www.attacker.com/malicious.exe_","markdown_message":"\u003cp\u003e\u003cu\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.attacker.com%2Fmalicious.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.attacker.com/malicious.exe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/u\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:44:31.336Z","updated_at":"2016-02-15T16:44:31.336Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Disabling automatic linking should fix all potential issues.\n\n@ru94mb Yes, and it would also remove a core feature of Markdown.\n\n\u003e I checked my payload on Hackerone (where the original bug was logged) and it remains plaintext and don't get converted to a link.\n\nI entered `_www.attacker.com/malicious.exe_` into my previous comment and it is not plaintext that I can see. Do I have the payload wrong?","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eDisabling automatic linking should fix all potential issues.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca href=\"/ru94mb\"\u003e@ru94mb\u003c/a\u003e Yes, and it would also remove a core feature of Markdown.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI checked my payload on Hackerone (where the original bug was logged) and it remains plaintext and don\u0026#39;t get converted to a link.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI entered \u003ccode\u003e_www.attacker.com/malicious.exe_\u003c/code\u003e into my previous comment and it is not plaintext that I can see. Do I have the payload wrong?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:46:27.445Z","updated_at":"2016-02-15T16:46:27.445Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you want to keep this linking enabled, then a redirection warning is suggested as part of user's security.","markdown_message":"\u003cp\u003eIf you want to keep this linking enabled, then a redirection warning is suggested as part of user\u0026#39;s security.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:47:12.233Z","updated_at":"2016-02-15T16:47:12.233Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":798634,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, that doesn't fit our current threat model.","markdown_message":"\u003cp\u003eSorry, that doesn\u0026#39;t fit our current threat model.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:51:01.637Z","updated_at":"2016-02-15T16:51:01.637Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok. Let me take a deeper look at the code and see why the original PoC is not working. Thanks for your inputs.","markdown_message":"\u003cp\u003eOk. Let me take a deeper look at the code and see why the original PoC is not working. Thanks for your inputs.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T16:52:24.887Z","updated_at":"2016-02-15T16:52:24.887Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":798744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The code is same as the vulnerable code in the referenced bug. The attack should ideally work. Anyways to be safe I would suggest that you upgrade to the latest version of markdown.c _https://github.com/vmg/sundown/blob/master/src/markdown.c_","markdown_message":"\u003cp\u003eThe code is same as the vulnerable code in the referenced bug. The attack should ideally work. Anyways to be safe I would suggest that you upgrade to the latest version of markdown.c \u003cu\u003e\u003ca title=\"https://github.com/vmg/sundown/blob/master/src/markdown.c\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvmg%2Fsundown%2Fblob%2Fmaster%2Fsrc%2Fmarkdown.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/vmg/sundown/blob/master/src/markdown.c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/u\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T17:31:34.745Z","updated_at":"2016-02-15T17:31:34.745Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":798843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your research. It seems that the bug may be triggered be an interaction between the referenced parse_inline function and other parts of the Sundown codebase. Without understanding the root cause I'm not comfortable upgrading, lest we accidentally introduce the bug that we're currently not vulnerable to. Additionally, Sundown is deprecated, so if we were to upgrade it would be to Hoedown.","markdown_message":"\u003cp\u003eThanks for your research. It seems that the bug may be triggered be an interaction between the referenced parse_inline function and other parts of the Sundown codebase. Without understanding the root cause I\u0026#39;m not comfortable upgrading, lest we accidentally introduce the bug that we\u0026#39;re currently not vulnerable to. Additionally, Sundown is deprecated, so if we were to upgrade it would be to Hoedown.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T18:26:32.780Z","updated_at":"2016-02-15T18:26:32.780Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":798869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok @whit537 I understand your point. Let me know if you plan to upgrade in future. ","markdown_message":"\u003cp\u003eOk \u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e I understand your point. Let me know if you plan to upgrade in future. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T18:42:02.755Z","updated_at":"2016-02-15T18:42:02.755Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1943359,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T13:28:46.278Z","updated_at":"2017-08-21T13:28:46.278Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}