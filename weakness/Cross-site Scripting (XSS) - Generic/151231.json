{"id":151231,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTEyMzE=","url":"https://hackerone.com/reports/151231","title":"Content-type sniffing leads to stored XSS in CMS Airship on Internet Explorer ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-13T22:59:29.698Z","submitted_at":"2016-07-13T22:59:29.698Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lukasreschke","url":"/lukasreschke","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-14T00:40:34.379Z","bug_reporter_agreed_on_going_public_at":"2016-07-14T00:40:34.208Z","team_member_agreed_on_going_public_at":"2016-07-14T00:40:24.235Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Description\nInternet Explorer has the nasty habit to perform Content-Type sniffing on delivered resources if the content-type is not known to it. Since the software isn't instructing Internet Explorer to disable content-type sniffing this leads to a stored XSS.  \n\nIn a nutshell, it is possible to trick Internet Explorer in executing arbitrary files. A more in-detail description about Internet Explorers' mimetype handling can be found at https://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx. Let's just phrase it as: The length to what Microsoft goes to guess the file content is insane.\n\n# Exploitation\nTo exploit this in this case we need to:\n\n- Craft the file in a way that Internet Explorer sniffs it's content\n- Control the file name delivered to Internet Explorer\n\nThis is actually a pretty easy thing to achieve, I've attached {F104817} which is a file with ZIP header that then contains a malicious HTML payload:\n\n{F104818}\n\nIt is now sufficient to upload the file as authenticated user and make another person using Internet Explorer make open the URL to said file. This will even work in IE 11 on Windows 8.1:\n\n{F104815}\n\n# Mitigation\nThe most reliable mitigation would be to use a sandboxed domain for user-uploaded content. So files would only be served from that origin and the Same-Origin-Policy would prevent this problem. \n\nSince this may not be possible in every case to enforce to users, setting the following headers in combination will mitigate content-type sniffing related problems:\n\n- `X-Content-Type-Options: nosniff` \n- `X-Download-Options: noopen` \n- `Content-Disposition: attachment; filename=\"filename.ext\"'`\n\nOne patch for [/src/Cabin/Hull/Landing/PublicFiles.php](https://github.com/paragonie/airship/blob/316a90803e6666befbee04c0a81d75abd0fc5319/src/Cabin/Hull/Landing/PublicFiles.php#L90) could look like the following:\n\n```\nFrom 42bc1760453fbfed004072929d99d9c397ab3f77 Mon Sep 17 00:00:00 2001\nFrom: Lukas Reschke \u003clukas@statuscode.ch\u003e\nDate: Thu, 14 Jul 2016 00:57:26 +0200\nSubject: [PATCH] Prevent Mime Sniffing in Internet Explorer\n\n---\n src/Cabin/Hull/Landing/PublicFiles.php | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a/src/Cabin/Hull/Landing/PublicFiles.php b/src/Cabin/Hull/Landing/PublicFiles.php\nindex 9fc9b1b..80ba6fa 100755\n--- a/src/Cabin/Hull/Landing/PublicFiles.php\n+++ b/src/Cabin/Hull/Landing/PublicFiles.php\n@@ -92,6 +92,9 @@ class PublicFiles extends LandingGear\n             }\n\n             // Serve the file\n+            \\header('Content-Disposition: attachment; filename=\"'.urlencode($fileData['filename']).'\"');\n+            \\header('X-Content-Type-Options: nosniff');\n+            \\header('X-Download-Options: noopen');\n             \\header('Content-Type: ' . $fileData['type']);\n             $this-\u003eairship_lens_object-\u003esendStandardHeaders($fileData['type']);\n             \\readfile($realPath);\n--\n2.7.4 (Apple Git-66)\n```\n\nThere may be other occurrences in the code that have the same issue. Generally speaking. There is no harm in adding the `X-Content-Type-Options: nosniff` header globally over the whole web application.\n\n---\n\nIn case you need testing VMs from Microsoft, you can get them from free at http://modern.ie","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eInternet Explorer has the nasty habit to perform Content-Type sniffing on delivered resources if the content-type is not known to it. Since the software isn\u0026#39;t instructing Internet Explorer to disable content-type sniffing this leads to a stored XSS.  \u003c/p\u003e\n\n\u003cp\u003eIn a nutshell, it is possible to trick Internet Explorer in executing arbitrary files. A more in-detail description about Internet Explorers\u0026#39; mimetype handling can be found at \u003ca title=\"https://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx\" href=\"/redirect?url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms775147%28v%3Dvs.85%29.aspx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://msdn.microsoft.com/en-us/library/ms775147(v=vs.85).aspx\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Let\u0026#39;s just phrase it as: The length to what Microsoft goes to guess the file content is insane.\u003c/p\u003e\n\n\u003ch1 id=\"exploitation\"\u003eExploitation\u003c/h1\u003e\n\n\u003cp\u003eTo exploit this in this case we need to:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCraft the file in a way that Internet Explorer sniffs it\u0026#39;s content\u003c/li\u003e\n\u003cli\u003eControl the file name delivered to Internet Explorer\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis is actually a pretty easy thing to achieve, I\u0026#39;ve attached \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"xss.html\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/817/94d2d4b53e09e4de708203458b6f0eee4aa967df/xss.html?response-content-disposition=attachment%3B%20filename%3D%22xss.html%22%3B%20filename%2A%3DUTF-8%27%27xss.html\u0026amp;response-content-type=application%2Fzip\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043309Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026amp;X-Amz-Signature=828544ee173f4642ea11f573da00ad368c69545ee801c9c76a15a3b7e9107d19\" data-attachment-type=\"application/zip\"\u003exss.html (F104817)\u003c/a\u003e which is a file with ZIP header that then contains a malicious HTML payload:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"payload-hex.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?response-content-disposition=attachment%3B%20filename%3D%22payload-hex.png%22%3B%20filename%2A%3DUTF-8%27%27payload-hex.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043309Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026amp;X-Amz-Signature=47c5534fbd5b0f88d839aadce134211932722b4b6dce5e256de7998fdcb10352\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?response-content-disposition=attachment%3B%20filename%3D%22payload-hex.png%22%3B%20filename%2A%3DUTF-8%27%27payload-hex.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043309Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026amp;X-Amz-Signature=47c5534fbd5b0f88d839aadce134211932722b4b6dce5e256de7998fdcb10352\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt is now sufficient to upload the file as authenticated user and make another person using Internet Explorer make open the URL to said file. This will even work in IE 11 on Windows 8.1:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"xss-in-action.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?response-content-disposition=attachment%3B%20filename%3D%22xss-in-action.png%22%3B%20filename%2A%3DUTF-8%27%27xss-in-action.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043309Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026amp;X-Amz-Signature=e2e2f8f13ca8c1073b8169250265d1f9548aafd3e3adfe44ba6a985503b0e090\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?response-content-disposition=attachment%3B%20filename%3D%22xss-in-action.png%22%3B%20filename%2A%3DUTF-8%27%27xss-in-action.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043309Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026amp;X-Amz-Signature=e2e2f8f13ca8c1073b8169250265d1f9548aafd3e3adfe44ba6a985503b0e090\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cp\u003eThe most reliable mitigation would be to use a sandboxed domain for user-uploaded content. So files would only be served from that origin and the Same-Origin-Policy would prevent this problem. \u003c/p\u003e\n\n\u003cp\u003eSince this may not be possible in every case to enforce to users, setting the following headers in combination will mitigate content-type sniffing related problems:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eX-Content-Type-Options: nosniff\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eX-Download-Options: noopen\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eContent-Disposition: attachment; filename=\u0026quot;filename.ext\u0026quot;\u0026#39;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOne patch for \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F316a90803e6666befbee04c0a81d75abd0fc5319%2Fsrc%2FCabin%2FHull%2FLanding%2FPublicFiles.php%23L90\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/src/Cabin/Hull/Landing/PublicFiles.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e could look like the following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003eFrom 42bc1760453fbfed004072929d99d9c397ab3f77 Mon Sep 17 00:00:00 2001\nFrom: Lukas Reschke \u0026lt;lukas@statuscode.ch\u0026gt;\nDate: Thu, 14 Jul 2016 00:57:26 +0200\nSubject: [PATCH] Prevent Mime Sniffing in Internet Explorer\n\u003c/span\u003e\n---\n src/Cabin/Hull/Landing/PublicFiles.php | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a/src/Cabin/Hull/Landing/PublicFiles.php b/src/Cabin/Hull/Landing/PublicFiles.php\n\u003cspan class=\"gh\"\u003eindex 9fc9b1b..80ba6fa 100755\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/src/Cabin/Hull/Landing/PublicFiles.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/src/Cabin/Hull/Landing/PublicFiles.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -92,6 +92,9 @@\u003c/span\u003e class PublicFiles extends LandingGear\n             }\n\n             // Serve the file\n\u003cspan class=\"gi\"\u003e+            \\header(\u0026#39;Content-Disposition: attachment; filename=\u0026quot;\u0026#39;.urlencode($fileData[\u0026#39;filename\u0026#39;]).\u0026#39;\u0026quot;\u0026#39;);\n+            \\header(\u0026#39;X-Content-Type-Options: nosniff\u0026#39;);\n+            \\header(\u0026#39;X-Download-Options: noopen\u0026#39;);\n\u003c/span\u003e             \\header(\u0026#39;Content-Type: \u0026#39; . $fileData[\u0026#39;type\u0026#39;]);\n             $this-\u0026gt;airship_lens_object-\u0026gt;sendStandardHeaders($fileData[\u0026#39;type\u0026#39;]);\n             \\readfile($realPath);\n\u003cspan class=\"gd\"\u003e--\n\u003c/span\u003e\u003cspan class=\"p\"\u003e2.7.4 (Apple Git-66)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThere may be other occurrences in the code that have the same issue. Generally speaking. There is no harm in adding the \u003ccode\u003eX-Content-Type-Options: nosniff\u003c/code\u003e header globally over the whole web application.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eIn case you need testing VMs from Microsoft, you can get them from free at \u003ca title=\"http://modern.ie\" href=\"/redirect?url=http%3A%2F%2Fmodern.ie\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://modern.ie\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":104815,"file_name":"xss-in-action.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/815/fc726415281b370aacb0ab3a872965cae8a4a9fa/xss-in-action.png?response-content-disposition=attachment%3B%20filename%3D%22xss-in-action.png%22%3B%20filename%2A%3DUTF-8%27%27xss-in-action.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043309Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=e2e2f8f13ca8c1073b8169250265d1f9548aafd3e3adfe44ba6a985503b0e090","file_size":73819,"type":"image/png"},{"id":104817,"file_name":"xss.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/817/94d2d4b53e09e4de708203458b6f0eee4aa967df/xss.html?response-content-disposition=attachment%3B%20filename%3D%22xss.html%22%3B%20filename%2A%3DUTF-8%27%27xss.html\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043309Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=828544ee173f4642ea11f573da00ad368c69545ee801c9c76a15a3b7e9107d19","file_size":281,"type":"application/zip"},{"id":104818,"file_name":"payload-hex.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/818/e16132682bcfe9eac608b67a992758aaea0966be/payload-hex.png?response-content-disposition=attachment%3B%20filename%3D%22payload-hex.png%22%3B%20filename%2A%3DUTF-8%27%27payload-hex.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043309Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=47c5534fbd5b0f88d839aadce134211932722b4b6dce5e256de7998fdcb10352","file_size":331502,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-13T00:40:24.334Z","allow_singular_disclosure_after":-138167565.53536525,"singular_disclosure_allowed":true,"vote_count":15,"voters":["lukasreschke","rubyroobs","wkcaj","spam404","ras-it","skansing","xsam","xiaoyinl","tbehroz","gopi","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1067876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report. Given that this only affects one browser, I'm inclined to say \"this isn't a vulnerability in Airship, this is a vulnerability in Internet Explorer\".","markdown_message":"\u003cp\u003eThanks for the report. Given that this only affects one browser, I\u0026#39;m inclined to say \u0026quot;this isn\u0026#39;t a vulnerability in Airship, this is a vulnerability in Internet Explorer\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-13T23:02:07.095Z","updated_at":"2016-07-13T23:02:07.095Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1067880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e  I'm inclined to say \"this isn't a vulnerability in Airship, this is a vulnerability in Internet Explorer\".\n\nThat probably depends on your definition of vulnerability. Most people (including MITRE) will go with something along the lines of: If it is documented behaviour then it's not a vulnerability.\n\nIn this case, this is clearly documented behaviour by Microsoft and it is common practice to protect against it.\n\nJust check the Wordpress source code as example: https://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780 or the one from Drupal: https://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116 or just about every other widely deployed PHP software\n\nConsidering something not a vulnerability while also praising [oneself to be more secure than Wordpress](https://paragonie.com/blog/2016/06/php-security-platinum-standard-raising-bar-cms-airship) is a rather questionable thing from my opinion then.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eI\u0026#39;m inclined to say \u0026quot;this isn\u0026#39;t a vulnerability in Airship, this is a vulnerability in Internet Explorer\u0026quot;.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat probably depends on your definition of vulnerability. Most people (including MITRE) will go with something along the lines of: If it is documented behaviour then it\u0026#39;s not a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eIn this case, this is clearly documented behaviour by Microsoft and it is common practice to protect against it.\u003c/p\u003e\n\n\u003cp\u003eJust check the Wordpress source code as example: \u003ca title=\"https://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWordPress%2FWordPress%2Fblob%2F3a7137a7a554e0883ddc1b13389899907c5a85d2%2Fwp-includes%2Ffunctions.php%23L4770-L4780\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WordPress/WordPress/blob/3a7137a7a554e0883ddc1b13389899907c5a85d2/wp-includes/functions.php#L4770-L4780\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or the one from Drupal: \u003ca title=\"https://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdrupal%2Fdrupal%2Fblob%2F3e04617d2e6ecd9c87f9c23593179aa84eb6f002%2Fcore%2Flib%2FDrupal%2FCore%2FEventSubscriber%2FFinishResponseSubscriber.php%23L112-L116\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/drupal/drupal/blob/3e04617d2e6ecd9c87f9c23593179aa84eb6f002/core/lib/Drupal/Core/EventSubscriber/FinishResponseSubscriber.php#L112-L116\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or just about every other widely deployed PHP software\u003c/p\u003e\n\n\u003cp\u003eConsidering something not a vulnerability while also praising \u003ca href=\"/redirect?url=https%3A%2F%2Fparagonie.com%2Fblog%2F2016%2F06%2Fphp-security-platinum-standard-raising-bar-cms-airship\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eoneself to be more secure than Wordpress\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is a rather questionable thing from my opinion then.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-13T23:07:35.917Z","updated_at":"2016-07-13T23:08:08.657Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1067920,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The reason for my personal inclination is that this misbehavior exclusively impacts a Microsoft product.\n\nDocumented or otherwise, this doesn't happen in Firefox, Chrome, Safari, Opera, or any of the minority web browsers. Given that we already make no pains to support any version of IE (to the point of using jQuery 3.x instead of 1.x), paying a bug bounty for an IE-only bug would set an odd precedent that I'm not comfortable committing to.\n\nIn the same avenue, Content-Security-Policy headers aren't supported by Internet Explorer either. Does that defiicit qualify as an \"XSS mitigation bypass\" vulnerability in CMS Airship?\n\nTo be clear: I'm not saying I won't apply the suggested patch. I'm just not willing to accept responsibility for a deficit in the design or implementation of a multi-billion dollar company's product (even if they documented it). Especially not if it means paying a bug bounty for a problem they created, whilst said company isn't one of my clients.\n\nTo the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?","markdown_message":"\u003cp\u003eThe reason for my personal inclination is that this misbehavior exclusively impacts a Microsoft product.\u003c/p\u003e\n\n\u003cp\u003eDocumented or otherwise, this doesn\u0026#39;t happen in Firefox, Chrome, Safari, Opera, or any of the minority web browsers. Given that we already make no pains to support any version of IE (to the point of using jQuery 3.x instead of 1.x), paying a bug bounty for an IE-only bug would set an odd precedent that I\u0026#39;m not comfortable committing to.\u003c/p\u003e\n\n\u003cp\u003eIn the same avenue, Content-Security-Policy headers aren\u0026#39;t supported by Internet Explorer either. Does that defiicit qualify as an \u0026quot;XSS mitigation bypass\u0026quot; vulnerability in CMS Airship?\u003c/p\u003e\n\n\u003cp\u003eTo be clear: I\u0026#39;m not saying I won\u0026#39;t apply the suggested patch. I\u0026#39;m just not willing to accept responsibility for a deficit in the design or implementation of a multi-billion dollar company\u0026#39;s product (even if they documented it). Especially not if it means paying a bug bounty for a problem they created, whilst said company isn\u0026#39;t one of my clients.\u003c/p\u003e\n\n\u003cp\u003eTo the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-14T00:07:41.401Z","updated_at":"2016-07-14T00:07:41.401Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1067943,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e In the same avenue, Content-Security-Policy headers aren't supported by Internet Explorer either. Does that defiicit qualify as an \"XSS mitigation bypass\" vulnerability in CMS Airship?\n\nThere certainly is a difference between \"unsupported hardening feature\" and \"widely known implementation detail\". This vulnerability being part of the latter.\n\nAlso certainly there is another big difference between a mitigation bypass and an actual vulnerability, such as this XSS.\n\n\u003e To the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?\n\nThe flaw itself isn't really \"exclusively-IE\". It's just the easiest to exploit in IE and the mitigation measures are pretty similar. Plus the bounties amount aren't that gigantic here that I'd dig into every small bug for hours. (especially since I donate all my bounties, so there is no real personal benefit here…)\n\nBut if we want to play the \"Let's prove that this is really bad\" game, then I'm happy to do that. ;-)\n\nSince you're missing the \"Content-Disposition\" header this can also be abused for a generic XSS attack using Flash. Of course, you should be able to say now \"Oh! But this is another thing I don't have influence on! I don't consider this a vulnerability per se\". But then again please tell your users that you don't care about any XSS attack vectors. Every software that handles user data securely will set these headers.\n\nA super easy way to reproduce is using https://github.com/nccgroup/CrossSiteContentHijacking\n\n1. Upload http://0me.me/ContentHijacking/objects/ContentHijacking.swf\n2. Configure links to the SWF and your Target Page in http://15.rs/ContentHijacking/ContentHijackingLoader.html\n3. Press retrieve content, or check the attachment\n\nThis will also work in the newest Chrome. Writing and compiling a Flash file that is doing all this automatically and executes arbitrary JS is left as exercise to the reader ;-)\n\n… and also there you will find the mitigation advice:\n\n\u003e Adding the \"Content-Disposition: Attachment\" and \"X-Content-Type-Options: nosniff\" headers to the response of static files will secure the website against Flash or PDF-based cross-site content-hijacking attacks. It is recommended that this practice be performed for all of the files that users need to download in all the modules that deal with a file download. Although this method does not fully secure the website against attacks using Silverlight or similar objects, it can mitigate the risk of using Adobe Flash and PDF objects, especially when uploading PDF files is permitted.\n","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eIn the same avenue, Content-Security-Policy headers aren\u0026#39;t supported by Internet Explorer either. Does that defiicit qualify as an \u0026quot;XSS mitigation bypass\u0026quot; vulnerability in CMS Airship?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThere certainly is a difference between \u0026quot;unsupported hardening feature\u0026quot; and \u0026quot;widely known implementation detail\u0026quot;. This vulnerability being part of the latter.\u003c/p\u003e\n\n\u003cp\u003eAlso certainly there is another big difference between a mitigation bypass and an actual vulnerability, such as this XSS.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eTo the best of your knowledge: is this design flaw present in Microsoft Edge too? Or is it an exclusively-IE bug, not just a Microsoft product bug?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe flaw itself isn\u0026#39;t really \u0026quot;exclusively-IE\u0026quot;. It\u0026#39;s just the easiest to exploit in IE and the mitigation measures are pretty similar. Plus the bounties amount aren\u0026#39;t that gigantic here that I\u0026#39;d dig into every small bug for hours. (especially since I donate all my bounties, so there is no real personal benefit here…)\u003c/p\u003e\n\n\u003cp\u003eBut if we want to play the \u0026quot;Let\u0026#39;s prove that this is really bad\u0026quot; game, then I\u0026#39;m happy to do that. ;-)\u003c/p\u003e\n\n\u003cp\u003eSince you\u0026#39;re missing the \u0026quot;Content-Disposition\u0026quot; header this can also be abused for a generic XSS attack using Flash. Of course, you should be able to say now \u0026quot;Oh! But this is another thing I don\u0026#39;t have influence on! I don\u0026#39;t consider this a vulnerability per se\u0026quot;. But then again please tell your users that you don\u0026#39;t care about any XSS attack vectors. Every software that handles user data securely will set these headers.\u003c/p\u003e\n\n\u003cp\u003eA super easy way to reproduce is using \u003ca title=\"https://github.com/nccgroup/CrossSiteContentHijacking\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnccgroup%2FCrossSiteContentHijacking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nccgroup/CrossSiteContentHijacking\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUpload \u003ca title=\"http://0me.me/ContentHijacking/objects/ContentHijacking.swf\" href=\"/redirect?url=http%3A%2F%2F0me.me%2FContentHijacking%2Fobjects%2FContentHijacking.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0me.me/ContentHijacking/objects/ContentHijacking.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eConfigure links to the SWF and your Target Page in \u003ca title=\"http://15.rs/ContentHijacking/ContentHijackingLoader.html\" href=\"/redirect?url=http%3A%2F%2F15.rs%2FContentHijacking%2FContentHijackingLoader.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://15.rs/ContentHijacking/ContentHijackingLoader.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ePress retrieve content, or check the attachment\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis will also work in the newest Chrome. Writing and compiling a Flash file that is doing all this automatically and executes arbitrary JS is left as exercise to the reader ;-)\u003c/p\u003e\n\n\u003cp\u003e… and also there you will find the mitigation advice:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAdding the \u0026quot;Content-Disposition: Attachment\u0026quot; and \u0026quot;X-Content-Type-Options: nosniff\u0026quot; headers to the response of static files will secure the website against Flash or PDF-based cross-site content-hijacking attacks. It is recommended that this practice be performed for all of the files that users need to download in all the modules that deal with a file download. Although this method does not fully secure the website against attacks using Silverlight or similar objects, it can mitigate the risk of using Adobe Flash and PDF objects, especially when uploading PDF files is permitted.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2016-07-14T00:35:55.211Z","updated_at":"2016-07-14T00:37:32.117Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":104827,"filename":"2016-07-14_02-33-15.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/827/7572baeb9b45eac66e6fc165eb53ed0941cce10a/2016-07-14_02-33-15.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-14_02-33-15.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-14_02-33-15.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043309Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=6e414849386cca04da6fcae449fee8a4c380d70e06e971365e5114b61a7058f6"}],"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1067946,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"See https://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c (I'm leaving the commit unlocked for public comment, since the public cannot comment on H1 issues, even when published under full disclosure.)","markdown_message":"\u003cp\u003eSee \u003ca title=\"https://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2Fdf20edff8794f6b36047422ec97daeed844b1b7c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/df20edff8794f6b36047422ec97daeed844b1b7c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (I\u0026#39;m leaving the commit unlocked for public comment, since the public cannot comment on H1 issues, even when published under full disclosure.)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-14T00:40:02.330Z","updated_at":"2016-07-14T00:40:02.330Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lukasreschke","url":"/lukasreschke"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1067949,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-14T00:40:24.262Z","updated_at":"2016-07-14T00:40:24.262Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1067950,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-14T00:40:34.301Z","updated_at":"2016-07-14T00:40:34.301Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1067951,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-14T00:40:34.430Z","updated_at":"2016-07-14T00:40:34.430Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1067972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"THX for applying the patch upstream.","markdown_message":"\u003cp\u003eTHX for applying the patch upstream.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-14T01:00:06.477Z","updated_at":"2016-07-14T01:00:06.477Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1067981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for providing the patch. :)","markdown_message":"\u003cp\u003eThanks for providing the patch. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-14T01:11:18.110Z","updated_at":"2016-07-14T01:11:18.110Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1653870,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"HackerOne changed its workflow a little; setting an award (or marking an issue as ineligible) is now mandatory.","markdown_message":"\u003cp\u003eHackerOne changed its workflow a little; setting an award (or marking an issue as ineligible) is now mandatory.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T14:26:27.849Z","updated_at":"2017-05-04T14:26:27.849Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Paragon Initiative Enterprises"}},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}