{"id":129862,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjk4NjI=","url":"https://hackerone.com/reports/129862","title":"Stored XSS on [your_zendesk].zendesk.com in Facebook Channel","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-11T16:27:13.292Z","submitted_at":"2016-04-11T16:27:13.292Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-01T21:16:03.496Z","bug_reporter_agreed_on_going_public_at":"2016-05-30T12:42:28.011Z","team_member_agreed_on_going_public_at":"2016-06-01T21:16:03.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have found a stored XSS in the Facebook Channel options at ```https://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth```.\n\nThe XSS is a result of improperly escaping Facebook Page names.\n\nSteps to reproduce\n-------------------------\n\n1. Create a facebook page with the following title/page name:\n\n    ```Foobar\" onmouseover=location\u0026#x3d;'javascript:alert\\x28document.domain\\x29'```\n\n    (I had to play around with this a bit to get it working correctly as Facebook has strict policies on the page name. If the page already exists, try to replace `Foobar` with any other random string)\n2. Create your own zendesk account and then go to ```https://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth``` to add a facebook page.\n3. After adding the page created in Step 1, hover over the \"Unlink\" button to trigger the XSS. See also attached screenshot.\n\nAttack scenario\n--------------------\nObviously anyone with the permissions to add facebook pages can trigger this stored XSS and attack the admins with the usual XSS attacks. \n\n","vulnerability_information_html":"\u003cp\u003eI have found a stored XSS in the Facebook Channel options at \u003ccode\u003ehttps://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe XSS is a result of improperly escaping Facebook Page names.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a facebook page with the following title/page name:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eFoobar\u0026quot; onmouseover=location\u0026amp;#x3d;\u0026#39;javascript:alert\\x28document.domain\\x29\u0026#39;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e(I had to play around with this a bit to get it working correctly as Facebook has strict policies on the page name. If the page already exists, try to replace \u003ccode\u003eFoobar\u003c/code\u003e with any other random string)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCreate your own zendesk account and then go to \u003ccode\u003ehttps://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth\u003c/code\u003e to add a facebook page.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAfter adding the page created in Step 1, hover over the \u0026quot;Unlink\u0026quot; button to trigger the XSS. See also attached screenshot.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"attack-scenario\"\u003eAttack scenario\u003c/h2\u003e\n\n\u003cp\u003eObviously anyone with the permissions to add facebook pages can trigger this stored XSS and attack the admins with the usual XSS attacks. \u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":84649,"file_name":"zendesk_stored_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/084/649/55a3ee1b8ccb74fa058764a08b5c515c11245c1a/zendesk_stored_xss.png?response-content-disposition=attachment%3B%20filename%3D%22zendesk_stored_xss.png%22%3B%20filename%2A%3DUTF-8%27%27zendesk_stored_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042429Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=a4f71508d9e7c401911f912425167289ba6f38cfddfa28e8ec3cbcba348bbb53","file_size":50312,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["fantam1","spetr0x","anik","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":899743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @eboda,\n\nThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/eboda\"\u003e@eboda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-11T17:03:49.685Z","updated_at":"2016-04-11T17:03:49.685Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912264,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @eboda,\n\nCongratulations! Your submitted vulnerability has been validated and is in process for remediation. You will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nThis was a good find and a creative exploit. Unfortunately because the channels settings page is restricted to admins, the risk of the vulnerability decreases considerably.Furthermore, as mentioned in our bug bounty program we award based on risk. \n\nHaving said that, we enjoyed reading your report and would like to extend an invite into our private bug-bounty program for [BIME](https://hackerone.com/bime). Happy Hacking!\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/eboda\"\u003e@eboda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCongratulations! Your submitted vulnerability has been validated and is in process for remediation. You will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \u003c/p\u003e\n\n\u003cp\u003eThis was a good find and a creative exploit. Unfortunately because the channels settings page is restricted to admins, the risk of the vulnerability decreases considerably.Furthermore, as mentioned in our bug bounty program we award based on risk. \u003c/p\u003e\n\n\u003cp\u003eHaving said that, we enjoyed reading your report and would like to extend an invite into our private bug-bounty program for \u003ca href=\"https://hackerone.com/bime\"\u003eBIME\u003c/a\u003e. Happy Hacking!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T16:40:29.951Z","updated_at":"2016-04-18T16:40:29.951Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912266,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-18T16:40:40.991Z","updated_at":"2016-04-18T16:40:40.991Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zendesk @noops43 ,\n\nThanks for the bounty and the invite to your private program!\n\nYeah I realize its implied risk is very low, but I didn't see a way to exploit it further and thought I would just report it as is.\n\nBest of luck to you!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zendesk\"\u003e@zendesk\u003c/a\u003e \u003ca href=\"/noops43\"\u003e@noops43\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThanks for the bounty and the invite to your private program!\u003c/p\u003e\n\n\u003cp\u003eYeah I realize its implied risk is very low, but I didn\u0026#39;t see a way to exploit it further and thought I would just report it as is.\u003c/p\u003e\n\n\u003cp\u003eBest of luck to you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T19:03:53.798Z","updated_at":"2016-04-18T19:03:53.798Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":933253,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zendesk @noops43 ,\nI noticed, that this bug is fixed now. Could you mark this issue as resolved?\n\nI would like to submit some bugs to @BIME, but I don't have yet 5 resolved reports, so my Signal calculation is \"pending\" and hence I don't meet the minimum requirement of having a Signal \u003e 1.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zendesk\"\u003e@zendesk\u003c/a\u003e \u003ca href=\"/noops43\"\u003e@noops43\u003c/a\u003e ,\u003cbr\u003e\nI noticed, that this bug is fixed now. Could you mark this issue as resolved?\u003c/p\u003e\n\n\u003cp\u003eI would like to submit some bugs to \u003ca href=\"/bime\"\u003e@BIME\u003c/a\u003e, but I don\u0026#39;t have yet 5 resolved reports, so my Signal calculation is \u0026quot;pending\u0026quot; and hence I don\u0026#39;t meet the minimum requirement of having a Signal \u0026gt; 1.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-29T08:50:14.441Z","updated_at":"2016-04-29T08:50:14.441Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":961931,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @eboda,\n\nYour submitted issue has been remediated. Thank you for participating in the [Zendesk Bug Bounty program](https://hackerone.com/zendesk). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/eboda\"\u003e@eboda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour submitted issue has been remediated. Thank you for participating in the \u003ca href=\"https://hackerone.com/zendesk\"\u003eZendesk Bug Bounty program\u003c/a\u003e. Please feel free to reach out if you have any questions or concerns.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T18:59:10.339Z","updated_at":"2016-05-17T18:59:10.339Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":990785,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Do you mind disclosing?","markdown_message":"\u003cp\u003eDo you mind disclosing?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-30T12:42:28.062Z","updated_at":"2016-05-30T12:42:28.062Z","first_to_agree":true,"actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995682,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T21:16:03.445Z","updated_at":"2016-06-01T21:16:03.445Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995683,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T21:16:03.517Z","updated_at":"2016-06-01T21:16:03.517Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}