{"id":339483,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzk0ODM=","url":"https://hackerone.com/reports/339483","title":"\"Bad Protocols Validation\" Bypass in \"wp_kses_bad_protocol_once\" using HTML-encoding without trailing semicolons","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-04-17T10:31:53.400Z","submitted_at":"2018-04-17T10:31:53.400Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"irsdl","url":"/irsdl","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-16T20:06:36.629Z","bug_reporter_agreed_on_going_public_at":"2019-10-17T20:06:35.775Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description:\nThe wp_kses_bad_protocol_once function (https://developer.wordpress.org/reference/functions/wp_kses_bad_protocol_once/) is used to sanitise content from bad protocols and other characters. It detects the protocol (URI scheme) by using the first colon character. It compares the identified protocol with a list of good protocols to ensure it is safe. \n\nAs this function is used to parse HTML-encoded attributes as well, it also uses HTML-encoded variants of the colon character as shown below:\n```\n   $string2 = preg_split( '/:|\u0026#0*58;|\u0026#x0*3a;/i', $string, 2 );\n```\n\nHowever, the above function is flawed as it does not include HTML-encoded parameters that do not use a semicolon character afterwards. See \"Decimal HTML character references without trailing semicolons\" and \"Hexadecimal HTML character references without trailing semicolons\" at https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet for more information about the issue.\n\nThe following HTML code shows an example that can bypass the wp_kses_bad_protocol_once validation (see it in action at https://jsfiddle.net/x103n1f7/1/):\n```\n\u003ca href=\"javascript\u0026#58alert(document.domain)\"\u003eJS - Numerical Entities\u003c/a\u003e\n\u003ca href=\"javascript\u0026#x3ax=1;alert(document.domain)\"\u003eJS - Hex Entities\u003c/a\u003e\n```\n\nThe following fix is suggested by adding one line of code at the first line of the wp_kses_bad_protocol_once function to add a semicolon character after the html-encoded variants of the colon character when it is missing. The function will look like this:\n\n```\nfunction wp_kses_bad_protocol_once($string, $allowed_protocols, $count = 1 ) {\n///////////////// suggested fix starts here\n    $string = preg_replace( '/(\u0026#0*58(?![;0-9])|\u0026#x0*3a(?![;a-f0-9]))/i' , \"$1;\" , $string );\n///////////////// suggested fix ends here\n    $string2 = preg_split( '/:|\u0026#0*58;|\u0026#x0*3a;/i', $string, 2 );\n    if ( isset($string2[1]) \u0026\u0026 ! preg_match('%/\\?%', $string2[0]) ) {\n        $string = trim( $string2[1] );\n        $protocol = wp_kses_bad_protocol_once2( $string2[0], $allowed_protocols );\n        if ( 'feed:' == $protocol ) {\n            if ( $count \u003e 2 )\n                return '';\n            $string = wp_kses_bad_protocol_once( $string, $allowed_protocols, ++$count );\n            if ( empty( $string ) )\n                return $string;\n        }\n        $string = $protocol . $string;\n    }\n \n    return $string;\n}\n```\n\n## Impact\n\nThis can lead to reflected or stored cross-site scripting attacks for the core or the modules that only rely on this function for the validation.","vulnerability_information_html":"\u003cp\u003eDescription:\u003cbr\u003e\nThe wp_kses_bad_protocol_once function (\u003ca title=\"https://developer.wordpress.org/reference/functions/wp_kses_bad_protocol_once/\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.wordpress.org%2Freference%2Ffunctions%2Fwp_kses_bad_protocol_once%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.wordpress.org/reference/functions/wp_kses_bad_protocol_once/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) is used to sanitise content from bad protocols and other characters. It detects the protocol (URI scheme) by using the first colon character. It compares the identified protocol with a list of good protocols to ensure it is safe. \u003c/p\u003e\n\n\u003cp\u003eAs this function is used to parse HTML-encoded attributes as well, it also uses HTML-encoded variants of the colon character as shown below:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e   $string2 = preg_split( \u0026#39;/:|\u0026amp;#0*58;|\u0026amp;#x0*3a;/i\u0026#39;, $string, 2 );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, the above function is flawed as it does not include HTML-encoded parameters that do not use a semicolon character afterwards. See \u0026quot;Decimal HTML character references without trailing semicolons\u0026quot; and \u0026quot;Hexadecimal HTML character references without trailing semicolons\u0026quot; at \u003ca title=\"https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FXSS_Filter_Evasion_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for more information about the issue.\u003c/p\u003e\n\n\u003cp\u003eThe following HTML code shows an example that can bypass the wp_kses_bad_protocol_once validation (see it in action at \u003ca title=\"https://jsfiddle.net/x103n1f7/1/):\" href=\"/redirect?url=https%3A%2F%2Fjsfiddle.net%2Fx103n1f7%2F1%2F%29%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://jsfiddle.net/x103n1f7/1/):\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;a href=\u0026quot;javascript\u0026amp;#58alert(document.domain)\u0026quot;\u0026gt;JS - Numerical Entities\u0026lt;/a\u0026gt;\n\u0026lt;a href=\u0026quot;javascript\u0026amp;#x3ax=1;alert(document.domain)\u0026quot;\u0026gt;JS - Hex Entities\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following fix is suggested by adding one line of code at the first line of the wp_kses_bad_protocol_once function to add a semicolon character after the html-encoded variants of the colon character when it is missing. The function will look like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction wp_kses_bad_protocol_once($string, $allowed_protocols, $count = 1 ) {\n///////////////// suggested fix starts here\n    $string = preg_replace( \u0026#39;/(\u0026amp;#0*58(?![;0-9])|\u0026amp;#x0*3a(?![;a-f0-9]))/i\u0026#39; , \u0026quot;$1;\u0026quot; , $string );\n///////////////// suggested fix ends here\n    $string2 = preg_split( \u0026#39;/:|\u0026amp;#0*58;|\u0026amp;#x0*3a;/i\u0026#39;, $string, 2 );\n    if ( isset($string2[1]) \u0026amp;\u0026amp; ! preg_match(\u0026#39;%/\\?%\u0026#39;, $string2[0]) ) {\n        $string = trim( $string2[1] );\n        $protocol = wp_kses_bad_protocol_once2( $string2[0], $allowed_protocols );\n        if ( \u0026#39;feed:\u0026#39; == $protocol ) {\n            if ( $count \u0026gt; 2 )\n                return \u0026#39;\u0026#39;;\n            $string = wp_kses_bad_protocol_once( $string, $allowed_protocols, ++$count );\n            if ( empty( $string ) )\n                return $string;\n        }\n        $string = $protocol . $string;\n    }\n\n    return $string;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis can lead to reflected or stored cross-site scripting attacks for the core or the modules that only rely on this function for the validation.\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-16T20:06:35.822Z","allow_singular_disclosure_after":-35285526.10489429,"singular_disclosure_allowed":true,"vote_count":34,"voters":["foobar7","bl4de","mik317","sameerphad72","mygf","moblig","enesdexh1","sudi","zayn1337","khizer47","and 24 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":2750,"asset_type":"SOURCE_CODE","asset_identifier":"WordPress Core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2659799,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was wondering if you have any update on this please?","markdown_message":"\u003cp\u003eI was wondering if you have any update on this please?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T13:31:53.230Z","updated_at":"2018-04-24T13:31:53.230Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2680168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks so much for your responsible disclosure and clear report, @irsdl.\n\nYour report looks valid at first glance. We'll do some testing and let you know if we need any further details from you!\n\nJohn","markdown_message":"\u003cp\u003eThanks so much for your responsible disclosure and clear report, \u003ca href=\"/irsdl\"\u003e@irsdl\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eYour report looks valid at first glance. We\u0026#39;ll do some testing and let you know if we need any further details from you!\u003c/p\u003e\n\n\u003cp\u003eJohn\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T15:23:30.216Z","updated_at":"2018-04-30T15:23:30.216Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2682202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@johnbillion Thanks for picking this up. I did not want to push my solution to the repository as it was a security issue. ","markdown_message":"\u003cp\u003e\u003ca href=\"/johnbillion\"\u003e@johnbillion\u003c/a\u003e Thanks for picking this up. I did not want to push my solution to the repository as it was a security issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T19:09:46.577Z","updated_at":"2018-04-30T19:09:46.577Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2701374,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Sorry about the delay, I've confirm that this is valid and will be testing your suggested fix today.","markdown_message":"\u003cp\u003eSorry about the delay, I\u0026#39;ve confirm that this is valid and will be testing your suggested fix today.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-04T17:46:52.560Z","updated_at":"2018-05-04T17:46:52.560Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2714201,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@voldemortensen Hi, any chance you might have an update for me? It would be great to know whether my recommended fix will be part of WP.","markdown_message":"\u003cp\u003e\u003ca href=\"/voldemortensen\"\u003e@voldemortensen\u003c/a\u003e Hi, any chance you might have an update for me? It would be great to know whether my recommended fix will be part of WP.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-08T09:12:55.087Z","updated_at":"2018-05-08T09:12:55.087Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2780825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@voldemortensen @johnbillion Hey guys, do you have any updates for me?\n","markdown_message":"\u003cp\u003e\u003ca href=\"/voldemortensen\"\u003e@voldemortensen\u003c/a\u003e \u003ca href=\"/johnbillion\"\u003e@johnbillion\u003c/a\u003e Hey guys, do you have any updates for me?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-22T21:07:31.002Z","updated_at":"2018-05-22T21:07:31.002Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2926200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@voldemortensen @johnbillion I haven't had any updates from you in a while. Did you test my code? this one should be an easy one to be shipped to live IMHO.","markdown_message":"\u003cp\u003e\u003ca href=\"/voldemortensen\"\u003e@voldemortensen\u003c/a\u003e \u003ca href=\"/johnbillion\"\u003e@johnbillion\u003c/a\u003e I haven\u0026#39;t had any updates from you in a while. Did you test my code? this one should be an easy one to be shipped to live IMHO.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-23T21:58:49.700Z","updated_at":"2018-06-23T21:58:49.700Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3101307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anything?","markdown_message":"\u003cp\u003eAnything?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-26T15:30:53.141Z","updated_at":"2018-07-26T15:30:53.141Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3186031,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Hi,\nI have found this very disrespectful that they are not replying to any of my messages whilst I have provided them with the issue as well as the code that fix it. They could just test it and report back as it was just one line change.\n\nAnyway, I think it is time to escalate this as this simple issue needs fixing.\n\nThanks\nSoroush","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI have found this very disrespectful that they are not replying to any of my messages whilst I have provided them with the issue as well as the code that fix it. They could just test it and report back as it was just one line change.\u003c/p\u003e\n\n\u003cp\u003eAnyway, I think it is time to escalate this as this simple issue needs fixing.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nSoroush\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-13T07:58:32.468Z","updated_at":"2018-08-13T07:58:32.468Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4583013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would like to share this post publicly and perhaps send a pull request to the repository as I had provided the fix already. Please let me know if there is any issues. If I don't hear anything back by next week, I consider it as a positive sign that I am allowed to share its details publicly.","markdown_message":"\u003cp\u003eI would like to share this post publicly and perhaps send a pull request to the repository as I had provided the fix already. Please let me know if there is any issues. If I don\u0026#39;t hear anything back by next week, I consider it as a positive sign that I am allowed to share its details publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T10:57:10.923Z","updated_at":"2019-04-17T10:59:58.916Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4829641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Soroush, I apologize that we didn't respond to your repeated requests for an update, we really dropped the ball there :(\n\nI appreciate that you provided a patch, how patiently you waited, that you gave us a heads up that you were planning to post it publicly, and that you waited even longer than you said you would before opening the public ticket. \n\nOur team is small and mostly comprised of volunteers, and we're currently struggling to stay on top of everything, but that's no excuse, we messed up, and I apologize.\n\nI've added this report to an internal list of tickets which need more attention, but unfortunately I can't give an ETA on when we'll be able to resolve it, since we also have higher-severity tickets that we're focusing on as well. I know that's not what you were hoping to hear, but unfortunately it's the best that I can do for now. We're making progress on ways that we can be more effective as a team, but there's still a lot of work ahead of us.","markdown_message":"\u003cp\u003eHi Soroush, I apologize that we didn\u0026#39;t respond to your repeated requests for an update, we really dropped the ball there :(\u003c/p\u003e\n\n\u003cp\u003eI appreciate that you provided a patch, how patiently you waited, that you gave us a heads up that you were planning to post it publicly, and that you waited even longer than you said you would before opening the public ticket. \u003c/p\u003e\n\n\u003cp\u003eOur team is small and mostly comprised of volunteers, and we\u0026#39;re currently struggling to stay on top of everything, but that\u0026#39;s no excuse, we messed up, and I apologize.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve added this report to an internal list of tickets which need more attention, but unfortunately I can\u0026#39;t give an ETA on when we\u0026#39;ll be able to resolve it, since we also have higher-severity tickets that we\u0026#39;re focusing on as well. I know that\u0026#39;s not what you were hoping to hear, but unfortunately it\u0026#39;s the best that I can do for now. We\u0026#39;re making progress on ways that we can be more effective as a team, but there\u0026#39;s still a lot of work ahead of us.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-13T17:25:12.081Z","updated_at":"2019-05-13T17:25:12.081Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4895443,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-21T16:45:35.888Z","updated_at":"2019-05-21T16:45:35.888Z","actor":{"username":"raamdev","cleared":false,"url":"/raamdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/595/af620efc09c8c516b1fd8ebbcee541b68d62618c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5643394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there @irsdl,\n\nWe haven't forgotten about you and would like your feedback on the following patch. This is largely using the code suggestion that you provided, with some expanded testing.\n\nCould you let us know if there are any other ways around this issue that you can find?\n\nCheers,\n\n@whyisjake","markdown_message":"\u003cp\u003eHey there \u003ca href=\"/irsdl\"\u003e@irsdl\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe haven\u0026#39;t forgotten about you and would like your feedback on the following patch. This is largely using the code suggestion that you provided, with some expanded testing.\u003c/p\u003e\n\n\u003cp\u003eCould you let us know if there are any other ways around this issue that you can find?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/whyisjake\"\u003e@whyisjake\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T21:25:52.336Z","updated_at":"2019-08-22T21:25:52.336Z","actor":{"username":"whyisjake","cleared":false,"url":"/whyisjake","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/499/942/de8d53f71535e9531105209e14875727a9e88cfe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":562642,"filename":"338.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/c2q1Bu8MfxuXp3w3osCqAf5z?response-content-disposition=attachment%3B%20filename%3D%22338.diff%22%3B%20filename%2A%3DUTF-8%27%27338.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053842Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=125f5195a0f1486de1d768c5c55aa379c81e66f22c20e481b04f4809e34543a7"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5657364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @whyisjake \nI will try to find time to have a look at this but as I am on holiday right now, it may take while.\n\nCheers\nSoroush","markdown_message":"\u003cp\u003eHi \u003ca href=\"/whyisjake\"\u003e@whyisjake\u003c/a\u003e \u003cbr\u003e\nI will try to find time to have a look at this but as I am on holiday right now, it may take while.\u003c/p\u003e\n\n\u003cp\u003eCheers\u003cbr\u003e\nSoroush\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-24T18:36:58.962Z","updated_at":"2019-08-24T18:36:58.962Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5669974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there @irsdl,\n\nSounds good. We have an upcoming release that we'd like to bundle this issue with. Do you have a preference for how you'd like to be credited in the release?\n\nCheers,\n\n@whisjake","markdown_message":"\u003cp\u003eHey there \u003ca href=\"/irsdl\"\u003e@irsdl\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSounds good. We have an upcoming release that we\u0026#39;d like to bundle this issue with. Do you have a preference for how you\u0026#39;d like to be credited in the release?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/whisjake\"\u003e@whisjake\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-26T23:43:22.497Z","updated_at":"2019-08-26T23:43:22.497Z","actor":{"username":"whyisjake","cleared":false,"url":"/whyisjake","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/499/942/de8d53f71535e9531105209e14875727a9e88cfe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5672559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @whyisjake, I cannot find a way to actually come up with any other HTML encoding patterns at the moment so the fix should fine.\n\nCredit can be like this: \"Soroush Dalili (@irsdl) from NCC Group\".\n\nThanks\nSoroush","markdown_message":"\u003cp\u003eHi \u003ca href=\"/whyisjake\"\u003e@whyisjake\u003c/a\u003e, I cannot find a way to actually come up with any other HTML encoding patterns at the moment so the fix should fine.\u003c/p\u003e\n\n\u003cp\u003eCredit can be like this: \u0026quot;Soroush Dalili (@irsdl) from NCC Group\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nSoroush\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-27T09:31:32.035Z","updated_at":"2019-08-27T09:31:32.035Z","actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5743851,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi there @irsdl,\n\nThanks for your contribution to making WordPress more secure. We released WordPress 5.2.3 yesterday and included the patch in the update.\n\nhttps://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/\n\nThank you for your responsible disclosure, and contributing to WordPress.\n\nCheers,\n\n@whyisjake","markdown_message":"\u003cp\u003eHi there \u003ca href=\"/irsdl\"\u003e@irsdl\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your contribution to making WordPress more secure. We released WordPress 5.2.3 yesterday and included the patch in the update.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.org%2Fnews%2F2019%2F09%2Fwordpress-5-2-3-security-and-maintenance-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for your responsible disclosure, and contributing to WordPress.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/whyisjake\"\u003e@whyisjake\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-06T04:01:25.637Z","updated_at":"2019-09-06T04:01:25.637Z","actor":{"username":"whyisjake","cleared":false,"url":"/whyisjake","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/499/942/de8d53f71535e9531105209e14875727a9e88cfe_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"irsdl","url":"/irsdl"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5747128,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-06T14:00:22.016Z","updated_at":"2019-09-06T14:00:22.016Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"irsdl","url":"/irsdl"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6068043,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-17T20:06:35.794Z","updated_at":"2019-10-17T20:06:35.794Z","first_to_agree":true,"actor":{"username":"irsdl","cleared":true,"url":"/irsdl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6325829,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-16T20:06:36.653Z","updated_at":"2019-11-16T20:06:36.653Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}