{"id":44217,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDIxNw==","url":"https://hackerone.com/reports/44217","title":"Application XSS filter function Bypass may allow Multiple stored XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-18T10:18:23.387Z","submitted_at":"2015-01-18T10:18:23.387Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"securityidiots","url":"/securityidiots","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-06-28T15:50:24.029Z","bug_reporter_agreed_on_going_public_at":"2015-05-29T15:50:03.272Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nAs i analysed the application behavior and the security structure, i found out that the application is using \"Greedy XSS Regex filter\" against XSS and removes any the whole string from '\u003c' to '\u003e'. So i tried some basic bypass which allowed me to insert tags and other characters into the string.\r\n\r\nHere is the the payload:\r\n\u003c%0crameset%20src=''\u003e \r\n\r\nNow if we see the whole application is using same filter against XSS which makes this bypass to be universally working on nearly all the input fields, which means we can say an attacker can successfully bypass and enter XSS payload in database but when the string prints in the frontend there is another filter, which encode all html entities before printing.\r\n\r\nNice but now enough as many of the inputs could in the below condition will end up with a successful XSS exploitation.\r\n1. Input under javascript.\r\n2. Any string not properly encoded before printing.\r\n3. JSON output with HTML headers.\r\n\r\nI have already reported some issues in vimeo where input injected directly into javascript and do not need any html characters, another issue of JSON output with HTML headers. \r\n\r\nBelow you can see both reports:\r\nhttps://hackerone.com/reports/43934\r\nhttps://hackerone.com/reports/44215\r\n\r\nIn the first screenshot you can see profile update request where i updates my profile and injected those HTML characters, in second screenshot you can see it injected in the response as stored XSS.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAs i analysed the application behavior and the security structure, i found out that the application is using \u0026quot;Greedy XSS Regex filter\u0026quot; against XSS and removes any the whole string from \u0026#39;\u0026lt;\u0026#39; to \u0026#39;\u0026gt;\u0026#39;. So i tried some basic bypass which allowed me to insert tags and other characters into the string.\u003c/p\u003e\n\n\u003cp\u003eHere is the the payload:\u003cbr\u003e\n\u0026lt;%0crameset%20src=\u0026#39;\u0026#39;\u0026gt; \u003c/p\u003e\n\n\u003cp\u003eNow if we see the whole application is using same filter against XSS which makes this bypass to be universally working on nearly all the input fields, which means we can say an attacker can successfully bypass and enter XSS payload in database but when the string prints in the frontend there is another filter, which encode all html entities before printing.\u003c/p\u003e\n\n\u003cp\u003eNice but now enough as many of the inputs could in the below condition will end up with a successful XSS exploitation.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eInput under javascript.\u003c/li\u003e\n\u003cli\u003eAny string not properly encoded before printing.\u003c/li\u003e\n\u003cli\u003eJSON output with HTML headers.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI have already reported some issues in vimeo where input injected directly into javascript and do not need any html characters, another issue of JSON output with HTML headers. \u003c/p\u003e\n\n\u003cp\u003eBelow you can see both reports:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/43934\" href=\"https://hackerone.com/reports/43934\"\u003ehttps://hackerone.com/reports/43934\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/44215\" href=\"https://hackerone.com/reports/44215\"\u003ehttps://hackerone.com/reports/44215\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn the first screenshot you can see profile update request where i updates my profile and injected those HTML characters, in second screenshot you can see it injected in the response as stored XSS.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":27291,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/291/7903324a132a49983c17a10bf5f1839dcea86cdc/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055852Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026X-Amz-Signature=32a2e55358cb42df4986df85f4a84d6f5da76e9097e942830bbc491efec96918","file_size":56986,"type":"image/png"},{"id":27292,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/292/21a28db1a5002c0f15c809764c5b39a7d4202c21/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055852Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026X-Amz-Signature=3c43c6d95c0e608c15ade160ffa64b9f661c7c59f5b94be11297793bbead55bc","file_size":65879,"type":"image/png"}],"allow_singular_disclosure_at":"2015-06-28T15:50:04.097Z","allow_singular_disclosure_after":-173714928.6688552,"singular_disclosure_allowed":true,"vote_count":6,"voters":["mpz","eveeez","vulnh0lic","japz","spetr0x","shahmeer-amir"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":330542,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@securityidiots, can you provide reproduction steps for arbitrary XSS (instead of the frameset)? I've tried your example and it appears that it's being properly encoded at least on my profile page settings. ","markdown_message":"\u003cp\u003e\u003ca href=\"/securityidiots\"\u003e@securityidiots\u003c/a\u003e, can you provide reproduction steps for arbitrary XSS (instead of the frameset)? I\u0026#39;ve tried your example and it appears that it\u0026#39;s being properly encoded at least on my profile page settings. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-11T23:01:56.000Z","updated_at":"2015-02-11T23:01:56.000Z","actor":{"username":"mandatory","cleared":false,"url":"/mandatory","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":332391,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Its already patched","markdown_message":"\u003cp\u003eIts already patched\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-14T21:59:07.083Z","updated_at":"2015-02-14T21:59:07.083Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340473,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Looks like this was patched by a separate fix.","markdown_message":"\u003cp\u003eLooks like this was patched by a separate fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-26T03:53:44.213Z","updated_at":"2015-02-26T03:53:44.213Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"securityidiots","url":"/securityidiots"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":393942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks Like Vimeo Resolved 3 Bugs Long Back , None Deserves For a Bounty? ","markdown_message":"\u003cp\u003eLooks Like Vimeo Resolved 3 Bugs Long Back , None Deserves For a Bounty? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-29T12:01:57.836Z","updated_at":"2015-04-29T12:01:57.836Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":396009,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\n@naren @andrewp Vimeo have resolved the bugs and still atfer a long wait i havent received any bounty. please let me know the reason for such a long delay.\n\nhttps://hackerone.com/reports/44157\nhttps://hackerone.com/reports/44217\nhttps://hackerone.com/reports/44239\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/naren\"\u003e@naren\u003c/a\u003e \u003ca href=\"/andrewp\"\u003e@andrewp\u003c/a\u003e Vimeo have resolved the bugs and still atfer a long wait i havent received any bounty. please let me know the reason for such a long delay.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://hackerone.com/reports/44157\" href=\"https://hackerone.com/reports/44157\"\u003ehttps://hackerone.com/reports/44157\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/44217\" href=\"https://hackerone.com/reports/44217\"\u003ehttps://hackerone.com/reports/44217\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/44239\" href=\"https://hackerone.com/reports/44239\"\u003ehttps://hackerone.com/reports/44239\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-01T11:03:37.790Z","updated_at":"2015-05-01T11:03:37.790Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":431476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewp hello sleeping beauty!! time to wake up","markdown_message":"\u003cp\u003e\u003ca href=\"/andrewp\"\u003e@andrewp\u003c/a\u003e hello sleeping beauty!! time to wake up\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-29T07:40:57.412Z","updated_at":"2015-05-29T07:40:57.412Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":432213,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-29T15:50:03.315Z","updated_at":"2015-05-29T15:50:03.315Z","first_to_agree":true,"actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":494536,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-28T15:50:24.151Z","updated_at":"2015-06-28T15:50:24.151Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1430295,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-19T15:10:54.433Z","updated_at":"2017-01-19T15:10:54.433Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"securityidiots","url":"/securityidiots"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}