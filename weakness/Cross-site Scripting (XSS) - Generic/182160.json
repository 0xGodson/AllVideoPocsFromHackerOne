{"id":182160,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODIxNjA=","url":"https://hackerone.com/reports/182160","title":"XSS in IE11 on portswigger.net via Flash","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-11-14T21:07:33.860Z","submitted_at":"2016-11-14T21:07:33.860Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"opnsec","url":"/opnsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15252,"url":"https://hackerone.com/portswigger","handle":"portswigger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PortSwigger Web Security","twitter_handle":"Burp_Suite","website":"https://portswigger.net","about":"Burp Suite is the leading software for web security testing"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-30T16:32:07.216Z","bug_reporter_agreed_on_going_public_at":"2016-11-30T16:32:07.159Z","team_member_agreed_on_going_public_at":"2016-11-30T14:20:52.665Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Portswigger Security Team,\n\nThere is a reflective XSS vulnerability in portswigger.net. The flash file `https://portswigger.net/burp/tutorials/video-js/video-js.swf` is from an old video.js library (version 3.2.0) which is vulnerable to XSS.\nThis XSS will be blocked by CSP instruction `object-src https://portswigger.net/knowledgebase/papers/;` but it will execute on browsers that don't enforce this CSP like Internet Explorer 11.\n\nPOC link : https://portswigger.net/burp/tutorials/video-js/video-js.swf?readyFunction=alert%28document.domain%2b'%20XSSed!'%29\n\nPOC instructions :\n- Open the POC link in Internet Explorer 11 with flash active\n- The javascript payload executes in `https://portswigger.net`\n(Tested on Windows 10)\n\nMitigation :\nTo solve this issue, replace the old `https://portswigger.net/burp/tutorials/video-js` library with the updated video.js library from http://videojs.com/. It is also better to host any swf file on a sandbox subdomain.\n\nRegards,\n\nEnguerran @opnsec","vulnerability_information_html":"\u003cp\u003eHello Portswigger Security Team,\u003c/p\u003e\n\n\u003cp\u003eThere is a reflective XSS vulnerability in portswigger.net. The flash file \u003ccode\u003ehttps://portswigger.net/burp/tutorials/video-js/video-js.swf\u003c/code\u003e is from an old video.js library (version 3.2.0) which is vulnerable to XSS.\u003cbr\u003e\nThis XSS will be blocked by CSP instruction \u003ccode\u003eobject-src https://portswigger.net/knowledgebase/papers/;\u003c/code\u003e but it will execute on browsers that don\u0026#39;t enforce this CSP like Internet Explorer 11.\u003c/p\u003e\n\n\u003cp\u003ePOC link : \u003ca title=\"https://portswigger.net/burp/tutorials/video-js/video-js.swf?readyFunction=alert%28document.domain%2b\u0026#39;%20XSSed!\u0026#39;%29\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fburp%2Ftutorials%2Fvideo-js%2Fvideo-js.swf%3FreadyFunction%3Dalert%2528document.domain%252b%27%2520XSSed%21%27%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/burp/tutorials/video-js/video-js.swf?readyFunction=alert%28document.domain%2b\u0026#39;%20XSSed!\u0026#39;%29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePOC instructions :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOpen the POC link in Internet Explorer 11 with flash active\u003c/li\u003e\n\u003cli\u003eThe javascript payload executes in \u003ccode\u003ehttps://portswigger.net\u003c/code\u003e\n(Tested on Windows 10)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eMitigation :\u003cbr\u003e\nTo solve this issue, replace the old \u003ccode\u003ehttps://portswigger.net/burp/tutorials/video-js\u003c/code\u003e library with the updated video.js library from \u003ca title=\"http://videojs.com/\" href=\"/redirect?url=http%3A%2F%2Fvideojs.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://videojs.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. It is also better to host any swf file on a sandbox subdomain.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eEnguerran \u003ca href=\"/opnsec\"\u003e@opnsec\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":134728,"file_name":"Portswigger_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/134/728/31aa08000e08c4d7b2d49ec7fc92d1ea6def375f/Portswigger_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Portswigger_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Portswigger_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044600Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=92bba337840f45e4235a678b6f4edb48aa185529151a9238b898386b31a6d6fd","file_size":26219,"type":"image/png"}],"allow_singular_disclosure_at":"2016-12-30T14:20:52.703Z","allow_singular_disclosure_after":-126109508.01046552,"singular_disclosure_allowed":true,"vote_count":32,"voters":["d1m0ck","albinowax","hogarth45","michiel","suv","spam404","yaworsk","reactors08","anovg","0x01alka","and 22 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1299995,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice catch! We'll handle this and get back to you. I'll do a quick audit for other flash files too.","markdown_message":"\u003cp\u003eNice catch! We\u0026#39;ll handle this and get back to you. I\u0026#39;ll do a quick audit for other flash files too.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T09:07:39.441Z","updated_at":"2016-11-15T09:07:39.441Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300628,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This should be fixed now. Many thanks! Are you happy for this report to be publicly disclosed when this program goes public?","markdown_message":"\u003cp\u003eThis should be fixed now. Many thanks! Are you happy for this report to be publicly disclosed when this program goes public?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T16:51:33.054Z","updated_at":"2016-11-15T16:51:33.054Z","actor":{"url":"/portswigger","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PortSwigger Web Security"}},"bounty_amount":"350.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"portswigger","collaborator":{"username":"opnsec","url":"/opnsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300637,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T16:53:01.312Z","updated_at":"2016-11-15T16:53:01.312Z","additional_data":{"old_title":"XSS in portswigger.net via Flash","new_title":"XSS in IE11 on portswigger.net via Flash"},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300639,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T16:53:29.410Z","updated_at":"2016-11-15T16:53:29.410Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"opnsec","url":"/opnsec"},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1302744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! \nI would be very happy that you disclose it when the program goes public.","markdown_message":"\u003cp\u003eThanks! \u003cbr\u003e\nI would be very happy that you disclose it when the program goes public.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-16T17:19:17.284Z","updated_at":"2016-11-16T17:19:17.284Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1329752,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-30T14:20:52.682Z","updated_at":"2016-11-30T14:20:52.682Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1330187,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-30T16:32:07.182Z","updated_at":"2016-11-30T16:32:07.182Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1330188,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-30T16:32:07.232Z","updated_at":"2016-11-30T16:32:07.232Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2992,"category":"team","content":"@opnsec found a forgotten unlinked Flash video player on portswigger.net that was vulnerable to XSS.  Fortunately our use of CSP partially mitigated it, meaning it could only be used to exploit Internet Explorer users. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/opnsec\"\u003e@opnsec\u003c/a\u003e found a forgotten unlinked Flash video player on portswigger.net that was vulnerable to XSS.  Fortunately our use of CSP partially mitigated it, meaning it could only be used to exploit Internet Explorer users. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}