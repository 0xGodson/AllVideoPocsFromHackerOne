{"id":258876,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTg4NzY=","url":"https://hackerone.com/reports/258876","title":"XSS when clicking \"Share to Twitter\" at quora.com/widgets/embed_iframe?path=...","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-08-11T09:00:04.923Z","submitted_at":"2017-08-11T09:00:04.923Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3152,"url":"https://hackerone.com/quora","handle":"quora","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Quora","twitter_handle":"quora","website":"http://www.quora.com","about":"A place to share knowledge and better understand the world."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-01-11T19:59:23.801Z","bug_reporter_agreed_on_going_public_at":"2018-01-11T02:43:11.365Z","team_member_agreed_on_going_public_at":"2018-01-11T19:59:23.687Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe endpoint at `https://{language}.quora.com/widgets/embed_iframe?path={path_to_answer_in_same_language}` shows the answer you specify in _path_ (like `/Question/answer/User`) in a format useful to embed.\nThere is one button _Share_ that when clicked shows another button _Share to Twitter_. The `href` attribute of this last button is of the format `javascript: window.open(\u0026quot;https://twitter.com/intent/tweet?text=Answer on @Quora by @User to Question? http://qr.ae/nnnn\u0026quot;, \u0026quot;Share Answer to Twitter\u0026quot;, \u0026quot;width=600, height=250\u0026quot;)`.\nThe problem is that you can create a question with `\"` (quotes) and inject Javascript code that is going to be executed when the user clicks _Share to Twitter_.\n\n**Description (Include Impact):**\nIt requires user interaction, but it works.\n\n### Steps To Reproduce\n\n1. Go to https://www.quora.com/\n2. Click on _Ask Question_ \n3. Enter a valid question which includes `\"-alert(document.domain)-\"` somewhere. I entered `Question ignore \"-alert(document.domain)-\"?` and it was accepted as valid\n4. Now you may be in the page of the question you just asked\n5. Click on _Answer_\n6. Enter anything\n7. Click on _Submit_\n8. Copy the path from the address bar. Mine was `/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar`\n9. Go to `https://www.quora.com/widgets/embed_iframe?path={path_from_last_step}`. Mine is https://www.quora.com/widgets/embed_iframe?path=/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar\n10. Click on _Share_\n11. Click on _Share to Twitter_\n12. `alert(document.domain)` is executed\n\n### Optional: Your Environment (Browser version, Device, app version, os version etc)\n\n * It is not browser dependent. Anyway, I tested it on Firefox, Chrome and Safari for Mac.\n\n### Optional: Supporting Material/References (Screenshots)\n\n * I don't think is necessary, but let me know if you need something else.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nThe endpoint at \u003ccode\u003ehttps://{language}.quora.com/widgets/embed_iframe?path={path_to_answer_in_same_language}\u003c/code\u003e shows the answer you specify in \u003cu\u003epath\u003c/u\u003e (like \u003ccode\u003e/Question/answer/User\u003c/code\u003e) in a format useful to embed.\u003cbr\u003e\nThere is one button \u003cu\u003eShare\u003c/u\u003e that when clicked shows another button \u003cu\u003eShare to Twitter\u003c/u\u003e. The \u003ccode\u003ehref\u003c/code\u003e attribute of this last button is of the format \u003ccode\u003ejavascript: window.open(\u0026amp;quot;https://twitter.com/intent/tweet?text=Answer on [@Quora](/quora) by @User to Question? http://qr.ae/nnnn\u0026amp;quot;, \u0026amp;quot;Share Answer to Twitter\u0026amp;quot;, \u0026amp;quot;width=600, height=250\u0026amp;quot;)\u003c/code\u003e.\u003cbr\u003e\nThe problem is that you can create a question with \u003ccode\u003e\u0026quot;\u003c/code\u003e (quotes) and inject Javascript code that is going to be executed when the user clicks \u003cu\u003eShare to Twitter\u003c/u\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription (Include Impact):\u003c/strong\u003e\u003cbr\u003e\nIt requires user interaction, but it works.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.quora.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.quora.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.quora.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eAsk Question\u003c/u\u003e \u003c/li\u003e\n\u003cli\u003eEnter a valid question which includes \u003ccode\u003e\u0026quot;-alert(document.domain)-\u0026quot;\u003c/code\u003e somewhere. I entered \u003ccode\u003eQuestion ignore \u0026quot;-alert(document.domain)-\u0026quot;?\u003c/code\u003e and it was accepted as valid\u003c/li\u003e\n\u003cli\u003eNow you may be in the page of the question you just asked\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eAnswer\u003c/u\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter anything\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eSubmit\u003c/u\u003e\n\u003c/li\u003e\n\u003cli\u003eCopy the path from the address bar. Mine was \u003ccode\u003e/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to \u003ccode\u003ehttps://www.quora.com/widgets/embed_iframe?path={path_from_last_step}\u003c/code\u003e. Mine is \u003ca title=\"https://www.quora.com/widgets/embed_iframe?path=/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar\" href=\"/redirect?url=https%3A%2F%2Fwww.quora.com%2Fwidgets%2Fembed_iframe%3Fpath%3D%2FQuestion-ignore-alert-document-domain%2Fanswer%2FCuenta-Para-Probar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.quora.com/widgets/embed_iframe?path=/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eShare\u003c/u\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eShare to Twitter\u003c/u\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ealert(document.domain)\u003c/code\u003e is executed\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"optional-your-environment-browser-version-device-app-version-os-version-etc\"\u003eOptional: Your Environment (Browser version, Device, app version, os version etc)\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eIt is not browser dependent. Anyway, I tested it on Firefox, Chrome and Safari for Mac.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"optional-supporting-material-references-screenshots\"\u003eOptional: Supporting Material/References (Screenshots)\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eI don\u0026#39;t think is necessary, but let me know if you need something else.\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["sourc7","hackedbrain","eveeez","malcolmx","khizer47","m7mdharoun","cr4xerbik4sh","raguljr","zerotoone","sumit7","and 5 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2085308,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T18:02:51.237Z","updated_at":"2017-10-19T18:02:51.237Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2085311,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Sorry for the long delay.","markdown_message":"\u003cp\u003eSorry for the long delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-19T18:03:10.746Z","updated_at":"2017-10-19T18:03:10.746Z","actor":{"url":"/quora","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Quora"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"quora","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2087714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries. Thank you for the bounty!","markdown_message":"\u003cp\u003eNo worries. Thank you for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-20T12:04:03.990Z","updated_at":"2017-10-20T12:04:03.990Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2199524,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed now. Can you verify?","markdown_message":"\u003cp\u003eThis should be fixed now. Can you verify?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-04T18:41:22.936Z","updated_at":"2017-12-04T18:41:22.936Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2210609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sriram-quora,\n\nI just checked and it seems that I'm still able to reproduce it. :( \nThis is the question I created https://www.quora.com/widgets/embed_iframe?path=/Blalasd-really-alert-document-domain/answer/Cuenta-Para-Probar\n\nSorry for the delay.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sriram-quora\"\u003e@sriram-quora\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI just checked and it seems that I\u0026#39;m still able to reproduce it. :( \u003cbr\u003e\nThis is the question I created \u003ca title=\"https://www.quora.com/widgets/embed_iframe?path=/Blalasd-really-alert-document-domain/answer/Cuenta-Para-Probar\" href=\"/redirect?url=https%3A%2F%2Fwww.quora.com%2Fwidgets%2Fembed_iframe%3Fpath%3D%2FBlalasd-really-alert-document-domain%2Fanswer%2FCuenta-Para-Probar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.quora.com/widgets/embed_iframe?path=/Blalasd-really-alert-document-domain/answer/Cuenta-Para-Probar\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-09T00:39:01.827Z","updated_at":"2017-12-09T00:39:01.827Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2236297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks - we think we've fixed it now, can you try again?","markdown_message":"\u003cp\u003eThanks - we think we\u0026#39;ve fixed it now, can you try again?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-19T21:48:22.192Z","updated_at":"2017-12-19T21:48:22.192Z","actor":{"username":"jessie","cleared":false,"url":"/jessie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2245267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jessie,\n\nit looks fixed now! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jessie\"\u003e@jessie\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eit looks fixed now! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-24T21:57:09.490Z","updated_at":"2017-12-24T21:57:09.490Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2260648,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-03T22:30:08.542Z","updated_at":"2018-01-03T22:30:08.542Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2276555,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi. If it's okay for you I would like to make this report public. Thank you in advance.","markdown_message":"\u003cp\u003eHi. If it\u0026#39;s okay for you I would like to make this report public. Thank you in advance.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-11T02:43:11.407Z","updated_at":"2018-01-11T02:43:11.407Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278673,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T19:59:23.726Z","updated_at":"2018-01-11T19:59:23.726Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278674,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T19:59:23.830Z","updated_at":"2018-01-11T19:59:23.830Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2279519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-12T04:54:30.836Z","updated_at":"2018-01-12T04:54:30.836Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}