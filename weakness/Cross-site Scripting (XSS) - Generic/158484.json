{"id":158484,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTg0ODQ=","url":"https://hackerone.com/reports/158484","title":"[scores.ubnt.com] DOM based XSS at form.html","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-11T14:53:50.729Z","submitted_at":"2016-08-11T14:53:50.729Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"s_p_q_r","url":"/s_p_q_r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-24T11:33:20.888Z","bug_reporter_agreed_on_going_public_at":"2017-01-25T11:33:08.419Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI would like to report that the #130889 bug hasn't been fixed completely.\n\nThe removeTags function has been added, however an attacker is still able to inject Javascript as parameter values without any HTML tags:\n\n\u003e https://scores.ubnt.com/form.html?uid=1\u0026p=%27%20onmouseover=alert(document.domain)//\n\nThe script is triggered by the onmouseover event on the header.\n\nTested with latest Firefox and Chrome.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI would like to report that the \u003ca href=\"/reports/130889\"\u003e#130889\u003c/a\u003e bug hasn\u0026#39;t been fixed completely.\u003c/p\u003e\n\n\u003cp\u003eThe removeTags function has been added, however an attacker is still able to inject Javascript as parameter values without any HTML tags:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca title=\"https://scores.ubnt.com/form.html?uid=1\u0026amp;p=%27%20onmouseover=alert(document.domain)//\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D1%26p%3D%2527%2520onmouseover%3Dalert%28document.domain%29%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=1\u0026amp;p=%27%20onmouseover=alert(document.domain)//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe script is triggered by the onmouseover event on the header.\u003c/p\u003e\n\n\u003cp\u003eTested with latest Firefox and Chrome.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-24T11:33:08.474Z","allow_singular_disclosure_after":-121280575.41666779,"singular_disclosure_allowed":true,"vote_count":11,"voters":["bl4de","ashish_r_padelkar","madrobot","mpz","eveeez","malcolmx","bountyoverflow","alfredsaonoy","sumit7","rbcafe","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1119500,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Futhermore, you shouldn't allow style injections in general:\n\n\u003e https://scores.ubnt.com/form.html?uid=1\u0026p=)%3B%20background-color:%23000000%3B\n\nThey also can lead to XSS in some browsers, for example, in IE7 via CSS expressions.","markdown_message":"\u003cp\u003eFuthermore, you shouldn\u0026#39;t allow style injections in general:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca title=\"https://scores.ubnt.com/form.html?uid=1\u0026amp;p=)%3B%20background-color:%23000000%3B\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D1%26p%3D%29%253B%2520background-color%3A%2523000000%253B\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=1\u0026amp;p=)%3B%20background-color:%23000000%3B\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThey also can lead to XSS in some browsers, for example, in IE7 via CSS expressions.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:09:34.791Z","updated_at":"2016-08-11T15:09:34.791Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1124215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report. We were able to reproduce your proof of concept. We'll be sure to update you as soon as we have more information. \n\nThanks and good luck in your future bug hunting. ","markdown_message":"\u003cp\u003eThanks for your report. We were able to reproduce your proof of concept. We\u0026#39;ll be sure to update you as soon as we have more information. \u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-12T21:48:36.379Z","updated_at":"2016-08-12T21:48:36.379Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1153908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HI s_p_q_r,\n\nThis should be patched now, but if you have a moment, we would like your confirmation.\n\nThanks for testing!","markdown_message":"\u003cp\u003eHI s_p_q_r,\u003c/p\u003e\n\n\u003cp\u003eThis should be patched now, but if you have a moment, we would like your confirmation.\u003c/p\u003e\n\n\u003cp\u003eThanks for testing!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-25T15:30:31.149Z","updated_at":"2016-08-25T15:30:31.149Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1154103,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI'm still able to reproduce it.","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m still able to reproduce it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-25T16:50:49.603Z","updated_at":"2016-08-25T16:50:49.603Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":114873,"filename":"ubnt_xss.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/114/873/0dff8273fef349143d55d887dec886034dfa1d62/ubnt_xss.png?response-content-disposition=attachment%3B%20filename%3D%22ubnt_xss.png%22%3B%20filename%2A%3DUTF-8%27%27ubnt_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=eb056108f4eb10869581e7901c7a105bf6183e545eff2824cac5262137eb0c4d"}],"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1154147,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-25T17:16:09.611Z","updated_at":"2016-08-25T17:16:09.611Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1408949,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-09T17:02:47.417Z","updated_at":"2017-01-09T17:02:47.417Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"s_p_q_r","url":"/s_p_q_r"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1408950,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you and good luck with future bug hunting.","markdown_message":"\u003cp\u003eThank you and good luck with future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-09T17:03:04.348Z","updated_at":"2017-01-09T17:03:04.348Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"s_p_q_r","url":"/s_p_q_r"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1412370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nYep, quotes are being removed now:\n\n```javascript\nrating.product.replace(/['\"]/g, '')\n```\n\nhowever style injection is still possible:\n\n\u003e https://scores.ubnt.com/form.html?uid=1\u0026p=)%3B%20background-color:%23000000%3B%20height:2000px;","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYep, quotes are being removed now:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003erating\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eproduct\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e[\u003c/span\u003e\u003cspan class=\"sr\"\u003e\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e]\u003c/span\u003e\u003cspan class=\"sr\"\u003e/g\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ehowever style injection is still possible:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca title=\"https://scores.ubnt.com/form.html?uid=1\u0026amp;p=)%3B%20background-color:%23000000%3B%20height:2000px\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D1%26p%3D%29%253B%2520background-color%3A%2523000000%253B%2520height%3A2000px\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=1\u0026amp;p=)%3B%20background-color:%23000000%3B%20height:2000px\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2017-01-10T21:48:14.146Z","updated_at":"2017-01-10T21:48:14.146Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1442979,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If it's okay with style injection.","markdown_message":"\u003cp\u003eIf it\u0026#39;s okay with style injection.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-25T11:33:08.437Z","updated_at":"2017-01-25T11:33:08.437Z","first_to_agree":true,"actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1503222,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-24T11:33:20.905Z","updated_at":"2017-02-24T11:33:20.905Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}