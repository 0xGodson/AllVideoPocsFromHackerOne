{"id":51061,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTA2MQ==","url":"https://hackerone.com/reports/51061","title":"XSS in ad.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-11T23:09:01.682Z","submitted_at":"2015-03-11T23:09:01.682Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-05-02T17:33:59.104Z","bug_reporter_agreed_on_going_public_at":"2015-04-02T17:33:57.045Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The XSS vulnerability is located here:\r\n\r\n```\r\nhttps://ad.mail.ru/adi/3030\r\n```\r\n\r\nand is triggered by setting referer to:\r\n\r\n```\r\n\"\u003e\u003cscript\u003ealert(0)\u003c/script\u003e\r\n```\r\n\r\nThe problem is that the referer is being loaded like so:\r\n\r\n```html\r\n \u003cins class=\"adsbygoogle\" style=\"display:inline-block;width:300px;height:250px\" data-ad-client=\"ca-pub-4831681952934476\" data-ad-slot=\"7515917252\" data-override-format=\"true\" data-page-url = \"\"\u003e\r\n\u003cscript\u003e\r\n    alert(0)\r\n\u003c/script\u003e\"\u003e\r\n```\r\n\r\nI am aware that this is out of scope, but I am still reporting it since I just happened to spot it while looking for other bugs. ","vulnerability_information_html":"\u003cp\u003eThe XSS vulnerability is located here:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://ad.mail.ru/adi/3030\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand is triggered by setting referer to:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(0)\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe problem is that the referer is being loaded like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e \u003cspan class=\"nt\"\u003e\u0026lt;ins\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;adsbygoogle\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;display:inline-block;width:300px;height:250px\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-ad-client=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;ca-pub-4831681952934476\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-ad-slot=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;7515917252\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-override-format=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;true\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-page-url = \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI am aware that this is out of scope, but I am still reporting it since I just happened to spot it while looking for other bugs. \u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-02T17:33:57.714Z","allow_singular_disclosure_after":-178634320.75603592,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":352237,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T16:15:48.738Z","updated_at":"2015-03-12T16:15:48.738Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":369060,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue.\nUnfortunately,  your report was not in a bug bounty program's scope(check the [rules](https://hackerone.com/mailru)), so  we cannot qualify you for reward :(","markdown_message":"\u003cp\u003eYour bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue.\u003cbr\u003e\nUnfortunately,  your report was not in a bug bounty program\u0026#39;s scope(check the \u003ca href=\"https://hackerone.com/mailru\"\u003erules\u003c/a\u003e), so  we cannot qualify you for reward :(\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-02T11:55:21.124Z","updated_at":"2015-04-02T11:55:21.124Z","actor":{"username":"yngwie","cleared":false,"url":"/yngwie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/185/1b6bf6046f42c100e3793d87a8410bc07178fa8f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ddworken","url":"/ddworken"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":369308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thank you very much for patching this vulnerability. I have confirmed that this has been fixed. \n\nThanks,\nDavid Dworken","markdown_message":"\u003cp\u003eGreat, thank you very much for patching this vulnerability. I have confirmed that this has been fixed. \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavid Dworken\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-02T17:32:49.913Z","updated_at":"2015-04-02T17:32:49.913Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":369310,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-02T17:33:57.077Z","updated_at":"2015-04-02T17:33:57.077Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":400135,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-02T17:33:59.204Z","updated_at":"2015-05-02T17:33:59.204Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":716618,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-11T10:36:50.429Z","updated_at":"2015-12-11T10:36:50.429Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}