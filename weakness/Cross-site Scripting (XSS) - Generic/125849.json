{"id":125849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU4NDk=","url":"https://hackerone.com/reports/125849","title":"XSS found on Snapchat website","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-25T03:11:04.743Z","submitted_at":"2016-03-25T03:11:04.743Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"esnard","url":"/esnard","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":513,"url":"https://hackerone.com/snapchat","handle":"snapchat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Snapchat","twitter_handle":"","website":"https://www.snapchat.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-26T10:10:01.808Z","bug_reporter_agreed_on_going_public_at":"2018-04-26T10:09:53.237Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Snapchat Team,\n\nI've found a reflected XSS vulnerability on this page:\nhttps://www.snapchat.com/add/snapchat\n\nExample:\nhttps://www.snapchat.com/add/%22%3E%3Ch1%3EXSS%3C%2Fh1%3E\n\nNote: you should visit the page with a mobile user-agent since the server displays different information based on the User-Agent HTTP header sent by the browser.\n\nThere are 6 places where the username isn't protected against XSS attacks:\n- 4 `meta` tags: twitter:title, twitter:image, og:title, og:image\n- 1 `object` tag: snapcode\n- 1 `h2` tag: username\n\nThis could lead to JavaScript execution, UI redressing or open redirects.","vulnerability_information_html":"\u003cp\u003eHi Snapchat Team,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve found a reflected XSS vulnerability on this page:\u003cbr\u003e\n\u003ca title=\"https://www.snapchat.com/add/snapchat\" href=\"/redirect?url=https%3A%2F%2Fwww.snapchat.com%2Fadd%2Fsnapchat\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.snapchat.com/add/snapchat\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eExample:\u003cbr\u003e\n\u003ca title=\"https://www.snapchat.com/add/%22%3E%3Ch1%3EXSS%3C%2Fh1%3E\" href=\"/redirect?url=https%3A%2F%2Fwww.snapchat.com%2Fadd%2F%2522%253E%253Ch1%253EXSS%253C%252Fh1%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.snapchat.com/add/%22%3E%3Ch1%3EXSS%3C%2Fh1%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNote: you should visit the page with a mobile user-agent since the server displays different information based on the User-Agent HTTP header sent by the browser.\u003c/p\u003e\n\n\u003cp\u003eThere are 6 places where the username isn\u0026#39;t protected against XSS attacks:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e4 \u003ccode\u003emeta\u003c/code\u003e tags: twitter:title, twitter:image, og:title, og:image\u003c/li\u003e\n\u003cli\u003e1 \u003ccode\u003eobject\u003c/code\u003e tag: snapcode\u003c/li\u003e\n\u003cli\u003e1 \u003ccode\u003eh2\u003c/code\u003e tag: username\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis could lead to JavaScript execution, UI redressing or open redirects.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-26T10:09:53.341Z","allow_singular_disclosure_after":-81886371.58785981,"singular_disclosure_allowed":true,"vote_count":34,"voters":["pufo","kaulse","asad0x01_","eveeez","apapedulimu","an0nym0us","byeu","pandaonair","luigigubello","t-4-y-m","and 24 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":871469,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, thanks for your report. \n\nWe're having trouble reproducing the findings that you've reported. In our testing, we're unable to see any JavaScript executing. If you think we've missed something, please let us know and provide us with detailed instructions on how to reproduce the exploit. Any images, or a video, that demonstrates the issue would also help us to evaluate this report. \n\nThanks and good luck in your future bug hunting. \n\n","markdown_message":"\u003cp\u003eHello, thanks for your report. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re having trouble reproducing the findings that you\u0026#39;ve reported. In our testing, we\u0026#39;re unable to see any JavaScript executing. If you think we\u0026#39;ve missed something, please let us know and provide us with detailed instructions on how to reproduce the exploit. Any images, or a video, that demonstrates the issue would also help us to evaluate this report. \u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-25T19:05:46.955Z","updated_at":"2016-03-25T19:05:46.955Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":872405,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello,\n\nThe execution of JavaScript code is blocked by the `Content-Security-Policy` HTTP header. Unless someone finds a flaw in a browser's implementation, I guess the only executable scripts are the one present on Snapchat servers - which are likely safe.\n\n`iframe` tags are also rejected, but inline `style` tags are allowed. Also, since the `img-src` directive allows images from https://storage.googleapis.com/ , an attacker could upload pictures on this domain (using Google Cloud) and display them on the page.\n\nHere's an example of a [defaced page](https://www.snapchat.com/add/%22%3E%3Ch1%20style=%22width:100%;height:100%;position:absolute;top:0;background-color:black;text-align:center;margin:0;color:white;font-size:256px%22%3EHACKED%3Cstyle%3E), and another example with [a redirection to HackerOne](https://www.snapchat.com/add/\"\u003e\u003cmeta http-equiv=\"refresh\" content=\"0;url=https:\u0026%2347;\u0026%2347;hackerone.com\u0026%2347;\"%3E%3Cstyle%3E).\n\nRemember that the user-agent must be the one of a mobile browser: Snapchat servers delivers two different pages based on your browser being mobile or not.\n\nThe second example won't work in Chrome since it has a built-in XSS auditor which prevents most of reflected XSS, but it works fine in Firefox.\n\nHave a nice day,\nBenoit","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe execution of JavaScript code is blocked by the \u003ccode\u003eContent-Security-Policy\u003c/code\u003e HTTP header. Unless someone finds a flaw in a browser\u0026#39;s implementation, I guess the only executable scripts are the one present on Snapchat servers - which are likely safe.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eiframe\u003c/code\u003e tags are also rejected, but inline \u003ccode\u003estyle\u003c/code\u003e tags are allowed. Also, since the \u003ccode\u003eimg-src\u003c/code\u003e directive allows images from \u003ca title=\"https://storage.googleapis.com/\" href=\"/redirect?url=https%3A%2F%2Fstorage.googleapis.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://storage.googleapis.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e , an attacker could upload pictures on this domain (using Google Cloud) and display them on the page.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s an example of a \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.snapchat.com%2Fadd%2F%2522%253E%253Ch1%2520style%3D%2522width%3A100%25%3Bheight%3A100%25%3Bposition%3Aabsolute%3Btop%3A0%3Bbackground-color%3Ablack%3Btext-align%3Acenter%3Bmargin%3A0%3Bcolor%3Awhite%3Bfont-size%3A256px%2522%253EHACKED%253Cstyle%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edefaced page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and another example with \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.snapchat.com%2Fadd%2F%2522%253E%253Cmeta%2520http-equiv%3D%2522refresh%2522%2520content%3D%25220%3Burl%3Dhttps%3A%26%252347%3B%26%252347%3Bhackerone.com%26%252347%3B%2522%253E%253Cstyle%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea redirection to HackerOne\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eRemember that the user-agent must be the one of a mobile browser: Snapchat servers delivers two different pages based on your browser being mobile or not.\u003c/p\u003e\n\n\u003cp\u003eThe second example won\u0026#39;t work in Chrome since it has a built-in XSS auditor which prevents most of reflected XSS, but it works fine in Firefox.\u003c/p\u003e\n\n\u003cp\u003eHave a nice day,\u003cbr\u003e\nBenoit\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-26T13:51:37.727Z","updated_at":"2016-03-26T13:57:56.072Z","actor":{"username":"esnard","cleared":false,"url":"/esnard","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":81458,"filename":"snapchat.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/458/490cab4fd00513417996d126bd54a47e96e14e77/snapchat.png?response-content-disposition=attachment%3B%20filename%3D%22snapchat.png%22%3B%20filename%2A%3DUTF-8%27%27snapchat.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042244Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=19b6f51f30095934f1bce69ad75fb459c2874c14f7d878c36dfae93bc94a5c92"}],"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876700,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-29T18:07:30.018Z","updated_at":"2016-03-29T18:07:30.018Z","actor":{"username":"divya","cleared":false,"url":"/divya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1013985,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @esnard\n\nSorry for the delay in responding back. We put a temporary fix in to prevent redirects and are working on a more long term solution. This domain however is purely static and doesn't have any authentication (which is why it is not explicitly included in scope for bug bounty program). So thankfully, the risk is minimal.\n\nCongratulations! The panel has decided to award you $250 for your bug report. We appreciate your efforts - thanks, and good luck on your future bug hunting!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/esnard\"\u003e@esnard\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay in responding back. We put a temporary fix in to prevent redirects and are working on a more long term solution. This domain however is purely static and doesn\u0026#39;t have any authentication (which is why it is not explicitly included in scope for bug bounty program). So thankfully, the risk is minimal.\u003c/p\u003e\n\n\u003cp\u003eCongratulations! The panel has decided to award you $250 for your bug report. We appreciate your efforts - thanks, and good luck on your future bug hunting!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-14T22:32:41.895Z","updated_at":"2016-06-14T22:32:41.895Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"esnard","url":"/esnard"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1013986,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-14T22:32:50.812Z","updated_at":"2016-06-14T22:32:50.812Z","actor":{"username":"divya","cleared":false,"url":"/divya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"esnard","url":"/esnard"},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2667380,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi Snapchat,\n\nA couple years later, is it still possible to disclose this report publicly?","markdown_message":"\u003cp\u003eHi Snapchat,\u003c/p\u003e\n\n\u003cp\u003eA couple years later, is it still possible to disclose this report publicly?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-26T10:09:53.279Z","updated_at":"2018-04-26T10:09:53.279Z","first_to_agree":true,"actor":{"username":"esnard","cleared":false,"url":"/esnard","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2800555,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-26T10:10:01.836Z","updated_at":"2018-05-26T10:10:01.836Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}