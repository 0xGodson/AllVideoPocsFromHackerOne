{"id":177757,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc3NTc=","url":"https://hackerone.com/reports/177757","title":"Stored XSS in Restoring Archived Tasks","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-24T10:11:35.407Z","submitted_at":"2016-10-24T10:11:35.407Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugs3ra","url":"/bugs3ra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-12-15T11:07:06.008Z","bug_reporter_agreed_on_going_public_at":"2016-11-15T11:06:56.819Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Harvest Team,\n\nThere is stored XSS in restoring archived/deleted tasks.\n\nPOC:\n1. Create a task with name with xss payload \"\u003e\u003cimg src=x onerror=alert(document.domain)\u003e\n2. Now from Tasks, delete the task and the task will be archived.\n3. Now Click on Manage archived tasks, to restore it back.\n4. Click on the task with xss payload, XSS is triggered.\n\n","vulnerability_information_html":"\u003cp\u003eHello Harvest Team,\u003c/p\u003e\n\n\u003cp\u003eThere is stored XSS in restoring archived/deleted tasks.\u003c/p\u003e\n\n\u003cp\u003ePOC:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a task with name with xss payload \u0026quot;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\u003c/li\u003e\n\u003cli\u003eNow from Tasks, delete the task and the task will be archived.\u003c/li\u003e\n\u003cli\u003eNow Click on Manage archived tasks, to restore it back.\u003c/li\u003e\n\u003cli\u003eClick on the task with xss payload, XSS is triggered.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-15T11:06:56.856Z","allow_singular_disclosure_after":-127417014.68305966,"singular_disclosure_allowed":true,"vote_count":12,"voters":["b6117130df17feef13481e3","mpz","eveeez","iwanttobuyhomefrombounty","alfredsaonoy","japz","sumit7","spetr0x","dr_dragon","shahmeer-amir","and 2 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1264047,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-24T10:17:30.099Z","updated_at":"2016-10-24T10:17:30.099Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":3876},"actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1264306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Impact: This can be used by invited team member with admin privilege to target the owner.","markdown_message":"\u003cp\u003eImpact: This can be used by invited team member with admin privilege to target the owner.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T13:02:57.455Z","updated_at":"2016-10-24T13:02:57.455Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1264818,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-24T17:09:13.225Z","updated_at":"2016-10-24T17:09:13.225Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":3876,"new_severity_id":3934},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1264823,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For your reference, Screenshot is attached....","markdown_message":"\u003cp\u003eFor your reference, Screenshot is attached....\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T17:11:25.867Z","updated_at":"2016-10-24T17:11:25.867Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":129917,"filename":"harvest_archived_tasks_XSS.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/917/f0bb4231f62d95d52beb32bd1295cd85730c0ae7/harvest_archived_tasks_XSS.JPG?response-content-disposition=attachment%3B%20filename%3D%22harvest_archived_tasks_XSS.JPG%22%3B%20filename%2A%3DUTF-8%27%27harvest_archived_tasks_XSS.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ73CCUSFG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044351Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCGGkmdk3O0%2B96YS48IazaeHEdMv%2BN41nMJvviy9CKnDgIhAK6vCcjQLqXNhfXEkARhk2Pfw1V1rRNUAtiJTzUH8Ee1KrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyudt2yAk5Z1nSjTXIqkQPiLeekhnilcZ3reJTn08DbSZ0A7Q3crWPYcBaZnWOAiOy6idHHwS4Qv12QRaYyYJTfU5fYuLEHwHAjRoOrVVPAbenU%2FwLFPGXct9IHMUpdTZpQpcx%2BuO279E1iybhTsDNyV6Ew2Wyuyqo9Xp0GMgN%2FZKLTdQVrO%2B4fQk7PAxpP8tk6YTZlTxqWkJw%2Bm95tnQ3bCJwg3olthCbReBss9OMSKyHsf31P4S%2FgkiL0FSWlGi3mgcczMC3pLrI3jpuNi8QQQqx%2BLFl60xADebcXrl0st3ZcpjZXWajov%2Bhxh2nB4aqlqQFbpQIJx53GNTobNZCAm9lNJWEIvZsNqIaYtaDPdtKfBFPlAHcevruCDL5ywTjjc7csF1SolFKO4NQE%2BhZoWqLg7xE1DXK565UD%2BN5R1Gz7x%2F9Nh4jbJPQMCC7EhMnEWhlETnHtYlMytpmG5EhZMmF5szMpKmrsggeMK2SWT8HS8bBV0Pq%2BNrGCg3mwl%2BD8xW%2FO1zWpevrFtzmaJ7geeO91EYwzx2zPaNxnluroWDDDyar%2FBTrqAXFKDZlnJTINjzKPhr8sSRAvNO7Yf6EQdYD6yjW0HrNQp4%2BT4yy1QL%2Fx%2F6v2GWMrebqDtxosOhN3WdPz5w%2BXe91skQJxOr0w2S3bBWvphE1AEIAuxKmOy8oLs3ydeVPJi829FHc3w8QeDj3AiY%2Bo9IZc6TvSFwJ6gx3UAw5BfJyNoQprSsAtrCV76dtG2%2BS9OZs0D1q%2Bz%2BgxzcSPWXcU5Opc2ko5PvvCmnZ31uiam5NbJyUg%2FNkxKsW9XB6ZnYAdByUNhziNztEVtbeBXmCYts1v%2FWwYGc%2FK20C8EHl%2BLpQPQ7QKUG55nGEr8Q%3D%3D\u0026X-Amz-Signature=3418bc41e5cf460acd1b0d6e62ef9a0658715b43bace21676b1625c59605e12c"}],"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1264825,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Vijay,\n\nThanks a lot for this one! I'm moving it to triage.\n \nWe believe that the severity of the bug is low, the owner and admins have the same privileges and tasks can only be created by admins. I'll contact you as soon as it is fixed.\n\nBest regards,\nJorge","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for this one! I\u0026#39;m moving it to triage.\u003c/p\u003e\n\n\u003cp\u003eWe believe that the severity of the bug is low, the owner and admins have the same privileges and tasks can only be created by admins. I\u0026#39;ll contact you as soon as it is fixed.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T17:13:58.495Z","updated_at":"2016-10-24T17:13:58.495Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1264912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jorgeleria , user with PM role can also create Tasks with XSS payload in name and can target admin user. This makes the issue severity little higher.\n\nTo Add task from PM user.\n1. Navigate to https://katil.harvestapp.com/projects/new, to create new project.\n2. You'll see Tasks, where you can add or create new tasks.\n3. In order to make tasks eligible for archive, you need to start the timer, otherwise the task would be permanently deleted when admin user tries to delete it.\n\n\nAlso, I'm not sure if it is intentional feature wherein PM user can create Tasks while creating projects. Ideally it shouldn't be allowed if it is restricted to admins only.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jorgeleria\"\u003e@jorgeleria\u003c/a\u003e , user with PM role can also create Tasks with XSS payload in name and can target admin user. This makes the issue severity little higher.\u003c/p\u003e\n\n\u003cp\u003eTo Add task from PM user.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to \u003ca title=\"https://katil.harvestapp.com/projects/new\" href=\"/redirect?url=https%3A%2F%2Fkatil.harvestapp.com%2Fprojects%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://katil.harvestapp.com/projects/new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, to create new project.\u003c/li\u003e\n\u003cli\u003eYou\u0026#39;ll see Tasks, where you can add or create new tasks.\u003c/li\u003e\n\u003cli\u003eIn order to make tasks eligible for archive, you need to start the timer, otherwise the task would be permanently deleted when admin user tries to delete it.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAlso, I\u0026#39;m not sure if it is intentional feature wherein PM user can create Tasks while creating projects. Ideally it shouldn\u0026#39;t be allowed if it is restricted to admins only.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T17:54:57.453Z","updated_at":"2016-10-24T17:58:15.160Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268817,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Vijay,\n\nYou are right about the PM users! This bug should be fixed now.\nCould you check if you are able to reproduce it?\n\nThanks!\nJorge","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eYou are right about the PM users! This bug should be fixed now.\u003cbr\u003e\nCould you check if you are able to reproduce it?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-26T15:22:31.630Z","updated_at":"2016-10-26T15:22:31.630Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugs3ra","url":"/bugs3ra"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1269012,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The issue is fixed....What about risk, it should be medium....","markdown_message":"\u003cp\u003eThe issue is fixed....What about risk, it should be medium....\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-26T17:19:12.289Z","updated_at":"2016-10-26T17:20:15.659Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1271211,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-27T16:23:20.513Z","updated_at":"2016-10-27T16:23:20.513Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"bugs3ra","url":"/bugs3ra"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300139,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If its okay..","markdown_message":"\u003cp\u003eIf its okay..\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T11:06:56.835Z","updated_at":"2016-11-15T11:06:56.835Z","first_to_agree":true,"actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1366182,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-15T11:07:06.050Z","updated_at":"2016-12-15T11:07:06.050Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}