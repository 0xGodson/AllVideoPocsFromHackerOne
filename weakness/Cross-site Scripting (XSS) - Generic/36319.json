{"id":36319,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjMxOQ==","url":"https://hackerone.com/reports/36319","title":"[qiwi.com] /oauth/confirm.action XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-11-17T12:33:08.786Z","submitted_at":"2014-11-17T12:33:08.786Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akhil-reni","url":"/akhil-reni","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-12-20T15:45:06.970Z","bug_reporter_agreed_on_going_public_at":"2014-11-20T15:44:58.019Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey hi,\r\n\r\nI have found a XSS in oauth2 \r\n\r\nvulnerable link: https://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1);/////\u0026clientId=kav_subscribe\r\n\r\nsteps to reproduce:\r\n1) open the following link https://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1);/////\u0026clientId=kav_subscribe\r\n2) click Вернуться на сайт магазина\r\n3) you will a alert on the browser.\r\n\r\nVulnerable parameter: redirect=\r\npayload: javascript:alert(1);/////\r\nPOC: look for attached screenshot.\r\n\r\n\r\nThanks,\r\nkarthik","vulnerability_information_html":"\u003cp\u003eHey hi,\u003c/p\u003e\n\n\u003cp\u003eI have found a XSS in oauth2 \u003c/p\u003e\n\n\u003cp\u003evulnerable link: \u003ca title=\"https://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1)%3B/////\u0026amp;clientId=kav_subscribe\" href=\"/redirect?url=https%3A%2F%2Fqiwi.com%2Foauth%2Fconfirm.action%3Fredirect%3Djavascript%3Aalert%281%29%253B%2F%2F%2F%2F%2F%26clientId%3Dkav_subscribe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1)%3B/////\u0026amp;clientId=kav_subscribe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003esteps to reproduce:\u003cbr\u003e\n1) open the following link \u003ca title=\"https://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1)%3B/////\u0026amp;clientId=kav_subscribe\" href=\"/redirect?url=https%3A%2F%2Fqiwi.com%2Foauth%2Fconfirm.action%3Fredirect%3Djavascript%3Aalert%281%29%253B%2F%2F%2F%2F%2F%26clientId%3Dkav_subscribe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://qiwi.com/oauth/confirm.action?redirect=javascript:alert(1)%3B/////\u0026amp;clientId=kav_subscribe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) click Вернуться на сайт магазина\u003cbr\u003e\n3) you will a alert on the browser.\u003c/p\u003e\n\n\u003cp\u003eVulnerable parameter: redirect=\u003cbr\u003e\npayload: javascript:alert(1);/////\u003cbr\u003e\nPOC: look for attached screenshot.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nkarthik\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":20889,"file_name":"xssqiwi.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/020/889/81de98fc48e31ec25df7467789bdf13f7682a348/xssqiwi.png?response-content-disposition=attachment%3B%20filename%3D%22xssqiwi.png%22%3B%20filename%2A%3DUTF-8%27%27xssqiwi.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=77711cf89ae516e855c678f869732eff9f02bb4f09a0c3be32b19d8018ce6f91","file_size":41320,"type":"image/png"}],"allow_singular_disclosure_at":"2014-12-20T15:44:58.352Z","allow_singular_disclosure_after":-190130336.2881886,"singular_disclosure_allowed":true,"vote_count":1,"voters":["eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":161896,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T12:54:15.494Z","updated_at":"2014-11-17T12:54:15.494Z","additional_data":{"old_title":"Qiwi Ouath XSS","new_title":"[qiwi.com] /oauth/confirm.action XSS"},"actor":{"username":"videns","cleared":false,"url":"/videns","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":161922,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T13:07:12.751Z","updated_at":"2014-11-17T13:07:12.751Z","actor":{"username":"videns","cleared":false,"url":"/videns","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":165256,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":" Closed as XSS with user interaction (click) required.","markdown_message":"\u003cp\u003eClosed as XSS with user interaction (click) required.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-20T15:33:18.489Z","updated_at":"2014-11-20T15:33:18.489Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"akhil-reni","url":"/akhil-reni"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":165257,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-20T15:33:34.005Z","updated_at":"2014-11-20T15:33:34.005Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"akhil-reni","url":"/akhil-reni"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":165273,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Cool","markdown_message":"\u003cp\u003eCool\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-20T15:44:58.034Z","updated_at":"2014-11-20T15:44:58.034Z","first_to_agree":true,"actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":185452,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-12-20T15:45:07.385Z","updated_at":"2014-12-20T15:45:07.385Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}