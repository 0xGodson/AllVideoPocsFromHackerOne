{"id":118024,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTgwMjQ=","url":"https://hackerone.com/reports/118024","title":"Markdown based stored XSS (IE only)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-22T19:58:40.720Z","submitted_at":"2016-02-22T19:58:40.720Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"a0xnirudh","url":"/a0xnirudh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-03T22:28:08.622Z","bug_reporter_agreed_on_going_public_at":"2017-04-27T08:35:40.815Z","team_member_agreed_on_going_public_at":"2017-05-03T22:28:08.571Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nMy other report #116697 deals with any browser even through its not a direct XSS as it doesn't execute in the context of the site. But here is another type of XSS using `vbscript:` which affects only IE users but executes on the context of the site (check the screenshot for POC alert(document.domain)).\n\n### POC:\n\n`[clickme](vbscript:alert(document.domain))`\n\n`vbscript:` is not supported in Microsoft EDGE and updated versions of IE 11 (as per [this link](http://stackoverflow.com/questions/17483782/vbscript-support-in-internet-explorer-11) but it do works if people are working in the compatibility mode (I have read the gitlab instruction which specifically says users to turm off compatibility mode but if IE detects that the incoming webpages has some contents which is supported only on compatibility mode, it recommends that to the users I guess.).\n\nFor example, I comment the above link on one of the project/issues and then when I reloaded the page, IE detects that the incoming webpage contains scripts that might not be compatible and hence it told me to enable compatibility options by clicking a button. Usually if people see a warning like that from a browser, they will tend to enable it.\n\n### Mitigation\n\nOther then updated versions of IE 11, it works on IE10, 9, 8, 7. Also fixing this issue is so trivial by just blocking the keyword `vbscript` and since it executes on the context of the site, I believe this should be fixed.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eMy other report \u003ca href=\"/reports/116697\"\u003e#116697\u003c/a\u003e deals with any browser even through its not a direct XSS as it doesn\u0026#39;t execute in the context of the site. But here is another type of XSS using \u003ccode\u003evbscript:\u003c/code\u003e which affects only IE users but executes on the context of the site (check the screenshot for POC alert(document.domain)).\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePOC:\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003e[clickme](vbscript:alert(document.domain))\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003evbscript:\u003c/code\u003e is not supported in Microsoft EDGE and updated versions of IE 11 (as per \u003ca href=\"/redirect?url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2F17483782%2Fvbscript-support-in-internet-explorer-11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis link\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e but it do works if people are working in the compatibility mode (I have read the gitlab instruction which specifically says users to turm off compatibility mode but if IE detects that the incoming webpages has some contents which is supported only on compatibility mode, it recommends that to the users I guess.).\u003c/p\u003e\n\n\u003cp\u003eFor example, I comment the above link on one of the project/issues and then when I reloaded the page, IE detects that the incoming webpage contains scripts that might not be compatible and hence it told me to enable compatibility options by clicking a button. Usually if people see a warning like that from a browser, they will tend to enable it.\u003c/p\u003e\n\n\u003ch3 id=\"mitigation\"\u003eMitigation\u003c/h3\u003e\n\n\u003cp\u003eOther then updated versions of IE 11, it works on IE10, 9, 8, 7. Also fixing this issue is so trivial by just blocking the keyword \u003ccode\u003evbscript\u003c/code\u003e and since it executes on the context of the site, I believe this should be fixed.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":74791,"file_name":"gitlab_vbscript_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/074/791/6e2329985f88d277743e2cffd47afd6dd2248868/gitlab_vbscript_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22gitlab_vbscript_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27gitlab_vbscript_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZT5T356C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041922Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBcsqzm4YMyykC8pKAfuq22D6bSOUdyHaa8fIa4mUQhAAiEAiwPORMjouAw3a3uzUTZC%2BINQcpZp97MOQsVELFW4zLYqtAMIUBABGgwwMTM2MTkyNzQ4NDkiDKDiVMmiMU9V%2FMrmWyqRA4sIGIrOpHyvVZfmW2jMtAM8T%2B3ge7R5BW4DZ%2F780qW3KhtUb%2BlN4eJRg5WRaAT1yVb84a%2FkYNxsJD%2FuSvAe1wqOnVhU6s2QkIgwao%2BmXWZI5Gv75IeDf5AKwwqIEXhO%2BTfJ7qch1s5pk6yRn5dlzyaRdvpwfit2B%2BnXtVL4Ks0Z%2BsF2L1Sb9lQIKC%2FyiIIKOMM1XnEe09NuSw7Xf8Y6UOJpBJj7jLlVUmTMlaXhg0X5owu1jllReuJ1Ofketv8kjZlScgELVQhqeic8VvMdQFPk7uIxbwdUxI2D8U0mLOURF82HqwOSOvz3AjdFiUL5rInys31EjL5eLGhJJbviiWW1U6yAdtVgX5Dl9fG5sndUapgZ6tOzi5c%2FKiIqcs6TFB7V%2Ba94pbfE0ADF3Y25zJTundlOhWYZvSXJ2UVXh75JBOJYxsTgwZ5UgbsU6QjjUdK4ipM4ELoinryh%2FjoKyVb8ZjECBbMYtE22GC3vCLw7DmthiFcvoOPlRvKlah04sJNQ7b9KklIYWOG8BUX0xWhiMIC6qf8FOusB8i%2B4NEipXflNQqWCERI653SNHefieJr6qXk8vUjlyfvLnR2tXIQ%2FWyHufZZf0Rg4hKv79dttIkGWWsjFWimwSTHN9mTNskp6X9ZC4gvqOEnXuOZx%2Bxs2%2BUbYrNxuALH8x%2F%2FpM%2Fh0c4yBQF6OpSWOrWsdl5H%2BUIYyT8bSyRmCqToj58jXSS6GdhErBYuWCR9lbvOawRSwbxWyEGwvrNZPVRFC6gFj0nD1QwcZcdcCocD0zhQwtFu6F4LHGlpDLS8voy4%2BpFMo9RuKO1foe47wef9OHTulwBbLQCigHgaQeH2Lh7CupMWFI4rneA%3D%3D\u0026X-Amz-Signature=e6b9820a39f03a52898f7ab924ffd1c060622079079659330bef1f4a0213cb9d","file_size":69012,"type":"image/png"}],"allow_singular_disclosure_at":"2017-05-27T08:35:40.848Z","allow_singular_disclosure_after":-113341421.17147575,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","japz","a0xnirudh","sumit7","spetr0x","vishnuraj","jugno","safisec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":809650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the new report. I've created an internal issue for this and I'll report back on it. \n\nFeel free to get in touch with us at security@gitlab.com for additional followup or attention to a report.\n\nBest regards,\n\nJose","markdown_message":"\u003cp\u003eThanks for the new report. I\u0026#39;ve created an internal issue for this and I\u0026#39;ll report back on it. \u003c/p\u003e\n\n\u003cp\u003eFeel free to get in touch with us at \u003ca title=\"security@gitlab.com\" href=\"mailto:security@gitlab.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@gitlab.com\u003c/a\u003e for additional followup or attention to a report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJose\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-24T00:03:08.553Z","updated_at":"2016-02-24T00:03:08.553Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822624,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Issue has been resolved https://gitlab.com/gitlab-org/gitlab-ce/issues/13625. Thank you.","markdown_message":"\u003cp\u003eIssue has been resolved \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/13625\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F13625\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/13625\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-03T14:54:26.783Z","updated_at":"2016-03-03T14:54:26.783Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"a0xnirudh","url":"/a0xnirudh"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you'd like to be listed at our site https://about.gitlab.com/vulnerability-acknowledgements/ please send me your name and URL.","markdown_message":"\u003cp\u003eIf you\u0026#39;d like to be listed at our site \u003ca title=\"https://about.gitlab.com/vulnerability-acknowledgements/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2Fvulnerability-acknowledgements%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/vulnerability-acknowledgements/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e please send me your name and URL.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-03T14:59:54.693Z","updated_at":"2016-03-03T14:59:54.693Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822660,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jose \n\nThanks for the quick bug fix and resolving it. Really appreciate it.\n\nName: \u003ca href = \"https://twitter.com/a0xnirudh\"\u003eAnirudhAnand\u003c/a\u003e\nCompany: \u003ca href = \"https://www.0daylabs.com/\"\u003e0daylabs\u003c/a\u003e","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jose\"\u003e@jose\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for the quick bug fix and resolving it. Really appreciate it.\u003c/p\u003e\n\n\u003cp\u003eName: \u0026lt;a href = \u0026quot;https://twitter.com/a0xnirudh\u0026quot;\u0026gt;AnirudhAnand\u0026lt;/a\u0026gt;\u003cbr\u003e\nCompany: \u0026lt;a href = \u0026quot;https://www.0daylabs.com/\u0026quot;\u0026gt;0daylabs\u0026lt;/a\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-03T15:06:10.422Z","updated_at":"2016-03-03T15:06:10.422Z","actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Got it. I'll probably have to strip away the twitter link as per our internal conventions but everything else looks good. I've got this update scheduled for Tuesday. I'll report back here.","markdown_message":"\u003cp\u003eGot it. I\u0026#39;ll probably have to strip away the twitter link as per our internal conventions but everything else looks good. I\u0026#39;ve got this update scheduled for Tuesday. I\u0026#39;ll report back here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-03T15:11:35.437Z","updated_at":"2016-03-03T15:11:35.437Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right, its ok. Thanks, in the mean time, I will play with the application more and let you know if I come across more bugs.\n\nThanks !","markdown_message":"\u003cp\u003eAll right, its ok. Thanks, in the mean time, I will play with the application more and let you know if I come across more bugs.\u003c/p\u003e\n\n\u003cp\u003eThanks !\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-03T15:13:04.357Z","updated_at":"2016-03-03T15:13:04.357Z","actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAgain just a quick update to let you know that a MR for the vulnerability acknowledgment has been posted here https://gitlab.com/gitlab-com/www-gitlab-com/merge_requests/1676.\n\nBest regards,\n\nJosé Torres\nGitLab B.V.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAgain just a quick update to let you know that a MR for the vulnerability acknowledgment has been posted here \u003ca title=\"https://gitlab.com/gitlab-com/www-gitlab-com/merge_requests/1676\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-com%2Fwww-gitlab-com%2Fmerge_requests%2F1676\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-com/www-gitlab-com/merge_requests/1676\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosé Torres\u003cbr\u003e\nGitLab B.V.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-10T06:42:06.221Z","updated_at":"2016-03-10T06:42:06.221Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1639389,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-27T08:35:40.833Z","updated_at":"2017-04-27T08:35:40.833Z","first_to_agree":true,"actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652673,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-03T22:28:08.590Z","updated_at":"2017-05-03T22:28:08.590Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652674,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-03T22:28:08.638Z","updated_at":"2017-05-03T22:28:08.638Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}