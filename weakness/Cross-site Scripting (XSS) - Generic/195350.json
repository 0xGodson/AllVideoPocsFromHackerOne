{"id":195350,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUzNTA=","url":"https://hackerone.com/reports/195350","title":"Subdomain takeover on podcasts.slack-core.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-02T19:10:40.111Z","submitted_at":"2017-01-02T19:10:40.111Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"michiel","url":"/michiel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-01-04T21:01:06.238Z","bug_reporter_agreed_on_going_public_at":"2017-01-04T10:44:12.317Z","team_member_agreed_on_going_public_at":"2017-01-04T21:01:06.191Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I noticed `slack-core.com` is used for Slack's call infrastructure. I had never seen that domain before, so I decided to find out what else was running on it. It turned out `podcasts.slack-core.com` was pointing to a Podcast and RSS hosting service called Feed.Press. However, there was no Feed.Press account associated with `podcasts.slack-core.com`, which allowed me to register it and start serving my content from this domain. \n\nNote that since it is not on Slack's root domain, the impact of this vulnerability seems pretty minimal.\n\n# Proof of Concept\nHere we can see `podcasts.slack-core.com` is CNAME'd to `redirect.feedpress.me`:\n\n```plain\nmichiel@msp ~ $ dig podcasts.slack-core.com                                                                                         [2.1.9]\n\n; \u003c\u003c\u003e\u003e DiG 9.10.3-P4-Ubuntu \u003c\u003c\u003e\u003e podcasts.slack-core.com\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 1307\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 512\n;; QUESTION SECTION:\n;podcasts.slack-core.com.\tIN\tA\n\n;; ANSWER SECTION:\npodcasts.slack-core.com. 299\tIN\tCNAME\tredirect.feedpress.me.\nredirect.feedpress.me.\t3599\tIN\tA\t5.135.16.40\n\n;; Query time: 253 msec\n;; SERVER: 8.8.8.8#53(8.8.8.8)\n;; WHEN: Mon Jan 02 14:02:07 EST 2017\n;; MSG SIZE  rcvd: 103\n```\n\nBy creating my own account on [Feed.Press](https://feed.press), I was able to register `podcasts.slack-core.com` as my \"custom domain\" under my Feed.Press account. After it propagated through Feed.Press' systems, I was able to fully control the contents served as http://podcasts.slack-core.com.\n\nSince the domain was dormant, I decided to redirect `/` to https://hackerone.com as a proof of concept. We can see that happening using this `curl` command (note the `Location` header):\n\n```plain\nmichiel@msp ~ $ curl -vv http://podcasts.slack-core.com\n* Rebuilt URL to: http://podcasts.slack-core.com/\n*   Trying 5.135.16.40...\n* Connected to podcasts.slack-core.com (5.135.16.40) port 80 (#0)\n\u003e GET / HTTP/1.1\n\u003e Host: podcasts.slack-core.com\n\u003e User-Agent: curl/7.47.0\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 301 Moved Permanently\n\u003c Server: nginx\n\u003c Date: Mon, 02 Jan 2017 19:06:18 GMT\n\u003c Content-Type: text/html\n\u003c Content-Length: 178\n\u003c Location: https://hackerone.com\n\u003c X-Backend-Server: 172.16.0.53\n\u003c\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e301 Moved Permanently\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ccenter\u003e\u003ch1\u003e301 Moved Permanently\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003enginx\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n* Connection #0 to host podcasts.slack-core.com left intact\n```\n\n# Remediation\nSince the domain is not used anymore, it is recommended to remove the CNAME of `podcasts.slack-core.com` to `redirect.feedpress.me`. \n\nIf you need me to release the domain in Feed.Press itself, let me know and I'll remove it from my account.","vulnerability_information_html":"\u003cp\u003eI noticed \u003ccode\u003eslack-core.com\u003c/code\u003e is used for Slack\u0026#39;s call infrastructure. I had never seen that domain before, so I decided to find out what else was running on it. It turned out \u003ccode\u003epodcasts.slack-core.com\u003c/code\u003e was pointing to a Podcast and RSS hosting service called Feed.Press. However, there was no Feed.Press account associated with \u003ccode\u003epodcasts.slack-core.com\u003c/code\u003e, which allowed me to register it and start serving my content from this domain. \u003c/p\u003e\n\n\u003cp\u003eNote that since it is not on Slack\u0026#39;s root domain, the impact of this vulnerability seems pretty minimal.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h1\u003e\n\n\u003cp\u003eHere we can see \u003ccode\u003epodcasts.slack-core.com\u003c/code\u003e is CNAME\u0026#39;d to \u003ccode\u003eredirect.feedpress.me\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emichiel@msp ~ $ dig podcasts.slack-core.com                                                                                         [2.1.9]\n\n; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.3-P4-Ubuntu \u0026lt;\u0026lt;\u0026gt;\u0026gt; podcasts.slack-core.com\n;; global options: +cmd\n;; Got answer:\n;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 1307\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 512\n;; QUESTION SECTION:\n;podcasts.slack-core.com.   IN  A\n\n;; ANSWER SECTION:\npodcasts.slack-core.com. 299    IN  CNAME   redirect.feedpress.me.\nredirect.feedpress.me.  3599    IN  A   5.135.16.40\n\n;; Query time: 253 msec\n;; SERVER: 8.8.8.8#53(8.8.8.8)\n;; WHEN: Mon Jan 02 14:02:07 EST 2017\n;; MSG SIZE  rcvd: 103\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBy creating my own account on \u003ca href=\"/redirect?url=https%3A%2F%2Ffeed.press\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFeed.Press\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, I was able to register \u003ccode\u003epodcasts.slack-core.com\u003c/code\u003e as my \u0026quot;custom domain\u0026quot; under my Feed.Press account. After it propagated through Feed.Press\u0026#39; systems, I was able to fully control the contents served as \u003ca title=\"http://podcasts.slack-core.com\" href=\"/redirect?url=http%3A%2F%2Fpodcasts.slack-core.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://podcasts.slack-core.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eSince the domain was dormant, I decided to redirect \u003ccode\u003e/\u003c/code\u003e to \u003ca title=\"https://hackerone.com\" href=\"https://hackerone.com\"\u003ehttps://hackerone.com\u003c/a\u003e as a proof of concept. We can see that happening using this \u003ccode\u003ecurl\u003c/code\u003e command (note the \u003ccode\u003eLocation\u003c/code\u003e header):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emichiel@msp ~ $ curl -vv http://podcasts.slack-core.com\n* Rebuilt URL to: http://podcasts.slack-core.com/\n*   Trying 5.135.16.40...\n* Connected to podcasts.slack-core.com (5.135.16.40) port 80 (#0)\n\u0026gt; GET / HTTP/1.1\n\u0026gt; Host: podcasts.slack-core.com\n\u0026gt; User-Agent: curl/7.47.0\n\u0026gt; Accept: */*\n\u0026gt;\n\u0026lt; HTTP/1.1 301 Moved Permanently\n\u0026lt; Server: nginx\n\u0026lt; Date: Mon, 02 Jan 2017 19:06:18 GMT\n\u0026lt; Content-Type: text/html\n\u0026lt; Content-Length: 178\n\u0026lt; Location: https://hackerone.com\n\u0026lt; X-Backend-Server: 172.16.0.53\n\u0026lt;\n\u0026lt;html\u0026gt;\n\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;301 Moved Permanently\u0026lt;/title\u0026gt;\u0026lt;/head\u0026gt;\n\u0026lt;body bgcolor=\u0026quot;white\u0026quot;\u0026gt;\n\u0026lt;center\u0026gt;\u0026lt;h1\u0026gt;301 Moved Permanently\u0026lt;/h1\u0026gt;\u0026lt;/center\u0026gt;\n\u0026lt;hr\u0026gt;\u0026lt;center\u0026gt;nginx\u0026lt;/center\u0026gt;\n\u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\n* Connection #0 to host podcasts.slack-core.com left intact\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"remediation\"\u003eRemediation\u003c/h1\u003e\n\n\u003cp\u003eSince the domain is not used anymore, it is recommended to remove the CNAME of \u003ccode\u003epodcasts.slack-core.com\u003c/code\u003e to \u003ccode\u003eredirect.feedpress.me\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eIf you need me to release the domain in Feed.Press itself, let me know and I\u0026#39;ll remove it from my account.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-03T10:44:12.368Z","allow_singular_disclosure_after":-123098826.67011593,"singular_disclosure_allowed":true,"vote_count":25,"voters":["philip","jobert","spam404","sameerphad72","hat_mast3r","global4g","supernatural","madrobot","mpz","eveeez","and 15 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1397055,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-03T19:41:58.234Z","updated_at":"2017-01-03T19:41:58.234Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe're looking into this and will keep you updated when we have additional information.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re looking into this and will keep you updated when we have additional information.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-03T21:03:03.180Z","updated_at":"2017-01-03T21:03:03.180Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1397353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys - this was fixed really fast! :) The domain no longer resolves, and therefore this issue is resolved.","markdown_message":"\u003cp\u003eHi guys - this was fixed really fast! :) The domain no longer resolves, and therefore this issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-03T21:20:54.791Z","updated_at":"2017-01-03T21:20:54.791Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397846,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T00:56:20.768Z","updated_at":"2017-01-04T00:56:20.768Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":17062,"new_severity_id":17277},"actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397847,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We've resolved this issue, and are going to issue you a bounty!  Thanks for your report, and happy bug hunting in the future!  \n\nCheers,\nSlack","markdown_message":"\u003cp\u003eWe\u0026#39;ve resolved this issue, and are going to issue you a bounty!  Thanks for your report, and happy bug hunting in the future!  \u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nSlack\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-04T00:57:02.382Z","updated_at":"2017-01-04T00:57:02.382Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"michiel","url":"/michiel"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397848,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T00:57:08.195Z","updated_at":"2017-01-04T00:57:08.195Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"michiel","url":"/michiel"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1398340,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the fast turnaround!  ","markdown_message":"\u003cp\u003eThanks for the fast turnaround!  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-04T10:44:12.340Z","updated_at":"2017-01-04T10:44:12.340Z","first_to_agree":true,"actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399802,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T21:01:06.209Z","updated_at":"2017-01-04T21:01:06.209Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399803,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T21:01:06.256Z","updated_at":"2017-01-04T21:01:06.256Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}