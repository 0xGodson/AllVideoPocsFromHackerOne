{"id":156258,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTYyNTg=","url":"https://hackerone.com/reports/156258","title":"OX (Guard): Stored Cross-Site Scripting via Incoming Email","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-08-03T12:15:24.219Z","submitted_at":"2016-08-03T12:15:24.219Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dejavuln","url":"/dejavuln","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/045/064/2158310e1f704a15f20abf07331e73795f2e8153_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-27T10:47:29.422Z","bug_reporter_agreed_on_going_public_at":"2016-09-27T10:47:26.876Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\n\"OX Guard\" introduces a Stored Cross-Site Scripting (XSS) vulnerability to the frontend. \n\nHTML/JS code can be injected into the frontend through an incoming email. \n\nInjected code will be executed (= become part of the DOM) the moment the victim opens the email. \n\nThe vulnerability allows for various serious attacks, such as the exfiltration of potentially sensitive information related to emails, contacts, calendar and other modules.\n\n{F109325}\n{F109322}\n{F109323}\n\n## Vulnerability Details\n\n1. _**The attacker**_ crafts a text-only email containing malicious code and\n2. signs it with an inline PGP signature and\n3. sends it to the victim, who is using OX with OX Guard.\n4. _**The victim**_ opens the email in OX (portal, email module, possibly other locations).\n5. OX (Guard) automatically verifies the PGP signature and, if successful, \n6. displays the email body without the inline signature. \n\nStep 6 is where the frontend becomes vulnerable: the displayed email body is not sanitized. \n\nAs mentioned in step 5, the signature needs to be recognized as valid. In other words, OX (Guard) must have access to the attacker's public key. \n\n\nWhile this may initially appear to be a mitigating factor, OX (Guard) is capable of fetching public keys automatically if the key can be found either locally (\"on the same OX Guard system\") or remotely (\"Guard will use public PGP Key servers if configured to find PGP Public keys. In addition, Guard will also look up SRV records for PGP Key servers for a recipients domain\"). (Source: [OX Guard documentation](https://oxpedia.org/wiki/index.php?title=AppSuite:OX_Guard#Recipient_key_detection))\n\nThe attacker can abuse this \"key import\"  feature either by creating a key pair on the same OX (Guard) system, or by making his public key accessible via a public key server or SRV record. \n\nI have been able to confirm this behavior by observing the OX installation of a commercial, privacy-focused email provider. **The only thing required to use this vulnerability against any of their webmail users is the victim's email address**.\n\n\n## Proof of Concept\n\nSimple payload:\n```aaa \u003cimg src=x onerror=\"alert(1)\"\u003e bbb \u003cu\u003euuu\u003c/u\u003e ccc```\n\nSlightly more interesting payload; shows access to sensitive data:\n```aaa \u003cimg src=x onerror=\"alert('XSS@'+document.domain+'\\n\\n'+document.getElementsByTagName('html')[0].innerText)\"\u003e bbb \u003cu\u003euuu\u003c/u\u003e ccc```\n\nKeep in mind the code has to be placed in the body of a plain-text email and signed (not encrypted) inline (not MIME). I don't think it's possible to send such an email from within OX; I used a standalone client to craft these emails. \n\nAnyway, I'm attaching an email as a template for your own testing. If you're going to use it, you'll need my PGP key, which is referenced in the email's header: F109324 \n\nIf you can't get it to work at all, let me know and I'll send you the email myself.\n\n\n## Relevant Code (Frontend, Backend)\n\nI've had a _**quick**_ look at your code; below are some snippets that seemed relevant. I hope this will make it easier for you to assign the issue to the right developer. \n\nThis is where the unsanitized email body is inserted into the frontend:\n\n```\n./oxguard-ui/apps/oxguard/pgp/checker.js:84:\n    // Verify signature\n    function verify (index, baton, isinline, location) {\n    [...]\n        http.get(ox.apiRoot + '/oxguard/pgpmail?action=verify', params)\n        .done(function (data) {\n        [...]    \n            if (result.verified === true) {\n                signedicon = $('\u003ci class=\"oxguard_icon_fa fa-pencil-square-o fa guard_signed\" aria-hidden=\"true\" title=\"' + gt('This Email was signed and verified.') + '\"/\u003e');\n                if (isinline) {\n                    var newbody = $('\u003csection class=\"body user-select-text\"\u003e').append(result.content);\n                                                                               ^^^^^^^^^^^^^^^^^^^^^^\n```\n\njQuery documentation [http://api.jquery.com/append/](http://api.jquery.com/append/) on append():\n\n\u003e Do not use these methods to insert strings obtained from untrusted sources. [...]\n\u003e Doing so can introduce cross-site-scripting (XSS) vulnerabilities. \n\u003e Remove or escape any user input before adding content to the document. \n\n\nI believe the \"content\" originates from the following part of the backend code, where it becomes part of the JSON that will later be processed by the previously mentioned frontend code:\n\n```\n./com.openexchange.guard/src/com/openexchange/guard/pgp/PGPResult.java:87\n\n    public String getJsonString() {\n        JsonObject result = new JsonObject();\n        result.add(\"signature\", new JsonPrimitive(signature));\n        result.add(\"verified\", new JsonPrimitive(verified));\n        result.add(\"missingPublicKey\", new JsonPrimitive(missingPublicKey));\n        if (Strings.isNotEmpty(this.error)) {\n            result.addProperty(\"error\", error);\n        }\n        if (Strings.isNotEmpty(this.content)) {\n            result.add(\"content\", new JsonPrimitive(this.content));\t// \u003c=====\n        }\n        if (source != null) {\n        \tresult.add(\"source\", new JsonPrimitive(source.getName()));\n        }\n        return result.toString();\n    }\n```\n\n*NB: Code snippets were taken from the most recent commit to [https://code.open-xchange.com/git/guard](https://code.open-xchange.com/git/guard):*\n\n```\ncommit b6ebea2ca5f02dd739f37ca4b6592528cb6ca8bd\nDate:   Thu Jul 14 17:48:20 2016 +0200\n```","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003e\u0026quot;OX Guard\u0026quot; introduces a Stored Cross-Site Scripting (XSS) vulnerability to the frontend. \u003c/p\u003e\n\n\u003cp\u003eHTML/JS code can be injected into the frontend through an incoming email. \u003c/p\u003e\n\n\u003cp\u003eInjected code will be executed (= become part of the DOM) the moment the victim opens the email. \u003c/p\u003e\n\n\u003cp\u003eThe vulnerability allows for various serious attacks, such as the exfiltration of potentially sensitive information related to emails, contacts, calendar and other modules.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"sandbox-xss.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/325/ff6bfaf1cfcf299840c1bb3def661136f91ce5fd/sandbox-xss.png?response-content-disposition=attachment%3B%20filename%3D%22sandbox-xss.png%22%3B%20filename%2A%3DUTF-8%27%27sandbox-xss.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=2d70166e33bc429a971584bf785dda00a12ef4873b4b7868b447354dd9fc99a1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/325/ff6bfaf1cfcf299840c1bb3def661136f91ce5fd/sandbox-xss.png?response-content-disposition=attachment%3B%20filename%3D%22sandbox-xss.png%22%3B%20filename%2A%3DUTF-8%27%27sandbox-xss.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=2d70166e33bc429a971584bf785dda00a12ef4873b4b7868b447354dd9fc99a1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"local-mail.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/322/91baaa1d5b168c44901f2c44fee5e0af63c20611/local-mail.png?response-content-disposition=attachment%3B%20filename%3D%22local-mail.png%22%3B%20filename%2A%3DUTF-8%27%27local-mail.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=0e703b1fd56665ba9504469fd3e4649093b6532cee0d1358ddf359f53dc4b452\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/322/91baaa1d5b168c44901f2c44fee5e0af63c20611/local-mail.png?response-content-disposition=attachment%3B%20filename%3D%22local-mail.png%22%3B%20filename%2A%3DUTF-8%27%27local-mail.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=0e703b1fd56665ba9504469fd3e4649093b6532cee0d1358ddf359f53dc4b452\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"local-portal.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/323/bde3d3fe0947c9d05f90384a66ff77ee288b2d35/local-portal.png?response-content-disposition=attachment%3B%20filename%3D%22local-portal.png%22%3B%20filename%2A%3DUTF-8%27%27local-portal.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=18f226116d86a1c061b231c1527c4e356d46df058fd4a31b6b9224c6b5e818e0\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/323/bde3d3fe0947c9d05f90384a66ff77ee288b2d35/local-portal.png?response-content-disposition=attachment%3B%20filename%3D%22local-portal.png%22%3B%20filename%2A%3DUTF-8%27%27local-portal.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=18f226116d86a1c061b231c1527c4e356d46df058fd4a31b6b9224c6b5e818e0\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-details\"\u003eVulnerability Details\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cu\u003e\u003cstrong\u003eThe attacker\u003c/strong\u003e\u003c/u\u003e crafts a text-only email containing malicious code and\u003c/li\u003e\n\u003cli\u003esigns it with an inline PGP signature and\u003c/li\u003e\n\u003cli\u003esends it to the victim, who is using OX with OX Guard.\u003c/li\u003e\n\u003cli\u003e\n\u003cu\u003e\u003cstrong\u003eThe victim\u003c/strong\u003e\u003c/u\u003e opens the email in OX (portal, email module, possibly other locations).\u003c/li\u003e\n\u003cli\u003eOX (Guard) automatically verifies the PGP signature and, if successful, \u003c/li\u003e\n\u003cli\u003edisplays the email body without the inline signature. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eStep 6 is where the frontend becomes vulnerable: the displayed email body is not sanitized. \u003c/p\u003e\n\n\u003cp\u003eAs mentioned in step 5, the signature needs to be recognized as valid. In other words, OX (Guard) must have access to the attacker\u0026#39;s public key. \u003c/p\u003e\n\n\u003cp\u003eWhile this may initially appear to be a mitigating factor, OX (Guard) is capable of fetching public keys automatically if the key can be found either locally (\u0026quot;on the same OX Guard system\u0026quot;) or remotely (\u0026quot;Guard will use public PGP Key servers if configured to find PGP Public keys. In addition, Guard will also look up SRV records for PGP Key servers for a recipients domain\u0026quot;). (Source: \u003ca href=\"/redirect?url=https%3A%2F%2Foxpedia.org%2Fwiki%2Findex.php%3Ftitle%3DAppSuite%3AOX_Guard%23Recipient_key_detection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eOX Guard documentation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eThe attacker can abuse this \u0026quot;key import\u0026quot;  feature either by creating a key pair on the same OX (Guard) system, or by making his public key accessible via a public key server or SRV record. \u003c/p\u003e\n\n\u003cp\u003eI have been able to confirm this behavior by observing the OX installation of a commercial, privacy-focused email provider. \u003cstrong\u003eThe only thing required to use this vulnerability against any of their webmail users is the victim\u0026#39;s email address\u003c/strong\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\n\u003cp\u003eSimple payload:\u003cbr\u003e\n\u003ccode\u003eaaa \u0026lt;img src=x onerror=\u0026quot;alert(1)\u0026quot;\u0026gt; bbb \u0026lt;u\u0026gt;uuu\u0026lt;/u\u0026gt; ccc\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eSlightly more interesting payload; shows access to sensitive data:\u003cbr\u003e\n\u003ccode\u003eaaa \u0026lt;img src=x onerror=\u0026quot;alert(\u0026#39;XSS@\u0026#39;+document.domain+\u0026#39;\\n\\n\u0026#39;+document.getElementsByTagName(\u0026#39;html\u0026#39;)[0].innerText)\u0026quot;\u0026gt; bbb \u0026lt;u\u0026gt;uuu\u0026lt;/u\u0026gt; ccc\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eKeep in mind the code has to be placed in the body of a plain-text email and signed (not encrypted) inline (not MIME). I don\u0026#39;t think it\u0026#39;s possible to send such an email from within OX; I used a standalone client to craft these emails. \u003c/p\u003e\n\n\u003cp\u003eAnyway, I\u0026#39;m attaching an email as a template for your own testing. If you\u0026#39;re going to use it, you\u0026#39;ll need my PGP key, which is referenced in the email\u0026#39;s header: \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"00000004.msg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/324/b8d81c2207c2d13d93581eae3579907eefa570fc/00000004.msg?response-content-disposition=attachment%3B%20filename%3D%2200000004.msg%22%3B%20filename%2A%3DUTF-8%27%2700000004.msg\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043515Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=5ddf7bb6218d2971c23ee64a27fbce41bf4d2f267729a38ace9f405236073499\" data-attachment-type=\"text/plain\"\u003e00000004.msg (F109324)\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eIf you can\u0026#39;t get it to work at all, let me know and I\u0026#39;ll send you the email myself.\u003c/p\u003e\n\n\u003ch2 id=\"relevant-code-frontend-backend\"\u003eRelevant Code (Frontend, Backend)\u003c/h2\u003e\n\n\u003cp\u003eI\u0026#39;ve had a \u003cu\u003e\u003cstrong\u003equick\u003c/strong\u003e\u003c/u\u003e look at your code; below are some snippets that seemed relevant. I hope this will make it easier for you to assign the issue to the right developer. \u003c/p\u003e\n\n\u003cp\u003eThis is where the unsanitized email body is inserted into the frontend:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e./oxguard-ui/apps/oxguard/pgp/checker.js:84:\n    // Verify signature\n    function verify (index, baton, isinline, location) {\n    [...]\n        http.get(ox.apiRoot + \u0026#39;/oxguard/pgpmail?action=verify\u0026#39;, params)\n        .done(function (data) {\n        [...]    \n            if (result.verified === true) {\n                signedicon = $(\u0026#39;\u0026lt;i class=\u0026quot;oxguard_icon_fa fa-pencil-square-o fa guard_signed\u0026quot; aria-hidden=\u0026quot;true\u0026quot; title=\u0026quot;\u0026#39; + gt(\u0026#39;This Email was signed and verified.\u0026#39;) + \u0026#39;\u0026quot;/\u0026gt;\u0026#39;);\n                if (isinline) {\n                    var newbody = $(\u0026#39;\u0026lt;section class=\u0026quot;body user-select-text\u0026quot;\u0026gt;\u0026#39;).append(result.content);\n                                                                               ^^^^^^^^^^^^^^^^^^^^^^\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ejQuery documentation \u003ca href=\"/redirect?url=http%3A%2F%2Fapi.jquery.com%2Fappend%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://api.jquery.com/append/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on append():\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDo not use these methods to insert strings obtained from untrusted sources. [...]\u003cbr\u003e\nDoing so can introduce cross-site-scripting (XSS) vulnerabilities. \u003cbr\u003e\nRemove or escape any user input before adding content to the document. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI believe the \u0026quot;content\u0026quot; originates from the following part of the backend code, where it becomes part of the JSON that will later be processed by the previously mentioned frontend code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e./com.openexchange.guard/src/com/openexchange/guard/pgp/PGPResult.java:87\n\n    public String getJsonString() {\n        JsonObject result = new JsonObject();\n        result.add(\u0026quot;signature\u0026quot;, new JsonPrimitive(signature));\n        result.add(\u0026quot;verified\u0026quot;, new JsonPrimitive(verified));\n        result.add(\u0026quot;missingPublicKey\u0026quot;, new JsonPrimitive(missingPublicKey));\n        if (Strings.isNotEmpty(this.error)) {\n            result.addProperty(\u0026quot;error\u0026quot;, error);\n        }\n        if (Strings.isNotEmpty(this.content)) {\n            result.add(\u0026quot;content\u0026quot;, new JsonPrimitive(this.content)); // \u0026lt;=====\n        }\n        if (source != null) {\n            result.add(\u0026quot;source\u0026quot;, new JsonPrimitive(source.getName()));\n        }\n        return result.toString();\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cem\u003eNB: Code snippets were taken from the most recent commit to \u003ca href=\"/redirect?url=https%3A%2F%2Fcode.open-xchange.com%2Fgit%2Fguard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://code.open-xchange.com/git/guard\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecommit b6ebea2ca5f02dd739f37ca4b6592528cb6ca8bd\nDate:   Thu Jul 14 17:48:20 2016 +0200\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":109322,"file_name":"local-mail.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/322/91baaa1d5b168c44901f2c44fee5e0af63c20611/local-mail.png?response-content-disposition=attachment%3B%20filename%3D%22local-mail.png%22%3B%20filename%2A%3DUTF-8%27%27local-mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=0e703b1fd56665ba9504469fd3e4649093b6532cee0d1358ddf359f53dc4b452","file_size":56990,"type":"image/png"},{"id":109323,"file_name":"local-portal.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/323/bde3d3fe0947c9d05f90384a66ff77ee288b2d35/local-portal.png?response-content-disposition=attachment%3B%20filename%3D%22local-portal.png%22%3B%20filename%2A%3DUTF-8%27%27local-portal.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=18f226116d86a1c061b231c1527c4e356d46df058fd4a31b6b9224c6b5e818e0","file_size":87321,"type":"image/png"},{"id":109324,"file_name":"00000004.msg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/324/b8d81c2207c2d13d93581eae3579907eefa570fc/00000004.msg?response-content-disposition=attachment%3B%20filename%3D%2200000004.msg%22%3B%20filename%2A%3DUTF-8%27%2700000004.msg\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=5ddf7bb6218d2971c23ee64a27fbce41bf4d2f267729a38ace9f405236073499","file_size":1910,"type":"text/plain"},{"id":109325,"file_name":"sandbox-xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/325/ff6bfaf1cfcf299840c1bb3def661136f91ce5fd/sandbox-xss.png?response-content-disposition=attachment%3B%20filename%3D%22sandbox-xss.png%22%3B%20filename%2A%3DUTF-8%27%27sandbox-xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=2d70166e33bc429a971584bf785dda00a12ef4873b4b7868b447354dd9fc99a1","file_size":71798,"type":"image/png"}],"allow_singular_disclosure_at":"2016-10-27T10:47:27.063Z","allow_singular_disclosure_after":-131651268.1084333,"singular_disclosure_allowed":true,"vote_count":48,"voters":["b1ngz","hunter","iamnoooob","michiel","bogdantcaciuc","psaux","yaworsk","ebrietas","cmd-0_0","0xsyndr0me","and 38 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1103958,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Great find and perfect report, thanks a lot! :-)","markdown_message":"\u003cp\u003eGreat find and perfect report, thanks a lot! :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-03T13:05:46.279Z","updated_at":"2016-08-03T13:05:46.279Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1103960,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our uses. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our uses. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-03T13:06:14.897Z","updated_at":"2016-08-03T13:06:14.897Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1103978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Would you like to be included in our advisories \"researcher credits\"?\n\nYes, I would appreciate that. Please use my full name (Benjamin Daniel Mussler). \n\nIf your researcher credits include contact information, you can use either \"https://fl7.de\" or my Twitter handle \"@dejavuln\". \n\nThank you. \n\n\n\n\n\n","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eWould you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes, I would appreciate that. Please use my full name (Benjamin Daniel Mussler). \u003c/p\u003e\n\n\u003cp\u003eIf your researcher credits include contact information, you can use either \u0026quot;\u003ca title=\"https://fl7.de\" href=\"/redirect?url=https%3A%2F%2Ffl7.de\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://fl7.de\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; or my Twitter handle \u0026quot;@dejavuln\u0026quot;. \u003c/p\u003e\n\n\u003cp\u003eThank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-03T13:29:41.303Z","updated_at":"2016-08-03T13:29:41.303Z","actor":{"username":"dejavuln","cleared":false,"url":"/dejavuln","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/064/2158310e1f704a15f20abf07331e73795f2e8153_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1121214,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-12T06:34:21.944Z","updated_at":"2016-08-12T06:34:21.944Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"dejavuln","url":"/dejavuln"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1121215,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The vulnerability will be solved and deployed shortly, closing this report as Resolved since we're not tracking defect resolution via hackerone.","markdown_message":"\u003cp\u003eThe vulnerability will be solved and deployed shortly, closing this report as Resolved since we\u0026#39;re not tracking defect resolution via hackerone.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-12T06:34:32.095Z","updated_at":"2016-08-12T06:34:32.095Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dejavuln","url":"/dejavuln"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1218534,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-27T10:47:26.959Z","updated_at":"2016-09-27T10:47:26.959Z","first_to_agree":true,"actor":{"username":"dejavuln","cleared":false,"url":"/dejavuln","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/064/2158310e1f704a15f20abf07331e73795f2e8153_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270663,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-27T10:47:29.442Z","updated_at":"2016-10-27T10:47:29.442Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4917028,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:21:06.206Z","updated_at":"2019-05-24T12:21:06.206Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":401122},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":2847,"category":"researcher","content":"CVE-ID: CVE-2016-6854\nRelated Open-Xchange Advisory: http://seclists.org/bugtraq/2016/Sep/14","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eCVE-ID: CVE-2016-6854\u003cbr\u003e\nRelated Open-Xchange Advisory: \u003ca title=\"http://seclists.org/bugtraq/2016/Sep/14\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Fbugtraq%2F2016%2FSep%2F14\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/bugtraq/2016/Sep/14\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}