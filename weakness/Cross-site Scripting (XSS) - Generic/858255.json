{"id":858255,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTgyNTU=","url":"https://hackerone.com/reports/858255","title":"Cross site scripting - XSRF Token","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-24T06:13:55.678Z","submitted_at":"2020-04-24T06:13:55.678Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"a9hora","url":"/a9hora","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/mrcDk9UGFz61ExLfVXv3XRCs/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-14T10:40:47.524Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-05-15T10:40:46.715Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Please follow below mentioned steps for reproducing the vulnerability.\n1. Open URL: https://nextcloud.com/enterprise/buy/\n2. Fill up valid name and email address and put payload in other fields.\n    \n    Payload/s:\n\t\t\t\u003cimg src=\"x\" onload=alert(document.cookie);\u003e\n\t\t\t\u003csvg/onload=alert(document.cookie);\u003e\t\n3. Submit it\n4. Open email address you mentioned in the email field.\n5. Open up the email source.\n6. You will be prompted with xsrf-token.\n\n## Impact\n\nAs an attacker is getting the xsrf-token, he can utilize it in later attack such as, CSRF.","vulnerability_information_html":"\u003cp\u003ePlease follow below mentioned steps for reproducing the vulnerability.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen URL: \u003ca title=\"https://nextcloud.com/enterprise/buy/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fenterprise%2Fbuy%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/enterprise/buy/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFill up valid name and email address and put payload in other fields.\u003c/p\u003e\n\n\u003cp\u003ePayload/s:\u003cbr\u003e\n        \u0026lt;img src=\u0026quot;x\u0026quot; onload=alert(document.cookie);\u0026gt;\u003cbr\u003e\n        \u0026lt;svg/onload=alert(document.cookie);\u0026gt;    \u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSubmit it\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOpen email address you mentioned in the email field.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOpen up the email source.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYou will be prompted with xsrf-token.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAs an attacker is getting the xsrf-token, he can utilize it in later attack such as, CSRF.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":801778,"file_name":"XSS-XSRF_Token_PoC.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/B63exAaYe4PsAd7weq4hpsEa?response-content-disposition=attachment%3B%20filename%3D%22XSS-XSRF_Token_PoC.mp4%22%3B%20filename%2A%3DUTF-8%27%27XSS-XSRF_Token_PoC.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070224Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=45259dcfa8a40ae96dab6bac3177524efa5f0de658a3bf11a7d7fae6cdb27040","file_size":6535944,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-06-14T10:40:46.785Z","allow_singular_disclosure_after":-17094097.810837567,"singular_disclosure_allowed":true,"vote_count":32,"voters":["everybodyhurts","brahim_boufakri01","mygf","sa1tama0","b69fb2ebda43240ece9dbeb","asusrog","franksecuritynl","cyberroot","deepak_p9018","khairizakaria","and 22 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":56,"asset_type":"URL","asset_identifier":"https://nextcloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7777438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-04-24T06:13:56.050Z","updated_at":"2020-04-24T06:13:56.050Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7971140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @a9hora,\n\nThanks for your report.\nWe'll look into it.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi \u003ca href=\"/a9hora\"\u003e@a9hora\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report.\u003cbr\u003e\nWe\u0026#39;ll look into it.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T07:18:25.275Z","updated_at":"2020-05-12T07:18:25.275Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8008198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed now, can you confirm?","markdown_message":"\u003cp\u003eThis should be fixed now, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T09:13:45.816Z","updated_at":"2020-05-15T09:13:45.816Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8008200,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-15T09:13:52.302Z","updated_at":"2020-05-15T09:13:52.302Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8008901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickvergessen,\n\nThank you for responding on my very first bug bounty attempt.\nAs I can see this issue is fixed now.\n\nThank you.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickvergessen\"\u003e@nickvergessen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for responding on my very first bug bounty attempt.\u003cbr\u003e\nAs I can see this issue is fixed now.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T09:32:36.512Z","updated_at":"2020-05-15T09:33:46.328Z","actor":{"username":"a9hora","cleared":false,"url":"/a9hora","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mrcDk9UGFz61ExLfVXv3XRCs/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8009463,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again.","markdown_message":"\u003cp\u003eThanks a lot for your report again.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T10:39:25.714Z","updated_at":"2020-05-15T10:39:25.714Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"a9hora","url":"/a9hora"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8009477,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Issues in our website are not eligible for bounties","markdown_message":"\u003cp\u003eIssues in our website are not eligible for bounties\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T10:40:40.257Z","updated_at":"2020-05-15T10:40:40.257Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8009480,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-15T10:40:46.736Z","updated_at":"2020-05-15T10:40:46.736Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8058816,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nextcloud thank you for your response.\nAs I already know that the reported issue is not eligible for bounties, though It would be a good motivation if you acknowledge my first ever attempt of bug bounty by email at (technotest55@protonmail.com) by mentioning my hackerone name A9HORA.\nThank you in advanced.","markdown_message":"\u003cp\u003e\u003ca href=\"/nextcloud\"\u003e@nextcloud\u003c/a\u003e thank you for your response.\u003cbr\u003e\nAs I already know that the reported issue is not eligible for bounties, though It would be a good motivation if you acknowledge my first ever attempt of bug bounty by email at (\u003ca title=\"technotest55@protonmail.com\" href=\"mailto:technotest55@protonmail.com\" rel=\"nofollow noopener noreferrer\"\u003etechnotest55@protonmail.com\u003c/a\u003e) by mentioning my hackerone name A9HORA.\u003cbr\u003e\nThank you in advanced.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-20T13:49:07.870Z","updated_at":"2020-05-20T13:49:07.870Z","actor":{"username":"a9hora","cleared":false,"url":"/a9hora","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mrcDk9UGFz61ExLfVXv3XRCs/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8234576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry we don't create SAs for our own website. Only for our products.\nIf you happen to find a security issue in the Nextcloud source code we will do that :)","markdown_message":"\u003cp\u003eSorry we don\u0026#39;t create SAs for our own website. Only for our products.\u003cbr\u003e\nIf you happen to find a security issue in the Nextcloud source code we will do that :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-08T16:59:55.680Z","updated_at":"2020-06-08T16:59:55.680Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8286729,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-14T10:40:47.576Z","updated_at":"2020-06-14T10:40:47.576Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}