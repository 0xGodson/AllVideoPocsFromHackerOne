{"id":202354,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDIzNTQ=","url":"https://hackerone.com/reports/202354","title":"Stored XSS / Bypassing .htaccess protection in http://nodebb.ubnt.com/","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-01-31T13:34:43.035Z","submitted_at":"2017-01-31T13:34:43.035Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-28T07:23:26.659Z","bug_reporter_agreed_on_going_public_at":"2017-08-29T07:23:24.206Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nWhile I was looking at your renewn SSL certificated, I have noticed the following link : http://nodebb.ubnt.com/\n\nI have seen that this link was protected by htaccess password, but I have decided to run a nmap scan. By running the following :\n\n```\nsudo nmap -sSV -p- 104.131.159.88 -oA stage_ph -T4\n```\n\none of the open ports was this : `4567/tcp open   tram?`\n\nAnd, to my surprise the ip `104.131.159.88:4567`, as well as `http://nodebb.ubnt.com:4567/` were available from internet and unprotected.\n\nHere, I have found a nodeBB instance and I have managed to create a persisted XSS by using the  upload API, that does not properly sanitize the file names and automatically sets wrong mime types. \n\nNormally, it seems that the user is allowed to upload only images, but the stored XSS was possible by injecting malicious html in the exif data and changing the file name to .html.\n\nI have attached a video with the POC, as well as the exif image.\n\nI have not managed to RCE, but it is also worth noting that uploading the file with the .php extension and writing php content using exif IS possible.\n\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eWhile I was looking at your renewn SSL certificated, I have noticed the following link : \u003ca title=\"http://nodebb.ubnt.com/\" href=\"/redirect?url=http%3A%2F%2Fnodebb.ubnt.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://nodebb.ubnt.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI have seen that this link was protected by htaccess password, but I have decided to run a nmap scan. By running the following :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003esudo nmap -sSV -p- 104.131.159.88 -oA stage_ph -T4\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eone of the open ports was this : \u003ccode\u003e4567/tcp open   tram?\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd, to my surprise the ip \u003ccode\u003e104.131.159.88:4567\u003c/code\u003e, as well as \u003ccode\u003ehttp://nodebb.ubnt.com:4567/\u003c/code\u003e were available from internet and unprotected.\u003c/p\u003e\n\n\u003cp\u003eHere, I have found a nodeBB instance and I have managed to create a persisted XSS by using the  upload API, that does not properly sanitize the file names and automatically sets wrong mime types. \u003c/p\u003e\n\n\u003cp\u003eNormally, it seems that the user is allowed to upload only images, but the stored XSS was possible by injecting malicious html in the exif data and changing the file name to .html.\u003c/p\u003e\n\n\u003cp\u003eI have attached a video with the POC, as well as the exif image.\u003c/p\u003e\n\n\u003cp\u003eI have not managed to RCE, but it is also worth noting that uploading the file with the .php extension and writing php content using exif IS possible.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":156302,"file_name":"exif.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/156/302/01e6a2517e0c9f93fb3c04654f9c34b2c8037818/exif.jpg?response-content-disposition=attachment%3B%20filename%3D%22exif.jpg%22%3B%20filename%2A%3DUTF-8%27%27exif.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3BIZ4JTU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045347Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDCqQsLMvYqK8Fn0GTGiLsXz5M8tY4soJZygdoXv5QEQAIgCyKzbKJdYVXE7%2F2vaqKKjTCLEh%2Fh%2BJKa%2B0XuR0hsEFUqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDLR6kgVshwHIKyeb6iqRA2MFJpPkZrhx3t6AejIGud%2FxGIWTN2PoGCZioXicg1VZZgMq5uaPSAxNNXocaSomclyhf%2B4rJe2NLnNAFrXhEGbulvXBmkmO3c%2BD1qqEXyp6qcE41xoYCshBNytJdSH%2BZLTkpaCox4H3NJ6CH%2Bfflh7STpyLJOhPOuoFBY2ARN4mLdeBNYSs61C8zzgM1WQDBhFMxgMb7vKIJ1dmuPynnD4cKxw%2FWKOaq4NfJudL5XP2lTarTb4xTPf3vkoagtHONFoVfop3fmgabccyD5073szNTxXapdwAVZzs9R7zo8NryIyGlYETmxKma4s0cUHjxtmLxK48pLT0PIi7RZmyxoES3J9QTPpynp9iBtI5QalJxwB2tncxj9MMn9FCqJ1bzmYGaodAVxgE3jvslHp5jSM%2Fa1ljSf8SmNJrP91wkWRf4uVZMFej6WQDf8glru%2BoEB1%2FYut3mcF783rDVabhOcofZMw%2BHz6ACFg0WnuWtpGqDpIcX0PQQ%2FoYL%2BmsAiBEElGWlx6CHhWkYkEEJRUVb4ZXMK38qf8FOusBe7etUydbe6JZ8fKykaXtOPxCu8iTA%2FElzyhp13PbtTDj33DNPynSKOmKukTuY24fr3DCAPr5hsRSqBR1%2Ba8d9PI2IvIU4Avj2sJzGWzPQZqC0yDuDhW7b1Hlw1obEAxs3X5bDEbon1OT%2FNhVXLOjpX6Tgp0e%2FX9uw%2FNELi9ZDp%2F4R20Hnj3eXjNGpomDVtKhE43xUUHq1cwYK5VNgPoPIFeCXGybJOtMWcGWoFDEfI0CPBvkCnoRsX0aaemkRB8e4CYE0aYJNO%2BizSsaZzOxO9oeciDAN9toV%2BloBz7WYCb61lChRw6E6vCQyg%3D%3D\u0026X-Amz-Signature=5419e6f26274748bdc00dc168c9812319bbe469ccb4b6f7a42fd1b36e8d003b3","file_size":11515,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2017-09-28T07:23:24.237Z","allow_singular_disclosure_after":-102634223.37766488,"singular_disclosure_allowed":true,"vote_count":9,"voters":["jensec","bl4de","michan","vijay_kumar","eveeez","r3y","mr_r3boot","t-4-y-m","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1456176,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-01T14:24:58.038Z","updated_at":"2017-02-01T14:24:58.038Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @inhibitor181,\n\nThe site nodebb.ubnt.com isn't in the scope of this program, and normally would not receive rewards because is beta and is 3rd party hosted, but because this XSS could affect a user that receive a link to this page, we decided to give you a reward anyway.\n\nThanks","markdown_message":"\u003cp\u003eHi \u003ca href=\"/inhibitor181\"\u003e@inhibitor181\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe site nodebb.ubnt.com isn\u0026#39;t in the scope of this program, and normally would not receive rewards because is beta and is 3rd party hosted, but because this XSS could affect a user that receive a link to this page, we decided to give you a reward anyway.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T14:28:58.203Z","updated_at":"2017-02-01T14:28:58.203Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456188,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-01T14:29:19.245Z","updated_at":"2017-02-01T14:29:19.245Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456190,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-01T14:29:27.152Z","updated_at":"2017-02-01T14:29:27.152Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456210,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ubnt-rubens . Thanks for the bounty.\n\nI did not realized this was not hosted by ubnt.com as nslookup just answered with `Address: 104.131.159.88`. And true, beta applications are out of scope, but there wasn't any proper identification that this was beta :P (no stg, dev or testing identification in URL).\n\nAnyway, thanks and best of luck","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ubnt-rubens\"\u003e@ubnt-rubens\u003c/a\u003e . Thanks for the bounty.\u003c/p\u003e\n\n\u003cp\u003eI did not realized this was not hosted by ubnt.com as nslookup just answered with \u003ccode\u003eAddress: 104.131.159.88\u003c/code\u003e. And true, beta applications are out of scope, but there wasn\u0026#39;t any proper identification that this was beta :P (no stg, dev or testing identification in URL).\u003c/p\u003e\n\n\u003cp\u003eAnyway, thanks and best of luck\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T14:39:40.475Z","updated_at":"2017-02-01T14:39:40.475Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1962215,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-29T07:23:24.222Z","updated_at":"2017-08-29T07:23:24.222Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029281,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T07:23:26.678Z","updated_at":"2017-09-28T07:23:26.678Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}