{"id":117480,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTc0ODA=","url":"https://hackerone.com/reports/117480","title":"Stored XSS via Angular Expression injection on developer.zendesk.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-19T18:25:48.676Z","submitted_at":"2016-02-19T18:25:48.676Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-01T21:15:09.461Z","bug_reporter_agreed_on_going_public_at":"2016-05-28T12:32:06.476Z","team_member_agreed_on_going_public_at":"2016-06-01T21:15:09.350Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"developer.zendesk.com is vulnerable to stored XSS via Angular template injection.\n\nTo replicate:\nBrowse to https://developer.zendesk.com\nSign up with an arbitrary email address and the following name: \"{{'a'.constructor.prototype.charAt=[].join;$eval('x=alert(1)');}}\"\nObserve the popup. \n\nThis is a stored vulnerability - every time that user views https://developer.zendesk.com/account it will hit them.\n\nThis is not self-xss - it's possible to exploit other users by using the intentional XSS on freetrial.zendesk.com to inject a cookie into other users' browsers, forcibly logging them into my account. \n\n\nClient-side template injection vulnerabilities arise when applications using a client-side template framework dynamically embed user input in web pages. When a web page is rendered, the framework will scan the page for template expressions, and execute any that it encounters. An attacker can exploit this by supplying a malicious template expression that launches a cross-site scripting (XSS) attack.\n\nIf possible, avoid using server-side code to dynamically embed user input into client-side templates. You can prevent angular from executing expressions in blocks of HTML by using the ng-non-bindable directive: https://docs.angularjs.org/api/ng/directive/ngNonBindable If this is not practical, consider filtering out { and } from user input. Upgrading to Angular 1.5 will prevent this particular sandbox escape from working, but is not a robust fix as Angular maintain that the sandbox isn't a security feature and can't be trusted - see https://sites.google.com/site/bughunteruniversity/nonvuln/angularjs-expression-sandbox-bypass\n\nPlease refer to http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html for further information on this technique.","vulnerability_information_html":"\u003cp\u003edeveloper.zendesk.com is vulnerable to stored XSS via Angular template injection.\u003c/p\u003e\n\n\u003cp\u003eTo replicate:\u003cbr\u003e\nBrowse to \u003ca title=\"https://developer.zendesk.com\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.zendesk.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.zendesk.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nSign up with an arbitrary email address and the following name: \u0026quot;{{\u0026#39;a\u0026#39;.constructor.prototype.charAt=[].join;$eval(\u0026#39;x=alert(1)\u0026#39;);}}\u0026quot;\u003cbr\u003e\nObserve the popup. \u003c/p\u003e\n\n\u003cp\u003eThis is a stored vulnerability - every time that user views \u003ca title=\"https://developer.zendesk.com/account\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.zendesk.com%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.zendesk.com/account\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e it will hit them.\u003c/p\u003e\n\n\u003cp\u003eThis is not self-xss - it\u0026#39;s possible to exploit other users by using the intentional XSS on freetrial.zendesk.com to inject a cookie into other users\u0026#39; browsers, forcibly logging them into my account. \u003c/p\u003e\n\n\u003cp\u003eClient-side template injection vulnerabilities arise when applications using a client-side template framework dynamically embed user input in web pages. When a web page is rendered, the framework will scan the page for template expressions, and execute any that it encounters. An attacker can exploit this by supplying a malicious template expression that launches a cross-site scripting (XSS) attack.\u003c/p\u003e\n\n\u003cp\u003eIf possible, avoid using server-side code to dynamically embed user input into client-side templates. You can prevent angular from executing expressions in blocks of HTML by using the ng-non-bindable directive: \u003ca title=\"https://docs.angularjs.org/api/ng/directive/ngNonBindable\" href=\"/redirect?url=https%3A%2F%2Fdocs.angularjs.org%2Fapi%2Fng%2Fdirective%2FngNonBindable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.angularjs.org/api/ng/directive/ngNonBindable\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e If this is not practical, consider filtering out { and } from user input. Upgrading to Angular 1.5 will prevent this particular sandbox escape from working, but is not a robust fix as Angular maintain that the sandbox isn\u0026#39;t a security feature and can\u0026#39;t be trusted - see \u003ca title=\"https://sites.google.com/site/bughunteruniversity/nonvuln/angularjs-expression-sandbox-bypass\" href=\"/redirect?url=https%3A%2F%2Fsites.google.com%2Fsite%2Fbughunteruniversity%2Fnonvuln%2Fangularjs-expression-sandbox-bypass\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sites.google.com/site/bughunteruniversity/nonvuln/angularjs-expression-sandbox-bypass\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease refer to \u003ca title=\"http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html\" href=\"/redirect?url=http%3A%2F%2Fblog.portswigger.net%2F2016%2F01%2Fxss-without-html-client-side-template.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for further information on this technique.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":74379,"file_name":"zendesk_storedxss.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/074/379/d78b87a3f12340178e9a65d68f62ac8ad966aa94/zendesk_storedxss.PNG?response-content-disposition=attachment%3B%20filename%3D%22zendesk_storedxss.PNG%22%3B%20filename%2A%3DUTF-8%27%27zendesk_storedxss.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041914Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=dd99d444bb8eebbad88c1e8c52b211e043cbbbffac529add4e7e7954269f37a6","file_size":173338,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["albinowax","spam404","greensec","spetr0x","clarckowen_","911","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":804909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @albinowax,\n\nThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-19T19:15:14.924Z","updated_at":"2016-02-19T19:15:14.924Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809118,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @albinowax,\n\nCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \n\nAlso, you will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \u003c/p\u003e\n\n\u003cp\u003eAlso, you will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-23T18:19:12.007Z","updated_at":"2016-02-23T18:19:12.007Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809119,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-23T18:19:20.899Z","updated_at":"2016-02-23T18:19:20.899Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":844346,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @albinowax,\n\nYour submitted issue has been remediated. Thank you for participating in the [Zendesk Bug Bounty program](https://hackerone.com/zendesk). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour submitted issue has been remediated. Thank you for participating in the \u003ca href=\"https://hackerone.com/zendesk\"\u003eZendesk Bug Bounty program\u003c/a\u003e. Please feel free to reach out if you have any questions or concerns.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-17T01:05:13.424Z","updated_at":"2016-03-17T01:05:13.424Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":988975,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-28T12:32:06.573Z","updated_at":"2016-05-28T12:32:06.573Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995679,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T21:15:09.399Z","updated_at":"2016-06-01T21:15:09.399Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995680,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T21:15:09.481Z","updated_at":"2016-06-01T21:15:09.481Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}