{"id":761975,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjE5NzU=","url":"https://hackerone.com/reports/761975","title":"Keychain data persistence may lead to account takeover","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-12-19T23:00:36.457Z","submitted_at":"2019-12-19T23:00:36.457Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0x3c3e","url":"/0x3c3e","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-07T14:47:57.336Z","bug_reporter_agreed_on_going_public_at":"2020-08-14T10:10:50.766Z","team_member_agreed_on_going_public_at":"2020-09-07T14:47:57.237Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nWhen user deletes Qiwi iOS application Keychain isn't wiped and on first Qiwi launch after re-installation Keychain isn't wiped as well. It allows an attacker (possible buyer of second hand Iphone) to takeover account.\n\n## Steps to reproduce\n1. Find somebody who uses Qiwi (phone enumeration may help I guess) and desires to sell his Iphone (on Avito per example)\n1. Meet up with the seller and check that Iphone isn't wiped to factory settings\n1. Check that Qiwi app is deleted (seller isn't technically educated and thinks that if he have deleted an app, he is fine and safe)\n1. Navigate to Settings and type Qiwi, this way you can find that the user previously had Qiwi app installed (it was surprise for me, but this way Apple returns empty line with \"QIWI\" as text, but without an icon)\n1. Buy the Iphone and hope that the seller forgot to logout from Qiwi\n1. Install Qiwi\n1. If Qiwi asks to enter PIN, continue, either you can't get in (probably, because I have checked if Keychain wiped after log-out)\n1. Jailbreak Iphone and attach Frida or Cydia to the app\n1. Locate the function which checks PIN and find correct PIN (it was stored somewhere in class data in plaintext)\n1. Login to QIWI with found PIN\n\n## Mitigation\nWipe Keychain on first launch of application.\n\n## References\n* https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#data-protection-api (scroll to Keychain Data Persistence)\n\n\u003e There's no iOS API that developers can use to force wipe data when an application is uninstalled. Instead, developers should take the following steps to prevent Keychain data from persisting between application installations:\n* When an application is first launched after installation, wipe all Keychain data associated with the application. This will prevent a device's second user from accidentally gaining access to the previous user's accounts.\n\n## Notes\nIf it's possible do not close the report as N/A, I have thought if I should to send the report for about a month or two (in that period developers added and removed Jailbreak detection, I don't know why), messaged to somebody from Qiwi security team, but got no response. (thanks for reading)\n\n## Impact\n\nAs it's a bank application, in my opinion developers should be extra careful about user security. So I think in this way security \u003e UI (it isn't so hard to get SMS and enter it to login after re-installation of an app).","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eWhen user deletes Qiwi iOS application Keychain isn\u0026#39;t wiped and on first Qiwi launch after re-installation Keychain isn\u0026#39;t wiped as well. It allows an attacker (possible buyer of second hand Iphone) to takeover account.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eFind somebody who uses Qiwi (phone enumeration may help I guess) and desires to sell his Iphone (on Avito per example)\u003c/li\u003e\n\u003cli\u003eMeet up with the seller and check that Iphone isn\u0026#39;t wiped to factory settings\u003c/li\u003e\n\u003cli\u003eCheck that Qiwi app is deleted (seller isn\u0026#39;t technically educated and thinks that if he have deleted an app, he is fine and safe)\u003c/li\u003e\n\u003cli\u003eNavigate to Settings and type Qiwi, this way you can find that the user previously had Qiwi app installed (it was surprise for me, but this way Apple returns empty line with \u0026quot;QIWI\u0026quot; as text, but without an icon)\u003c/li\u003e\n\u003cli\u003eBuy the Iphone and hope that the seller forgot to logout from Qiwi\u003c/li\u003e\n\u003cli\u003eInstall Qiwi\u003c/li\u003e\n\u003cli\u003eIf Qiwi asks to enter PIN, continue, either you can\u0026#39;t get in (probably, because I have checked if Keychain wiped after log-out)\u003c/li\u003e\n\u003cli\u003eJailbreak Iphone and attach Frida or Cydia to the app\u003c/li\u003e\n\u003cli\u003eLocate the function which checks PIN and find correct PIN (it was stored somewhere in class data in plaintext)\u003c/li\u003e\n\u003cli\u003eLogin to QIWI with found PIN\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003cp\u003eWipe Keychain on first launch of application.\u003c/p\u003e\n\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca title=\"https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#data-protection-api\" href=\"/redirect?url=https%3A%2F%2Fmobile-security.gitbook.io%2Fmobile-security-testing-guide%2Fios-testing-guide%2F0x06d-testing-data-storage%23data-protection-api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#data-protection-api\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (scroll to Keychain Data Persistence)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThere\u0026#39;s no iOS API that developers can use to force wipe data when an application is uninstalled. Instead, developers should take the following steps to prevent Keychain data from persisting between application installations:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWhen an application is first launched after installation, wipe all Keychain data associated with the application. This will prevent a device\u0026#39;s second user from accidentally gaining access to the previous user\u0026#39;s accounts.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"notes\"\u003eNotes\u003c/h2\u003e\n\n\u003cp\u003eIf it\u0026#39;s possible do not close the report as N/A, I have thought if I should to send the report for about a month or two (in that period developers added and removed Jailbreak detection, I don\u0026#39;t know why), messaged to somebody from Qiwi security team, but got no response. (thanks for reading)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAs it\u0026#39;s a bank application, in my opinion developers should be extra careful about user security. So I think in this way security \u0026gt; UI (it isn\u0026#39;t so hard to get SMS and enter it to login after re-installation of an app).\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":90,"name":"Insufficient Session Expiration"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-09-13T10:10:50.829Z","allow_singular_disclosure_after":-9232613.584374962,"singular_disclosure_allowed":true,"vote_count":3,"voters":["arwildo","atpugsec","valluvarsploit"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18746,"asset_type":"APPLE_STORE_APP_ID","asset_identifier":"ru.qiwi.QIWI","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6592696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually the attacker may install Qiwi when he checks Iphone before buying, he should be tricky, but I guess it's possible scenario. \nAlso, in my experience Qiwi is the only app with persistent keychain. Can you evaluate why you decided to not wipe it (especially in case if the report will be closed as N/A or Informative)?\n\nFew typos:\n*  (probably, because *I have* checked if Keychain wiped after log-out) -- \u003e  (probably, because *I haven't* checked if Keychain wiped after log-out)\n* Jailbreak Iphone and attach Frida or *Cydia* to the app -- \u003e Jailbreak Iphone and attach Frida or *Cycript* to the app","markdown_message":"\u003cp\u003eActually the attacker may install Qiwi when he checks Iphone before buying, he should be tricky, but I guess it\u0026#39;s possible scenario. \u003cbr\u003e\nAlso, in my experience Qiwi is the only app with persistent keychain. Can you evaluate why you decided to not wipe it (especially in case if the report will be closed as N/A or Informative)?\u003c/p\u003e\n\n\u003cp\u003eFew typos:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e (probably, because \u003cem\u003eI have\u003c/em\u003e checked if Keychain wiped after log-out) -- \u0026gt;  (probably, because \u003cem\u003eI haven\u0026#39;t\u003c/em\u003e checked if Keychain wiped after log-out)\u003c/li\u003e\n\u003cli\u003eJailbreak Iphone and attach Frida or \u003cem\u003eCydia\u003c/em\u003e to the app -- \u0026gt; Jailbreak Iphone and attach Frida or \u003cem\u003eCycript\u003c/em\u003e to the app\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-12-19T23:07:01.580Z","updated_at":"2019-12-19T23:13:52.189Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6592789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I emailed to VIDENS@qiwi.com (пт, 25 окт., 22:22) with following text:\n\u003e Привет, у меня вопрос по скоупу bb программы https://hackerone.com/qiwi. Входит ли в скоуп физический доступ к девайсу? Например, к мобильному телефону.\nБыло бы круто, если подобная деталь была прописана в scope, либо в no-scope.\nЗаранее спасибо,\nАрсений","markdown_message":"\u003cp\u003eI emailed to \u003ca title=\"VIDENS@qiwi.com\" href=\"mailto:VIDENS@qiwi.com\" rel=\"nofollow noopener noreferrer\"\u003eVIDENS@qiwi.com\u003c/a\u003e (пт, 25 окт., 22:22) with following text:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eПривет, у меня вопрос по скоупу bb программы \u003ca title=\"https://hackerone.com/qiwi\" href=\"https://hackerone.com/qiwi\"\u003ehttps://hackerone.com/qiwi\u003c/a\u003e. Входит ли в скоуп физический доступ к девайсу? Например, к мобильному телефону.\u003cbr\u003e\nБыло бы круто, если подобная деталь была прописана в scope, либо в no-scope.\u003cbr\u003e\nЗаранее спасибо,\u003cbr\u003e\nАрсений\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2019-12-19T23:34:52.527Z","updated_at":"2019-12-19T23:34:52.527Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6611022,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello.\n\nThank you for the report, we will look into it.","markdown_message":"\u003cp\u003eHello.\u003c/p\u003e\n\n\u003cp\u003eThank you for the report, we will look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T09:20:11.735Z","updated_at":"2019-12-23T09:20:11.735Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6612290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, if I remember correctly QIWI iOS app uses UIWebView to render pdf files and something like this (even real pages, it's also possible to open custom urls from QIWI app not related to QIWI, but it's tricky). That view is deprecated https://developer.apple.com/documentation/uikit/uiwebview (https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#uiwebview). As the best best practices it's better to not use it. ","markdown_message":"\u003cp\u003eAlso, if I remember correctly QIWI iOS app uses UIWebView to render pdf files and something like this (even real pages, it\u0026#39;s also possible to open custom urls from QIWI app not related to QIWI, but it\u0026#39;s tricky). That view is deprecated \u003ca title=\"https://developer.apple.com/documentation/uikit/uiwebview\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fuikit%2Fuiwebview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.apple.com/documentation/uikit/uiwebview\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (\u003ca title=\"https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#uiwebview\" href=\"/redirect?url=https%3A%2F%2Fmobile-security.gitbook.io%2Fmobile-security-testing-guide%2Fios-testing-guide%2F0x06h-testing-platform-interaction%23uiwebview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#uiwebview\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). As the best best practices it\u0026#39;s better to not use it. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T13:48:17.143Z","updated_at":"2019-12-23T13:48:17.143Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6612294,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hello.\n\nWe have checked the scenario with our developers and it occurs the described behaviour is not exploitable. PIN is encrypted and is checked on the backend. Moreover PIN is stored only when FaceID or TouchID is enabled and those make the attack attempts pretty futile.","markdown_message":"\u003cp\u003eHello.\u003c/p\u003e\n\n\u003cp\u003eWe have checked the scenario with our developers and it occurs the described behaviour is not exploitable. PIN is encrypted and is checked on the backend. Moreover PIN is stored only when FaceID or TouchID is enabled and those make the attack attempts pretty futile.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T13:48:47.272Z","updated_at":"2019-12-23T13:48:47.272Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6612305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I will try to make PoC, to show that it's possible to extract PIN using Frida.","markdown_message":"\u003cp\u003eHi, I will try to make PoC, to show that it\u0026#39;s possible to extract PIN using Frida.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T13:50:01.122Z","updated_at":"2019-12-23T13:54:09.159Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6612664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again, actually you don't need even using Frida, everything is easier.\nPIN is stored in keychain, using `objection` you can dump it. (`ios keychain dump`)\nHere is related article https://habr.com/ru/company/dataart/blog/429196/.\n\nPIN is stored in plaintext (hided last two digits). {F666925}","markdown_message":"\u003cp\u003eHi again, actually you don\u0026#39;t need even using Frida, everything is easier.\u003cbr\u003e\nPIN is stored in keychain, using \u003ccode\u003eobjection\u003c/code\u003e you can dump it. (\u003ccode\u003eios keychain dump\u003c/code\u003e)\u003cbr\u003e\nHere is related article \u003ca title=\"https://habr.com/ru/company/dataart/blog/429196/\" href=\"/redirect?url=https%3A%2F%2Fhabr.com%2Fru%2Fcompany%2Fdataart%2Fblog%2F429196%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://habr.com/ru/company/dataart/blog/429196/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003ePIN is stored in plaintext (hided last two digits). \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"photo_2019-12-23_17-49-02.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x16b5i9rcZxbsNoVh1nekeev?response-content-disposition=attachment%3B%20filename%3D%22photo_2019-12-23_17-49-02.jpg%22%3B%20filename%2A%3DUTF-8%27%27photo_2019-12-23_17-49-02.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064744Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026amp;X-Amz-Signature=bd3434bc1c16835594149b43374a7848b47720284b6344895e75cc5e9b8a9019\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x16b5i9rcZxbsNoVh1nekeev?response-content-disposition=attachment%3B%20filename%3D%22photo_2019-12-23_17-49-02.jpg%22%3B%20filename%2A%3DUTF-8%27%27photo_2019-12-23_17-49-02.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064744Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026amp;X-Amz-Signature=bd3434bc1c16835594149b43374a7848b47720284b6344895e75cc5e9b8a9019\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T14:48:41.125Z","updated_at":"2019-12-23T15:01:28.574Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":666925,"filename":"photo_2019-12-23_17-49-02.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x16b5i9rcZxbsNoVh1nekeev?response-content-disposition=attachment%3B%20filename%3D%22photo_2019-12-23_17-49-02.jpg%22%3B%20filename%2A%3DUTF-8%27%27photo_2019-12-23_17-49-02.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064744Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=bd3434bc1c16835594149b43374a7848b47720284b6344895e75cc5e9b8a9019"}],"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6612670,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The PIN is partially checked on backend, I don't know why it's stored in keychain in that case.","markdown_message":"\u003cp\u003eThe PIN is partially checked on backend, I don\u0026#39;t know why it\u0026#39;s stored in keychain in that case.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T14:50:09.298Z","updated_at":"2019-12-23T15:02:50.673Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6612682,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Moreover PIN is stored only when FaceID or TouchID is enabled and those make the attack attempts pretty futile.\n\nI don't have FaceID or TouchID enabled on the test device. Also cellular is disabled, I don't know if it's important.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eMoreover PIN is stored only when FaceID or TouchID is enabled and those make the attack attempts pretty futile.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI don\u0026#39;t have FaceID or TouchID enabled on the test device. Also cellular is disabled, I don\u0026#39;t know if it\u0026#39;s important.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T14:52:53.370Z","updated_at":"2019-12-23T14:59:51.754Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6612801,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My concern here, that keychain for QIWI is persistent and PIN for some reason is stored in keychain while it's also for some reason checked on backend. I can't get the logic behind it.","markdown_message":"\u003cp\u003eMy concern here, that keychain for QIWI is persistent and PIN for some reason is stored in keychain while it\u0026#39;s also for some reason checked on backend. I can\u0026#39;t get the logic behind it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-23T15:12:21.619Z","updated_at":"2019-12-23T15:12:21.619Z","actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6616452,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Посмотрим еще.","markdown_message":"\u003cp\u003eПосмотрим еще.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-24T06:16:39.211Z","updated_at":"2019-12-24T06:16:39.211Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6616454,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-24T06:16:51.157Z","updated_at":"2019-12-24T06:16:51.157Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6724548,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-09T09:17:51.987Z","updated_at":"2020-01-09T09:17:51.987Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"0x3c3e","url":"/0x3c3e"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8342851,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello!\nThe issue was fixed in version 7.11\nThank you for your help!","markdown_message":"\u003cp\u003eHello!\u003cbr\u003e\nThe issue was fixed in version 7.11\u003cbr\u003e\nThank you for your help!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-19T13:08:10.382Z","updated_at":"2020-06-19T13:08:10.382Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0x3c3e","url":"/0x3c3e"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8936434,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey, is it possible to disclose the report? ","markdown_message":"\u003cp\u003eHey, is it possible to disclose the report? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-14T10:10:50.798Z","updated_at":"2020-08-14T10:10:50.798Z","first_to_agree":true,"actor":{"username":"0x3c3e","cleared":false,"url":"/0x3c3e","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qEDbNUXqt1WruDeUswBPo8Qk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9153597,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-07T14:47:57.273Z","updated_at":"2020-09-07T14:47:57.273Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9153598,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-07T14:47:57.368Z","updated_at":"2020-09-07T14:47:57.368Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}