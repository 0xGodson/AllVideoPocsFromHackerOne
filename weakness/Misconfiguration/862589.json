{"id":862589,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjI1ODk=","url":"https://hackerone.com/reports/862589","title":"Spring Actuator endpoints publicly available, leading to account takeover","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-04-29T17:29:53.025Z","submitted_at":"2020-04-29T17:29:53.025Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kazan71p","url":"/kazan71p","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13343,"url":"https://hackerone.com/line","handle":"line","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LINE","twitter_handle":"","website":"https://line.me","about":"LINE Security Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-04T02:52:31.171Z","bug_reporter_agreed_on_going_public_at":"2020-08-04T02:52:31.068Z","team_member_agreed_on_going_public_at":"2020-08-04T01:35:14.542Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":145,"name":"Misconfiguration"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":132,"voters":["slingx","abudman","r3b00t_","sultancad","yxw21","an0mal1es","w31rd0","mashoud1122","vapour","holme","and 122 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":16958,"asset_type":"URL","asset_identifier":"*.line.me","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7844651,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T02:51:54.486Z","updated_at":"2020-04-30T02:51:54.486Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7844659,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T02:55:54.225Z","updated_at":"2020-04-30T02:55:54.225Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kazan71p","url":"/kazan71p"},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7846090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T04:58:50.324Z","updated_at":"2020-04-30T04:58:50.324Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7847606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T07:39:19.521Z","updated_at":"2020-04-30T07:39:19.521Z","actor":{"username":"dwan","cleared":false,"url":"/dwan","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ra4aa3xoyc0jmoyzzbxl7rkwrw54/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22defcon2.png%22%3B%20filename%2A%3DUTF-8%27%27defcon2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=7f583c4b670e4e759e9d227acdca46856279b960193ac5bc7c0b8fea4e87123d"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7861556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-01T09:01:22.272Z","updated_at":"2020-05-01T09:01:22.272Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7862526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-01T10:22:38.576Z","updated_at":"2020-05-01T10:22:38.576Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7933904,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-08T03:20:07.150Z","updated_at":"2020-05-08T03:20:07.150Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7934110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-08T04:04:36.298Z","updated_at":"2020-05-08T04:04:36.298Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8077537,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-22T08:27:53.137Z","updated_at":"2020-05-22T08:27:53.137Z","actor":{"url":"/line","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LINE"}},"bounty_amount":"5000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"line","collaborator":{"username":"kazan71p","url":"/kazan71p"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8078259,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-22T09:37:04.171Z","updated_at":"2020-05-22T09:37:04.171Z","additional_data":{},"actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8839976,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-04T01:33:45.374Z","updated_at":"2020-08-04T01:33:45.374Z","additional_data":{},"actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8839980,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-04T01:35:14.569Z","updated_at":"2020-08-04T01:35:14.569Z","first_to_agree":true,"actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8840217,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-04T02:52:31.098Z","updated_at":"2020-08-04T02:52:31.098Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8840218,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-04T02:52:31.200Z","updated_at":"2020-08-04T02:52:31.200Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":23902,"category":"team","content":"Due to insufficient access controls, it was possible to access the Spring Boot Actuator endpoints /heapdump and /env. The /heapdump endpoint leaks data from the Java Virtual Machine, leading to disclosure of admin credentials, user tokens and a combination of other data.\n\nThis endpoint was not discovered by the internal security team due to being put on a custom path, avoiding detection through our usual means. The reporter accessing this endpoint also triggered a warning for our CSIRT team, allowing us to take quick and coordinated action. After quickly restricting access to this endpoint, we investigated and found no activity except that of the reporter.\n\nThe maximum impact of this issue was potential takeover of random LINE Official Accounts through leaked tokens/cookies. We appreciate the professionalism and clear communication from @kazan71p and want to thank him for helping keep LINE secure.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eDue to insufficient access controls, it was possible to access the Spring Boot Actuator endpoints /heapdump and /env. The /heapdump endpoint leaks data from the Java Virtual Machine, leading to disclosure of admin credentials, user tokens and a combination of other data.\u003c/p\u003e\n\n\u003cp\u003eThis endpoint was not discovered by the internal security team due to being put on a custom path, avoiding detection through our usual means. The reporter accessing this endpoint also triggered a warning for our CSIRT team, allowing us to take quick and coordinated action. After quickly restricting access to this endpoint, we investigated and found no activity except that of the reporter.\u003c/p\u003e\n\n\u003cp\u003eThe maximum impact of this issue was potential takeover of random LINE Official Accounts through leaked tokens/cookies. We appreciate the professionalism and clear communication from \u003ca href=\"/kazan71p\"\u003e@kazan71p\u003c/a\u003e and want to thank him for helping keep LINE secure.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}