{"id":361189,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjExODk=","url":"https://hackerone.com/reports/361189","title":"Anyone can register organization legal type as \"Soletrader\"","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2018-06-02T21:16:53.384Z","submitted_at":"2018-06-02T21:16:53.384Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4bg0p","url":"/4bg0p","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/282/091/ef5664ab80ebc8b254efe3033941152deaea5609_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-03T16:31:39.705Z","bug_reporter_agreed_on_going_public_at":"2018-06-03T16:31:39.613Z","team_member_agreed_on_going_public_at":"2018-06-03T16:26:11.794Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When Organization type is registered, two values are displayed : Business and Organization. \nWhen another value is provided, an error message is printed saying the Legal Type is wrong. \n\nThis error message is not printed and request success when the value \"Soletrader\"  is provided.\nThe value \"Soletrader\" is part of the MangoPay API Documentation ( \u003chttps://docs.mangopay.com/guide/kyc\u003e).\n\nA malicious attacker can register its organization with this Legal Type which seems to be not planned by the librapay.com platform.\n\n**Steps to reproduce**\n1. Go to \u003chttps://en.liberapay.com/~107759/identity\u003e\n2. Check the box \"Yes, I represent a business or nonprofit.\"\n3. Inspect element with your browser on the \"Organization type\" input, and change \u003coption value=\"BUSINESS\"\u003eEntreprise\u003c/option\u003e with \u003coption value=\"Soletrader\"\u003eEntreprise\u003c/option\u003e.\n4. Select \"Enterprise\" on the Organization type\" input\n5. Click on the \"Save button\".\n6. The request is accepted by the platform and the success message \"Your identity information has been updated.\" is printed.\n\nYou can try to do the same providing another value than \"Soletrader\" and you will check that an error is printed.\n\n## Impact\n\nA malicious attacker can register its organization with this Legal Type which seems to be not planned by the librapay.com platform. He could use this to have not planned  or unauthorized features when calling Mangopay API.","vulnerability_information_html":"\u003cp\u003eWhen Organization type is registered, two values are displayed : Business and Organization. \u003cbr\u003e\nWhen another value is provided, an error message is printed saying the Legal Type is wrong. \u003c/p\u003e\n\n\u003cp\u003eThis error message is not printed and request success when the value \u0026quot;Soletrader\u0026quot;  is provided.\u003cbr\u003e\nThe value \u0026quot;Soletrader\u0026quot; is part of the MangoPay API Documentation ( \u003ca title=\"https://docs.mangopay.com/guide/kyc\" href=\"/redirect?url=https%3A%2F%2Fdocs.mangopay.com%2Fguide%2Fkyc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.mangopay.com/guide/kyc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eA malicious attacker can register its organization with this Legal Type which seems to be not planned by the librapay.com platform.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://en.liberapay.com/~107759/identity\" href=\"/redirect?url=https%3A%2F%2Fen.liberapay.com%2F~107759%2Fidentity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.liberapay.com/~107759/identity\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCheck the box \u0026quot;Yes, I represent a business or nonprofit.\u0026quot;\u003c/li\u003e\n\u003cli\u003eInspect element with your browser on the \u0026quot;Organization type\u0026quot; input, and change \u0026lt;option value=\u0026quot;BUSINESS\u0026quot;\u0026gt;Entreprise\u0026lt;/option\u0026gt; with \u0026lt;option value=\u0026quot;Soletrader\u0026quot;\u0026gt;Entreprise\u0026lt;/option\u0026gt;.\u003c/li\u003e\n\u003cli\u003eSelect \u0026quot;Enterprise\u0026quot; on the Organization type\u0026quot; input\u003c/li\u003e\n\u003cli\u003eClick on the \u0026quot;Save button\u0026quot;.\u003c/li\u003e\n\u003cli\u003eThe request is accepted by the platform and the success message \u0026quot;Your identity information has been updated.\u0026quot; is printed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou can try to do the same providing another value than \u0026quot;Soletrader\u0026quot; and you will check that an error is printed.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA malicious attacker can register its organization with this Legal Type which seems to be not planned by the librapay.com platform. He could use this to have not planned  or unauthorized features when calling Mangopay API.\u003c/p\u003e\n","weakness":{"id":72,"name":"Resource Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-03T16:26:11.888Z","allow_singular_disclosure_after":-78585423.29469994,"singular_disclosure_allowed":true,"vote_count":4,"voters":["asad0x01_","eveeez","albatraoz","0x08"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2835172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! I am currently reviewing your report.","markdown_message":"\u003cp\u003eThank you for your submission! I am currently reviewing your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T09:00:47.567Z","updated_at":"2018-06-03T09:00:47.567Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@4bg0p Thank you for this interesting report. It's true that it would be better to support the Sole Trader type completely ([issue 334](https://github.com/liberapay/liberapay.com/issues/334)) or not at all, however it's not dangerous to have hidden support for it.","markdown_message":"\u003cp\u003e\u003ca href=\"/4bg0p\"\u003e@4bg0p\u003c/a\u003e Thank you for this interesting report. It\u0026#39;s true that it would be better to support the Sole Trader type completely (\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fissues%2F334\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eissue 334\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) or not at all, however it\u0026#39;s not dangerous to have hidden support for it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T11:34:48.840Z","updated_at":"2018-06-03T11:34:48.840Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835575,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright, I am not an expert of MangoPay, but reading the documentation I saw that Sole Trader legal type could permit someone not to provide the \"ARTICLES_OF_ASSOCIATION\" document which is required to the \"Business\" and \"Organization\" legal types. I thought it could lead to a Security Vulnerability because your database would be inconsistent or would not handle this legal type.\n\nBut if you think it is not a security vulnerability and that you have hidden support for it, could you close it as Informative or Resolved so that my reputation would not be affected ?\n\nRegards,\n\nSpdr","markdown_message":"\u003cp\u003eAlright, I am not an expert of MangoPay, but reading the documentation I saw that Sole Trader legal type could permit someone not to provide the \u0026quot;ARTICLES_OF_ASSOCIATION\u0026quot; document which is required to the \u0026quot;Business\u0026quot; and \u0026quot;Organization\u0026quot; legal types. I thought it could lead to a Security Vulnerability because your database would be inconsistent or would not handle this legal type.\u003c/p\u003e\n\n\u003cp\u003eBut if you think it is not a security vulnerability and that you have hidden support for it, could you close it as Informative or Resolved so that my reputation would not be affected ?\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eSpdr\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T14:49:15.925Z","updated_at":"2018-06-03T14:49:15.925Z","actor":{"username":"4bg0p","cleared":true,"url":"/4bg0p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/282/091/ef5664ab80ebc8b254efe3033941152deaea5609_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2835601,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"In recognition of the quality of your report I am closing it as Resolved to reward you with reputation points. :-)","markdown_message":"\u003cp\u003eIn recognition of the quality of your report I am closing it as Resolved to reward you with reputation points. :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T15:05:37.148Z","updated_at":"2018-06-03T15:05:37.148Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"4bg0p","url":"/4bg0p"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T16:26:11.833Z","updated_at":"2018-06-03T16:26:11.833Z","first_to_agree":true,"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835680,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T16:29:30.866Z","updated_at":"2018-06-03T16:29:30.866Z","additional_data":{"old_severity":"Low","new_severity":"None","old_severity_id":163029,"new_severity_id":163184},"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835682,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T16:30:30.677Z","updated_at":"2018-06-03T16:30:30.677Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835683,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T16:31:39.650Z","updated_at":"2018-06-03T16:31:39.650Z","actor":{"username":"4bg0p","cleared":true,"url":"/4bg0p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/282/091/ef5664ab80ebc8b254efe3033941152deaea5609_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2835684,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T16:31:39.737Z","updated_at":"2018-06-03T16:31:39.737Z","actor":{"username":"4bg0p","cleared":true,"url":"/4bg0p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/282/091/ef5664ab80ebc8b254efe3033941152deaea5609_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}