{"id":231805,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzE4MDU=","url":"https://hackerone.com/reports/231805","title":"Insecure Cache-Control Leading to API key Retrieval","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-25T13:57:42.919Z","submitted_at":"2017-05-25T13:57:42.919Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pabster","url":"/pabster","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":557,"url":"https://hackerone.com/thisdata","handle":"thisdata","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/557/79c77bd118e4c8403ec74357b3b4260d560b67a8_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/557/79c77bd118e4c8403ec74357b3b4260d560b67a8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ThisData","twitter_handle":"ThisDataHQ","website":"https://thisdata.com","about":"ThisData is a cloud security service which can monitor your apps for unusual logins, compromised accounts, and fraudulent activity"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-18T19:12:51.022Z","bug_reporter_agreed_on_going_public_at":"2017-06-21T17:39:04.610Z","team_member_agreed_on_going_public_at":"2017-07-18T19:12:50.977Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description:\nhttps://thisdata.com/customers/[user]/install/apis/[number]/reauthorize Does not have good browser cache management, allowing another user with access to the device to retrieve the API key. All of the thisdata.com pages do not have the cache management correctly configured, allowing the attacker to gain access to all of the information of the victim, but with the API key it is enough to take full control of the victim's app.\n\nSteps To Reproduce:\n1) Go to the API Settings.\n2) Logout\n3) Click on the back button.\nThe page will show the API key.\n\nDanger:\nIn a PC scenario in an office or in a library or in a coffee shop or such places allow for an attacker to exploit this vulnerability (since the amount of pages visited after visiting the API settings doesn't matter). Also it is very easy to get access to a laptop, so this is a likable scenario, and once it happens the attacker has full control over the victim's app data since he/she can use the API key to add users ...\n\nSolution:\nAdd the header:(\"Cache-Control: no-store, no-cache, must-revalidate\");\nYou currently don't have the no-store or the no-cache, which is enough to be able to exploit this vulnerability.\n\nTested in Chrome latest version.\n\nHope it helps.\nSincerely,\nPablo","vulnerability_information_html":"\u003cp\u003eDescription:\u003cbr\u003e\n\u003ca title=\"https://thisdata.com/customers/%5Buser%5D/install/apis/%5Bnumber%5D/reauthorize\" href=\"/redirect?url=https%3A%2F%2Fthisdata.com%2Fcustomers%2F%255Buser%255D%2Finstall%2Fapis%2F%255Bnumber%255D%2Freauthorize\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://thisdata.com/customers/%5Buser%5D/install/apis/%5Bnumber%5D/reauthorize\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e Does not have good browser cache management, allowing another user with access to the device to retrieve the API key. All of the thisdata.com pages do not have the cache management correctly configured, allowing the attacker to gain access to all of the information of the victim, but with the API key it is enough to take full control of the victim\u0026#39;s app.\u003c/p\u003e\n\n\u003cp\u003eSteps To Reproduce:\u003cbr\u003e\n1) Go to the API Settings.\u003cbr\u003e\n2) Logout\u003cbr\u003e\n3) Click on the back button.\u003cbr\u003e\nThe page will show the API key.\u003c/p\u003e\n\n\u003cp\u003eDanger:\u003cbr\u003e\nIn a PC scenario in an office or in a library or in a coffee shop or such places allow for an attacker to exploit this vulnerability (since the amount of pages visited after visiting the API settings doesn\u0026#39;t matter). Also it is very easy to get access to a laptop, so this is a likable scenario, and once it happens the attacker has full control over the victim\u0026#39;s app data since he/she can use the API key to add users ...\u003c/p\u003e\n\n\u003cp\u003eSolution:\u003cbr\u003e\nAdd the header:(\u0026quot;Cache-Control: no-store, no-cache, must-revalidate\u0026quot;);\u003cbr\u003e\nYou currently don\u0026#39;t have the no-store or the no-cache, which is enough to be able to exploit this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eTested in Chrome latest version.\u003c/p\u003e\n\n\u003cp\u003eHope it helps.\u003cbr\u003e\nSincerely,\u003cbr\u003e\nPablo\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-21T17:39:04.663Z","allow_singular_disclosure_after":-108559594.56302936,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","r3y","apapedulimu","pabster","t-4-y-m","mrr3boot"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1768671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, has anyone seen this yet?","markdown_message":"\u003cp\u003eHello, has anyone seen this yet?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-20T15:41:45.814Z","updated_at":"2017-06-20T15:41:45.814Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1769181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Apologies for the delay. We had a change in staff members that have been monitoring this account. I will review and reply again soon. \n\nThanks,\nRich","markdown_message":"\u003cp\u003eHi, Apologies for the delay. We had a change in staff members that have been monitoring this account. I will review and reply again soon. \u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nRich\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-20T18:22:11.010Z","updated_at":"2017-06-20T18:22:11.010Z","actor":{"username":"richchetwynd","cleared":false,"url":"/richchetwynd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1772277,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks. Cache control has been added to the API settings page. We decided not to remove caching across all pages in the app for performance reasons but this will stop unauthorized attempts to steal API keys.","markdown_message":"\u003cp\u003eThanks. Cache control has been added to the API settings page. We decided not to remove caching across all pages in the app for performance reasons but this will stop unauthorized attempts to steal API keys.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-21T17:07:17.022Z","updated_at":"2017-06-21T17:07:17.022Z","actor":{"username":"richchetwynd","cleared":false,"url":"/richchetwynd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pabster","url":"/pabster"},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1772368,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you! \nPublic disclosure please?","markdown_message":"\u003cp\u003eThank you! \u003cbr\u003e\nPublic disclosure please?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-21T17:39:04.628Z","updated_at":"2017-06-21T17:39:04.628Z","first_to_agree":true,"actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1847780,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T19:11:29.553Z","updated_at":"2017-07-18T19:11:29.553Z","additional_data":{"old_severity":"Medium (6.6)","new_severity":"Low","old_severity_id":44883,"new_severity_id":60069},"actor":{"username":"richchetwynd","cleared":false,"url":"/richchetwynd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847788,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T19:12:50.997Z","updated_at":"2017-07-18T19:12:50.997Z","actor":{"username":"richchetwynd","cleared":false,"url":"/richchetwynd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847789,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T19:12:51.040Z","updated_at":"2017-07-18T19:12:51.040Z","actor":{"username":"richchetwynd","cleared":false,"url":"/richchetwynd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"thisdata","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}