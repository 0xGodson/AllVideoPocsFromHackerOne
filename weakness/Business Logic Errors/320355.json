{"id":320355,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjAzNTU=","url":"https://hackerone.com/reports/320355","title":"myshopify.com domain takeover","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-27T15:51:11.492Z","submitted_at":"2018-02-27T15:51:11.492Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xacb","url":"/0xacb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-27T17:59:38.712Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-02-27T17:21:08.061Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Shopify Security Team,\n\nI just received your email and I'm sorry for any inconvenience. Yes, it was me.\nBasically, I just tried to audit your website using some black box testing. Unfortunately, I didn't read about those guidelines, such as creating a store on https://partners.shopify.com/ and I created a normal trial account.\n\nI'm glad you found a bug as a result of inspecting my activity logs. And you're right, I didn't notice the bug.\n\nI tried many different things, such as:\n\n- I tried to bypass the open redirect filter, without success: https://www.shopify.com/login?redirect=//acme\n- I explored the domain DNS check tool to get RCE without success. I tried to use some command injection techniques, but I didn't receive any requests on my server (█████). I tried to use curl and netcat to perform external requests.\n- I think I managed to add domains that were not verified by the DNS tool by submitting them using the last endpoint, but those domains remain \"Not connected\".\n\nI have all my requests on Burp, but I didn't save the session. As far as I can remember, this was what I tested. I would like to know what was the bug. If possible, I would like to test it further.\n\nThank you,\nAndré\n\n## Impact\n\nNone","vulnerability_information_html":"\u003cp\u003eHello Shopify Security Team,\u003c/p\u003e\n\n\u003cp\u003eI just received your email and I\u0026#39;m sorry for any inconvenience. Yes, it was me.\u003cbr\u003e\nBasically, I just tried to audit your website using some black box testing. Unfortunately, I didn\u0026#39;t read about those guidelines, such as creating a store on \u003ca title=\"https://partners.shopify.com/\" href=\"/redirect?url=https%3A%2F%2Fpartners.shopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://partners.shopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and I created a normal trial account.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m glad you found a bug as a result of inspecting my activity logs. And you\u0026#39;re right, I didn\u0026#39;t notice the bug.\u003c/p\u003e\n\n\u003cp\u003eI tried many different things, such as:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eI tried to bypass the open redirect filter, without success: \u003ca title=\"https://www.shopify.com/login?redirect=//acme\" href=\"/redirect?url=https%3A%2F%2Fwww.shopify.com%2Flogin%3Fredirect%3D%2F%2Facme\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.shopify.com/login?redirect=//acme\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eI explored the domain DNS check tool to get RCE without success. I tried to use some command injection techniques, but I didn\u0026#39;t receive any requests on my server (█████). I tried to use curl and netcat to perform external requests.\u003c/li\u003e\n\u003cli\u003eI think I managed to add domains that were not verified by the DNS tool by submitting them using the last endpoint, but those domains remain \u0026quot;Not connected\u0026quot;.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI have all my requests on Burp, but I didn\u0026#39;t save the session. As far as I can remember, this was what I tested. I would like to know what was the bug. If possible, I would like to test it further.\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\nAndré\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eNone\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":56,"voters":["jokebookservice1","sp1d3rs","jensec","ramsexy","spam404","mik317","sameerphad72","flashdisk","fa1rlight","asad0x01_","and 46 more..."],"severity":{"rating":"medium","score":6.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2439081,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, I was just testing, and I think the bug is related with the last point:\n\nIf a given domain stays in the \"Not connected\" state, a company that owns that domain can't register it later. Was this the bug? I can add more detailed information later. Thank you","markdown_message":"\u003cp\u003eHello, I was just testing, and I think the bug is related with the last point:\u003c/p\u003e\n\n\u003cp\u003eIf a given domain stays in the \u0026quot;Not connected\u0026quot; state, a company that owns that domain can\u0026#39;t register it later. Was this the bug? I can add more detailed information later. Thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T15:57:43.014Z","updated_at":"2018-02-27T15:57:43.014Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439105,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi André,\nthanks for submitting your report and detailing your tests. It's good to confirm your description matches what we noticed. It turns out you identified an issue with how we were handling domain verifications. As a result of your tests, you managed to redirect traffic from `myshopify.com` to your store. We rolled out a fix yesterday but want to ensure to compensate you for your work helping us discover the issue.\n\nI'm resolving this now and we'll follow up with a bounty during our next round of decisions, which should be by the end of next week at the latest.\n\nThanks for helping to improve the security of Shopify. Hopefully we'll see more reports from you.","markdown_message":"\u003cp\u003eHi André,\u003cbr\u003e\nthanks for submitting your report and detailing your tests. It\u0026#39;s good to confirm your description matches what we noticed. It turns out you identified an issue with how we were handling domain verifications. As a result of your tests, you managed to redirect traffic from \u003ccode\u003emyshopify.com\u003c/code\u003e to your store. We rolled out a fix yesterday but want to ensure to compensate you for your work helping us discover the issue.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m resolving this now and we\u0026#39;ll follow up with a bounty during our next round of decisions, which should be by the end of next week at the latest.\u003c/p\u003e\n\n\u003cp\u003eThanks for helping to improve the security of Shopify. Hopefully we\u0026#39;ll see more reports from you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T16:04:42.146Z","updated_at":"2018-02-27T16:04:42.146Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"0xacb","url":"/0xacb"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2439118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Peteryaworski,\n\nI didn't notice! I'm so sorry for any disruption in your service.\nYes, I will keep trying to find more bugs, I'm just getting started with bug bounties.\n\nThank you so much!","markdown_message":"\u003cp\u003eHello Peteryaworski,\u003c/p\u003e\n\n\u003cp\u003eI didn\u0026#39;t notice! I\u0026#39;m so sorry for any disruption in your service.\u003cbr\u003e\nYes, I will keep trying to find more bugs, I\u0026#39;m just getting started with bug bounties.\u003c/p\u003e\n\n\u003cp\u003eThank you so much!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T16:09:59.758Z","updated_at":"2018-02-27T16:09:59.758Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xacb, no problem, we figured that might have been the case since there would have been no indication to you during your testing that it happened without you manually navigating to `myshopify.com`. That's why we reached out.\n\nWelcome to bug bounties :)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e, no problem, we figured that might have been the case since there would have been no indication to you during your testing that it happened without you manually navigating to \u003ccode\u003emyshopify.com\u003c/code\u003e. That\u0026#39;s why we reached out.\u003c/p\u003e\n\n\u003cp\u003eWelcome to bug bounties :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T16:16:46.007Z","updated_at":"2018-02-27T16:16:46.007Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2439270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reaching out :)","markdown_message":"\u003cp\u003eThank you for reaching out :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T16:41:52.159Z","updated_at":"2018-02-27T16:41:52.159Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439433,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you again for finding this issue!","markdown_message":"\u003cp\u003eThank you again for finding this issue!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T17:20:57.450Z","updated_at":"2018-02-27T17:20:57.450Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"0xacb","url":"/0xacb"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2439435,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-27T17:21:08.091Z","updated_at":"2018-02-27T17:21:08.091Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2439495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree to disclose this report, but please remove my server IP address.\nThank you for the bounty :)","markdown_message":"\u003cp\u003eI agree to disclose this report, but please remove my server IP address.\u003cbr\u003e\nThank you for the bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T17:49:40.641Z","updated_at":"2018-02-27T17:49:40.641Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439523,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-27T17:59:38.618Z","updated_at":"2018-02-27T17:59:38.618Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439533,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-27T18:02:50.466Z","updated_at":"2018-02-27T18:02:50.466Z","additional_data":{"old_title":"Email Reply","new_title":"myshopify.com domain takeover"},"actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2889863,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:50:19.345Z","updated_at":"2018-06-15T17:50:19.345Z","additional_data":{"added_weaknesses":[{"id":65,"name":"Business Logic Errors"}],"removed_weaknesses":[]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2889865,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:50:53.203Z","updated_at":"2018-06-15T17:50:53.203Z","additional_data":{"old_severity":"None","new_severity":"Medium (6.1)","old_severity_id":123229,"new_severity_id":168630},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6714,"category":"team","content":"On February 27, 2018, Shopify support received notification that `myshopify.com` was being redirected to a specific Shopify store. We tracked the behaviour down to tests from @0xacb. Unknowingly, he identified a bug in our domain verification and path creations, which allowed for the registration of a Shopify owned domain name despite domain verification failing. We fixed our path registration process immediately and reached out to him to ensure he was compensated for his work.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eOn February 27, 2018, Shopify support received notification that \u003ccode\u003emyshopify.com\u003c/code\u003e was being redirected to a specific Shopify store. We tracked the behaviour down to tests from \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e. Unknowingly, he identified a bug in our domain verification and path creations, which allowed for the registration of a Shopify owned domain name despite domain verification failing. We fixed our path registration process immediately and reached out to him to ensure he was compensated for his work.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}