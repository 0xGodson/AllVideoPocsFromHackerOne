{"id":422279,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjIyNzk=","url":"https://hackerone.com/reports/422279","title":"H1514 Simple phishing using auto-created modal with weak URL-pattern check in incontext_app_link","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-11T00:37:43.811Z","submitted_at":"2018-10-11T00:37:43.811Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-10T22:35:47.817Z","bug_reporter_agreed_on_going_public_at":"2019-04-10T22:35:47.685Z","team_member_agreed_on_going_public_at":"2019-04-10T18:19:33.553Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis is unrelated to the Twine-template issue reported earlier as this would still be an issue if the template escape would be fixed. \n\n### Background\n\nThe `incontext_app_link` is checked server-side if it's a correct `shopifycloud.com`-URL. The problem however is that userdata inside the URL is allowed. By utilizing two backslashes `\\\\` in the userdata, we're able to make all browsers except Safari load the URL before the `@` instead of the domain after. This means that since the `API.modal.open` triggers directly when the victim accesses the page, we can fake a login page on this URL to make the admin think they need to reauthorize in Shopify. However, the link is actually loaded from a different domain and the credentials will be stolen whenever the admins uses the form.\n\nThe same thing applies here as to the Twine-report, the attacker needs to use a product-ID that exists for the merchant. But since these IDs are publicly available in the webstore, this should be no issue.\n\n### PoC\n\nPoC-link (use your own store, and also replace `1557454323768` with a working Product ID inside your store):\n\n```\n/admin/products/1557454323768?incontext_app_link=https%3A%2F%2F████████%5C%5C%40google-shopping.shopifycloud.com\n```\n\nThe following HTML is loaded from `██████`:\n\n\n```html\n\u003ccenter\u003e\n\u003cform onsubmit=\"alert('your login is: ' + document.getElementById('u').value + ':' + document.getElementById('p').value); return false\"\u003e\n\u003cinput id=\"u\" placeholder=\"Email address\" style=\" position: absolute; top: 140px; left: 80px; font-size: 20px; height: 50px; border: 0; width: 400px;\"\u003e\n\u003cinput id=\"p\" placeholder=\"Password\" type=\"password\" style=\"position: absolute; font-size: 20px; height: 50px; border: 0; width: 400px; left: 80px; top: 210px;\"\u003e\n\u003cbutton type=\"submit\" style=\"position: absolute; left: 80px; height: 50px; top: 280px; width: 480px; background: transparent; border: 0;\"\u003e\u003c/button\u003e\u003c/form\u003e\n\u003cimg src=\"login.png\" width=\"600\" /\u003e\u003c/center\u003e\n\u003cscript\u003eparent.postMessage('{\"message\":\"Shopify.API.Modal.setHeight\",\"data\":{\"height\":500,\"width\":\"940\"}}','*')\u003c/script\u003e\n```\n\n{F358706}\n\nHere's a video showing the scenario of the attacker sending a link to an admin:\n\n{F358705}\n\nRegards,\nFrans and Mathias\n\n## Impact\n\n#","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis is unrelated to the Twine-template issue reported earlier as this would still be an issue if the template escape would be fixed. \u003c/p\u003e\n\n\u003ch3 id=\"background\"\u003eBackground\u003c/h3\u003e\n\n\u003cp\u003eThe \u003ccode\u003eincontext_app_link\u003c/code\u003e is checked server-side if it\u0026#39;s a correct \u003ccode\u003eshopifycloud.com\u003c/code\u003e-URL. The problem however is that userdata inside the URL is allowed. By utilizing two backslashes \u003ccode\u003e\\\\\u003c/code\u003e in the userdata, we\u0026#39;re able to make all browsers except Safari load the URL before the \u003ccode\u003e@\u003c/code\u003e instead of the domain after. This means that since the \u003ccode\u003eAPI.modal.open\u003c/code\u003e triggers directly when the victim accesses the page, we can fake a login page on this URL to make the admin think they need to reauthorize in Shopify. However, the link is actually loaded from a different domain and the credentials will be stolen whenever the admins uses the form.\u003c/p\u003e\n\n\u003cp\u003eThe same thing applies here as to the Twine-report, the attacker needs to use a product-ID that exists for the merchant. But since these IDs are publicly available in the webstore, this should be no issue.\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003cp\u003ePoC-link (use your own store, and also replace \u003ccode\u003e1557454323768\u003c/code\u003e with a working Product ID inside your store):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/admin/products/1557454323768?incontext_app_link=https%3A%2F%2F████████%5C%5C%40google-shopping.shopifycloud.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following HTML is loaded from \u003ccode\u003e██████\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eonsubmit=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;alert(\u0026#39;your login is: \u0026#39; + document.getElementById(\u0026#39;u\u0026#39;).value + \u0026#39;:\u0026#39; + document.getElementById(\u0026#39;p\u0026#39;).value); return false\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;u\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Email address\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot; position: absolute; top: 140px; left: 80px; font-size: 20px; height: 50px; border: 0; width: 400px;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;p\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;position: absolute; font-size: 20px; height: 50px; border: 0; width: 400px; left: 80px; top: 210px;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;position: absolute; left: 80px; height: 50px; top: 280px; width: 480px; background: transparent; border: 0;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/button\u0026gt;\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;img\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;login.png\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eparent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epostMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{\u0026quot;message\u0026quot;:\u0026quot;Shopify.API.Modal.setHeight\u0026quot;,\u0026quot;data\u0026quot;:{\u0026quot;height\u0026quot;:500,\u0026quot;width\u0026quot;:\u0026quot;940\u0026quot;}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e*\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e{F358706}\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s a video showing the scenario of the attacker sending a link to an admin:\u003c/p\u003e\n\n\u003cp\u003e{F358705}\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans and Mathias\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n","bounty_amount":"1837.0","formatted_bounty":"$1,837","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":20,"voters":["samengmg","sp1d3rs","mygf","r0hack","terjanq","realtess","8redtriangle2","cr4xerbik4sh","bb00x","arifmkhls","and 10 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3463078,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2018-10-11T00:37:51.833Z","updated_at":"2018-10-11T00:37:51.833Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"avlidienbrunn","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3463656,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-11T06:06:58.348Z","updated_at":"2018-10-11T06:06:58.348Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3475516,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-13T14:57:26.460Z","updated_at":"2018-10-13T14:57:26.460Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"668.5","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475517,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-13T14:57:27.070Z","updated_at":"2018-10-13T14:57:27.070Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"668.5","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475537,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @fransrosen and @avlidienbrunn!\nThanks for your report. This is an interesting find. Though we typically don't accept reports related to social engineering and phishing, we have decided to award a $1337 bounty in this case. We were explicitly trying to whitelist the domains based on installed apps, and this URI parsing bug bypasses that check.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e and \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e!\u003cbr\u003e\nThanks for your report. This is an interesting find. Though we typically don\u0026#39;t accept reports related to social engineering and phishing, we have decided to award a $1337 bounty in this case. We were explicitly trying to whitelist the domains based on installed apps, and this URI parsing bug bypasses that check.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-13T15:05:23.108Z","updated_at":"2018-10-13T15:05:23.108Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3475538,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-13T15:05:41.078Z","updated_at":"2018-10-13T15:05:41.078Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3712198,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-26T20:50:33.404Z","updated_at":"2018-11-26T20:50:33.404Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.4)","old_severity_id":null,"new_severity_id":249990},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4152082,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @fransrosen and @avlidienbrunn!\nWe have recently deployed a fix for in context app links, and you should no longer be able to reproduce this issue. The library we were using for parsing the `in_context_app_link` parameter was not intended to be used for this kind of host validation. For this reason, we've moved away from using this library to parse these links, and now use the URI parsing provided by Ruby.\n\nWe have also decided to award a bonus of $500, since we found an additional XSS issue in closely related code, while fixing the issue you reported. This will be applied in our next round of bounties, which will take place within the next week.\n\nThanks again for the great find!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e and \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e!\u003cbr\u003e\nWe have recently deployed a fix for in context app links, and you should no longer be able to reproduce this issue. The library we were using for parsing the \u003ccode\u003ein_context_app_link\u003c/code\u003e parameter was not intended to be used for this kind of host validation. For this reason, we\u0026#39;ve moved away from using this library to parse these links, and now use the URI parsing provided by Ruby.\u003c/p\u003e\n\n\u003cp\u003eWe have also decided to award a bonus of $500, since we found an additional XSS issue in closely related code, while fixing the issue you reported. This will be applied in our next round of bounties, which will take place within the next week.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the great find!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T21:25:58.400Z","updated_at":"2019-02-14T21:25:58.400Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4287562,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding a 500$ bonus on this issue as we uncovered an XSS while fixing it. Thanks again!","markdown_message":"\u003cp\u003eWe\u0026#39;re awarding a 500$ bonus on this issue as we uncovered an XSS while fixing it. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T18:49:27.511Z","updated_at":"2019-03-08T18:49:27.511Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4287563,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding a 500$ bonus on this issue as we uncovered an XSS while fixing it. Thanks again!","markdown_message":"\u003cp\u003eWe\u0026#39;re awarding a 500$ bonus on this issue as we uncovered an XSS while fixing it. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T18:49:28.285Z","updated_at":"2019-03-08T18:49:28.285Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4461624,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-03T20:23:25.847Z","updated_at":"2019-04-03T20:23:25.847Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4461953,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, sure! Can you redact `██████████` from the report first? :)","markdown_message":"\u003cp\u003eHi, sure! Can you redact \u003ccode\u003e██████████\u003c/code\u003e from the report first? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T20:26:00.936Z","updated_at":"2019-04-03T20:26:34.711Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4462276,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"We'll have to remove the attachment too","markdown_message":"\u003cp\u003eWe\u0026#39;ll have to remove the attachment too\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T20:27:25.121Z","updated_at":"2019-04-03T20:27:25.121Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4532157,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Removed the attachments so I think we're good to go Mr. Rosén :)","markdown_message":"\u003cp\u003eRemoved the attachments so I think we\u0026#39;re good to go Mr. Rosén :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T18:19:33.576Z","updated_at":"2019-04-10T18:19:33.576Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4533491,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Here's a new video!\n\n{F466342}","markdown_message":"\u003cp\u003eHere\u0026#39;s a new video!\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"shopify-modal.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/466/342/007aab540dd817afca9c7131d65f2ecba06ec33a/shopify-modal.mp4?response-content-disposition=attachment%3B%20filename%3D%22shopify-modal.mp4%22%3B%20filename%2A%3DUTF-8%27%27shopify-modal.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055540Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=3ea83b573b82d2dba9ddc4c65aef410078595029da8fbd493def2920fb654277\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/466/342/007aab540dd817afca9c7131d65f2ecba06ec33a/shopify-modal.mp4?response-content-disposition=attachment%3B%20filename%3D%22shopify-modal.mp4%22%3B%20filename%2A%3DUTF-8%27%27shopify-modal.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055540Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=3ea83b573b82d2dba9ddc4c65aef410078595029da8fbd493def2920fb654277\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T22:35:47.715Z","updated_at":"2019-04-10T22:35:47.715Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":466342,"filename":"shopify-modal.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/466/342/007aab540dd817afca9c7131d65f2ecba06ec33a/shopify-modal.mp4?response-content-disposition=attachment%3B%20filename%3D%22shopify-modal.mp4%22%3B%20filename%2A%3DUTF-8%27%27shopify-modal.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055540Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=3ea83b573b82d2dba9ddc4c65aef410078595029da8fbd493def2920fb654277"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4533492,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-10T22:35:47.836Z","updated_at":"2019-04-10T22:35:47.836Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7147443,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-25T14:52:55.656Z","updated_at":"2020-02-25T14:52:55.656Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"your-store.myshopify.com","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14195,"category":"team","content":"@fransrosen and @avlidienbrunn found that it was possible to inject arbitrary content from other domains into the products page in admin via the incontext_app_link parameter. This content was intended to be limited to the domains of installed apps, but this bug would have allowed any URL to load content in a modal inside Shopify admin.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/fransrosen\"\u003e@fransrosen\u003c/a\u003e and \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e found that it was possible to inject arbitrary content from other domains into the products page in admin via the incontext_app_link parameter. This content was intended to be limited to the domains of installed apps, but this bug would have allowed any URL to load content in a modal inside Shopify admin.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}