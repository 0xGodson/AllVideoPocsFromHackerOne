{"id":272570,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzI1NzA=","url":"https://hackerone.com/reports/272570","title":"Organization Admin Privilege Escalation To Owner","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-28T01:05:19.847Z","submitted_at":"2017-09-28T01:05:19.847Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rhynorater","url":"/rhynorater","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/UBVBBEU7D2PJtynWGRFj7sMX/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21024,"url":"https://hackerone.com/bitwarden","handle":"bitwarden","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Bitwarden","twitter_handle":"bitwarden","website":"https://bitwarden.com","about":"Open source password management solutions for individuals, teams, and business organizations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-28T02:53:06.142Z","bug_reporter_agreed_on_going_public_at":"2017-09-28T02:52:59.674Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary\nIt seems there is an issue with your roles which allows an admin to escalate his own privileges to owner and takeover the organization. \n\n##Reproduce\n1. Create an account, accountA\n2. Create another account, accountB\n3. Create an organization under accountA and invite accountB to that organization as admin\n4. Accept invitation with accountB and log out\n5. Confirm accountB for the organization on accountA\n6. Log in with accountB\n7. Navigate to the organization -\u003e invite users -\u003e edit accountB user and change to owner\n8. See that the change worked and accountB is now owner. \n9. To proceed with organization takeover, remove the original owner\n10. Note that (after login and logout) the original owner no longer is in the organization\n\n##Impact\nAnyone who is an admin on an organization can take total control of the organization and kick the original owner out. \n\n##Request\nCould you please whitelist ip 173.167.43.57 and ip 54.197.209.98 so that I can keep reporting? It is very hard to fully test the application while I am constantly getting blacklisted and having to use my phone as a hotspot :P If not, that's cool, just figured I'd ask :)\n\n\nThanks,\nJustin Gardner","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eIt seems there is an issue with your roles which allows an admin to escalate his own privileges to owner and takeover the organization. \u003c/p\u003e\n\n\u003ch2 id=\"reproduce\"\u003eReproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate an account, accountA\u003c/li\u003e\n\u003cli\u003eCreate another account, accountB\u003c/li\u003e\n\u003cli\u003eCreate an organization under accountA and invite accountB to that organization as admin\u003c/li\u003e\n\u003cli\u003eAccept invitation with accountB and log out\u003c/li\u003e\n\u003cli\u003eConfirm accountB for the organization on accountA\u003c/li\u003e\n\u003cli\u003eLog in with accountB\u003c/li\u003e\n\u003cli\u003eNavigate to the organization -\u0026gt; invite users -\u0026gt; edit accountB user and change to owner\u003c/li\u003e\n\u003cli\u003eSee that the change worked and accountB is now owner. \u003c/li\u003e\n\u003cli\u003eTo proceed with organization takeover, remove the original owner\u003c/li\u003e\n\u003cli\u003eNote that (after login and logout) the original owner no longer is in the organization\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAnyone who is an admin on an organization can take total control of the organization and kick the original owner out. \u003c/p\u003e\n\n\u003ch2 id=\"request\"\u003eRequest\u003c/h2\u003e\n\n\u003cp\u003eCould you please whitelist ip 173.167.43.57 and ip 54.197.209.98 so that I can keep reporting? It is very hard to fully test the application while I am constantly getting blacklisted and having to use my phone as a hotspot :P If not, that\u0026#39;s cool, just figured I\u0026#39;d ask :)\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJustin Gardner\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-28T02:52:59.712Z","allow_singular_disclosure_after":-100059999.54807761,"singular_disclosure_allowed":true,"vote_count":10,"voters":["gamliel","eveeez","r3y","khizer47","linkks","zerotoone","japz","walidhossain","hertz19","b4155f7c29acd42c27d007a"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":772,"asset_type":"URL","asset_identifier":"vault.bitwarden.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2028948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks Justin. We'll take a look at this now.\n\nIf you'd like to be IP whitelisted please swing by our dev chat so I can better understand what you're doing. I don't want you to nuke our servers :-)\n\nhttps://gitter.im/bitwarden/Lobby","markdown_message":"\u003cp\u003eThanks Justin. We\u0026#39;ll take a look at this now.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;d like to be IP whitelisted please swing by our dev chat so I can better understand what you\u0026#39;re doing. I don\u0026#39;t want you to nuke our servers :-)\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://gitter.im/bitwarden/Lobby\" href=\"/redirect?url=https%3A%2F%2Fgitter.im%2Fbitwarden%2FLobby\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitter.im/bitwarden/Lobby\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T01:10:57.670Z","updated_at":"2017-09-28T01:10:57.670Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2028949,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T01:13:21.502Z","updated_at":"2017-09-28T01:13:21.502Z","additional_data":{"old_title":"Application Logic Error - Admin -\u003e Owner Privledge Esc / Organization takeover","new_title":"Organization Admin Privilege Escalation To Owner"},"actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've patched this in production now with tonight's release. See related commit here: https://github.com/bitwarden/core/commit/2444346ea91451496081c3b36254e00362527d18\n\nLet me know if you see any issue.","markdown_message":"\u003cp\u003eWe\u0026#39;ve patched this in production now with tonight\u0026#39;s release. See related commit here: \u003ca title=\"https://github.com/bitwarden/core/commit/2444346ea91451496081c3b36254e00362527d18\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbitwarden%2Fcore%2Fcommit%2F2444346ea91451496081c3b36254e00362527d18\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/bitwarden/core/commit/2444346ea91451496081c3b36254e00362527d18\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know if you see any issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T02:38:44.095Z","updated_at":"2017-09-28T02:38:44.095Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029030,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T02:39:40.001Z","updated_at":"2017-09-28T02:39:40.001Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"bitwarden.com","new_scope":"vault.bitwarden.com","genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029034,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T02:41:39.085Z","updated_at":"2017-09-28T02:41:39.085Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks great! Thanks for the quick response time!","markdown_message":"\u003cp\u003eLooks great! Thanks for the quick response time!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T02:49:44.029Z","updated_at":"2017-09-28T02:49:44.029Z","actor":{"username":"rhynorater","cleared":true,"url":"/rhynorater","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UBVBBEU7D2PJtynWGRFj7sMX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029040,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T02:51:43.455Z","updated_at":"2017-09-28T02:51:43.455Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rhynorater","url":"/rhynorater"},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029041,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosing for knowledge of other hackers.","markdown_message":"\u003cp\u003eDisclosing for knowledge of other hackers.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T02:52:59.692Z","updated_at":"2017-09-28T02:52:59.692Z","first_to_agree":true,"actor":{"username":"rhynorater","cleared":true,"url":"/rhynorater","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UBVBBEU7D2PJtynWGRFj7sMX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2109756,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-28T02:53:06.178Z","updated_at":"2017-10-28T02:53:06.178Z","actor":{"url":"/bitwarden","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Bitwarden"}},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}