{"id":995969,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85OTU5Njk=","url":"https://hackerone.com/reports/995969","title":"Manipulate Uneditable Messages in Support","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2020-10-01T15:37:47.475Z","submitted_at":"2020-10-01T15:37:47.558Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahmd_halabi","url":"/ahmd_halabi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48311,"url":"https://hackerone.com/cs_money","handle":"cs_money","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"CS Money","twitter_handle":"csmoneytrade","website":"https://cs.money","about":"CS:GO trading platform that helps people to trade, buy, sell and search for the best skins and deals they could possibly find."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-27T19:28:43.629Z","bug_reporter_agreed_on_going_public_at":"2020-10-20T20:50:19.015Z","team_member_agreed_on_going_public_at":"2020-10-27T19:28:43.538Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHello,\n\nThe support section has a validation on all the posted messages where it doesn't allow you to edit your messages after some minutes from posting them.\nI was able to bypass this protection and edit successfully the previous messages that can't be edited.\n\nAfter further investigation, I found that whenever you create/send a message, there is a date value made of numbers generated in the response which indicates the timestamp or the date that the message was created.\nAnd when you edit that message, the same value is used as a date parameter in the edit request.\n\nThe bug is that the date parameter is still active for the unedited messages, so when you perform an editable request having the old unedited message's date value as a date parameter, the request will be successful and the new edit text will be successfully applied.\n\n## Steps To Reproduce:\n1. So first you need to identify the message initial date, send a message in the support section, intercept its request and see the response containing the target date.\n\n```\n█████████\nHost: support.cs.money\n\n{\"user_steamid\":\"id-number\",\"text\":\"test\",\"settings\":{\"skin_exterior\":0,\"eco\":0,\"unavailable\":1,\"hints_in_trade\":1,\"lock_skin\":0,\"popup_skin\":1,\"reserved_skin\":1,\"save_filter\":0,\"virtual_trade\":0,\"skins_ticker\":1,\"beautiful_pics\":1,\"skins_float\":0,\"rarity\":0,\"collection\":0,\"conveyor\":1,\"block_red_points\":0,\"sourcePay\":\"scrill\"},\"bot_mode\":\"trade\",\"user_mode\":\"trade\"}\n```\n\n██████\n\n'2. Say that you no longer are able to edit the above message created by you. So now create another message. Click edit, send the message and intercept its request.\n'3. Add the date value from the step 1 response in the `date` value, and add the new message content in the `new_message` value.\n\n```\n███████\nHost: support.cs.money\n\n{\"date\":\"date-value\",\"new_message\":\"Hackerone edited message changed successfully === bug\"}\n```\n\n'4. Forward the request and see the response code id 200 OK, Reload the page and see that the message is edited successfully.\n\n## Supporting Material/References:\nPlease see the video below where I explained the bug step-by-step.\n\n█████\n\n## Impact\n\nUsers are able to edit their old messages that are not supposed to be editable anymore. This can lead to serious issues because they are being edited on the server too.\nAlso this is a bypass for the application validation and violation of its protection.\nI think this can lead to serious problems if malicious users edit the messages to bad or harmful content.\n\nBest Regards.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe support section has a validation on all the posted messages where it doesn\u0026#39;t allow you to edit your messages after some minutes from posting them.\u003cbr\u003e\nI was able to bypass this protection and edit successfully the previous messages that can\u0026#39;t be edited.\u003c/p\u003e\n\n\u003cp\u003eAfter further investigation, I found that whenever you create/send a message, there is a date value made of numbers generated in the response which indicates the timestamp or the date that the message was created.\u003cbr\u003e\nAnd when you edit that message, the same value is used as a date parameter in the edit request.\u003c/p\u003e\n\n\u003cp\u003eThe bug is that the date parameter is still active for the unedited messages, so when you perform an editable request having the old unedited message\u0026#39;s date value as a date parameter, the request will be successful and the new edit text will be successfully applied.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eSo first you need to identify the message initial date, send a message in the support section, intercept its request and see the response containing the target date.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e█████████\nHost: support.cs.money\n\n{\u0026quot;user_steamid\u0026quot;:\u0026quot;id-number\u0026quot;,\u0026quot;text\u0026quot;:\u0026quot;test\u0026quot;,\u0026quot;settings\u0026quot;:{\u0026quot;skin_exterior\u0026quot;:0,\u0026quot;eco\u0026quot;:0,\u0026quot;unavailable\u0026quot;:1,\u0026quot;hints_in_trade\u0026quot;:1,\u0026quot;lock_skin\u0026quot;:0,\u0026quot;popup_skin\u0026quot;:1,\u0026quot;reserved_skin\u0026quot;:1,\u0026quot;save_filter\u0026quot;:0,\u0026quot;virtual_trade\u0026quot;:0,\u0026quot;skins_ticker\u0026quot;:1,\u0026quot;beautiful_pics\u0026quot;:1,\u0026quot;skins_float\u0026quot;:0,\u0026quot;rarity\u0026quot;:0,\u0026quot;collection\u0026quot;:0,\u0026quot;conveyor\u0026quot;:1,\u0026quot;block_red_points\u0026quot;:0,\u0026quot;sourcePay\u0026quot;:\u0026quot;scrill\u0026quot;},\u0026quot;bot_mode\u0026quot;:\u0026quot;trade\u0026quot;,\u0026quot;user_mode\u0026quot;:\u0026quot;trade\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e██████\u003c/p\u003e\n\n\u003cp\u003e\u0026#39;2. Say that you no longer are able to edit the above message created by you. So now create another message. Click edit, send the message and intercept its request.\u003cbr\u003e\n\u0026#39;3. Add the date value from the step 1 response in the \u003ccode\u003edate\u003c/code\u003e value, and add the new message content in the \u003ccode\u003enew_message\u003c/code\u003e value.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e███████\nHost: support.cs.money\n\n{\u0026quot;date\u0026quot;:\u0026quot;date-value\u0026quot;,\u0026quot;new_message\u0026quot;:\u0026quot;Hackerone edited message changed successfully === bug\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026#39;4. Forward the request and see the response code id 200 OK, Reload the page and see that the message is edited successfully.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003ePlease see the video below where I explained the bug step-by-step.\u003c/p\u003e\n\n\u003cp\u003e█████\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUsers are able to edit their old messages that are not supposed to be editable anymore. This can lead to serious issues because they are being edited on the server too.\u003cbr\u003e\nAlso this is a bypass for the application validation and violation of its protection.\u003cbr\u003e\nI think this can lead to serious problems if malicious users edit the messages to bad or harmful content.\u003c/p\u003e\n\n\u003cp\u003eBest Regards.\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["najeh_halawani","amad3u6","what_web","01alsanosi","eingengraou"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":45903,"asset_type":"URL","asset_identifier":"support.cs.money","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9417952,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey!\nThis issue is already reported in #995664.\nStill, as we've told in the original report, we can't see direct security impact here.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nThis issue is already reported in \u003ca href=\"/reports/995664\"\u003e#995664\u003c/a\u003e.\u003cbr\u003e\nStill, as we\u0026#39;ve told in the original report, we can\u0026#39;t see direct security impact here.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T09:34:06.805Z","updated_at":"2020-10-05T09:34:06.805Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9418099,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Let me explain little more about the impact :\n- First it is a bypass and violation of the security system that you designed to disallow edit messages after certain time.\n- Second, this will cause investigation issues and clients may write things for the support and when the support answer a thing, the client can re edit his messages through this bug and answer the opposite for example which will be returned back as a bad thing done for the support with that client.\n- This bug also abuses support section since the messages are taken seriously when it comes to forensics investigations. If some bad situation happened they wont understand that there is a bug there and the client changes the messages.\nSo malicious clients can abuse these messages for their side and cause some issues to your company when it comes to law especially if the support answered specific things in the messages and the malicious client edited his messages.\n\nAt the end in real case scenarios you are talking about hackers (black hats) where they try to make large exploitation through small bugs they find in your system. Don’t you think this should be resolved ?\n\nThat’s why I put the severity as high since it may lead to serious issues which not necessary to be technical issues, they can be business, communication and investigation issues.\n\nI hope that you think about the impact of this bug taking in consideration all the circumstances.\n\nKind Regards.","markdown_message":"\u003cp\u003eLet me explain little more about the impact :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eFirst it is a bypass and violation of the security system that you designed to disallow edit messages after certain time.\u003c/li\u003e\n\u003cli\u003eSecond, this will cause investigation issues and clients may write things for the support and when the support answer a thing, the client can re edit his messages through this bug and answer the opposite for example which will be returned back as a bad thing done for the support with that client.\u003c/li\u003e\n\u003cli\u003eThis bug also abuses support section since the messages are taken seriously when it comes to forensics investigations. If some bad situation happened they wont understand that there is a bug there and the client changes the messages.\nSo malicious clients can abuse these messages for their side and cause some issues to your company when it comes to law especially if the support answered specific things in the messages and the malicious client edited his messages.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAt the end in real case scenarios you are talking about hackers (black hats) where they try to make large exploitation through small bugs they find in your system. Don’t you think this should be resolved ?\u003c/p\u003e\n\n\u003cp\u003eThat’s why I put the severity as high since it may lead to serious issues which not necessary to be technical issues, they can be business, communication and investigation issues.\u003c/p\u003e\n\n\u003cp\u003eI hope that you think about the impact of this bug taking in consideration all the circumstances.\u003c/p\u003e\n\n\u003cp\u003eKind Regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T09:46:50.930Z","updated_at":"2020-10-05T09:46:50.930Z","actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9418594,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nThank you for the clarification, still this issue was previously reported before.\nWe are in a middle of discussion with another hacker.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nThank you for the clarification, still this issue was previously reported before.\u003cbr\u003e\nWe are in a middle of discussion with another hacker.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T10:35:51.922Z","updated_at":"2020-10-05T10:35:51.922Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9521519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hope there are updates on this ?\nThanks.","markdown_message":"\u003cp\u003eHope there are updates on this ?\u003cbr\u003e\nThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-14T13:56:38.832Z","updated_at":"2020-10-14T13:56:38.832Z","actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9527762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nAfter the discussion, we've came to a conclusion, that no fix needed.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nAfter the discussion, we\u0026#39;ve came to a conclusion, that no fix needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T08:18:51.593Z","updated_at":"2020-10-15T08:18:51.593Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9528511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, what about the report status ?","markdown_message":"\u003cp\u003eSo, what about the report status ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T09:29:12.231Z","updated_at":"2020-10-15T09:29:12.231Z","actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9529918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will be closing this as informative.\nBased on opinion we have, this issue does not have exact security issue, and is not require immidiate actions or fix.","markdown_message":"\u003cp\u003eWill be closing this as informative.\u003cbr\u003e\nBased on opinion we have, this issue does not have exact security issue, and is not require immidiate actions or fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T12:21:45.428Z","updated_at":"2020-10-15T12:21:45.428Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9534599,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"No fix needed.","markdown_message":"\u003cp\u003eNo fix needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-15T19:51:54.671Z","updated_at":"2020-10-15T19:51:54.671Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9582303,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-20T20:50:19.036Z","updated_at":"2020-10-20T20:50:19.036Z","first_to_agree":true,"actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9652424,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-27T19:28:43.566Z","updated_at":"2020-10-27T19:28:43.566Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9652425,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-27T19:28:43.670Z","updated_at":"2020-10-27T19:28:43.670Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}