{"id":300748,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDA3NDg=","url":"https://hackerone.com/reports/300748","title":"Ethereum account balance manipulation","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-12-27T08:38:17.059Z","submitted_at":"2017-12-27T08:38:17.059Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vicompany","url":"/vicompany","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-21T08:52:55.671Z","bug_reporter_agreed_on_going_public_at":"2018-02-19T08:52:44.320Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-03-21T08:52:44.442Z","allow_singular_disclosure_after":-87597374.86378177,"singular_disclosure_allowed":true,"vote_count":236,"voters":["jokebookservice1","totalsx","flamezzz","arneswinnen","sp1d3rs","jensec","airblender","jr0ch17","ajxchapman","cache-money","and 226 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":120,"asset_type":"URL","asset_identifier":"coinbase.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2248590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T15:57:19.894Z","updated_at":"2017-12-27T15:57:19.894Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248594,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T15:58:59.720Z","updated_at":"2017-12-27T15:58:59.720Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T18:18:10.090Z","updated_at":"2017-12-27T18:18:10.090Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2248787,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T18:20:01.204Z","updated_at":"2018-03-14T20:17:28.089Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248799,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T18:25:51.321Z","updated_at":"2017-12-27T18:25:51.321Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2255657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-02T13:03:34.204Z","updated_at":"2018-03-14T20:17:57.820Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278498,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T19:08:52.812Z","updated_at":"2018-01-11T19:08:52.812Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278500,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T19:09:43.889Z","updated_at":"2018-01-11T19:09:43.889Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278548,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T19:21:28.081Z","updated_at":"2018-01-11T19:21:28.081Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2284967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-15T09:30:33.623Z","updated_at":"2018-03-14T20:17:57.778Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2319652,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-26T01:11:06.312Z","updated_at":"2018-01-26T01:11:06.312Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"bounty_amount":"10000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"vicompany","url":"/vicompany"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2319653,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-26T01:11:15.058Z","updated_at":"2018-01-26T01:11:15.058Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"vicompany","url":"/vicompany"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2403495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-19T08:52:44.381Z","updated_at":"2018-02-19T08:52:44.381Z","first_to_agree":true,"actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2513557,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-21T08:52:55.731Z","updated_at":"2018-03-21T08:52:55.731Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2562506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-03T21:38:32.483Z","updated_at":"2018-04-03T21:38:32.483Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2563466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-04T07:36:26.169Z","updated_at":"2018-04-04T07:36:26.169Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6904,"category":"team","content":"The researchers noticed an issue with our ETH receiving code when receiving from a contract. This allowed sending of ETH to Coinbase to be credited even if the underlying contract execution failed. The issue was fixed by changing the contract handling logic. Analysis of the issue indicated only accidental loss for Coinbase, and no exploitation attempts.\n\nThe Security team thanks @vicompany for the quick disclosure, and also the internal team for pushing a fix within hours. We do appreciate @vicompany's patience as the full communication loop back to HackerOne took significantly longer than the fix deployment cycle.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe researchers noticed an issue with our ETH receiving code when receiving from a contract. This allowed sending of ETH to Coinbase to be credited even if the underlying contract execution failed. The issue was fixed by changing the contract handling logic. Analysis of the issue indicated only accidental loss for Coinbase, and no exploitation attempts.\u003c/p\u003e\n\n\u003cp\u003eThe Security team thanks \u003ca href=\"/vicompany\"\u003e@vicompany\u003c/a\u003e for the quick disclosure, and also the internal team for pushing a fix within hours. We do appreciate \u003ca href=\"/vicompany\"\u003e@vicompany\u003c/a\u003e\u0026#39;s patience as the full communication loop back to HackerOne took significantly longer than the fix deployment cycle.\u003c/p\u003e\n"},{"id":6862,"category":"researcher","content":"**Short Summary:** \nBy using a smart contract to distribute ether over a set of wallets you can manipulate the account balance of your Coinbase account. If 1 of the internal transactions in the smart contract fails all transactions before that will be reversed. But on Coinbase these transactions will not be reversed, meaning someone could add as much ether to their balance as they want. When you look up the Coinbase wallet address after this transaction you will see that it is empty, but checking your Coinbase wallet will show your funds.\n\n**Steps To Reproduce:**\n* Setup a smart contract with a few valid Coinbase wallets and 1 final faulty wallet (always throw exception when receiving funds smart contract for example)\n* Transfer appropriate funds to smart contract.\n* Execute smart contract adding the set amount of ether to the Coinbase wallets without ever actually leaving the smart contract wallet because the complete transaction fails at the last wallet.\n* Repeat until you have more than enough ethereum in your Coinbase wallet.\n* Cash out, transfer to off site wallet\n\nFor some more information see\nhttps://www.vicompany.nl/magazine/from-christmas-present-in-the-blockchain-to-massive-bug-bounty","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cstrong\u003eShort Summary:\u003c/strong\u003e \u003cbr\u003e\nBy using a smart contract to distribute ether over a set of wallets you can manipulate the account balance of your Coinbase account. If 1 of the internal transactions in the smart contract fails all transactions before that will be reversed. But on Coinbase these transactions will not be reversed, meaning someone could add as much ether to their balance as they want. When you look up the Coinbase wallet address after this transaction you will see that it is empty, but checking your Coinbase wallet will show your funds.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps To Reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSetup a smart contract with a few valid Coinbase wallets and 1 final faulty wallet (always throw exception when receiving funds smart contract for example)\u003c/li\u003e\n\u003cli\u003eTransfer appropriate funds to smart contract.\u003c/li\u003e\n\u003cli\u003eExecute smart contract adding the set amount of ether to the Coinbase wallets without ever actually leaving the smart contract wallet because the complete transaction fails at the last wallet.\u003c/li\u003e\n\u003cli\u003eRepeat until you have more than enough ethereum in your Coinbase wallet.\u003c/li\u003e\n\u003cli\u003eCash out, transfer to off site wallet\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFor some more information see\u003cbr\u003e\n\u003ca title=\"https://www.vicompany.nl/magazine/from-christmas-present-in-the-blockchain-to-massive-bug-bounty\" href=\"/redirect?url=https%3A%2F%2Fwww.vicompany.nl%2Fmagazine%2Ffrom-christmas-present-in-the-blockchain-to-massive-bug-bounty\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.vicompany.nl/magazine/from-christmas-present-in-the-blockchain-to-massive-bug-bounty\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}