{"id":1029027,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI5MDI3","url":"https://hackerone.com/reports/1029027","title":"Bypass subscription","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-07T14:41:11.309Z","submitted_at":"2020-11-07T14:41:11.355Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"1a2er3d","url":"/1a2er3d","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/DWBWddP3mjaXNTU72fdZGmPi/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":638,"url":"https://hackerone.com/imgur","handle":"imgur","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Imgur","twitter_handle":"imgur","website":"http://imgur.com","about":"The most awesome images on the Internet."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-13T17:28:19.982Z","bug_reporter_agreed_on_going_public_at":"2020-11-13T17:28:18.033Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team! You can bypass avatar subscriptions.\nThus, without connecting a subscription - it's free.\n\nA list of all avatars is available at the address below, with a GET request:\n\n```\n:method: GET\n:authority: api.imgur.com\n:scheme: https\n:path: /account/v1/accounts/me/avatars?client_id=YOU CLIENT ID\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\ndnt: 1\naccept: */*\norigin: https://imgur.com\nsec-fetch-site: same-site\nsec-fetch-mode: cors\nsec-fetch-dest: empty\nreferer: https://imgur.com/\naccept-encoding: gzip, deflate, br\naccept-language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7\nYOU COOKIE\n\n```\n\nBut the subscription on the site is paid and without this trick it cannot be bypassed.\nWe use \" \" - space in front of the icon name and get paid icon for free.\n\nBelow is the request to send\n\n ```\n:method: PATCH\n:authority: api.imgur.com\n:scheme: https\n:path: /account/v1/accounts/me?client_id=YOU CLIENT ID\naccept: application/vnd.imgur.v1+json\ndnt: 1\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\ncontent-type: application/vnd.imgur.v1+json\norigin: https://imgur.com\nsec-fetch-site: same-site\nsec-fetch-mode: cors\nsec-fetch-dest: empty\nreferer: https://imgur.com/\naccept-encoding: gzip, deflate, br\naccept-language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7\nYOU COOKIE\n\nContent-Length: 73\n\n{\n\t\"avatar_id\": \" subscription/spooktober-pumpkin\", \n\t\"id\": YOU ID\n}\n ```\n__Small recommendation __\n\nThe point is that you use \"TRIM\" after checking by name. It turns out TRIM strips the space and it bypasses the check.\n\n**I think this information will be useful to you.**\n\n## Impact\n\nWe connect a paid avatar - for free.\nThus, we bypass the subscription.","vulnerability_information_html":"\u003cp\u003eHello team! You can bypass avatar subscriptions.\u003cbr\u003e\nThus, without connecting a subscription - it\u0026#39;s free.\u003c/p\u003e\n\n\u003cp\u003eA list of all avatars is available at the address below, with a GET request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e:method: GET\n:authority: api.imgur.com\n:scheme: https\n:path: /account/v1/accounts/me/avatars?client_id=YOU CLIENT ID\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\ndnt: 1\naccept: */*\norigin: https://imgur.com\nsec-fetch-site: same-site\nsec-fetch-mode: cors\nsec-fetch-dest: empty\nreferer: https://imgur.com/\naccept-encoding: gzip, deflate, br\naccept-language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7\nYOU COOKIE\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut the subscription on the site is paid and without this trick it cannot be bypassed.\u003cbr\u003e\nWe use \u0026quot; \u0026quot; - space in front of the icon name and get paid icon for free.\u003c/p\u003e\n\n\u003cp\u003eBelow is the request to send\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e:method: PATCH\n:authority: api.imgur.com\n:scheme: https\n:path: /account/v1/accounts/me?client_id=YOU CLIENT ID\naccept: application/vnd.imgur.v1+json\ndnt: 1\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\ncontent-type: application/vnd.imgur.v1+json\norigin: https://imgur.com\nsec-fetch-site: same-site\nsec-fetch-mode: cors\nsec-fetch-dest: empty\nreferer: https://imgur.com/\naccept-encoding: gzip, deflate, br\naccept-language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7\nYOU COOKIE\n\nContent-Length: 73\n\n{\n    \u0026quot;avatar_id\u0026quot;: \u0026quot; subscription/spooktober-pumpkin\u0026quot;, \n    \u0026quot;id\u0026quot;: YOU ID\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e_\u003cu\u003eSmall recommendation _\u003c/u\u003e\u003c/p\u003e\n\n\u003cp\u003eThe point is that you use \u0026quot;TRIM\u0026quot; after checking by name. It turns out TRIM strips the space and it bypasses the check.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eI think this information will be useful to you.\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWe connect a paid avatar - for free.\u003cbr\u003e\nThus, we bypass the subscription.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-13T17:28:18.091Z","allow_singular_disclosure_after":-1334664.6233138,"singular_disclosure_allowed":true,"vote_count":54,"voters":["pudsec","th4nu_0x0","rahsec","zeroxyele","mygf","mainteemoforfun","sudi","bhavi","hodkasia_sachin","demonia","and 44 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9756440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we're a small team and sometimes it takes us a while to verify all reports. Please don't ask for updates as these take time and effort away from the reports we're working through and make our response time slower across the board. Thanks - we'll be in touch soon!","markdown_message":"\u003cp\u003eHello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we\u0026#39;re a small team and sometimes it takes us a while to verify all reports. Please don\u0026#39;t ask for updates as these take time and effort away from the reports we\u0026#39;re working through and make our response time slower across the board. Thanks - we\u0026#39;ll be in touch soon!\u003c/p\u003e\n","automated_response":true,"created_at":"2020-11-07T14:41:11.855Z","updated_at":"2020-11-07T14:41:11.855Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9764108,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\nWe have accepted the report as valid and added an issue in our internal issue\ntracker for your report. We will update this page when more progress is made.\n\nThanks.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nWe have accepted the report as valid and added an issue in our internal issue\u003cbr\u003e\ntracker for your report. We will update this page when more progress is made.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-09T07:58:09.114Z","updated_at":"2020-11-09T07:58:09.114Z","actor":{"username":"srinidhik","cleared":false,"url":"/srinidhik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/342/158/8d34a803d2f3fffe842a3047954bcf0007d73044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9770784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will I receive a bug bounty as well?","markdown_message":"\u003cp\u003eWill I receive a bug bounty as well?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-09T16:49:20.058Z","updated_at":"2020-11-09T16:49:20.058Z","actor":{"username":"1a2er3d","cleared":false,"url":"/1a2er3d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DWBWddP3mjaXNTU72fdZGmPi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9775343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@specialagent,\n\u003e Will I receive a bug bounty as well?\n\nYes, of course.","markdown_message":"\u003cp\u003e\u003ca href=\"/specialagent\"\u003e@specialagent\u003c/a\u003e,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWill I receive a bug bounty as well?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes, of course.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-10T07:17:56.791Z","updated_at":"2020-11-10T07:17:56.791Z","actor":{"username":"srinidhik","cleared":false,"url":"/srinidhik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/342/158/8d34a803d2f3fffe842a3047954bcf0007d73044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9793743,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!","markdown_message":"\u003cp\u003eThe Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-11T18:07:57.542Z","updated_at":"2020-11-11T18:07:57.542Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"imgur","collaborator":{"username":"1a2er3d","url":"/1a2er3d"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9793942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you! ","markdown_message":"\u003cp\u003eThank you! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-11T18:37:52.893Z","updated_at":"2020-11-11T18:37:52.893Z","actor":{"username":"1a2er3d","cleared":false,"url":"/1a2er3d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DWBWddP3mjaXNTU72fdZGmPi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9796837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@1a2er3d,\nWe have released a fix that should address this issue, can you please re-test\nand confirm?\n\nThanks.","markdown_message":"\u003cp\u003e\u003ca href=\"/1a2er3d\"\u003e@1a2er3d\u003c/a\u003e,\u003cbr\u003e\nWe have released a fix that should address this issue, can you please re-test\u003cbr\u003e\nand confirm?\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T06:49:59.124Z","updated_at":"2020-11-12T06:49:59.124Z","actor":{"username":"srinidhik","cleared":false,"url":"/srinidhik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/342/158/8d34a803d2f3fffe842a3047954bcf0007d73044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9796869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed 100%, thank you! ","markdown_message":"\u003cp\u003eFixed 100%, thank you! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T07:02:18.037Z","updated_at":"2020-11-12T07:02:18.037Z","actor":{"username":"1a2er3d","cleared":false,"url":"/1a2er3d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DWBWddP3mjaXNTU72fdZGmPi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9816442,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for helping make Imgur more secure; closing this as *Resolved*.","markdown_message":"\u003cp\u003eThanks for helping make Imgur more secure; closing this as \u003cem\u003eResolved\u003c/em\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-13T17:20:27.727Z","updated_at":"2020-11-13T17:20:27.727Z","actor":{"username":"srinidhik","cleared":false,"url":"/srinidhik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/342/158/8d34a803d2f3fffe842a3047954bcf0007d73044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"1a2er3d","url":"/1a2er3d"},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9816785,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since everything is fixed and the report is closed, can we put it on public display?","markdown_message":"\u003cp\u003eSince everything is fixed and the report is closed, can we put it on public display?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-13T17:28:18.054Z","updated_at":"2020-11-13T17:28:18.054Z","first_to_agree":true,"actor":{"username":"1a2er3d","cleared":false,"url":"/1a2er3d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DWBWddP3mjaXNTU72fdZGmPi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10090141,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-13T17:28:20.019Z","updated_at":"2020-12-13T17:28:20.019Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}