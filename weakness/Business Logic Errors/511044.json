{"id":511044,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTEwNDQ=","url":"https://hackerone.com/reports/511044","title":"[www.zomato.com] Availing Zomato Gold membership for free by tampering plan id(s) ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-16T17:56:32.161Z","submitted_at":"2019-03-16T17:56:32.161Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pasw","url":"/pasw","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-18T08:09:55.631Z","bug_reporter_agreed_on_going_public_at":"2019-03-17T06:58:51.938Z","team_member_agreed_on_going_public_at":"2019-03-18T08:09:55.563Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nGet free zomato gold membership using zomato iOS app.\n\n**Description:** [add more details about this vulnerability]\n1) Login to the zomato iOS application.\n2) Select zomato gold from the home screen.\n3) Depending on your location, you will see different gold pack options. \n4) Select any gold pack. \n5) Select payment method.\n6) Intercept the api using burp. \nPOST ████useragent=model_iPad__os_9.3.5__v_13.1.9__t_iPad\u0026app_version=13.1.9\u0026push_permission=0\u0026session_id=7\u0026app_run_id=1\u0026lang=en\u0026presentlon=77.70730672359205\u0026uuid=YOUR_UUID\n\naccess_token=YOUR_ACCESS_TOKEN\u0026amount=1050\u0026city_id=4\u0026client_id=zomato_ios_v2\u0026email=YOUR_EMAIL\u0026name=YOUR_NAME\u0026██████plan_id=40\n\n7) You can see that the api takes plan_id and amount as paramter. \n8) I decided to try various other plain_Ids using burp intruder. \n9) Using the intruder, I figured out that the plan_Id 147 has a membership cost of 0.\n**(Image: intruder_plan_ids.png)**\n10) Replace the plan id and amount the step 6. **( Image: api_request.png)**\nPOST █████████useragent=model_iPad__os_9.3.5__v_13.1.9__t_iPad\u0026app_version=13.1.9\u0026push_permission=0\u0026session_id=7\u0026app_run_id=1\u0026lang=en\u0026presentlon=77.70730672359205\u0026uuid=YOUR_UUID\n\naccess_token=YOUR_ACCESS_TOKEN\u0026amount=0\u0026city_id=4\u0026client_id=zomato_ios_v2\u0026email=YOUR_EMAIL\u0026name=YOUR_NAME\u0026██████████plan_id=147\n\n11) You will get the following response.   **(Image: api_response.png)**\n{\"response\":{\"status\":\"success\",\"message\":\"Transaction Approved Without Sending to Gateway\"\n\n12) You are now a zomato gold member. \n13) There is also a referral program in zomato. In this program, if your freind buys zomato gold using your referral code, you get another 1 month of free membership. \n14) The attacker can create as many accounts as possible and share his referral code with these accounts, purchase free zomato gold from the new codes using the referral code and also get 1 month extended membership for each referral. **(Image: extended_gold_by_1_month_sharing_voucher_code.png)** \n\n**RCA:**\n1. Some apis take in the plan_id and give the plan details in the response.\n2. This makes it easier for the attacker to enumerate plan ids. \n3. Also, multiple plans are valid at the same time.\n\n**Possible Fixes:**\n1. Plan_ids should not be easily guessable.\n2. Only required plans should be kept active and all other plans should be disabled.\n3. If possible, for any payment made, have some extra checks when the payment_amount is zero.\n\n## Impact\n\nAn attacker can get zomato subscription free of cost for a month. Then using the referral code, he can extended the subscription by another month for each successful free referral using fake accounts.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nGet free zomato gold membership using zomato iOS app.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e [add more details about this vulnerability]\u003cbr\u003e\n1) Login to the zomato iOS application.\u003cbr\u003e\n2) Select zomato gold from the home screen.\u003cbr\u003e\n3) Depending on your location, you will see different gold pack options. \u003cbr\u003e\n4) Select any gold pack. \u003cbr\u003e\n5) Select payment method.\u003cbr\u003e\n6) Intercept the api using burp. \u003cbr\u003e\nPOST ████useragent=model_iPad_\u003cu\u003eos_9.3.5\u003c/u\u003e\u003cu\u003ev_13.1.9\u003c/u\u003e_t_iPad\u0026amp;app_version=13.1.9\u0026amp;push_permission=0\u0026amp;session_id=7\u0026amp;app_run_id=1\u0026amp;lang=en\u0026amp;presentlon=77.70730672359205\u0026amp;uuid=YOUR_UUID\u003c/p\u003e\n\n\u003cp\u003eaccess_token=YOUR_ACCESS_TOKEN\u0026amp;amount=1050\u0026amp;city_id=4\u0026amp;client_id=zomato_ios_v2\u0026amp;email=YOUR_EMAIL\u0026amp;name=YOUR_NAME\u0026amp;██████plan_id=40\u003c/p\u003e\n\n\u003cp\u003e7) You can see that the api takes plan_id and amount as paramter. \u003cbr\u003e\n8) I decided to try various other plain_Ids using burp intruder. \u003cbr\u003e\n9) Using the intruder, I figured out that the plan_Id 147 has a membership cost of 0.\u003cbr\u003e\n\u003cstrong\u003e(Image: intruder_plan_ids.png)\u003c/strong\u003e\u003cbr\u003e\n10) Replace the plan id and amount the step 6. \u003cstrong\u003e( Image: api_request.png)\u003c/strong\u003e\u003cbr\u003e\nPOST █████████useragent=model_iPad_\u003cu\u003eos_9.3.5\u003c/u\u003e\u003cu\u003ev_13.1.9\u003c/u\u003e_t_iPad\u0026amp;app_version=13.1.9\u0026amp;push_permission=0\u0026amp;session_id=7\u0026amp;app_run_id=1\u0026amp;lang=en\u0026amp;presentlon=77.70730672359205\u0026amp;uuid=YOUR_UUID\u003c/p\u003e\n\n\u003cp\u003eaccess_token=YOUR_ACCESS_TOKEN\u0026amp;amount=0\u0026amp;city_id=4\u0026amp;client_id=zomato_ios_v2\u0026amp;email=YOUR_EMAIL\u0026amp;name=YOUR_NAME\u0026amp;██████████plan_id=147\u003c/p\u003e\n\n\u003cp\u003e11) You will get the following response.   \u003cstrong\u003e(Image: api_response.png)\u003c/strong\u003e\u003cbr\u003e\n{\u0026quot;response\u0026quot;:{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;,\u0026quot;message\u0026quot;:\u0026quot;Transaction Approved Without Sending to Gateway\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e12) You are now a zomato gold member. \u003cbr\u003e\n13) There is also a referral program in zomato. In this program, if your freind buys zomato gold using your referral code, you get another 1 month of free membership. \u003cbr\u003e\n14) The attacker can create as many accounts as possible and share his referral code with these accounts, purchase free zomato gold from the new codes using the referral code and also get 1 month extended membership for each referral. \u003cstrong\u003e(Image: extended_gold_by_1_month_sharing_voucher_code.png)\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRCA:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSome apis take in the plan_id and give the plan details in the response.\u003c/li\u003e\n\u003cli\u003eThis makes it easier for the attacker to enumerate plan ids. \u003c/li\u003e\n\u003cli\u003eAlso, multiple plans are valid at the same time.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003ePossible Fixes:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ePlan_ids should not be easily guessable.\u003c/li\u003e\n\u003cli\u003eOnly required plans should be kept active and all other plans should be disabled.\u003c/li\u003e\n\u003cli\u003eIf possible, for any payment made, have some extra checks when the payment_amount is zero.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can get zomato subscription free of cost for a month. Then using the referral code, he can extended the subscription by another month for each successful free referral using fake accounts.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":216,"voters":["fersingb","0xnan","fr33rh","r00ster","0xbeefed","base_64","mik317","yamcha","pasw","sameerphad72","and 206 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":390,"asset_type":"APPLE_STORE_APP_ID","asset_identifier":"434613896","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4337722,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-16T18:20:33.714Z","updated_at":"2019-03-16T18:20:33.714Z","additional_data":{"old_severity":"Critical","new_severity":"Medium (6.5)","old_severity_id":317716,"new_severity_id":317719},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4337726,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @pasw - This has been fixed. Thanks for helping us keep @zomato secure.\n\n████████\n\nPrateek","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pasw\"\u003e@pasw\u003c/a\u003e - This has been fixed. Thanks for helping us keep \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e secure.\u003c/p\u003e\n\n\u003cp\u003e████████\u003c/p\u003e\n\n\u003cp\u003ePrateek\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T18:21:57.624Z","updated_at":"2019-03-17T10:02:15.521Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pasw","url":"/pasw"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4337875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow @prateek_0490-zomato. Thats really impressive.\n███████\n███████\nI tried on two just to verify if the referral code was working and if I could increase my membership.","markdown_message":"\u003cp\u003eWow \u003ca href=\"/prateek_0490-zomato\"\u003e@prateek_0490-zomato\u003c/a\u003e. Thats really impressive.\u003cbr\u003e\n███████\u003cbr\u003e\n███████\u003cbr\u003e\nI tried on two just to verify if the referral code was working and if I could increase my membership.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T19:16:33.268Z","updated_at":"2019-03-17T10:02:52.104Z","actor":{"username":"pasw","cleared":false,"url":"/pasw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4337883,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-16T19:19:44.046Z","updated_at":"2019-03-16T19:19:44.046Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"pasw","url":"/pasw"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4337895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for the bounty :) ","markdown_message":"\u003cp\u003eThanks a lot for the bounty :) \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T19:23:10.425Z","updated_at":"2019-03-16T19:23:10.425Z","actor":{"username":"pasw","cleared":false,"url":"/pasw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4339070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @prateek_0490-zomato,\n██████████\n██████","markdown_message":"\u003cp\u003eHello \u003ca href=\"/prateek_0490-zomato\"\u003e@prateek_0490-zomato\u003c/a\u003e,\u003cbr\u003e\n██████████\u003cbr\u003e\n██████\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-17T06:52:32.023Z","updated_at":"2019-03-17T10:03:55.291Z","actor":{"username":"pasw","cleared":false,"url":"/pasw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4339076,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, that’s expected. ███\n\nPrateek","markdown_message":"\u003cp\u003eYes, that’s expected. ███\u003c/p\u003e\n\n\u003cp\u003ePrateek\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-17T06:55:07.922Z","updated_at":"2019-03-17T10:04:16.692Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4339084,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. Thanks a lot. ","markdown_message":"\u003cp\u003eSure. Thanks a lot. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-17T06:58:38.601Z","updated_at":"2019-03-17T06:58:38.601Z","actor":{"username":"pasw","cleared":false,"url":"/pasw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4339085,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose?","markdown_message":"\u003cp\u003eCan we disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-17T06:58:51.968Z","updated_at":"2019-03-17T06:58:51.968Z","first_to_agree":true,"actor":{"username":"pasw","cleared":false,"url":"/pasw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4340610,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-17T09:56:12.015Z","updated_at":"2019-03-17T09:56:12.015Z","additional_data":{"old_title":"Get free zomato gold membership using iOS app.","new_title":"[www.zomato.com] Availing Zomato Gold membership for free by tampering plan id(s) "},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4343408,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-18T08:09:55.582Z","updated_at":"2019-03-18T08:09:55.582Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4343409,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-18T08:09:55.652Z","updated_at":"2019-03-18T08:09:55.652Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}