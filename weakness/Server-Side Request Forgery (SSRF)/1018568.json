{"id":1018568,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE4NTY4","url":"https://hackerone.com/reports/1018568","title":"Server Side Request Forgery in 'Jabber settings' in Admin Control Panel","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-10-26T02:08:22.155Z","submitted_at":"2020-10-26T02:08:22.204Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"they","url":"/they","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8936,"url":"https://hackerone.com/phpbb","handle":"phpbb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/936/b55f672a4229962bd2f7e68593c1df9762be29f4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/936/b55f672a4229962bd2f7e68593c1df9762be29f4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"phpBB","twitter_handle":"phpbb","website":"https://www.phpbb.com","about":"phpBB is the world's most popular free and open source forum software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-20T17:04:13.089Z","bug_reporter_agreed_on_going_public_at":"2020-12-10T23:13:54.164Z","team_member_agreed_on_going_public_at":"2020-12-20T17:04:13.006Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Overview\nThe 'Jabber settings' panel inside the Administrator Control Panel can be used to access resources that would otherwise only be accessible by the host machine, including resources/services hosted on the `localhost` interface. This can be performed by setting the 'jabber server' parameter to the desired IP address, such as `127.0.0.1` and the port to the desired port. In some cases, service type/version numbers can be gathered as well as this information is printed to screen.\n\n## How to trigger\nSet 'jabber server' to 127.0.0.1\nSet 'Jabber port' to whatever port you want to check.\nCheck the 'Enabled' radio button\nClick submit\n\nIf the port is closed, you will see a socket error message 'Connection refused' error like this:\n{F1051582}\n\nSome such as mysqld simply return:\n\u003e Could not authorize on Jabber server.\n\n## Example Recording\nI have hosted an internal sshd service on `127.0.0.1:2222` to demonstrate that software type and version information is returned to the Administrator Control Panel. I am `ssh`'d into `phpbb-ubuntu`, which is running the aforementioned sshd service in debug mode so you can see the request hit. \n{F1051590}\n\n## Setup info\nBase OS: Ubuntu 20.04.1\nphpbb Version: 3.3.1\n{F1051573}\n\n## Impact\n\nAn attacker could use this to interact with and enumerate services and resources on behalf of the host machine (including resources hosted on the `localhost` interface). This can be used to port scan and, in some cases, perform service versioning/enumeration on the `localhost` interface as well as on machines hosted on the same network as the phpbb host machine.","vulnerability_information_html":"\u003ch2 id=\"overview\"\u003eOverview\u003c/h2\u003e\n\n\u003cp\u003eThe \u0026#39;Jabber settings\u0026#39; panel inside the Administrator Control Panel can be used to access resources that would otherwise only be accessible by the host machine, including resources/services hosted on the \u003ccode\u003elocalhost\u003c/code\u003e interface. This can be performed by setting the \u0026#39;jabber server\u0026#39; parameter to the desired IP address, such as \u003ccode\u003e127.0.0.1\u003c/code\u003e and the port to the desired port. In some cases, service type/version numbers can be gathered as well as this information is printed to screen.\u003c/p\u003e\n\n\u003ch2 id=\"how-to-trigger\"\u003eHow to trigger\u003c/h2\u003e\n\n\u003cp\u003eSet \u0026#39;jabber server\u0026#39; to 127.0.0.1\u003cbr\u003e\nSet \u0026#39;Jabber port\u0026#39; to whatever port you want to check.\u003cbr\u003e\nCheck the \u0026#39;Enabled\u0026#39; radio button\u003cbr\u003e\nClick submit\u003c/p\u003e\n\n\u003cp\u003eIf the port is closed, you will see a socket error message \u0026#39;Connection refused\u0026#39; error like this:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"conn_refused.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FGevTXaM6T67pcAuew7qdqqx?response-content-disposition=attachment%3B%20filename%3D%22conn_refused.png%22%3B%20filename%2A%3DUTF-8%27%27conn_refused.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=6ac6c63058825bdc2affd258c603a40e55d7833c71026148be63e0c08fcb8d62\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FGevTXaM6T67pcAuew7qdqqx?response-content-disposition=attachment%3B%20filename%3D%22conn_refused.png%22%3B%20filename%2A%3DUTF-8%27%27conn_refused.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=6ac6c63058825bdc2affd258c603a40e55d7833c71026148be63e0c08fcb8d62\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSome such as mysqld simply return:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCould not authorize on Jabber server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"example-recording\"\u003eExample Recording\u003c/h2\u003e\n\n\u003cp\u003eI have hosted an internal sshd service on \u003ccode\u003e127.0.0.1:2222\u003c/code\u003e to demonstrate that software type and version information is returned to the Administrator Control Panel. I am \u003ccode\u003essh\u003c/code\u003e\u0026#39;d into \u003ccode\u003ephpbb-ubuntu\u003c/code\u003e, which is running the aforementioned sshd service in debug mode so you can see the request hit. \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"recording-1603676588353.webm\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rp5vt3rpiJ8HLyBFec3VJSig?response-content-disposition=attachment%3B%20filename%3D%22recording-1603676588353.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1603676588353.webm\u0026amp;response-content-type=video%2Fwebm\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=81c7f9d5e93728b80b5a6606ff2036ed4840ea18ea209ea0200d02d3937d7d6f\" data-attachment-type=\"video/webm\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rp5vt3rpiJ8HLyBFec3VJSig?response-content-disposition=attachment%3B%20filename%3D%22recording-1603676588353.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1603676588353.webm\u0026amp;response-content-type=video%2Fwebm\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=81c7f9d5e93728b80b5a6606ff2036ed4840ea18ea209ea0200d02d3937d7d6f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"setup-info\"\u003eSetup info\u003c/h2\u003e\n\n\u003cp\u003eBase OS: Ubuntu 20.04.1\u003cbr\u003e\nphpbb Version: 3.3.1\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"version.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/i2EqFVEjWyrQ91iQbf1LkeJJ?response-content-disposition=attachment%3B%20filename%3D%22version.png%22%3B%20filename%2A%3DUTF-8%27%27version.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=0e8fefba7ba0c5ae8c93bed40063f945eb10d496479f944b311ab950019fda39\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/i2EqFVEjWyrQ91iQbf1LkeJJ?response-content-disposition=attachment%3B%20filename%3D%22version.png%22%3B%20filename%2A%3DUTF-8%27%27version.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T041154Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026amp;X-Amz-Signature=0e8fefba7ba0c5ae8c93bed40063f945eb10d496479f944b311ab950019fda39\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could use this to interact with and enumerate services and resources on behalf of the host machine (including resources hosted on the \u003ccode\u003elocalhost\u003c/code\u003e interface). This can be used to port scan and, in some cases, perform service versioning/enumeration on the \u003ccode\u003elocalhost\u003c/code\u003e interface as well as on machines hosted on the same network as the phpbb host machine.\u003c/p\u003e\n","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1051573,"file_name":"version.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/i2EqFVEjWyrQ91iQbf1LkeJJ?response-content-disposition=attachment%3B%20filename%3D%22version.png%22%3B%20filename%2A%3DUTF-8%27%27version.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041154Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=0e8fefba7ba0c5ae8c93bed40063f945eb10d496479f944b311ab950019fda39","file_size":61539,"type":"image/png"},{"id":1051576,"file_name":"howtotrigger.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hLTPTB5ZmmtHS6XXTPgDdqDc?response-content-disposition=attachment%3B%20filename%3D%22howtotrigger.png%22%3B%20filename%2A%3DUTF-8%27%27howtotrigger.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041154Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=48b1f389fdefccc39328d210d69097566c055d30a48c650be983565a5af07034","file_size":180489,"type":"image/png"},{"id":1051582,"file_name":"conn_refused.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FGevTXaM6T67pcAuew7qdqqx?response-content-disposition=attachment%3B%20filename%3D%22conn_refused.png%22%3B%20filename%2A%3DUTF-8%27%27conn_refused.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041154Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=6ac6c63058825bdc2affd258c603a40e55d7833c71026148be63e0c08fcb8d62","file_size":18282,"type":"image/png"},{"id":1051590,"file_name":"recording-1603676588353.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rp5vt3rpiJ8HLyBFec3VJSig?response-content-disposition=attachment%3B%20filename%3D%22recording-1603676588353.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1603676588353.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUELEOUFM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041154Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEHcXLEQPeJ1NbEZdJXi%2BjDjW%2Brvnvj%2FJxEOqy4HmeuwAiBgfPiwnDW5VOmXCmdoSe8v4i4f3S1PrDzJHYj%2FK50vXSq0AwhTEAEaDDAxMzYxOTI3NDg0OSIMaRbp4M0ZZ3Ux0slgKpEDvGtg639OjuV4555YTXv0v1%2B3YeZYF7O3onBjNlgrOhYRA2lprfPhUel71T%2FX8MbclnF3ZoJTRbh1SdgGfYOStDOta4s40bALV9ZmACLawkbdV5j9rxJ9pCGv21GYDtjHl%2BVgYvqeUwT5NO%2BGzBJrB503UxwAbns4iOwLRos1I4mDZe8lyTK4OMOf2a1zF%2BFTTlSMuC7w658c6qUWnC5%2BArvYu5FSuBUNrnkIR0rG7uhSI8ku8glS3yPDiQjxIRB%2F6CwvXzaA%2B2%2FNSYCsbFFNan5Z3Qv3Pw0xINQ1V2xkEBrKDV2pJ42QAmmq7rgxA7nqrBru1GFYFrIkNUKpGw7I9OnBd81CnAxR9SYAoa%2B6sQ2cYGkXqOUhL0i6m1jBJc%2FiP11Lb%2FbVovAvfjqWsjLoQGLW6ZOZXFlq4Bb6qVcqO%2FV489Jh7LKgvf31VImkKBHPJZwDVAxn2q5yPm6TakzKJPvE4pDzpxa7Nw3oQ8Knf4I3qGhuif9BXRI3vu%2BhplC7ximOU4kG0vG2MI8F3rK2Xxow8Y6q%2FwU67AGCwlwk%2Fh50Mwp%2FofR%2Be%2BD5LiLGKMPNwxJJuYfv0E3oKNIT9wTCjV1Id28if6r3Zw9qtUxsnDKkDk%2B14l2fH9vPhI8cfp9BDEEHlfIIuWpITf0EUwAKcW%2BaKDKVRx%2FLb6InewTMZ%2B%2FgFi6gBqHlzu6MCAeys7vQVufF0akHiMP%2BiPeXfKCLU%2F4r9BeqnyEJqvrxabHfVXrZG5WsK5OLFxwqz4j4dpwzxocYRpH4zbbfII18jPfcKEQtcvg9zCzIaEfzIbLATRocx3PcEQLLDsdGuqcKyAv9S5VdHnJUqfDX%2BAjGLQcwxhdjmh4WHg%3D%3D\u0026X-Amz-Signature=81c7f9d5e93728b80b5a6606ff2036ed4840ea18ea209ea0200d02d3937d7d6f","file_size":17506144,"type":"video/webm"}],"allow_singular_disclosure_at":"2021-01-09T23:13:54.204Z","allow_singular_disclosure_after":1018919.79702131,"singular_disclosure_allowed":false,"vote_count":7,"voters":["prophet","mygf","demonia","sodium_","cufflio","sahil__soni","naty060911"],"severity":{"rating":"low","score":3.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":12184,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/phpbb/phpbb","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9630867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for your extremely detailed report. We will examine and follow up soon.","markdown_message":"\u003cp\u003eThank you very much for your extremely detailed report. We will examine and follow up soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T02:56:09.018Z","updated_at":"2020-10-26T02:56:09.018Z","actor":{"username":"marshalrusty","cleared":false,"url":"/marshalrusty","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9631697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @they and thanks for your report!\n\nDo you have a suggestion on how to fix this issue, while still allowing to use this Jabber functionality? \n(on any server, either locally or remote)\n\nThanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/they\"\u003e@they\u003c/a\u003e and thanks for your report!\u003c/p\u003e\n\n\u003cp\u003eDo you have a suggestion on how to fix this issue, while still allowing to use this Jabber functionality? \u003cbr\u003e\n(on any server, either locally or remote)\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T07:23:45.520Z","updated_at":"2020-10-26T07:23:45.520Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9631699,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-26T07:24:03.180Z","updated_at":"2020-10-26T07:24:03.180Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9635824,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @derky,\n\nI thought about this while reporting because it is possible someone runs a jabber server on the same machine. I do think this is the edge case vs the norm, whereas I think it is much more likely someone is made an admin on a board without access to the underlying OS. So, a couple of my suggestions from that perspective:\n\nInitial thoughts are to use predefined error messages by default that don't immediately give away the service version or a definitive \"yes/no\" and allow for more descriptive messages via a `JABBER_DEBUG` config setting.\n\nAnother more thorough option would be to block `localhost` connections by default and have an `ALLOW_LIST` or similar that can be set either in `functions_jabber.php` or `config.php` where an admin with local access can add `127.0.0.1` or `localhost`. A step further would be also having a `BLOCK_LIST` that could be configured to not allow connections to specific subnets or IP's.  Would probably not be too bad to even detect a `localhost` connection attempt and return a specific error message saying:\n\u003e Localhost jabber connections must be allowed via `config.php`. Contact the server administrator for assistance.\n\nWhich would still make a fairly decent end user experience directing them towards the solution. Again, this just addresses the access control boundary that may be in place between an admin with local access vs an admin without local access.\n\nI will continue to think about it and comment with any other thoughts that I come up with...\n\nThanks for the quick replies!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/derky\"\u003e@derky\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI thought about this while reporting because it is possible someone runs a jabber server on the same machine. I do think this is the edge case vs the norm, whereas I think it is much more likely someone is made an admin on a board without access to the underlying OS. So, a couple of my suggestions from that perspective:\u003c/p\u003e\n\n\u003cp\u003eInitial thoughts are to use predefined error messages by default that don\u0026#39;t immediately give away the service version or a definitive \u0026quot;yes/no\u0026quot; and allow for more descriptive messages via a \u003ccode\u003eJABBER_DEBUG\u003c/code\u003e config setting.\u003c/p\u003e\n\n\u003cp\u003eAnother more thorough option would be to block \u003ccode\u003elocalhost\u003c/code\u003e connections by default and have an \u003ccode\u003eALLOW_LIST\u003c/code\u003e or similar that can be set either in \u003ccode\u003efunctions_jabber.php\u003c/code\u003e or \u003ccode\u003econfig.php\u003c/code\u003e where an admin with local access can add \u003ccode\u003e127.0.0.1\u003c/code\u003e or \u003ccode\u003elocalhost\u003c/code\u003e. A step further would be also having a \u003ccode\u003eBLOCK_LIST\u003c/code\u003e that could be configured to not allow connections to specific subnets or IP\u0026#39;s.  Would probably not be too bad to even detect a \u003ccode\u003elocalhost\u003c/code\u003e connection attempt and return a specific error message saying:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eLocalhost jabber connections must be allowed via \u003ccode\u003econfig.php\u003c/code\u003e. Contact the server administrator for assistance.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWhich would still make a fairly decent end user experience directing them towards the solution. Again, this just addresses the access control boundary that may be in place between an admin with local access vs an admin without local access.\u003c/p\u003e\n\n\u003cp\u003eI will continue to think about it and comment with any other thoughts that I come up with...\u003c/p\u003e\n\n\u003cp\u003eThanks for the quick replies!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T13:20:55.655Z","updated_at":"2020-10-26T13:20:55.655Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9651765,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"To start with your thorough suggestion, unfortunately trying to prevent connections to localhost is incredibly hard (if not impossible) because of all the possibilities. To a name a few options that all point to 127.0.0.1:\nhttp://2130706433\nhttp://0x7f000001\nhttp://0177.0.0.01\nhttp://127.1\nhttp://localtest.me\n\nJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\n \nI do agree that we can limit the error message by only saying the connection to the Jabber server failed. To fix the access control boundary we could limit this page to only allow admins with \"founder\" permissions. So it's not possible to fix this SSRF while still allowing Jabber, but we could change this as further hardening.\n\n\n\n\n\n","markdown_message":"\u003cp\u003eTo start with your thorough suggestion, unfortunately trying to prevent connections to localhost is incredibly hard (if not impossible) because of all the possibilities. To a name a few options that all point to 127.0.0.1:\u003cbr\u003e\n\u003ca title=\"http://2130706433\" href=\"/redirect?url=http%3A%2F%2F2130706433\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://2130706433\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://0x7f000001\" href=\"/redirect?url=http%3A%2F%2F0x7f000001\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0x7f000001\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://0177.0.0.01\" href=\"/redirect?url=http%3A%2F%2F0177.0.0.01\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0177.0.0.01\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://127.1\" href=\"/redirect?url=http%3A%2F%2F127.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://127.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://localtest.me\" href=\"/redirect?url=http%3A%2F%2Flocaltest.me\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localtest.me\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\u003c/p\u003e\n\n\u003cp\u003eI do agree that we can limit the error message by only saying the connection to the Jabber server failed. To fix the access control boundary we could limit this page to only allow admins with \u0026quot;founder\u0026quot; permissions. So it\u0026#39;s not possible to fix this SSRF while still allowing Jabber, but we could change this as further hardening.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-27T18:53:18.877Z","updated_at":"2020-10-27T18:53:18.877Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9653422,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @derky,\n\nYea, I am familiar with those, and that was another thing I considered. One thing I did want to mention was the possibility of resolving the provided hostname/ip and then validating it as an ipv4 or ipv6 address. A quick suggestion I threw together is:\n\n```\n$x = gethostbyname('0x7f000001');\n$is_valid = filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) || filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6);\n\nif((!$is_valid) || ($x ==\"127.0.0.1\")){\n print $x.\" is not valid\";\n}else{\n  print $x.\" is valid\";\n}\n```\n\nObviously more work can be done there (I am not a PHP developer by any stretch...), but that seemed to catch those edge cases, though I know there are probably infinity of them. But, it would catch the majority of what might come your way.\n\nThanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/derky\"\u003e@derky\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYea, I am familiar with those, and that was another thing I considered. One thing I did want to mention was the possibility of resolving the provided hostname/ip and then validating it as an ipv4 or ipv6 address. A quick suggestion I threw together is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$x = gethostbyname(\u0026#39;0x7f000001\u0026#39;);\n$is_valid = filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) || filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6);\n\nif((!$is_valid) || ($x ==\u0026quot;127.0.0.1\u0026quot;)){\n print $x.\u0026quot; is not valid\u0026quot;;\n}else{\n  print $x.\u0026quot; is valid\u0026quot;;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eObviously more work can be done there (I am not a PHP developer by any stretch...), but that seemed to catch those edge cases, though I know there are probably infinity of them. But, it would catch the majority of what might come your way.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-27T21:16:58.861Z","updated_at":"2020-10-27T21:16:58.861Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9654476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\n\nAlso wanted to say that I do agree with this.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAlso wanted to say that I do agree with this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-28T01:07:34.115Z","updated_at":"2020-10-28T01:07:34.115Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9697647,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your responses. We've discussed this internally and decided that we will limit the verbosity of the error messages as part of hardening.","markdown_message":"\u003cp\u003eThanks for your responses. We\u0026#39;ve discussed this internally and decided that we will limit the verbosity of the error messages as part of hardening.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-01T21:51:05.512Z","updated_at":"2020-11-01T21:51:05.512Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10067902,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-10T22:12:39.988Z","updated_at":"2020-12-10T22:12:39.988Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10067913,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Cory,\n\nThis was fixed by limiting communication content in the following release: https://www.phpbb.com/community/viewtopic.php?f=14\u0026t=2573416\n\nThanks for your report!","markdown_message":"\u003cp\u003eHi Cory,\u003c/p\u003e\n\n\u003cp\u003eThis was fixed by limiting communication content in the following release: \u003ca title=\"https://www.phpbb.com/community/viewtopic.php?f=14\u0026amp;t=2573416\" href=\"/redirect?url=https%3A%2F%2Fwww.phpbb.com%2Fcommunity%2Fviewtopic.php%3Ff%3D14%26t%3D2573416\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.phpbb.com/community/viewtopic.php?f=14\u0026amp;t=2573416\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-10T22:15:17.768Z","updated_at":"2020-12-10T22:15:17.768Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"they","url":"/they"},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10068143,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome! Thanks for crediting me in the release!","markdown_message":"\u003cp\u003eAwesome! Thanks for crediting me in the release!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-10T23:13:54.180Z","updated_at":"2020-12-10T23:13:54.180Z","first_to_agree":true,"actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10158308,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-20T17:04:13.026Z","updated_at":"2020-12-20T17:04:13.026Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10158309,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-20T17:04:13.111Z","updated_at":"2020-12-20T17:04:13.111Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}