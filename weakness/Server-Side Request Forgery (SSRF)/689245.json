{"id":689245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODkyNDU=","url":"https://hackerone.com/reports/689245","title":"SSRF In plantuml (on plantuml.pre.gitlab.com)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-09-06T00:02:52.414Z","submitted_at":"2019-09-06T00:02:52.414Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"plazmaz","url":"/plazmaz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-17T13:55:48.552Z","bug_reporter_agreed_on_going_public_at":"2019-09-10T17:39:21.873Z","team_member_agreed_on_going_public_at":"2020-08-17T13:55:48.419Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n### Summary\n\nThe site https://plantuml.pre.gitlab.com is vulnerable to SSRF. While I haven't spun up an instance to test if gitlab's integration with plantuml is vulnerable to this, it seems feasible that it is, given a few facotrs:\n#1 The SSRF is due to a feature in plantuml\n#2 A PlantUML integration exists for gitlab community edition\n#3 Due to conversation in gitlab (https://gitlab.com/gitlab-org/release/framework/issues/448, https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/2163/) I believe this is a staging server for plantuml\n\n### Steps to reproduce\n\n(Step-by-step guide to reproduce the issue, including:)\n1. Visit the following link:\nhttps://plantuml.pre.gitlab.com/uml/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOS1MNv1TO0m00\n2. Note that the UML of the website is included\n\nNote: It seems that while I was testing, access to instance metadata (169.254.169.254) was blocked (or limited), as the server now returns an error after timing out for the following uml, where previously it returned information:\n```\n@startuml\nstart\n    :Do some stuff;\n    !include http://169.254.169.254/\nstop;\n@enduml\n```\n\n\n### Impact\nThis allows attackers to access internal endpoints and data. Additionally, had the instance metadata not been restricted, accessing that information would be feasible. Additionally, this will likely allow for bypassing of the block of /proxy mentioned in this issue: https://gitlab.com/gitlab-org/release/framework/issues/457\n\n### What is the current *bug* behavior?\n\nThe plantuml server returns data from internal addresses:\nhttps://plantuml.pre.gitlab.com/png/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOw7CLb-GNM0C0\n\n### What is the expected *correct* behavior?\nThe plantuml server does not allow link-local network includes via the `include` statement\n\n## Impact\n\nIt's difficult to say, but given the default plantuml installation allows for this SSRF, it's likely multiple on-premises installations would open a risk for SSRF once plantuml is enabled. This site also allows for accessing other resources on its network in its current state","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eThe site \u003ca title=\"https://plantuml.pre.gitlab.com\" href=\"/redirect?url=https%3A%2F%2Fplantuml.pre.gitlab.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plantuml.pre.gitlab.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to SSRF. While I haven\u0026#39;t spun up an instance to test if gitlab\u0026#39;s integration with plantuml is vulnerable to this, it seems feasible that it is, given a few facotrs:\u003c/p\u003e\n\n\u003ch1 id=\"1-the-ssrf-is-due-to-a-feature-in-plantuml\"\u003e1 The SSRF is due to a feature in plantuml\u003c/h1\u003e\n\n\u003ch1 id=\"2-a-plantuml-integration-exists-for-gitlab-community-edition\"\u003e2 A PlantUML integration exists for gitlab community edition\u003c/h1\u003e\n\n\u003ch1 id=\"3-due-to-conversation-in-gitlab-https-gitlab-com-gitlab-org-release-framework-issues-448-https-gitlab-com-gitlab-com-gl-infra-infrastructure-issues-2163-i-believe-this-is-a-staging-server-for-plantuml\"\u003e3 Due to conversation in gitlab (\u003ca title=\"https://gitlab.com/gitlab-org/release/framework/issues/448\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Frelease%2Fframework%2Fissues%2F448\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/release/framework/issues/448\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca title=\"https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/2163/\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-com%2Fgl-infra%2Finfrastructure%2Fissues%2F2163%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/2163/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) I believe this is a staging server for plantuml\u003c/h1\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003cp\u003e(Step-by-step guide to reproduce the issue, including:)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVisit the following link:\n\u003ca title=\"https://plantuml.pre.gitlab.com/uml/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOS1MNv1TO0m00\" href=\"/redirect?url=https%3A%2F%2Fplantuml.pre.gitlab.com%2Fuml%2FAov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOS1MNv1TO0m00\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plantuml.pre.gitlab.com/uml/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOS1MNv1TO0m00\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNote that the UML of the website is included\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNote: It seems that while I was testing, access to instance metadata (169.254.169.254) was blocked (or limited), as the server now returns an error after timing out for the following uml, where previously it returned information:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e@startuml\nstart\n    :Do some stuff;\n    !include http://169.254.169.254/\nstop;\n@enduml\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"impact\"\u003eImpact\u003c/h3\u003e\n\n\u003cp\u003eThis allows attackers to access internal endpoints and data. Additionally, had the instance metadata not been restricted, accessing that information would be feasible. Additionally, this will likely allow for bypassing of the block of /proxy mentioned in this issue: \u003ca title=\"https://gitlab.com/gitlab-org/release/framework/issues/457\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Frelease%2Fframework%2Fissues%2F457\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/release/framework/issues/457\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-current-bug-behavior\"\u003eWhat is the current \u003cem\u003ebug\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eThe plantuml server returns data from internal addresses:\u003cbr\u003e\n\u003ca title=\"https://plantuml.pre.gitlab.com/png/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOw7CLb-GNM0C0\" href=\"/redirect?url=https%3A%2F%2Fplantuml.pre.gitlab.com%2Fpng%2FAov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOw7CLb-GNM0C0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plantuml.pre.gitlab.com/png/Aov9B2hXKW02AvTyXUByt5I5ufBIj3Hhi9XYPbvoJcbAga96IKc1bRw-eP6vdW4G6bfP65WOw7CLb-GNM0C0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"what-is-the-expected-correct-behavior\"\u003eWhat is the expected \u003cem\u003ecorrect\u003c/em\u003e behavior?\u003c/h3\u003e\n\n\u003cp\u003eThe plantuml server does not allow link-local network includes via the \u003ccode\u003einclude\u003c/code\u003e statement\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIt\u0026#39;s difficult to say, but given the default plantuml installation allows for this SSRF, it\u0026#39;s likely multiple on-premises installations would open a risk for SSRF once plantuml is enabled. This site also allows for accessing other resources on its network in its current state\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["sky003","mygf","naategh","khizer47","xko2x","sa1tama0","cryptographer","enessltk","hodiecras","sachin96","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5743469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @plazmaz,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 10 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-09-06T00:19:50.389Z","updated_at":"2019-09-06T00:19:50.389Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5745496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @plazamaz,\n\nThank you for this report.\nThere are indeed network controls that should restrict access to metadata information.\n\nGiven the point above and that plantuml is not yet available in production, we consider that there is no security impact today (pre.gitlab.com is a test infrastructure without any production data and out of scope of our bug bounty program).\n\nWe offer you to self-close this report within the next 3 days before we close it as `Informative`.\nPlease feel free to check again when plantuml is available in production.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/plazamaz\"\u003e@plazamaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report.\u003cbr\u003e\nThere are indeed network controls that should restrict access to metadata information.\u003c/p\u003e\n\n\u003cp\u003eGiven the point above and that plantuml is not yet available in production, we consider that there is no security impact today (pre.gitlab.com is a test infrastructure without any production data and out of scope of our bug bounty program).\u003c/p\u003e\n\n\u003cp\u003eWe offer you to self-close this report within the next 3 days before we close it as \u003ccode\u003eInformative\u003c/code\u003e.\u003cbr\u003e\nPlease feel free to check again when plantuml is available in production.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-06T09:03:16.998Z","updated_at":"2019-09-06T09:03:16.998Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5748860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually, plantuml is available in production, just not enabled in the cloud installation. This is something that can be enabled after GitLab 8.16: https://docs.gitlab.com/ee/administration/integration/plantuml.html. While that server may not be in scope, local gitlab installations **are**. Restricting network access within your servers is a bandaid fix for something that will impact customer installations.","markdown_message":"\u003cp\u003eActually, plantuml is available in production, just not enabled in the cloud installation. This is something that can be enabled after GitLab 8.16: \u003ca title=\"https://docs.gitlab.com/ee/administration/integration/plantuml.html\" href=\"/redirect?url=https%3A%2F%2Fdocs.gitlab.com%2Fee%2Fadministration%2Fintegration%2Fplantuml.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.gitlab.com/ee/administration/integration/plantuml.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. While that server may not be in scope, local gitlab installations \u003cstrong\u003eare\u003c/strong\u003e. Restricting network access within your servers is a bandaid fix for something that will impact customer installations.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-06T16:47:34.345Z","updated_at":"2019-09-06T16:47:34.345Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5757126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you truly feel this is not a risk to you, would you have any problem with me discussing the technique publicly? I feel that the use of plantuml as an attack vector is an interesting approach that I would like to talk about.","markdown_message":"\u003cp\u003eIf you truly feel this is not a risk to you, would you have any problem with me discussing the technique publicly? I feel that the use of plantuml as an attack vector is an interesting approach that I would like to talk about.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-08T16:59:54.378Z","updated_at":"2019-09-08T16:59:54.378Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5759262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @plazmaz,\n\nI have added this point to the agenda of our security team meeting tomorrow. I will come back to you with the result of our discussion.\n\nBest regards,\nGitLab Security Team\n\n\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI have added this point to the agenda of our security team meeting tomorrow. I will come back to you with the result of our discussion.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-09T07:45:26.067Z","updated_at":"2019-09-09T07:45:26.067Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5773086,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @plazmaz,\n\nThank you again for the report. \nWe will address it by a documentation update to advice on mitigating SSRF risks. \nWe are awarding a corresponding bounty. Congratulations!\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n\n\n\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report. \u003cbr\u003e\nWe will address it by a documentation update to advice on mitigating SSRF risks. \u003cbr\u003e\nWe are awarding a corresponding bounty. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-10T17:22:14.695Z","updated_at":"2019-09-10T17:22:14.695Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"plazmaz","url":"/plazmaz"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5773201,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing report, documentation issue tracked at https://gitlab.com/gitlab-org/gitlab-ee/issues/18085","markdown_message":"\u003cp\u003eClosing report, documentation issue tracked at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ee/issues/18085\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ee%2Fissues%2F18085\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ee/issues/18085\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-10T17:30:32.918Z","updated_at":"2019-09-10T17:30:32.918Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"plazmaz","url":"/plazmaz"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5773256,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great, thanks. Requesting disclosure.","markdown_message":"\u003cp\u003eGreat, thanks. Requesting disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-10T17:39:21.911Z","updated_at":"2019-09-10T17:39:21.911Z","first_to_agree":true,"actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5834086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @plazmaz,\n\nWe generally accept disclosure once the corresponding [issue](https://gitlab.com/gitlab-org/gitlab/issues/18085) is made public after it is closed.\n\nBest regards,\nGitLab Security Team\n\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe generally accept disclosure once the corresponding \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fissues%2F18085\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eissue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is made public after it is closed.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-18T09:55:45.947Z","updated_at":"2019-09-18T09:55:45.947Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5837607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, familiar with that policy, figured I'd request it so you can accept it once you're ready. Thanks!","markdown_message":"\u003cp\u003eYep, familiar with that policy, figured I\u0026#39;d request it so you can accept it once you\u0026#39;re ready. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-18T16:57:04.522Z","updated_at":"2019-09-18T16:57:04.522Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8958292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @plazmaz,\n\nWe added information in the documentation to bring attention to the SSRF risks of running PlantUML for self-hosted customers. It's available at https://docs.gitlab.com/ee/administration/integration/plantuml.html#security.\n\nI'm going to accept the disclosure request.\n\nThanks again for your report,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe added information in the documentation to bring attention to the SSRF risks of running PlantUML for self-hosted customers. It\u0026#39;s available at \u003ca title=\"https://docs.gitlab.com/ee/administration/integration/plantuml.html#security\" href=\"/redirect?url=https%3A%2F%2Fdocs.gitlab.com%2Fee%2Fadministration%2Fintegration%2Fplantuml.html%23security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.gitlab.com/ee/administration/integration/plantuml.html#security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to accept the disclosure request.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-17T13:55:48.445Z","updated_at":"2020-08-17T13:55:48.445Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8958293,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T13:55:48.584Z","updated_at":"2020-08-17T13:55:48.584Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":18174,"category":"researcher","content":"A staging server on gitlab supported rendering of PlantUML. I was able to use PlantUML to make internal network requests on this server. While this was not technically in scope, gitlab.com relies on network configuration to mitigate the SSRF risk plantuml presents via the `!include` function(which allows including remote resources). However, their standard setup instructions did not make it clear that this was a risk, and it is unlikely users configuring self-hosted gitlab instances would know to restrict network access to their PlantUML instance.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA staging server on gitlab supported rendering of PlantUML. I was able to use PlantUML to make internal network requests on this server. While this was not technically in scope, gitlab.com relies on network configuration to mitigate the SSRF risk plantuml presents via the \u003ccode\u003e!include\u003c/code\u003e function(which allows including remote resources). However, their standard setup instructions did not make it clear that this was a risk, and it is unlikely users configuring self-hosted gitlab instances would know to restrict network access to their PlantUML instance.\u003c/p\u003e\n"}]}