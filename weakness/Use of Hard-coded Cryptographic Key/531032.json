{"id":531032,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzEwMzI=","url":"https://hackerone.com/reports/531032","title":"Slack DTLS uses a private key that is in the public domain, which may lead to SRTP stream hijack","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-04-08T09:20:55.916Z","submitted_at":"2019-04-08T09:20:55.916Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sandrogauci","url":"/sandrogauci","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-12T00:17:02.105Z","bug_reporter_agreed_on_going_public_at":"2020-03-04T15:29:38.623Z","team_member_agreed_on_going_public_at":"2020-03-12T00:17:01.965Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"- Affects: Janus DTLS certificate\n\n### Description\n\nThe Janus server in use by Slack is configured using a certificate and private key that were previously distributed by default. This certificate is used to authenticate the DTLS _connection_ which is later used to exchange keys for the SRTP stream. As a result, the confidentiality of the WebRTC call over Slack cannot be ensured.\n\n\n### How to reproduce the issue\n\n1. Start Wireshark and set a display filter for stun\n2. In the web browser, open `about:webrtc-internals`\n3. Start a call on Slack\n4. Observe the packets containing the string _rainmaker_ which would be part of the DTLS certificate\n5. Notice that the `SetRemoteDescription` fingerprint in the `about:webrtc-internals` page is `C5:5F:DA:7D:84:47:B1:BF:6B:55:16:62:48:31:3E:D3:F1:7B:25:89:92:4A:4B:4D:4D:D9:D5:AF:EA:D8:15:44`\n\nThe old certificate can be obtained from the following commit where it was previously removed:\n\nhttps://github.com/meetecho/janus-gateway/commit/6f98f2dde644b3ead4a162c241dff9da1587ec13\n\nThe certificate's SHA256 checksum can be calculated using the OpenSSL command line tool as follows:\n\n```\nopenssl x509 -noout -fingerprint -sha256 -inform pem -in janus-cert1.crt \nSHA256 Fingerprint=C5:5F:DA:7D:84:47:B1:BF:6B:55:16:62:48:31:3E:D3:F1:7B:25:89:92:4A:4B:4D:4D:D9:D5:AF:EA:D8:15:44\n```\n\nAttachments:\n\n- `dump-stun.pcapng`: contains the data stream containing the TURN tunnelled DTLS exchange and SRTP stream that follows\n- `janus-cert1.crt` and `janus-cert1.key` are the certificate and key in use by Slack\n- `2019-04-07_16-06-wireshark.png` shows the certificate in the Wireshark dump\n- `2019-04-07_16-13-fingerprint.png` shows the SHA256 fingerprint which matches the public certificate and corresponding private key\n\nAn attacker would probably need to take the following steps to exploit this issue in the case of Slack:\n\n1. Start a man-in-the-middle attack using any known method (ARP cache poisoning, DNS cache poisoning, static routes on compromised network router etc)\n2. Actively hijack the Slack TURN servers between the victim and the Internet\n3. Wait for victim to make a Slack call\n4. Handle STUN packets from victim to attacker-controlled TURN server; allow authentication with any password\n5. Start DTLS exchange\n6. When DTLS certificate is required, present victim with the Janus default certificate\n7. The attacker does __NOT__ verify the victim's DTLS certificate\n8. The SRTP Master Key is set over this DTLS connection\n9. Attacker can now handle the SRTP stream between the victim and attacker\n\n### Solutions and recommendations\n\nIt is recommended to generate a new certificate and private key.\n\n## Impact\n\nAttackers positioned as man-in-the-middle may hijack the DTLS connection and set their own SRTP keys, handling the SRTP stream instead of Slack. This is still research in progress but it does not appear that attackers can perform a two-way MITM attack due to the mutual authentication required by the DTLS exchange. Therefore, it seems that this vulnerability can only be abused to hijack the SRTP stream between the WebRTC client and Slack but not the other way round.","vulnerability_information_html":"\u003cul\u003e\n\u003cli\u003eAffects: Janus DTLS certificate\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"description\"\u003eDescription\u003c/h3\u003e\n\n\u003cp\u003eThe Janus server in use by Slack is configured using a certificate and private key that were previously distributed by default. This certificate is used to authenticate the DTLS \u003cu\u003econnection\u003c/u\u003e which is later used to exchange keys for the SRTP stream. As a result, the confidentiality of the WebRTC call over Slack cannot be ensured.\u003c/p\u003e\n\n\u003ch3 id=\"how-to-reproduce-the-issue\"\u003eHow to reproduce the issue\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eStart Wireshark and set a display filter for stun\u003c/li\u003e\n\u003cli\u003eIn the web browser, open \u003ccode\u003eabout:webrtc-internals\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eStart a call on Slack\u003c/li\u003e\n\u003cli\u003eObserve the packets containing the string \u003cu\u003erainmaker\u003c/u\u003e which would be part of the DTLS certificate\u003c/li\u003e\n\u003cli\u003eNotice that the \u003ccode\u003eSetRemoteDescription\u003c/code\u003e fingerprint in the \u003ccode\u003eabout:webrtc-internals\u003c/code\u003e page is \u003ccode\u003eC5:5F:DA:7D:84:47:B1:BF:6B:55:16:62:48:31:3E:D3:F1:7B:25:89:92:4A:4B:4D:4D:D9:D5:AF:EA:D8:15:44\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe old certificate can be obtained from the following commit where it was previously removed:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/meetecho/janus-gateway/commit/6f98f2dde644b3ead4a162c241dff9da1587ec13\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fcommit%2F6f98f2dde644b3ead4a162c241dff9da1587ec13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/meetecho/janus-gateway/commit/6f98f2dde644b3ead4a162c241dff9da1587ec13\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe certificate\u0026#39;s SHA256 checksum can be calculated using the OpenSSL command line tool as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eopenssl x509 -noout -fingerprint -sha256 -inform pem -in janus-cert1.crt \nSHA256 Fingerprint=C5:5F:DA:7D:84:47:B1:BF:6B:55:16:62:48:31:3E:D3:F1:7B:25:89:92:4A:4B:4D:4D:D9:D5:AF:EA:D8:15:44\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAttachments:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003edump-stun.pcapng\u003c/code\u003e: contains the data stream containing the TURN tunnelled DTLS exchange and SRTP stream that follows\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ejanus-cert1.crt\u003c/code\u003e and \u003ccode\u003ejanus-cert1.key\u003c/code\u003e are the certificate and key in use by Slack\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e2019-04-07_16-06-wireshark.png\u003c/code\u003e shows the certificate in the Wireshark dump\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e2019-04-07_16-13-fingerprint.png\u003c/code\u003e shows the SHA256 fingerprint which matches the public certificate and corresponding private key\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAn attacker would probably need to take the following steps to exploit this issue in the case of Slack:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eStart a man-in-the-middle attack using any known method (ARP cache poisoning, DNS cache poisoning, static routes on compromised network router etc)\u003c/li\u003e\n\u003cli\u003eActively hijack the Slack TURN servers between the victim and the Internet\u003c/li\u003e\n\u003cli\u003eWait for victim to make a Slack call\u003c/li\u003e\n\u003cli\u003eHandle STUN packets from victim to attacker-controlled TURN server; allow authentication with any password\u003c/li\u003e\n\u003cli\u003eStart DTLS exchange\u003c/li\u003e\n\u003cli\u003eWhen DTLS certificate is required, present victim with the Janus default certificate\u003c/li\u003e\n\u003cli\u003eThe attacker does \u003cstrong\u003eNOT\u003c/strong\u003e verify the victim\u0026#39;s DTLS certificate\u003c/li\u003e\n\u003cli\u003eThe SRTP Master Key is set over this DTLS connection\u003c/li\u003e\n\u003cli\u003eAttacker can now handle the SRTP stream between the victim and attacker\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"solutions-and-recommendations\"\u003eSolutions and recommendations\u003c/h3\u003e\n\n\u003cp\u003eIt is recommended to generate a new certificate and private key.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttackers positioned as man-in-the-middle may hijack the DTLS connection and set their own SRTP keys, handling the SRTP stream instead of Slack. This is still research in progress but it does not appear that attackers can perform a two-way MITM attack due to the mutual authentication required by the DTLS exchange. Therefore, it seems that this vulnerability can only be abused to hijack the SRTP stream between the WebRTC client and Slack but not the other way round.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":35,"name":"Use of Hard-coded Cryptographic Key"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":464389,"file_name":"janus-cert1.key","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/389/d33ecafb57f8569c6f20295f2bd8b9d84d599216/janus-cert1.key?response-content-disposition=attachment%3B%20filename%3D%22janus-cert1.key%22%3B%20filename%2A%3DUTF-8%27%27janus-cert1.key\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=bee3af829e9e98f4afd30353da8ae946278e51221d48f8f532bc23ce7c092aa2","file_size":493,"type":"text/plain"},{"id":464390,"file_name":"janus-cert1.crt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/390/db251066e5aea487b0021f9488c204548b27659c/janus-cert1.crt?response-content-disposition=attachment%3B%20filename%3D%22janus-cert1.crt%22%3B%20filename%2A%3DUTF-8%27%27janus-cert1.crt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=73f03785b5808f7a1e40692558c7cffb3d2d6b638c13e55ca42c9a0ced30f1f9","file_size":1139,"type":"text/plain"},{"id":464391,"file_name":"dump-stun.pcapng","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/391/2be4cd04b9db0cb57fe01399bdfc5308a33a3993/dump-stun.pcapng?response-content-disposition=attachment%3B%20filename%3D%22dump-stun.pcapng%22%3B%20filename%2A%3DUTF-8%27%27dump-stun.pcapng\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=63b0ee803ace42352b52caed61da1ef309290777d0c8638317fffd144592931f","file_size":44604,"type":"application/octet-stream"},{"id":464392,"file_name":"2019-04-07_16-13-fingerprint.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/392/0bbee157af8baf99b0bd846d165a704e44aad9ad/2019-04-07_16-13-fingerprint.png?response-content-disposition=attachment%3B%20filename%3D%222019-04-07_16-13-fingerprint.png%22%3B%20filename%2A%3DUTF-8%27%272019-04-07_16-13-fingerprint.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=424833eb98ebdbed7aec32f05d19fe94d8e92b9b91d47e07f5b7ac2083f3d3bf","file_size":342633,"type":"image/png"},{"id":464393,"file_name":"2019-04-07_16-06-wireshark.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/393/375e0043a31b4f50d38e7bd5f9eb12bf28deac0d/2019-04-07_16-06-wireshark.png?response-content-disposition=attachment%3B%20filename%3D%222019-04-07_16-06-wireshark.png%22%3B%20filename%2A%3DUTF-8%27%272019-04-07_16-06-wireshark.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=861b04fe13adccd4a66eef4675fae7d3288eabc29240a3f30e3f3f689e29f55d","file_size":939427,"type":"image/png"}],"allow_singular_disclosure_at":"2020-04-03T15:29:38.693Z","allow_singular_disclosure_after":-23294746.64764251,"singular_disclosure_allowed":true,"vote_count":165,"voters":["sandrogauci","a_d_a_m","spam404","base_64","prophet","renekroka","mygf","leonishan","passc0de","rayansec","and 155 more..."],"severity":{"rating":"high","score":8.7,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":15516,"asset_type":"URL","asset_identifier":"slack.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4509340,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @sandrogauci! We're looking into this and will update shortly!","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/sandrogauci\"\u003e@sandrogauci\u003c/a\u003e! We\u0026#39;re looking into this and will update shortly!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T16:38:39.066Z","updated_at":"2019-04-08T16:38:39.066Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509640,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Triaged!","markdown_message":"\u003cp\u003eTriaged!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T17:17:08.975Z","updated_at":"2019-04-08T17:17:08.975Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4516602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks!","markdown_message":"\u003cp\u003ethanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-09T08:17:47.916Z","updated_at":"2019-04-09T08:17:47.916Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4655050,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still working on this - thanks for your patience @sandrogauci!","markdown_message":"\u003cp\u003eStill working on this - thanks for your patience \u003ca href=\"/sandrogauci\"\u003e@sandrogauci\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-28T05:30:17.325Z","updated_at":"2019-04-28T05:30:17.325Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4655068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the update @maxfeldman ","markdown_message":"\u003cp\u003ethanks for the update \u003ca href=\"/maxfeldman\"\u003e@maxfeldman\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-28T05:49:35.413Z","updated_at":"2019-04-28T05:49:35.413Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4909963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Max, It's been a while. Are you still working on this?","markdown_message":"\u003cp\u003eHi Max, It\u0026#39;s been a while. Are you still working on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T13:24:19.462Z","updated_at":"2019-05-23T13:24:19.462Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sandrogauci,\n\nApologies for the delay - we've concluded the investigation and are updated - thank you very much for the report!\n\nMax","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sandrogauci\"\u003e@sandrogauci\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eApologies for the delay - we\u0026#39;ve concluded the investigation and are updated - thank you very much for the report!\u003c/p\u003e\n\n\u003cp\u003eMax\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:33:36.831Z","updated_at":"2019-05-23T14:33:36.831Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910619,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Resolved!","markdown_message":"\u003cp\u003eResolved!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:34:00.042Z","updated_at":"2019-05-23T14:34:00.042Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sandrogauci","url":"/sandrogauci"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910621,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report!\n\nThe Slack Security Team","markdown_message":"\u003cp\u003eThanks for the report!\u003c/p\u003e\n\n\u003cp\u003eThe Slack Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:34:28.072Z","updated_at":"2019-05-23T14:34:28.072Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"sandrogauci","url":"/sandrogauci"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910749,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to hear it. Thanks @maxfeldman ","markdown_message":"\u003cp\u003eGlad to hear it. Thanks \u003ca href=\"/maxfeldman\"\u003e@maxfeldman\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:41:46.663Z","updated_at":"2019-05-23T14:41:46.663Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6825058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @maxfeldman can you make this report public please?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/maxfeldman\"\u003e@maxfeldman\u003c/a\u003e can you make this report public please?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-21T11:19:51.544Z","updated_at":"2020-01-21T11:19:51.544Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6925922,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T04:00:29.586Z","updated_at":"2020-01-31T04:00:29.586Z","first_to_agree":true,"actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7149935,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Hey @sandrogauci,\n\nWe're going to temporarily cancel your disclosure request, as we are performing a review of high severity and above disclosures, and want give your report appropriate consideration before it becomes public. As soon as we complete our review, we will contact you about disclosure.\n\nWe apologize for the delay.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/sandrogauci\"\u003e@sandrogauci\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re going to temporarily cancel your disclosure request, as we are performing a review of high severity and above disclosures, and want give your report appropriate consideration before it becomes public. As soon as we complete our review, we will contact you about disclosure.\u003c/p\u003e\n\n\u003cp\u003eWe apologize for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-25T20:10:06.416Z","updated_at":"2020-02-25T20:10:06.416Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7171431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bugtriage-josh - that comes unexpectedly as we were under the impression that you successfully resolved this issue almost a year ago. We have an educational presentation to give at Kamailio World and were hoping to use this report as an example of our contribution to the WebRTC security space. We're not interested in making Slack look bad of course; only to have practical and real examples to the VoIP/WebRTC developers in the audience.\n\nCould you let me know when your review is planned to be complete so that we can prepare accordingly?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bugtriage-josh\"\u003e@bugtriage-josh\u003c/a\u003e - that comes unexpectedly as we were under the impression that you successfully resolved this issue almost a year ago. We have an educational presentation to give at Kamailio World and were hoping to use this report as an example of our contribution to the WebRTC security space. We\u0026#39;re not interested in making Slack look bad of course; only to have practical and real examples to the VoIP/WebRTC developers in the audience.\u003c/p\u003e\n\n\u003cp\u003eCould you let me know when your review is planned to be complete so that we can prepare accordingly?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-28T02:44:08.193Z","updated_at":"2020-02-28T02:44:08.193Z","actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7226258,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-04T15:29:38.655Z","updated_at":"2020-03-04T15:29:38.655Z","first_to_agree":true,"actor":{"username":"sandrogauci","cleared":false,"url":"/sandrogauci","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/642/2eb1cf49c0fa48f4e53a84213fda7eb95f10193e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7294444,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @sandrogauci\n\nWe should be good to go with disclosure now. Sorry about the delay and thank you for your patience.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/sandrogauci\"\u003e@sandrogauci\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe should be good to go with disclosure now. Sorry about the delay and thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-12T00:17:02.002Z","updated_at":"2020-03-12T00:17:02.002Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7294445,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-12T00:17:02.149Z","updated_at":"2020-03-12T00:17:02.149Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":20684,"category":"researcher","content":"DTLS certificate used for Slack WebRTC calls was previously included in the Janus (WebRTC server) together with the private key, thus considered public domain.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eDTLS certificate used for Slack WebRTC calls was previously included in the Janus (WebRTC server) together with the private key, thus considered public domain.\u003c/p\u003e\n"}]}