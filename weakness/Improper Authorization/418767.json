{"id":418767,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTg3Njc=","url":"https://hackerone.com/reports/418767","title":"Hacker can bypass 2FA requirement and reporter blacklist through embedded submission form","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-04T02:41:19.585Z","submitted_at":"2018-10-04T02:41:19.585Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"japz","url":"/japz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-31T17:24:15.211Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-10-25T23:13:54.418Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\n### Summary:\n\nA program owner can enforce the hackers to setup the two-factor authentication before submitting new reports to their program here: https://hackerone.com/parrot_sec/submission_requirements (see below image)\n\n{F355169}\n\nThe [Parrot Sec](https://hackerone.com/parrot_sec) program has this feature enabled to enforce the hackers to setup `2FA` before submitting reports. I removed my `2FA` to test and it is good that i was block from submitting new reports (see below image)\n\n{F355168}\n\n---\n\n### BYPASS 2FA Requirements using Embedded Submission:\n\nNow i was able to bypass this 2FA setup requirements by using the Parrot Sec program __Embedded Submission Form__.\n\n## Steps to reproduce:\n\n  1. Login to your account and __remove__ your 2FA on your account (if you already setup it)\n  2. Now go to https://hackerone.com/parrot_sec and hit `Submit Report` button, observed that you cannot submit report unless you will enable your 2FA.\n  3. __BYPASS:__ Get the `Embedded Submission` URL on their [policy page](https://hackerone.com/parrot_sec): i get this -\u003e\u003e https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\n  4. Now submit report using that embedded submission form and you can submit reports without setting-up your 2FA, despite the program __enforce__ the user to setup the 2FA before submitting new reports.\n  5. 2FA requirements successfully bypassed!\n\n## Impact\n\nBypassing the enabled protection/feature of the program.\n\nLet me know if anything else is needed.\n\nRegards\nJapz","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary:\u003c/h3\u003e\n\n\u003cp\u003eA program owner can enforce the hackers to setup the two-factor authentication before submitting new reports to their program here: \u003ca title=\"https://hackerone.com/parrot_sec/submission_requirements\" href=\"https://hackerone.com/parrot_sec/submission_requirements\"\u003ehttps://hackerone.com/parrot_sec/submission_requirements\u003c/a\u003e (see below image)\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"enable_2fa_requirements.JPG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/169/84f4669829e5d6eb997fc201eda7618951a1b399/enable_2fa_requirements.JPG?response-content-disposition=attachment%3B%20filename%3D%22enable_2fa_requirements.JPG%22%3B%20filename%2A%3DUTF-8%27%27enable_2fa_requirements.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e6a11ee638f482e461a6d26748beb7fbc058dc74596130aeea46f7aa3d5ce9f7\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/169/84f4669829e5d6eb997fc201eda7618951a1b399/enable_2fa_requirements.JPG?response-content-disposition=attachment%3B%20filename%3D%22enable_2fa_requirements.JPG%22%3B%20filename%2A%3DUTF-8%27%27enable_2fa_requirements.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e6a11ee638f482e461a6d26748beb7fbc058dc74596130aeea46f7aa3d5ce9f7\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ca href=\"https://hackerone.com/parrot_sec\"\u003eParrot Sec\u003c/a\u003e program has this feature enabled to enforce the hackers to setup \u003ccode\u003e2FA\u003c/code\u003e before submitting reports. I removed my \u003ccode\u003e2FA\u003c/code\u003e to test and it is good that i was block from submitting new reports (see below image)\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2fa_required.JPG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/168/151b4ad340fd65215299a21ab87dc0e7f734d307/2fa_required.JPG?response-content-disposition=attachment%3B%20filename%3D%222fa_required.JPG%22%3B%20filename%2A%3DUTF-8%27%272fa_required.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a059ff7e9d4b4bac932679ccbacf948b5a0979f83682ec6776f66fadfa7ba0bc\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/168/151b4ad340fd65215299a21ab87dc0e7f734d307/2fa_required.JPG?response-content-disposition=attachment%3B%20filename%3D%222fa_required.JPG%22%3B%20filename%2A%3DUTF-8%27%272fa_required.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a059ff7e9d4b4bac932679ccbacf948b5a0979f83682ec6776f66fadfa7ba0bc\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch3 id=\"bypass-2fa-requirements-using-embedded-submission\"\u003eBYPASS 2FA Requirements using Embedded Submission:\u003c/h3\u003e\n\n\u003cp\u003eNow i was able to bypass this 2FA setup requirements by using the Parrot Sec program \u003cstrong\u003eEmbedded Submission Form\u003c/strong\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to your account and \u003cstrong\u003eremove\u003c/strong\u003e your 2FA on your account (if you already setup it)\u003c/li\u003e\n\u003cli\u003eNow go to \u003ca title=\"https://hackerone.com/parrot_sec\" href=\"https://hackerone.com/parrot_sec\"\u003ehttps://hackerone.com/parrot_sec\u003c/a\u003e and hit \u003ccode\u003eSubmit Report\u003c/code\u003e button, observed that you cannot submit report unless you will enable your 2FA.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eBYPASS:\u003c/strong\u003e Get the \u003ccode\u003eEmbedded Submission\u003c/code\u003e URL on their \u003ca href=\"https://hackerone.com/parrot_sec\"\u003epolicy page\u003c/a\u003e: i get this -\u0026gt;\u0026gt; \u003ca title=\"https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\" href=\"https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\"\u003ehttps://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNow submit report using that embedded submission form and you can submit reports without setting-up your 2FA, despite the program \u003cstrong\u003eenforce\u003c/strong\u003e the user to setup the 2FA before submitting new reports.\u003c/li\u003e\n\u003cli\u003e2FA requirements successfully bypassed!\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBypassing the enabled protection/feature of the program.\u003c/p\u003e\n\n\u003cp\u003eLet me know if anything else is needed.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nJapz\u003c/p\u003e\n","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":124,"name":"Improper Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":355168,"file_name":"2fa_required.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/168/151b4ad340fd65215299a21ab87dc0e7f734d307/2fa_required.JPG?response-content-disposition=attachment%3B%20filename%3D%222fa_required.JPG%22%3B%20filename%2A%3DUTF-8%27%272fa_required.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055511Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=a059ff7e9d4b4bac932679ccbacf948b5a0979f83682ec6776f66fadfa7ba0bc","file_size":63901,"type":"image/jpeg"},{"id":355169,"file_name":"enable_2fa_requirements.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/169/84f4669829e5d6eb997fc201eda7618951a1b399/enable_2fa_requirements.JPG?response-content-disposition=attachment%3B%20filename%3D%22enable_2fa_requirements.JPG%22%3B%20filename%2A%3DUTF-8%27%27enable_2fa_requirements.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055511Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=e6a11ee638f482e461a6d26748beb7fbc058dc74596130aeea46f7aa3d5ce9f7","file_size":15454,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2018-11-24T23:13:54.524Z","allow_singular_disclosure_after":-66120076.9826995,"singular_disclosure_allowed":true,"vote_count":172,"voters":["mirchr","arneswinnen","sultancad","cache-money","kapytein","sigsegv_banana","muon4","bl4de","spam404","mik317","and 162 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3441622,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-05T19:33:12.282Z","updated_at":"2018-10-05T19:33:12.282Z","additional_data":{"old_severity":"Medium (6.1)","new_severity":"Medium (5.0)","old_severity_id":219456,"new_severity_id":220558},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3441624,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-05T19:34:26.649Z","updated_at":"2018-10-05T19:34:26.649Z","additional_data":{"old_title":"Bypass 2FA requirements for hackers before submitting new reports","new_title":"Hacker can bypass 2FA requirement and reporter blacklist through embedded submission form"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3441625,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-05T19:34:38.265Z","updated_at":"2018-10-05T19:34:38.265Z","additional_data":{"added_weaknesses":[{"id":124,"name":"Improper Authorization"}],"removed_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3441719,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @japz - thanks for bringing this to our attention, this is a great find!\n\nThe other report you filed (#419288) has the same root cause as this issue. To help you understand why, and for the sake of defaulting to disclosure, let me give you some insight into how this endpoint works. The endpoint that dispatches the request, `:uuid/embedded_submissions`, to create a report through an embedded form looks like this:\n\n```ruby\ndef execute\n  # ...\n  report = Interactors::Reports::Create.interact_without_authorization(\n    report_attributes.merge(as_user: current_user),\n  )\n  # ...\nend\n```\n\nWhen the `interact_without_authorization` method is used instead of `interact`, the ACL check is skipped. The ACL check for the `Interactors::Reports::Create` class looks like this:\n\n```ruby\ndef can_create_report?\n  return_false_if { !current_user }\n  return_false_if { current_user.reached_abuse_create_limit?(team: team) }\n  return_false_if { current_user.reached_team_signal_limit?(team: team, track_intent: true) }\n  return_false_if do\n    team.submission_requirements\u0026.mfa_required_at.present? \u0026\u0026\n      current_user.totp_supported? \u0026\u0026 current_user.totp_disabled?\n  end\n  can_create_draft?\nend\n\ndef can_create_draft?\n  # ...\n  return_false_if { team.blacklisted_reporters.include? current_user }\n  # ...\nend\n```\n\nAs you can see, this ACL check contains logic to make sure that the user isn't blacklisted and has 2FA enabled when the program requires it. We should've used `interact` instead of `interact_without_authorization`, which is why the fix (and root cause) of both of your reports is the same.\n\n**One more thing...**\n\nI also want to point out something else: when we did the root cause analysis of your report, we stumbled upon another security vulnerability. This security vulnerability has a higher severity than the issues you reported to us. Because you gave us a nudge in the right direction, we'll still go ahead and reward you for it. Here's the problem:\n\nAnonymous submissions are tracked through something we call a `tracer` identifier. This is a universally unique identifier (UUID) that we use to make sure you can't access other anonymous reporters' drafts and submissions. When any system submits a report through us, they submit a `draft_id`, which identifies the report draft for that particular report. It contains a copy of the title, vulnerability information, attachments, and more. Here's the code how we fetch report drafts in the `Interactors::Reports::Create` class:\n\n```ruby\ndef report_draft\n  if current_user\n    ReportDraft.find_by(id: draft_id, reporter: current_user, team: team)\n  else\n    ReportDraft.find_by(id: draft_id, tracer: tracer, team: team)\n  end\nend\n```\n\nIf the user is authenticated, we try and find the report draft based on the given `draft_id` and the owner of the report draft. In case the user isn't authenticated, we use the tracer and `draft_id`. When an authenticated user creates a report draft, the tracer is left blank (`nil`). When we create a report as an anonymous user, the request looks like this:\n\n```\nPOST /█████/embedded_submissions HTTP/1.1\nHost: localhost:8080\n...\n\n----------1446553971\nContent-Disposition: form-data; name=\"draft_id\"\n\n1\n----------1446553971\nContent-Disposition: form-data; name=\"tracer\"\n\n█████████\n----------1446553971\n...\n----------1446553971--\n```\n\nWhen you submit it as an authenticated user, the `tracer` isn't submitted because we identify the user based on the `current_user` object. This means that the `tracer` parameter is optional. The code also shows this:\n\n**Controller**\n```ruby\ndef create\n  # ...\n  report = Interactors::Reports::CreateEmbeddedSubmission.interact(\n    draft_id: report_params[:draft_id],\n    # ...\n    tracer: report_params[:tracer],\nend\n\n# ...\n\ndef report_params\n  params.require(:report)\n  report_params = params.permit(\n    # ...\n    tracer: Parameters.string,\n    draft_id: Parameters.id | Parameters.nil,\n    # ...\n    ),\n  )\n\n  report_params[:report].merge(\n    draft_id: report_params[:draft_id],\n    handle: report_params[:team_id],\n    tracer: report_params[:tracer],\n  )\nend\n```\n\nThis is where the problem arises: if an anonymous user removes the `tracer` parameter from the request, it'll fall back to a `nil` value. This means that the `report_draft` method (as shown earlier) will be executed with a tracer equal to the tracer that is used for authenticated users, resulting in an anonymous user being able to load report drafts from authenticated users who have drafts for the same program.\n\nWhen we create the report, we fetch the attachments from the report draft. When you're creating a draft, the attachments are attached to that object and so we need to move them to the new report object. The following code is then executed:\n\n```ruby\ndef valid_attachments\n  attachments.where(attachable: report_draft).or(attachments.where(attachable: nil))\nend\n```\n\nThe `attachments` method looks like this:\n\n```ruby\ndef attachments\n  return Attachment.none if attachment_ids.empty?\n\n  if current_user\n    Attachment.where(id: attachment_ids, uploaded_by: current_user)\n  elsif report_draft\n    Attachment.where(id: attachment_ids, attachable: report_draft)\n  else\n    fail(\n      'cannot safely get attachments without current user and without report_draft',\n    )\n  end\nend\n```\n\nThe vulnerability that is caused by this, is that an anonymous user can load a report draft from another user, which was authenticated when creating the draft. The attachments of that draft are then copied to the anonymous submission, thus allowing you to \"steal\" someone's attachments.\n\nThere are two caveats to this: you do not immediately get access to the attachments. Anonymous submissions can't be claimed right now. However, I'd think that if would follow up with the program or with our support channel, we'd allow you to claim the report after the fact, granting you access to the attachments you were not authorized to see. The other caveat is that this only applies to attachments of drafts created for the same program, the program needs to have an embedded submission form, and you need to have the embedded submission form's UUID. All in all, it would grant you access to someone else's attachments though, which is not good.\n\nThanks again for bringing this to our attention, this was a good find! We will escalate this to the team and will start working on a fix for both problems. Good luck and happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e - thanks for bringing this to our attention, this is a great find!\u003c/p\u003e\n\n\u003cp\u003eThe other report you filed (#419288) has the same root cause as this issue. To help you understand why, and for the sake of defaulting to disclosure, let me give you some insight into how this endpoint works. The endpoint that dispatches the request, \u003ccode\u003e:uuid/embedded_submissions\u003c/code\u003e, to create a report through an embedded form looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereport\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eInteractors\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eReports\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einteract_without_authorization\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ereport_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eas_user: \u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen the \u003ccode\u003einteract_without_authorization\u003c/code\u003e method is used instead of \u003ccode\u003einteract\u003c/code\u003e, the ACL check is skipped. The ACL check for the \u003ccode\u003eInteractors::Reports::Create\u003c/code\u003e class looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecan_create_report?\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereturn_false_if\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereturn_false_if\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ereached_abuse_create_limit?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eteam: \u003c/span\u003e\u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereturn_false_if\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ereached_team_signal_limit?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eteam: \u003c/span\u003e\u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etrack_intent: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereturn_false_if\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esubmission_requirements\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emfa_required_at\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epresent?\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotp_supported?\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotp_disabled?\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecan_create_draft?\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecan_create_draft?\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereturn_false_if\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eblacklisted_reporters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einclude?\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see, this ACL check contains logic to make sure that the user isn\u0026#39;t blacklisted and has 2FA enabled when the program requires it. We should\u0026#39;ve used \u003ccode\u003einteract\u003c/code\u003e instead of \u003ccode\u003einteract_without_authorization\u003c/code\u003e, which is why the fix (and root cause) of both of your reports is the same.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eOne more thing...\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI also want to point out something else: when we did the root cause analysis of your report, we stumbled upon another security vulnerability. This security vulnerability has a higher severity than the issues you reported to us. Because you gave us a nudge in the right direction, we\u0026#39;ll still go ahead and reward you for it. Here\u0026#39;s the problem:\u003c/p\u003e\n\n\u003cp\u003eAnonymous submissions are tracked through something we call a \u003ccode\u003etracer\u003c/code\u003e identifier. This is a universally unique identifier (UUID) that we use to make sure you can\u0026#39;t access other anonymous reporters\u0026#39; drafts and submissions. When any system submits a report through us, they submit a \u003ccode\u003edraft_id\u003c/code\u003e, which identifies the report draft for that particular report. It contains a copy of the title, vulnerability information, attachments, and more. Here\u0026#39;s the code how we fetch report drafts in the \u003ccode\u003eInteractors::Reports::Create\u003c/code\u003e class:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ereport_draft\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eReportDraft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind_by\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003edraft_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ereporter: \u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eteam: \u003c/span\u003e\u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eReportDraft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind_by\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003edraft_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etracer: \u003c/span\u003e\u003cspan class=\"n\"\u003etracer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eteam: \u003c/span\u003e\u003cspan class=\"n\"\u003eteam\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the user is authenticated, we try and find the report draft based on the given \u003ccode\u003edraft_id\u003c/code\u003e and the owner of the report draft. In case the user isn\u0026#39;t authenticated, we use the tracer and \u003ccode\u003edraft_id\u003c/code\u003e. When an authenticated user creates a report draft, the tracer is left blank (\u003ccode\u003enil\u003c/code\u003e). When we create a report as an anonymous user, the request looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /█████/embedded_submissions HTTP/1.1\nHost: localhost:8080\n...\n\n----------1446553971\nContent-Disposition: form-data; name=\u0026quot;draft_id\u0026quot;\n\n1\n----------1446553971\nContent-Disposition: form-data; name=\u0026quot;tracer\u0026quot;\n\n█████████\n----------1446553971\n...\n----------1446553971--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen you submit it as an authenticated user, the \u003ccode\u003etracer\u003c/code\u003e isn\u0026#39;t submitted because we identify the user based on the \u003ccode\u003ecurrent_user\u003c/code\u003e object. This means that the \u003ccode\u003etracer\u003c/code\u003e parameter is optional. The code also shows this:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eController\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereport\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eInteractors\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eReports\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eCreateEmbeddedSubmission\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einteract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003edraft_id: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:draft_id\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003etracer: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tracer\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ereport_params\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:report\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epermit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003etracer: \u003c/span\u003e\u003cspan class=\"no\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003edraft_id: \u003c/span\u003e\u003cspan class=\"no\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"no\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:report\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003edraft_id: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:draft_id\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003ehandle: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:team_id\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003etracer: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_params\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tracer\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is where the problem arises: if an anonymous user removes the \u003ccode\u003etracer\u003c/code\u003e parameter from the request, it\u0026#39;ll fall back to a \u003ccode\u003enil\u003c/code\u003e value. This means that the \u003ccode\u003ereport_draft\u003c/code\u003e method (as shown earlier) will be executed with a tracer equal to the tracer that is used for authenticated users, resulting in an anonymous user being able to load report drafts from authenticated users who have drafts for the same program.\u003c/p\u003e\n\n\u003cp\u003eWhen we create the report, we fetch the attachments from the report draft. When you\u0026#39;re creating a draft, the attachments are attached to that object and so we need to move them to the new report object. The following code is then executed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003evalid_attachments\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eattachments\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eattachable: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_draft\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattachments\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eattachable: \u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003eattachments\u003c/code\u003e method looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eattachments\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"no\"\u003eAttachment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enone\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eattachment_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eempty?\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eAttachment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003eattachment_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003euploaded_by: \u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eelsif\u003c/span\u003e \u003cspan class=\"n\"\u003ereport_draft\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eAttachment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003eattachment_ids\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eattachable: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_draft\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003efail\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"s1\"\u003e\u0026#39;cannot safely get attachments without current user and without report_draft\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe vulnerability that is caused by this, is that an anonymous user can load a report draft from another user, which was authenticated when creating the draft. The attachments of that draft are then copied to the anonymous submission, thus allowing you to \u0026quot;steal\u0026quot; someone\u0026#39;s attachments.\u003c/p\u003e\n\n\u003cp\u003eThere are two caveats to this: you do not immediately get access to the attachments. Anonymous submissions can\u0026#39;t be claimed right now. However, I\u0026#39;d think that if would follow up with the program or with our support channel, we\u0026#39;d allow you to claim the report after the fact, granting you access to the attachments you were not authorized to see. The other caveat is that this only applies to attachments of drafts created for the same program, the program needs to have an embedded submission form, and you need to have the embedded submission form\u0026#39;s UUID. All in all, it would grant you access to someone else\u0026#39;s attachments though, which is not good.\u003c/p\u003e\n\n\u003cp\u003eThanks again for bringing this to our attention, this was a good find! We will escalate this to the team and will start working on a fix for both problems. Good luck and happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T20:07:59.421Z","updated_at":"2018-10-25T23:12:08.705Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3441818,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @japz - pay day! This is a combined bounty for both findings: $2,500 for the report you submitted to us and $7,500 for the vulnerability that we discovered because of it. We determined the CVSS for the vulnerability we found to be 7.1 (High). Again, thanks a lot, this was a great find! We're still in the process of fixing the problems. We will also determine whether this was abused at any point in time. Thanks for your patience throughout the process!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e - pay day! This is a combined bounty for both findings: $2,500 for the report you submitted to us and $7,500 for the vulnerability that we discovered because of it. We determined the CVSS for the vulnerability we found to be 7.1 (High). Again, thanks a lot, this was a great find! We\u0026#39;re still in the process of fixing the problems. We will also determine whether this was abused at any point in time. Thanks for your patience throughout the process!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T20:53:21.298Z","updated_at":"2018-10-05T20:53:21.298Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"10000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"japz","url":"/japz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3442221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @japz - about an hour ago we released a fix for the security vulnerability that we found ourselves. We're still in the process of getting a fix out for your initial report. We'll keep working to get this to get this fully resolved.\n\nRegarding my earlier comment:\n\n\u003e you do not immediately get access to the attachments. Anonymous submissions can't be claimed right now. \n\nThis turns out to be false. A user has the ability to provide their email address when they make an anonymous submission. This will send them an invitation to claim the report. When they do so, they'll immediately gain access to the attachment.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e - about an hour ago we released a fix for the security vulnerability that we found ourselves. We\u0026#39;re still in the process of getting a fix out for your initial report. We\u0026#39;ll keep working to get this to get this fully resolved.\u003c/p\u003e\n\n\u003cp\u003eRegarding my earlier comment:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eyou do not immediately get access to the attachments. Anonymous submissions can\u0026#39;t be claimed right now. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis turns out to be false. A user has the ability to provide their email address when they make an anonymous submission. This will send them an invitation to claim the report. When they do so, they\u0026#39;ll immediately gain access to the attachment.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-06T00:38:15.315Z","updated_at":"2018-10-06T00:40:40.013Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3442508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert ,\n\nGood day, I woke up just now :) ..sorry for the late response.\n\n\u003e\u003eThe other report you filed (#419288) has the same root cause as this issue.\n\nI see.. because of `interact_without_authorization` (for anonymous) all the validations was skipped.\n\n\u003e\u003eI also want to point out something else: when we did the root cause analysis of your report, we stumbled upon another security vulnerability. This security vulnerability has a higher severity than the issues you reported to us. Because you gave us a nudge in the right direction, we'll still go ahead and reward you for it.\n\nFirst, thank you for the very detailed explanation about the relationship of the bug that i've submitted and the other bug you found because of my submission. I've read everything and try to understand from to bottom of your comments. From what i understand, the other high severity bug you found while you guys doing the Root Cause Analysis (RCA) is the attacker can steal sensitive report details such as `Attachments` if attacker manipulates the __anonymous__ submission request and removed the `tracer` param from the request because it will load the drafts reports from authenticated users whos doing embedded submission drafts in the same program.\n\nI'm glad i was able to help and put the team in the right direction that will eliminates the other high severity issue.\n\n\u003eRegarding my earlier comment:\n\n \u003e\u003eyou do not immediately get access to the attachments. Anonymous submissions can't be claimed right now.\n\n\u003eThis turns out to be false. A user has the ability to provide their email address when they make an anonymous submission. This will send them an invitation to claim the report. When they do so, they'll immediately gain access to the attachment.\n\nYes that's correct, i tested the `authenticated` and `anonymous` submission before i submitted my report, and the anonymous submission will let you claim the report by sending an invite to accept the report if your provided email address in the form have an existing account on HackerOne  :)\n\n\u003e\u003eThanks again for bringing this to our attention, this was a good find! We will escalate this to the team and will start working on a fix for both problems. Good luck and happy hacking!\n\nIt's my pleasure working with you guys as always :)\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eGood day, I woke up just now :) ..sorry for the late response.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe other report you filed (#419288) has the same root cause as this issue.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI see.. because of \u003ccode\u003einteract_without_authorization\u003c/code\u003e (for anonymous) all the validations was skipped.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI also want to point out something else: when we did the root cause analysis of your report, we stumbled upon another security vulnerability. This security vulnerability has a higher severity than the issues you reported to us. Because you gave us a nudge in the right direction, we\u0026#39;ll still go ahead and reward you for it.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eFirst, thank you for the very detailed explanation about the relationship of the bug that i\u0026#39;ve submitted and the other bug you found because of my submission. I\u0026#39;ve read everything and try to understand from to bottom of your comments. From what i understand, the other high severity bug you found while you guys doing the Root Cause Analysis (RCA) is the attacker can steal sensitive report details such as \u003ccode\u003eAttachments\u003c/code\u003e if attacker manipulates the \u003cstrong\u003eanonymous\u003c/strong\u003e submission request and removed the \u003ccode\u003etracer\u003c/code\u003e param from the request because it will load the drafts reports from authenticated users whos doing embedded submission drafts in the same program.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m glad i was able to help and put the team in the right direction that will eliminates the other high severity issue.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eRegarding my earlier comment:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eyou do not immediately get access to the attachments. Anonymous submissions can\u0026#39;t be claimed right now.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis turns out to be false. A user has the ability to provide their email address when they make an anonymous submission. This will send them an invitation to claim the report. When they do so, they\u0026#39;ll immediately gain access to the attachment.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes that\u0026#39;s correct, i tested the \u003ccode\u003eauthenticated\u003c/code\u003e and \u003ccode\u003eanonymous\u003c/code\u003e submission before i submitted my report, and the anonymous submission will let you claim the report by sending an invite to accept the report if your provided email address in the form have an existing account on HackerOne  :)\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThanks again for bringing this to our attention, this was a good find! We will escalate this to the team and will start working on a fix for both problems. Good luck and happy hacking!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIt\u0026#39;s my pleasure working with you guys as always :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-06T05:05:34.408Z","updated_at":"2018-10-06T05:10:20.865Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3442517,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HI @jobert \n\n\u003eabout an hour ago we released a fix for the security vulnerability that we found ourselves. \n\nI'll probably take a look at this one after both issues was fully resolved :)\n\nWe're still in the process of getting a fix out for your initial report. We'll keep working to get this to get this fully resolved.\n\nSounds good, just ping me if there is anything i can help with, I'd love to help.\n\n\u003epay day!\n\nThanks for the bounty :) so much appreciated.. you guys are awesome! :)\n\nCheers!\nJapz","markdown_message":"\u003cp\u003eHI \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eabout an hour ago we released a fix for the security vulnerability that we found ourselves. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI\u0026#39;ll probably take a look at this one after both issues was fully resolved :)\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re still in the process of getting a fix out for your initial report. We\u0026#39;ll keep working to get this to get this fully resolved.\u003c/p\u003e\n\n\u003cp\u003eSounds good, just ping me if there is anything i can help with, I\u0026#39;d love to help.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003epay day!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThanks for the bounty :) so much appreciated.. you guys are awesome! :)\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003cbr\u003e\nJapz\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-06T05:16:45.100Z","updated_at":"2018-10-06T05:16:45.100Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3458129,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-09T23:37:54.427Z","updated_at":"2018-10-09T23:37:54.427Z","additional_data":{"duplicate_report_id":420518},"actor":{"username":"0xspade","cleared":true,"url":"/0xspade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zrdN5btoaSqZpZF81Z68c3Q7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3523281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert ,\n\nTomorrow (Oct 25 here in PH) is the birthday of my youngest brother @reymark_divino :) , He is also an active researcher in HackerOne.\n\nSince I've submitted 3-4 (2dups) valid bugs in the main platform this month, I would like to ask if this submission of mine is somehow eligible for h1 hoodie ? , I'd like to give a hoodie as a birthday gift for my youngest brother if possible, because he really like it so much. :)\n\nLet me know.\n\nKind Regards\nJapz ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eTomorrow (Oct 25 here in PH) is the birthday of my youngest brother \u003ca href=\"/reymark_divino\"\u003e@reymark_divino\u003c/a\u003e :) , He is also an active researcher in HackerOne.\u003c/p\u003e\n\n\u003cp\u003eSince I\u0026#39;ve submitted 3-4 (2dups) valid bugs in the main platform this month, I would like to ask if this submission of mine is somehow eligible for h1 hoodie ? , I\u0026#39;d like to give a hoodie as a birthday gift for my youngest brother if possible, because he really like it so much. :)\u003c/p\u003e\n\n\u003cp\u003eLet me know.\u003c/p\u003e\n\n\u003cp\u003eKind Regards\u003cbr\u003e\nJapz \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-24T02:15:27.738Z","updated_at":"2018-10-24T02:21:37.264Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3535945,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @japz - thanks again for bringing this to our attention! We've now also deployed a fix for the security vulnerability that you initially reported to us. Anyone can still submit a report through an embedded submission form, but you won't be able to claim the report, unless you're able to report to that program in the first place. This means that claiming will only work when your account:\n\n - meets the 2FA requirement\n - isn't rate limited\n - meets the signal requirement\n - has access to the program\n - isn't banned from the program\n\nThanks again for the report, it's much appreciated. We look forward to future reports from you. Good luck and happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e - thanks again for bringing this to our attention! We\u0026#39;ve now also deployed a fix for the security vulnerability that you initially reported to us. Anyone can still submit a report through an embedded submission form, but you won\u0026#39;t be able to claim the report, unless you\u0026#39;re able to report to that program in the first place. This means that claiming will only work when your account:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003emeets the 2FA requirement\u003c/li\u003e\n\u003cli\u003eisn\u0026#39;t rate limited\u003c/li\u003e\n\u003cli\u003emeets the signal requirement\u003c/li\u003e\n\u003cli\u003ehas access to the program\u003c/li\u003e\n\u003cli\u003eisn\u0026#39;t banned from the program\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks again for the report, it\u0026#39;s much appreciated. We look forward to future reports from you. Good luck and happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-25T23:11:03.262Z","updated_at":"2018-10-25T23:11:03.262Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"japz","url":"/japz"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3535951,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-25T23:13:54.464Z","updated_at":"2018-10-25T23:13:54.464Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3536285,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2018-10-26T01:29:38.677Z","updated_at":"2018-10-26T01:29:38.677Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"r3y","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3536288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert - You ignore my last comment :(\n\nSorry little bro @reymark_divino no surprise h1 hoodie for you :( , but no worries we'll get that hoodie once we find another valid bug on h1 platform.. Happy birthday!.. keep hacking and keep up the good work. ^.^ I love you :-*","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e - You ignore my last comment :(\u003c/p\u003e\n\n\u003cp\u003eSorry little bro \u003ca href=\"/reymark_divino\"\u003e@reymark_divino\u003c/a\u003e no surprise h1 hoodie for you :( , but no worries we\u0026#39;ll get that hoodie once we find another valid bug on h1 platform.. Happy birthday!.. keep hacking and keep up the good work. ^.^ I love you :-*\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-26T01:35:17.430Z","updated_at":"2018-10-26T01:35:17.430Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3536749,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\ni still can reproduce my report #420518 it seems that you only fixed if a user is logged in while if a Unauthenticated User is flood with Anonymous Report still it can spam the Program with embedded submission.\n{F366265}\ni just submitted 100 request.\nwill post the Steps to Reproduce on my original submission.\n\nThanks,","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003ei still can reproduce my report \u003ca href=\"/reports/420518\"\u003e#420518\u003c/a\u003e it seems that you only fixed if a user is logged in while if a Unauthenticated User is flood with Anonymous Report still it can spam the Program with embedded submission.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Capture.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/366/265/6d7d2497009ca8f216a7252e011af563de3b190a/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=373d1552e9b3554269b41cabe00af059e2d35fe723e571fbad19a77df4e7c6d7\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/366/265/6d7d2497009ca8f216a7252e011af563de3b190a/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055511Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=373d1552e9b3554269b41cabe00af059e2d35fe723e571fbad19a77df4e7c6d7\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\ni just submitted 100 request.\u003cbr\u003e\nwill post the Steps to Reproduce on my original submission.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-26T03:13:02.587Z","updated_at":"2018-10-26T03:13:02.587Z","actor":{"username":"0xspade","cleared":true,"url":"/0xspade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zrdN5btoaSqZpZF81Z68c3Q7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":366265,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/366/265/6d7d2497009ca8f216a7252e011af563de3b190a/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055511Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=373d1552e9b3554269b41cabe00af059e2d35fe723e571fbad19a77df4e7c6d7"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3541455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mga_bobo - thanks for letting us know. To clarify: we do not proactively block people from submitting a report anonymously. We leverage a rate limiter that is higher than the per-user rate limit. You'll notice that you won't be able to claim more reports than your account is allowed to submit to a program. Before the fix for this report was in place, it was possible to claim as many reports as you wanted, completely bypassing the abuse and rate limit for a single user. Let me know if you believe I missed something. Good luck and happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mga_bobo\"\u003e@mga_bobo\u003c/a\u003e - thanks for letting us know. To clarify: we do not proactively block people from submitting a report anonymously. We leverage a rate limiter that is higher than the per-user rate limit. You\u0026#39;ll notice that you won\u0026#39;t be able to claim more reports than your account is allowed to submit to a program. Before the fix for this report was in place, it was possible to claim as many reports as you wanted, completely bypassing the abuse and rate limit for a single user. Let me know if you believe I missed something. Good luck and happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-27T00:15:43.149Z","updated_at":"2018-10-27T00:15:43.149Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3541467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree, but in some cases. I believe that you cannot track hackers behind on the report spams. Unless they are logged in.for example in this xxx program i have a lots of N/A and Informatives and i noticed that they have enabled their embedded submission. All i need to do is to logout and spam their program. Maybe just a suggestion. You need to have a rate limit atleast 10 to 20 request. Just like the login feature i guess.","markdown_message":"\u003cp\u003eI agree, but in some cases. I believe that you cannot track hackers behind on the report spams. Unless they are logged in.for example in this xxx program i have a lots of N/A and Informatives and i noticed that they have enabled their embedded submission. All i need to do is to logout and spam their program. Maybe just a suggestion. You need to have a rate limit atleast 10 to 20 request. Just like the login feature i guess.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-27T00:24:03.713Z","updated_at":"2018-10-27T00:24:03.713Z","actor":{"username":"0xspade","cleared":true,"url":"/0xspade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zrdN5btoaSqZpZF81Z68c3Q7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3541472,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mga_bobo - you're right, but that's the solution we're going with right now. The problem we were more concerned with was the authenticated users for the time being. We may implement more measures to restrict a huge number of submissions down the road as an anonymous user. For now, we'll deal with it manually in case it happens. Thanks again for your diligence, it's much appreciated.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mga_bobo\"\u003e@mga_bobo\u003c/a\u003e - you\u0026#39;re right, but that\u0026#39;s the solution we\u0026#39;re going with right now. The problem we were more concerned with was the authenticated users for the time being. We may implement more measures to restrict a huge number of submissions down the road as an anonymous user. For now, we\u0026#39;ll deal with it manually in case it happens. Thanks again for your diligence, it\u0026#39;s much appreciated.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-27T00:29:40.273Z","updated_at":"2018-10-27T00:29:40.273Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3541505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can easily track users with the mitigation you placed, i believe.I cant bypass your mitigation if im logged in while if not and as a anonymous user. Yes i can spam it. Haha. I hope you noticed japz reply btw. Just for his lil bro. And also i hope that once my issue is fixed. You'll give me something good, eventually.","markdown_message":"\u003cp\u003eYou can easily track users with the mitigation you placed, i believe.I cant bypass your mitigation if im logged in while if not and as a anonymous user. Yes i can spam it. Haha. I hope you noticed japz reply btw. Just for his lil bro. And also i hope that once my issue is fixed. You\u0026#39;ll give me something good, eventually.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-27T00:43:35.469Z","updated_at":"2018-10-27T00:43:35.469Z","actor":{"username":"0xspade","cleared":true,"url":"/0xspade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zrdN5btoaSqZpZF81Z68c3Q7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3546341,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-28T17:31:35.189Z","updated_at":"2018-10-28T17:31:35.189Z","actor":{"username":"r3y","cleared":true,"url":"/r3y","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/158/384/32dc4d4d9cb28c5e7e2a7ba29c3151a7c0fdce0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3565402,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"This can be disclosed now that @japz posted his blog post: https://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5. Thanks again @japz, this was great!\n\nPS I awarded your brother swag for another report, thanks for the heads up :)","markdown_message":"\u003cp\u003eThis can be disclosed now that \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e posted his blog post: \u003ca title=\"https://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fjapzdivino%2Fbypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Thanks again \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e, this was great!\u003c/p\u003e\n\n\u003cp\u003ePS I awarded your brother swag for another report, thanks for the heads up :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T17:24:14.709Z","updated_at":"2018-10-31T17:24:14.709Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3569697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003ePS I awarded your brother swag for another report, thanks for the heads up :)\n\nI've talk to him and i saw on his hacktivity timeline that you awarded a swag.. he's so much happy for that birthday gift. Thanks @jobert, so much appreciated! :)\n\nCheers!\nJapz","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003ePS I awarded your brother swag for another report, thanks for the heads up :)\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI\u0026#39;ve talk to him and i saw on his hacktivity timeline that you awarded a swag.. he\u0026#39;s so much happy for that birthday gift. Thanks \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e, so much appreciated! :)\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003cbr\u003e\nJapz\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-01T13:27:27.520Z","updated_at":"2018-11-01T13:27:27.520Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11382,"category":"team","content":"The hacker submitted a vulnerability to us that allowed any user to bypass multiple program restrictions, such as the 2FA requirement, report rate limit, and internal abuse limits. The severity for this vulnerability was set to medium (CVSS 5.0). This vulnerability was awarded $2,500.\n\nWhen we looked into the root cause of the vulnerability, we stumbled upon another vulnerability, which had a higher CVSS score (7.1). The second vulnerability that we identified allowed an attacker to gain access to other users' attachments who were writing a report at the same time. Because we identified this vulnerability due to @japz' report, we decided to award him an additional $7,500. The report itself contains an in-depth explanation of where the vulnerability originated from.\n\nWe determined that neither of the vulnerabilities have been abused.\n\nHere's a link to @japz's own blog post about the vulnerability: https://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5.\n\nWe'd like to thank @japz and @mga_bobo for bringing this to our attention, this was a great find!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe hacker submitted a vulnerability to us that allowed any user to bypass multiple program restrictions, such as the 2FA requirement, report rate limit, and internal abuse limits. The severity for this vulnerability was set to medium (CVSS 5.0). This vulnerability was awarded $2,500.\u003c/p\u003e\n\n\u003cp\u003eWhen we looked into the root cause of the vulnerability, we stumbled upon another vulnerability, which had a higher CVSS score (7.1). The second vulnerability that we identified allowed an attacker to gain access to other users\u0026#39; attachments who were writing a report at the same time. Because we identified this vulnerability due to \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e\u0026#39; report, we decided to award him an additional $7,500. The report itself contains an in-depth explanation of where the vulnerability originated from.\u003c/p\u003e\n\n\u003cp\u003eWe determined that neither of the vulnerabilities have been abused.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s a link to \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e\u0026#39;s own blog post about the vulnerability: \u003ca title=\"https://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fjapzdivino%2Fbypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/japzdivino/bypass-hackerone-2fa-requirement-and-reporter-blacklist-46d7959f1ee5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to thank \u003ca href=\"/japz\"\u003e@japz\u003c/a\u003e and \u003ca href=\"/mga_bobo\"\u003e@mga_bobo\u003c/a\u003e for bringing this to our attention, this was a great find!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}