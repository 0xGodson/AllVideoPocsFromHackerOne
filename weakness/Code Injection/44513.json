{"id":44513,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDUxMw==","url":"https://hackerone.com/reports/44513","title":"RCE due to Web Console IP Whitelist bypass in Rails 4.0 and 4.1","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-21T12:51:04.867Z","submitted_at":"2015-01-21T12:51:04.867Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"joernchen","url":"/joernchen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-06-16T19:21:46.422Z","bug_reporter_agreed_on_going_public_at":"2015-06-16T19:21:46.137Z","team_member_agreed_on_going_public_at":"2015-06-16T19:16:20.595Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"With the release of Ruby on Rails 4.2 the so called [Web Console](https://github.com/rails/web-console) was introduced. \r\n\r\nAs the Web Console documentation states:\r\n*Web Console is built explicitly for Rails 4.*\r\n\r\nBy default the Web Console is available in the Rails Development Environment and allows only the IPs `127.0.0.1` and `::1` to access the console in order to evaluate arbitrary Ruby statements for the purpose of debugging.\r\n\r\nHowever with Rails Versions 4.1 and 4.0 the Web Console built in IP whitelist is bypassable.\r\nThis is due to the fact that Web Console parses the `request.remote_ip` to check if the IP is whitelisted with the Ruby class `IPAddr`. The Rails stack prior to 4.2 when calculating `request.remote_ip` uses [these regular expressions](https://github.com/rails/rails/blob/4-1-stable/actionpack/lib/action_dispatch/middleware/remote_ip.rb#L31-38) to strip out trusted Proxies from the HTTP Headers `X-Forwarded-For` and `Client-IP`.\r\n\r\nDue to this parser differential an attacker might bypass the Web Console IP whitelist by supplying a HTTP header value of:\r\n\r\n`X-Forwarded-For: 0000::1` \r\n\r\nThis IPv6 address in the given notation would bypass the `TRUSTED_PROXIES` entry `^::1$` but match the `IPAddr` value of `::1` within Web Console.\r\n\r\nAs the Web Console is *intended* for debugging in the Development Environment this will most likely not affect Production setups, unless Web Console is explicitly enabled. But gaining RCE on Developer laptops might be fun as well ;).\r\n\r\nI've already sent a description of this to the Rails Security Team via mail, but I've been asked to submit here again. \r\n\r\nThe easiest mitigation of this issue would be to disallow execution of Web Console within Rails \u003c 4.2.","vulnerability_information_html":"\u003cp\u003eWith the release of Ruby on Rails 4.2 the so called \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Fweb-console\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWeb Console\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was introduced. \u003c/p\u003e\n\n\u003cp\u003eAs the Web Console documentation states:\u003cbr\u003e\n\u003cem\u003eWeb Console is built explicitly for Rails 4.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eBy default the Web Console is available in the Rails Development Environment and allows only the IPs \u003ccode\u003e127.0.0.1\u003c/code\u003e and \u003ccode\u003e::1\u003c/code\u003e to access the console in order to evaluate arbitrary Ruby statements for the purpose of debugging.\u003c/p\u003e\n\n\u003cp\u003eHowever with Rails Versions 4.1 and 4.0 the Web Console built in IP whitelist is bypassable.\u003cbr\u003e\nThis is due to the fact that Web Console parses the \u003ccode\u003erequest.remote_ip\u003c/code\u003e to check if the IP is whitelisted with the Ruby class \u003ccode\u003eIPAddr\u003c/code\u003e. The Rails stack prior to 4.2 when calculating \u003ccode\u003erequest.remote_ip\u003c/code\u003e uses \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fblob%2F4-1-stable%2Factionpack%2Flib%2Faction_dispatch%2Fmiddleware%2Fremote_ip.rb%23L31-38\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethese regular expressions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to strip out trusted Proxies from the HTTP Headers \u003ccode\u003eX-Forwarded-For\u003c/code\u003e and \u003ccode\u003eClient-IP\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eDue to this parser differential an attacker might bypass the Web Console IP whitelist by supplying a HTTP header value of:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eX-Forwarded-For: 0000::1\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eThis IPv6 address in the given notation would bypass the \u003ccode\u003eTRUSTED_PROXIES\u003c/code\u003e entry \u003ccode\u003e^::1$\u003c/code\u003e but match the \u003ccode\u003eIPAddr\u003c/code\u003e value of \u003ccode\u003e::1\u003c/code\u003e within Web Console.\u003c/p\u003e\n\n\u003cp\u003eAs the Web Console is \u003cem\u003eintended\u003c/em\u003e for debugging in the Development Environment this will most likely not affect Production setups, unless Web Console is explicitly enabled. But gaining RCE on Developer laptops might be fun as well ;).\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve already sent a description of this to the Rails Security Team via mail, but I\u0026#39;ve been asked to submit here again. \u003c/p\u003e\n\n\u003cp\u003eThe easiest mitigation of this issue would be to disallow execution of Web Console within Rails \u0026lt; 4.2.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-16T19:16:20.836Z","allow_singular_disclosure_after":-172147363.08179703,"singular_disclosure_allowed":true,"vote_count":8,"voters":["sw33tlie","dee-see","an0nym0us","exception","japz","cryptographer","lxth0rz","nebelschwaden"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":315285,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi There,\n\nThanks for submitting this via email, I can confirm we've received it and will be in touch in the next 24 hours or so with an eta","markdown_message":"\u003cp\u003eHi There,\u003c/p\u003e\n\n\u003cp\u003eThanks for submitting this via email, I can confirm we\u0026#39;ve received it and will be in touch in the next 24 hours or so with an eta\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-21T21:03:28.035Z","updated_at":"2015-01-21T21:03:28.035Z","actor":{"username":"nzkoz","cleared":false,"url":"/nzkoz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/317/11e8edc22329e340906e362e4f8d431cd6797787_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems like 24 hours was a bit too optimistic ;).\n\nCan I get a short heads up?\n\nThx!","markdown_message":"\u003cp\u003eSeems like 24 hours was a bit too optimistic ;).\u003c/p\u003e\n\n\u003cp\u003eCan I get a short heads up?\u003c/p\u003e\n\n\u003cp\u003eThx!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-28T17:57:05.629Z","updated_at":"2015-01-28T17:57:05.629Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328348,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@joernchen we are still discussing the better way to fix this issue. Meanwhile I'll prepare the advisory and will post here to review.","markdown_message":"\u003cp\u003e\u003ca href=\"/joernchen\"\u003e@joernchen\u003c/a\u003e we are still discussing the better way to fix this issue. Meanwhile I\u0026#39;ll prepare the advisory and will post here to review.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-09T14:59:14.908Z","updated_at":"2015-02-09T14:59:14.908Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":328359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Regarding fixing this: the most clean way IMHO would be to backport the use of ``IPAddr`` in ``remote_ip`` to 4.0 and 4.1","markdown_message":"\u003cp\u003eRegarding fixing this: the most clean way IMHO would be to backport the use of \u003ccode\u003eIPAddr\u003c/code\u003e in \u003ccode\u003eremote_ip\u003c/code\u003e to 4.0 and 4.1\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-09T15:16:43.863Z","updated_at":"2015-02-09T15:16:43.863Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339216,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@joernchen we were discussing the possibility of just not supporting web console on Rails versions \u003c 4.2.  Backporting that commit seems fine, but just saying \"we don't support this\" sounds like less of a maintenance / security burden on us.\n\nOf course saying \"we don't support this\" means we'll do a security release that specifically raised an exception for people trying to use web console in older versions of Rails.  What do you think?\n\n@rafaelfranca: is what I'm saying accurate?","markdown_message":"\u003cp\u003e\u003ca href=\"/joernchen\"\u003e@joernchen\u003c/a\u003e we were discussing the possibility of just not supporting web console on Rails versions \u0026lt; 4.2.  Backporting that commit seems fine, but just saying \u0026quot;we don\u0026#39;t support this\u0026quot; sounds like less of a maintenance / security burden on us.\u003c/p\u003e\n\n\u003cp\u003eOf course saying \u0026quot;we don\u0026#39;t support this\u0026quot; means we\u0026#39;ll do a security release that specifically raised an exception for people trying to use web console in older versions of Rails.  What do you think?\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/rafaelfranca\"\u003e@rafaelfranca\u003c/a\u003e: is what I\u0026#39;m saying accurate?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-24T16:35:51.241Z","updated_at":"2015-02-24T16:35:51.241Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":339219,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes.","markdown_message":"\u003cp\u003eYes.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-24T16:42:46.388Z","updated_at":"2015-02-24T16:42:46.388Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":339234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds like a pretty valid option to me!","markdown_message":"\u003cp\u003eSounds like a pretty valid option to me!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-24T17:04:26.929Z","updated_at":"2015-02-24T17:04:26.929Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":359908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\ncould I get a short heads up on the state of fixing this?","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003ecould I get a short heads up on the state of fixing this?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-21T09:03:02.172Z","updated_at":"2015-03-21T09:03:02.172Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":377022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nactually it's pretty sad to see this issue still pending. \nThe proposed fix should be implementable easily. So could I get a rough ETA for a fix?\n\nThx,\n\njoernchen\n\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eactually it\u0026#39;s pretty sad to see this issue still pending. \u003cbr\u003e\nThe proposed fix should be implementable easily. So could I get a rough ETA for a fix?\u003c/p\u003e\n\n\u003cp\u003eThx,\u003c/p\u003e\n\n\u003cp\u003ejoernchen\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-10T10:30:26.194Z","updated_at":"2015-04-10T10:30:26.194Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":378142,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @joernchen,\n\nSad indeed. I told Rafael I'd deal with this, and have then allowed it to stagnate. :(\n\nI'm currently looking into whether we can elegantly-enough make it safe after all, from the web-console side.\n\nI'll get back to you, by Wednesday at the latest, with either a new proposed fix, or an ETA on releasing the version check.\n\nThank you very much for your patience.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/joernchen\"\u003e@joernchen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSad indeed. I told Rafael I\u0026#39;d deal with this, and have then allowed it to stagnate. :(\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m currently looking into whether we can elegantly-enough make it safe after all, from the web-console side.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll get back to you, by Wednesday at the latest, with either a new proposed fix, or an ETA on releasing the version check.\u003c/p\u003e\n\n\u003cp\u003eThank you very much for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-11T23:21:23.618Z","updated_at":"2015-04-11T23:21:23.618Z","actor":{"username":"matthewd","cleared":false,"url":"/matthewd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/558/5df350e99e2e86f74de4e3bf90de8880ac877b25_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":".. and it's Thursday. But, I come bearing a patch.\n\nWhat do you think of this solution?\n\nNote that the added tests show a similar (separately reported) issue that affects 4.2 as well -- so we need to go beyond refusing older versions.","markdown_message":"\u003cp\u003e.. and it\u0026#39;s Thursday. But, I come bearing a patch.\u003c/p\u003e\n\n\u003cp\u003eWhat do you think of this solution?\u003c/p\u003e\n\n\u003cp\u003eNote that the added tests show a similar (separately reported) issue that affects 4.2 as well -- so we need to go beyond refusing older versions.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T17:18:15.421Z","updated_at":"2015-04-16T17:18:15.421Z","actor":{"username":"matthewd","cleared":false,"url":"/matthewd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/558/5df350e99e2e86f74de4e3bf90de8880ac877b25_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":35103,"filename":"web-console-whitelist.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/035/103/b46f5c668530b8057f30f80ac7fc3abcecdfa22d/web-console-whitelist.patch?response-content-disposition=attachment%3B%20filename%3D%22web-console-whitelist.patch%22%3B%20filename%2A%3DUTF-8%27%27web-console-whitelist.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055904Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=d845f4cb4d50611401d8a522834c0eb8e79fac00d579f0f9fadf75e9ec01b9c9"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will validate the patch tomorrow. I don't see any tests covering the reported case.","markdown_message":"\u003cp\u003eWill validate the patch tomorrow. I don\u0026#39;t see any tests covering the reported case.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T18:44:06.640Z","updated_at":"2015-04-16T18:44:06.640Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":383037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, I've had a look at 4.1's ActionDispatch::RemoteIp::GetIp, and to me it looks like that patch is not sufficient. This is due to the fact that GetIp in 4.1 operates with the said Regexes and the WebConsole whitelist uses IPAddr. But to be 100% sure I'll setup a little testenv to verify my assumption.","markdown_message":"\u003cp\u003eSo, I\u0026#39;ve had a look at 4.1\u0026#39;s ActionDispatch::RemoteIp::GetIp, and to me it looks like that patch is not sufficient. This is due to the fact that GetIp in 4.1 operates with the said Regexes and the WebConsole whitelist uses IPAddr. But to be 100% sure I\u0026#39;ll setup a little testenv to verify my assumption.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-17T09:37:13.054Z","updated_at":"2015-04-17T09:37:13.054Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":389253,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, this time the delay obviously was on my side.\n\nBut good news: I've tested the patch and could not find a way around it :).","markdown_message":"\u003cp\u003eSorry, this time the delay obviously was on my side.\u003c/p\u003e\n\n\u003cp\u003eBut good news: I\u0026#39;ve tested the patch and could not find a way around it :).\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-24T11:31:47.863Z","updated_at":"2015-04-24T11:33:01.756Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":401206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there any ETA yet for the patch?","markdown_message":"\u003cp\u003eIs there any ETA yet for the patch?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-04T14:09:34.293Z","updated_at":"2015-05-04T14:09:34.293Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":428047,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \n\nit's been a while since my inital report, and I confirmed that the patch is actually working a month ago.\nSo when is patch/disclosure time?\n\ncheers,\n\njoernchen\n","markdown_message":"\u003cp\u003eHi, \u003c/p\u003e\n\n\u003cp\u003eit\u0026#39;s been a while since my inital report, and I confirmed that the patch is actually working a month ago.\u003cbr\u003e\nSo when is patch/disclosure time?\u003c/p\u003e\n\n\u003cp\u003echeers,\u003c/p\u003e\n\n\u003cp\u003ejoernchen\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-25T17:29:59.343Z","updated_at":"2015-05-25T17:29:59.343Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":430601,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\ngiven the fact that I submitted this initially to security@rubyonrails.org on December 22nd 2014, and no visible progress is made even though there is a patch ready, I will go full disclosure with the details of this issue by 22nd of June.\n\nCheers,\n\njoernchen","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003egiven the fact that I submitted this initially to \u003ca title=\"security@rubyonrails.org\" href=\"mailto:security@rubyonrails.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@rubyonrails.org\u003c/a\u003e on December 22nd 2014, and no visible progress is made even though there is a patch ready, I will go full disclosure with the details of this issue by 22nd of June.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ejoernchen\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-28T15:21:21.206Z","updated_at":"2015-05-28T15:23:42.265Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":449420,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again,\n\nThat sounds.. entirely fair.\n\nI'm trying to get the release aligned with a couple of other \"smallish\" sec fixes, in the hope that it'll improve adoption (instead of people just dismissing them as individually too obscure to bother with). When we formed that plan, we expected the others to be ready at about the same time... there's been a bit of subsequent delay \u0026 back-and-forth, and I've meanwhile spectacularly failed to communicate any of the above.\n\nAnyway, I believe we're now on track to roll releases within the next week.\n\nWe've been assigned CVE-2015-3224 for this issue. Based on previous reports, I'm crediting you as \"joernchen of Phenoelit\" -- is that right?\n\nThanks,\n\nMatthew","markdown_message":"\u003cp\u003eHi again,\u003c/p\u003e\n\n\u003cp\u003eThat sounds.. entirely fair.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m trying to get the release aligned with a couple of other \u0026quot;smallish\u0026quot; sec fixes, in the hope that it\u0026#39;ll improve adoption (instead of people just dismissing them as individually too obscure to bother with). When we formed that plan, we expected the others to be ready at about the same time... there\u0026#39;s been a bit of subsequent delay \u0026amp; back-and-forth, and I\u0026#39;ve meanwhile spectacularly failed to communicate any of the above.\u003c/p\u003e\n\n\u003cp\u003eAnyway, I believe we\u0026#39;re now on track to roll releases within the next week.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve been assigned CVE-2015-3224 for this issue. Based on previous reports, I\u0026#39;m crediting you as \u0026quot;joernchen of Phenoelit\u0026quot; -- is that right?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n\n\u003cp\u003eMatthew\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-10T16:18:17.551Z","updated_at":"2015-06-10T16:18:17.551Z","actor":{"username":"matthewd","cleared":false,"url":"/matthewd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/558/5df350e99e2e86f74de4e3bf90de8880ac877b25_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":449423,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-10T16:24:20.784Z","updated_at":"2015-06-10T16:24:20.784Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":449470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@matthewd yes, you can credit me like this.\n\nthx\n\njoernchen","markdown_message":"\u003cp\u003e\u003ca href=\"/matthewd\"\u003e@matthewd\u003c/a\u003e yes, you can credit me like this.\u003c/p\u003e\n\n\u003cp\u003ethx\u003c/p\u003e\n\n\u003cp\u003ejoernchen\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-10T17:07:22.017Z","updated_at":"2015-06-10T17:07:22.017Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474492,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:11:53.212Z","updated_at":"2015-06-16T19:11:53.212Z","actor":{"username":"matthewd","cleared":false,"url":"/matthewd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/558/5df350e99e2e86f74de4e3bf90de8880ac877b25_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"joernchen","url":"/joernchen"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":474497,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:16:20.623Z","updated_at":"2015-06-16T19:16:20.623Z","first_to_agree":true,"actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":474511,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:21:46.185Z","updated_at":"2015-06-16T19:21:46.185Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474512,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T19:21:46.453Z","updated_at":"2015-06-16T19:21:46.453Z","actor":{"username":"joernchen","cleared":false,"url":"/joernchen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/5c3bb9f26b9116faa19b35d813ae411be62433e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":615249,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-09T06:54:22.835Z","updated_at":"2015-10-09T06:54:22.835Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"joernchen","url":"/joernchen"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":165,"category":"team","content":"IP whitelist bypass in Web Console \n\nThere is a remote code execution vulnerability in Web Console. \nThis vulnerability has been assigned the CVE identifier CVE-2015-3224. \n\nVersions Affected:  All \nNot affected:       Environments inaccessible from remote IPs, or without Web Console enabled \nFixed Versions:     2.1.3 \n\nImpact \n------ \nSpecially crafted remote requests can spoof their origin, bypassing the IP whitelist, in any environment where Web Console is enabled (development and test, by default). \n\nUsers whose application is only accessible from localhost (as is the default behaviour in Rails 4.2) are not affected, unless a local proxy is involved. \n\nAll affected users should either upgrade or use one of the work arounds immediately. \n\nReleases \n-------- \nThe 2.1.3 release is available at the normal locations. \n\nWorkarounds \n----------- \nTo work around this issue, turn off web-console in all environments, by removing/commenting it from the application's Gemfile. \n\nPatches \n------- \nTo aid users who aren't able to upgrade immediately we have provided patches for the two supported release series.  They are in git-am format and consist of a single changeset. \n\n* 2-1-ip-whitelist.patch - Patch for 2.1 series \n\nPlease note that only the 2.1.x series is supported at present.  Users of earlier unsupported releases are advised to upgrade as soon as possible. \n\nCredits \n------- \nThis vulnerability was reported by both joernchen of Phenoelit and Ben Murphy.  Thanks to each of them for reporting the issue to us and verifying the fix. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIP whitelist bypass in Web Console \u003c/p\u003e\n\n\u003cp\u003eThere is a remote code execution vulnerability in Web Console. \u003cbr\u003e\nThis vulnerability has been assigned the CVE identifier CVE-2015-3224. \u003c/p\u003e\n\n\u003cp\u003eVersions Affected:  All \u003cbr\u003e\nNot affected:       Environments inaccessible from remote IPs, or without Web Console enabled \u003cbr\u003e\nFixed Versions:     2.1.3 \u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact \u003c/h2\u003e\n\n\u003cp\u003eSpecially crafted remote requests can spoof their origin, bypassing the IP whitelist, in any environment where Web Console is enabled (development and test, by default). \u003c/p\u003e\n\n\u003cp\u003eUsers whose application is only accessible from localhost (as is the default behaviour in Rails 4.2) are not affected, unless a local proxy is involved. \u003c/p\u003e\n\n\u003cp\u003eAll affected users should either upgrade or use one of the work arounds immediately. \u003c/p\u003e\n\n\u003ch2 id=\"releases\"\u003eReleases \u003c/h2\u003e\n\n\u003cp\u003eThe 2.1.3 release is available at the normal locations. \u003c/p\u003e\n\n\u003ch2 id=\"workarounds\"\u003eWorkarounds \u003c/h2\u003e\n\n\u003cp\u003eTo work around this issue, turn off web-console in all environments, by removing/commenting it from the application\u0026#39;s Gemfile. \u003c/p\u003e\n\n\u003ch2 id=\"patches\"\u003ePatches \u003c/h2\u003e\n\n\u003cp\u003eTo aid users who aren\u0026#39;t able to upgrade immediately we have provided patches for the two supported release series.  They are in git-am format and consist of a single changeset. \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e2-1-ip-whitelist.patch - Patch for 2.1 series \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlease note that only the 2.1.x series is supported at present.  Users of earlier unsupported releases are advised to upgrade as soon as possible. \u003c/p\u003e\n\n\u003ch2 id=\"credits\"\u003eCredits \u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability was reported by both joernchen of Phenoelit and Ben Murphy.  Thanks to each of them for reporting the issue to us and verifying the fix. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}