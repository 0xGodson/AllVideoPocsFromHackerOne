{"id":232347,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzIzNDc=","url":"https://hackerone.com/reports/232347","title":"[FG-VD-17-063] NextCloud Insufficient Attack Protection Vulnerability Notification","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-27T01:58:44.370Z","submitted_at":"2017-05-27T01:58:44.370Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yzy9951","url":"/yzy9951","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3776"],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-29T20:40:55.518Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-06-29T20:40:35.852Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Subject: [FG-VD-17-063] NextCloud Insufficient Attack Protection Vulnerability Notification\n\n-------\n\nVulnerability Notification\nMay 26, 2017\nTracking Case #: FG-VD-17-063\n\nDear NextCloud,\n\nThe following information pertains to information discovered by Fortinet's FortiGuard Labs. It has been determined that a vulnerability exists in NextCloud. To streamline the disclosure process, we have created a preliminary advisory which you can find below. This upcoming advisory is purely intended as a reference, and does not contain sensitive information such as proof of concept code. \n\nAs a mature corporation involved in security research, we strive to responsibly disclose vulnerability information. We will not post an advisory until we determine it is appropriate to do so in co-ordination with the vendor unless a resolution cannot be reached. We will not disclose full proof of concept, only details relevant to the advisory.\n\nWe look forward to working closely with you to resolve this issue, and kindly ask for your co-operation during this time. Please let us know if you have any further questions, and we will promptly respond to address any issues. \n\nIf this message is not encrypted, it is because we could not find your key to do so. If you have one available for use, please notify us and we will ensure that this is used in future correspondence. We ask you use our public PGP key to encrypt and communicate any sensitive information with us. You may find the key on our FortiGuard center at: http://www.fortiguard.com/pgpkey.\n\nType of Vulnerability \u0026 Repercussions:\n\tInsufficient Attack Protection\n\nAffected Product:\n\tNextCloud 12.0.0 (stable)\n\nUpcoming Advisory Reference:\n\thttp://www.fortiguard.com/advisory/UpcomingAdvisories.html\n\nCredits:\n\tThis vulnerability was discovered by Fortinet's FortiGuard Labs.\n\n\nProof of Concept \u0026 Additional Information:\n\tPlease check the attachment.\n\tDetailed information is at 'F188459', FG-VD-17-063.txt.","vulnerability_information_html":"\u003cp\u003eSubject: [FG-VD-17-063] NextCloud Insufficient Attack Protection Vulnerability Notification\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eVulnerability Notification\u003cbr\u003e\nMay 26, 2017\u003cbr\u003e\nTracking Case #: FG-VD-17-063\u003c/p\u003e\n\n\u003cp\u003eDear NextCloud,\u003c/p\u003e\n\n\u003cp\u003eThe following information pertains to information discovered by Fortinet\u0026#39;s FortiGuard Labs. It has been determined that a vulnerability exists in NextCloud. To streamline the disclosure process, we have created a preliminary advisory which you can find below. This upcoming advisory is purely intended as a reference, and does not contain sensitive information such as proof of concept code. \u003c/p\u003e\n\n\u003cp\u003eAs a mature corporation involved in security research, we strive to responsibly disclose vulnerability information. We will not post an advisory until we determine it is appropriate to do so in co-ordination with the vendor unless a resolution cannot be reached. We will not disclose full proof of concept, only details relevant to the advisory.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to working closely with you to resolve this issue, and kindly ask for your co-operation during this time. Please let us know if you have any further questions, and we will promptly respond to address any issues. \u003c/p\u003e\n\n\u003cp\u003eIf this message is not encrypted, it is because we could not find your key to do so. If you have one available for use, please notify us and we will ensure that this is used in future correspondence. We ask you use our public PGP key to encrypt and communicate any sensitive information with us. You may find the key on our FortiGuard center at: \u003ca title=\"http://www.fortiguard.com/pgpkey\" href=\"/redirect?url=http%3A%2F%2Fwww.fortiguard.com%2Fpgpkey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.fortiguard.com/pgpkey\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eType of Vulnerability \u0026amp; Repercussions:\u003cbr\u003e\n    Insufficient Attack Protection\u003c/p\u003e\n\n\u003cp\u003eAffected Product:\u003cbr\u003e\n    NextCloud 12.0.0 (stable)\u003c/p\u003e\n\n\u003cp\u003eUpcoming Advisory Reference:\u003cbr\u003e\n    \u003ca title=\"http://www.fortiguard.com/advisory/UpcomingAdvisories.html\" href=\"/redirect?url=http%3A%2F%2Fwww.fortiguard.com%2Fadvisory%2FUpcomingAdvisories.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.fortiguard.com/advisory/UpcomingAdvisories.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCredits:\u003cbr\u003e\n    This vulnerability was discovered by Fortinet\u0026#39;s FortiGuard Labs.\u003c/p\u003e\n\n\u003cp\u003eProof of Concept \u0026amp; Additional Information:\u003cbr\u003e\n    Please check the attachment.\u003cbr\u003e\n    Detailed information is at \u0026#39;F188459\u0026#39;, FG-VD-17-063.txt.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":188459,"file_name":"FG-VD-17-063.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/459/90813030f2c9bd1a5f1dc13c4af662333f703432/FG-VD-17-063.txt?response-content-disposition=attachment%3B%20filename%3D%22FG-VD-17-063.txt%22%3B%20filename%2A%3DUTF-8%27%27FG-VD-17-063.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=3bc4a0fc05205c1571855ffaaea8afd7f7c1db08f1c0c5dc47969d2acca12804","file_size":3481,"type":"text/plain"},{"id":188460,"file_name":"Figure_1._Nextcloud_cookies.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/460/31b1d8faacd937dd7d0e8c9e4d9cd73663bc57ad/Figure_1._Nextcloud_cookies.jpg?response-content-disposition=attachment%3B%20filename%3D%22Figure_1._Nextcloud_cookies.jpg%22%3B%20filename%2A%3DUTF-8%27%27Figure_1._Nextcloud_cookies.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=9d7b3cbb26b18d2234886312da1c20bcbb5d6c3e00695a19444e6874098b85f4","file_size":47815,"type":"image/jpeg"},{"id":188461,"file_name":"Figure_2._Logging_function.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/461/2343770fd40982a2d3174cce3282a884f7bd07b2/Figure_2._Logging_function.jpg?response-content-disposition=attachment%3B%20filename%3D%22Figure_2._Logging_function.jpg%22%3B%20filename%2A%3DUTF-8%27%27Figure_2._Logging_function.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=0f32a64fc32c6a9a0702c44c0cb59abdbfa64cd0375f9f60db18a5d3c2ff17c3","file_size":57306,"type":"image/jpeg"},{"id":188462,"file_name":"Figure_3.1._PoC_request.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/462/17e94d819969792692d38475d94b47dcf6e50538/Figure_3.1._PoC_request.jpg?response-content-disposition=attachment%3B%20filename%3D%22Figure_3.1._PoC_request.jpg%22%3B%20filename%2A%3DUTF-8%27%27Figure_3.1._PoC_request.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=2d759c35029ec726c537241189fbb5e934cc3bb90fe30fc05f9e18fb19661fb1","file_size":117398,"type":"image/jpeg"},{"id":188463,"file_name":"Figure_3.2._PoC_request_HEX.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/463/eb7a132393fedceaeb0c511e608b108be5a5b9b2/Figure_3.2._PoC_request_HEX.jpg?response-content-disposition=attachment%3B%20filename%3D%22Figure_3.2._PoC_request_HEX.jpg%22%3B%20filename%2A%3DUTF-8%27%27Figure_3.2._PoC_request_HEX.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=95756bad3c8bd384814023abcbbdb85a29bbd5093ab679c7a19cf34215f87618","file_size":142731,"type":"image/jpeg"},{"id":188464,"file_name":"Figure_4._Logs_has_been_deleted.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/188/464/878eaba3428dc0e25962da24df8c37e255da210c/Figure_4._Logs_has_been_deleted.jpg?response-content-disposition=attachment%3B%20filename%3D%22Figure_4._Logs_has_been_deleted.jpg%22%3B%20filename%2A%3DUTF-8%27%27Figure_4._Logs_has_been_deleted.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050554Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=a1d6c62b4c8eac600b2c31558d5566c954a3b6759e83d94b06c3900e846cb136","file_size":44325,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2018-07-29T20:40:36.054Z","allow_singular_disclosure_after":-76321518.37595505,"singular_disclosure_allowed":true,"vote_count":9,"voters":["mygf","michan","eveeez","geeknik","apapedulimu","khizer47","silv3rpoision","sumit7","cryptographer"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1704664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-05-27T01:58:44.552Z","updated_at":"2017-05-27T01:58:44.552Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I'd like to change the vulnerability type from Insufficient Attack Protection to Code Injection. Thanks.","markdown_message":"\u003cp\u003eHi, I\u0026#39;d like to change the vulnerability type from Insufficient Attack Protection to Code Injection. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T02:01:16.791Z","updated_at":"2017-05-27T02:01:16.791Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704890,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice catch! :) After some troubles with Burp we could reproduce this behaviour. \n\nThe root cause here is a different one though when writing a log entry Nextcloud calls `\\OC\\Log\\File::write` ([relevant code on GitHub](https://github.com/nextcloud/server/blob/v12.0.0/lib/private/Log/File.php#L69-L135)), this function calls the PHP function `json_encode` on an array that also contains your specified User-Agent:\n\n```php\n$entry = compact(\n\t'reqId',\n\t'level',\n\t'time',\n\t'remoteAddr',\n\t'user',\n\t'app',\n\t'method',\n\t'url',\n\t'message',\n\t'userAgent',\n\t'version'\n);\n$entry = json_encode($entry);\n```\n\nHowever, PHP seems to fail to `json_encode` the array with your special character and simply returns `false`,  which then gets written as a single new line to the log file. The JavaScript log viewer isn't able to handle so many empty lines and will simply claim no logs have been found. \n\nSo a malicious user could effectively evade logging of their own actions by using a specially crafted User-Agent that PHP is not able to `json_encode`. This is certainly an undesired outcome and I'll check with the team on how we can best address this.\n\nIt should be noted that the log file on the filesystem plus the \"Download logs\" in the GUI still contain all the previous log entries. No other data is lost thus. You can find this log file in your data directory in `nextcloud.log`. ","markdown_message":"\u003cp\u003eNice catch! :) After some troubles with Burp we could reproduce this behaviour. \u003c/p\u003e\n\n\u003cp\u003eThe root cause here is a different one though when writing a log entry Nextcloud calls \u003ccode\u003e\\OC\\Log\\File::write\u003c/code\u003e (\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Fv12.0.0%2Flib%2Fprivate%2FLog%2FFile.php%23L69-L135\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erelevant code on GitHub\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), this function calls the PHP function \u003ccode\u003ejson_encode\u003c/code\u003e on an array that also contains your specified User-Agent:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$entry\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003ecompact\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;reqId\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;level\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;time\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;remoteAddr\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;app\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;method\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;url\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;message\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;userAgent\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;version\u0026#39;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$entry\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003ejson_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$entry\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, PHP seems to fail to \u003ccode\u003ejson_encode\u003c/code\u003e the array with your special character and simply returns \u003ccode\u003efalse\u003c/code\u003e,  which then gets written as a single new line to the log file. The JavaScript log viewer isn\u0026#39;t able to handle so many empty lines and will simply claim no logs have been found. \u003c/p\u003e\n\n\u003cp\u003eSo a malicious user could effectively evade logging of their own actions by using a specially crafted User-Agent that PHP is not able to \u003ccode\u003ejson_encode\u003c/code\u003e. This is certainly an undesired outcome and I\u0026#39;ll check with the team on how we can best address this.\u003c/p\u003e\n\n\u003cp\u003eIt should be noted that the log file on the filesystem plus the \u0026quot;Download logs\u0026quot; in the GUI still contain all the previous log entries. No other data is lost thus. You can find this log file in your data directory in \u003ccode\u003enextcloud.log\u003c/code\u003e. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T07:50:22.095Z","updated_at":"2017-05-27T07:50:22.095Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704892,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-27T07:51:40.920Z","updated_at":"2017-05-27T07:51:40.920Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.3)","old_severity_id":45307,"new_severity_id":45330},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704917,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Thanks for your quick reply.\nIf possible, please request a CVE ID for this issue, thanks.","markdown_message":"\u003cp\u003eGreat! Thanks for your quick reply.\u003cbr\u003e\nIf possible, please request a CVE ID for this issue, thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T08:23:32.408Z","updated_at":"2017-05-27T08:23:32.408Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We'll request a CVE ID for this as part of our own advisory process, no worries :)\n\nWe release our advisories usually 14 days after release of the new version to give users a chance to update. I'll post more information about this in a few days once we'vre determined the beat course of action here.","markdown_message":"\u003cp\u003eWe\u0026#39;ll request a CVE ID for this as part of our own advisory process, no worries :)\u003c/p\u003e\n\n\u003cp\u003eWe release our advisories usually 14 days after release of the new version to give users a chance to update. I\u0026#39;ll post more information about this in a few days once we\u0026#39;vre determined the beat course of action here.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T08:28:06.025Z","updated_at":"2017-05-27T08:28:06.025Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"After you release the advisory, can I post an advisory about it?","markdown_message":"\u003cp\u003eAfter you release the advisory, can I post an advisory about it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T08:49:00.737Z","updated_at":"2017-05-27T08:49:00.737Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704953,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. We'd also be happy to link to it from our advisory :)","markdown_message":"\u003cp\u003eSure. We\u0026#39;d also be happy to link to it from our advisory :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T09:15:19.755Z","updated_at":"2017-05-27T09:15:19.755Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704962,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Tiny nitpick, I just saw that you added us on http://www.fortiguard.com/zeroday?type=zd, would it be possible to change the vendor name from \"NextCloud\" to \"Nextcloud\" with lowercase c? ","markdown_message":"\u003cp\u003eTiny nitpick, I just saw that you added us on \u003ca title=\"http://www.fortiguard.com/zeroday?type=zd\" href=\"/redirect?url=http%3A%2F%2Fwww.fortiguard.com%2Fzeroday%3Ftype%3Dzd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.fortiguard.com/zeroday?type=zd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, would it be possible to change the vendor name from \u0026quot;NextCloud\u0026quot; to \u0026quot;Nextcloud\u0026quot; with lowercase c? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T09:25:37.927Z","updated_at":"2017-05-27T09:25:37.927Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for that, I am contacting the site admin.","markdown_message":"\u003cp\u003eSorry for that, I am contacting the site admin.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-27T09:33:36.684Z","updated_at":"2017-05-27T09:33:36.684Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1935939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Apologies for the delay on this one, we had some internal discussion on this and are aiming to release a patch for this in our next releases which are scheduled around early September 2017.\n\nOur current proposed patch can be seen at https://github.com/nextcloud/server/pull/6169, basically we loop over the array and check if the values can be encoded and if not we encode the value manually to UTF-8 and also make sure that the JSON entry is even created when an error occurred.\n\n```diff\ndiff --git a/lib/private/Log/File.php b/lib/private/Log/File.php\nindex 97ec5012b1f..c6677dd528d 100644\n--- a/lib/private/Log/File.php\n+++ b/lib/private/Log/File.php\n@@ -117,7 +117,18 @@ public static function write($app, $message, $level) {\n \t\t\t'userAgent',\n \t\t\t'version'\n \t\t);\n-\t\t$entry = json_encode($entry);\n+\t\t// PHP's json_encode only accept proper UTF-8 strings, loop over all\n+\t\t// elements to ensure that they are properly UTF-8 compliant or convert\n+\t\t// them manually.\n+\t\tforeach($entry as $key =\u003e $value) {\n+\t\t\tif(is_string($value)) {\n+\t\t\t\t$testEncode = json_encode($value);\n+\t\t\t\tif($testEncode === false) {\n+\t\t\t\t\t$entry[$key] = utf8_encode($value);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\t\t$entry = json_encode($entry, JSON_PARTIAL_OUTPUT_ON_ERROR);\n \t\t$handle = @fopen(self::$logFile, 'a');\n \t\tif ((fileperms(self::$logFile) \u0026 0777) != 0640) {\n \t\t\t@chmod(self::$logFile, 0640);\n```","markdown_message":"\u003cp\u003eApologies for the delay on this one, we had some internal discussion on this and are aiming to release a patch for this in our next releases which are scheduled around early September 2017.\u003c/p\u003e\n\n\u003cp\u003eOur current proposed patch can be seen at \u003ca title=\"https://github.com/nextcloud/server/pull/6169\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F6169\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/6169\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, basically we loop over the array and check if the values can be encoded and if not we encode the value manually to UTF-8 and also make sure that the JSON entry is even created when an error occurred.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/private/Log/File.php b/lib/private/Log/File.php\nindex 97ec5012b1f..c6677dd528d 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/private/Log/File.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/private/Log/File.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -117,7 +117,18 @@\u003c/span\u003e public static function write($app, $message, $level) {\n            \u0026#39;userAgent\u0026#39;,\n            \u0026#39;version\u0026#39;\n        );\n\u003cspan class=\"gd\"\u003e-       $entry = json_encode($entry);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+       // PHP\u0026#39;s json_encode only accept proper UTF-8 strings, loop over all\n+       // elements to ensure that they are properly UTF-8 compliant or convert\n+       // them manually.\n+       foreach($entry as $key =\u0026gt; $value) {\n+           if(is_string($value)) {\n+               $testEncode = json_encode($value);\n+               if($testEncode === false) {\n+                   $entry[$key] = utf8_encode($value);\n+               }\n+           }\n+       }\n+       $entry = json_encode($entry, JSON_PARTIAL_OUTPUT_ON_ERROR);\n\u003c/span\u003e        $handle = @fopen(self::$logFile, \u0026#39;a\u0026#39;);\n        if ((fileperms(self::$logFile) \u0026amp; 0777) != 0640) {\n            @chmod(self::$logFile, 0640);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-08-17T13:05:14.934Z","updated_at":"2017-08-17T13:05:14.934Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2055490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Lukasreschke,\n\nWhen you post an advisory for this issue, please credit us as following:\n\"This vulnerability was discovered by Zhouyuan Yang of Fortinet's FortiGuard Labs.\"\n\nAnd if possible, please request a CVE ID for this issue.\n\nThanks,\nZhouyuan","markdown_message":"\u003cp\u003eHi Lukasreschke,\u003c/p\u003e\n\n\u003cp\u003eWhen you post an advisory for this issue, please credit us as following:\u003cbr\u003e\n\u0026quot;This vulnerability was discovered by Zhouyuan Yang of Fortinet\u0026#39;s FortiGuard Labs.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eAnd if possible, please request a CVE ID for this issue.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nZhouyuan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-10T02:16:12.153Z","updated_at":"2017-10-10T02:16:12.153Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2599284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Any updates?","markdown_message":"\u003cp\u003eHi, Any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-12T22:56:03.525Z","updated_at":"2018-04-12T22:56:03.525Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2756313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSorry for the delay here.\nI'll pick this up in the coming days and get back to you.\n\nWould it be possible for you to verify this is fixed in our latest release?\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay here.\u003cbr\u003e\nI\u0026#39;ll pick this up in the coming days and get back to you.\u003c/p\u003e\n\n\u003cp\u003eWould it be possible for you to verify this is fixed in our latest release?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-17T10:05:47.510Z","updated_at":"2018-05-17T10:05:47.510Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2886775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI can confirm that with the latest version (Nextcloud 13.0.2), this issue has been fixed.\n\n-----------\n1. Can I public my findings?\n2. When you post an advisory for this issue, please credit us as following:\n\"This vulnerability was discovered by Zhouyuan Yang of Fortinet's FortiGuard Labs.\"\n3. And if possible, please request a CVE ID for this issue.\n\n\nThanks,\nZhouyuan","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI can confirm that with the latest version (Nextcloud 13.0.2), this issue has been fixed.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003col\u003e\n\u003cli\u003eCan I public my findings?\u003c/li\u003e\n\u003cli\u003eWhen you post an advisory for this issue, please credit us as following:\n\u0026quot;This vulnerability was discovered by Zhouyuan Yang of Fortinet\u0026#39;s FortiGuard Labs.\u0026quot;\u003c/li\u003e\n\u003cli\u003eAnd if possible, please request a CVE ID for this issue.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nZhouyuan\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-15T00:56:25.815Z","updated_at":"2018-06-15T00:56:25.815Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2902814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI'll request the CVE id soon (it is on my todo list for this week).\nThen we'll also disclose this on our website. After that you are of course free to publish this (and we'll also disclose this report).\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll request the CVE id soon (it is on my todo list for this week).\u003cbr\u003e\nThen we\u0026#39;ll also disclose this on our website. After that you are of course free to publish this (and we\u0026#39;ll also disclose this report).\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-18T19:58:38.352Z","updated_at":"2018-06-18T19:58:38.352Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2902819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's great! Thanks!","markdown_message":"\u003cp\u003eThat\u0026#39;s great! Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-18T19:59:47.923Z","updated_at":"2018-06-18T19:59:47.923Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2940777,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-27T12:09:15.555Z","updated_at":"2018-06-27T12:09:15.555Z","additional_data":{"old_severity":"Medium (5.3)","new_severity":"Low","old_severity_id":45330,"new_severity_id":173376},"actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2942151,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $100.","markdown_message":"\u003cp\u003eCongratulations! We have determined this to be eligible for a reward of $100.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T19:53:07.892Z","updated_at":"2018-06-27T19:53:07.892Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"yzy9951","url":"/yzy9951"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2942161,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2018-06-27T19:55:05.436Z","updated_at":"2018-06-27T19:55:05.436Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yzy9951","url":"/yzy9951"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2942163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The CVE has been request btw. It should be assigned shortly.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eThe CVE has been request btw. It should be assigned shortly.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T19:55:32.179Z","updated_at":"2018-06-27T19:55:32.179Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2951614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer ,\n\nPlease credit us as following: \"This vulnerability was discovered by Zhouyuan Yang of Fortinet's FortiGuard Labs.\"\nAnd just let me know when the CVE has been assigned.\n\nThanks!\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rullzer\"\u003e@rullzer\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003ePlease credit us as following: \u0026quot;This vulnerability was discovered by Zhouyuan Yang of Fortinet\u0026#39;s FortiGuard Labs.\u0026quot;\u003cbr\u003e\nAnd just let me know when the CVE has been assigned.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-28T17:19:08.746Z","updated_at":"2018-06-28T17:19:08.746Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2960281,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-29T20:40:35.931Z","updated_at":"2018-06-29T20:40:35.931Z","first_to_agree":true,"actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3113888,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-29T20:40:55.547Z","updated_at":"2018-07-29T20:40:55.547Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3118532,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer , Can I know the CVE number? And a link at https://nextcloud.com/security/advisories/?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rullzer\"\u003e@rullzer\u003c/a\u003e , Can I know the CVE number? And a link at \u003ca title=\"https://nextcloud.com/security/advisories/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisories%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisories/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T22:23:37.161Z","updated_at":"2018-07-30T22:23:37.161Z","actor":{"username":"yzy9951","cleared":false,"url":"/yzy9951","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3119662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nHackerone wanted one reference to be public before assigning the CVE. So it should be assigned soon. I'll update you once I know more.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eHackerone wanted one reference to be public before assigning the CVE. So it should be assigned soon. I\u0026#39;ll update you once I know more.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-31T05:39:09.051Z","updated_at":"2018-07-31T05:39:09.051Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}