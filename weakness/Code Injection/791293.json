{"id":791293,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTEyOTM=","url":"https://hackerone.com/reports/791293","title":"Modify Host Header which is sent to email","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-02-08T18:40:32.664Z","submitted_at":"2020-02-08T18:40:32.664Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"codermak","url":"/codermak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":37038,"url":"https://hackerone.com/endless_hosting","handle":"endless_hosting","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/zVTn9zZCSSQ7SD4HRUSyaj6d/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/zVTn9zZCSSQ7SD4HRUSyaj6d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Endless Hosting","twitter_handle":"Endless_Hosting","website":"https://theendlessweb.com","about":"Endless Hosting provides free shared-hosting services."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-12T12:24:39.537Z","bug_reporter_agreed_on_going_public_at":"2020-02-09T17:00:35.093Z","team_member_agreed_on_going_public_at":"2020-02-12T12:24:39.440Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nModify host header and include the fake website in password reset email.  Password reset mail is taking source domain from request header host, which can be modified using burp suite and the modified link is sent to the victims email\n\n## Steps To Reproduce:\n\n  1. Go to  https://da.theendlessweb.com:2222/\n  2. Start burp suite\n  3. Enter username and click on Send me a Link\n  4. Intercep the request and modify the URL to some other custom url\n  5. Forward the modified request\n  6. Password reset email will be sent.\n  7. Check your email and you will see the new url (which was configured in step 4) in the email.\n\n## Supporting Material/References:\n\n  * Snapshots in attachment\n\n## Impact\n\nWith this, attacker can make any victim to visit their custom website and can affect the victim in many ways","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eModify host header and include the fake website in password reset email.  Password reset mail is taking source domain from request header host, which can be modified using burp suite and the modified link is sent to the victims email\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to  \u003ca title=\"https://da.theendlessweb.com:2222/\" href=\"/redirect?url=https%3A%2F%2Fda.theendlessweb.com%3A2222%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://da.theendlessweb.com:2222/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eStart burp suite\u003c/li\u003e\n\u003cli\u003eEnter username and click on Send me a Link\u003c/li\u003e\n\u003cli\u003eIntercep the request and modify the URL to some other custom url\u003c/li\u003e\n\u003cli\u003eForward the modified request\u003c/li\u003e\n\u003cli\u003ePassword reset email will be sent.\u003c/li\u003e\n\u003cli\u003eCheck your email and you will see the new url (which was configured in step 4) in the email.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSnapshots in attachment\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWith this, attacker can make any victim to visit their custom website and can affect the victim in many ways\u003c/p\u003e\n","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":710311,"file_name":"email-hosting.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/HwF1ueqQR9fkHzZ8YAGTfgdu?response-content-disposition=attachment%3B%20filename%3D%22email-hosting.png%22%3B%20filename%2A%3DUTF-8%27%27email-hosting.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065341Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=977e3aca955c4b530a05fa2694c0f5c4a41bf01f62b632767ad5b9fca36d4208","file_size":93805,"type":"image/png"},{"id":710312,"file_name":"Screen_Shot_2020-02-09_at_12.06.31_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Ebg3qaKNav4fXMqTCibRtHbi?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-02-09_at_12.06.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-02-09_at_12.06.31_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065341Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=eb70eceb95266b9e1ab194d2288bf8119f6d4ad69f90616e27009d80b51790a9","file_size":82950,"type":"image/png"}],"allow_singular_disclosure_at":"2020-03-10T17:00:35.142Z","allow_singular_disclosure_after":-25365186.648254536,"singular_disclosure_allowed":true,"vote_count":29,"voters":["a_d_a_m","alesandroortiz","mik317","0xelkomy","dhakal_ananda","namgyukang","khizer47","ms1241721_","codermak","haruto","and 19 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":18613,"asset_type":"URL","asset_identifier":"(*).theendlessweb.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7000690,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\n\nThanks for letting us know about this issue. The option to force a redirect to our hostname was disabled as a reseller wished to whitelabel their host. We did not consider this security implication when making this change, and it has such been reverted.\n\nThanks","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThanks for letting us know about this issue. The option to force a redirect to our hostname was disabled as a reseller wished to whitelabel their host. We did not consider this security implication when making this change, and it has such been reverted.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-09T16:36:53.986Z","updated_at":"2020-02-09T16:36:53.986Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"codermak","url":"/codermak"},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7000758,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great. Thanks.\n\nI have verified this and its not reproducible now","markdown_message":"\u003cp\u003eGreat. Thanks.\u003c/p\u003e\n\n\u003cp\u003eI have verified this and its not reproducible now\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-09T16:59:52.184Z","updated_at":"2020-02-09T16:59:52.184Z","actor":{"username":"codermak","cleared":false,"url":"/codermak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7000761,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-09T17:00:35.116Z","updated_at":"2020-02-09T17:00:35.116Z","first_to_agree":true,"actor":{"username":"codermak","cleared":false,"url":"/codermak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/c9Yeqnq2Apkoc1UAkLCciykW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7030731,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T12:24:39.467Z","updated_at":"2020-02-12T12:24:39.467Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7030732,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T12:24:39.553Z","updated_at":"2020-02-12T12:24:39.553Z","actor":{"username":"djelectro","cleared":false,"url":"/djelectro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/265/021/6ea3e4f5c95898231f1798d10d2270e08abf96f9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"endless_hosting","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}