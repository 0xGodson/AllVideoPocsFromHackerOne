{"id":683318,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODMzMTg=","url":"https://hackerone.com/reports/683318","title":"Windows builds with insecure path defaults (CVE-2019-1552)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-08-28T00:18:59.854Z","submitted_at":"2019-08-28T00:18:59.854Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mirchr","url":"/mirchr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24,"url":"https://hackerone.com/ibb-openssl","handle":"ibb-openssl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OpenSSL (IBB)","twitter_handle":"","website":"https://www.openssl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-1552"],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-24T20:16:50.969Z","bug_reporter_agreed_on_going_public_at":"2019-09-24T20:16:50.883Z","team_member_agreed_on_going_public_at":"2019-09-24T20:13:50.699Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Advisory: https://www.openssl.org/news/secadv/20190730.txt\n\n```\nSeverity: Low\n\nOpenSSL has internal defaults for a directory tree where it can find a\nconfiguration file as well as certificates used for verification in\nTLS.  This directory is most commonly referred to as OPENSSLDIR, and\nis configurable with the --prefix / --openssldir configuration options.\n\nFor OpenSSL versions 1.1.0 and 1.1.1, the mingw configuration targets\nassume that resulting programs and libraries are installed in a\nUnix-like environment and the default prefix for program installation\nas well as for OPENSSLDIR should be '/usr/local'.\n\nHowever, mingw programs are Windows programs, and as such, find\nthemselves looking at sub-directories of 'C:/usr/local', which may be\nworld writable, which enables untrusted users to modify OpenSSL's\ndefault configuration, insert CA certificates, modify (or even\nreplace) existing engine modules, etc.\n\nFor OpenSSL 1.0.2, '/usr/local/ssl' is used as default for OPENSSLDIR\non all Unix and Windows targets, including Visual C builds.  However,\nsome build instructions for the diverse Windows targets on 1.0.2\nencourage you to specify your own --prefix.\n\nOpenSSL versions 1.1.1, 1.1.0 and 1.0.2 are affected by this issue.\nDue to the limited scope of affected deployments this has been\nassessed as low severity and therefore we are not creating new\nreleases at this time.\n\nThe mitigations are found in these commits:\n- For 1.1.1, commit 54aa9d51b09d67e90db443f682cface795f5af9e\n- For 1.1.0, commit e32bc855a81a2d48d215c506bdeb4f598045f7e9 and\n  b15a19c148384e73338aa7c5b12652138e35ed28\n- For 1.0.2, commit d333ebaf9c77332754a9d5e111e2f53e1de54fdd\n\nThe 1.1.1 and 1.1.0 mitigation set more appropriate defaults for\nmingw, while the 1.0.2 mitigation documents the issue and provides\nenhanced examples.\n\nThis issue was reported by Rich Mirch.  The fix was developed by\nRichard Levitte from the OpenSSL development team.  It was reported to\nOpenSSL on 9th Jun 2019.\n```\n## Summary:\nI have confirmed this vulnerability in over a dozen Windows applications. A few public links have been included below. While the OpenSSL project rated this a low, most projects/vendors that I have worked with have rated it a high due to the ability to inject arbitrary code into the calling process from a low privileged user.\n\n## Supporting Material/References:\n* curl/libcurl - Windows OpenSSL engine code injection https://curl.haxx.se/docs/CVE-2019-5443.html\n* CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/\n* Stunnel Windows local privilege escalation vulnerability https://www.stunnel.org/pipermail/stunnel-users/2019-June/006417.html\n* CVE-2019-10211: EnterpriseDB Windows installer bundled OpenSSL executes code from unprotected directory https://www.postgresql.org/about/news/1960/\n\n## Impact\n\nThis can result in the elevation of privileges for the vulnerable application. Low privileged accounts on Windows allow authenticated low privileged users the ability to create directories under the top level root directory c:\\\\. A malicious user could create this path and add a custom openssl.cnf file to load a OpenSSL engine library. When this library is loaded, arbitrary code would be executed with the full authority of the calling process. In some cases this is a service running with SYSTEM privileges - the highest authority on Windows systems.","vulnerability_information_html":"\u003cp\u003eAdvisory: \u003ca title=\"https://www.openssl.org/news/secadv/20190730.txt\" href=\"/redirect?url=https%3A%2F%2Fwww.openssl.org%2Fnews%2Fsecadv%2F20190730.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.openssl.org/news/secadv/20190730.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSeverity: Low\n\nOpenSSL has internal defaults for a directory tree where it can find a\nconfiguration file as well as certificates used for verification in\nTLS.  This directory is most commonly referred to as OPENSSLDIR, and\nis configurable with the --prefix / --openssldir configuration options.\n\nFor OpenSSL versions 1.1.0 and 1.1.1, the mingw configuration targets\nassume that resulting programs and libraries are installed in a\nUnix-like environment and the default prefix for program installation\nas well as for OPENSSLDIR should be \u0026#39;/usr/local\u0026#39;.\n\nHowever, mingw programs are Windows programs, and as such, find\nthemselves looking at sub-directories of \u0026#39;C:/usr/local\u0026#39;, which may be\nworld writable, which enables untrusted users to modify OpenSSL\u0026#39;s\ndefault configuration, insert CA certificates, modify (or even\nreplace) existing engine modules, etc.\n\nFor OpenSSL 1.0.2, \u0026#39;/usr/local/ssl\u0026#39; is used as default for OPENSSLDIR\non all Unix and Windows targets, including Visual C builds.  However,\nsome build instructions for the diverse Windows targets on 1.0.2\nencourage you to specify your own --prefix.\n\nOpenSSL versions 1.1.1, 1.1.0 and 1.0.2 are affected by this issue.\nDue to the limited scope of affected deployments this has been\nassessed as low severity and therefore we are not creating new\nreleases at this time.\n\nThe mitigations are found in these commits:\n- For 1.1.1, commit 54aa9d51b09d67e90db443f682cface795f5af9e\n- For 1.1.0, commit e32bc855a81a2d48d215c506bdeb4f598045f7e9 and\n  b15a19c148384e73338aa7c5b12652138e35ed28\n- For 1.0.2, commit d333ebaf9c77332754a9d5e111e2f53e1de54fdd\n\nThe 1.1.1 and 1.1.0 mitigation set more appropriate defaults for\nmingw, while the 1.0.2 mitigation documents the issue and provides\nenhanced examples.\n\nThis issue was reported by Rich Mirch.  The fix was developed by\nRichard Levitte from the OpenSSL development team.  It was reported to\nOpenSSL on 9th Jun 2019.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eI have confirmed this vulnerability in over a dozen Windows applications. A few public links have been included below. While the OpenSSL project rated this a low, most projects/vendors that I have worked with have rated it a high due to the ability to inject arbitrary code into the calling process from a low privileged user.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003ecurl/libcurl - Windows OpenSSL engine code injection \u003ca title=\"https://curl.haxx.se/docs/CVE-2019-5443.html\" href=\"/redirect?url=https%3A%2F%2Fcurl.haxx.se%2Fdocs%2FCVE-2019-5443.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://curl.haxx.se/docs/CVE-2019-5443.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine \u003ca title=\"https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/\" href=\"/redirect?url=https%3A%2F%2Fblog.mirch.io%2F2019%2F06%2F10%2Fcve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eStunnel Windows local privilege escalation vulnerability \u003ca title=\"https://www.stunnel.org/pipermail/stunnel-users/2019-June/006417.html\" href=\"/redirect?url=https%3A%2F%2Fwww.stunnel.org%2Fpipermail%2Fstunnel-users%2F2019-June%2F006417.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.stunnel.org/pipermail/stunnel-users/2019-June/006417.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCVE-2019-10211: EnterpriseDB Windows installer bundled OpenSSL executes code from unprotected directory \u003ca title=\"https://www.postgresql.org/about/news/1960/\" href=\"/redirect?url=https%3A%2F%2Fwww.postgresql.org%2Fabout%2Fnews%2F1960%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.postgresql.org/about/news/1960/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis can result in the elevation of privileges for the vulnerable application. Low privileged accounts on Windows allow authenticated low privileged users the ability to create directories under the top level root directory c:\\. A malicious user could create this path and add a custom openssl.cnf file to load a OpenSSL engine library. When this library is loaded, arbitrary code would be executed with the full authority of the calling process. In some cases this is a service running with SYSTEM privileges - the highest authority on Windows systems.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-24T20:13:50.798Z","allow_singular_disclosure_after":-37275828.74294634,"singular_disclosure_allowed":true,"vote_count":12,"voters":["dee-see","1337ibrahim","onetrick","cryptographer","armansameer","chelitaboo83","frichetten","misterd","rednecktek","nopwnnogain","and 2 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5691612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mirchr - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mirchr\"\u003e@mirchr\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T14:42:17.675Z","updated_at":"2019-08-29T14:42:17.675Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5691784,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-29T15:04:03.025Z","updated_at":"2019-08-29T15:04:03.025Z","cve_ids":["CVE-2019-1552"],"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5691785,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @mirchr! I was able to validate your report, and have submitted it to the appropriate remediation team for review. You will be updated on the status of this report as soon as there is additional information to share. Please note that the status and severity are subject to change. ","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/mirchr\"\u003e@mirchr\u003c/a\u003e! I was able to validate your report, and have submitted it to the appropriate remediation team for review. You will be updated on the status of this report as soon as there is additional information to share. Please note that the status and severity are subject to change. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T15:04:21.846Z","updated_at":"2019-08-29T15:04:21.846Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5881149,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T20:13:15.512Z","updated_at":"2019-09-24T20:13:15.512Z","actor":{"url":"/ibb-openssl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/024/523699736f62cf8e067320163b49e80626b1b3a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OpenSSL (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-openssl","collaborator":{"username":"mirchr","url":"/mirchr"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881151,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThank you for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-24T20:13:44.161Z","updated_at":"2019-09-24T20:13:44.161Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"mirchr","url":"/mirchr"},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881153,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T20:13:50.728Z","updated_at":"2019-09-24T20:13:50.728Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881184,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for the bounty!","markdown_message":"\u003cp\u003eThank you for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-24T20:16:50.906Z","updated_at":"2019-09-24T20:16:50.906Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5881185,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T20:16:50.988Z","updated_at":"2019-09-24T20:16:50.988Z","actor":{"username":"mirchr","cleared":true,"url":"/mirchr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d5WVwYt8n5pYhhom1mNPokFG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-openssl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}