{"id":195950,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTU5NTA=","url":"https://hackerone.com/reports/195950","title":"Use of uninitialized memory in unserialize()","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-05T11:24:39.937Z","submitted_at":"2017-01-05T11:24:39.937Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rc0r","url":"/rc0r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-5340"],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-01T18:41:51.251Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-06-01T18:41:44.660Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The following is a copy of the bug report at https://bugs.php.net/bug.php?id=73832\n\n# Description\n\nThere was found a bug showing that PHP uses uninitialized memory during\ncalls to `unserialize()`. As the following report shows, the payload supplied\nto `unserialize()` may control this uninitialized memory region and thus may\nbe used to trick PHP into operating on faked objects and calling attacker\ncontrolled destructor function pointers. The supplied proof of concept exploit\npractically demonstrates the issue by executing arbitrary code solely by\npassing a specially crafted string to `unserialize()`. Even though this\nparticular demo exploit only works locally this flaw is very likely to also\nallow for remote code execution.\n\nThis bug was found using `afl-fuzz` / `afl-utils`.\n\n\n# Analysis\n\nThe following shows a short gdb dump of the flaw in a custom-built PHP (git\nmaster on 40727d7ce9) with debugging symbols ([1], [2]):\n\n    $ gdb ./sapi/cli/php\n    gdb\u003e r test.php payload.master\n    [...]\n    Fatal error: Possible integer overflow in memory allocation (2736264714 * 32 + 32) in test.php on line 6\n\n    Program received signal SIGSEGV, Segmentation fault.\n    gdb\u003e i r\n    rax            0x7ffff7fb673c\t140737353836348\n    rbx            0x3030303030303030\t3472328296227680304\n    rcx            0xf6d9\t63193\n    rdx            0x1cb8c30\t30116912\n    rsi            0x0\t0\n    rdi            0x3030303030303030\t3472328296227680304\n    rbp            0x30303030\t0x30303030\n    rsp            0x7fffffffc080\t0x7fffffffc080\n    r8             0x7ffff7fb6740\t140737353836352\n    r9             0x1cb4d00\t30100736\n    r10            0xeb\t235\n    r11            0x206\t518\n    r12            0x1c96ad8\t29977304\n    r13            0x30303030\t808464432\n    r14            0x7ffff167be00\t140737243495936\n    r15            0x3030303030303030\t3472328296227680304         \u003c\u003c !!!\n    rip            0x10b63d7\t0x10b63d7 \u003czend_hash_destroy+327\u003e\n    eflags         0x10202\t[ IF RF ]\n    cs             0x33\t51\n    ss             0x2b\t43\n    ds             0x0\t0\n    es             0x0\t0\n    fs             0x0\t0\n    gs             0x0\t0\n    gdb\u003e x/i $rip\n    =\u003e 0x10b63d7 \u003czend_hash_destroy+327\u003e:\tcallq  *%r15\n    gdb\u003e bt\n    #0  0x00000000010b63d7 in zend_hash_destroy (ht=\u003coptimized out\u003e) at Zend/zend_hash.c:1233\n    #1  0x00000000010b7914 in zend_array_destroy (ht=0x7ffff167be00) at Zend/zend_hash.c:1293\n    #2  0x000000000106f59e in _zval_dtor_func (p=0x7ffff167be00) at Zend/zend_variables.c:43\n    #3  0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u003coptimized out\u003e) at Zend/zend_variables.h:49\n    #4  zend_array_destroy (ht=\u003coptimized out\u003e) at Zend/zend_hash.c:1303\n    #5  0x000000000106f59e in _zval_dtor_func (p=0x7ffff167bce8) at Zend/zend_variables.c:43\n    #6  0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u003coptimized out\u003e) at Zend/zend_variables.h:49\n    #7  zend_array_destroy (ht=\u003coptimized out\u003e) at Zend/zend_hash.c:1303\n    [...]\n    #83 0x000000000106f59e in _zval_dtor_func (p=0x7ffff1656540) at Zend/zend_variables.c:43\n    #84 0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u003coptimized out\u003e) at Zend/zend_variables.h:49\n    #85 zend_array_destroy (ht=\u003coptimized out\u003e) at Zend/zend_hash.c:1303\n    #86 0x000000000106f59e in _zval_dtor_func (p=0x7ffff1656428) at Zend/zend_variables.c:43\n    #87 0x00000000010b7323 in i_zval_ptr_dtor (zval_ptr=\u003coptimized out\u003e) at Zend/zend_variables.h:49\n    #88 zend_array_destroy (ht=\u003coptimized out\u003e) at Zend/zend_hash.c:1307\n    #89 0x0000000001137a3d in zend_object_std_dtor (object=0x7ffff165c960) at Zend/zend_objects.c:60\n    #90 0x0000000001147fdf in zend_objects_store_free_object_storage (objects=\u003coptimized out\u003e) at Zend/zend_objects_API.c:99\n    #91 0x000000000103ce3b in shutdown_executor () at Zend/zend_execute_API.c:359\n    #92 0x0000000001073599 in zend_deactivate () at Zend/zend.c:997\n    #93 0x0000000000f27ff1 in php_request_shutdown (dummy=\u003coptimized out\u003e) at main/main.c:1873\n    #94 0x0000000001355e25 in do_cli (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at sapi/cli/php_cli.c:1161\n    #95 0x00000000013533d5 in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at sapi/cli/php_cli.c:1387\n\nSome more in-depth debugging walk through follows:\n \n    $ gdb ./sapi/cli/php\n    gdb\u003e b zend_hash_destroy\n    gdb\u003e ign 1 2\n    gdb\u003e r test.php payload.master\n    gdb\u003e p ht\n    $6 = (HashTable *) 0x7ffff167be00\n    gdb\u003e p *ht\n    $7 = {\n      gc = {\n        refcount = 0, \n        u = {\n          v = {\n            type = 1 '\\001', \n            flags = 0 '\\000', \n            gc_info = 32768\n          }, \n          type_info = 2147483649\n        }\n      }, \n      u = {\n        v = {\n          flags = 18 '\\022', \n          nApplyCount = 0 '\\000', \n          nIteratorsCount = 0 '\\000', \n          consistency = 0 '\\000'\n        }, \n        flags = 18\n      }, \n      nTableMask = 808464432, \n      arData = 0x3030303030303030, \n      nNumUsed = 808464432, \n      nNumOfElements = 808464432, \n      nTableSize = 808464432, \n      nInternalPointer = 808464432, \n      nNextFreeElement = 3472328296227680304, \n      pDestructor = 0x3030303030303030\n    }\n    gdb\u003e awatch *0x7ffff167be00\n    gdb\u003e dis 1\n    gdb\u003e r\n    Hardware access (read/write) watchpoint 2: *0x7ffff167be00\n    Value = 808464432\n    0x00007ffff5103d44 in __memmove_sse2_unaligned_erms () from /usr/lib/libc.so.6\n    gdb\u003e x/20x 0x00007ffff167be00\n    0x7ffff167be00:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be10:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be20:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be30:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be40:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    gdb\u003e c // (multiple times)\n    [...]\n    Hardware access (read/write) watchpoint 2: *0x7ffff167be00\n\n    Value = -244859336\n    0x0000000000fdcacb in zend_mm_alloc_small (size=\u003coptimized out\u003e, heap=\u003coptimized out\u003e, bin_num=\u003coptimized out\u003e) at Zend/zend_alloc.c:1261\n    1261\t\t\theap-\u003efree_slot[bin_num] = p-\u003enext_free_slot;\n    \u003e\u003e\u003e bt\n    #0  0x0000000000fdcacb in zend_mm_alloc_small (size=\u003coptimized out\u003e, heap=\u003coptimized out\u003e, bin_num=\u003coptimized out\u003e) at Zend/zend_alloc.c:1261\n    #1  _emalloc_56 () at Zend/zend_alloc.c:2336\n    #2  0x000000000107f6f7 in _array_init (arg=0x7ffff16673c0, size=2736264714) at Zend/zend_API.c:1060\n    #3  0x0000000000e23888 in php_var_unserialize_internal (rval=\u003coptimized out\u003e, p=\u003coptimized out\u003e, max=\u003coptimized out\u003e, var_hash=\u003coptimized out\u003e) at ext/standard/var_unserializer.re:788\n\nFrom the above backtrace one can see PHP tries to allocate memory for a\n`zend_array` of very large length corresponding to `a:9000111000000010:{...`\nin `payload.master` ([2]).\nThis allocation fails a bit later because of an integer overflow in the size\nparameter that is detected in `zend_hash_check_size()` called from\n`_zend_hash_init()`. As soon as this overflow is detected, PHP starts to\nshut down. At this point the contents of the partially initialized `zend_array`\nlook as follows:\n\n    gdb\u003e c\n    Fatal error: Possible integer overflow in memory allocation (2736264714 * 32 + 32) in test.php on line 6\n    Hardware access (read/write) watchpoint 2: *0x7ffff167be00\n\n    Value = 1\n    0x00000000010b6f6e in i_zval_ptr_dtor (zval_ptr=\u003coptimized out\u003e) at Zend/zend_variables.h:48\n    48\t\t\tif (!--GC_REFCOUNT(ref)) {\n    gdb\u003e x/16x 0x00007ffff167be00\n    0x7ffff167be00:\t0x00000001\t0x00008007\t0x00000012\t0x30303030\n    0x7ffff167be10:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be20:\t0x30303030\t0x30303030\t0x30303030\t0x30303030\n    0x7ffff167be30:\t0x30303030\t0x30303030\t0xf167be70\t0x00007fff \n\nDuring shutdown PHP attempts to destroy its internal objects as well as the\ncorrupted array shown above. Therefore at some point the arrays own destructor\ngets called from `zend_hash_destroy()` which was overwritten with user supplied\ncontents:\n \n```c\nZEND_API void ZEND_FASTCALL zend_hash_destroy(HashTable *ht)\n{\n// ...\n1231 \t\t\t\tif (HT_IS_WITHOUT_HOLES(ht)) {\n1232 \t\t\t\t\tdo {\n1233 \t\t\t\t\t\tht-\u003epDestructor(\u0026p-\u003eval);\n1234 \t\t\t\t\t} while (++p != end);\n1235 \t\t\t\t} else {\n// ...\n```\n\n\n# PoC\n\nThe following PoC exploit was developed for PHP 7.0.14 shipped with the\nArchlinux (x64) distribution:\n\n    $ uname -a\n    Linux box01 4.8.13-1-ARCH #1 SMP PREEMPT Fri Dec 9 07:24:34 CET 2016 x86_64 GNU/Linux\n    $ php --version\n    PHP 7.0.14 (cli) (built: Dec  7 2016 17:11:27) ( NTS )\n    Copyright (c) 1997-2016 The PHP Group\n    Zend Engine v3.0.0, Copyright (c) 1998-2016 Zend Technologies\n\nFor the PoC `exploit.py` ([3]) to work you'll need the PHP test script\n`test.php` ([1]) as well as the master payload file `payload.master` ([2])\nto be placed in the same directory.\nThe PoC contains ROP gadgets for php-7.0.13-* and php-7.0.14 of Arch linux.\nUncomment them as needed.\n\n    $ python exploit.py\n    [............... \u003cgnome-calculator pops open!\u003e ......]\n\nUpon success `gnome-calculator` should be executed. You may want to replace\n`gnome-calculator` with sth. else like, f.e. `touch a` in `epxloit.py` in case\nyou want to test this without `gnome-calculator` present.\n\n\n# References\n\n[1](http://hlt99.blinkenshell.org/php/gfhd8763lkjdg3149nop1qyt/test.php)\n[2](http://hlt99.blinkenshell.org/php/gfhd8763lkjdg3149nop1qyt/payload.master)\n[3](http://hlt99.blinkenshell.org/php/gfhd8763lkjdg3149nop1qyt/exploit.py)\n\n\n# PHP versions known to be affected\n\n7.0.13 (Arch Linux)\n7.0.13-* (Arch Linux)\n7.0.14 (Arch Linux)\nmaster on Github (as of commit 40727d7ce9)\n\nVersions prior to 7.0.13 have not been tested.\n\n\n\n# Reporters\n\nrc0r \u003chlt99@blinkenshell.org\u003e\nHenri Salo from Nixu Corporation\n\n\n# Thanks\n\nA very big thank you goes to Kapsi internet-käyttäjät ry for providing\nvaluable fuzzing resources!","vulnerability_information_html":"\u003cp\u003eThe following is a copy of the bug report at \u003ca title=\"https://bugs.php.net/bug.php?id=73832\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D73832\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=73832\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eThere was found a bug showing that PHP uses uninitialized memory during\u003cbr\u003e\ncalls to \u003ccode\u003eunserialize()\u003c/code\u003e. As the following report shows, the payload supplied\u003cbr\u003e\nto \u003ccode\u003eunserialize()\u003c/code\u003e may control this uninitialized memory region and thus may\u003cbr\u003e\nbe used to trick PHP into operating on faked objects and calling attacker\u003cbr\u003e\ncontrolled destructor function pointers. The supplied proof of concept exploit\u003cbr\u003e\npractically demonstrates the issue by executing arbitrary code solely by\u003cbr\u003e\npassing a specially crafted string to \u003ccode\u003eunserialize()\u003c/code\u003e. Even though this\u003cbr\u003e\nparticular demo exploit only works locally this flaw is very likely to also\u003cbr\u003e\nallow for remote code execution.\u003c/p\u003e\n\n\u003cp\u003eThis bug was found using \u003ccode\u003eafl-fuzz\u003c/code\u003e / \u003ccode\u003eafl-utils\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch1 id=\"analysis\"\u003eAnalysis\u003c/h1\u003e\n\n\u003cp\u003eThe following shows a short gdb dump of the flaw in a custom-built PHP (git\u003cbr\u003e\nmaster on 40727d7ce9) with debugging symbols ([1], [2]):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gdb ./sapi/cli/php\ngdb\u0026gt; r test.php payload.master\n[...]\nFatal error: Possible integer overflow in memory allocation (2736264714 * 32 + 32) in test.php on line 6\n\nProgram received signal SIGSEGV, Segmentation fault.\ngdb\u0026gt; i r\nrax            0x7ffff7fb673c   140737353836348\nrbx            0x3030303030303030   3472328296227680304\nrcx            0xf6d9   63193\nrdx            0x1cb8c30    30116912\nrsi            0x0  0\nrdi            0x3030303030303030   3472328296227680304\nrbp            0x30303030   0x30303030\nrsp            0x7fffffffc080   0x7fffffffc080\nr8             0x7ffff7fb6740   140737353836352\nr9             0x1cb4d00    30100736\nr10            0xeb 235\nr11            0x206    518\nr12            0x1c96ad8    29977304\nr13            0x30303030   808464432\nr14            0x7ffff167be00   140737243495936\nr15            0x3030303030303030   3472328296227680304         \u0026lt;\u0026lt; !!!\nrip            0x10b63d7    0x10b63d7 \u0026lt;zend_hash_destroy+327\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\ngdb\u0026gt; x/i $rip\n=\u0026gt; 0x10b63d7 \u0026lt;zend_hash_destroy+327\u0026gt;:   callq  *%r15\ngdb\u0026gt; bt\n#0  0x00000000010b63d7 in zend_hash_destroy (ht=\u0026lt;optimized out\u0026gt;) at Zend/zend_hash.c:1233\n#1  0x00000000010b7914 in zend_array_destroy (ht=0x7ffff167be00) at Zend/zend_hash.c:1293\n#2  0x000000000106f59e in _zval_dtor_func (p=0x7ffff167be00) at Zend/zend_variables.c:43\n#3  0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u0026lt;optimized out\u0026gt;) at Zend/zend_variables.h:49\n#4  zend_array_destroy (ht=\u0026lt;optimized out\u0026gt;) at Zend/zend_hash.c:1303\n#5  0x000000000106f59e in _zval_dtor_func (p=0x7ffff167bce8) at Zend/zend_variables.c:43\n#6  0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u0026lt;optimized out\u0026gt;) at Zend/zend_variables.h:49\n#7  zend_array_destroy (ht=\u0026lt;optimized out\u0026gt;) at Zend/zend_hash.c:1303\n[...]\n#83 0x000000000106f59e in _zval_dtor_func (p=0x7ffff1656540) at Zend/zend_variables.c:43\n#84 0x00000000010b708e in i_zval_ptr_dtor (zval_ptr=\u0026lt;optimized out\u0026gt;) at Zend/zend_variables.h:49\n#85 zend_array_destroy (ht=\u0026lt;optimized out\u0026gt;) at Zend/zend_hash.c:1303\n#86 0x000000000106f59e in _zval_dtor_func (p=0x7ffff1656428) at Zend/zend_variables.c:43\n#87 0x00000000010b7323 in i_zval_ptr_dtor (zval_ptr=\u0026lt;optimized out\u0026gt;) at Zend/zend_variables.h:49\n#88 zend_array_destroy (ht=\u0026lt;optimized out\u0026gt;) at Zend/zend_hash.c:1307\n#89 0x0000000001137a3d in zend_object_std_dtor (object=0x7ffff165c960) at Zend/zend_objects.c:60\n#90 0x0000000001147fdf in zend_objects_store_free_object_storage (objects=\u0026lt;optimized out\u0026gt;) at Zend/zend_objects_API.c:99\n#91 0x000000000103ce3b in shutdown_executor () at Zend/zend_execute_API.c:359\n#92 0x0000000001073599 in zend_deactivate () at Zend/zend.c:997\n#93 0x0000000000f27ff1 in php_request_shutdown (dummy=\u0026lt;optimized out\u0026gt;) at main/main.c:1873\n#94 0x0000000001355e25 in do_cli (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at sapi/cli/php_cli.c:1161\n#95 0x00000000013533d5 in main (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at sapi/cli/php_cli.c:1387\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSome more in-depth debugging walk through follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gdb ./sapi/cli/php\ngdb\u0026gt; b zend_hash_destroy\ngdb\u0026gt; ign 1 2\ngdb\u0026gt; r test.php payload.master\ngdb\u0026gt; p ht\n$6 = (HashTable *) 0x7ffff167be00\ngdb\u0026gt; p *ht\n$7 = {\n  gc = {\n    refcount = 0, \n    u = {\n      v = {\n        type = 1 \u0026#39;\\001\u0026#39;, \n        flags = 0 \u0026#39;\\000\u0026#39;, \n        gc_info = 32768\n      }, \n      type_info = 2147483649\n    }\n  }, \n  u = {\n    v = {\n      flags = 18 \u0026#39;\\022\u0026#39;, \n      nApplyCount = 0 \u0026#39;\\000\u0026#39;, \n      nIteratorsCount = 0 \u0026#39;\\000\u0026#39;, \n      consistency = 0 \u0026#39;\\000\u0026#39;\n    }, \n    flags = 18\n  }, \n  nTableMask = 808464432, \n  arData = 0x3030303030303030, \n  nNumUsed = 808464432, \n  nNumOfElements = 808464432, \n  nTableSize = 808464432, \n  nInternalPointer = 808464432, \n  nNextFreeElement = 3472328296227680304, \n  pDestructor = 0x3030303030303030\n}\ngdb\u0026gt; awatch *0x7ffff167be00\ngdb\u0026gt; dis 1\ngdb\u0026gt; r\nHardware access (read/write) watchpoint 2: *0x7ffff167be00\nValue = 808464432\n0x00007ffff5103d44 in __memmove_sse2_unaligned_erms () from /usr/lib/libc.so.6\ngdb\u0026gt; x/20x 0x00007ffff167be00\n0x7ffff167be00: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be10: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be20: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be30: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be40: 0x30303030  0x30303030  0x30303030  0x30303030\ngdb\u0026gt; c // (multiple times)\n[...]\nHardware access (read/write) watchpoint 2: *0x7ffff167be00\n\nValue = -244859336\n0x0000000000fdcacb in zend_mm_alloc_small (size=\u0026lt;optimized out\u0026gt;, heap=\u0026lt;optimized out\u0026gt;, bin_num=\u0026lt;optimized out\u0026gt;) at Zend/zend_alloc.c:1261\n1261            heap-\u0026gt;free_slot[bin_num] = p-\u0026gt;next_free_slot;\n\u0026gt;\u0026gt;\u0026gt; bt\n#0  0x0000000000fdcacb in zend_mm_alloc_small (size=\u0026lt;optimized out\u0026gt;, heap=\u0026lt;optimized out\u0026gt;, bin_num=\u0026lt;optimized out\u0026gt;) at Zend/zend_alloc.c:1261\n#1  _emalloc_56 () at Zend/zend_alloc.c:2336\n#2  0x000000000107f6f7 in _array_init (arg=0x7ffff16673c0, size=2736264714) at Zend/zend_API.c:1060\n#3  0x0000000000e23888 in php_var_unserialize_internal (rval=\u0026lt;optimized out\u0026gt;, p=\u0026lt;optimized out\u0026gt;, max=\u0026lt;optimized out\u0026gt;, var_hash=\u0026lt;optimized out\u0026gt;) at ext/standard/var_unserializer.re:788\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFrom the above backtrace one can see PHP tries to allocate memory for a\u003cbr\u003e\n\u003ccode\u003ezend_array\u003c/code\u003e of very large length corresponding to \u003ccode\u003ea:9000111000000010:{...\u003c/code\u003e\u003cbr\u003e\nin \u003ccode\u003epayload.master\u003c/code\u003e ([2]).\u003cbr\u003e\nThis allocation fails a bit later because of an integer overflow in the size\u003cbr\u003e\nparameter that is detected in \u003ccode\u003ezend_hash_check_size()\u003c/code\u003e called from\u003cbr\u003e\n\u003ccode\u003e_zend_hash_init()\u003c/code\u003e. As soon as this overflow is detected, PHP starts to\u003cbr\u003e\nshut down. At this point the contents of the partially initialized \u003ccode\u003ezend_array\u003c/code\u003e\u003cbr\u003e\nlook as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003egdb\u0026gt; c\nFatal error: Possible integer overflow in memory allocation (2736264714 * 32 + 32) in test.php on line 6\nHardware access (read/write) watchpoint 2: *0x7ffff167be00\n\nValue = 1\n0x00000000010b6f6e in i_zval_ptr_dtor (zval_ptr=\u0026lt;optimized out\u0026gt;) at Zend/zend_variables.h:48\n48          if (!--GC_REFCOUNT(ref)) {\ngdb\u0026gt; x/16x 0x00007ffff167be00\n0x7ffff167be00: 0x00000001  0x00008007  0x00000012  0x30303030\n0x7ffff167be10: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be20: 0x30303030  0x30303030  0x30303030  0x30303030\n0x7ffff167be30: 0x30303030  0x30303030  0xf167be70  0x00007fff \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDuring shutdown PHP attempts to destroy its internal objects as well as the\u003cbr\u003e\ncorrupted array shown above. Therefore at some point the arrays own destructor\u003cbr\u003e\ngets called from \u003ccode\u003ezend_hash_destroy()\u003c/code\u003e which was overwritten with user supplied\u003cbr\u003e\ncontents:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eZEND_API\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eZEND_FASTCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003ezend_hash_destroy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHashTable\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eht\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ...\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1231\u003c/span\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eHT_IS_WITHOUT_HOLES\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eht\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1232\u003c/span\u003e                    \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1233\u003c/span\u003e                        \u003cspan class=\"n\"\u003eht\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003epDestructor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1234\u003c/span\u003e                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e1235\u003c/span\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// ...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003cp\u003eThe following PoC exploit was developed for PHP 7.0.14 shipped with the\u003cbr\u003e\nArchlinux (x64) distribution:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ uname -a\nLinux box01 4.8.13-1-ARCH #1 SMP PREEMPT Fri Dec 9 07:24:34 CET 2016 x86_64 GNU/Linux\n$ php --version\nPHP 7.0.14 (cli) (built: Dec  7 2016 17:11:27) ( NTS )\nCopyright (c) 1997-2016 The PHP Group\nZend Engine v3.0.0, Copyright (c) 1998-2016 Zend Technologies\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor the PoC \u003ccode\u003eexploit.py\u003c/code\u003e ([3]) to work you\u0026#39;ll need the PHP test script\u003cbr\u003e\n\u003ccode\u003etest.php\u003c/code\u003e ([1]) as well as the master payload file \u003ccode\u003epayload.master\u003c/code\u003e ([2])\u003cbr\u003e\nto be placed in the same directory.\u003cbr\u003e\nThe PoC contains ROP gadgets for php-7.0.13-* and php-7.0.14 of Arch linux.\u003cbr\u003e\nUncomment them as needed.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ python exploit.py\n[............... \u0026lt;gnome-calculator pops open!\u0026gt; ......]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUpon success \u003ccode\u003egnome-calculator\u003c/code\u003e should be executed. You may want to replace\u003cbr\u003e\n\u003ccode\u003egnome-calculator\u003c/code\u003e with sth. else like, f.e. \u003ccode\u003etouch a\u003c/code\u003e in \u003ccode\u003eepxloit.py\u003c/code\u003e in case\u003cbr\u003e\nyou want to test this without \u003ccode\u003egnome-calculator\u003c/code\u003e present.\u003c/p\u003e\n\n\u003ch1 id=\"references\"\u003eReferences\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fhlt99.blinkenshell.org%2Fphp%2Fgfhd8763lkjdg3149nop1qyt%2Ftest.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fhlt99.blinkenshell.org%2Fphp%2Fgfhd8763lkjdg3149nop1qyt%2Fpayload.master\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fhlt99.blinkenshell.org%2Fphp%2Fgfhd8763lkjdg3149nop1qyt%2Fexploit.py\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"php-versions-known-to-be-affected\"\u003ePHP versions known to be affected\u003c/h1\u003e\n\n\u003cp\u003e7.0.13 (Arch Linux)\u003cbr\u003e\n7.0.13-* (Arch Linux)\u003cbr\u003e\n7.0.14 (Arch Linux)\u003cbr\u003e\nmaster on Github (as of commit 40727d7ce9)\u003c/p\u003e\n\n\u003cp\u003eVersions prior to 7.0.13 have not been tested.\u003c/p\u003e\n\n\u003ch1 id=\"reporters\"\u003eReporters\u003c/h1\u003e\n\n\u003cp\u003erc0r \u003ca title=\"hlt99@blinkenshell.org\" href=\"mailto:hlt99@blinkenshell.org\" rel=\"nofollow noopener noreferrer\"\u003ehlt99@blinkenshell.org\u003c/a\u003e\u003cbr\u003e\nHenri Salo from Nixu Corporation\u003c/p\u003e\n\n\u003ch1 id=\"thanks\"\u003eThanks\u003c/h1\u003e\n\n\u003cp\u003eA very big thank you goes to Kapsi internet-käyttäjät ry for providing\u003cbr\u003e\nvaluable fuzzing resources!\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-01T18:41:44.738Z","allow_singular_disclosure_after":-110282984.56615342,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","virgindad","spetr0x"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1401290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"██████████\n█████████\n* ██████████\n* ██████████\n\nThanks!","markdown_message":"\u003cp\u003e██████████\u003cbr\u003e\n█████████\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e██████████\u003c/li\u003e\n\u003cli\u003e██████████\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-05T11:31:27.385Z","updated_at":"2017-05-31T18:04:19.255Z","actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[CVE-2017-5340](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5340) was assigned for this issue.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2017-5340\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVE-2017-5340\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was assigned for this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T16:26:21.023Z","updated_at":"2017-01-18T16:26:21.023Z","actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698599,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T18:37:21.198Z","updated_at":"2017-05-24T18:37:21.198Z","cve_ids":["CVE-2017-5340"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698606,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T18:39:31.314Z","updated_at":"2017-05-24T18:39:31.314Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":17570,"new_severity_id":44641},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698607,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-24T18:39:46.265Z","updated_at":"2017-05-24T18:39:46.265Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"rc0r","url":"/rc0r"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1698618,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Downgraded from \"High\" to \"Medium\" as [unserialize](http://php.net/manual/en/function.unserialize.php) issues are classified there based upon the current [PHP security classification](https://wiki.php.net/security#medium_severity).\n\n\u003e ██████\n\n███████\n\nThank you for the finding and your patience!","markdown_message":"\u003cp\u003eDowngraded from \u0026quot;High\u0026quot; to \u0026quot;Medium\u0026quot; as \u003ca href=\"/redirect?url=http%3A%2F%2Fphp.net%2Fmanual%2Fen%2Ffunction.unserialize.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eunserialize\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e issues are classified there based upon the current \u003ca href=\"/redirect?url=https%3A%2F%2Fwiki.php.net%2Fsecurity%23medium_severity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePHP security classification\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e██████\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e███████\u003c/p\u003e\n\n\u003cp\u003eThank you for the finding and your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-24T18:43:14.171Z","updated_at":"2017-05-31T18:04:44.118Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"rc0r","url":"/rc0r"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1715034,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Before publicly disclosing this report could you please redact the non-technical comments to the report?\n\nThanks, rc0r!","markdown_message":"\u003cp\u003eBefore publicly disclosing this report could you please redact the non-technical comments to the report?\u003c/p\u003e\n\n\u003cp\u003eThanks, rc0r!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-31T05:59:39.813Z","updated_at":"2017-05-31T05:59:39.813Z","actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1717191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rc0r - No problem. Sufficiently redacted now?","markdown_message":"\u003cp\u003e\u003ca href=\"/rc0r\"\u003e@rc0r\u003c/a\u003e - No problem. Sufficiently redacted now?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-31T18:05:19.207Z","updated_at":"2017-05-31T18:05:19.207Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1721004,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, thank you!","markdown_message":"\u003cp\u003eYes, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-01T12:39:22.263Z","updated_at":"2017-06-01T12:39:22.263Z","actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1722564,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-01T18:41:44.691Z","updated_at":"2017-06-01T18:41:44.691Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1722565,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-01T18:41:51.225Z","updated_at":"2017-06-01T18:41:51.225Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}