{"id":206227,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDYyMjc=","url":"https://hackerone.com/reports/206227","title":"Remote Code Execution on Git.imgur-dev.com ","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-02-14T04:59:37.000Z","submitted_at":"2017-02-14T04:59:37.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"orange","url":"/orange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/051/3495315121602d0de9c4f6728fef03bc3b41d3fe_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":638,"url":"https://hackerone.com/imgur","handle":"imgur","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Imgur","twitter_handle":"imgur","website":"http://imgur.com","about":"The most awesome images on the Internet."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-16T17:19:46.735Z","bug_reporter_agreed_on_going_public_at":"2017-03-17T17:19:39.778Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, Imgur Security Team:\n\nI just found that your GitHub Enterprise Server(https://git.imgur-dev.com/) didn't patch to the latest version(2.8.7). And there is a Rails static key leads to RCE vulnerability!\n\nYou can see the PoC from my screenshots :)","vulnerability_information_html":"\u003cp\u003eHi, Imgur Security Team:\u003c/p\u003e\n\n\u003cp\u003eI just found that your GitHub Enterprise Server(\u003ca title=\"https://git.imgur-dev.com/\" href=\"/redirect?url=https%3A%2F%2Fgit.imgur-dev.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://git.imgur-dev.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) didn\u0026#39;t patch to the latest version(2.8.7). And there is a Rails static key leads to RCE vulnerability!\u003c/p\u003e\n\n\u003cp\u003eYou can see the PoC from my screenshots :)\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":160665,"file_name":"2017-02-14_124553.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/160/665/044e4adab90046e7e10f5782b1b6cf00cd60fad9/2017-02-14_124553.png?response-content-disposition=attachment%3B%20filename%3D%222017-02-14_124553.png%22%3B%20filename%2A%3DUTF-8%27%272017-02-14_124553.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=e1afd0bd3e32483ae16966885f488e17fcccbe81b4587bef338682c5be9ea7d3","file_size":14344,"type":"image/png"},{"id":160666,"file_name":"2017-02-14_124702.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/160/666/9c1ee6fb9178211a1b1618609e3cb61ba4a9724a/2017-02-14_124702.png?response-content-disposition=attachment%3B%20filename%3D%222017-02-14_124702.png%22%3B%20filename%2A%3DUTF-8%27%272017-02-14_124702.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045515Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=cd37d4e58e02085bb8253a05ebf6718ed48f308aa4feabdca539f4c255c60efa","file_size":44059,"type":"image/png"}],"allow_singular_disclosure_at":"2017-04-16T17:19:39.833Z","allow_singular_disclosure_after":-116854535.7448837,"singular_disclosure_allowed":true,"vote_count":114,"voters":["delimitry","nytr0gen","sp1d3rs","rijalrojan","hunter","notnaffy","michiel","orange","ameyanekar","bl4de","and 104 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1484140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we're a small team and sometimes it takes us a while to verify all reports. Please don't ask for updates as these take time and effort away from the reports we're working through and make our response time slower across the board. Thanks - we'll be in touch soon!","markdown_message":"\u003cp\u003eHello! Thanks for taking the time to make this report to the Imgur security team! We look forward to reviewing and assessing the risk of this vuln. In the meantime, we ask that you sit tight while we get to it - we\u0026#39;re a small team and sometimes it takes us a while to verify all reports. Please don\u0026#39;t ask for updates as these take time and effort away from the reports we\u0026#39;re working through and make our response time slower across the board. Thanks - we\u0026#39;ll be in touch soon!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-02-14T04:59:37.264Z","updated_at":"2017-02-14T04:59:37.264Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1484178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.s. I think this site is owned by Imgur. I have checked the SSL Certificate and the GIT repositories in GitHub Enterprise Server. It seems here are all the Imgur source code.\n\nThanks a lot!","markdown_message":"\u003cp\u003eP.s. I think this site is owned by Imgur. I have checked the SSL Certificate and the GIT repositories in GitHub Enterprise Server. It seems here are all the Imgur source code.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-14T06:01:20.887Z","updated_at":"2017-02-14T06:01:20.887Z","actor":{"username":"orange","cleared":false,"url":"/orange","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/051/3495315121602d0de9c4f6728fef03bc3b41d3fe_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1485292,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!","markdown_message":"\u003cp\u003eWe have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-14T17:45:08.100Z","updated_at":"2017-02-14T17:45:08.100Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1485405,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! We'll be in touch about a bounty soon.","markdown_message":"\u003cp\u003eWe have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! We\u0026#39;ll be in touch about a bounty soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-14T18:33:23.407Z","updated_at":"2017-02-14T18:33:23.407Z","actor":{"username":"kcramer","cleared":false,"url":"/kcramer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"orange","url":"/orange"},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1494486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, are there any updates?","markdown_message":"\u003cp\u003eHi, are there any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-20T09:11:20.039Z","updated_at":"2017-02-20T09:11:20.039Z","actor":{"username":"orange","cleared":false,"url":"/orange","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/051/3495315121602d0de9c4f6728fef03bc3b41d3fe_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1499697,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @orange - we've settled on a $2500 award for this report. Thanks for making us aware of the issue and we hope you'll report any issues to us in the future! Have a good week.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/orange\"\u003e@orange\u003c/a\u003e - we\u0026#39;ve settled on a $2500 award for this report. Thanks for making us aware of the issue and we hope you\u0026#39;ll report any issues to us in the future! Have a good week.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T17:12:20.694Z","updated_at":"2017-02-22T17:12:20.694Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"imgur","collaborator":{"username":"orange","url":"/orange"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548177,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Please disclose it :)","markdown_message":"\u003cp\u003ePlease disclose it :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-17T17:19:39.806Z","updated_at":"2017-03-17T17:19:39.806Z","first_to_agree":true,"actor":{"username":"orange","cleared":false,"url":"/orange","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/051/3495315121602d0de9c4f6728fef03bc3b41d3fe_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1614059,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-16T17:19:46.751Z","updated_at":"2017-04-16T17:19:46.751Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3788,"category":"researcher","content":"GitHub Enterprise Rails static key issue.\n\nThe patch released on date 2017/01/31 (https://enterprise.github.com/releases/2.8.7/notes), but two weeks pass, it seems still vulnerable.\nI think this server is very critical for Imgur, so I reported to the vendor.\n\nThanks to Imgur Security Team's kindness :)\n\nP.s. Also thanks to @iblue and his amazing finding!\nhttp://exablue.de/blog/2017-03-15-github-enterprise-remote-code-execution.html","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eGitHub Enterprise Rails static key issue.\u003c/p\u003e\n\n\u003cp\u003eThe patch released on date 2017/01/31 (\u003ca title=\"https://enterprise.github.com/releases/2.8.7/notes\" href=\"/redirect?url=https%3A%2F%2Fenterprise.github.com%2Freleases%2F2.8.7%2Fnotes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://enterprise.github.com/releases/2.8.7/notes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), but two weeks pass, it seems still vulnerable.\u003cbr\u003e\nI think this server is very critical for Imgur, so I reported to the vendor.\u003c/p\u003e\n\n\u003cp\u003eThanks to Imgur Security Team\u0026#39;s kindness :)\u003c/p\u003e\n\n\u003cp\u003eP.s. Also thanks to \u003ca href=\"/iblue\"\u003e@iblue\u003c/a\u003e and his amazing finding!\u003cbr\u003e\n\u003ca title=\"http://exablue.de/blog/2017-03-15-github-enterprise-remote-code-execution.html\" href=\"/redirect?url=http%3A%2F%2Fexablue.de%2Fblog%2F2017-03-15-github-enterprise-remote-code-execution.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://exablue.de/blog/2017-03-15-github-enterprise-remote-code-execution.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}