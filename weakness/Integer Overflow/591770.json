{"id":591770,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTE3NzA=","url":"https://hackerone.com/reports/591770","title":"Signed integer overflow in tool_progress_cb()","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2019-05-28T18:58:13.144Z","submitted_at":"2019-05-28T18:58:13.144Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-04T20:58:05.194Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:44:45.270Z","team_member_agreed_on_going_public_at":"2019-10-04T20:58:05.109Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nGood afternoon curl security! I built this curl from commit 8144ba38c383718355d8af2ed8330414edcbbc83. We discovered a signed integer overflow in tool_progress_cb().\n\n## Steps To Reproduce:\nCompiled with the Undefined Behavior Sanitizer enabled. Ran with the following command line:\n`./curl -q -# -T- -C- file:///dev/null`\n\n## Supporting Material/References:\n```\ntool_cb_prg.c:129:22: runtime error: signed integer overflow: 9223372036854775807 - -1 cannot be represented in type 'long'\n    #0 0x42fc40 in tool_progress_cb /root/curl/src/tool_cb_prg.c:129:22\n    #1 0x562090 in Curl_pgrsUpdate /root/curl/lib/progress.c:484:16\n    #2 0x4d3da1 in multi_runsingle /root/curl/lib/multi.c:2009:29\n    #3 0x4cce1b in curl_multi_perform /root/curl/lib/multi.c:2066:14\n    #4 0x4a7740 in easy_transfer /root/curl/lib/easy.c:624:15\n    #5 0x4a7740 in easy_perform /root/curl/lib/easy.c:718\n    #6 0x4a7740 in curl_easy_perform /root/curl/lib/easy.c:737\n    #7 0x47fbb6 in operate_do /root/curl/src/tool_operate.c:1604:20\n    #8 0x46a606 in operate /root/curl/src/tool_operate.c:2098:20\n    #9 0x469176 in main /root/curl/src/tool_main.c:326:14\n    #10 0x7f9199d682e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\n    #11 0x409fe9 in _start (/root/curl/src/curl+0x409fe9)\n\ntool_cb_prg.c:135:22: runtime error: signed integer overflow: 9223372036854775807 - -1 cannot be represented in type 'long'\n    #0 0x42fe09 in tool_progress_cb /root/curl/src/tool_cb_prg.c:135:22\n    #1 0x562090 in Curl_pgrsUpdate /root/curl/lib/progress.c:484:16\n    #2 0x4d3da1 in multi_runsingle /root/curl/lib/multi.c:2009:29\n    #3 0x4cce1b in curl_multi_perform /root/curl/lib/multi.c:2066:14\n    #4 0x4a7740 in easy_transfer /root/curl/lib/easy.c:624:15\n    #5 0x4a7740 in easy_perform /root/curl/lib/easy.c:718\n    #6 0x4a7740 in curl_easy_perform /root/curl/lib/easy.c:737\n    #7 0x47fbb6 in operate_do /root/curl/src/tool_operate.c:1604:20\n    #8 0x46a606 in operate /root/curl/src/tool_operate.c:2098:20\n    #9 0x469176 in main /root/curl/src/tool_main.c:326:14\n    #10 0x7f9199d682e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\n    #11 0x409fe9 in _start (/root/curl/src/curl+0x409fe9)\n\n######################################################################################################################################################################################################################################################### 100.0%\n\n```\n\n## Impact\n\nAn integer overflow or wraparound occurs when an integer value is incremented to a value that is too large to store in the associated representation. When this occurs, the value may wrap to become a very small or negative number. While this may be intended behavior in circumstances that rely on wrapping, it can have security consequences if the wrap is unexpected. This is especially the case if the integer overflow can be triggered using user-supplied inputs. This becomes security-critical when the result is used to control looping, make a security decision, or determine the offset or size in behaviors such as memory allocation, copying, concatenation, etc.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eGood afternoon curl security! I built this curl from commit 8144ba38c383718355d8af2ed8330414edcbbc83. We discovered a signed integer overflow in tool_progress_cb().\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eCompiled with the Undefined Behavior Sanitizer enabled. Ran with the following command line:\u003cbr\u003e\n\u003ccode\u003e./curl -q -# -T- -C- file:///dev/null\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etool_cb_prg.c:129:22: runtime error: signed integer overflow: 9223372036854775807 - -1 cannot be represented in type \u0026#39;long\u0026#39;\n    #0 0x42fc40 in tool_progress_cb /root/curl/src/tool_cb_prg.c:129:22\n    #1 0x562090 in Curl_pgrsUpdate /root/curl/lib/progress.c:484:16\n    #2 0x4d3da1 in multi_runsingle /root/curl/lib/multi.c:2009:29\n    #3 0x4cce1b in curl_multi_perform /root/curl/lib/multi.c:2066:14\n    #4 0x4a7740 in easy_transfer /root/curl/lib/easy.c:624:15\n    #5 0x4a7740 in easy_perform /root/curl/lib/easy.c:718\n    #6 0x4a7740 in curl_easy_perform /root/curl/lib/easy.c:737\n    #7 0x47fbb6 in operate_do /root/curl/src/tool_operate.c:1604:20\n    #8 0x46a606 in operate /root/curl/src/tool_operate.c:2098:20\n    #9 0x469176 in main /root/curl/src/tool_main.c:326:14\n    #10 0x7f9199d682e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\n    #11 0x409fe9 in _start (/root/curl/src/curl+0x409fe9)\n\ntool_cb_prg.c:135:22: runtime error: signed integer overflow: 9223372036854775807 - -1 cannot be represented in type \u0026#39;long\u0026#39;\n    #0 0x42fe09 in tool_progress_cb /root/curl/src/tool_cb_prg.c:135:22\n    #1 0x562090 in Curl_pgrsUpdate /root/curl/lib/progress.c:484:16\n    #2 0x4d3da1 in multi_runsingle /root/curl/lib/multi.c:2009:29\n    #3 0x4cce1b in curl_multi_perform /root/curl/lib/multi.c:2066:14\n    #4 0x4a7740 in easy_transfer /root/curl/lib/easy.c:624:15\n    #5 0x4a7740 in easy_perform /root/curl/lib/easy.c:718\n    #6 0x4a7740 in curl_easy_perform /root/curl/lib/easy.c:737\n    #7 0x47fbb6 in operate_do /root/curl/src/tool_operate.c:1604:20\n    #8 0x46a606 in operate /root/curl/src/tool_operate.c:2098:20\n    #9 0x469176 in main /root/curl/src/tool_main.c:326:14\n    #10 0x7f9199d682e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\n    #11 0x409fe9 in _start (/root/curl/src/curl+0x409fe9)\n\n######################################################################################################################################################################################################################################################### 100.0%\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn integer overflow or wraparound occurs when an integer value is incremented to a value that is too large to store in the associated representation. When this occurs, the value may wrap to become a very small or negative number. While this may be intended behavior in circumstances that rely on wrapping, it can have security consequences if the wrap is unexpected. This is especially the case if the integer overflow can be triggered using user-supplied inputs. This becomes security-critical when the result is used to control looping, make a security decision, or determine the offset or size in behaviors such as memory allocation, copying, concatenation, etc.\u003c/p\u003e\n","weakness":{"id":15,"name":"Integer Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["geeknik","cr4xerbik4sh","clubby789","heltor"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4943557,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-28T18:58:30.163Z","updated_at":"2019-05-28T18:58:30.163Z","additional_data":{"old_title":"Signed integer overflow in ","new_title":"Signed integer overflow in tool_progress_cb()"},"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4944031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. We'll investigate the possible security angle of this...","markdown_message":"\u003cp\u003eThanks. We\u0026#39;ll investigate the possible security angle of this...\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T20:33:35.072Z","updated_at":"2019-05-28T20:33:35.072Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4966713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can't see any security problem with this. It will just risk making the progress bar not appear as intended.","markdown_message":"\u003cp\u003eI can\u0026#39;t see any security problem with this. It will just risk making the progress bar not appear as intended.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-01T21:06:42.349Z","updated_at":"2019-06-01T21:06:42.349Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4966720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dgustafsson I think you can proceed with your patch from the security mailing list and make a PR out of that, credit ing @geeknik for the discover. We should probably also make a test case out of the recipe to repro this.","markdown_message":"\u003cp\u003e\u003ca href=\"/dgustafsson\"\u003e@dgustafsson\u003c/a\u003e I think you can proceed with your patch from the security mailing list and make a PR out of that, credit ing \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e for the discover. We should probably also make a test case out of the recipe to repro this.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-01T21:09:30.523Z","updated_at":"2019-06-01T21:09:30.523Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4967819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am back from travelling on Monday, will go ahead with patch then.","markdown_message":"\u003cp\u003eI am back from travelling on Monday, will go ahead with patch then.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-02T08:40:07.561Z","updated_at":"2019-06-02T08:40:07.561Z","actor":{"username":"dgustafsson","cleared":false,"url":"/dgustafsson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4969302,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-02T14:23:31.128Z","updated_at":"2019-06-02T14:23:31.128Z","additional_data":{"old_severity":null,"new_severity":"None","old_severity_id":null,"new_severity_id":406212},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4969306,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-02T14:24:05.599Z","updated_at":"2019-06-02T14:24:05.599Z","additional_data":{"old_severity":"None","new_severity":"Low","old_severity_id":406212,"new_severity_id":406213},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4969307,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-02T14:24:23.655Z","updated_at":"2019-06-02T14:24:23.655Z","additional_data":{"old_severity":"Low","new_severity":"None","old_severity_id":406213,"new_severity_id":406214},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4969310,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This is indeed an unintended integer overflow that should be fixed, but we cannot find any security vulnerability in relation to it. We will treat it as a \"regular\" bug report and work on a fix using the regular means.","markdown_message":"\u003cp\u003eThis is indeed an unintended integer overflow that should be fixed, but we cannot find any security vulnerability in relation to it. We will treat it as a \u0026quot;regular\u0026quot; bug report and work on a fix using the regular means.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-02T14:25:40.758Z","updated_at":"2019-06-02T14:25:40.758Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5960825,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:44:45.317Z","updated_at":"2019-10-04T16:44:45.317Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5962727,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T20:58:05.145Z","updated_at":"2019-10-04T20:58:05.145Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5962728,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T20:58:05.217Z","updated_at":"2019-10-04T20:58:05.217Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}