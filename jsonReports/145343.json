{"id":145343,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDUzNDM=","url":"https://hackerone.com/reports/145343","title":"Possible RCE","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-17T10:48:53.671Z","submitted_at":"2016-06-17T10:48:53.671Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-08T13:26:03.865Z","bug_reporter_agreed_on_going_public_at":"2017-07-23T22:33:41.062Z","team_member_agreed_on_going_public_at":"2018-03-08T13:26:03.789Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI just quickly took a glance, I am not entirely sure or didn't get a chance to test it but it seems there are some serious bugs.\n\nIn */apps/user_ldap/ajax/wizard.php*: \n```php\n36: $action = (string)$_POST['action']; \n```\nand it is called in multiple places. including line 83 \u0026 99. one being `$action($loginName);` \u0026 since \n`$loginName` is defined as:\n\n```php\n$loginName = $_POST['ldap_test_loginname'];\n```\nwould mean an RCE is achievable when $result is called\n```php\n$result = $wizard-\u003e$action($loginName);\n``` \n \nThis is because userinput is used as dynamic function name. ergo, arbitrary functions may be called.\n\nAll an attacker have to send is a POST request with action parameter containing a function name like action=eval\u0026ldap_test_loginname=stufftoexecute\n\nThere is a very little chance the $wizard will stop this because arbritary wakeup \u0026 constract objects may be exploitable. like I said, I didn't get a chance to test this but seems fairly feasible. please think about it and let me know.\n\nThanks,\nP\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI just quickly took a glance, I am not entirely sure or didn\u0026#39;t get a chance to test it but it seems there are some serious bugs.\u003c/p\u003e\n\n\u003cp\u003eIn \u003cem\u003e/apps/user_ldap/ajax/wizard.php\u003c/em\u003e: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e36\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nv\"\u003e$action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;action\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand it is called in multiple places. including line 83 \u0026amp; 99. one being \u003ccode\u003e$action($loginName);\u003c/code\u003e \u0026amp; since \u003cbr\u003e\n\u003ccode\u003e$loginName\u003c/code\u003e is defined as:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$loginName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ldap_test_loginname\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewould mean an RCE is achievable when $result is called\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$wizard\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$action\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loginName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is because userinput is used as dynamic function name. ergo, arbitrary functions may be called.\u003c/p\u003e\n\n\u003cp\u003eAll an attacker have to send is a POST request with action parameter containing a function name like action=eval\u0026amp;ldap_test_loginname=stufftoexecute\u003c/p\u003e\n\n\u003cp\u003eThere is a very little chance the $wizard will stop this because arbritary wakeup \u0026amp; constract objects may be exploitable. like I said, I didn\u0026#39;t get a chance to test this but seems fairly feasible. please think about it and let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nP\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["bugdiscloseguys","kieran","paulos_","geotester","alexoooo"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1018835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-17T10:48:53.881Z","updated_at":"2016-06-17T10:48:53.881Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1018934,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. At the moment we consider this accepted behaviours since CSRF checks as well as a check for admin privileges is in place. As per our threat model we consider it acceptable to allow administrators to execute arbitrary code. (ref https://nextcloud.com/security/threat-model/)","markdown_message":"\u003cp\u003eThanks a lot for your report. At the moment we consider this accepted behaviours since CSRF checks as well as a check for admin privileges is in place. As per our threat model we consider it acceptable to allow administrators to execute arbitrary code. (ref \u003ca title=\"https://nextcloud.com/security/threat-model/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/threat-model/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T11:57:31.843Z","updated_at":"2016-06-17T11:57:31.843Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1861267,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T22:33:41.080Z","updated_at":"2017-07-23T22:33:41.080Z","first_to_agree":true,"actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2473758,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T13:26:03.814Z","updated_at":"2018-03-08T13:26:03.814Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2473759,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T13:26:03.890Z","updated_at":"2018-03-08T13:26:03.890Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}