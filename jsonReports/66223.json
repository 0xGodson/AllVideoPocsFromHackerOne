{"id":66223,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjIyMw==","url":"https://hackerone.com/reports/66223","title":"Two-factor authentication (via SMS)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-06-05T22:22:51.813Z","submitted_at":"2015-06-05T22:22:51.813Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dia2diab","url":"/dia2diab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PAKTzyXvp7W3Bs7oo3BGnVtr/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-06-16T18:45:52.934Z","bug_reporter_agreed_on_going_public_at":"2015-06-15T22:07:41.845Z","team_member_agreed_on_going_public_at":"2015-06-16T18:45:52.359Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Coinbase Security Team\r\n\r\nI just found a problem in Two-factor authentication mechanism, here is the details and how to reproduce this issue:\r\n\r\nI have two accounts with two emails on `coinbase.com` i active `2FA` on the both of two emails with this phone number `+201066462288`.\r\n\r\nFrom `Chrome` i will try to login using my first email `a_diaa_2007@yahoo.com` and now i recieved my code related to this email here `6020930`.\r\n\r\nFrom `FireFox` i will try to do the same thing using my second email `diaa.diab.2012@gmail.com` and now i recieved my second code for the second email `1091566`.\r\n\r\nLogically, the following steps must be excuted to make the two accounts be logged in:\r\n\r\n`a_diaa_2007@yahoo.com` =\u003e `6020930`\r\n`diaa.diab.2012@gmail.com` =\u003e `1091566`\r\n\r\nBut the problem is when i change the two code and emails to be \r\n`a_diaa_2007@yahoo.com` =\u003e `1091566`\r\n`diaa.diab.2012@gmail.com` =\u003e `6020930`\r\n\r\nI found myself be logged in with two accounts and there is no problem there, The exactly problem is you allow accounts that have the same number to be logged in with each other verification code if they request a login via SMS.\r\n\r\nThank you.\r\nDiaa ","vulnerability_information_html":"\u003cp\u003eHello Coinbase Security Team\u003c/p\u003e\n\n\u003cp\u003eI just found a problem in Two-factor authentication mechanism, here is the details and how to reproduce this issue:\u003c/p\u003e\n\n\u003cp\u003eI have two accounts with two emails on \u003ccode\u003ecoinbase.com\u003c/code\u003e i active \u003ccode\u003e2FA\u003c/code\u003e on the both of two emails with this phone number \u003ccode\u003e+201066462288\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eFrom \u003ccode\u003eChrome\u003c/code\u003e i will try to login using my first email \u003ccode\u003ea_diaa_2007@yahoo.com\u003c/code\u003e and now i recieved my code related to this email here \u003ccode\u003e6020930\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eFrom \u003ccode\u003eFireFox\u003c/code\u003e i will try to do the same thing using my second email \u003ccode\u003ediaa.diab.2012@gmail.com\u003c/code\u003e and now i recieved my second code for the second email \u003ccode\u003e1091566\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eLogically, the following steps must be excuted to make the two accounts be logged in:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ea_diaa_2007@yahoo.com\u003c/code\u003e =\u0026gt; \u003ccode\u003e6020930\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003ediaa.diab.2012@gmail.com\u003c/code\u003e =\u0026gt; \u003ccode\u003e1091566\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBut the problem is when i change the two code and emails to be \u003cbr\u003e\n\u003ccode\u003ea_diaa_2007@yahoo.com\u003c/code\u003e =\u0026gt; \u003ccode\u003e1091566\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003ediaa.diab.2012@gmail.com\u003c/code\u003e =\u0026gt; \u003ccode\u003e6020930\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI found myself be logged in with two accounts and there is no problem there, The exactly problem is you allow accounts that have the same number to be logged in with each other verification code if they request a login via SMS.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003cbr\u003e\nDiaa \u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-15T22:07:42.376Z","allow_singular_disclosure_after":-172225629.5621039,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":444604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dia2diab,\n\nI agree that this shouldn't work, but I don't think there's a security issue. Can you describe how this behavior might be exploited?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dia2diab\"\u003e@dia2diab\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI agree that this shouldn\u0026#39;t work, but I don\u0026#39;t think there\u0026#39;s a security issue. Can you describe how this behavior might be exploited?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-08T16:20:01.953Z","updated_at":"2015-06-08T16:20:01.953Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":444974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @aianus \n\n I know there is a low risk and maybe nothing but, This trick can be used by someone who sit beside our victim if he got his password of any accounts by any ways, so he can login and wait after victim be logged in with his other account, the last code that victim will get on his mobile will be shown on the mobile screen, and if the attacker can catch it, he will prevent the victim to be logged in with this code.\n\nIf the user connect his mobile with two coinbase accounts, the 2FA-check must be correct, each code must be valid for its account.\n\nThank you\nDiaa","markdown_message":"\u003cp\u003eHello \u003ca href=\"/aianus\"\u003e@aianus\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI know there is a low risk and maybe nothing but, This trick can be used by someone who sit beside our victim if he got his password of any accounts by any ways, so he can login and wait after victim be logged in with his other account, the last code that victim will get on his mobile will be shown on the mobile screen, and if the attacker can catch it, he will prevent the victim to be logged in with this code.\u003c/p\u003e\n\n\u003cp\u003eIf the user connect his mobile with two coinbase accounts, the 2FA-check must be correct, each code must be valid for its account.\u003c/p\u003e\n\n\u003cp\u003eThank you\u003cbr\u003e\nDiaa\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-08T19:49:43.387Z","updated_at":"2015-06-08T19:49:43.387Z","actor":{"username":"dia2diab","cleared":true,"url":"/dia2diab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PAKTzyXvp7W3Bs7oo3BGnVtr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":444979,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Well if you manage to get your phone number onto the victim's account then you can easily bypass their 2FA regardless of this bug. I'm going to mark as Won't Fix but please let us know if you find anything else.","markdown_message":"\u003cp\u003eWell if you manage to get your phone number onto the victim\u0026#39;s account then you can easily bypass their 2FA regardless of this bug. I\u0026#39;m going to mark as Won\u0026#39;t Fix but please let us know if you find anything else.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-08T19:53:40.558Z","updated_at":"2015-06-08T19:53:40.558Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":444980,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok thanks","markdown_message":"\u003cp\u003eok thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-08T19:54:40.818Z","updated_at":"2015-06-08T19:54:40.818Z","actor":{"username":"dia2diab","cleared":true,"url":"/dia2diab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PAKTzyXvp7W3Bs7oo3BGnVtr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":463285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I recommend to fix this issue but don't give me a bounty.\n\nThank you\nDiaa","markdown_message":"\u003cp\u003eI recommend to fix this issue but don\u0026#39;t give me a bounty.\u003c/p\u003e\n\n\u003cp\u003eThank you\u003cbr\u003e\nDiaa\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-13T23:41:33.355Z","updated_at":"2015-06-13T23:41:33.355Z","actor":{"username":"dia2diab","cleared":true,"url":"/dia2diab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PAKTzyXvp7W3Bs7oo3BGnVtr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":473366,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-15T22:07:41.906Z","updated_at":"2015-06-15T22:07:41.906Z","first_to_agree":true,"actor":{"username":"dia2diab","cleared":true,"url":"/dia2diab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PAKTzyXvp7W3Bs7oo3BGnVtr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T18:45:52.455Z","updated_at":"2015-06-16T18:45:52.455Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474444,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T18:45:52.965Z","updated_at":"2015-06-16T18:45:52.965Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}