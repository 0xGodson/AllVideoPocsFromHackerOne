{"id":205000,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDUwMDA=","url":"https://hackerone.com/reports/205000","title":"Authorization bypass using login by phone option+horizontal escalation possible on Grab Android App","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-02-09T15:59:33.227Z","submitted_at":"2017-02-09T15:59:33.227Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-14T02:54:12.710Z","bug_reporter_agreed_on_going_public_at":"2017-09-13T16:12:29.201Z","team_member_agreed_on_going_public_at":"2017-09-14T02:54:12.646Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description:**\nAfter my previous report about 2FA bypass on the Profile Edit endpoint i was interested to find enpoint, which will allow me horizontal privileges escalation.\nSo, I found the endpoint using android app `https://p.grabtaxi.com/api/passenger/v2/profiles/activationsms` which allow me to bypass OTP code due to lack of rate limiting.\nThe root cause of the problem it that facts: resend code endpoint do not have rate limiting (it has only 30 seconds timing for resending possibility). But code activation on the `https://p.grabtaxi.com/api/passenger/v2/profiles/activate` has 3 attempts limit, then it will be expired.\nCombined this two facts, i found that it is possible to succeed in the account takeover of any user using only phone number.\nMethod: we have only 3 code attempts, and we can reset the code every 30 seconds without rate limiting.\n**This gave us 6 attempts in the minute, 360 attempts in the hour, and 8640 attempts in 24 hour**. Since codes range has only 9999 values (it is 4-digit), we will likely succeed with the correct code in the 24-72 hours.\nAttacker just need to choose some 3 custom OTP codes, for example, 1056, 1057, 1058, and start trying to send them every 30 seconds. If all 3 codes will fail - reset it and try again in next 30 seconds. Sooner or later, Grab Server will throw some of this codes, and this code will be accepted, and we will have access to the victim's account. How it looks in the Web Debugger - you can see on the screenshot attached (`test.png`).\nExample report, where used similar method: https://hackerone.com/reports/149598\n\n##Impact\n\nThe attacker can bypass OTP verification on Grab android app on any mobile number using \"Login with mobile number\" option. Attacker can succeed in the account takeover of any user without any privileges, using only phone number and country code.\n\n##Steps To Reproduce:\n\n1. Use my POC tool, attached to the report (written on C#, requires .NET 4.0). Sources included.\n2. Enter your test phone number  to the field (it must starts with country code without `+` and be the connected to the Grab account on Android app) - or you can use my test number `███` and press Start.\n3. Tool will start sending 3 code attempts `1056, 1057, 1058` and refreshing the code in case of failing every 30 seconds. The process may take many hours, but sooner or later you will receive message with success response and session header. \n\n\n##Mitigation/Remediation Steps:\nI suggest you implement a rate-limiting on this endpoint `https://p.grabtaxi.com/api/passenger/v2/profiles/activationsms`, for example, blocking code resending for some time after 5 or more resends.\n\n\n\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nAfter my previous report about 2FA bypass on the Profile Edit endpoint i was interested to find enpoint, which will allow me horizontal privileges escalation.\u003cbr\u003e\nSo, I found the endpoint using android app \u003ccode\u003ehttps://p.grabtaxi.com/api/passenger/v2/profiles/activationsms\u003c/code\u003e which allow me to bypass OTP code due to lack of rate limiting.\u003cbr\u003e\nThe root cause of the problem it that facts: resend code endpoint do not have rate limiting (it has only 30 seconds timing for resending possibility). But code activation on the \u003ccode\u003ehttps://p.grabtaxi.com/api/passenger/v2/profiles/activate\u003c/code\u003e has 3 attempts limit, then it will be expired.\u003cbr\u003e\nCombined this two facts, i found that it is possible to succeed in the account takeover of any user using only phone number.\u003cbr\u003e\nMethod: we have only 3 code attempts, and we can reset the code every 30 seconds without rate limiting.\u003cbr\u003e\n\u003cstrong\u003eThis gave us 6 attempts in the minute, 360 attempts in the hour, and 8640 attempts in 24 hour\u003c/strong\u003e. Since codes range has only 9999 values (it is 4-digit), we will likely succeed with the correct code in the 24-72 hours.\u003cbr\u003e\nAttacker just need to choose some 3 custom OTP codes, for example, 1056, 1057, 1058, and start trying to send them every 30 seconds. If all 3 codes will fail - reset it and try again in next 30 seconds. Sooner or later, Grab Server will throw some of this codes, and this code will be accepted, and we will have access to the victim\u0026#39;s account. How it looks in the Web Debugger - you can see on the screenshot attached (\u003ccode\u003etest.png\u003c/code\u003e).\u003cbr\u003e\nExample report, where used similar method: \u003ca title=\"https://hackerone.com/reports/149598\" href=\"https://hackerone.com/reports/149598\"\u003ehttps://hackerone.com/reports/149598\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can bypass OTP verification on Grab android app on any mobile number using \u0026quot;Login with mobile number\u0026quot; option. Attacker can succeed in the account takeover of any user without any privileges, using only phone number and country code.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eUse my POC tool, attached to the report (written on C#, requires .NET 4.0). Sources included.\u003c/li\u003e\n\u003cli\u003eEnter your test phone number  to the field (it must starts with country code without \u003ccode\u003e+\u003c/code\u003e and be the connected to the Grab account on Android app) - or you can use my test number \u003ccode\u003e███\u003c/code\u003e and press Start.\u003c/li\u003e\n\u003cli\u003eTool will start sending 3 code attempts \u003ccode\u003e1056, 1057, 1058\u003c/code\u003e and refreshing the code in case of failing every 30 seconds. The process may take many hours, but sooner or later you will receive message with success response and session header. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"mitigation-remediation-steps\"\u003eMitigation/Remediation Steps:\u003c/h2\u003e\n\n\u003cp\u003eI suggest you implement a rate-limiting on this endpoint \u003ccode\u003ehttps://p.grabtaxi.com/api/passenger/v2/profiles/activationsms\u003c/code\u003e, for example, blocking code resending for some time after 5 or more resends.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":159107,"file_name":"test.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/159/107/3407504403feb37e416b0a1e815127768d14e2fa/test.PNG?response-content-disposition=attachment%3B%20filename%3D%22test.PNG%22%3B%20filename%2A%3DUTF-8%27%27test.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045451Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=f8f882ca93d304685247c5e45adff37fd6b9f5292a886feeed9c9d9a2aa79754","file_size":117629,"type":"image/png"},{"id":159108,"file_name":"prog.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/159/108/2903cd4b1931e7c6dc71b1b3be802817d2ab15c6/prog.PNG?response-content-disposition=attachment%3B%20filename%3D%22prog.PNG%22%3B%20filename%2A%3DUTF-8%27%27prog.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045451Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=5b7419d76f5dc5f62311332128fe6ba1df0b9356a918ae73c34a8a5419bdc137","file_size":7284,"type":"image/png"}],"allow_singular_disclosure_at":"2017-10-13T16:12:29.296Z","allow_singular_disclosure_after":-101306542.12274304,"singular_disclosure_allowed":true,"vote_count":50,"voters":["pprab","bl4de","flashdisk","johndoe1492","fa1rlight","cuso4","asad0x01_","madrobot","mpz","eveeez","and 40 more..."],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1474799,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S. in the step 2 correct country code needed too besides the phone. In my case it's `UA`. After pressing `Start` button sending process will start in 30 seconds.","markdown_message":"\u003cp\u003eP.S. in the step 2 correct country code needed too besides the phone. In my case it\u0026#39;s \u003ccode\u003eUA\u003c/code\u003e. After pressing \u003ccode\u003eStart\u003c/code\u003e button sending process will start in 30 seconds.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-09T16:03:17.311Z","updated_at":"2017-02-09T16:06:36.711Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474823,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have reviewed your bug report and would like to inform you that your submission is valid. We would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that we can verify the same.\n\nWe appreciate your help in keeping Grab and our customers safe and secure.","markdown_message":"\u003cp\u003eWe have reviewed your bug report and would like to inform you that your submission is valid. We would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that we can verify the same.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your help in keeping Grab and our customers safe and secure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-09T16:13:25.078Z","updated_at":"2017-02-09T16:13:25.078Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1481544,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-13T08:06:55.686Z","updated_at":"2017-02-13T08:06:55.686Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1502858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sp1d3rs,\n\nCan you verify if this issue has been fixed?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCan you verify if this issue has been fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-24T08:07:28.485Z","updated_at":"2017-02-24T08:07:28.485Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1503018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, it seems like issue is fully fixed.\nAfter 5 unsuccessfull code attempts the response is\n```\n{\n\t\"status\": 400,\n\t\"code\": 4004\n}\n```\ninstead\n```\n{\n\t\"status\": 400,\n\t\"code\": 4000\n}\n```\nwhich means the attacker get block for some time.\nAlso `https://p.grabtaxi.com/api/passenger/v2/profiles/activationsms` and  `https://p.grabtaxi.com/api/passenger/v2/profiles/register` does not refresh anymore code attempts. \nSo all possible attack vectors will not work here anymore.","markdown_message":"\u003cp\u003eHi, it seems like issue is fully fixed.\u003cbr\u003e\nAfter 5 unsuccessfull code attempts the response is\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026quot;status\u0026quot;: 400,\n    \u0026quot;code\u0026quot;: 4004\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003einstead\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026quot;status\u0026quot;: 400,\n    \u0026quot;code\u0026quot;: 4000\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhich means the attacker get block for some time.\u003cbr\u003e\nAlso \u003ccode\u003ehttps://p.grabtaxi.com/api/passenger/v2/profiles/activationsms\u003c/code\u003e and  \u003ccode\u003ehttps://p.grabtaxi.com/api/passenger/v2/profiles/register\u003c/code\u003e does not refresh anymore code attempts. \u003cbr\u003e\nSo all possible attack vectors will not work here anymore.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-24T09:55:11.623Z","updated_at":"2017-02-24T09:56:51.157Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1503042,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your working with us and helping us in resolving this issue. Your bounty will be processed shortly.","markdown_message":"\u003cp\u003eThank you for your working with us and helping us in resolving this issue. Your bounty will be processed shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-24T10:07:47.671Z","updated_at":"2017-02-24T10:07:47.671Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1512684,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-01T05:57:39.754Z","updated_at":"2017-03-01T05:57:39.754Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Grab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1513177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the bounty!","markdown_message":"\u003cp\u003eThank you very much for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-01T12:07:39.282Z","updated_at":"2017-03-01T12:07:39.282Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1924932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. Can you hide the private information from the report, like phone number (in Steps to Reproduce section)?\nI'm going to prepare this report for disclosure (if you agree, for sure).","markdown_message":"\u003cp\u003eHello. Can you hide the private information from the report, like phone number (in Steps to Reproduce section)?\u003cbr\u003e\nI\u0026#39;m going to prepare this report for disclosure (if you agree, for sure).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-13T19:14:00.783Z","updated_at":"2017-08-13T19:14:00.783Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @grabsecurity, can you hide the phone number using ████████ ?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/grabsecurity\"\u003e@grabsecurity\u003c/a\u003e, can you hide the phone number using ████████ ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T22:28:29.578Z","updated_at":"2017-08-31T22:28:29.578Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1993017,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @sp1d3rs ! It's done.\n\nThank you for working with us we are looking for more of your report!","markdown_message":"\u003cp\u003eHello \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e ! It\u0026#39;s done.\u003c/p\u003e\n\n\u003cp\u003eThank you for working with us we are looking for more of your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-13T02:58:06.537Z","updated_at":"2017-09-13T02:58:06.537Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1994023,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nozz_ ,\nThanks a lot for the redacting! I noticed that the phone number also exposed in the F159112 and F159106 attachments. Can they be removed too?\nOr maybe we can disclose this report with Limited Visibility?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nozz_\"\u003e@nozz_\u003c/a\u003e ,\u003cbr\u003e\nThanks a lot for the redacting! I noticed that the phone number also exposed in the F159112 and F159106 attachments. Can they be removed too?\u003cbr\u003e\nOr maybe we can disclose this report with Limited Visibility?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-13T12:42:02.849Z","updated_at":"2017-09-13T12:42:13.283Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1994723,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I was able to remove attachments by contacting with H1 support.\nRequesting full disclosure:)","markdown_message":"\u003cp\u003eI was able to remove attachments by contacting with H1 support.\u003cbr\u003e\nRequesting full disclosure:)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-13T16:12:29.237Z","updated_at":"2017-09-13T16:12:29.237Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995893,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No problem. We appreciate your help in keeping Grab and our customers safe and secure.","markdown_message":"\u003cp\u003eNo problem. We appreciate your help in keeping Grab and our customers safe and secure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T02:54:12.670Z","updated_at":"2017-09-14T02:54:12.670Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995894,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-14T02:54:12.731Z","updated_at":"2017-09-14T02:54:12.731Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3472,"category":"researcher","content":"###Summary\nI found a OTP code bypass on the login endpoint, used by Grab Android App. Since no password was required upon login (only SMS code), it was actually account takeover (still, the victim will be informed that something is wrong  because of few incoming SMSes with codes).\nThe team was very responsible and fixed the issue fast.\nThanks to the Grab team for the great experience and the bounty! It is a pleasure to work with you!\n\n###Technique\nThe used method (thanks to the @yaworsk and his #149598 report!) is highly depending on the luck due to low enough chance to guess correct code using only 3 attempts in 30 seconds (and we must consider that the server may not throw the one of the choosen codes for a very long time). So account takeover is not so easy, and requires a lot of time. The side effect of this - it is abusing the SMS sending mechanism (it was fixed too).\n\n###Why it works\n1) The code had only 4 digits (with 5-6 digits chance to guess the code dramatically drop). Even with 4 digits tool can work a week without results.\n*and*\n2) There was no limiting on the code refreshing attempts  (now it is, and also account can be locked).\n\n###Used tools and apps:\n1) Nox App Player (android emulator), proxied through web debugging proxy.\n2) Tested application - https://play.google.com/store/apps/details?id=com.grabtaxi.passenger (app allows registration from any country)\n3) Custom C# tool for SMS code refreshing.","can_view?":true,"can_edit?":false,"content_html":"\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eI found a OTP code bypass on the login endpoint, used by Grab Android App. Since no password was required upon login (only SMS code), it was actually account takeover (still, the victim will be informed that something is wrong  because of few incoming SMSes with codes).\u003cbr\u003e\nThe team was very responsible and fixed the issue fast.\u003cbr\u003e\nThanks to the Grab team for the great experience and the bounty! It is a pleasure to work with you!\u003c/p\u003e\n\n\u003ch3 id=\"technique\"\u003eTechnique\u003c/h3\u003e\n\n\u003cp\u003eThe used method (thanks to the \u003ca href=\"/yaworsk\"\u003e@yaworsk\u003c/a\u003e and his \u003ca href=\"/reports/149598\"\u003e#149598\u003c/a\u003e report!) is highly depending on the luck due to low enough chance to guess correct code using only 3 attempts in 30 seconds (and we must consider that the server may not throw the one of the choosen codes for a very long time). So account takeover is not so easy, and requires a lot of time. The side effect of this - it is abusing the SMS sending mechanism (it was fixed too).\u003c/p\u003e\n\n\u003ch3 id=\"why-it-works\"\u003eWhy it works\u003c/h3\u003e\n\n\u003cp\u003e1) The code had only 4 digits (with 5-6 digits chance to guess the code dramatically drop). Even with 4 digits tool can work a week without results.\u003cbr\u003e\n\u003cem\u003eand\u003c/em\u003e\u003cbr\u003e\n2) There was no limiting on the code refreshing attempts  (now it is, and also account can be locked).\u003c/p\u003e\n\n\u003ch3 id=\"used-tools-and-apps\"\u003eUsed tools and apps:\u003c/h3\u003e\n\n\u003cp\u003e1) Nox App Player (android emulator), proxied through web debugging proxy.\u003cbr\u003e\n2) Tested application - \u003ca title=\"https://play.google.com/store/apps/details?id=com.grabtaxi.passenger\" href=\"/redirect?url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.grabtaxi.passenger\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://play.google.com/store/apps/details?id=com.grabtaxi.passenger\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (app allows registration from any country)\u003cbr\u003e\n3) Custom C# tool for SMS code refreshing.\u003c/p\u003e\n"}]}