{"id":708013,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDgwMTM=","url":"https://hackerone.com/reports/708013","title":"StoreFront API allows for a brute force attack on customer login by not timing out ALL attempts","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-10-04T22:13:38.873Z","submitted_at":"2019-10-04T22:13:38.873Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"clew","url":"/clew","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-07T20:12:54.095Z","bug_reporter_agreed_on_going_public_at":"2019-10-07T20:12:53.993Z","team_member_agreed_on_going_public_at":"2019-10-07T19:16:40.481Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It seems that the service used for login purposes could be brute forced. the system fails when the password is incorrect, after some unsuccessful attempts the following message is shown:\n\n \n{\"data\":{\"customerAccessTokenCreate\":null},\"errors\":[{\"message\":\"Login attempt limit exceeded. Please try again later.\",\"locations\":[{\"line\":1,\"column\":10}],\"path\":[\"customerAccessTokenCreate\"]}]}\n\n \nHowever, it still possible to continue brute forcing and if you try with the real password it will work again. So in our case, we have been able to perform brute force attack.  \n\nWe feel Shopify should enforce the \"limit exceeded\" error for BOTH valid and invalid passwords.\n\n## Impact\n\nIf the brute force attack succeeds, the attacker will then gain access to that user's shopify account, including contact information and order history.","vulnerability_information_html":"\u003cp\u003eIt seems that the service used for login purposes could be brute forced. the system fails when the password is incorrect, after some unsuccessful attempts the following message is shown:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;data\u0026quot;:{\u0026quot;customerAccessTokenCreate\u0026quot;:null},\u0026quot;errors\u0026quot;:[{\u0026quot;message\u0026quot;:\u0026quot;Login attempt limit exceeded. Please try again later.\u0026quot;,\u0026quot;locations\u0026quot;:[{\u0026quot;line\u0026quot;:1,\u0026quot;column\u0026quot;:10}],\u0026quot;path\u0026quot;:[\u0026quot;customerAccessTokenCreate\u0026quot;]}]}\u003c/p\u003e\n\n\u003cp\u003eHowever, it still possible to continue brute forcing and if you try with the real password it will work again. So in our case, we have been able to perform brute force attack.  \u003c/p\u003e\n\n\u003cp\u003eWe feel Shopify should enforce the \u0026quot;limit exceeded\u0026quot; error for BOTH valid and invalid passwords.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf the brute force attack succeeds, the attacker will then gain access to that user\u0026#39;s shopify account, including contact information and order history.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":31,"name":"Brute Force"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":599924,"file_name":"shopify_brute_force.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VNrj9Fx69b5DAAp5fqALceDt?response-content-disposition=attachment%3B%20filename%3D%22shopify_brute_force.png%22%3B%20filename%2A%3DUTF-8%27%27shopify_brute_force.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXTSUKMQR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064027Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICj7knYENMnZh5A0NglwhkrcefT2BpvxRPeuGap0VUVRAiAmn0d7G6cOHj4E%2FKnqMO8ijTpfdfQo0l3AXDA9%2BVALKyq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM%2FiUJtIxCtzL546wIKpEDje0AX20BGKjUrOSYKWZEdzHWjKRP8eQkcBUNH01qDuCwWFb492oSkH%2FEbtHYsr08fP7HLp%2BTd6LcNHSrDFB9d%2BFYETRUG%2BADKmSGmr3Nwq3xqOP7v1EpWK%2BMEc71vsf2gHyy2w59dToZZzlFf2LAOtvhw7zU2wPf4yKeKdDuOWSWY%2FYHF9%2FAyxR3PD619mcgslnZ5pnYBzX6KdEFvaj1f6s0iYObvLdLHSGri%2BDq6ie%2BP8QhqPHtP8GrAkyOULwf0RxusfkoOYlk6RCSPeGnc%2B%2F0xS4Z3WGTX1xspZfXd0eNVxbwMndOmyXOgV4rAgYhogZMCF8CUdB54myomh4lvN8GC6ZOidewqvFMUYwvJDtcv5pamoBOKfBja9zALg1XyMVI0veiuhxW3yKuxhVLdNKxYadV6pexYwarFA3FPF7h4jC%2F4kY3598KIMbOh7q27L9WfbepKiXnfyh29KSGWxJCVMqZfME%2F5fKTENVzxThmVhSuR%2BN%2FKLX7fsytnAWZSmFjtkQ0xLsf2eZqtVvhJBAwkdSq%2FwU67AHKBp0gQe3TLXIgmEnz83bIH2CwQkZMzah2yfBPWtq0ZmAtH%2B0SUMwvTFocxndYggkQSymMXlnMxSrW%2BShlOraR%2FvJ3Ray4%2FLsf09Cb2XaPSrPR5Wx1KvVAyb2Z18jluSP%2Fm5hPR5XJ4tbNBRxfzhgRI1u4O97hl5qsWT1DT7hNdHJ0BNkn7AUS4VJKTLipMdxmxf4j4xDx5eEMqe7Wr5xoy56daL76ywzY%2F7%2B2Yy7SSE3lpZivXSYx0hn1jJAOzsp%2BLLnwo599EX%2FHSD0E4ZBDvjofSUuw6iva2j9O%2BZyk3WJc%2FbmM7LEVw1QRhA%3D%3D\u0026X-Amz-Signature=713011f99e923ec2cb8e411d4b4776a4f0ea27ed5e6f3a25766bc0ed0a8f0e0f","file_size":64332,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":31,"voters":["sultancad","sameerphad72","dhakal_ananda","0-1","nessun00x","sodium_","exception","darkshadow1733","japz","cryptographer","and 21 more..."],"severity":{"rating":"medium","score":5.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5963063,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've confirmed the issue, and our engineering team is working on a fix. We'll be in touch with you again early next week.","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve confirmed the issue, and our engineering team is working on a fix. We\u0026#39;ll be in touch with you again early next week.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-04T22:18:25.610Z","updated_at":"2019-10-04T22:18:25.610Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5979793,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T19:03:04.908Z","updated_at":"2019-10-07T19:03:04.908Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.8)","old_severity_id":531650,"new_severity_id":533000},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5979887,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for reporting this. We deployed a fix this morning, and the login throttle should now be checked whether the password is valid or invalid.\n\nAlthough this issue doesn't fall into any of the vulnerability categories listed in the bounty table on our [program page](https://hackerone.com/shopify), we've decided to award a bounty of $500 for this report since the incorrect throttling of customer account logins would make a brute force attack on customer account credentials more likely to succeed.\n\nWe look forward to hearing from you again soon!","markdown_message":"\u003cp\u003eThanks again for reporting this. We deployed a fix this morning, and the login throttle should now be checked whether the password is valid or invalid.\u003c/p\u003e\n\n\u003cp\u003eAlthough this issue doesn\u0026#39;t fall into any of the vulnerability categories listed in the bounty table on our \u003ca href=\"https://hackerone.com/shopify\"\u003eprogram page\u003c/a\u003e, we\u0026#39;ve decided to award a bounty of $500 for this report since the incorrect throttling of customer account logins would make a brute force attack on customer account credentials more likely to succeed.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to hearing from you again soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-07T19:15:37.523Z","updated_at":"2019-10-07T19:15:37.523Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"clew","url":"/clew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5979897,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T19:16:16.782Z","updated_at":"2019-10-07T19:16:16.782Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"clew","url":"/clew"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5979902,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T19:16:40.510Z","updated_at":"2019-10-07T19:16:40.510Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5980279,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T20:12:54.024Z","updated_at":"2019-10-07T20:12:54.024Z","actor":{"username":"clew","cleared":false,"url":"/clew","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5980280,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T20:12:54.128Z","updated_at":"2019-10-07T20:12:54.128Z","actor":{"username":"clew","cleared":false,"url":"/clew","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18422,"category":"team","content":"@clew noticed that the [`customerAccessTokenCreate` mutation](https://help.shopify.com/en/api/storefront-api/reference/mutation/customeraccesstokencreate) in the [Storefront API](https://help.shopify.com/en/api/storefront-api) did not correctly throttle login attempts. The throttle failed to prevent brute force attacks because its counter was only checked \u0026 incremented when an invalid password was submitted. We've corrected the problem by applying the throttle to all login attempts, whether the password is valid or invalid.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/clew\"\u003e@clew\u003c/a\u003e noticed that the \u003ca href=\"/redirect?url=https%3A%2F%2Fhelp.shopify.com%2Fen%2Fapi%2Fstorefront-api%2Freference%2Fmutation%2Fcustomeraccesstokencreate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ecustomerAccessTokenCreate\u003c/code\u003e mutation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in the \u003ca href=\"/redirect?url=https%3A%2F%2Fhelp.shopify.com%2Fen%2Fapi%2Fstorefront-api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eStorefront API\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e did not correctly throttle login attempts. The throttle failed to prevent brute force attacks because its counter was only checked \u0026amp; incremented when an invalid password was submitted. We\u0026#39;ve corrected the problem by applying the throttle to all login attempts, whether the password is valid or invalid.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}