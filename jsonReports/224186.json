{"id":224186,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQxODY=","url":"https://hackerone.com/reports/224186","title":"Email spoofing at weblate.org","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-04-26T23:53:23.210Z","submitted_at":"2017-04-26T23:53:23.210Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pyrk2142","url":"/pyrk2142","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-16T14:13:09.528Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-05-17T14:12:58.904Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Good day.\n\nI found security bug at weblate.org. Now anybody may send email from weblate.org domain.\n\nNow you have SPF policy and DMARC policy, that does not protect anything (because exists insecure domain policy: \"p=none\" and \"sp=none\"). Anybody may send email from weblate.org (or subdomain), that are not protected (because SPF does not mean, that email service will do something with spoofed email (for example, Yahoo will add it to inbox)). \n\nYou may use https://emkei.cz/ to test this bug. For example, I sent email from admin@weblate.org (or test@mail.weblate.org) to my email and got this message.\n\nWhy it is dangerous?\n\nAttacker may send fake email from your domain and ask user to do somethig. For example, go to site and insert password. User may trust, because email send from normal domain.\n\nIf you try send email from Facebook main site, Google domain, you will not get message. You may use DMARC Policy (with \"p=reject\") to prevent sending emails form your domain.\n\n","vulnerability_information_html":"\u003cp\u003eGood day.\u003c/p\u003e\n\n\u003cp\u003eI found security bug at weblate.org. Now anybody may send email from weblate.org domain.\u003c/p\u003e\n\n\u003cp\u003eNow you have SPF policy and DMARC policy, that does not protect anything (because exists insecure domain policy: \u0026quot;p=none\u0026quot; and \u0026quot;sp=none\u0026quot;). Anybody may send email from weblate.org (or subdomain), that are not protected (because SPF does not mean, that email service will do something with spoofed email (for example, Yahoo will add it to inbox)). \u003c/p\u003e\n\n\u003cp\u003eYou may use \u003ca title=\"https://emkei.cz/\" href=\"/redirect?url=https%3A%2F%2Femkei.cz%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://emkei.cz/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to test this bug. For example, I sent email from \u003ca title=\"admin@weblate.org\" href=\"mailto:admin@weblate.org\" rel=\"nofollow noopener noreferrer\"\u003eadmin@weblate.org\u003c/a\u003e (or \u003ca title=\"test@mail.weblate.org\" href=\"mailto:test@mail.weblate.org\" rel=\"nofollow noopener noreferrer\"\u003etest@mail.weblate.org\u003c/a\u003e) to my email and got this message.\u003c/p\u003e\n\n\u003cp\u003eWhy it is dangerous?\u003c/p\u003e\n\n\u003cp\u003eAttacker may send fake email from your domain and ask user to do somethig. For example, go to site and insert password. User may trust, because email send from normal domain.\u003c/p\u003e\n\n\u003cp\u003eIf you try send email from Facebook main site, Google domain, you will not get message. You may use DMARC Policy (with \u0026quot;p=reject\u0026quot;) to prevent sending emails form your domain.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-16T14:12:58.930Z","allow_singular_disclosure_after":-111595757.63697957,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","spetr0x","jackie_1"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1639190,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Oops, I've used wrong DMARC record, should be fixed now.","markdown_message":"\u003cp\u003eOops, I\u0026#39;ve used wrong DMARC record, should be fixed now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T05:45:43.961Z","updated_at":"2017-04-27T05:45:43.961Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pyrk2142","url":"/pyrk2142"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1639515,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good day.\n\nYes, now all is correct. Thank you for the fast answer.","markdown_message":"\u003cp\u003eGood day.\u003c/p\u003e\n\n\u003cp\u003eYes, now all is correct. Thank you for the fast answer.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T09:48:44.670Z","updated_at":"2017-04-27T09:48:44.670Z","actor":{"username":"pyrk2142","cleared":false,"url":"/pyrk2142","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1680162,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-17T14:12:58.916Z","updated_at":"2017-05-17T14:12:58.916Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1760977,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-16T14:13:09.543Z","updated_at":"2017-06-16T14:13:09.543Z","actor":{"url":"/weblate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Weblate"}},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}