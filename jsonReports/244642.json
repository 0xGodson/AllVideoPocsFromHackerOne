{"id":244642,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ2NDI=","url":"https://hackerone.com/reports/244642","title":"Forgot password link doesn't expire after used, only after some hours","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-06-30T05:32:22.026Z","submitted_at":"2017-06-30T05:32:22.026Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mohammad_obaid","url":"/mohammad_obaid","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/131/334/48beb15ae8dbb3cfdf59ca392d153fe7ba8cf1a0_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-03T06:42:58.087Z","bug_reporter_agreed_on_going_public_at":"2017-06-30T10:15:52.449Z","team_member_agreed_on_going_public_at":"2017-07-03T06:42:58.008Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, Hope you guys are doing great. I want to report couple of issues regarding forgot password mechanism. \n##1st ISSUE:\nOne thing I noticed that when password rest link is requested and user change its password, that reset link should expire immediately but in your case , used reset link can be reused again and again. This will cause an attacker to take over victim account if he somehow gain victim email account access and found password reset token in emails.\n##POC:\n1- Go to https://wakatime.com/reset_password\n2- Enter your email address and you will get one password reset token in your email.\n3- Now change password using that link and you will be successfully log in from your new password.\n4- Now log out and change password again using reset token which is sent in step2.\n5- You will see your password will again changed.\n\n##2nd ISSUE:\nSecond issue I want to report is that when multiple token is requested , previous one should be expired immediately which in your case is not.\nThis will cause an attacker to take over victim account if he somehow gain victim email account access and found unused password reset token in emails.\n\n##POC:\n1- Go to https://wakatime.com/reset_password\n2- Enter your email address and you will get one password reset token in your email. Call this token1.\n3- No repeat step 1 and 2 and you will get another rest token. Call this token2\n3- Now change password using token2 and you will be successfully log in from your new password.\n4- Now log out and change password again using  token1 which is sent in step2.\n5- You will see your password will again changed.\n\n##POSSIBLE FIX:\nAll used password reset link should be expired immediately.\nAll unused password reset token should be expired immediately with the issue of new token .\n\n","vulnerability_information_html":"\u003cp\u003eHi, Hope you guys are doing great. I want to report couple of issues regarding forgot password mechanism. \u003c/p\u003e\n\n\u003ch2 id=\"1st-issue\"\u003e1st ISSUE:\u003c/h2\u003e\n\n\u003cp\u003eOne thing I noticed that when password rest link is requested and user change its password, that reset link should expire immediately but in your case , used reset link can be reused again and again. This will cause an attacker to take over victim account if he somehow gain victim email account access and found password reset token in emails.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC:\u003c/h2\u003e\n\n\u003cp\u003e1- Go to \u003ca title=\"https://wakatime.com/reset_password\" href=\"/redirect?url=https%3A%2F%2Fwakatime.com%2Freset_password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wakatime.com/reset_password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2- Enter your email address and you will get one password reset token in your email.\u003cbr\u003e\n3- Now change password using that link and you will be successfully log in from your new password.\u003cbr\u003e\n4- Now log out and change password again using reset token which is sent in step2.\u003cbr\u003e\n5- You will see your password will again changed.\u003c/p\u003e\n\n\u003ch2 id=\"2nd-issue\"\u003e2nd ISSUE:\u003c/h2\u003e\n\n\u003cp\u003eSecond issue I want to report is that when multiple token is requested , previous one should be expired immediately which in your case is not.\u003cbr\u003e\nThis will cause an attacker to take over victim account if he somehow gain victim email account access and found unused password reset token in emails.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC:\u003c/h2\u003e\n\n\u003cp\u003e1- Go to \u003ca title=\"https://wakatime.com/reset_password\" href=\"/redirect?url=https%3A%2F%2Fwakatime.com%2Freset_password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wakatime.com/reset_password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2- Enter your email address and you will get one password reset token in your email. Call this token1.\u003cbr\u003e\n3- No repeat step 1 and 2 and you will get another rest token. Call this token2\u003cbr\u003e\n3- Now change password using token2 and you will be successfully log in from your new password.\u003cbr\u003e\n4- Now log out and change password again using  token1 which is sent in step2.\u003cbr\u003e\n5- You will see your password will again changed.\u003c/p\u003e\n\n\u003ch2 id=\"possible-fix\"\u003ePOSSIBLE FIX:\u003c/h2\u003e\n\n\u003cp\u003eAll used password reset link should be expired immediately.\u003cbr\u003e\nAll unused password reset token should be expired immediately with the issue of new token .\u003c/p\u003e\n","weakness":{"id":92,"name":"Weak Password Recovery Mechanism for Forgotten Password"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-30T10:15:52.496Z","allow_singular_disclosure_after":-107808821.61877976,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","exception","japz"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1793712,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update whether its duplicate or triaged?","markdown_message":"\u003cp\u003eAny update whether its duplicate or triaged?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T09:25:02.794Z","updated_at":"2017-06-30T09:25:02.794Z","actor":{"username":"mohammad_obaid","cleared":true,"url":"/mohammad_obaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/131/334/48beb15ae8dbb3cfdf59ca392d153fe7ba8cf1a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1793750,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the thorough report! It's fixed now by invalidating reset password links after a user changes their password.","markdown_message":"\u003cp\u003eThanks for the thorough report! It\u0026#39;s fixed now by invalidating reset password links after a user changes their password.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T10:07:55.741Z","updated_at":"2017-06-30T10:07:55.741Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mohammad_obaid","url":"/mohammad_obaid"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1793763,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for quick fix. If you dont mind can we disclose it publicly?","markdown_message":"\u003cp\u003eThanks for quick fix. If you dont mind can we disclose it publicly?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T10:15:52.469Z","updated_at":"2017-06-30T10:15:52.469Z","first_to_agree":true,"actor":{"username":"mohammad_obaid","cleared":true,"url":"/mohammad_obaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/131/334/48beb15ae8dbb3cfdf59ca392d153fe7ba8cf1a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey can we disclose it?","markdown_message":"\u003cp\u003eHey can we disclose it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T05:29:24.525Z","updated_at":"2017-07-03T05:29:24.525Z","actor":{"username":"mohammad_obaid","cleared":true,"url":"/mohammad_obaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/131/334/48beb15ae8dbb3cfdf59ca392d153fe7ba8cf1a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798469,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, disclosing publicly now.","markdown_message":"\u003cp\u003eSure, disclosing publicly now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-03T06:42:58.030Z","updated_at":"2017-07-03T06:42:58.030Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1798470,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T06:42:58.105Z","updated_at":"2017-07-03T06:42:58.105Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1800717,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T01:03:26.112Z","updated_at":"2017-07-04T01:03:26.112Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":54929,"new_severity_id":55821},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1800718,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T01:03:49.308Z","updated_at":"2017-07-04T01:03:49.308Z","additional_data":{"old_title":"Forgot passwod link doesnt expire","new_title":"Forgot passwod link doesn't expire after used, only after some hours"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1800720,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T01:04:24.916Z","updated_at":"2017-07-04T01:04:24.916Z","additional_data":{"old_title":"Forgot passwod link doesn't expire after used, only after some hours","new_title":"Forgot password link doesn't expire after used, only after some hours"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4668,"category":"team","content":"Password reset links expired after 12 hours. Now they also expire when the password has been changed.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ePassword reset links expired after 12 hours. Now they also expire when the password has been changed.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}