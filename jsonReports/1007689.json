{"id":1007689,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA3Njg5","url":"https://hackerone.com/reports/1007689","title":"2020-10-09 Credential Stuffing Attack","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-10-13T19:28:35.674Z","submitted_at":"2020-10-13T19:28:35.683Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-13T20:37:40.444Z","bug_reporter_agreed_on_going_public_at":"2020-10-13T20:00:01.561Z","team_member_agreed_on_going_public_at":"2020-10-13T20:37:40.342Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-12T20:00:01.697Z","allow_singular_disclosure_after":-4003874.718584209,"singular_disclosure_allowed":true,"vote_count":181,"voters":["oxecho","moloshy","basil_jawan","jensec","m0chan","gamer7112","kapytein","the_arch_angel","jobert","a_d_a_m","and 171 more..."],"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9512722,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-13T19:58:37.521Z","updated_at":"2020-10-13T19:58:37.521Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9512724,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-13T19:58:43.828Z","updated_at":"2020-10-13T19:58:43.828Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9512734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-13T20:00:01.586Z","updated_at":"2020-10-13T20:00:01.586Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9513059,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-13T20:37:40.364Z","updated_at":"2020-10-13T20:37:40.364Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9513060,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-13T20:37:40.480Z","updated_at":"2020-10-13T20:37:40.480Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24866,"category":"team","content":"**Executive summary**\nOn October 4, 2020 and October 5, 2020, an attacker launched two [credential stuffing attacks](https://owasp.org/www-community/attacks/Credential_stuffing) against HackerOne.com. On October 9, 2020, HackerOne’s Security team noticed the attack during their weekly audit of anomalies in their log aggregation platform, leading to the Incident Response team starting an investigation.\n\nThe Incident Response team identified that a number of accounts had valid authentication attempts, of which some were blocked due to two-factor authentication. One account in particular had user activity from an unauthorized party, which viewed a number of report titles. After an investigation, the Incident Response team concluded that report contents hadn’t been accessed.\n\nOn October 9, 2020, HackerOne immediately locked all affected accounts that had their credentials compromised. After the accounts were locked, HackerOne reached out to the account holders to notify them with instructions how to unlock their account and advice regarding their credentials. In the abundance of caution, programs of which report titles were viewed received a notification from HackerOne as well.\n\n**Incident timeline**\n\n| Date       | Time (PDT) | What happened?                                                                                                                                                                                                                                              |\n|---|---|---|\n| 2020-10-04 | 12:00p     | Credential stuffing attack against hackerone.com started.                                                                                                                                                                                                   |\n| 2020-10-05 | 2:00a      | Credential stuffing attack against hackerone.com stopped. The attack ran for 14 hours.                                                                                                                                                                      |\n| 2020-10-05 | 12:00p     | Credential stuffing attack against hackerone.com started.                                                                                                                                                                                                   |\n| 2020-10-05 | 4:00p      | Credential stuffing attack against hackerone.com stopped. The attack ran for four hours. In total, about 63,000 credentials were tested. Looking at authentication volume per hour, this was about an order of magnitude higher compared to normal traffic. |\n| 2020-10-09 | 11:00a     | HackerOne Security team notices a spike in sign in attempts on October 4, 2020 and October 5, 2020.                                                                                                                                                         |\n| 2020-10-09 | 12:42p     | Incident Response (IR) team starts incident.                                                                                                                                                                                                                |\n| 2020-10-09 | 1:11p      | IR team confirms five accounts saw valid authentication attempts, two authentication attempts were blocked due to Two-Factor Authentication.                                                                                                                |\n| 2020-10-09 | 1:13p      | IR team confirms none of the five accounts are associated with a program and only two have access to reports.                                                                                                                                               |\n| 2020-10-09 | 1:14p      | IR team proactively locked the five affected accounts.                                                                                                                                                                                                      |\n| 2020-10-09 | 2:17p      | IR team confirms that one of the affected accounts saw user activity from a flagged IP address that the attack originated from. This account had its 14 report titles viewed, affecting five programs.                                                      |\n| 2020-10-09 | 5:20p      | IR team unlocks the affected accounts and deactivated platform sessions.                                                                                                                                                                                    |\n| 2020-10-09 | 5:20p      | IR team reaches out to the five accounts who had valid authentication attempts.                                                                                                                                                                             |\n| 2020-10-09 | 5:20p      | IR team reaches out to the two accounts who had valid authentication attempts, but had Two-Factor Authentication enabled.                                                                                                                                   |\n| 2020-10-09 | 6:20p      | IR team reaches out to the programs of which report titles were viewed.                                                                                                                                                                                     |\n| 2020-10-09 | 6:40p      | Incident ends.                                                                                                                                                                                                                                              |\n\n**Root Cause Analysis**\nHackerOne has alerts in place to detect large numbers of authentication attempts per account, including a lockout strategy, and alerts to detect large numbers of authentication attempts per IP address. HackerOne also offers two-factor authentication for every user on the platform. Yet, the credential stuffing attack went unnoticed for four days. As a mitigation against missing alerts, HackerOne’s Security team does an audit for anomalies on its log aggregation platform on a weekly basis. The anomaly in sign-ins was detected during this audit.\n\n*Why did the attack go unnoticed for four days?*\nAs is typical for a credential stuffing attack, the attack specifically enumerated one password per account. This is different from a brute force attack, where many passwords are enumerated for a single account. Because each authentication attempt was for a different user, it avoided the account lockout strategy to be initiated. The attack itself was routed through the Tor network, which effectively changed the IP address for each authentication attempt. Neither of the alerts HackerOne has set up could therefore detect the attack.\n\n**Action items for HackerOne**\nHackerOne has implemented an alert for anomalous authentication volume, regardless of their origin or user account. This will help to proactively alert the Security team when a similar attack would be launched.\n\nHackerOne will also prioritize a feature that helps keeping its users more secure by identifying machines they haven’t authenticated from in the past. HackerOne will start to require the user to confirm their authentication attempt through a 3rd party system before the newly identified machine can authenticate against the platform.\n\n**Advice for users**\nThis incident is a great reminder of the benefits of two-factor authentication. You can enable this for your account under [Authentication](https://hackerone.com/settings/auth).\n\nHackerOne also recommends its users to use a password manager and refrain from reusing passwords across multiple systems.\n\n**Note on breadth of the attack**\nAs mentioned earlier, the attack covered many accounts and used unique IP addresses for each attempt by using the Tor network. The Incident Response team identified two commonalities in the authentication requests, namely the browser’s user agent and a client-generated authentication fingerprint. The user agent gave a slightly broader set of accounts that were affected than the fingerprint.\n\nTo err on the side of caution, the Incident Response team decided to use the browser’s user agent to avoid missing an account that was authenticated. This may have resulted in people having their accounts locked by error. Due to the sensitive nature of the information that could’ve been accessed, the Incident Response team believes that this was the right decision.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cstrong\u003eExecutive summary\u003c/strong\u003e\u003cbr\u003e\nOn October 4, 2020 and October 5, 2020, an attacker launched two \u003ca href=\"/redirect?url=https%3A%2F%2Fowasp.org%2Fwww-community%2Fattacks%2FCredential_stuffing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecredential stuffing attacks\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e against HackerOne.com. On October 9, 2020, HackerOne’s Security team noticed the attack during their weekly audit of anomalies in their log aggregation platform, leading to the Incident Response team starting an investigation.\u003c/p\u003e\n\n\u003cp\u003eThe Incident Response team identified that a number of accounts had valid authentication attempts, of which some were blocked due to two-factor authentication. One account in particular had user activity from an unauthorized party, which viewed a number of report titles. After an investigation, the Incident Response team concluded that report contents hadn’t been accessed.\u003c/p\u003e\n\n\u003cp\u003eOn October 9, 2020, HackerOne immediately locked all affected accounts that had their credentials compromised. After the accounts were locked, HackerOne reached out to the account holders to notify them with instructions how to unlock their account and advice regarding their credentials. In the abundance of caution, programs of which report titles were viewed received a notification from HackerOne as well.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eIncident timeline\u003c/strong\u003e\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDate\u003c/th\u003e\n\u003cth\u003eTime (PDT)\u003c/th\u003e\n\u003cth\u003eWhat happened?\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-04\u003c/td\u003e\n\u003ctd\u003e12:00p\u003c/td\u003e\n\u003ctd\u003eCredential stuffing attack against hackerone.com started.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-05\u003c/td\u003e\n\u003ctd\u003e2:00a\u003c/td\u003e\n\u003ctd\u003eCredential stuffing attack against hackerone.com stopped. The attack ran for 14 hours.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-05\u003c/td\u003e\n\u003ctd\u003e12:00p\u003c/td\u003e\n\u003ctd\u003eCredential stuffing attack against hackerone.com started.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-05\u003c/td\u003e\n\u003ctd\u003e4:00p\u003c/td\u003e\n\u003ctd\u003eCredential stuffing attack against hackerone.com stopped. The attack ran for four hours. In total, about 63,000 credentials were tested. Looking at authentication volume per hour, this was about an order of magnitude higher compared to normal traffic.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e11:00a\u003c/td\u003e\n\u003ctd\u003eHackerOne Security team notices a spike in sign in attempts on October 4, 2020 and October 5, 2020.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e12:42p\u003c/td\u003e\n\u003ctd\u003eIncident Response (IR) team starts incident.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e1:11p\u003c/td\u003e\n\u003ctd\u003eIR team confirms five accounts saw valid authentication attempts, two authentication attempts were blocked due to Two-Factor Authentication.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e1:13p\u003c/td\u003e\n\u003ctd\u003eIR team confirms none of the five accounts are associated with a program and only two have access to reports.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e1:14p\u003c/td\u003e\n\u003ctd\u003eIR team proactively locked the five affected accounts.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e2:17p\u003c/td\u003e\n\u003ctd\u003eIR team confirms that one of the affected accounts saw user activity from a flagged IP address that the attack originated from. This account had its 14 report titles viewed, affecting five programs.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e5:20p\u003c/td\u003e\n\u003ctd\u003eIR team unlocks the affected accounts and deactivated platform sessions.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e5:20p\u003c/td\u003e\n\u003ctd\u003eIR team reaches out to the five accounts who had valid authentication attempts.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e5:20p\u003c/td\u003e\n\u003ctd\u003eIR team reaches out to the two accounts who had valid authentication attempts, but had Two-Factor Authentication enabled.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e6:20p\u003c/td\u003e\n\u003ctd\u003eIR team reaches out to the programs of which report titles were viewed.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-09\u003c/td\u003e\n\u003ctd\u003e6:40p\u003c/td\u003e\n\u003ctd\u003eIncident ends.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e\u003cstrong\u003eRoot Cause Analysis\u003c/strong\u003e\u003cbr\u003e\nHackerOne has alerts in place to detect large numbers of authentication attempts per account, including a lockout strategy, and alerts to detect large numbers of authentication attempts per IP address. HackerOne also offers two-factor authentication for every user on the platform. Yet, the credential stuffing attack went unnoticed for four days. As a mitigation against missing alerts, HackerOne’s Security team does an audit for anomalies on its log aggregation platform on a weekly basis. The anomaly in sign-ins was detected during this audit.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eWhy did the attack go unnoticed for four days?\u003c/em\u003e\u003cbr\u003e\nAs is typical for a credential stuffing attack, the attack specifically enumerated one password per account. This is different from a brute force attack, where many passwords are enumerated for a single account. Because each authentication attempt was for a different user, it avoided the account lockout strategy to be initiated. The attack itself was routed through the Tor network, which effectively changed the IP address for each authentication attempt. Neither of the alerts HackerOne has set up could therefore detect the attack.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAction items for HackerOne\u003c/strong\u003e\u003cbr\u003e\nHackerOne has implemented an alert for anomalous authentication volume, regardless of their origin or user account. This will help to proactively alert the Security team when a similar attack would be launched.\u003c/p\u003e\n\n\u003cp\u003eHackerOne will also prioritize a feature that helps keeping its users more secure by identifying machines they haven’t authenticated from in the past. HackerOne will start to require the user to confirm their authentication attempt through a 3rd party system before the newly identified machine can authenticate against the platform.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAdvice for users\u003c/strong\u003e\u003cbr\u003e\nThis incident is a great reminder of the benefits of two-factor authentication. You can enable this for your account under \u003ca href=\"https://hackerone.com/settings/auth\"\u003eAuthentication\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eHackerOne also recommends its users to use a password manager and refrain from reusing passwords across multiple systems.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote on breadth of the attack\u003c/strong\u003e\u003cbr\u003e\nAs mentioned earlier, the attack covered many accounts and used unique IP addresses for each attempt by using the Tor network. The Incident Response team identified two commonalities in the authentication requests, namely the browser’s user agent and a client-generated authentication fingerprint. The user agent gave a slightly broader set of accounts that were affected than the fingerprint.\u003c/p\u003e\n\n\u003cp\u003eTo err on the side of caution, the Incident Response team decided to use the browser’s user agent to avoid missing an account that was authenticated. This may have resulted in people having their accounts locked by error. Due to the sensitive nature of the information that could’ve been accessed, the Incident Response team believes that this was the right decision.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}