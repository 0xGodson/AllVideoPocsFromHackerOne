{"id":152944,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI5NDQ=","url":"https://hackerone.com/reports/152944","title":"Session Management Flaw","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-21T16:19:08.168Z","submitted_at":"2016-07-21T16:19:08.168Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khizer47","url":"/khizer47","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-08T07:32:20.703Z","bug_reporter_agreed_on_going_public_at":"2016-10-08T07:32:20.655Z","team_member_agreed_on_going_public_at":"2016-10-07T23:04:10.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nSir I found a Vulnuberlity in your Website. Called Session Management Flaw\nYou can Know More About This Flaw through OWASP Guide\n https://www.owasp.org/index.php?title=Broken_Authentication_and_Session_Management\u0026setlang=en\n\nin this Loop Hole The Application Is Not Destroying the Session After Signing Out from The User Account at\nhttps://rpm.newrelic.com/\n\u0026 Thus If The Attacker Got his Hands Upon Users Cookies he can Get Access To the User Account.\n\nAn attacker can get the user session cookies by any means Session Spoofer, Cookie Staler etc \n\nSteps To Reproduce:\n\n1: Login to Your newrelic  Account. after successful login you will b taken to https://rpm.newrelic.com/\n\n2: Then Use \"BrupSuite\" or any other  Utility to get the cookies of that session ( I'm using \"EditThisCookie\" Chrome Extension in a Case of Attacker he can Use Any Sort Of cookie Stealing Script or Cookies Soofing Utility to get his hands on cookies ).\n\n\u003eAnd grab the cookies of active User Session.\n\n3: Then Logout of the  Account from https://rpm.newrelic.com/ \u0026 You will See That The Site will take you towards \nhttps://login.newrelic.com/\n\n4: Clear all Cookies related to https://newrelic.com/ \u0026 https://rpm.newrelic.com/   Then Inject Hijacked User Cookies so that you can get into the user session...\n\nAfter the cookies Is been injected You will See That the main page https://newrelic.com/  \u0026 https://login.newrelic.com/ are telling you that you are not logged in but if you open https://rpm.newrelic.com/ You will see that you are logged in to the account...\n\n\u0026 You can see \u0026 Edit any User Info :P\n\n\u0026 Also The cookies you captured will work for long so you can get into account anytime you need i tested cookies that worked lost last about 1 day :p \n\nSir, I'm making \u0026 Uploading a POC Video to YouTube \u0026 Will send you as soon as possible.\n\nthanks,\nKhizer Javed \n\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eSir I found a Vulnuberlity in your Website. Called Session Management Flaw\u003cbr\u003e\nYou can Know More About This Flaw through OWASP Guide\u003cbr\u003e\n \u003ca title=\"https://www.owasp.org/index.php?title=Broken_Authentication_and_Session_Management\u0026amp;setlang=en\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%3Ftitle%3DBroken_Authentication_and_Session_Management%26setlang%3Den\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php?title=Broken_Authentication_and_Session_Management\u0026amp;setlang=en\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ein this Loop Hole The Application Is Not Destroying the Session After Signing Out from The User Account at\u003cbr\u003e\n\u003ca title=\"https://rpm.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u0026amp; Thus If The Attacker Got his Hands Upon Users Cookies he can Get Access To the User Account.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can get the user session cookies by any means Session Spoofer, Cookie Staler etc \u003c/p\u003e\n\n\u003cp\u003eSteps To Reproduce:\u003c/p\u003e\n\n\u003cp\u003e1: Login to Your newrelic  Account. after successful login you will b taken to \u003ca title=\"https://rpm.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2: Then Use \u0026quot;BrupSuite\u0026quot; or any other  Utility to get the cookies of that session ( I\u0026#39;m using \u0026quot;EditThisCookie\u0026quot; Chrome Extension in a Case of Attacker he can Use Any Sort Of cookie Stealing Script or Cookies Soofing Utility to get his hands on cookies ).\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAnd grab the cookies of active User Session.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e3: Then Logout of the  Account from \u003ca title=\"https://rpm.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026amp; You will See That The Site will take you towards \u003cbr\u003e\n\u003ca title=\"https://login.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Flogin.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://login.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e4: Clear all Cookies related to \u003ca title=\"https://newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Fnewrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026amp; \u003ca title=\"https://rpm.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e   Then Inject Hijacked User Cookies so that you can get into the user session...\u003c/p\u003e\n\n\u003cp\u003eAfter the cookies Is been injected You will See That the main page \u003ca title=\"https://newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Fnewrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  \u0026amp; \u003ca title=\"https://login.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Flogin.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://login.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e are telling you that you are not logged in but if you open \u003ca title=\"https://rpm.newrelic.com/\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e You will see that you are logged in to the account...\u003c/p\u003e\n\n\u003cp\u003e\u0026amp; You can see \u0026amp; Edit any User Info :P\u003c/p\u003e\n\n\u003cp\u003e\u0026amp; Also The cookies you captured will work for long so you can get into account anytime you need i tested cookies that worked lost last about 1 day :p \u003c/p\u003e\n\n\u003cp\u003eSir, I\u0026#39;m making \u0026amp; Uploading a POC Video to YouTube \u0026amp; Will send you as soon as possible.\u003c/p\u003e\n\n\u003cp\u003ethanks,\u003cbr\u003e\nKhizer Javed \u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-06T23:04:10.435Z","allow_singular_disclosure_after":-130742996.587366,"singular_disclosure_allowed":true,"vote_count":7,"voters":["bugdiscloseguys","mahmoud0x00","m16","khizer47","js_js","twi0x00tter","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1095519,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This has come in from a few different sources.   We have an engineering task assigned for this issue.\n\nThank you.","markdown_message":"\u003cp\u003eThis has come in from a few different sources.   We have an engineering task assigned for this issue.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-29T16:25:12.079Z","updated_at":"2016-07-29T16:25:12.079Z","actor":{"username":"nrjensen","cleared":false,"url":"/nrjensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/502/de292f03830249c4d1b24742734cc80dfd4f3b8e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1096654,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-30T00:18:46.367Z","updated_at":"2016-07-30T00:18:46.367Z","additional_data":{"duplicate_report_id":153450},"actor":{"username":"crybaby","cleared":false,"url":"/crybaby","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1139872,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any Updates?","markdown_message":"\u003cp\u003eAny Updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T10:54:53.979Z","updated_at":"2016-08-19T10:54:53.979Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1150208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK.  It looks like this is resolved.   If you want to verify that would be great.\n-- NOTE:   We do keep a valid session for a few minutes after logout.   So please wait ~10 minutes after logging out to retest.","markdown_message":"\u003cp\u003eOK.  It looks like this is resolved.   If you want to verify that would be great.\u003cbr\u003e\n-- NOTE:   We do keep a valid session for a few minutes after logout.   So please wait ~10 minutes after logging out to retest.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T20:57:39.032Z","updated_at":"2016-08-23T20:57:39.032Z","actor":{"username":"nrjensen","cleared":false,"url":"/nrjensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/502/de292f03830249c4d1b24742734cc80dfd4f3b8e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1150641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep! Ita look good from here session expires after. 7 minutes 😉","markdown_message":"\u003cp\u003eYep! Ita look good from here session expires after. 7 minutes 😉\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-24T02:06:53.938Z","updated_at":"2016-08-24T02:06:53.938Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152753,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T21:41:59.963Z","updated_at":"2016-08-24T21:41:59.963Z","additional_data":{"duplicate_report_id":163167},"actor":{"username":"aakanksha","cleared":false,"url":"/aakanksha","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1153853,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-25T14:52:29.012Z","updated_at":"2016-08-25T14:52:29.012Z","additional_data":{"duplicate_report_id":163227},"actor":{"username":"cjlegacion","cleared":false,"url":"/cjlegacion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1154471,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"O.o what is happening here 😂","markdown_message":"\u003cp\u003eO.o what is happening here 😂\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-25T19:33:02.518Z","updated_at":"2016-08-25T19:33:02.518Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157018,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!","markdown_message":"\u003cp\u003eWe believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T23:11:40.327Z","updated_at":"2016-08-26T23:11:40.327Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"khizer47","url":"/khizer47"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1238113,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-07T23:04:10.421Z","updated_at":"2016-10-07T23:04:10.421Z","first_to_agree":true,"actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1238387,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-08T07:32:20.677Z","updated_at":"2016-10-08T07:32:20.677Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1238388,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-08T07:32:20.717Z","updated_at":"2016-10-08T07:32:20.717Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1247870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \n\nNew Relic team i want to ask what if I can get the. Swag from New Relic?? \n\nSome of my friends also get the Swag?","markdown_message":"\u003cp\u003eHi, \u003c/p\u003e\n\n\u003cp\u003eNew Relic team i want to ask what if I can get the. Swag from New Relic?? \u003c/p\u003e\n\n\u003cp\u003eSome of my friends also get the Swag?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-14T16:35:02.702Z","updated_at":"2016-10-14T16:35:02.702Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2694225,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-03T03:29:06.025Z","updated_at":"2018-05-03T03:29:06.025Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}