{"id":55670,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTY3MA==","url":"https://hackerone.com/reports/55670","title":"Fabric.io:  Ex-admin of an organization can delete team members","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-10T09:53:25.964Z","submitted_at":"2015-04-10T09:53:25.964Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-01T15:46:20.209Z","bug_reporter_agreed_on_going_public_at":"2015-10-02T15:46:14.925Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When an admin is deleted from an organization, his access rights are not removed properly. This allows an ex-admin to delete team members from the organization.\r\n\r\nBefore proceeding with attack,\r\n\r\n1. Create an organization with two accounts.  Lets say,  VictimOrg - Victimadmin, Victimmember\r\n\r\n2. Invite Hackeradmin to VictimOrg and change his role to admin. At this point Hackeradmin can login and grab VictimOrg \u0026 Victimmember ids.\r\n\r\n     VictimOrg id:54af7e07b8568e8c6a0001e\r\n     Victimmember id:552787195127ae16b8000987\r\n\r\n3. Delete Hackeradmin from VictimOrg. Now, Hakeradmin is not a member of VictimOrg anymore. Ideally, he does not have rights to access/make changes to VictimOrg. However, he can still delete team members from the VictimOrg.\r\n\r\n\r\nSteps listed below shows that Hackeradmin can delete Victimmember from VictimOrg:\r\n\r\n1. Log into fabric.io as Hackeradmin.\r\n2. Navigate to settings-\u003eorganizations-\u003eHackerOrg-\u003eTeam member link.\r\n3. Click on x symbol corresponding to Hackermember to remove him from HackerOrg. Intercept this request using burp proxy.\r\n\r\n    Proxy shows a similar request as below,\r\n\t\r\n\tDELETE /api/v3/accounts/54c1e78b9ea696b3cb00026a/organizations/54aa36e3937ae35559011d17/leave HTTP/1.1\r\n\tHost: fabric.io\r\n\r\n4. In the intercepted request replace the account id with Victimmember id and org id with VictimOrg id.\r\n\r\n\tModified request is,\r\n\t\r\n\tDELETE /api/v3/accounts/552787195127ae16b8000987/organizations/54af7e07b8568e8c6a0001e/leave HTTP/1.1\r\n\tHost: fabric.io\r\n\r\n5. Send the modified request to the server and it removes Victimmember from VictimOrg. \r\n6. To confirm, login as Victimadmin and look at the VictimOrg team members. \r\n","vulnerability_information_html":"\u003cp\u003eWhen an admin is deleted from an organization, his access rights are not removed properly. This allows an ex-admin to delete team members from the organization.\u003c/p\u003e\n\n\u003cp\u003eBefore proceeding with attack,\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eCreate an organization with two accounts.  Lets say,  VictimOrg - Victimadmin, Victimmember\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInvite Hackeradmin to VictimOrg and change his role to admin. At this point Hackeradmin can login and grab VictimOrg \u0026amp; Victimmember ids.\u003c/p\u003e\n\n\u003cp\u003eVictimOrg id:54af7e07b8568e8c6a0001e\u003cbr\u003e\n Victimmember id:552787195127ae16b8000987\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eDelete Hackeradmin from VictimOrg. Now, Hakeradmin is not a member of VictimOrg anymore. Ideally, he does not have rights to access/make changes to VictimOrg. However, he can still delete team members from the VictimOrg.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSteps listed below shows that Hackeradmin can delete Victimmember from VictimOrg:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into fabric.io as Hackeradmin.\u003c/li\u003e\n\u003cli\u003eNavigate to settings-\u0026gt;organizations-\u0026gt;HackerOrg-\u0026gt;Team member link.\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClick on x symbol corresponding to Hackermember to remove him from HackerOrg. Intercept this request using burp proxy.\u003c/p\u003e\n\n\u003cp\u003eProxy shows a similar request as below,\u003c/p\u003e\n\n\u003cp\u003eDELETE /api/v3/accounts/54c1e78b9ea696b3cb00026a/organizations/54aa36e3937ae35559011d17/leave HTTP/1.1\u003cbr\u003e\nHost: fabric.io\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn the intercepted request replace the account id with Victimmember id and org id with VictimOrg id.\u003c/p\u003e\n\n\u003cp\u003eModified request is,\u003c/p\u003e\n\n\u003cp\u003eDELETE /api/v3/accounts/552787195127ae16b8000987/organizations/54af7e07b8568e8c6a0001e/leave HTTP/1.1\u003cbr\u003e\nHost: fabric.io\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSend the modified request to the server and it removes Victimmember from VictimOrg. \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTo confirm, login as Victimadmin and look at the VictimOrg team members. \u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"280.0","formatted_bounty":"$280","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-01T15:46:15.104Z","allow_singular_disclosure_after":-162830037.85699043,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sw33tlie","eveeez","fantam1","wouterk"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":378882,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-13T15:25:13.665Z","updated_at":"2015-04-13T15:25:13.665Z","actor":{"username":"cmiller","cleared":false,"url":"/cmiller","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/113/6ef9b6413b36e8b43175bab4ec39791395346508_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":388308,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-23T17:46:22.726Z","updated_at":"2015-04-23T17:46:22.726Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"280.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":544358,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-11T14:01:20.366Z","updated_at":"2015-08-11T14:01:20.366Z","actor":{"username":"cmiller","cleared":false,"url":"/cmiller","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/113/6ef9b6413b36e8b43175bab4ec39791395346508_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606722,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-02T15:46:14.954Z","updated_at":"2015-10-02T15:46:14.954Z","first_to_agree":true,"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":640331,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-01T15:46:20.231Z","updated_at":"2015-11-01T15:46:20.231Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}