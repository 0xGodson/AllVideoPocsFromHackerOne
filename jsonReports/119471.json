{"id":119471,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTk0NzE=","url":"https://hackerone.com/reports/119471","title":"DOMXSS in Tweetdeck","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-29T15:15:46.940Z","submitted_at":"2016-02-29T15:15:46.940Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"filedescriptor","url":"/filedescriptor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-02T16:32:42.040Z","bug_reporter_agreed_on_going_public_at":"2017-03-03T16:32:37.054Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nI would like to report a DOMXSS issue in TweetDeck.\n\n#Details\nIn Tweetdeck, a tweet contains info of what client (app) the user used to sent the tweet. The render process is vulnerable to DOMXSS.\n\nIn https://ton.twimg.com/tweetdeck-web/web/dist/bundle.6f91b4e832.js, the following line is responsible for retrieving the client website:\n\n```javascript\n                case \"followSourceLink\":\n                    TD.util.openURL($(n.getMainTweet().source).attr(\"href\"));\n                    break;\n```\n\nwhere ```n.getMainTweet().source``` is the client name. This name can be controlled through changing the application name (picture attached), and arbitrary characters can be inserted (including angle brackets).  Moving on, ```$()``` is a jQuery DOMXSS sink. If we inject a payload like ```\u003csvg onload=alert(document.domain)\u003e``` then XSS will be executed showing the executing domain.\n\nSo to sum up,\n1. Attacker creates an application where the app name is a XSS payload.\n2. Attacker uses the app to post a tweet, then the tweet contains a malicious info of which app the tweet is sent from\n3. Victim clicks on the app info and XSS triggers.\n\n#PoC\n1. Make sure you are using latest IE (otherwise CSP kicks in)\n2. Follow @attackerfoobar or search for the user on TweetDeck\n3. Expand the first tweet, click \"Click here to get followers ❤️\" (which is a bait app name)\n4. XSS executes\n\nVideo demonstration is also attached.\n\n#Fix\nProbably sanitize ```n.getMainTweet().source``` before putting it into ```$()```.","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nI would like to report a DOMXSS issue in TweetDeck.\u003c/p\u003e\n\n\u003ch1 id=\"details\"\u003eDetails\u003c/h1\u003e\n\n\u003cp\u003eIn Tweetdeck, a tweet contains info of what client (app) the user used to sent the tweet. The render process is vulnerable to DOMXSS.\u003c/p\u003e\n\n\u003cp\u003eIn \u003ca title=\"https://ton.twimg.com/tweetdeck-web/web/dist/bundle.6f91b4e832.js\" href=\"/redirect?url=https%3A%2F%2Fton.twimg.com%2Ftweetdeck-web%2Fweb%2Fdist%2Fbundle.6f91b4e832.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ton.twimg.com/tweetdeck-web/web/dist/bundle.6f91b4e832.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the following line is responsible for retrieving the client website:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e                \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003efollowSourceLink\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"nx\"\u003eTD\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopenURL\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetMainTweet\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nx\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehref\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere \u003ccode\u003en.getMainTweet().source\u003c/code\u003e is the client name. This name can be controlled through changing the application name (picture attached), and arbitrary characters can be inserted (including angle brackets).  Moving on, \u003ccode\u003e$()\u003c/code\u003e is a jQuery DOMXSS sink. If we inject a payload like \u003ccode\u003e\u0026lt;svg onload=alert(document.domain)\u0026gt;\u003c/code\u003e then XSS will be executed showing the executing domain.\u003c/p\u003e\n\n\u003cp\u003eSo to sum up,\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker creates an application where the app name is a XSS payload.\u003c/li\u003e\n\u003cli\u003eAttacker uses the app to post a tweet, then the tweet contains a malicious info of which app the tweet is sent from\u003c/li\u003e\n\u003cli\u003eVictim clicks on the app info and XSS triggers.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eMake sure you are using latest IE (otherwise CSP kicks in)\u003c/li\u003e\n\u003cli\u003eFollow \u003ca href=\"/attackerfoobar\"\u003e@attackerfoobar\u003c/a\u003e or search for the user on TweetDeck\u003c/li\u003e\n\u003cli\u003eExpand the first tweet, click \u0026quot;Click here to get followers ❤️\u0026quot; (which is a bait app name)\u003c/li\u003e\n\u003cli\u003eXSS executes\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eVideo demonstration is also attached.\u003c/p\u003e\n\n\u003ch1 id=\"fix\"\u003eFix\u003c/h1\u003e\n\n\u003cp\u003eProbably sanitize \u003ccode\u003en.getMainTweet().source\u003c/code\u003e before putting it into \u003ccode\u003e$()\u003c/code\u003e.\u003c/p\u003e\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":75882,"file_name":"appname.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/075/882/b1852462f6151e5fde1eb31802165bdaea35df31/appname.png?response-content-disposition=attachment%3B%20filename%3D%22appname.png%22%3B%20filename%2A%3DUTF-8%27%27appname.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ65C6B2IJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042001Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDUDlftdKCwahQOnPUKizOkg2EzWpa90Y7MV2cJRjoCFAiEA7Y2OQGIwYjcI2ewX5wzy7TrFHvDUf%2BCIL8e2DBoQ8fsqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKstxWWwDBb9kBJ3SSqRAyYWn3xpHc0USlh6j0wUSD0P5lO2wLxrjvfOA2dyjKZVBt1gxJU12nqIqX3KIg9FMETGEwUxbJSTMSoAcGPp86A4SMVO8Ppo%2FbSGSoejkYE57Bm25m03qu80tv22vPGnS25uBEQwCGHzeB2vvgj1L%2F15%2FdzT0%2BG4%2F74LUGHuubNg%2B1XOneA7L7zqEmAAr70tzAVWPrguJqems75lbK%2BgcQwymG9sVI%2Fc6Td6ZStY2vC4MGQhtj%2FB2Gxx7UAazrOqjIGb1G9qSrFARMAiCA7vgzOMlozejJvfAqou2z6NM3lDtH8wHmf%2B04QN5xiDr1wHZOWKVAIeC5Ng5ZOHrGZHtIwdpNYeb2lpY41KE2SAlCRzfQencarj%2BFbPOGd%2BdHnCDIJlkJ1M1OhMbkMpBhgRTzJvpjEERD9SlENQz5LcU8UE9skEafYGlX74JBQCbHp8ggo6mahYoFYYmhlSHgdatm%2B%2B80xz%2FD0LdF7MbyN1WO9WSpnnpVn2rGssLX2aL6wHE4ounfUDQ%2B4P4CmCmYXO1gdWMISXqv8FOusBPH9k2FVakiaEQK4YvWltErNybc3TWS8xjxBe6uFjakG136A%2F7cfMlNRnx071vXJ5t%2FnQ0DZo2Y862T0BMLrHkL3Pal5DQwlhftJzzG0wIFtIf3KfvhKUoOTyenebyJM9PSNwU%2Faz7Lk6mjCUBlIcBPoaXxLvWVV5GfzpPmZeYyz44K91%2B%2BJNPxEcwRShDiit42CCyNfZyC8VIfo21uwKB4nV6gkhX8R%2Blh0KSG1wieFtWcFGCxcDONA9mTKdk1sq7POkUsFpKtFYS%2BgWPlrqp9a%2FEOoUGn3Q91oQVzp5eFzuVvos0aQZvs39%2Bw%3D%3D\u0026X-Amz-Signature=493d8d7b683827bcd756f24ae710b60741e3852625f30f82c9a6ca390991d741","file_size":86248,"type":"image/png"},{"id":75883,"file_name":"Recording__1.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/075/883/03271b7aa7516ea591a932c3e321192145b491bf/Recording__1.mp4?response-content-disposition=attachment%3B%20filename%3D%22Recording__1.mp4%22%3B%20filename%2A%3DUTF-8%27%27Recording__1.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ65C6B2IJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042001Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDUDlftdKCwahQOnPUKizOkg2EzWpa90Y7MV2cJRjoCFAiEA7Y2OQGIwYjcI2ewX5wzy7TrFHvDUf%2BCIL8e2DBoQ8fsqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKstxWWwDBb9kBJ3SSqRAyYWn3xpHc0USlh6j0wUSD0P5lO2wLxrjvfOA2dyjKZVBt1gxJU12nqIqX3KIg9FMETGEwUxbJSTMSoAcGPp86A4SMVO8Ppo%2FbSGSoejkYE57Bm25m03qu80tv22vPGnS25uBEQwCGHzeB2vvgj1L%2F15%2FdzT0%2BG4%2F74LUGHuubNg%2B1XOneA7L7zqEmAAr70tzAVWPrguJqems75lbK%2BgcQwymG9sVI%2Fc6Td6ZStY2vC4MGQhtj%2FB2Gxx7UAazrOqjIGb1G9qSrFARMAiCA7vgzOMlozejJvfAqou2z6NM3lDtH8wHmf%2B04QN5xiDr1wHZOWKVAIeC5Ng5ZOHrGZHtIwdpNYeb2lpY41KE2SAlCRzfQencarj%2BFbPOGd%2BdHnCDIJlkJ1M1OhMbkMpBhgRTzJvpjEERD9SlENQz5LcU8UE9skEafYGlX74JBQCbHp8ggo6mahYoFYYmhlSHgdatm%2B%2B80xz%2FD0LdF7MbyN1WO9WSpnnpVn2rGssLX2aL6wHE4ounfUDQ%2B4P4CmCmYXO1gdWMISXqv8FOusBPH9k2FVakiaEQK4YvWltErNybc3TWS8xjxBe6uFjakG136A%2F7cfMlNRnx071vXJ5t%2FnQ0DZo2Y862T0BMLrHkL3Pal5DQwlhftJzzG0wIFtIf3KfvhKUoOTyenebyJM9PSNwU%2Faz7Lk6mjCUBlIcBPoaXxLvWVV5GfzpPmZeYyz44K91%2B%2BJNPxEcwRShDiit42CCyNfZyC8VIfo21uwKB4nV6gkhX8R%2Blh0KSG1wieFtWcFGCxcDONA9mTKdk1sq7POkUsFpKtFYS%2BgWPlrqp9a%2FEOoUGn3Q91oQVzp5eFzuVvos0aQZvs39%2Bw%3D%3D\u0026X-Amz-Signature=22443daa7f71e4daafdc10370ff78c862e63893781026ffcb9d07440387b5ece","file_size":386814,"type":"video/mp4"}],"allow_singular_disclosure_at":"2017-04-02T16:32:37.110Z","allow_singular_disclosure_after":-118064844.53006263,"singular_disclosure_allowed":true,"vote_count":49,"voters":["delimitry","adn","bl4de","spam404","gerben_javado","ta8ahi","ngalog","ysx","tungpun","xsam","and 39 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":817907,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T23:29:26.988Z","updated_at":"2016-02-29T23:29:26.988Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818075,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T01:40:34.413Z","updated_at":"2016-03-01T01:40:34.413Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818372,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm this is fixed!","markdown_message":"\u003cp\u003eI can confirm this is fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T08:31:59.895Z","updated_at":"2016-03-01T08:31:59.895Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":824728,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-04T18:46:08.457Z","updated_at":"2016-03-04T18:46:08.457Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"filedescriptor","url":"/filedescriptor"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517722,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-03T16:32:37.081Z","updated_at":"2017-03-03T16:32:37.081Z","first_to_agree":true,"actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1579013,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-02T16:32:42.060Z","updated_at":"2017-04-02T16:32:42.060Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}