{"id":36279,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjI3OQ==","url":"https://hackerone.com/reports/36279","title":"Adobe Flash Player MP4 Use-After-Free Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-11-17T06:20:07.759Z","submitted_at":"2014-11-17T06:20:07.759Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hhj4ck","url":"/hhj4ck","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-11T04:19:11.042Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-02-09T04:19:02.223Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Summary\r\nAdobe Flash Player is prone to a vulnerability which leads to Use-After-Free. After parsing a malformed mp4 file, Flash will not free the NetStream object properly. Such memory block is still accessed even the page containing Flash is closed, which leads to a memory crash. \r\n------------------------------------------------------------------\r\nII. Description\r\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. NetStream object can load and play an external mp4 file. \r\nAfter playing a mp4 file, Flash will keep on accessing the memory saving the media object. A malformed mp4 file will trick the Flash to believe that this film never ends. The accessing continues even the web page containing Flash is closing. Closing the page release Flash from the memory space, while the accessing is still going on via a standalone thread. \r\nThere are two possible types of crash depending on the order of different blocks' release:\r\n1. If the media object memory is freed first, then the memory crash is caused by accessing freed memory.\r\n2. If the meida object is freed later, the crash is caused by executing freed memory.\r\nEach of the two possible types of crash may by exploited by carefully crafted mp4 file which could lead to code execution.\r\n\r\nPOC and its source code are attached.   \r\n------------------------------------------------------------------\r\nIII. Impact\r\nUse-After-Free\r\n------------------------------------------------------------------\r\nIV. Affected\r\nAdobe Flash Player (verion \u003e10)\r\n------------------------------------------------------------------\r\nV. Reference\r\nhttp://helpx.adobe.com/security/products/flash-player/apsb14-24.html\r\nIt has been asigned as CVE-2014-8438\r\n------------------------------------------------------------------\r\nVI. Credit\r\nLiu Jincheng and Wen Guanxing from Venustech ADLAB are credited for this vulnerability.","vulnerability_information_html":"\u003cp\u003eI. Summary\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-is-prone-to-a-vulnerability-which-leads-to-use-after-free-after-parsing-a-malformed-mp4-file-flash-will-not-free-the-netstream-object-properly-such-memory-block-is-still-accessed-even-the-page-containing-flash-is-closed-which-leads-to-a-memory-crash\"\u003eAdobe Flash Player is prone to a vulnerability which leads to Use-After-Free. After parsing a malformed mp4 file, Flash will not free the NetStream object properly. Such memory block is still accessed even the page containing Flash is closed, which leads to a memory crash. \u003c/h2\u003e\n\n\u003cp\u003eII. Description\u003cbr\u003e\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. NetStream object can load and play an external mp4 file. \u003cbr\u003e\nAfter playing a mp4 file, Flash will keep on accessing the memory saving the media object. A malformed mp4 file will trick the Flash to believe that this film never ends. The accessing continues even the web page containing Flash is closing. Closing the page release Flash from the memory space, while the accessing is still going on via a standalone thread. \u003cbr\u003e\nThere are two possible types of crash depending on the order of different blocks\u0026#39; release:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIf the media object memory is freed first, then the memory crash is caused by accessing freed memory.\u003c/li\u003e\n\u003cli\u003eIf the meida object is freed later, the crash is caused by executing freed memory.\nEach of the two possible types of crash may by exploited by carefully crafted mp4 file which could lead to code execution.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"poc-and-its-source-code-are-attached\"\u003ePOC and its source code are attached.   \u003c/h2\u003e\n\n\u003cp\u003eIII. Impact\u003c/p\u003e\n\n\u003ch2 id=\"use-after-free\"\u003eUse-After-Free\u003c/h2\u003e\n\n\u003cp\u003eIV. Affected\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-verion-10\"\u003eAdobe Flash Player (verion \u0026gt;10)\u003c/h2\u003e\n\n\u003cp\u003eV. Reference\u003cbr\u003e\n\u003ca title=\"http://helpx.adobe.com/security/products/flash-player/apsb14-24.html\" href=\"/redirect?url=http%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb14-24.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://helpx.adobe.com/security/products/flash-player/apsb14-24.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"it-has-been-asigned-as-cve-2014-8438\"\u003eIt has been asigned as CVE-2014-8438\u003c/h2\u003e\n\n\u003cp\u003eVI. Credit\u003cbr\u003e\nLiu Jincheng and Wen Guanxing from Venustech ADLAB are credited for this vulnerability.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":20877,"file_name":"mp4_UAF_.rar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/020/877/982abae0ee82ae357323607f59df5cacadc87146/mp4_UAF_.rar?response-content-disposition=attachment%3B%20filename%3D%22mp4_UAF_.rar%22%3B%20filename%2A%3DUTF-8%27%27mp4_UAF_.rar\u0026response-content-type=application%2Fx-rar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054351Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=bdccdc026975a6fef51f8a82e36a04670326b6edd0048e575813fc1aae6c4071","file_size":692806,"type":"application/x-rar"}],"allow_singular_disclosure_at":"2015-03-11T04:19:02.552Z","allow_singular_disclosure_after":-183173088.4966278,"singular_disclosure_allowed":true,"vote_count":1,"voters":["muhammad_uwais"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":328029,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:18:48.914Z","updated_at":"2015-02-09T04:18:48.914Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hhj4ck","url":"/hhj4ck"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328030,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:18:54.932Z","updated_at":"2015-02-09T04:18:54.932Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"2000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"hhj4ck","url":"/hhj4ck"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328031,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:02.262Z","updated_at":"2015-02-09T04:19:02.262Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350730,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T04:19:11.089Z","updated_at":"2015-03-11T04:19:11.089Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}