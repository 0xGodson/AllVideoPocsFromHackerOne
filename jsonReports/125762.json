{"id":125762,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU3NjI=","url":"https://hackerone.com/reports/125762","title":"Reflected XSS on Zomato API","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-24T18:35:58.767Z","submitted_at":"2016-03-24T18:35:58.767Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"murat","url":"/murat","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-27T08:46:33.934Z","bug_reporter_agreed_on_going_public_at":"2016-05-27T08:38:43.229Z","team_member_agreed_on_going_public_at":"2016-05-27T08:46:33.876Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"First of all [here] (https://hackerone.com/reports/115402) is another report looks like this report. \n\nZomato using APIs for developers to create their restaurant search etc. \n\nYou are using res_search_widget which is can be seen right [here] (https://www.zomato.com/widgets/res_search_widget.php). \n\nIn the report which is 115402 number that i mentioned start of the report, reporter say something like this: \n\nI use a piece of javascript code that creates an alert box with the document.domain, which shows the SOP is bypassed: \"}');alert(document.domain);console.log('.  But you dont need to add something to your API or widget code. You should only use '\"\u003e characters to bypass security and have xss alert.\n\nSo, here is xss:\n\nJust go to your widget from [here](https://www.zomato.com/widgets/res_search_widget.php).\n\nAnd just write this payload:\n\n`'--\u003e\"\u003e'\u003e'\"\u003cscript\u003eprompt(document.domain)\u003c/script\u003e;\" f0r=TRUE`\n\nHere is your alert.\n\n","vulnerability_information_html":"\u003cp\u003eFirst of all \u003ca href=\"https://hackerone.com/reports/115402\"\u003ehere\u003c/a\u003e is another report looks like this report. \u003c/p\u003e\n\n\u003cp\u003eZomato using APIs for developers to create their restaurant search etc. \u003c/p\u003e\n\n\u003cp\u003eYou are using res_search_widget which is can be seen right \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fwidgets%2Fres_search_widget.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eIn the report which is 115402 number that i mentioned start of the report, reporter say something like this: \u003c/p\u003e\n\n\u003cp\u003eI use a piece of javascript code that creates an alert box with the document.domain, which shows the SOP is bypassed: \u0026quot;}\u0026#39;);alert(document.domain);console.log(\u0026#39;.  But you dont need to add something to your API or widget code. You should only use \u0026#39;\u0026quot;\u0026gt; characters to bypass security and have xss alert.\u003c/p\u003e\n\n\u003cp\u003eSo, here is xss:\u003c/p\u003e\n\n\u003cp\u003eJust go to your widget from \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fwidgets%2Fres_search_widget.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAnd just write this payload:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e\u0026#39;--\u0026gt;\u0026quot;\u0026gt;\u0026#39;\u0026gt;\u0026#39;\u0026quot;\u0026lt;script\u0026gt;prompt(document.domain)\u0026lt;/script\u0026gt;;\u0026quot; f0r=TRUE\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eHere is your alert.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":81082,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/082/d344a6c9146345e573f29b6f298082759c361530/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042238Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=a1bb9f92e9fb06c943d4d8fb9adce359770cd4fd5b49f7dd105a3b8cb215de3d","file_size":101358,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-26T08:38:43.313Z","allow_singular_disclosure_after":-142285435.47589198,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":874095,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @shield ,\nThanks for your detailed report. We are investigating this issue.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/shield\"\u003e@shield\u003c/a\u003e ,\u003cbr\u003e\nThanks for your detailed report. We are investigating this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T09:54:41.326Z","updated_at":"2016-03-28T09:54:41.326Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":874229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vinothzomato who is the shield? Its not me :)","markdown_message":"\u003cp\u003e\u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e who is the shield? Its not me :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T11:52:12.018Z","updated_at":"2016-03-28T11:52:12.018Z","actor":{"username":"murat","cleared":false,"url":"/murat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":874256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry @murat. It was a typo :)","markdown_message":"\u003cp\u003esorry \u003ca href=\"/murat\"\u003e@murat\u003c/a\u003e. It was a typo :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T12:18:40.689Z","updated_at":"2016-03-28T12:18:40.689Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":874257,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am just kidding :) np @vinothzomato ","markdown_message":"\u003cp\u003eI am just kidding :) np \u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-28T12:19:28.087Z","updated_at":"2016-03-28T12:19:28.087Z","actor":{"username":"murat","cleared":false,"url":"/murat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":948822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAny update?","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAny update?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-10T14:40:18.237Z","updated_at":"2016-05-10T14:40:18.237Z","actor":{"username":"murat","cleared":false,"url":"/murat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":986758,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for keeping @Zomato safe.","markdown_message":"\u003cp\u003eThanks for keeping \u003ca href=\"/zomato\"\u003e@Zomato\u003c/a\u003e safe.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-27T08:29:49.608Z","updated_at":"2016-05-27T08:29:49.608Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"murat","url":"/murat"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":986775,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public? Thanks! :)","markdown_message":"\u003cp\u003ePublic? Thanks! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-27T08:38:43.254Z","updated_at":"2016-05-27T08:38:43.254Z","first_to_agree":true,"actor":{"username":"murat","cleared":false,"url":"/murat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":986799,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T08:46:33.900Z","updated_at":"2016-05-27T08:46:33.900Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":986800,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T08:46:33.952Z","updated_at":"2016-05-27T08:46:33.952Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5206785,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T14:51:23.552Z","updated_at":"2019-06-27T14:51:23.552Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}