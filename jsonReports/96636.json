{"id":96636,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjYzNg==","url":"https://hackerone.com/reports/96636","title":"Password Reset - query param overrides postdata","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-29T20:31:00.808Z","submitted_at":"2015-10-29T20:31:00.808Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reecer","url":"/reecer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/605/a4cd4a53e000620f20da70b8918427f5f7704129_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":513,"url":"https://hackerone.com/snapchat","handle":"snapchat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Snapchat","twitter_handle":"","website":"https://www.snapchat.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-24T18:49:30.262Z","bug_reporter_agreed_on_going_public_at":"2015-11-26T00:44:50.627Z","team_member_agreed_on_going_public_at":"2015-12-24T18:49:30.062Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Suppose a user were to reset their password at the following url (with the given query parameters):\n```\nhttps://accounts.snapchat.com/accounts/change_password?\nnewpassword={someNewPass}\u0026newpassword2={someNewPass}\n```\nThen regardless of the new password entered into the form, `{someNewPass}` becomes the user's new password.  This becomes malicious when an attacker refers a users to this url which contains these query parameters to change the user's password.\n\nEven though this requires some level of social engineering -- convincing a user (whose username is known) not only to change his/her password, but do so via a given url -- I don't see a good reason to allow this behavior. Bottom line, _don't read username/passwords from query string_.\n\nI look forward to your response.","vulnerability_information_html":"\u003cp\u003eSuppose a user were to reset their password at the following url (with the given query parameters):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://accounts.snapchat.com/accounts/change_password?\nnewpassword={someNewPass}\u0026amp;newpassword2={someNewPass}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen regardless of the new password entered into the form, \u003ccode\u003e{someNewPass}\u003c/code\u003e becomes the user\u0026#39;s new password.  This becomes malicious when an attacker refers a users to this url which contains these query parameters to change the user\u0026#39;s password.\u003c/p\u003e\n\n\u003cp\u003eEven though this requires some level of social engineering -- convincing a user (whose username is known) not only to change his/her password, but do so via a given url -- I don\u0026#39;t see a good reason to allow this behavior. Bottom line, \u003cu\u003edon\u0026#39;t read username/passwords from query string\u003c/u\u003e.\u003c/p\u003e\n\n\u003cp\u003eI look forward to your response.\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-26T00:44:50.812Z","allow_singular_disclosure_after":-158135467.23086637,"singular_disclosure_allowed":true,"vote_count":3,"voters":["michiel","mysteryboy456","mohacker"],"structured_scope":{"databaseId":11827,"asset_type":"URL","asset_identifier":"accounts.snapchat.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":657367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Reecer,\n\nCongratulations! Your report won second place in the October bug bounty competition! The panel met and assigned this reward a base value of $750. Since you got second place in the competition, this base reward gets a 2x multiplier, bringing you to a total reward of $1500.\n\nWe generally pay out for reports when the bug is fixed, but we wanted to give you a head’s up and congratulate you on winning second place in the contest. We really appreciate your assistance in reporting this issue to help improve Snapchat’s security posture.\n\nWe are aiming to fix this within the next week or two, so hang tight - we’ll get your bounty to you soon.\n\nThanks again for your help, and good luck on your future bug hunting!\n\nWarmest regards,\nDaniel","markdown_message":"\u003cp\u003eHi Reecer,\u003c/p\u003e\n\n\u003cp\u003eCongratulations! Your report won second place in the October bug bounty competition! The panel met and assigned this reward a base value of $750. Since you got second place in the competition, this base reward gets a 2x multiplier, bringing you to a total reward of $1500.\u003c/p\u003e\n\n\u003cp\u003eWe generally pay out for reports when the bug is fixed, but we wanted to give you a head’s up and congratulate you on winning second place in the contest. We really appreciate your assistance in reporting this issue to help improve Snapchat’s security posture.\u003c/p\u003e\n\n\u003cp\u003eWe are aiming to fix this within the next week or two, so hang tight - we’ll get your bounty to you soon.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your help, and good luck on your future bug hunting!\u003c/p\u003e\n\n\u003cp\u003eWarmest regards,\u003cbr\u003e\nDaniel\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-13T23:16:05.286Z","updated_at":"2015-11-13T23:16:05.286Z","actor":{"username":"hwangd","cleared":false,"url":"/hwangd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657373,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-13T23:17:15.803Z","updated_at":"2015-11-13T23:17:15.803Z","actor":{"username":"hwangd","cleared":false,"url":"/hwangd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":660411,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Reecer,\n\nWe just pushed a fix according to your bug report earlier today and believe that it is working as intended now. Please let us know if this fix is sufficient.\n\nAs we mentioned last week, we have decided to award you with $1500 for your report.\n\nThanks again for your help, and good luck on your future bug hunting!\n\nThanks,\nDaniel","markdown_message":"\u003cp\u003eHi Reecer,\u003c/p\u003e\n\n\u003cp\u003eWe just pushed a fix according to your bug report earlier today and believe that it is working as intended now. Please let us know if this fix is sufficient.\u003c/p\u003e\n\n\u003cp\u003eAs we mentioned last week, we have decided to award you with $1500 for your report.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your help, and good luck on your future bug hunting!\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDaniel\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-17T00:19:28.676Z","updated_at":"2015-11-17T00:19:28.676Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Snapchat"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"reecer","url":"/reecer"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":660412,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-17T00:19:38.386Z","updated_at":"2015-11-17T00:19:38.386Z","actor":{"username":"hwangd","cleared":false,"url":"/hwangd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"reecer","url":"/reecer"},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":660443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Daniel,\nIt indeed appears fixed! Good work and thanks for the reward.\n\n-Reece","markdown_message":"\u003cp\u003eHi Daniel,\u003cbr\u003e\nIt indeed appears fixed! Good work and thanks for the reward.\u003c/p\u003e\n\n\u003cp\u003e-Reece\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-17T00:46:56.836Z","updated_at":"2015-11-17T00:46:56.836Z","actor":{"username":"reecer","cleared":false,"url":"/reecer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/605/a4cd4a53e000620f20da70b8918427f5f7704129_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":699671,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'd like to reference this for job applications.","markdown_message":"\u003cp\u003eI\u0026#39;d like to reference this for job applications.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-26T00:44:50.673Z","updated_at":"2015-11-26T00:44:50.673Z","first_to_agree":true,"actor":{"username":"reecer","cleared":false,"url":"/reecer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/605/a4cd4a53e000620f20da70b8918427f5f7704129_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":732134,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This bug was a result of the server being unable to distinguish GET and POST parameters, oftentimes defaulting to using a GET parameter value over that of a POST parameter. \nIf an attacker convinced a user to visit a URL with the attacker-specified password as a parameter, then if the user provided their current password and solved the CAPTCHA, this could allow an attacker to overwrite the user's credentials. The attacker would specify \"newpassword\" and \"newpassword2\" GET parameters which would override the POST values that the user specified - thus, changing the user's password to the attacker-known value.","markdown_message":"\u003cp\u003eThis bug was a result of the server being unable to distinguish GET and POST parameters, oftentimes defaulting to using a GET parameter value over that of a POST parameter. \u003cbr\u003e\nIf an attacker convinced a user to visit a URL with the attacker-specified password as a parameter, then if the user provided their current password and solved the CAPTCHA, this could allow an attacker to overwrite the user\u0026#39;s credentials. The attacker would specify \u0026quot;newpassword\u0026quot; and \u0026quot;newpassword2\u0026quot; GET parameters which would override the POST values that the user specified - thus, changing the user\u0026#39;s password to the attacker-known value.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-24T18:49:30.101Z","updated_at":"2015-12-24T18:49:30.101Z","actor":{"username":"hwangd","cleared":false,"url":"/hwangd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":732135,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-24T18:49:30.299Z","updated_at":"2015-12-24T18:49:30.299Z","actor":{"username":"hwangd","cleared":false,"url":"/hwangd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9804083,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-12T16:44:54.518Z","updated_at":"2020-11-12T16:44:54.518Z","actor":{"username":"apfeifer_sc","cleared":false,"url":"/apfeifer_sc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"accounts.snapchat.com","genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1156,"category":"team","content":"This bug was a result of the server being unable to distinguish GET and POST parameters, oftentimes defaulting to using a GET parameter value over that of a POST parameter. If an attacker convinced a user to visit a URL with the attacker-specified password as a parameter, then if the user provided their current password and solved the CAPTCHA, this could allow an attacker to overwrite the user's credentials. The attacker would specify \"newpassword\" and \"newpassword2\" GET parameters which would override the POST values that the user specified - thus, changing the user's password to the attacker-known value.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis bug was a result of the server being unable to distinguish GET and POST parameters, oftentimes defaulting to using a GET parameter value over that of a POST parameter. If an attacker convinced a user to visit a URL with the attacker-specified password as a parameter, then if the user provided their current password and solved the CAPTCHA, this could allow an attacker to overwrite the user\u0026#39;s credentials. The attacker would specify \u0026quot;newpassword\u0026quot; and \u0026quot;newpassword2\u0026quot; GET parameters which would override the POST values that the user specified - thus, changing the user\u0026#39;s password to the attacker-known value.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}