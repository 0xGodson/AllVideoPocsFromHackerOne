{"id":126539,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjY1Mzk=","url":"https://hackerone.com/reports/126539","title":"XSS on https://app.shopify.com/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-28T17:48:52.852Z","submitted_at":"2016-03-28T17:48:52.852Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"secalert","url":"/secalert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QH4YfDe1RhH4dK8KndjwJwCu/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-05T08:29:48.669Z","bug_reporter_agreed_on_going_public_at":"2016-04-05T08:29:48.403Z","team_member_agreed_on_going_public_at":"2016-04-04T22:52:01.514Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"DESCRIPTION\n===========\nIt has been identified that the page located at https://app.shopify.com/ is prone to cross-site scripting issues. Cross-site Scripting (XSS) refers to client-side code injection attack wherein an attacker can execute malicious scripts (also commonly referred to as a malicious payload) into a legitimate website or web application. \n\nIMPACT\n======\nA XSS vulnerability arises when web applications take data from users and dynamically include it in web pages without first properly validating the data. XSS vulnerabilities allow an attacker to execute arbitrary commands and display arbitrary content in a victim user's browser. A successful XSS attack leads to\nan attacker controlling the victim’s browser or account on the vulnerable web application. \n\nTEST ENVIRONMENT\n=================\n1) Google Chrome 49.0.2623.75 (64-bit) on Mac OS X 10.11.3\n2) Firefox 45.0 on Mac OS X 10.11.3\n\nPROOF OF CONCEPT\n=================\nSteps to reproduce:\n1) Login.\n2) Visit the following page: https://app.shopify.com/services/partners?signup=confirm(document.domain)\u0026signup_action=whitehat_signup\n\nThe „signup“ param will execute the passed javascript code and will be rendered like this:\n\n```javascript\nPage(function() {\nPartners.VapSignupFunnel.partnerDashboardPageLoad(confirm(document.domain));\nreturn {};\n});\n```\n\nSCREENSHOT\n===========\nScreenshots are attached.\n\nREMEDIATION\n===========\n1) All input should be neutralized before being reflected back to client (i.e.\nbrowser), not just parameters that the user is supposed to specify, but all data\nin the request, including hidden fields, cookies, headers, the URL itself, and\nso forth.\n\n2) Make use of entity encoding in the used context. See also:\nhttps://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\n\nCREDITS\n========\nDavid Vieira-Kurz aka @secalert (https://hackerone.com/secalert)","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDESCRIPTION\u003c/h1\u003e\n\n\u003cp\u003eIt has been identified that the page located at \u003ca title=\"https://app.shopify.com/\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is prone to cross-site scripting issues. Cross-site Scripting (XSS) refers to client-side code injection attack wherein an attacker can execute malicious scripts (also commonly referred to as a malicious payload) into a legitimate website or web application. \u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eIMPACT\u003c/h1\u003e\n\n\u003cp\u003eA XSS vulnerability arises when web applications take data from users and dynamically include it in web pages without first properly validating the data. XSS vulnerabilities allow an attacker to execute arbitrary commands and display arbitrary content in a victim user\u0026#39;s browser. A successful XSS attack leads to\u003cbr\u003e\nan attacker controlling the victim’s browser or account on the vulnerable web application. \u003c/p\u003e\n\n\u003ch1 id=\"test-environment\"\u003eTEST ENVIRONMENT\u003c/h1\u003e\n\n\u003cp\u003e1) Google Chrome 49.0.2623.75 (64-bit) on Mac OS X 10.11.3\u003cbr\u003e\n2) Firefox 45.0 on Mac OS X 10.11.3\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003ePROOF OF CONCEPT\u003c/h1\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\n1) Login.\u003cbr\u003e\n2) Visit the following page: \u003ca title=\"https://app.shopify.com/services/partners?signup=confirm(document.domain)\u0026amp;signup_action=whitehat_signup\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2Fservices%2Fpartners%3Fsignup%3Dconfirm%28document.domain%29%26signup_action%3Dwhitehat_signup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com/services/partners?signup=confirm(document.domain)\u0026amp;signup_action=whitehat_signup\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe „signup“ param will execute the passed javascript code and will be rendered like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003ePage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ePartners\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eVapSignupFunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epartnerDashboardPageLoad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econfirm\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edomain\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"screenshot\"\u003eSCREENSHOT\u003c/h1\u003e\n\n\u003cp\u003eScreenshots are attached.\u003c/p\u003e\n\n\u003ch1 id=\"remediation\"\u003eREMEDIATION\u003c/h1\u003e\n\n\u003cp\u003e1) All input should be neutralized before being reflected back to client (i.e.\u003cbr\u003e\nbrowser), not just parameters that the user is supposed to specify, but all data\u003cbr\u003e\nin the request, including hidden fields, cookies, headers, the URL itself, and\u003cbr\u003e\nso forth.\u003c/p\u003e\n\n\u003cp\u003e2) Make use of entity encoding in the used context. See also:\u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FXSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"credits\"\u003eCREDITS\u003c/h1\u003e\n\n\u003cp\u003eDavid Vieira-Kurz aka \u003ca href=\"/secalert\"\u003e@secalert\u003c/a\u003e (\u003ca title=\"https://hackerone.com/secalert\" href=\"https://hackerone.com/secalert\"\u003ehttps://hackerone.com/secalert\u003c/a\u003e)\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":81766,"file_name":"shopify-xss-2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/766/53749fb11565cca84f0237dd1953e19d7f4eea24/shopify-xss-2.png?response-content-disposition=attachment%3B%20filename%3D%22shopify-xss-2.png%22%3B%20filename%2A%3DUTF-8%27%27shopify-xss-2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042306Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=15285f2b16a6167ae7394e42ac00de0f15afe927216e30f1bdc29f50af4683c8","file_size":214847,"type":"image/png"},{"id":81767,"file_name":"shopify-xss-1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/767/7ff9b3f47cadc8a7938a90dcc31c9d3435b97b1a/shopify-xss-1.png?response-content-disposition=attachment%3B%20filename%3D%22shopify-xss-1.png%22%3B%20filename%2A%3DUTF-8%27%27shopify-xss-1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042306Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=b1547857f7cf9fe8a332e20d5130cb6981c77f06ea83cfb65c58ae12b41327f5","file_size":493688,"type":"image/png"}],"allow_singular_disclosure_at":"2016-05-04T22:52:01.818Z","allow_singular_disclosure_after":-146813464.81003538,"singular_disclosure_allowed":true,"vote_count":2,"voters":["inhibitor181","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":878004,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your report. We recently rolled out a fix for this issue.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThank you for your report. We recently rolled out a fix for this issue.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-30T13:41:29.863Z","updated_at":"2016-03-30T13:41:29.863Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"secalert","url":"/secalert"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":888719,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify! This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T22:51:45.029Z","updated_at":"2016-04-04T22:51:45.029Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"secalert","url":"/secalert"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":888721,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T22:52:01.546Z","updated_at":"2016-04-04T22:52:01.546Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":889281,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Huge thanks for the bounty. :)  Yes, i agree to disclose this report publicly.","markdown_message":"\u003cp\u003eHuge thanks for the bounty. :)  Yes, i agree to disclose this report publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-05T08:29:48.451Z","updated_at":"2016-04-05T08:29:48.451Z","actor":{"username":"secalert","cleared":false,"url":"/secalert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QH4YfDe1RhH4dK8KndjwJwCu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":889282,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-05T08:29:48.691Z","updated_at":"2016-04-05T08:29:48.691Z","actor":{"username":"secalert","cleared":false,"url":"/secalert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QH4YfDe1RhH4dK8KndjwJwCu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}