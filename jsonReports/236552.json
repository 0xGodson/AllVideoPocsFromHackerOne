{"id":236552,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzY1NTI=","url":"https://hackerone.com/reports/236552","title":"Unauthenticated RCE in Vaultpress","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-06-05T10:28:51.711Z","submitted_at":"2017-06-05T10:28:51.711Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b258ea62bf297b02afa9854","url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-15T12:51:38.159Z","bug_reporter_agreed_on_going_public_at":"2017-08-16T12:51:21.119Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hitting wordpress instalattion with vaultpress on it with get parameter vaultpress=true attacker is one method away from RCE and that method is **validate_api_signature**.\n\nIn this method we have the following constraints:\n1. Firewall\n2. Usage (recomended) of openssl to validate API call\n\nIn case of disabled firewall or its bypass ( easy on many configurations, specially the ones behind proxy/balancer servers ) then in case of usage of openssl to verify the signature we have easy bypass because unsafe usage of **openssl_verify** PHP function.\n\n```\nif ( $this-\u003ecan_use_openssl() ) {\n\t\t\t\n\t\t\t$sslsig = '';\n\t\t\tif ( isset( $post['sslsig'] ) ) {\n\t\t\t\t$sslsig = $post['sslsig'];\n\t\t\t\tunset( $post['sslsig'] );\n\t\t\t}\n\t\t\tif ( openssl_verify( serialize( array( 'uri' =\u003e $uri, 'post' =\u003e $post ) ), base64_decode( $sslsig ), $this-\u003eget_option( 'public_key' ) ) ) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\t$__vp_validate_error = array( 'error' =\u003e 'invalid_signed_data' );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n```\nThis function **openssl_verify** have 3 possible values as result value: \n- int(1) success \n- int(0) failure to verify\n- int(-1) error \n\nbut we all know that \n```\nif (-1) {echo \"Hi RCE\";}\n```\nwill print **Hi RCE**\n\nProposed fix:\n```\nif ( openssl_verify( serialize( array( 'uri' =\u003e $uri, 'post' =\u003e $post ) ), base64_decode( $sslsig ), $this-\u003eget_option( 'public_key' ) ) ===1 ) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\t$__vp_validate_error = array( 'error' =\u003e 'invalid_signed_data' );\n\t\t\t\treturn false;\n\t\t\t}\n```\nIn order to get the idea how to cause **openssl_verify** to return -1all you need is to provide valid signature towards public key from different type. Check the uploaded files and execute them in the CMD in the following order:\n```\nphp genkey1.php\nphp genkey2.php\nphp PoC.php\n```\n","vulnerability_information_html":"\u003cp\u003eHitting wordpress instalattion with vaultpress on it with get parameter vaultpress=true attacker is one method away from RCE and that method is \u003cstrong\u003evalidate_api_signature\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eIn this method we have the following constraints:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFirewall\u003c/li\u003e\n\u003cli\u003eUsage (recomended) of openssl to validate API call\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn case of disabled firewall or its bypass ( easy on many configurations, specially the ones behind proxy/balancer servers ) then in case of usage of openssl to verify the signature we have easy bypass because unsafe usage of \u003cstrong\u003eopenssl_verify\u003c/strong\u003e PHP function.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif ( $this-\u0026gt;can_use_openssl() ) {\n\n            $sslsig = \u0026#39;\u0026#39;;\n            if ( isset( $post[\u0026#39;sslsig\u0026#39;] ) ) {\n                $sslsig = $post[\u0026#39;sslsig\u0026#39;];\n                unset( $post[\u0026#39;sslsig\u0026#39;] );\n            }\n            if ( openssl_verify( serialize( array( \u0026#39;uri\u0026#39; =\u0026gt; $uri, \u0026#39;post\u0026#39; =\u0026gt; $post ) ), base64_decode( $sslsig ), $this-\u0026gt;get_option( \u0026#39;public_key\u0026#39; ) ) ) {\n                return true;\n            } else {\n                $__vp_validate_error = array( \u0026#39;error\u0026#39; =\u0026gt; \u0026#39;invalid_signed_data\u0026#39; );\n                return false;\n            }\n        }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis function \u003cstrong\u003eopenssl_verify\u003c/strong\u003e have 3 possible values as result value: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eint(1) success \u003c/li\u003e\n\u003cli\u003eint(0) failure to verify\u003c/li\u003e\n\u003cli\u003eint(-1) error \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ebut we all know that \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif (-1) {echo \u0026quot;Hi RCE\u0026quot;;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewill print \u003cstrong\u003eHi RCE\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eProposed fix:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif ( openssl_verify( serialize( array( \u0026#39;uri\u0026#39; =\u0026gt; $uri, \u0026#39;post\u0026#39; =\u0026gt; $post ) ), base64_decode( $sslsig ), $this-\u0026gt;get_option( \u0026#39;public_key\u0026#39; ) ) ===1 ) {\n                return true;\n            } else {\n                $__vp_validate_error = array( \u0026#39;error\u0026#39; =\u0026gt; \u0026#39;invalid_signed_data\u0026#39; );\n                return false;\n            }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn order to get the idea how to cause \u003cstrong\u003eopenssl_verify\u003c/strong\u003e to return -1all you need is to provide valid signature towards public key from different type. Check the uploaded files and execute them in the CMD in the following order:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ephp genkey1.php\nphp genkey2.php\nphp PoC.php\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","original_report_id":null,"original_report_url":null,"attachments":[{"id":191300,"file_name":"genkey2.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/191/300/344a2d70a66ac330d5ca7d26b064c37299e2de78/genkey2.php?response-content-disposition=attachment%3B%20filename%3D%22genkey2.php%22%3B%20filename%2A%3DUTF-8%27%27genkey2.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050652Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=9ebab833ccc11173057a06aed7cf438fb9cbb651cc7f12091680de409753d4cf","file_size":716,"type":"text/x-php"},{"id":191301,"file_name":"genkey1.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/191/301/40a8794e4d194e8d084f6a85c49da93c6e6e64a1/genkey1.php?response-content-disposition=attachment%3B%20filename%3D%22genkey1.php%22%3B%20filename%2A%3DUTF-8%27%27genkey1.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050652Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=98ea152ab761148def03f8efb8332cc952b16b30ed7d3d53d47845300db50aff","file_size":714,"type":"text/x-php"},{"id":191302,"file_name":"PoC.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/191/302/4a20e2244e6c30767c07fb7ada43f2c4f4667444/PoC.php?response-content-disposition=attachment%3B%20filename%3D%22PoC.php%22%3B%20filename%2A%3DUTF-8%27%27PoC.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050652Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=d6d71915166447ffcb797cb29149ee15e1e1451a3cd75d2c6a487a608c01b328","file_size":249,"type":"text/x-php"}],"allow_singular_disclosure_at":"2017-09-15T12:51:21.193Z","allow_singular_disclosure_after":-103738531.59250356,"singular_disclosure_allowed":true,"vote_count":31,"voters":["marcs0h","flamezzz","bl4de","bogdantcaciuc","cha5m","cuso4","edoverflow","vijay_kumar","eveeez","leet-boy","and 21 more..."],"severity":{"rating":"critical","score":9.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1729826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Thanks for the report. We are going to take a look.","markdown_message":"\u003cp\u003eHi. Thanks for the report. We are going to take a look.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-05T10:38:24.982Z","updated_at":"2017-06-05T10:38:24.982Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1736383,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for reporting this. It's now fixed as of VaultPress 1.9.0 and have pushed this fix out to our users.","markdown_message":"\u003cp\u003eThanks for reporting this. It\u0026#39;s now fixed as of VaultPress 1.9.0 and have pushed this fix out to our users.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-07T01:36:39.766Z","updated_at":"2017-06-07T01:36:39.766Z","actor":{"username":"thingalon","cleared":false,"url":"/thingalon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"b258ea62bf297b02afa9854","url":"/b258ea62bf297b02afa9854"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1743058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, regarding this issue everything seems fine now. I can see the update process towards the clients goes quite fast. Any toughs/previous practices from your side regarding possible future disclosure and possible bounty?  ","markdown_message":"\u003cp\u003eGreat, regarding this issue everything seems fine now. I can see the update process towards the clients goes quite fast. Any toughs/previous practices from your side regarding possible future disclosure and possible bounty?  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-08T22:27:05.762Z","updated_at":"2017-06-08T22:27:05.762Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1745575,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-09T21:04:39.736Z","updated_at":"2017-06-09T21:04:39.736Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"b258ea62bf297b02afa9854","url":"/b258ea62bf297b02afa9854"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1745723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thx for the bounty, tough it was more worth than reflected XSS due its existence in security plugin, but it is your decision. When update completes on wordpress.org I'll request disclosure. :)","markdown_message":"\u003cp\u003eThx for the bounty, tough it was more worth than reflected XSS due its existence in security plugin, but it is your decision. When update completes on wordpress.org I\u0026#39;ll request disclosure. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-09T21:19:00.506Z","updated_at":"2017-06-09T21:19:00.506Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1750942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Extra from my side, another type of bypass / attack against this method in order to get the wanted RCE :) :\n\n```\nif ( $sig[0] === $signature )\n\t\t\treturn true;\n```\nhere we have classic timing attack (effective because its goal - RCE ) and should be replaced with:\n\n```\nif ( hash_equals($signature, $sig[0]))\n\t\t\treturn true;\n```\n\n","markdown_message":"\u003cp\u003eExtra from my side, another type of bypass / attack against this method in order to get the wanted RCE :) :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif ( $sig[0] === $signature )\n            return true;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ehere we have classic timing attack (effective because its goal - RCE ) and should be replaced with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif ( hash_equals($signature, $sig[0]))\n            return true;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-06-12T22:15:14.295Z","updated_at":"2017-06-12T22:15:14.295Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1752543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Yes, we are aware of it. I'll ping again the VaultPress team to see if they can also fix this issue.","markdown_message":"\u003cp\u003eHi. Yes, we are aware of it. I\u0026#39;ll ping again the VaultPress team to see if they can also fix this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-13T12:58:24.446Z","updated_at":"2017-06-13T12:58:24.446Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1752562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"well, isn't 32 byte lenght (~50-100k requests to be defeated, worst case ~400k for md5), but exists and bad thing here is that isn't time limited e.g. could be solved piece by piece in quite big time interval.","markdown_message":"\u003cp\u003ewell, isn\u0026#39;t 32 byte lenght (~50-100k requests to be defeated, worst case ~400k for md5), but exists and bad thing here is that isn\u0026#39;t time limited e.g. could be solved piece by piece in quite big time interval.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-13T13:09:42.463Z","updated_at":"2017-06-13T13:09:42.463Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1786487,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you. This fix has been applied to trunk, and will be released with the next version of VaultPress soon.","markdown_message":"\u003cp\u003eThank you. This fix has been applied to trunk, and will be released with the next version of VaultPress soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-28T01:38:28.040Z","updated_at":"2017-06-28T01:38:28.040Z","actor":{"username":"thingalon","cleared":false,"url":"/thingalon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1794307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"+1","markdown_message":"\u003cp\u003e+1\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T14:50:35.516Z","updated_at":"2017-06-30T14:50:35.516Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1933299,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, patch was supplied more than 2 months ago, update progress is more than good, so in the beginning of September I plan to release public advisories regarding this issue.  ","markdown_message":"\u003cp\u003eHi, patch was supplied more than 2 months ago, update progress is more than good, so in the beginning of September I plan to release public advisories regarding this issue.  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-16T12:51:21.160Z","updated_at":"2017-08-16T12:51:21.160Z","first_to_agree":true,"actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1999297,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T12:51:38.184Z","updated_at":"2017-09-15T12:51:38.184Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}