{"id":95981,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTk4MQ==","url":"https://hackerone.com/reports/95981","title":"Http Response Splitting - Validate link","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-26T23:48:50.529Z","submitted_at":"2015-10-26T23:48:50.529Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gerben_javado","url":"/gerben_javado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2706,"url":"https://hackerone.com/binary","handle":"binary","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/706/4135651e3753f5359487598936cfa85f5bda7f1f_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/706/4135651e3753f5359487598936cfa85f5bda7f1f_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Binary.com","twitter_handle":"binarydotcom","website":"https://www.binary.com","about":"Binary.com is the leading binary options website, founded in 1999."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-15T12:21:01.580Z","bug_reporter_agreed_on_going_public_at":"2015-11-15T12:19:00.435Z","team_member_agreed_on_going_public_at":"2015-11-15T12:21:01.304Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"So i found a http response splitting issue in your website. If we visit the following url:\n\nhttps://www.binary.com/user/validate_link?step=account\u0026verify_token=sometoken\n\nWe will get a response header that says: \n\n    Set-Cookie: verify_token=sometoken; expires=Wed, 28 Oct 2015 23:31:35 GMT; domain=.binary.com; path=/; secure\n\nHowever this value doesnt seem to be urlencoded which gives the attacker the option to create his own response header. For example if you were to visit:\n\nhttps://www.binary.com/user/validate_link?step=account\u0026verify_token=%0aSet-Cookie:%20GerbenJavado=Awesome;%0a\n\nThe following response header will be included in the response: (shameless plug)\n\n    Set-Cookie: GerbenJavado=Awesome;\n\n#Attacker Scenario\nSince this attack doesnt require any user interaction to be exploited, a attacker could do lots of fun stuff using this vulnerability by including a malicious url in a Iframe or even in a IMG tag. \n\n- As the example shows the attacker can set cookies for the user on binary.com\n- The attacker can disable or bypass security headers placed by the server\n\nOne restricition the attacker has is that the request is a redirect. This made it for me impossible to XSS attacks or Cache Poisining. Maybe you guys could look a bit into this further. However i would argue that because of the fact user interaction is not needed and the fact that the attacker can set his own headers (including cookies) the attack is fairly scary.\n\n","vulnerability_information_html":"\u003cp\u003eSo i found a http response splitting issue in your website. If we visit the following url:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.binary.com/user/validate_link?step=account\u0026amp;verify_token=sometoken\" href=\"/redirect?url=https%3A%2F%2Fwww.binary.com%2Fuser%2Fvalidate_link%3Fstep%3Daccount%26verify_token%3Dsometoken\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.binary.com/user/validate_link?step=account\u0026amp;verify_token=sometoken\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe will get a response header that says: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSet-Cookie: verify_token=sometoken; expires=Wed, 28 Oct 2015 23:31:35 GMT; domain=.binary.com; path=/; secure\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever this value doesnt seem to be urlencoded which gives the attacker the option to create his own response header. For example if you were to visit:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.binary.com/user/validate_link?step=account\u0026amp;verify_token=%0aSet-Cookie:%20GerbenJavado=Awesome%3B%0a\" href=\"/redirect?url=https%3A%2F%2Fwww.binary.com%2Fuser%2Fvalidate_link%3Fstep%3Daccount%26verify_token%3D%250aSet-Cookie%3A%2520GerbenJavado%3DAwesome%253B%250a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.binary.com/user/validate_link?step=account\u0026amp;verify_token=%0aSet-Cookie:%20GerbenJavado=Awesome%3B%0a\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe following response header will be included in the response: (shameless plug)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSet-Cookie: GerbenJavado=Awesome;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"attacker-scenario\"\u003eAttacker Scenario\u003c/h1\u003e\n\n\u003cp\u003eSince this attack doesnt require any user interaction to be exploited, a attacker could do lots of fun stuff using this vulnerability by including a malicious url in a Iframe or even in a IMG tag. \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAs the example shows the attacker can set cookies for the user on binary.com\u003c/li\u003e\n\u003cli\u003eThe attacker can disable or bypass security headers placed by the server\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOne restricition the attacker has is that the request is a redirect. This made it for me impossible to XSS attacks or Cache Poisining. Maybe you guys could look a bit into this further. However i would argue that because of the fact user interaction is not needed and the fact that the attacker can set his own headers (including cookies) the attack is fairly scary.\u003c/p\u003e\n","bounty_amount":"75.0","formatted_bounty":"$75","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-15T12:19:00.663Z","allow_singular_disclosure_after":-159044153.71157146,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","apapedulimu","dz_samir","its_afolic","namansahore","snappyjack","wzulfikar"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":643157,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi I checked this bug . And it does seems to a valid issue to me . I will talk with the dev team about it and let you know the updates","markdown_message":"\u003cp\u003eHi I checked this bug . And it does seems to a valid issue to me . I will talk with the dev team about it and let you know the updates\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T17:21:20.554Z","updated_at":"2015-11-03T17:21:20.554Z","actor":{"username":"cyberboy","cleared":true,"url":"/cyberboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/pQbrCr2dJysJYTjJvvMUiMdr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645387,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-04T16:30:30.259Z","updated_at":"2015-11-04T16:30:30.259Z","actor":{"username":"defmax","cleared":false,"url":"/defmax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice find :) @gerben_javado ","markdown_message":"\u003cp\u003eNice find :) \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T16:32:30.123Z","updated_at":"2016-11-24T10:56:04.912Z","actor":{"username":"defmax","cleared":false,"url":"/defmax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645464,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-04T17:11:40.791Z","updated_at":"2015-11-04T17:11:40.791Z","actor":{"username":"defmax","cleared":false,"url":"/defmax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/defmax","username":"defmax"},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655485,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @gerben_javado we have pushed the fixed for it . It seems good from my side . I would like you to confirm the fix.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e we have pushed the fixed for it . It seems good from my side . I would like you to confirm the fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-12T16:42:44.873Z","updated_at":"2016-11-24T10:56:06.252Z","actor":{"username":"cyberboy","cleared":true,"url":"/cyberboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/pQbrCr2dJysJYTjJvvMUiMdr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gerben_javado","url":"/gerben_javado"},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655490,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-12T16:45:09.342Z","updated_at":"2015-11-12T16:45:09.342Z","actor":{"url":"/binary","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/706/4135651e3753f5359487598936cfa85f5bda7f1f_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Binary.com"}},"bounty_amount":"75.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"binary","collaborator":{"username":"gerben_javado","url":"/gerben_javado"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep issue is fixed. Thank you for bounty.","markdown_message":"\u003cp\u003eYep issue is fixed. Thank you for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-12T16:46:59.195Z","updated_at":"2015-11-12T16:46:59.195Z","actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks :)\nkeep hunting \n\n","markdown_message":"\u003cp\u003ethanks :)\u003cbr\u003e\nkeep hunting \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-12T16:47:43.272Z","updated_at":"2015-11-12T16:47:43.272Z","actor":{"username":"cyberboy","cleared":true,"url":"/cyberboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/pQbrCr2dJysJYTjJvvMUiMdr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":658502,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-15T12:19:00.478Z","updated_at":"2015-11-15T12:19:00.478Z","first_to_agree":true,"actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":658504,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-15T12:21:01.348Z","updated_at":"2015-11-15T12:21:01.348Z","actor":{"username":"cyberboy","cleared":true,"url":"/cyberboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/pQbrCr2dJysJYTjJvvMUiMdr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":658505,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-15T12:21:01.610Z","updated_at":"2015-11-15T12:21:01.610Z","actor":{"username":"cyberboy","cleared":true,"url":"/cyberboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/pQbrCr2dJysJYTjJvvMUiMdr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"binary","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}