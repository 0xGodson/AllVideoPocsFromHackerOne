{"id":863553,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjM1NTM=","url":"https://hackerone.com/reports/863553","title":"SSRF protection bypass in /appsuite/api/oxodocumentfilter addfile action","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-30T22:09:41.303Z","submitted_at":"2020-04-30T22:09:41.303Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skr0x1c0","url":"/skr0x1c0","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-27T09:47:32.051Z","bug_reporter_agreed_on_going_public_at":"2020-09-24T07:55:02.144Z","team_member_agreed_on_going_public_at":"2020-11-27T09:47:31.959Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\n\nThe URL validation logic applied when handling `/appsuite/api/oxodocumentfilter\u0026action=addfile` suffers from three defects which can be used to execute Time of Check Time of Use (ToCToU) SSRF attack. This issue allows malicious actors to execute HTTP GET requests on internal network services and may lead to confidential information leak.\n\n## Defect #1: Time of Check Time of Use (ToCToU) vulnerability\n\nURL validation logic in `URITools.getFinalURL` method implemented [here](https://gitlab.open-xchange.com/middleware/core/-/blob/develop/com.openexchange.server/src/com/openexchange/tools/net/URITools.java#L108) suffers from ToCToU vulnerability  \n\n```java\nURL u = new URL(url);\nif (validator.isPresent()) {\n    Optional\u003cOXException\u003e exception = validator.get().apply(u);\n    if (exception.isPresent()) {\n        throw exception.get();\n    }\n}\n\nURLConnection urlConnnection = u.openConnection();\n```\n\nIn the above code, DNS resolution of input URL hostname is done during both time of check (`validator.get().apply(u)`) and time of use (`u.openConnection()`) by calling `InetAddress.getByName` method. So if an attacker can change the DNS resolution result after time of check and before time of use, he can bypass the validator. This defect alone is extremely difficult to exploit because of following limitations\n\n1. By default, `InetAddress.getByName` caches the DNS resolution results for 30 seconds if the DNS resolution succeeds and for 10 seconds if the DNS resolution fails. \n2. Time interval between `validator.get().apply(u)` and `u.openConnection()` is extremely small (less than one millisecond for normal URLs). Defect #2 is used to bypass this limitation\n\n## Defect #2: Length of input URL is not limited\n\nThe URL validator `AddFileAction.validator` implemented [here](https://gitlab.open-xchange.com/documents/office/-/blob/develop/com.openexchange.office.rest/src/com/openexchange/office/rest/AddFileAction.java#L353) does not validate the length of input URL. By providing a URL with large size, the attacker can increase the time interval between `InetAddress.getByName` method calls at time of check and time of use. Larger time interval allows the attacker to easily exploit Defect #1\n\n## Defect #3: URL validator allows input URL if its dns resolution fails\n\n`HostList.contains` method implemented [here](https://gitlab.open-xchange.com/middleware/core/-/blob/develop/com.openexchange.net/src/com/openexchange/net/HostList.java#L234) returns false if the DNS resolution of input URL hostname fails\n\n```java\n// Need to resolve as last resort\ntry {\n    return contains(InetAddress.getByName(toCheck), false);\n} catch (UnknownHostException e) {\n    // Cannot be resolved\n    return false;\n}\n```\n\nThe `AddFileAction.validator` calls `blackImageUrlHostlist.contains` method to check if the input URL hostname or the IP address it resolves to is in blacklist. If an attacker makes the DNS resolution of hostname to fail, the IP address checks are skipped and URL is accepted.\n\n# Attack strategy\n\nConsider a hostname `randomid.dns.pointer.pw` with authoritative nameserver controlled by attacker. Attack strategy is to make the DNS resolution of `randomid.dns.pointer.pw` to fail at time of check (`validator.get().apply(u);`) and to succeed at time of use (`u.openConnection()`). This allows the attacker to bypass IP address blacklist filters and execute HTTP GET request on any blacklisted IP address. Following steps may be followed by attacker to execute this attack\n\n1. Trigger the `InetAddress.getByName` cache on server by executing `addfile` action with request data `{\"add_imageurl\": \"http://randomid.dns.pointer.pw\"}`. At this time, the authoritative DNS server will be set to fail the DNS resolution of `randomid.dns.pointer.pw` by returning `SERVFAIL` status. `InetAddress.getByName` will cache this failure result for 10 seconds\n2. Note the time when above request response was received. This is the cache start time\n3. Tell the authoritative name server of domain `pointer.pw` to return 127.0.0.1 for type A dns requests of hostname `randomid.dns.pointer.pw`\n4. Sleep for specified duration from cache start time such that in the next step `InetAddress.getByName` will return cached response (SERVFAIL) at time of check and will return 127.0.0.1 at time of use (url.openConnection())\n5. Execute SSRF request with `add_imageurl` value set to format `http://u{25MB}:password@randomid.dns.pointer.pw/path/to/internal/resource.png`. Here u{25MB} means the username part is a string of length 25 x 1024 x 1024 charachters\n\n# Demo\nThis demo shows adding `appsuite/v=7.10.3-9.20200409.083030/apps/themes/logo.png` via internal network (127.0.0.1) using `/appsuite/api/oxodocumentfilter\u0026action=addfile` API\n{F810312}\n\n# Steps to reproduce\n\n1. Install golang from https://golang.org/dl/\n2. Install Open-Xchange and Documents in a virtual machine with atleast 4GB RAM by following guides https://oxpedia.org/wiki/index.php?title=AppSuite:Open-Xchange_Installation_Guide_for_Debian_9.0 and https://oxpedia.org/wiki/index.php?title=AppSuite:Documents_Installation_Guide#Debian_GNU.2FLinux_9.0_.28valid_from_v7.10.29\n3. Download and extract poc.zip file\n4. Open terminal / command line and set current directory to extracted poc.zip folder\n5. Run command\n   \n   ```shell\n    go run . -serverRoot=\"http://172.16.66.130\" -username=\"testuser\" -password=\"secret\" -targetPath=\"appsuite/v=7.10.3-9.20200409.083030/apps/themes/logo.png\" -targetPort=\"80\" -payloadSize=25 -startSleepDuration=6600\n   ```\n   \n   where `172.16.66.130` is the IP address of VM\n\n## Impact\n\nAn attacker can trigger requests to internal resources and possibly retrieve response contents.","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eThe URL validation logic applied when handling \u003ccode\u003e/appsuite/api/oxodocumentfilter\u0026amp;action=addfile\u003c/code\u003e suffers from three defects which can be used to execute Time of Check Time of Use (ToCToU) SSRF attack. This issue allows malicious actors to execute HTTP GET requests on internal network services and may lead to confidential information leak.\u003c/p\u003e\n\n\u003ch2 id=\"defect-1-time-of-check-time-of-use-toctou-vulnerability\"\u003eDefect #1: Time of Check Time of Use (ToCToU) vulnerability\u003c/h2\u003e\n\n\u003cp\u003eURL validation logic in \u003ccode\u003eURITools.getFinalURL\u003c/code\u003e method implemented \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.open-xchange.com%2Fmiddleware%2Fcore%2F-%2Fblob%2Fdevelop%2Fcom.openexchange.server%2Fsrc%2Fcom%2Fopenexchange%2Ftools%2Fnet%2FURITools.java%23L108\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e suffers from ToCToU vulnerability  \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003eu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"no\"\u003eURL\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisPresent\u003c/span\u003e\u003cspan class=\"o\"\u003e())\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eOptional\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eOXException\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003eapply\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisPresent\u003c/span\u003e\u003cspan class=\"o\"\u003e())\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"nc\"\u003eURLConnection\u003c/span\u003e \u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eopenConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn the above code, DNS resolution of input URL hostname is done during both time of check (\u003ccode\u003evalidator.get().apply(u)\u003c/code\u003e) and time of use (\u003ccode\u003eu.openConnection()\u003c/code\u003e) by calling \u003ccode\u003eInetAddress.getByName\u003c/code\u003e method. So if an attacker can change the DNS resolution result after time of check and before time of use, he can bypass the validator. This defect alone is extremely difficult to exploit because of following limitations\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eBy default, \u003ccode\u003eInetAddress.getByName\u003c/code\u003e caches the DNS resolution results for 30 seconds if the DNS resolution succeeds and for 10 seconds if the DNS resolution fails. \u003c/li\u003e\n\u003cli\u003eTime interval between \u003ccode\u003evalidator.get().apply(u)\u003c/code\u003e and \u003ccode\u003eu.openConnection()\u003c/code\u003e is extremely small (less than one millisecond for normal URLs). Defect #2 is used to bypass this limitation\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"defect-2-length-of-input-url-is-not-limited\"\u003eDefect #2: Length of input URL is not limited\u003c/h2\u003e\n\n\u003cp\u003eThe URL validator \u003ccode\u003eAddFileAction.validator\u003c/code\u003e implemented \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.open-xchange.com%2Fdocuments%2Foffice%2F-%2Fblob%2Fdevelop%2Fcom.openexchange.office.rest%2Fsrc%2Fcom%2Fopenexchange%2Foffice%2Frest%2FAddFileAction.java%23L353\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e does not validate the length of input URL. By providing a URL with large size, the attacker can increase the time interval between \u003ccode\u003eInetAddress.getByName\u003c/code\u003e method calls at time of check and time of use. Larger time interval allows the attacker to easily exploit Defect #1\u003c/p\u003e\n\n\u003ch2 id=\"defect-3-url-validator-allows-input-url-if-its-dns-resolution-fails\"\u003eDefect #3: URL validator allows input URL if its dns resolution fails\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eHostList.contains\u003c/code\u003e method implemented \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.open-xchange.com%2Fmiddleware%2Fcore%2F-%2Fblob%2Fdevelop%2Fcom.openexchange.net%2Fsrc%2Fcom%2Fopenexchange%2Fnet%2FHostList.java%23L234\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e returns false if the DNS resolution of input URL hostname fails\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// Need to resolve as last resort\u003c/span\u003e\n\u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003econtains\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eInetAddress\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetByName\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoCheck\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eUnknownHostException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Cannot be resolved\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003eAddFileAction.validator\u003c/code\u003e calls \u003ccode\u003eblackImageUrlHostlist.contains\u003c/code\u003e method to check if the input URL hostname or the IP address it resolves to is in blacklist. If an attacker makes the DNS resolution of hostname to fail, the IP address checks are skipped and URL is accepted.\u003c/p\u003e\n\n\u003ch1 id=\"attack-strategy\"\u003eAttack strategy\u003c/h1\u003e\n\n\u003cp\u003eConsider a hostname \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e with authoritative nameserver controlled by attacker. Attack strategy is to make the DNS resolution of \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e to fail at time of check (\u003ccode\u003evalidator.get().apply(u);\u003c/code\u003e) and to succeed at time of use (\u003ccode\u003eu.openConnection()\u003c/code\u003e). This allows the attacker to bypass IP address blacklist filters and execute HTTP GET request on any blacklisted IP address. Following steps may be followed by attacker to execute this attack\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eTrigger the \u003ccode\u003eInetAddress.getByName\u003c/code\u003e cache on server by executing \u003ccode\u003eaddfile\u003c/code\u003e action with request data \u003ccode\u003e{\u0026quot;add_imageurl\u0026quot;: \u0026quot;http://randomid.dns.pointer.pw\u0026quot;}\u003c/code\u003e. At this time, the authoritative DNS server will be set to fail the DNS resolution of \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e by returning \u003ccode\u003eSERVFAIL\u003c/code\u003e status. \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will cache this failure result for 10 seconds\u003c/li\u003e\n\u003cli\u003eNote the time when above request response was received. This is the cache start time\u003c/li\u003e\n\u003cli\u003eTell the authoritative name server of domain \u003ccode\u003epointer.pw\u003c/code\u003e to return 127.0.0.1 for type A dns requests of hostname \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eSleep for specified duration from cache start time such that in the next step \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will return cached response (SERVFAIL) at time of check and will return 127.0.0.1 at time of use (url.openConnection())\u003c/li\u003e\n\u003cli\u003eExecute SSRF request with \u003ccode\u003eadd_imageurl\u003c/code\u003e value set to format \u003ccode\u003ehttp://u{25MB}:password@randomid.dns.pointer.pw/path/to/internal/resource.png\u003c/code\u003e. Here u{25MB} means the username part is a string of length 25 x 1024 x 1024 charachters\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"demo\"\u003eDemo\u003c/h1\u003e\n\n\u003cp\u003eThis demo shows adding \u003ccode\u003eappsuite/v=7.10.3-9.20200409.083030/apps/themes/logo.png\u003c/code\u003e via internal network (127.0.0.1) using \u003ccode\u003e/appsuite/api/oxodocumentfilter\u0026amp;action=addfile\u003c/code\u003e API\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"demo.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/chgtrrRS28UNB5cQMMZM5t4h?response-content-disposition=attachment%3B%20filename%3D%22demo.mov%22%3B%20filename%2A%3DUTF-8%27%27demo.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070253Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=b4978d41aaa0867c6c91b7ef07b12b426db9ee5b39668af3742662ce0435e7bd\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/chgtrrRS28UNB5cQMMZM5t4h?response-content-disposition=attachment%3B%20filename%3D%22demo.mov%22%3B%20filename%2A%3DUTF-8%27%27demo.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070253Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=b4978d41aaa0867c6c91b7ef07b12b426db9ee5b39668af3742662ce0435e7bd\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eInstall golang from \u003ca title=\"https://golang.org/dl/\" href=\"/redirect?url=https%3A%2F%2Fgolang.org%2Fdl%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://golang.org/dl/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eInstall Open-Xchange and Documents in a virtual machine with atleast 4GB RAM by following guides \u003ca title=\"https://oxpedia.org/wiki/index.php?title=AppSuite:Open-Xchange_Installation_Guide_for_Debian_9.0\" href=\"/redirect?url=https%3A%2F%2Foxpedia.org%2Fwiki%2Findex.php%3Ftitle%3DAppSuite%3AOpen-Xchange_Installation_Guide_for_Debian_9.0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://oxpedia.org/wiki/index.php?title=AppSuite:Open-Xchange_Installation_Guide_for_Debian_9.0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"https://oxpedia.org/wiki/index.php?title=AppSuite:Documents_Installation_Guide#Debian_GNU.2FLinux_9.0_.28valid_from_v7.10.29\" href=\"/redirect?url=https%3A%2F%2Foxpedia.org%2Fwiki%2Findex.php%3Ftitle%3DAppSuite%3ADocuments_Installation_Guide%23Debian_GNU.2FLinux_9.0_.28valid_from_v7.10.29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://oxpedia.org/wiki/index.php?title=AppSuite:Documents_Installation_Guide#Debian_GNU.2FLinux_9.0_.28valid_from_v7.10.29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eDownload and extract poc.zip file\u003c/li\u003e\n\u003cli\u003eOpen terminal / command line and set current directory to extracted poc.zip folder\u003c/li\u003e\n\u003cli\u003eRun command\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e    go run \u003cspan class=\"nb\"\u003e.\u003c/span\u003e \u003cspan class=\"nt\"\u003e-serverRoot\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;http://172.16.66.130\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-username\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;testuser\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-password\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-targetPath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;appsuite/v=7.10.3-9.20200409.083030/apps/themes/logo.png\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-targetPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;80\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-payloadSize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e25 \u003cspan class=\"nt\"\u003e-startSleepDuration\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e6600\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere \u003ccode\u003e172.16.66.130\u003c/code\u003e is the IP address of VM\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can trigger requests to internal resources and possibly retrieve response contents.\u003c/p\u003e\n","bounty_amount":"550.0","formatted_bounty":"$550","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":810312,"file_name":"demo.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/chgtrrRS28UNB5cQMMZM5t4h?response-content-disposition=attachment%3B%20filename%3D%22demo.mov%22%3B%20filename%2A%3DUTF-8%27%27demo.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=b4978d41aaa0867c6c91b7ef07b12b426db9ee5b39668af3742662ce0435e7bd","file_size":11644384,"type":"video/quicktime"},{"id":810313,"file_name":"poc.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dwWxe6PF8geLw9r7tvrKQPwR?response-content-disposition=attachment%3B%20filename%3D%22poc.zip%22%3B%20filename%2A%3DUTF-8%27%27poc.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=c5e53167519eb8dcb6d3a5c93fa247211fb8127782326f9f3abb95672c741897","file_size":8120,"type":"application/zip"}],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["excavator","bhavi","jgu","what_web","exploit_db","khizer47","f_m","jayantprajapat","a1r33s","devilsadvocate","and 2 more..."],"severity":{"rating":"medium","score":4.9,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7857401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"#Demo 2\nThis demo demonstrates SSRF using netcat \n{F810327}","markdown_message":"\u003ch1 id=\"demo-2\"\u003eDemo 2\u003c/h1\u003e\n\n\u003cp\u003eThis demo demonstrates SSRF using netcat \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"demo2.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QRk1p6eZyNRP2Qm2ig8xoKJ7?response-content-disposition=attachment%3B%20filename%3D%22demo2.mov%22%3B%20filename%2A%3DUTF-8%27%27demo2.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070253Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=a94f35a24b1b062ca74ccbbcaeb16221b1d6ac356cbae2cbf8c8bb83a10df007\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QRk1p6eZyNRP2Qm2ig8xoKJ7?response-content-disposition=attachment%3B%20filename%3D%22demo2.mov%22%3B%20filename%2A%3DUTF-8%27%27demo2.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070253Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=a94f35a24b1b062ca74ccbbcaeb16221b1d6ac356cbae2cbf8c8bb83a10df007\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-30T22:27:56.399Z","updated_at":"2020-04-30T22:27:56.399Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":810327,"filename":"demo2.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QRk1p6eZyNRP2Qm2ig8xoKJ7?response-content-disposition=attachment%3B%20filename%3D%22demo2.mov%22%3B%20filename%2A%3DUTF-8%27%27demo2.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=a94f35a24b1b062ca74ccbbcaeb16221b1d6ac356cbae2cbf8c8bb83a10df007"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7882821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report and great research documentation. The root cause of this is a known issue (#747984) and we're looking to address it in future releases, however we'll have a closer look at the reported details to challenge our implementation.","markdown_message":"\u003cp\u003eThanks for your report and great research documentation. The root cause of this is a known issue (#747984) and we\u0026#39;re looking to address it in future releases, however we\u0026#39;ll have a closer look at the reported details to challenge our implementation.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-04T06:30:18.924Z","updated_at":"2020-05-04T06:30:18.924Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7910954,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Great report! We've one topic to clarify regarding Defect #2:\nThe function you're mentioning (AddFileAction.validator) is not using URITools.getFinalURL from Defect #1. How would an excessively URL in this case affect the resolution/blacklist process? Can you think about a case where the length of a URL actually affects DNS resolution time? AFAIK URLs are limited to 2KB which is not really a huge amount of data that could slow down parsers etc.","markdown_message":"\u003cp\u003eGreat report! We\u0026#39;ve one topic to clarify regarding Defect #2:\u003cbr\u003e\nThe function you\u0026#39;re mentioning (AddFileAction.validator) is not using URITools.getFinalURL from Defect #1. How would an excessively URL in this case affect the resolution/blacklist process? Can you think about a case where the length of a URL actually affects DNS resolution time? AFAIK URLs are limited to 2KB which is not really a huge amount of data that could slow down parsers etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-06T10:38:12.458Z","updated_at":"2020-05-06T10:38:12.458Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7918272,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @mheiland, Thank you, I appreciate the compliment.\n\nDefect #2 is not used to slow down DNS resolution time. It is used to increase the time interval between time of check DNS resolution and time of use DNS resolution. \n\nFrom defect #1, we know that time of check DNS resolution and time of use DNS resolutions are triggered at `validator.get().apply(u)` and `httpURLConnection.connect()` respectively as shown below.\n\n```java\nURL u = new URL(url);\nif (validator.isPresent()) {\n    Optional\u003cOXException\u003e exception = validator.get().apply(u); // \u003c-- triggers time of check DNS resolution\n    if (exception.isPresent()) {\n        throw exception.get();\n    }\n}\n\nURLConnection urlConnnection = u.openConnection();\nurlConnnection.setConnectTimeout(2500);\nurlConnnection.setReadTimeout(2500);\n\nif (urlConnnection instanceof HttpURLConnection) {\n    HttpURLConnection httpURLConnection = (HttpURLConnection) urlConnnection;\n    httpURLConnection.setInstanceFollowRedirects(false);\n    httpURLConnection.connect(); // \u003c-- triggers time of use DNS resolution\n    ...\n}\n```\nIn `u.openConnection()` and `httpURLConnection.connect()` method calls, there are various operations (like validation) happening before time of use DNS resolution which depends on the length of input URL. The below java code demonstrates how URL length affect the time interval between time of check DNS resolution and time of use DNS resolution. The java code measures the time taken to execute `url.openConnection().connect()` on two URL of length `2000` and `25 x 1024 x 1024` characters. The length of the URL is varied by adding characters to username portion of the URL. \n\n```java\nimport java.net.*;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        // Using a closed port in localhost so that the below measurements\n        // include only the computation time and not the networking time\n        URL baseURL = new URL(\"http://127.0.0.1:12345\");\n\n        // When a method is called for first time, JVM might perform bytecode\n        // validation, first pass compilation etc. To avoid this overhead during\n        // actual measurement, we trigger the method once before performing\n        // actual measurement of execution time\n        sampleUrlConnectTime(baseURL, 1);\n\n        // See recommendations from https://stackoverflow.com/a/417184 for choosing\n        // optimum maximum URL length\n        URL normalUrl = makeUrlOfLength(baseURL, 2000);\n        float normalUrlTime = sampleUrlConnectTime(normalUrl, 10);\n        System.out.println(\"Normal url time: \" + normalUrlTime + \" ms\");\n\n        URL bigUrl = makeUrlOfLength(baseURL, 25*1024*1024);\n        float bigUrlTime = sampleUrlConnectTime(bigUrl, 10);\n        System.out.println(\"Big url time: \" + bigUrlTime + \" ms\");\n    }\n\n    private static float sampleUrlConnectTime(URL url, int numSamples) \n            throws Exception {\n        long sum = 0;\n        for (int i=0; i \u003c numSamples; i++) {\n            sum += measureUrlConnectNanos(url);\n        }\n        return sum / (numSamples * 1000000f); // average and convert to milliseconds\n    }\n\n    private static long measureUrlConnectNanos(URL url) throws Exception {\n        long cTime = System.nanoTime();\n        try {\n            URLConnection connection = url.openConnection();\n            connection.connect();\n            throw new Exception(\"Expected connection to fail\");\n        } catch (ConnectException e) {\n            return System.nanoTime()-cTime;\n        }\n    }\n\n    private static URL makeUrlOfLength(URL url, int length) {\n        assert length \u003e= url.toString().length() + 4;\n        String username = new String(new char[length-url.toString().length()-3])\n                .replace(\"\\0\", \"u\");\n        try {\n            String result = url.getProtocol() + \"://\" + username + \":p@\" + \n                    url.getAuthority() + url.getPath();\n            assert result.length() == length;\n            return new URL(result);\n        } catch (MalformedURLException e) {\n            throw new RuntimeException(\"expected to construct a valid url\");\n        }\n    }\n}\n\n```\n\nRunning the above code on my laptop gives the following output\n\n```shell\nNormal url time: 1.2768717 ms\nBig url time: 672.89435 ms\n```\n\nIf `toctou_time` denotes the time interval between time of check DNS resolution and time of use DNS resolution, from the above output, it is clear that an attacker can control the `toctou_time` by controlling the length of input URL.\n\nDefect #1 is **not** exploitable without the help of defect #2. To exploit defect #1 and achieve SSRF, attacker needs to make the DNS resolution at time of check to fail and DNS resolution at time of use to successfully resolve to IP `127.0.0.1`. DNS resolution in java is done using `InetAddress.getByName` method. By default `InetAddress.getByName` will cache the result of a failed DNS resolution result from DNS server for `10 seconds`. This means that even if the attacker changes the DNS resolution response of DNS server (by controlling the authoritative DNS server) from failure to `127.0.0.1`, the result from `InetAddress.getByName` will not change until the cache is expired (10 seconds). \n\nTo defeat this caching behaviour, attacker needs to follow the following strategy:\n1. Attacker sends an add image by url request to server with URL `http://randomid.dns.pointer.pw`. At this time, the authoritative DNS server will be set to fail the DNS resolution of `randomid.dns.pointer.pw` by returning SERVFAIL status. When the server process this request, as part of the URL validation process, it will try to resolve the IP address of URL hostname by calling `InetAddress.getByName`. Since the DNS server will return SERVFAIL, the DNS resolution of URL hostname will fail and `InetAddress.getByName` will cache this failure result for next 10 seconds. Now since the DNS resolution failed, from defect #3, we know that the URL will be accepted. Now server will try to establish connection with input URL hostname by calling `httpURLConnection.connect()`. This will again trigger `InetAddress.getByName` method for DNS resolution and the method will return the previously cached failure result. Since DNS resolution failed, connection attempt will fail and server will return error response to the attacker. Let the time at which attacker receives the failure response be denoted as `cache_start_time`. Now the attacker knows that the cache will expire at `cache_start_time + 10 seconds`. Let this cache expiration time be denoted as `cache_expire_time`.\n2. Attacker now tells the authoritative name server to return `127.0.0.1` for dns requests of hostname `randomid.dns.pointer.pw`\n3. Now the attacker has to precisely time another add image by url request with URL hostname `randomid.dns.pointer.pw` such that when the server process this request, the time at which `InetAddress.getByName` is called during URL validation (time of check) is between range `[cache_expire_time-toctou_time`, `cache_expire_time)`. This precise timing ensures that at the time of URL validation, `InetAddress.getByName` will return the cached failure response and at the time of use (`httpURLConnection.connect()`), `InetAddress.getByName` will connect with the DNS server (since cache is expired at time of use) and will return `127.0.0.1`. The failure result at time of check will bypass the IP address blacklist and `127.0.0.1` result at time of use will establish connection to local network of server, bypassing SSRF protections. This precise timing is required because if the request timing in too early, both at time of check and time of use, DNS resolution will return the cached failure response and the request will fail. If the request timing is too late, at the time of check itself the `InetAddress.getByName` cache will have expired and it will connect with the DNS server and return `127.0.0.1`. This will cause the URL validation to fail and the request will fail.\n\nThe reason why defect #2 is important for above strategy to work is because of precise timing requirement in step 3 of above strategy. If the URL length is limited to 2000 characters, the maximum `toctou_time` an attacker can achieve by controlling URL length is ~1.5ms. This means that the attacker has to precisely time the request in step 3 such that time at which `InetAddress.getByName` is called during URL validation is in range `[cache_expire_time-1.5ms, cache_expire_time)`. This extreme high timing precision of `1.5 ms` is improbable to achieve because of time uncertainties in network transport and time uncertainties in instruction scheduling by kernel and JVM etc. An attacker can try to spray lot of parallel requests to server hoping that at least one of them will will satisfy the timing requirement and successfully execute SSRF, but the rate limiting feature will prevent making large number of parallel requests. So the only way an attacker can exploit defect #1 with reasonable reliability is by increasing the `toctou_time`. If the URL length is `25 MB`, the `toctou_time` is `~670ms`. This relaxes the timing precision requirement to `~670 ms` and attacker can easily execute SSRF attack.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e, Thank you, I appreciate the compliment.\u003c/p\u003e\n\n\u003cp\u003eDefect #2 is not used to slow down DNS resolution time. It is used to increase the time interval between time of check DNS resolution and time of use DNS resolution. \u003c/p\u003e\n\n\u003cp\u003eFrom defect #1, we know that time of check DNS resolution and time of use DNS resolutions are triggered at \u003ccode\u003evalidator.get().apply(u)\u003c/code\u003e and \u003ccode\u003ehttpURLConnection.connect()\u003c/code\u003e respectively as shown below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003eu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"no\"\u003eURL\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisPresent\u003c/span\u003e\u003cspan class=\"o\"\u003e())\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eOptional\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eOXException\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003eapply\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026lt;-- triggers time of check DNS resolution\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisPresent\u003c/span\u003e\u003cspan class=\"o\"\u003e())\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003eexception\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eget\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"nc\"\u003eURLConnection\u003c/span\u003e \u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eopenConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n\u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetConnectTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2500\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetReadTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2500\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e \u003cspan class=\"k\"\u003einstanceof\u003c/span\u003e \u003cspan class=\"nc\"\u003eHttpURLConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eHttpURLConnection\u003c/span\u003e \u003cspan class=\"n\"\u003ehttpURLConnection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eHttpURLConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eurlConnnection\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ehttpURLConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetInstanceFollowRedirects\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ehttpURLConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003econnect\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026lt;-- triggers time of use DNS resolution\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn \u003ccode\u003eu.openConnection()\u003c/code\u003e and \u003ccode\u003ehttpURLConnection.connect()\u003c/code\u003e method calls, there are various operations (like validation) happening before time of use DNS resolution which depends on the length of input URL. The below java code demonstrates how URL length affect the time interval between time of check DNS resolution and time of use DNS resolution. The java code measures the time taken to execute \u003ccode\u003eurl.openConnection().connect()\u003c/code\u003e on two URL of length \u003ccode\u003e2000\u003c/code\u003e and \u003ccode\u003e25 x 1024 x 1024\u003c/code\u003e characters. The length of the URL is varied by adding characters to username portion of the URL. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejava.net.*\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMain\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Using a closed port in localhost so that the below measurements\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// include only the computation time and not the networking time\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003ebaseURL\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"no\"\u003eURL\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://127.0.0.1:12345\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// When a method is called for first time, JVM might perform bytecode\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// validation, first pass compilation etc. To avoid this overhead during\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// actual measurement, we trigger the method once before performing\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// actual measurement of execution time\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esampleUrlConnectTime\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaseURL\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e// See recommendations from https://stackoverflow.com/a/417184 for choosing\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// optimum maximum URL length\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003enormalUrl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emakeUrlOfLength\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaseURL\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2000\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003enormalUrlTime\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esampleUrlConnectTime\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enormalUrl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Normal url time: \u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003enormalUrlTime\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot; ms\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003ebigUrl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emakeUrlOfLength\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebaseURL\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e25\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"mi\"\u003e1024\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"mi\"\u003e1024\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ebigUrlTime\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esampleUrlConnectTime\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebigUrl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Big url time: \u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ebigUrlTime\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot; ms\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"nf\"\u003esampleUrlConnectTime\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003enumSamples\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \n            \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003esum\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003enumSamples\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esum\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003emeasureUrlConnectNanos\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esum\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumSamples\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e1000000\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// average and convert to milliseconds\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"nf\"\u003emeasureUrlConnectNanos\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003elong\u003c/span\u003e \u003cspan class=\"n\"\u003ecTime\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003enanoTime\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eURLConnection\u003c/span\u003e \u003cspan class=\"n\"\u003econnection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eopenConnection\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003econnect\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eException\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Expected connection to fail\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eConnectException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003enanoTime\u003c/span\u003e\u003cspan class=\"o\"\u003e()-\u003c/span\u003e\u003cspan class=\"n\"\u003ecTime\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"nf\"\u003emakeUrlOfLength\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eURL\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003eusername\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e()-\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"o\"\u003e])\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ereplace\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\\0\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;u\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetProtocol\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;://\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eusername\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;:p@\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \n                    \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetAuthority\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetPath\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eURL\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eMalformedURLException\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nf\"\u003eRuntimeException\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;expected to construct a valid url\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRunning the above code on my laptop gives the following output\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003eNormal url \u003cspan class=\"nb\"\u003etime\u003c/span\u003e: 1.2768717 ms\nBig url \u003cspan class=\"nb\"\u003etime\u003c/span\u003e: 672.89435 ms\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf \u003ccode\u003etoctou_time\u003c/code\u003e denotes the time interval between time of check DNS resolution and time of use DNS resolution, from the above output, it is clear that an attacker can control the \u003ccode\u003etoctou_time\u003c/code\u003e by controlling the length of input URL.\u003c/p\u003e\n\n\u003cp\u003eDefect #1 is \u003cstrong\u003enot\u003c/strong\u003e exploitable without the help of defect #2. To exploit defect #1 and achieve SSRF, attacker needs to make the DNS resolution at time of check to fail and DNS resolution at time of use to successfully resolve to IP \u003ccode\u003e127.0.0.1\u003c/code\u003e. DNS resolution in java is done using \u003ccode\u003eInetAddress.getByName\u003c/code\u003e method. By default \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will cache the result of a failed DNS resolution result from DNS server for \u003ccode\u003e10 seconds\u003c/code\u003e. This means that even if the attacker changes the DNS resolution response of DNS server (by controlling the authoritative DNS server) from failure to \u003ccode\u003e127.0.0.1\u003c/code\u003e, the result from \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will not change until the cache is expired (10 seconds). \u003c/p\u003e\n\n\u003cp\u003eTo defeat this caching behaviour, attacker needs to follow the following strategy:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker sends an add image by url request to server with URL \u003ccode\u003ehttp://randomid.dns.pointer.pw\u003c/code\u003e. At this time, the authoritative DNS server will be set to fail the DNS resolution of \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e by returning SERVFAIL status. When the server process this request, as part of the URL validation process, it will try to resolve the IP address of URL hostname by calling \u003ccode\u003eInetAddress.getByName\u003c/code\u003e. Since the DNS server will return SERVFAIL, the DNS resolution of URL hostname will fail and \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will cache this failure result for next 10 seconds. Now since the DNS resolution failed, from defect #3, we know that the URL will be accepted. Now server will try to establish connection with input URL hostname by calling \u003ccode\u003ehttpURLConnection.connect()\u003c/code\u003e. This will again trigger \u003ccode\u003eInetAddress.getByName\u003c/code\u003e method for DNS resolution and the method will return the previously cached failure result. Since DNS resolution failed, connection attempt will fail and server will return error response to the attacker. Let the time at which attacker receives the failure response be denoted as \u003ccode\u003ecache_start_time\u003c/code\u003e. Now the attacker knows that the cache will expire at \u003ccode\u003ecache_start_time + 10 seconds\u003c/code\u003e. Let this cache expiration time be denoted as \u003ccode\u003ecache_expire_time\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eAttacker now tells the authoritative name server to return \u003ccode\u003e127.0.0.1\u003c/code\u003e for dns requests of hostname \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNow the attacker has to precisely time another add image by url request with URL hostname \u003ccode\u003erandomid.dns.pointer.pw\u003c/code\u003e such that when the server process this request, the time at which \u003ccode\u003eInetAddress.getByName\u003c/code\u003e is called during URL validation (time of check) is between range \u003ccode\u003e[cache_expire_time-toctou_time\u003c/code\u003e, \u003ccode\u003ecache_expire_time)\u003c/code\u003e. This precise timing ensures that at the time of URL validation, \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will return the cached failure response and at the time of use (\u003ccode\u003ehttpURLConnection.connect()\u003c/code\u003e), \u003ccode\u003eInetAddress.getByName\u003c/code\u003e will connect with the DNS server (since cache is expired at time of use) and will return \u003ccode\u003e127.0.0.1\u003c/code\u003e. The failure result at time of check will bypass the IP address blacklist and \u003ccode\u003e127.0.0.1\u003c/code\u003e result at time of use will establish connection to local network of server, bypassing SSRF protections. This precise timing is required because if the request timing in too early, both at time of check and time of use, DNS resolution will return the cached failure response and the request will fail. If the request timing is too late, at the time of check itself the \u003ccode\u003eInetAddress.getByName\u003c/code\u003e cache will have expired and it will connect with the DNS server and return \u003ccode\u003e127.0.0.1\u003c/code\u003e. This will cause the URL validation to fail and the request will fail.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe reason why defect #2 is important for above strategy to work is because of precise timing requirement in step 3 of above strategy. If the URL length is limited to 2000 characters, the maximum \u003ccode\u003etoctou_time\u003c/code\u003e an attacker can achieve by controlling URL length is ~1.5ms. This means that the attacker has to precisely time the request in step 3 such that time at which \u003ccode\u003eInetAddress.getByName\u003c/code\u003e is called during URL validation is in range \u003ccode\u003e[cache_expire_time-1.5ms, cache_expire_time)\u003c/code\u003e. This extreme high timing precision of \u003ccode\u003e1.5 ms\u003c/code\u003e is improbable to achieve because of time uncertainties in network transport and time uncertainties in instruction scheduling by kernel and JVM etc. An attacker can try to spray lot of parallel requests to server hoping that at least one of them will will satisfy the timing requirement and successfully execute SSRF, but the rate limiting feature will prevent making large number of parallel requests. So the only way an attacker can exploit defect #1 with reasonable reliability is by increasing the \u003ccode\u003etoctou_time\u003c/code\u003e. If the URL length is \u003ccode\u003e25 MB\u003c/code\u003e, the \u003ccode\u003etoctou_time\u003c/code\u003e is \u003ccode\u003e~670ms\u003c/code\u003e. This relaxes the timing precision requirement to \u003ccode\u003e~670 ms\u003c/code\u003e and attacker can easily execute SSRF attack.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-06T22:32:40.339Z","updated_at":"2020-05-06T22:32:40.339Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7922422,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the explanation.","markdown_message":"\u003cp\u003eThanks for the explanation.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-07T08:56:28.224Z","updated_at":"2020-05-07T08:56:28.224Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7936802,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-08T09:43:20.883Z","updated_at":"2020-05-08T09:43:20.883Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.1)","old_severity_id":708823,"new_severity_id":715330},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7936806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T09:43:57.922Z","updated_at":"2020-05-08T09:43:57.922Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7937081,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mheiland, \n\nYes, I would like to be included in the advisories. Please use following information for the same:\nSreejith Krishnan R(@skr0x1c0)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eYes, I would like to be included in the advisories. Please use following information for the same:\u003cbr\u003e\nSreejith Krishnan R(@skr0x1c0)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T10:14:19.022Z","updated_at":"2020-05-08T10:14:19.022Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7937189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mheiland,\n\nCould you tell me the parameter used for severity calculation.\n\nWhen using very conservative parameters for calculation, I was getting CVE rating of 4.0\n{F820409}\n\nAlso other SSRF vulnerability reports reported earlier where given medium severity rating, eg: [737163](https://hackerone.com/reports/737163)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCould you tell me the parameter used for severity calculation.\u003c/p\u003e\n\n\u003cp\u003eWhen using very conservative parameters for calculation, I was getting CVE rating of 4.0\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_2020-05-08_at_3.49.35_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nA2rukCbmZ4jWZGDPeagLTYB?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_3.49.35_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_3.49.35_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070254Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=661b5ae453b338215b3c54e8d04903d89bb388267519f88a26caae39837afa75\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nA2rukCbmZ4jWZGDPeagLTYB?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_3.49.35_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_3.49.35_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070254Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=661b5ae453b338215b3c54e8d04903d89bb388267519f88a26caae39837afa75\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAlso other SSRF vulnerability reports reported earlier where given medium severity rating, eg: \u003ca href=\"https://hackerone.com/reports/737163\"\u003e737163\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T10:25:29.585Z","updated_at":"2020-05-08T10:25:29.585Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":820409,"filename":"Screenshot_2020-05-08_at_3.49.35_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nA2rukCbmZ4jWZGDPeagLTYB?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_3.49.35_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_3.49.35_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070254Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=661b5ae453b338215b3c54e8d04903d89bb388267519f88a26caae39837afa75"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7937465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"First let me state that we rate each finding individually and some vulns are rated in severity grades like \"medium\" which covers CVSS 4.0 to 6.9. We recently switched to providing the exact CVSS score including each base metric to researchers.\n\nIn this case the difference at rating is that we chose \"low\" for \"privileges required\" - as user-level authentication is required - and \"unchanged\" as \"scope\". I agree that scope is indeed changed in this case and will update the rating.\n\nRegardless of the rating you'll certainly be eligible for a bonus to compensate for your in-depth research and documentation.","markdown_message":"\u003cp\u003eFirst let me state that we rate each finding individually and some vulns are rated in severity grades like \u0026quot;medium\u0026quot; which covers CVSS 4.0 to 6.9. We recently switched to providing the exact CVSS score including each base metric to researchers.\u003c/p\u003e\n\n\u003cp\u003eIn this case the difference at rating is that we chose \u0026quot;low\u0026quot; for \u0026quot;privileges required\u0026quot; - as user-level authentication is required - and \u0026quot;unchanged\u0026quot; as \u0026quot;scope\u0026quot;. I agree that scope is indeed changed in this case and will update the rating.\u003c/p\u003e\n\n\u003cp\u003eRegardless of the rating you\u0026#39;ll certainly be eligible for a bonus to compensate for your in-depth research and documentation.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T10:56:39.133Z","updated_at":"2020-05-08T11:01:52.649Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7937467,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-08T10:56:58.570Z","updated_at":"2020-05-08T10:56:58.570Z","additional_data":{"old_severity":"Low (3.1)","new_severity":"Low (3.5)","old_severity_id":715330,"new_severity_id":715382},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7937854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland, you are right. Privileges required should be low. \n\nThank you for updating severity and giving bonus compensation eligibility.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e, you are right. Privileges required should be low. \u003c/p\u003e\n\n\u003cp\u003eThank you for updating severity and giving bonus compensation eligibility.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T11:48:29.212Z","updated_at":"2020-05-08T11:48:29.212Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7941222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland,\n\nI just found out that defect #2 may be used by malicious actors for denial of service attacks also.\n\n# Attack strategy\n1. Attacker creates a web server which will respond to all request with status set to 307 temporary redirect and location header set to a large URL (say 50MB length)\n2. Attacker repeatedly sends add image by url request with `image_url` value set to URL of web server created in step 1. Request rate will be controlled such that rate limit is not reached.\n\nThe above attack strategy is using redirect to large URL instead of directly providing large URL for bypassing maximum request body size restrictions set by reverse proxy\n\n# Steps to reproduce\n1. Download and extract dos.zip\n2. Change working directory to extracted folder\n3. Execute command \n\n    ```shell\n    go run . -serverRoot=\"http://172.16.66.130\" -username=\"testuser\" -password=\"secret\" -redirectorAddress=\"172.16.146.1:8081\" -numWorkers=10 -payloadSize=50\n    ```\n\n    Where\n    - redirectorAddress: The IP address and port the which redirector server should bind to. This IP address should be accessible from the VM\n    - serverRoot: Base URL of open-xchange server\n    - username: Username of any user in open-xchange server\n    - password: Password of user in open-xchange server\n    - payloadSize: Size of URL set in location header by redirector server\n    - numWorkers: Number of parallel add image by URL request to make\n\nWhile running the above go program, if we try to open a document, it will fail with following message\n{F820938}","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI just found out that defect #2 may be used by malicious actors for denial of service attacks also.\u003c/p\u003e\n\n\u003ch1 id=\"attack-strategy\"\u003eAttack strategy\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker creates a web server which will respond to all request with status set to 307 temporary redirect and location header set to a large URL (say 50MB length)\u003c/li\u003e\n\u003cli\u003eAttacker repeatedly sends add image by url request with \u003ccode\u003eimage_url\u003c/code\u003e value set to URL of web server created in step 1. Request rate will be controlled such that rate limit is not reached.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe above attack strategy is using redirect to large URL instead of directly providing large URL for bypassing maximum request body size restrictions set by reverse proxy\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload and extract dos.zip\u003c/li\u003e\n\u003cli\u003eChange working directory to extracted folder\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExecute command \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ego run \u003cspan class=\"nb\"\u003e.\u003c/span\u003e \u003cspan class=\"nt\"\u003e-serverRoot\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;http://172.16.66.130\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-username\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;testuser\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-password\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-redirectorAddress\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;172.16.146.1:8081\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-numWorkers\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10 \u003cspan class=\"nt\"\u003e-payloadSize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e50\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eredirectorAddress: The IP address and port the which redirector server should bind to. This IP address should be accessible from the VM\u003c/li\u003e\n\u003cli\u003eserverRoot: Base URL of open-xchange server\u003c/li\u003e\n\u003cli\u003eusername: Username of any user in open-xchange server\u003c/li\u003e\n\u003cli\u003epassword: Password of user in open-xchange server\u003c/li\u003e\n\u003cli\u003epayloadSize: Size of URL set in location header by redirector server\u003c/li\u003e\n\u003cli\u003enumWorkers: Number of parallel add image by URL request to make\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhile running the above go program, if we try to open a document, it will fail with following message\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_2020-05-08_at_11.36.13_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rsbY1zxMVpV7jNRZTFnPvbDz?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_11.36.13_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_11.36.13_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070254Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=ebcfd4bd60268e66bb65d470dcf89f99580f05d93b2c27158c6d230b5a8fe9ca\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rsbY1zxMVpV7jNRZTFnPvbDz?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_11.36.13_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_11.36.13_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070254Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026amp;X-Amz-Signature=ebcfd4bd60268e66bb65d470dcf89f99580f05d93b2c27158c6d230b5a8fe9ca\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-08T18:30:56.720Z","updated_at":"2020-05-08T18:30:56.720Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":820944,"filename":"dos.zip","type":"application/zip","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zJpTVH5ezd2bis8b7VMeq5Rk?response-content-disposition=attachment%3B%20filename%3D%22dos.zip%22%3B%20filename%2A%3DUTF-8%27%27dos.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070254Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=2b2e0e1cd2b3ef7533ca7b8a8e71ba4b9e1640160a12b0d6fb7c323253e34a0a"},{"id":820938,"filename":"Screenshot_2020-05-08_at_11.36.13_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rsbY1zxMVpV7jNRZTFnPvbDz?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-05-08_at_11.36.13_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-05-08_at_11.36.13_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070254Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=ebcfd4bd60268e66bb65d470dcf89f99580f05d93b2c27158c6d230b5a8fe9ca"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7971325,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the additional information. Improving the URL check will also address this issue.","markdown_message":"\u003cp\u003eThanks for the additional information. Improving the URL check will also address this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T07:38:07.217Z","updated_at":"2020-05-12T07:38:07.217Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7971329,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-12T07:38:19.520Z","updated_at":"2020-05-12T07:38:19.520Z","additional_data":{"old_severity":"Low (3.5)","new_severity":"Medium (4.9)","old_severity_id":715382,"new_severity_id":718413},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7971332,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-12T07:38:50.280Z","updated_at":"2020-05-12T07:38:50.280Z","additional_data":{"old_severity":"Medium (4.9)","new_severity":"Medium (4.9)","old_severity_id":718413,"new_severity_id":718414},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7999066,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We reviewed this vulnerability internally and will provide a backport to in-production releases during the next months.","markdown_message":"\u003cp\u003eWe reviewed this vulnerability internally and will provide a backport to in-production releases during the next months.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-14T11:25:41.802Z","updated_at":"2020-05-14T11:25:41.802Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skr0x1c0","url":"/skr0x1c0"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7999068,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T11:26:23.506Z","updated_at":"2020-05-14T11:26:23.506Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"150.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"skr0x1c0","url":"/skr0x1c0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7999725,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty and bonus! I really appreciate this :)","markdown_message":"\u003cp\u003eThank you for the bounty and bonus! I really appreciate this :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-14T12:20:46.756Z","updated_at":"2020-05-14T12:20:46.756Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315768,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since this bug is fixed in 7.10.4, can we disclose this report?","markdown_message":"\u003cp\u003eSince this bug is fixed in 7.10.4, can we disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T07:55:02.167Z","updated_at":"2020-09-24T07:55:02.167Z","first_to_agree":true,"actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes we will disclose this soon. We have some grace time to allow our users to upgrade their environments, sadly not everyone is on the latest and greatest version at all time. I plan to disclose this in mid-October.","markdown_message":"\u003cp\u003eYes we will disclose this soon. We have some grace time to allow our users to upgrade their environments, sadly not everyone is on the latest and greatest version at all time. I plan to disclose this in mid-October.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T07:59:52.733Z","updated_at":"2020-09-24T07:59:52.733Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9538543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mheiland, \n\nI hope your users have upgraded to the latest version by now. If so, can we disclose this report?\n\nBest regards,\nSreejith Krishnan R","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eI hope your users have upgraded to the latest version by now. If so, can we disclose this report?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSreejith Krishnan R\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-16T08:07:42.619Z","updated_at":"2020-10-16T08:07:42.619Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9884470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug was disclosed on security advisory published in 13th October 2020 (https://seclists.org/fulldisclosure/2020/Oct/20). \n\nCan we disclose this report also?","markdown_message":"\u003cp\u003eThis bug was disclosed on security advisory published in 13th October 2020 (\u003ca title=\"https://seclists.org/fulldisclosure/2020/Oct/20\" href=\"/redirect?url=https%3A%2F%2Fseclists.org%2Ffulldisclosure%2F2020%2FOct%2F20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://seclists.org/fulldisclosure/2020/Oct/20\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). \u003c/p\u003e\n\n\u003cp\u003eCan we disclose this report also?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-21T06:07:53.686Z","updated_at":"2020-11-21T06:07:53.686Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9939661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mheiland, is there any reason why this report was not disclosed along with others? If so, can you tell me when this report may be disclosed?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e, is there any reason why this report was not disclosed along with others? If so, can you tell me when this report may be disclosed?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-27T08:22:53.932Z","updated_at":"2020-11-27T08:22:53.932Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9941740,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-27T09:47:31.985Z","updated_at":"2020-11-27T09:47:31.985Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9941741,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-27T09:47:32.090Z","updated_at":"2020-11-27T09:47:32.090Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}