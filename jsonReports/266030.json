{"id":266030,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjYwMzA=","url":"https://hackerone.com/reports/266030","title":"Add arbitrary value in reset password cookie","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-09-05T13:23:42.848Z","submitted_at":"2017-09-05T13:23:42.848Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cuso4","url":"/cuso4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-01T14:41:09.454Z","bug_reporter_agreed_on_going_public_at":"2018-02-01T14:41:09.329Z","team_member_agreed_on_going_public_at":"2017-10-19T20:42:34.475Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I recently discovered that we can add arbitery value in reset pass token and compromise the life time unlimitedly ..\n\nAfter opening a reset password link I got these cookies ....for token expires timeout .\n\n{\n    \"domain\": \".app.legalrobot.com\",\n    \"expirationDate\": 1504618468.82726,\n    \"hostOnly\": false,\n    \"httpOnly\": false,\n    \"name\": \"tokenExpires\",\n    \"path\": \"/\",\n    \"sameSite\": \"no_restriction\",\n    \"secure\": true,\n    \"session\": false,\n    \"storeId\": \"0\",\n    \"value\": \"Tue%20Sep%2005%202017%2013%3A35%3A30%20GMT%2B0000%20(UTC)\",\n    \"id\": 2\n}\n\n\nThere was a warning in a page like .....\n\nYour password reset token expires in 21 minutes...\n\nokay so I decoded the value and changed year to 2019 instead of 2017 ...and it's all done ....miracle i got this page  with different warning ...\n\nYour password reset token expires in 2 years\n\nokay there are some issue like content spoofing , attacker can do this again and again , generally after 21 minutes token must experies but after changing to two years it won't ....\n\n\nattaching screenshot here ....\n\nIf you can please take a another look  #265652  i have attached a logical bug with fully video poc \n\n\nthanks again","vulnerability_information_html":"\u003cp\u003eI recently discovered that we can add arbitery value in reset pass token and compromise the life time unlimitedly ..\u003c/p\u003e\n\n\u003cp\u003eAfter opening a reset password link I got these cookies ....for token expires timeout .\u003c/p\u003e\n\n\u003cp\u003e{\u003cbr\u003e\n    \u0026quot;domain\u0026quot;: \u0026quot;.app.legalrobot.com\u0026quot;,\u003cbr\u003e\n    \u0026quot;expirationDate\u0026quot;: 1504618468.82726,\u003cbr\u003e\n    \u0026quot;hostOnly\u0026quot;: false,\u003cbr\u003e\n    \u0026quot;httpOnly\u0026quot;: false,\u003cbr\u003e\n    \u0026quot;name\u0026quot;: \u0026quot;tokenExpires\u0026quot;,\u003cbr\u003e\n    \u0026quot;path\u0026quot;: \u0026quot;/\u0026quot;,\u003cbr\u003e\n    \u0026quot;sameSite\u0026quot;: \u0026quot;no_restriction\u0026quot;,\u003cbr\u003e\n    \u0026quot;secure\u0026quot;: true,\u003cbr\u003e\n    \u0026quot;session\u0026quot;: false,\u003cbr\u003e\n    \u0026quot;storeId\u0026quot;: \u0026quot;0\u0026quot;,\u003cbr\u003e\n    \u0026quot;value\u0026quot;: \u0026quot;Tue%20Sep%2005%202017%2013%3A35%3A30%20GMT%2B0000%20(UTC)\u0026quot;,\u003cbr\u003e\n    \u0026quot;id\u0026quot;: 2\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003cp\u003eThere was a warning in a page like .....\u003c/p\u003e\n\n\u003cp\u003eYour password reset token expires in 21 minutes...\u003c/p\u003e\n\n\u003cp\u003eokay so I decoded the value and changed year to 2019 instead of 2017 ...and it\u0026#39;s all done ....miracle i got this page  with different warning ...\u003c/p\u003e\n\n\u003cp\u003eYour password reset token expires in 2 years\u003c/p\u003e\n\n\u003cp\u003eokay there are some issue like content spoofing , attacker can do this again and again , generally after 21 minutes token must experies but after changing to two years it won\u0026#39;t ....\u003c/p\u003e\n\n\u003cp\u003eattaching screenshot here ....\u003c/p\u003e\n\n\u003cp\u003eIf you can please take a another look  \u003ca href=\"/reports/265652\"\u003e#265652\u003c/a\u003e  i have attached a logical bug with fully video poc \u003c/p\u003e\n\n\u003cp\u003ethanks again\u003c/p\u003e\n","weakness":{"id":69,"name":"CRLF Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":218554,"file_name":"Screenshot_at_2017-09-05_18-47-54.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/554/09c40faa22059aa0d6bcc3e276dd6e52d4769d74/Screenshot_at_2017-09-05_18-47-54.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_2017-09-05_18-47-54.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_2017-09-05_18-47-54.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051717Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=bee725d3039b387b538610d7babad15fd81fb993c0fd6cff32f46d31b7ad01e9","file_size":1609723,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["cuso4","realtess"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":519,"asset_type":"URL","asset_identifier":"app.legalrobot.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1982789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@danrubins any update ? sorry for inconvinance but i am pinging as it's more then time of first response .\n\n","markdown_message":"\u003cp\u003e\u003ca href=\"/danrubins\"\u003e@danrubins\u003c/a\u003e any update ? sorry for inconvinance but i am pinging as it\u0026#39;s more then time of first response .\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T14:23:05.718Z","updated_at":"2017-09-07T14:23:05.718Z","actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1991567,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-12T12:37:15.272Z","updated_at":"2017-09-12T12:37:15.272Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":74640},"actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2014664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @danrubins , May i get any update ? Since  its different then common bugs and it's​ have impactful attacking senario in which changing the life time of reset token attacker can compromise user account .\nBest.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/danrubins\"\u003e@danrubins\u003c/a\u003e , May i get any update ? Since  its different then common bugs and it\u0026#39;s​ have impactful attacking senario in which changing the life time of reset token attacker can compromise user account .\u003cbr\u003e\nBest.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-22T17:12:19.363Z","updated_at":"2017-09-22T17:12:19.363Z","actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2086140,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. Of course, you can always change your own cookies, locally. This is the equivalent of changing HTML in your own browser. One of the cookie values is just there to set the display of the session timeout for the user and doesn't have any security impact. The other value, the token that is actually sensitive, is revalidated on the server against the timestamp that exists on the server side. So, there's really no problem with adjusting the cookies on the client, we always revalidate the input on the server side.","markdown_message":"\u003cp\u003eThanks for the report. Of course, you can always change your own cookies, locally. This is the equivalent of changing HTML in your own browser. One of the cookie values is just there to set the display of the session timeout for the user and doesn\u0026#39;t have any security impact. The other value, the token that is actually sensitive, is revalidated on the server against the timestamp that exists on the server side. So, there\u0026#39;s really no problem with adjusting the cookies on the client, we always revalidate the input on the server side.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-19T20:41:57.111Z","updated_at":"2017-10-19T20:41:57.111Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2086143,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure in the interest of transparency.","markdown_message":"\u003cp\u003eRequesting full disclosure in the interest of transparency.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-19T20:42:34.497Z","updated_at":"2017-10-19T20:42:34.497Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2087635,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you please look at #265652. \nThx","markdown_message":"\u003cp\u003eCan you please look at \u003ca href=\"/reports/265652\"\u003e#265652\u003c/a\u003e. \u003cbr\u003e\nThx\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-20T11:08:42.475Z","updated_at":"2017-10-20T11:08:42.475Z","actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2154999,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-13T21:42:28.589Z","updated_at":"2017-11-13T21:42:28.589Z","additional_data":{"old_title":"Add arbitery value in cookie of reset password lead to compromise life time of a token","new_title":"Add arbitrary value in reset password cookie"},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2342145,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T14:41:09.387Z","updated_at":"2018-02-01T14:41:09.387Z","actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2342146,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T14:41:09.512Z","updated_at":"2018-02-01T14:41:09.512Z","actor":{"username":"cuso4","cleared":true,"url":"/cuso4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/181/556/8167516100c0077da496fbf5c10e276d0417655e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}