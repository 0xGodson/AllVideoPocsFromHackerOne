{"id":374748,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzQ3NDg=","url":"https://hackerone.com/reports/374748","title":"SQL injection in Serendipity (serendipity_fetchComments)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-06-30T15:34:42.642Z","submitted_at":"2018-06-30T15:34:42.642Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"oreamnos","url":"/oreamnos","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30278,"url":"https://hackerone.com/hannob","handle":"hannob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Hanno's projects","twitter_handle":"hanno","website":"https://hboeck.de/","about":"Personal web projects from Hanno BÃ¶ck."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-09T14:44:05.375Z","bug_reporter_agreed_on_going_public_at":"2018-11-09T14:44:05.320Z","team_member_agreed_on_going_public_at":"2018-11-09T14:37:41.862Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary\n\nAn authenticated administrator can alter *Entries to display on frontpage* and *Entries to display in Feeds* in a way to perform a SQL injection and extract database records or access files on the underlying system.\n\n##Description\n\nThe function `serendipity_fetchComments` (implemented in `functions_comments.inc.php`) allows to obtain an array of comments related to a specific entry id. It accepts six parameters that will impact the query:\n- `$id`: casted as integer and then used in the query;\n- `$limit`: used unescaped in the query;\n- `$order `: used unescaped in the query;\n- `$showAll`: adds a fixed condition to the query;\n- `$type`: used unescaped in the query;\n- `$where`: used unescaped in the query.\n\nThus, any use of `serendipity_fetchComments` where either `$limit`, `$order`, `$type` or `$where` are user-controlled will result in a SQL injection. Two vulnerable calls were discovered.\n\nThe first one can be found in `rss.php`. The value of `$serendipity['RSSfetchLimit']` comes from website's configuration (*Entries to display in Feeds*) and is used as second argument of `serendipity_fetchComments`:\n\n```php\n\u003c?php\n// [...]\nswitch ($_GET['type']) {\n    case 'comments_and_trackbacks':\n    case 'trackbacks':\n    case 'comments':\n        $entries     = serendipity_fetchComments(isset($_GET['cid']) ? $_GET['cid'] : null, $serendipity['RSSfetchLimit'], 'co.id desc', false, $_GET['type']);\n```\n\nThe same way, `serendipity_printCommentsByAuthor` (implemented in `functions_comments.inc.php`) uses `$serendipity['fetchLimit']` as second argument. The value of `$serendipity['fetchLimit']` also comes from website's configuration (*Entries to display on frontpage*):\n\n```php\n\u003c?php\n// [...]\n    $sql_limit = $serendipity['fetchLimit'] * ($serendipity['GET']['page']-1) . ',' . $serendipity['fetchLimit'];\n    $c = serendipity_fetchComments(null, $sql_limit, 'co.entry_id DESC, co.id ASC', false, $type, $sql_where);\n```\n## Steps To Reproduce\n\n  1. Access https://blog.fuzzing-project.org/serendipity_admin.php?serendipity[adminModule]=configuration as authenticated administrator.\n  1. Alter either *Entries to display on frontpage* or *Entries to display in Feeds* (under *Appearance and Options*) by adding any non-numeric character in one of these fields.\n  1. Access https://blog.fuzzing-project.org/rss.php?type=comment if you edited *Entries to display in Feeds*, or the homepage is you edited *Entries to display on frontpage*. The character \nbroke the correctness of the query and an error message will be displayed.\n\nI don't have any test environment at the moment but let me know if you need a real payload to show it's possible to extract arbitrary database records.\n\n## Impact\n\nAn authenticated administrator can extract database records, including password hashes of other users of the instance. Depending on database user privileges, it could also allow to access other bases or files on the underlying server.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eAn authenticated administrator can alter \u003cem\u003eEntries to display on frontpage\u003c/em\u003e and \u003cem\u003eEntries to display in Feeds\u003c/em\u003e in a way to perform a SQL injection and extract database records or access files on the underlying system.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eThe function \u003ccode\u003eserendipity_fetchComments\u003c/code\u003e (implemented in \u003ccode\u003efunctions_comments.inc.php\u003c/code\u003e) allows to obtain an array of comments related to a specific entry id. It accepts six parameters that will impact the query:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e$id\u003c/code\u003e: casted as integer and then used in the query;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$limit\u003c/code\u003e: used unescaped in the query;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$order\u003c/code\u003e: used unescaped in the query;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$showAll\u003c/code\u003e: adds a fixed condition to the query;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$type\u003c/code\u003e: used unescaped in the query;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$where\u003c/code\u003e: used unescaped in the query.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThus, any use of \u003ccode\u003eserendipity_fetchComments\u003c/code\u003e where either \u003ccode\u003e$limit\u003c/code\u003e, \u003ccode\u003e$order\u003c/code\u003e, \u003ccode\u003e$type\u003c/code\u003e or \u003ccode\u003e$where\u003c/code\u003e are user-controlled will result in a SQL injection. Two vulnerable calls were discovered.\u003c/p\u003e\n\n\u003cp\u003eThe first one can be found in \u003ccode\u003erss.php\u003c/code\u003e. The value of \u003ccode\u003e$serendipity[\u0026#39;RSSfetchLimit\u0026#39;]\u003c/code\u003e comes from website\u0026#39;s configuration (\u003cem\u003eEntries to display in Feeds\u003c/em\u003e) and is used as second argument of \u003ccode\u003eserendipity_fetchComments\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// [...]\u003c/span\u003e\n\u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;type\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;comments_and_trackbacks\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;trackbacks\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"nv\"\u003e$entries\u003c/span\u003e     \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eserendipity_fetchComments\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;cid\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;cid\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;RSSfetchLimit\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;co.id desc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;type\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe same way, \u003ccode\u003eserendipity_printCommentsByAuthor\u003c/code\u003e (implemented in \u003ccode\u003efunctions_comments.inc.php\u003c/code\u003e) uses \u003ccode\u003e$serendipity[\u0026#39;fetchLimit\u0026#39;]\u003c/code\u003e as second argument. The value of \u003ccode\u003e$serendipity[\u0026#39;fetchLimit\u0026#39;]\u003c/code\u003e also comes from website\u0026#39;s configuration (\u003cem\u003eEntries to display on frontpage\u003c/em\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// [...]\u003c/span\u003e\n    \u003cspan class=\"nv\"\u003e$sql_limit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;fetchLimit\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;page\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$serendipity\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;fetchLimit\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eserendipity_fetchComments\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$sql_limit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;co.entry_id DESC, co.id ASC\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$sql_where\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAccess \u003ca title=\"https://blog.fuzzing-project.org/serendipity_admin.php?serendipity%5BadminModule%5D=configuration\" href=\"/redirect?url=https%3A%2F%2Fblog.fuzzing-project.org%2Fserendipity_admin.php%3Fserendipity%255BadminModule%255D%3Dconfiguration\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.fuzzing-project.org/serendipity_admin.php?serendipity%5BadminModule%5D=configuration\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as authenticated administrator.\u003c/li\u003e\n\u003cli\u003eAlter either \u003cem\u003eEntries to display on frontpage\u003c/em\u003e or \u003cem\u003eEntries to display in Feeds\u003c/em\u003e (under \u003cem\u003eAppearance and Options\u003c/em\u003e) by adding any non-numeric character in one of these fields.\u003c/li\u003e\n\u003cli\u003eAccess \u003ca title=\"https://blog.fuzzing-project.org/rss.php?type=comment\" href=\"/redirect?url=https%3A%2F%2Fblog.fuzzing-project.org%2Frss.php%3Ftype%3Dcomment\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.fuzzing-project.org/rss.php?type=comment\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e if you edited \u003cem\u003eEntries to display in Feeds\u003c/em\u003e, or the homepage is you edited \u003cem\u003eEntries to display on frontpage\u003c/em\u003e. The character \nbroke the correctness of the query and an error message will be displayed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI don\u0026#39;t have any test environment at the moment but let me know if you need a real payload to show it\u0026#39;s possible to extract arbitrary database records.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn authenticated administrator can extract database records, including password hashes of other users of the instance. Depending on database user privileges, it could also allow to access other bases or files on the underlying server.\u003c/p\u003e\n","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-09T14:37:41.921Z","allow_singular_disclosure_after":-64854478.44468832,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","geeknik","wphackedhelp"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":11140,"asset_type":"URL","asset_identifier":"*.fuzzing-project.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3048154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @hannob, any update regarding this one? Should I report it directly to upstream?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hannob\"\u003e@hannob\u003c/a\u003e, any update regarding this one? Should I report it directly to upstream?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-15T12:47:20.916Z","updated_at":"2018-07-15T12:47:20.916Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3061889,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Reported to serendipity.\nGarvin (s9y dev) thinks this is a low impact issue, as it requires a logged in admin. But he'll fix it, likely with a proper cast.","markdown_message":"\u003cp\u003eReported to serendipity.\u003cbr\u003e\nGarvin (s9y dev) thinks this is a low impact issue, as it requires a logged in admin. But he\u0026#39;ll fix it, likely with a proper cast.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T14:07:16.141Z","updated_at":"2018-07-18T14:07:16.141Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3063067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is now fixed with a patch I got from s9y's dev (as should be all other open issues).\nI'd appreciate if you could check that and also look for further issues, s9y will soon release a security update.","markdown_message":"\u003cp\u003eThis is now fixed with a patch I got from s9y\u0026#39;s dev (as should be all other open issues).\u003cbr\u003e\nI\u0026#39;d appreciate if you could check that and also look for further issues, s9y will soon release a security update.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T17:38:17.473Z","updated_at":"2018-07-18T17:38:17.473Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3063168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Garvin (s9y dev) thinks this is a low impact issue, as it requires a logged in admin. \n\nI agree, even if it could still be exploited by chaining with #373950. \n\n\u003e I'd appreciate if you could check that and also look for further issues, s9y will soon release a security update.\n\nThe fix (https://github.com/s9y/Serendipity/commit/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f#diff-2168c9599f249d04a7bda43923c908f2R104) looks good to me. I would also add a cast to https://github.com/s9y/Serendipity/blob/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f/include/functions_comments.inc.php#L471, just to be sure.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eGarvin (s9y dev) thinks this is a low impact issue, as it requires a logged in admin. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI agree, even if it could still be exploited by chaining with \u003ca href=\"/reports/373950\"\u003e#373950\u003c/a\u003e. \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI\u0026#39;d appreciate if you could check that and also look for further issues, s9y will soon release a security update.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe fix (\u003ca title=\"https://github.com/s9y/Serendipity/commit/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f#diff-2168c9599f249d04a7bda43923c908f2R104\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fs9y%2FSerendipity%2Fcommit%2F1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f%23diff-2168c9599f249d04a7bda43923c908f2R104\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/s9y/Serendipity/commit/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f#diff-2168c9599f249d04a7bda43923c908f2R104\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) looks good to me. I would also add a cast to \u003ca title=\"https://github.com/s9y/Serendipity/blob/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f/include/functions_comments.inc.php#L471\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fs9y%2FSerendipity%2Fblob%2F1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f%2Finclude%2Ffunctions_comments.inc.php%23L471\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/s9y/Serendipity/blob/1afc4d929d96e5bf63cafd4cb8155ca2fb4e8f5f/include/functions_comments.inc.php#L471\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, just to be sure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T17:57:39.424Z","updated_at":"2018-07-18T17:57:39.424Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3073292,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Suggestion implemented in https://github.com/s9y/Serendipity/commit/005a86da1cacdfb579001d4ff9f85df16b4b5316#diff-e9913ab11efe99f0e30efb4d2f6fd2b9R471.","markdown_message":"\u003cp\u003eSuggestion implemented in \u003ca title=\"https://github.com/s9y/Serendipity/commit/005a86da1cacdfb579001d4ff9f85df16b4b5316#diff-e9913ab11efe99f0e30efb4d2f6fd2b9R471\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fs9y%2FSerendipity%2Fcommit%2F005a86da1cacdfb579001d4ff9f85df16b4b5316%23diff-e9913ab11efe99f0e30efb4d2f6fd2b9R471\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/s9y/Serendipity/commit/005a86da1cacdfb579001d4ff9f85df16b4b5316#diff-e9913ab11efe99f0e30efb4d2f6fd2b9R471\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-20T09:11:53.005Z","updated_at":"2018-07-20T09:11:53.005Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3203944,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This was fixed with the release of Serendipity 2.1.3:\nhttp://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html","markdown_message":"\u003cp\u003eThis was fixed with the release of Serendipity 2.1.3:\u003cbr\u003e\n\u003ca title=\"http://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\" href=\"/redirect?url=http%3A%2F%2Fblog.s9y.org%2Farchives%2F278-Serendipity-2.1.3-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-16T13:31:51.569Z","updated_at":"2018-08-16T13:31:51.569Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"oreamnos","url":"/oreamnos"},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617247,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:37:41.884Z","updated_at":"2018-11-09T14:37:41.884Z","first_to_agree":true,"actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617257,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:44:05.345Z","updated_at":"2018-11-09T14:44:05.345Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3617258,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T14:44:05.395Z","updated_at":"2018-11-09T14:44:05.395Z","actor":{"username":"oreamnos","cleared":false,"url":"/oreamnos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/427/1f5f5e51101ffa57eab64523a8b1fe4e75aee36c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":9817,"category":"team","content":"Bug in upstream Serendipity software, got fixed in version 2.1.3.\n\nThe impact is limited, as it requires a backend login. Still it's a great finding and many thanks to the reporter.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eBug in upstream Serendipity software, got fixed in version 2.1.3.\u003c/p\u003e\n\n\u003cp\u003eThe impact is limited, as it requires a backend login. Still it\u0026#39;s a great finding and many thanks to the reporter.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}