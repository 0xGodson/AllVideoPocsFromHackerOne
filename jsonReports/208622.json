{"id":208622,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDg2MjI=","url":"https://hackerone.com/reports/208622","title":"Reflected cross-site scripting (XSS) vulnerability in scores.ubnt.com allows attackers to inject arbitrary web script via p parameter.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-02-24T13:55:30.609Z","submitted_at":"2017-02-24T13:55:30.609Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-04-07T17:03:58.797Z","bug_reporter_agreed_on_going_public_at":"2017-03-08T17:03:46.269Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Ubiquiti Networks bug bounty team,\n\n# Short Description\n---\n\nscores.ubnt.com is still vulnerable to reflected XSS, a form of client-side code injection wherein one can execute malicious scripts into a page. The fix to https://hackerone.com/reports/158484 does not suffice for some browsers (mainly older versions) since there are `style` attribute XSS vectors.\n\n# Why does this vulnerability exist?\n---\n\nCross-site scripting exists whenever input can be interpreted as code. Scripts can be injected into the `style` attribute via the `p` parameter as follows:\n\nhttps://scores.ubnt.com/form.html?uid=259\u0026p=airFiber);xss:expression(alert(1));border-image:url(foobar\n\nHere are a list of payloads:\n\n~~~\n);xss:expression(alert(1));border-image:url(foobar\n);border-image: url(javascript:alert(1));content:url(foobar\n~~~\n\n# What are the exploits?\n---\n\nA cross-site scripting vulnerability allows an attacker to modify the page. This means he/she can inject forms to steal usernames, passwords, cookies (no HttpOnly flag present) and so forth. In short, XSS opens the doors to plenty of phishing techniques.\n\nA very good list of malicious payloads can be found here: http://www.xss-payloads.com/payloads.html\n\n","vulnerability_information_html":"\u003cp\u003eDear Ubiquiti Networks bug bounty team,\u003c/p\u003e\n\n\u003ch1 id=\"short-description\"\u003eShort Description\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003escores.ubnt.com is still vulnerable to reflected XSS, a form of client-side code injection wherein one can execute malicious scripts into a page. The fix to \u003ca title=\"https://hackerone.com/reports/158484\" href=\"https://hackerone.com/reports/158484\"\u003ehttps://hackerone.com/reports/158484\u003c/a\u003e does not suffice for some browsers (mainly older versions) since there are \u003ccode\u003estyle\u003c/code\u003e attribute XSS vectors.\u003c/p\u003e\n\n\u003ch1 id=\"why-does-this-vulnerability-exist\"\u003eWhy does this vulnerability exist?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eCross-site scripting exists whenever input can be interpreted as code. Scripts can be injected into the \u003ccode\u003estyle\u003c/code\u003e attribute via the \u003ccode\u003ep\u003c/code\u003e parameter as follows:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://scores.ubnt.com/form.html?uid=259\u0026amp;p=airFiber)%3Bxss:expression(alert(1))%3Bborder-image:url(foobar\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D259%26p%3DairFiber%29%253Bxss%3Aexpression%28alert%281%29%29%253Bborder-image%3Aurl%28foobar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=259\u0026amp;p=airFiber)%3Bxss:expression(alert(1))%3Bborder-image:url(foobar\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHere are a list of payloads:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e);xss:expression(alert(1));border-image:url(foobar\n);border-image: url(javascript:alert(1));content:url(foobar\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"what-are-the-exploits\"\u003eWhat are the exploits?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eA cross-site scripting vulnerability allows an attacker to modify the page. This means he/she can inject forms to steal usernames, passwords, cookies (no HttpOnly flag present) and so forth. In short, XSS opens the doors to plenty of phishing techniques.\u003c/p\u003e\n\n\u003cp\u003eA very good list of malicious payloads can be found here: \u003ca title=\"http://www.xss-payloads.com/payloads.html\" href=\"/redirect?url=http%3A%2F%2Fwww.xss-payloads.com%2Fpayloads.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.xss-payloads.com/payloads.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-07T17:03:46.319Z","allow_singular_disclosure_after":-117633135.38763136,"singular_disclosure_allowed":true,"vote_count":9,"voters":["delimitry","sp1d3rs","ysx","eveeez","linkks","japz","hacklad","0x718","spetr0x"],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1524761,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Dear Ubiquiti Networks bug bounty team,\n\nI was checking on the status of this report and I was wondering if you could give me an update. Is there anything that I can do to help?\n\nYours sincerely,\nEd","markdown_message":"\u003cp\u003eDear Ubiquiti Networks bug bounty team,\u003c/p\u003e\n\n\u003cp\u003eI was checking on the status of this report and I was wondering if you could give me an update. Is there anything that I can do to help?\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-07T17:26:06.378Z","updated_at":"2017-03-07T17:26:06.378Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1524800,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-07T17:37:17.828Z","updated_at":"2017-03-07T17:37:17.828Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1526654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nJust need your confirmation before close it.\n\nThanks","markdown_message":"\u003cp\u003eHi \u003ca href=\"/edio\"\u003e@edio\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eJust need your confirmation before close it.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-08T11:13:32.557Z","updated_at":"2017-03-08T11:13:32.557Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1527355,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ubnt-rubens,\n\nI can confirm that by forcing input to remain inside the `url` property I am unable to inject code.\n\n~~~\nurl('/images/logo-\" + rating.product.replace(/['\"]/g, '') + \".png')\\\" /\u003e\")\n~~~\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ubnt-rubens\"\u003e@ubnt-rubens\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI can confirm that by forcing input to remain inside the \u003ccode\u003eurl\u003c/code\u003e property I am unable to inject code.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eurl(\u0026#39;/images/logo-\u0026quot; + rating.product.replace(/[\u0026#39;\u0026quot;]/g, \u0026#39;\u0026#39;) + \u0026quot;.png\u0026#39;)\\\u0026quot; /\u0026gt;\u0026quot;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-08T16:01:12.113Z","updated_at":"2017-03-08T16:01:12.113Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1527531,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-08T17:01:32.591Z","updated_at":"2017-03-08T17:01:32.591Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"edoverflow","url":"/edoverflow"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1527535,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you and good luck with future bug hunting.","markdown_message":"\u003cp\u003eThank you and good luck with future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-08T17:01:41.343Z","updated_at":"2017-03-08T17:01:41.343Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1527547,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you very much for rewarding me with a bounty! 😊 I look forward to working with you again in the future.","markdown_message":"\u003cp\u003eThank you very much for rewarding me with a bounty! 😊 I look forward to working with you again in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-08T17:03:46.287Z","updated_at":"2017-03-08T17:03:46.287Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1589715,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-07T17:03:58.820Z","updated_at":"2017-04-07T17:03:58.820Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}