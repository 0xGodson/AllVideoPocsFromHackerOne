{"id":127077,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjcwNzc=","url":"https://hackerone.com/reports/127077","title":"www.lahitapiola.fi DOM XSS by choosing regional company","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-31T09:17:34.671Z","submitted_at":"2016-03-31T09:17:34.671Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reactors08","url":"/reactors08","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-01T12:47:58.657Z","bug_reporter_agreed_on_going_public_at":"2016-06-01T12:47:38.023Z","team_member_agreed_on_going_public_at":"2016-06-01T12:31:45.565Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"please check screenshot first.\nbrowser: Chrome(latest) or Internet Explorer 11\nsteps to reproduce:\n- go to page http://www.lahitapiola.fi/henkilo#\"\u003e\u003cimg src=x onerror=alert(1)\u003e\n- press `Valitse alueyhtiösi` button\n- input zip e.g. 111\n\nvulnerable js code - https://www.lahitapiola.fi/cs/lahitapiola/js/scripts.js\n","vulnerability_information_html":"\u003cp\u003eplease check screenshot first.\u003cbr\u003e\nbrowser: Chrome(latest) or Internet Explorer 11\u003cbr\u003e\nsteps to reproduce:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ego to page \u003ca title=\"http://www.lahitapiola.fi/henkilo#%22%3E\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo%23%2522%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/henkilo#%22%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;img src=x onerror=alert(1)\u0026gt;\u003c/li\u003e\n\u003cli\u003epress \u003ccode\u003eValitse alueyhtiösi\u003c/code\u003e button\u003c/li\u003e\n\u003cli\u003einput zip e.g. 111\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003evulnerable js code - \u003ca title=\"https://www.lahitapiola.fi/cs/lahitapiola/js/scripts.js\" href=\"/redirect?url=https%3A%2F%2Fwww.lahitapiola.fi%2Fcs%2Flahitapiola%2Fjs%2Fscripts.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lahitapiola.fi/cs/lahitapiola/js/scripts.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":82297,"file_name":"lahitapiola_dom_xss_location_href.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/082/297/692f0458c36712f783fa7ad9d9e028d04e88b316/lahitapiola_dom_xss_location_href.jpg?response-content-disposition=attachment%3B%20filename%3D%22lahitapiola_dom_xss_location_href.jpg%22%3B%20filename%2A%3DUTF-8%27%27lahitapiola_dom_xss_location_href.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042318Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=b3b2a12869487f7052fd52233271561ff8980afe12f4019a01f7bb9ee9089e1a","file_size":196471,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-07-01T12:31:45.631Z","allow_singular_disclosure_after":-141839493.15779555,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":922086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reactors08. As you probably know, the issue is found in  an external library component. We are currently looking into the possibility to update this component to the latest version. I will keep you posted.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/reactors08\"\u003e@reactors08\u003c/a\u003e. As you probably know, the issue is found in  an external library component. We are currently looking into the possibility to update this component to the latest version. I will keep you posted.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-22T07:00:59.396Z","updated_at":"2016-04-22T07:00:59.396Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":952998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reactors08 . We are currently verifying whether or not the proposed fix actually fixed this issue fully. There will be a 100$ bounty which will be paid out once the fix is verified.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/reactors08\"\u003e@reactors08\u003c/a\u003e . We are currently verifying whether or not the proposed fix actually fixed this issue fully. There will be a 100$ bounty which will be paid out once the fix is verified.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T12:02:40.077Z","updated_at":"2016-05-12T12:02:40.077Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":969906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quick update. There will be a fix for this during next week.","markdown_message":"\u003cp\u003eQuick update. There will be a fix for this during next week.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-23T12:33:52.454Z","updated_at":"2016-05-23T12:33:52.454Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. This issue is now fixed. I would appreciate it if you could retest your finding and let me know that you agree on the fix. Thank you.","markdown_message":"\u003cp\u003eHello. This issue is now fixed. I would appreciate it if you could retest your finding and let me know that you agree on the fix. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T07:36:40.726Z","updated_at":"2016-06-01T07:36:40.726Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. The bug has been fixed.","markdown_message":"\u003cp\u003eHi. The bug has been fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T10:42:19.035Z","updated_at":"2016-06-01T10:42:19.035Z","actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994626,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T11:28:36.179Z","updated_at":"2016-06-01T11:28:36.179Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"reactors08","url":"/reactors08"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994677,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for verifying this.","markdown_message":"\u003cp\u003eThank you for verifying this.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T12:31:24.178Z","updated_at":"2016-06-01T12:31:24.178Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"reactors08","url":"/reactors08"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994678,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T12:31:45.587Z","updated_at":"2016-06-01T12:31:45.587Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994689,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T12:47:38.044Z","updated_at":"2016-06-01T12:47:38.044Z","actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994691,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T12:47:58.677Z","updated_at":"2016-06-01T12:47:58.677Z","actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2020,"category":"team","content":"##Issue\n\nThe reporter found a bug in one of the client side javascript libraries used on the LocalTapiola website. The bug was an xss-vulnerability. The report contained a brief PoC and a screenshot as proof.\n\n##Fix\n\nThe issue was investigated and found to be valid. The vulnerability was fixed and the fix was deployed to production. The reporter verified the fix as working.\n \n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. The report was publicly disclosed.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a bug in one of the client side javascript libraries used on the LocalTapiola website. The bug was an xss-vulnerability. The report contained a brief PoC and a screenshot as proof.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid. The vulnerability was fixed and the fix was deployed to production. The reporter verified the fix as working.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. The report was publicly disclosed.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}