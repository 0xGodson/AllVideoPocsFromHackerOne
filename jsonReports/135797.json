{"id":135797,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzU3OTc=","url":"https://hackerone.com/reports/135797","title":"Session Fixation","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-02T15:12:07.605Z","submitted_at":"2016-05-02T15:12:07.605Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-22T12:26:59.678Z","bug_reporter_agreed_on_going_public_at":"2016-05-23T12:26:53.454Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary\n-------------\n\nYour login flow is vulnerable to session fixation. This can allow an attacker to steal a valid user session from a victim.\n\nSteps to reproduce\n--------------\n\n1. As the attacker go to https://wallet.sandbox.romit.io (but do not login!) and check the cookies `romit.sandbox.session` and `SANDBOX-XSRF-TOKEN`, that are set. For example:\n\n    ```\nSANDBOX-XSRF-TOKEN=AAG02cId-yyza3k8uhQR7JKuB-4YOmhizkjM; \nromit.sandbox.session=s%3AEHm0kA9uwWYHayOwdRQXbuZWEIRIliQZ.ndejz36ofa52c9ENnApLuaLkMnTYCot3IiY1qdTvz0w;\n```\n2. Now simulate the victim by opening a second browser and setting those two cookies.\n3. As the victim, login in the second browser.\n4. As the attacker, go to https://wallet.sandbox.romit.io (using the first browser / same cookies as in step 1). You are now logged in to the victims account.\n\nPossible exploitation scenarios\n---------------\n\nThis can be exploited if there is another bug like HTTP Response Splitting on your website. \n\nBut a far easier way is to exploit this on shared computers. For example in a library, as an attacker open https://wallet.sandbox.romit.io (but do not login!) and keep note of the cookies as above in step 1. Then simply go away and now when a victim will use the same computer and try to login, the attacker will have access to the victims account.\n\nMitigation\n--------------\n\nIf you assign a new session when someone logs in, this flaw should be fixed.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eYour login flow is vulnerable to session fixation. This can allow an attacker to steal a valid user session from a victim.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eAs the attacker go to \u003ca title=\"https://wallet.sandbox.romit.io\" href=\"/redirect?url=https%3A%2F%2Fwallet.sandbox.romit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.sandbox.romit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (but do not login!) and check the cookies \u003ccode\u003eromit.sandbox.session\u003c/code\u003e and \u003ccode\u003eSANDBOX-XSRF-TOKEN\u003c/code\u003e, that are set. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSANDBOX-XSRF-TOKEN=AAG02cId-yyza3k8uhQR7JKuB-4YOmhizkjM; \nromit.sandbox.session=s%3AEHm0kA9uwWYHayOwdRQXbuZWEIRIliQZ.ndejz36ofa52c9ENnApLuaLkMnTYCot3IiY1qdTvz0w;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNow simulate the victim by opening a second browser and setting those two cookies.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAs the victim, login in the second browser.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAs the attacker, go to \u003ca title=\"https://wallet.sandbox.romit.io\" href=\"/redirect?url=https%3A%2F%2Fwallet.sandbox.romit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.sandbox.romit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (using the first browser / same cookies as in step 1). You are now logged in to the victims account.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"possible-exploitation-scenarios\"\u003ePossible exploitation scenarios\u003c/h2\u003e\n\n\u003cp\u003eThis can be exploited if there is another bug like HTTP Response Splitting on your website. \u003c/p\u003e\n\n\u003cp\u003eBut a far easier way is to exploit this on shared computers. For example in a library, as an attacker open \u003ca title=\"https://wallet.sandbox.romit.io\" href=\"/redirect?url=https%3A%2F%2Fwallet.sandbox.romit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.sandbox.romit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (but do not login!) and keep note of the cookies as above in step 1. Then simply go away and now when a victim will use the same computer and try to login, the attacker will have access to the victims account.\u003c/p\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003cp\u003eIf you assign a new session when someone logs in, this flaw should be fixed.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-22T12:26:53.568Z","allow_singular_disclosure_after":-142617560.40763095,"singular_disclosure_allowed":true,"vote_count":7,"voters":["gamliel","fantam1","at3nder","iamashishgeek","spetr0x","zeroknife","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":940589,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-04T17:50:03.019Z","updated_at":"2016-05-04T17:50:03.019Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":941105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Edgar, I think we've fixed it on wallet.sandbox.romit.io. Can you please verify?","markdown_message":"\u003cp\u003eEdgar, I think we\u0026#39;ve fixed it on wallet.sandbox.romit.io. Can you please verify?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T21:37:44.500Z","updated_at":"2016-05-04T21:37:44.500Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":942001,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Darin,\nthat was a fast fix! I can confirm, it works properly now. ","markdown_message":"\u003cp\u003eHey Darin,\u003cbr\u003e\nthat was a fast fix! I can confirm, it works properly now. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T13:04:53.704Z","updated_at":"2016-05-05T13:04:53.704Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942005,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually, there is one issue that remains: You generate a new session now, but the CSRF token stays the same. So while an attacker might not hijack the whole session directly, he can use CSRF on the victim. Might be good to also generate a new token along with the new session.","markdown_message":"\u003cp\u003eActually, there is one issue that remains: You generate a new session now, but the CSRF token stays the same. So while an attacker might not hijack the whole session directly, he can use CSRF on the victim. Might be good to also generate a new token along with the new session.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T13:11:23.872Z","updated_at":"2016-05-05T13:11:23.872Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":963806,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-18T20:51:17.063Z","updated_at":"2016-05-18T20:51:17.063Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":963807,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\nThanks again!","markdown_message":"\u003cp\u003eThank you for helping us resolve this issue.  In this case, our security was adjusted for better defense in depth, but no direct exploitation is possible.  As a result, we are rewarding $50 for identifying it.\u003cbr\u003e\nThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-18T20:51:33.683Z","updated_at":"2016-05-18T20:51:33.683Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":963924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","markdown_message":"\u003cp\u003eThank you for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-18T21:52:45.267Z","updated_at":"2016-05-18T21:52:58.997Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":969887,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Mind disclosing this? Thank you.","markdown_message":"\u003cp\u003eMind disclosing this? Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-23T12:26:53.498Z","updated_at":"2016-05-23T12:26:53.498Z","first_to_agree":true,"actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028159,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-22T12:26:59.774Z","updated_at":"2016-06-22T12:26:59.774Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}