{"id":369185,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjkxODU=","url":"https://hackerone.com/reports/369185","title":"Unsafe handling of protocol handlers","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-06-20T14:09:09.983Z","submitted_at":"2018-06-20T14:09:09.983Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-24T23:36:53.728Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T16:21:31.369Z","team_member_agreed_on_going_public_at":"2018-09-24T23:36:53.613Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nBrave browser (macOS) handles protocol handlers in unsafe way (and differently from other browsers).\nKey differences between protocol handlers handling in Brave and other browsers:\n\n### Open external app vs Open \"Terminal\" \n\nBrave only asks about opening external app. \nOther browsers (e.g. Chrome) asks about opening a specific app. \n\nTry to open a `ssh://` link in Chrome: browser opens a popup with a question similar to \"Do you want to open \"Terminal\"?\" \n\nOpening `ssh://` in Brave results in a popup with a content similar to : \"Do you want to open external app for ssh://\"\n\n\u003e Sorry, I didn't remember actual popups' content + I've got RU version\n\n#### Impact\n\nUser doesn't know which app will be opened after allowing to open an external app.\nThat means it easier for attacker to trick user to open an external app in Brave compared to other browsers.\n\nThis applies to all protocol handlers in Brave browser, not only `ssh://` or `telnet://`.\n\n### ssh:// and telnet:// without confirmation\n\nIn Chrome/Safari/FF, after opening Terminal using `ssh://` link, Terminal shows an alert with a text similar to \"Do you want to initiate ssh session with **example.com*?\".\n\nNext things worth noting:\n1. There is an additional confirmation dialog in Terminal while navigating to ssh:// through browser.\n1. Default answer in the confirmation dialog is negative. (\"Don't connect\")\n3. **example.com**: user sees exact host\n\nBrave browser initiates `ssh://` and `telnet://` sessions automatically after opening the external app (Terminal) without confirmation messages.\n\nIf browser handles `ssh://` URLs  by default, any iframe with `src=\"ssh://example.com\"` could automatically start ssh session without user's interaction.  Additionally, it's possible to silently initiate ssh connection, by running `alert()` on `window.onblur` event - Terminal isn't visible in this case.\n\nSame applies to `telnet://` too.\n\n## Version:\nBrave\t0.22.810\nV8\t6.7.288.43\nrev\t8f30eeb\nMuon\t7.0.6\nOS Release\t17.6.0\nUpdate Channel\tRelease\nOS Architecture\tx64\nOS Platform\tmacOS\nNode.js\t7.9.0\nBrave Sync\tv1.4.2\nlibchromiumcontent\t67.0.3396.71\n\n## Steps To Reproduce:\n\n1. Open exploit.html\n2. Click `ssh://google.com` link\n3. Allow opening an external app\n4. Terminal launched without additional alerts/warnings\n\n1. Open `exploit.html`\n2. Click `ssh://google.com` link\n3. Remember `ssh://` (set as default handler)\n4. Add iframe \u003c-- Any iframe could automatically trigger ssh connection without confirmation\n\n## Impact\n\n1. No confirmation message for external apps. - definitely bad behavior. Brave handles all protocol handlers in this way, not only `ssh://` || `telnet://`\n\n2. SSH connection without confirmation - ssh sessions leak important user info: IP, username, etc. Also, it opens a wider attack surface.\n\n3. If `ssh://` is allowed to open by default (i.e. \"remembered\"): Any iframe could automatically trigger ssh session. It's possible to start ssh session without user's notice by calling `alert()` after navigation to `ssh://`\n\n4. Terminal doesn't alert hostname in confirmation dialog (because of no confirmation dialog), so it's possible to spoof host to which user connects. \n\nExample/Attack scenario for #4:\n1. link points to `ssh://abc.xyz` and the text of the link is \"Connect to google.com\". \n2. User clicks and initiates connection to abc.xyz. \n3. In most cases host will be visible in terminal tab's header. However, because ssh command isn't printed in terminal output while navigating through `ssh://` URLs, it's ease to not notice real host name and continue treat it as `google.com`.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eBrave browser (macOS) handles protocol handlers in unsafe way (and differently from other browsers).\u003cbr\u003e\nKey differences between protocol handlers handling in Brave and other browsers:\u003c/p\u003e\n\n\u003ch3 id=\"open-external-app-vs-open-terminal\"\u003eOpen external app vs Open \u0026quot;Terminal\u0026quot;\u003c/h3\u003e\n\n\u003cp\u003eBrave only asks about opening external app. \u003cbr\u003e\nOther browsers (e.g. Chrome) asks about opening a specific app. \u003c/p\u003e\n\n\u003cp\u003eTry to open a \u003ccode\u003essh://\u003c/code\u003e link in Chrome: browser opens a popup with a question similar to \u0026quot;Do you want to open \u0026quot;Terminal\u0026quot;?\u0026quot; \u003c/p\u003e\n\n\u003cp\u003eOpening \u003ccode\u003essh://\u003c/code\u003e in Brave results in a popup with a content similar to : \u0026quot;Do you want to open external app for ssh://\u0026quot;\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSorry, I didn\u0026#39;t remember actual popups\u0026#39; content + I\u0026#39;ve got RU version\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4 id=\"impact\"\u003eImpact\u003c/h4\u003e\n\n\u003cp\u003eUser doesn\u0026#39;t know which app will be opened after allowing to open an external app.\u003cbr\u003e\nThat means it easier for attacker to trick user to open an external app in Brave compared to other browsers.\u003c/p\u003e\n\n\u003cp\u003eThis applies to all protocol handlers in Brave browser, not only \u003ccode\u003essh://\u003c/code\u003e or \u003ccode\u003etelnet://\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch3 id=\"ssh-and-telnet-without-confirmation\"\u003essh:// and telnet:// without confirmation\u003c/h3\u003e\n\n\u003cp\u003eIn Chrome/Safari/FF, after opening Terminal using \u003ccode\u003essh://\u003c/code\u003e link, Terminal shows an alert with a text similar to \u0026quot;Do you want to initiate ssh session with *\u003cem\u003eexample.com\u003c/em\u003e?\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eNext things worth noting:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThere is an additional confirmation dialog in Terminal while navigating to ssh:// through browser.\u003c/li\u003e\n\u003cli\u003eDefault answer in the confirmation dialog is negative. (\u0026quot;Don\u0026#39;t connect\u0026quot;)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eexample.com\u003c/strong\u003e: user sees exact host\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eBrave browser initiates \u003ccode\u003essh://\u003c/code\u003e and \u003ccode\u003etelnet://\u003c/code\u003e sessions automatically after opening the external app (Terminal) without confirmation messages.\u003c/p\u003e\n\n\u003cp\u003eIf browser handles \u003ccode\u003essh://\u003c/code\u003e URLs  by default, any iframe with \u003ccode\u003esrc=\u0026quot;ssh://example.com\u0026quot;\u003c/code\u003e could automatically start ssh session without user\u0026#39;s interaction.  Additionally, it\u0026#39;s possible to silently initiate ssh connection, by running \u003ccode\u003ealert()\u003c/code\u003e on \u003ccode\u003ewindow.onblur\u003c/code\u003e event - Terminal isn\u0026#39;t visible in this case.\u003c/p\u003e\n\n\u003cp\u003eSame applies to \u003ccode\u003etelnet://\u003c/code\u003e too.\u003c/p\u003e\n\n\u003ch2 id=\"version\"\u003eVersion:\u003c/h2\u003e\n\n\u003cp\u003eBrave   0.22.810\u003cbr\u003e\nV8  6.7.288.43\u003cbr\u003e\nrev 8f30eeb\u003cbr\u003e\nMuon    7.0.6\u003cbr\u003e\nOS Release  17.6.0\u003cbr\u003e\nUpdate Channel  Release\u003cbr\u003e\nOS Architecture x64\u003cbr\u003e\nOS Platform macOS\u003cbr\u003e\nNode.js 7.9.0\u003cbr\u003e\nBrave Sync  v1.4.2\u003cbr\u003e\nlibchromiumcontent  67.0.3396.71\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen exploit.html\u003c/li\u003e\n\u003cli\u003eClick \u003ccode\u003essh://google.com\u003c/code\u003e link\u003c/li\u003e\n\u003cli\u003eAllow opening an external app\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTerminal launched without additional alerts/warnings\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOpen \u003ccode\u003eexploit.html\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eClick \u003ccode\u003essh://google.com\u003c/code\u003e link\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRemember \u003ccode\u003essh://\u003c/code\u003e (set as default handler)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAdd iframe \u0026lt;-- Any iframe could automatically trigger ssh connection without confirmation\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eNo confirmation message for external apps. - definitely bad behavior. Brave handles all protocol handlers in this way, not only \u003ccode\u003essh://\u003c/code\u003e || \u003ccode\u003etelnet://\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSSH connection without confirmation - ssh sessions leak important user info: IP, username, etc. Also, it opens a wider attack surface.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf \u003ccode\u003essh://\u003c/code\u003e is allowed to open by default (i.e. \u0026quot;remembered\u0026quot;): Any iframe could automatically trigger ssh session. It\u0026#39;s possible to start ssh session without user\u0026#39;s notice by calling \u003ccode\u003ealert()\u003c/code\u003e after navigation to \u003ccode\u003essh://\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTerminal doesn\u0026#39;t alert hostname in confirmation dialog (because of no confirmation dialog), so it\u0026#39;s possible to spoof host to which user connects. \u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eExample/Attack scenario for #4:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003elink points to \u003ccode\u003essh://abc.xyz\u003c/code\u003e and the text of the link is \u0026quot;Connect to google.com\u0026quot;. \u003c/li\u003e\n\u003cli\u003eUser clicks and initiates connection to abc.xyz. \u003c/li\u003e\n\u003cli\u003eIn most cases host will be visible in terminal tab\u0026#39;s header. However, because ssh command isn\u0026#39;t printed in terminal output while navigating through \u003ccode\u003essh://\u003c/code\u003e URLs, it\u0026#39;s ease to not notice real host name and continue treat it as \u003ccode\u003egoogle.com\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","original_report_id":null,"original_report_url":null,"attachments":[{"id":310762,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/310/762/3d1fe029b56ac2867592af33f20339ea2d9b4764/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054450Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=daf059826f92d409d36afe6b9498b980b4fa716ffa6b611ffcf2e27c4c74f596","file_size":537,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["bl4de","sameerphad72","metnew","mygf","eveeez","japz","cryptographer","0x08","upender-33","jatacheers","and 1 more..."],"severity":{"rating":"low","score":3.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2919926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @metnew,\n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n\n@fidgetspinner","markdown_message":"\u003cp\u003eHi \u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/fidgetspinner\"\u003e@fidgetspinner\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T07:36:29.774Z","updated_at":"2018-06-22T07:36:29.774Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2919935,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @metnew,\n\nThank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.\n\nKind regards,\n\n@fidgetspinner","markdown_message":"\u003cp\u003eHi \u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/fidgetspinner\"\u003e@fidgetspinner\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T07:40:50.710Z","updated_at":"2018-06-22T07:40:50.710Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2919936,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-22T07:41:20.729Z","updated_at":"2018-06-22T07:41:20.729Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.1)","old_severity_id":170981,"new_severity_id":171845},"actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2922974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Tracked here: https://github.com/brave/browser-laptop/issues/14519","markdown_message":"\u003cp\u003eTracked here: \u003ca title=\"https://github.com/brave/browser-laptop/issues/14519\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F14519\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/14519\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T16:37:34.487Z","updated_at":"2018-06-22T16:37:34.487Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3000417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found [this issue](https://github.com/brave/browser-laptop/issues/14664) in `brave/laptop-browser` repo. Seems like `file:///` could leak real ip in tor tabs.\n\n`ssh://` and `telnet://` protocols could be used for deanonymization too. Could @brave reconsider severity of this bug?\n\n@pranjal_jumde @fidgetspinner ","markdown_message":"\u003cp\u003eI found \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F14664\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in \u003ccode\u003ebrave/laptop-browser\u003c/code\u003e repo. Seems like \u003ccode\u003efile:///\u003c/code\u003e could leak real ip in tor tabs.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003essh://\u003c/code\u003e and \u003ccode\u003etelnet://\u003c/code\u003e protocols could be used for deanonymization too. Could \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e reconsider severity of this bug?\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/pranjal_jumde\"\u003e@pranjal_jumde\u003c/a\u003e \u003ca href=\"/fidgetspinner\"\u003e@fidgetspinner\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T14:30:57.537Z","updated_at":"2018-07-06T14:30:57.537Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that this only works if the URL is entered on an about: page such as about:newtab, which is considered a privileged context. If you go to a site like google.com and then try to enter ssh://... in the URLbar, it will prompt for permission.","markdown_message":"\u003cp\u003eNote that this only works if the URL is entered on an about: page such as about:newtab, which is considered a privileged context. If you go to a site like google.com and then try to enter ssh://... in the URLbar, it will prompt for permission.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:11:14.002Z","updated_at":"2018-07-06T22:11:14.002Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3003563,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"opened https://github.com/brave/browser-laptop/issues/14679 for the part of this that we intend to fix","markdown_message":"\u003cp\u003eopened \u003ca title=\"https://github.com/brave/browser-laptop/issues/14679\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F14679\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/14679\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for the part of this that we intend to fix\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:16:29.187Z","updated_at":"2018-07-06T22:16:29.187Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3003585,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Maybe I misunderstood something, but the vulnerability described in this report is kind of different.\nIf a user set to open ssh or telnet by default, ssh session will be opened immediately without confirmation (that's the key concept of this report)\nSame applies to ssh/telnet sessions initiated after allowing to open an external app (Terminal) - these sessions don't require additional confirmations.\nI didn't write anything about behavior with `about:` pages and protocol handlers, so maybe it's better to re-check the report.\n\n\u003e But as I understand, Brave is going to blacklist all protocols except `https/https/chrome/chrome-devtools` (if I remember correctly). That's why I asking: Why the issue described in the report couldn't be considered as a valid technique to deanonymize Tor tabs users in Brave?\n","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Maybe I misunderstood something, but the vulnerability described in this report is kind of different.\u003cbr\u003e\nIf a user set to open ssh or telnet by default, ssh session will be opened immediately without confirmation (that\u0026#39;s the key concept of this report)\u003cbr\u003e\nSame applies to ssh/telnet sessions initiated after allowing to open an external app (Terminal) - these sessions don\u0026#39;t require additional confirmations.\u003cbr\u003e\nI didn\u0026#39;t write anything about behavior with \u003ccode\u003eabout:\u003c/code\u003e pages and protocol handlers, so maybe it\u0026#39;s better to re-check the report.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eBut as I understand, Brave is going to blacklist all protocols except \u003ccode\u003ehttps/https/chrome/chrome-devtools\u003c/code\u003e (if I remember correctly). That\u0026#39;s why I asking: Why the issue described in the report couldn\u0026#39;t be considered as a valid technique to deanonymize Tor tabs users in Brave?\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-06T22:24:10.362Z","updated_at":"2018-07-06T22:24:10.362Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry maybe i don't understand what you mean by \"If a user set to open ssh or telnet by default, ssh session will be opened immediately without confirmation\". \n\nIf a user sees the \"Allow ssh: URLs to open an external application?\" prompt in brave, clicks 'remember this decision', and clicks 'allow', then I would expect SSH URLs to open in Brave without further confirmation in the future because the user has already expressed that they would like to open those URLs. \n\nAre you saying there's a way to open SSH: URLs (outside of about: pages) without any confirmations at all? that would be a bug.\n\n\u003e Why the issue described in the report couldn't be considered as a valid technique to deanonymize Tor tabs users in Brave?\n\nWe can't prevent these kinds of deanonymization attacks unless the whole operating system is using Tor. Even if Brave blocked the permission request in Tor tabs, a website could still say \"To use our website, open this application and connect to ...\" which would deanonymize the user since the other application doesn't use Tor. \n\nIn general, we will award for Tor IP leaks that don't require much user interaction.","markdown_message":"\u003cp\u003eSorry maybe i don\u0026#39;t understand what you mean by \u0026quot;If a user set to open ssh or telnet by default, ssh session will be opened immediately without confirmation\u0026quot;. \u003c/p\u003e\n\n\u003cp\u003eIf a user sees the \u0026quot;Allow ssh: URLs to open an external application?\u0026quot; prompt in brave, clicks \u0026#39;remember this decision\u0026#39;, and clicks \u0026#39;allow\u0026#39;, then I would expect SSH URLs to open in Brave without further confirmation in the future because the user has already expressed that they would like to open those URLs. \u003c/p\u003e\n\n\u003cp\u003eAre you saying there\u0026#39;s a way to open SSH: URLs (outside of about: pages) without any confirmations at all? that would be a bug.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWhy the issue described in the report couldn\u0026#39;t be considered as a valid technique to deanonymize Tor tabs users in Brave?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe can\u0026#39;t prevent these kinds of deanonymization attacks unless the whole operating system is using Tor. Even if Brave blocked the permission request in Tor tabs, a website could still say \u0026quot;To use our website, open this application and connect to ...\u0026quot; which would deanonymize the user since the other application doesn\u0026#39;t use Tor. \u003c/p\u003e\n\n\u003cp\u003eIn general, we will award for Tor IP leaks that don\u0026#39;t require much user interaction.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:32:54.213Z","updated_at":"2018-07-06T22:32:54.213Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3003644,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"1. If a user selects \"Remember this decision\", all further ssh sessions will be initiated automatically\n2. Combining this bug with #374969 could lead to tor deanonymization in one click.","markdown_message":"\u003col\u003e\n\u003cli\u003eIf a user selects \u0026quot;Remember this decision\u0026quot;, all further ssh sessions will be initiated automatically\u003c/li\u003e\n\u003cli\u003eCombining this bug with \u003ca href=\"/reports/374969\"\u003e#374969\u003c/a\u003e could lead to tor deanonymization in one click.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-07-06T22:49:38.069Z","updated_at":"2018-07-06T22:49:38.069Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003713,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This is a duplicate of https://github.com/brave/browser-laptop/issues/10251.","markdown_message":"\u003cp\u003eThis is a duplicate of \u003ca title=\"https://github.com/brave/browser-laptop/issues/10251\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F10251\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/10251\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T23:12:25.128Z","updated_at":"2018-07-06T23:12:25.128Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003721,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We anticipate resolving this issue in Brave 1.0. We will not be tracking it separately since the issue is not present in that codebase.","markdown_message":"\u003cp\u003eWe anticipate resolving this issue in Brave 1.0. We will not be tracking it separately since the issue is not present in that codebase.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T23:13:19.917Z","updated_at":"2018-07-06T23:13:19.917Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3012018,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-08T00:45:54.691Z","updated_at":"2018-07-08T00:45:54.691Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @brave @diracdeltas @toml Could you cancel public disclosure of this bug?\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e Could you cancel public disclosure of this bug?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-03T23:24:36.347Z","updated_at":"2018-08-03T23:24:36.347Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139472,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:59:00.752Z","updated_at":"2018-08-04T02:59:00.752Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139473,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:59:11.060Z","updated_at":"2018-08-04T02:59:11.060Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359083,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T16:21:31.426Z","updated_at":"2018-09-19T16:21:31.426Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3382932,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-24T23:36:53.653Z","updated_at":"2018-09-24T23:36:53.653Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3382933,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-24T23:36:53.758Z","updated_at":"2018-09-24T23:36:53.758Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}