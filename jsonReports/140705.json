{"id":140705,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDA3MDU=","url":"https://hackerone.com/reports/140705","title":"[my.mail.ru] HTML injection в письмах от myadmin@corp.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-24T12:49:47.991Z","submitted_at":"2016-05-24T12:49:47.991Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-03T11:55:46.251Z","bug_reporter_agreed_on_going_public_at":"2016-09-24T22:24:48.747Z","team_member_agreed_on_going_public_at":"2016-10-03T11:55:46.184Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1) Создаем группу и приглашаем в нее пользователей \nhttps://my.mail.ru/my/editcommunity\n\n2) Меняем название группы на\n`\u003c/a\u003e\u003ca href=\"//blackfan.ru\"\u003e\u003cimg src=\"//blackfan.ru/fk\"\u003e\u003c/a\u003e\u003c!--`\n\n3) Устанавливаем пользователям права модератора или смотрителя\nhttps://my.mail.ru/community/blahblahgroup/communityaccess\n\n4) Откатываем права и меняем название назад\n\nВ результате пользователи получают уведомление \"Вас назначили модератором\" от myadmin@corp.mail.ru. В теле письма содержится html инъекция через название группы:\n\n```\nВы назначены модератором группы \"[html_inj]\"\n```\n\nПример письма в приложении.","vulnerability_information_html":"\u003cp\u003e1) Создаем группу и приглашаем в нее пользователей \u003cbr\u003e\n\u003ca title=\"https://my.mail.ru/my/editcommunity\" href=\"/redirect?url=https%3A%2F%2Fmy.mail.ru%2Fmy%2Feditcommunity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.mail.ru/my/editcommunity\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2) Меняем название группы на\u003cbr\u003e\n\u003ccode\u003e\u0026lt;/a\u0026gt;\u0026lt;a href=\u0026quot;//blackfan.ru\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;//blackfan.ru/fk\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;!--\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e3) Устанавливаем пользователям права модератора или смотрителя\u003cbr\u003e\n\u003ca title=\"https://my.mail.ru/community/blahblahgroup/communityaccess\" href=\"/redirect?url=https%3A%2F%2Fmy.mail.ru%2Fcommunity%2Fblahblahgroup%2Fcommunityaccess\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.mail.ru/community/blahblahgroup/communityaccess\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e4) Откатываем права и меняем название назад\u003c/p\u003e\n\n\u003cp\u003eВ результате пользователи получают уведомление \u0026quot;Вас назначили модератором\u0026quot; от \u003ca title=\"myadmin@corp.mail.ru\" href=\"mailto:myadmin@corp.mail.ru\" rel=\"nofollow noopener noreferrer\"\u003emyadmin@corp.mail.ru\u003c/a\u003e. В теле письма содержится html инъекция через название группы:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eВы назначены модератором группы \u0026quot;[html_inj]\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eПример письма в приложении.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":95553,"file_name":"Screenshot_at_16-34-26.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/095/553/64201aef610be40fc7ed0557ba98a1399b1adee2/Screenshot_at_16-34-26.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_16-34-26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_16-34-26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042802Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=32ec5b12b8c4e9e9101fd5fca90542e74dd999e8b0acfbc96ef5b3bc8048a192","file_size":195193,"type":"image/png"}],"allow_singular_disclosure_at":"2016-10-24T22:24:48.837Z","allow_singular_disclosure_after":-131868193.68651867,"singular_disclosure_allowed":true,"vote_count":4,"voters":["bobrov","samincube","paresh_parmar","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":975646,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.","markdown_message":"\u003cp\u003eСпасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\u003c/p\u003e\n\n\u003cp\u003eПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T14:35:40.716Z","updated_at":"2016-05-24T14:35:40.716Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":983153,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Привет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице https://hackerone.com/settings/bounties можно выбрать желаемый метод выплаты. \n\nСпасибо и ждем от тебя новых багрепортов!\n\nP.S. работа по устранению уязвимости пока продолжается.","markdown_message":"\u003cp\u003eПривет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице \u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e можно выбрать желаемый метод выплаты. \u003c/p\u003e\n\n\u003cp\u003eСпасибо и ждем от тебя новых багрепортов!\u003c/p\u003e\n\n\u003cp\u003eP.S. работа по устранению уязвимости пока продолжается.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T15:30:58.699Z","updated_at":"2016-05-25T15:30:58.699Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1040397,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет, бага закрыта.\nПожалуйста, подтвердите, что проблема больше не воспроизводится. \n","markdown_message":"\u003cp\u003eПривет, бага закрыта.\u003cbr\u003e\nПожалуйста, подтвердите, что проблема больше не воспроизводится. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-27T10:13:55.698Z","updated_at":"2016-06-27T10:13:55.698Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1042271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Проблема исправлена","markdown_message":"\u003cp\u003eПроблема исправлена\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-28T05:52:08.604Z","updated_at":"2016-06-28T05:52:08.604Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1214439,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-24T22:24:48.789Z","updated_at":"2016-09-24T22:24:48.789Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1228944,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-03T11:55:46.212Z","updated_at":"2016-10-03T11:55:46.212Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1228945,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-03T11:55:46.270Z","updated_at":"2016-10-03T11:55:46.270Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}