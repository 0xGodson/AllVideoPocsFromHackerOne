{"id":51166,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTE2Ng==","url":"https://hackerone.com/reports/51166","title":"Email verification links still valid after changing it 2x","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-03-12T17:47:11.177Z","submitted_at":"2015-03-12T17:47:11.177Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackds","url":"/jackds","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/975/99b380468b2f9d3b8f03ecf5c652585a082c2ec5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-13T11:08:45.280Z","bug_reporter_agreed_on_going_public_at":"2015-03-13T09:33:04.433Z","team_member_agreed_on_going_public_at":"2015-03-13T11:08:44.916Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When creating a new account on IRCCloud.com the user is asked to confirm his email address. The email verification link is formatted in the following way: ircloud.com/verify-emai/{user_id}/{email_address}/{hash_value}.\r\n\r\nIf the user decides to change his email address before he confirmed it, a new confirmation mail is sent to his newly entered address. At this point the old verification link is not valid anymore. However, if the user again changes it's email address, and uses the same address as he originally used to create his account the same verification link is sent again as the original one. The hash value in the URL seems to be generated based on the entered email address. This tells me that the hash is not very strong. I would would have expected some randomness here as well, at least to make sure that a new hash is generated the second time the user changed his email address. This can for example be done by adding a random salt to the hash. Ofcourse you will need to store this random value also to be able to recalculate the hash during verification.\r\n\r\nIn short:\r\n- User creates account and receives verification link: verify-email/1/test@test.com/12345\r\n- User changes email address. A new confirmation mail is sent with the following verification link: verify-email/1/otheraddress@test.com/85264\r\n- Now the first verification link is not valid anymore.\r\n- User changes email address back to test@test.com. He now receives the exact same link as before: verify-email/1/test@test.com/12345.","vulnerability_information_html":"\u003cp\u003eWhen creating a new account on IRCCloud.com the user is asked to confirm his email address. The email verification link is formatted in the following way: ircloud.com/verify-emai/{user_id}/{email_address}/{hash_value}.\u003c/p\u003e\n\n\u003cp\u003eIf the user decides to change his email address before he confirmed it, a new confirmation mail is sent to his newly entered address. At this point the old verification link is not valid anymore. However, if the user again changes it\u0026#39;s email address, and uses the same address as he originally used to create his account the same verification link is sent again as the original one. The hash value in the URL seems to be generated based on the entered email address. This tells me that the hash is not very strong. I would would have expected some randomness here as well, at least to make sure that a new hash is generated the second time the user changed his email address. This can for example be done by adding a random salt to the hash. Ofcourse you will need to store this random value also to be able to recalculate the hash during verification.\u003c/p\u003e\n\n\u003cp\u003eIn short:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUser creates account and receives verification link: verify-email/1/\u003ca title=\"test@test.com\" href=\"mailto:test@test.com\" rel=\"nofollow noopener noreferrer\"\u003etest@test.com\u003c/a\u003e/12345\u003c/li\u003e\n\u003cli\u003eUser changes email address. A new confirmation mail is sent with the following verification link: verify-email/1/\u003ca title=\"otheraddress@test.com\" href=\"mailto:otheraddress@test.com\" rel=\"nofollow noopener noreferrer\"\u003eotheraddress@test.com\u003c/a\u003e/85264\u003c/li\u003e\n\u003cli\u003eNow the first verification link is not valid anymore.\u003c/li\u003e\n\u003cli\u003eUser changes email address back to \u003ca title=\"test@test.com\" href=\"mailto:test@test.com\" rel=\"nofollow noopener noreferrer\"\u003etest@test.com\u003c/a\u003e. He now receives the exact same link as before: verify-email/1/\u003ca title=\"test@test.com\" href=\"mailto:test@test.com\" rel=\"nofollow noopener noreferrer\"\u003etest@test.com\u003c/a\u003e/12345.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-12T09:33:04.755Z","allow_singular_disclosure_after":-180391192.8286672,"singular_disclosure_allowed":true,"vote_count":1,"voters":["spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":353307,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. While improvements could certainly be made to this hash, we're comfortable with the level of security vs complexity of generation provided in this particular instance.","markdown_message":"\u003cp\u003eThanks for the report. While improvements could certainly be made to this hash, we\u0026#39;re comfortable with the level of security vs complexity of generation provided in this particular instance.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-13T07:52:04.854Z","updated_at":"2015-03-13T07:52:04.854Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":353365,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-13T09:33:04.472Z","updated_at":"2015-03-13T09:33:04.472Z","first_to_agree":true,"actor":{"username":"jackds","cleared":true,"url":"/jackds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/975/99b380468b2f9d3b8f03ecf5c652585a082c2ec5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353502,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-13T11:08:44.979Z","updated_at":"2015-03-13T11:08:44.979Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":353503,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-13T11:08:45.332Z","updated_at":"2015-03-13T11:08:45.332Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}