{"id":232150,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzIxNTA=","url":"https://hackerone.com/reports/232150","title":"heap-buffer-overflow (READ of size 11) in Perl 5.25.x","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-26T06:38:31.405Z","submitted_at":"2017-05-26T06:38:31.405Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30,"url":"https://hackerone.com/ibb-perl","handle":"ibb-perl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Perl (IBB)","twitter_handle":"","website":"http://www.perl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-28T19:23:48.944Z","bug_reporter_agreed_on_going_public_at":"2017-05-26T22:47:42.375Z","team_member_agreed_on_going_public_at":"2017-05-28T19:23:48.876Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This issue was first reported to the Perl security mailing list on 19 August 2016. It was inadvertently made public in another bug report on 23 August 2016. It was finally marked fixed around 23 January 2017. \n\n[Original bug report](https://rt.perl.org/Ticket/Display.html?id=128998):\n\n```\nperl -e 'v300\u0026O|0' triggers a heap-buffer-overflow in Perl_my_atof2 (numeric.c:1349). This was found with AFL, ASAN and libdislocator.so and affects v5.25.4 (v5.25.3-305-g8c6b0c7). Perl 5.20.2 returns errors, doesn't crash.\n\n==23567==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000e1ba at pc 0x0000004abd02 bp 0x7ffced70a210 sp 0x7ffced7099d0\nREAD of size 11 at 0x60200000e1ba thread T0\n    #0 0x4abd01 in __interceptor_strlen (/root/perl/perl+0x4abd01)\n    #1 0xc2edf7 in Perl_my_atof2 /root/perl/numeric.c:1349:28\n    #2 0xc2e7a5 in Perl_my_atof /root/perl/numeric.c:1244:13\n    #3 0x99bbfc in S_sv_setnv /root/perl/sv.c:2113:9\n    #4 0x8fd5fe in S_sv_2iuv_common /root/perl/sv.c:2298:13\n    #5 0x900fd5 in Perl_sv_2uv_flags /root/perl/sv.c:2574:6\n    #6 0x9c7738 in Perl_pp_bit_or /root/perl/pp.c:2463:35\n    #7 0x7f1d93 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #8 0x5a11d6 in S_run_body /root/perl/perl.c:2524:2\n    #9 0x5a11d6 in perl_run /root/perl/perl.c:2447\n    #10 0x4de85d in main /root/perl/perlmain.c:123:9\n    #11 0x7ff026dedb44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #12 0x4de4cc in _start (/root/perl/perl+0x4de4cc)\n\n0x60200000e1ba is located 0 bytes to the right of 10-byte region [0x60200000e1b0,0x60200000e1ba)\nallocated by thread T0 here:\n    #0 0x4c0e4b in malloc (/root/perl/perl+0x4c0e4b)\n    #1 0x7f5bd7 in Perl_safesysmalloc /root/perl/util.c:153:21\n```\n\nReason for the bug:\n\n```\nThe UTF-8 string path of bit-and in do_vop() doesn't NUL terminate the resulting string. The bit-or op then attempts to or the result of that and a number, so attempts to convert that result into a number and strlen() attempts to access the undefined bytes following the result of the bit-and. \n```\n\n[First mention of it being a security issue](https://rt.perl.org/Ticket/Attachment/1418970/767269/) - 19 August 2016\n\n[... proper to treat this as a security issue.](https://rt.perl.org/Ticket/Attachment/1418980/767280/) - 23 August 2016\n\nIt was eventually decided that this didn't warrant a release or CVE assignment and that the fix would just be [committed](https://perl5.git.perl.org/perl.git/commit/b43665fffa48dd179eba1b5616d4ca35b4def876) and a perldelta entry created. \n\n","vulnerability_information_html":"\u003cp\u003eThis issue was first reported to the Perl security mailing list on 19 August 2016. It was inadvertently made public in another bug report on 23 August 2016. It was finally marked fixed around 23 January 2017. \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FDisplay.html%3Fid%3D128998\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eOriginal bug report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eperl -e \u0026#39;v300\u0026amp;O|0\u0026#39; triggers a heap-buffer-overflow in Perl_my_atof2 (numeric.c:1349). This was found with AFL, ASAN and libdislocator.so and affects v5.25.4 (v5.25.3-305-g8c6b0c7). Perl 5.20.2 returns errors, doesn\u0026#39;t crash.\n\n==23567==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000e1ba at pc 0x0000004abd02 bp 0x7ffced70a210 sp 0x7ffced7099d0\nREAD of size 11 at 0x60200000e1ba thread T0\n    #0 0x4abd01 in __interceptor_strlen (/root/perl/perl+0x4abd01)\n    #1 0xc2edf7 in Perl_my_atof2 /root/perl/numeric.c:1349:28\n    #2 0xc2e7a5 in Perl_my_atof /root/perl/numeric.c:1244:13\n    #3 0x99bbfc in S_sv_setnv /root/perl/sv.c:2113:9\n    #4 0x8fd5fe in S_sv_2iuv_common /root/perl/sv.c:2298:13\n    #5 0x900fd5 in Perl_sv_2uv_flags /root/perl/sv.c:2574:6\n    #6 0x9c7738 in Perl_pp_bit_or /root/perl/pp.c:2463:35\n    #7 0x7f1d93 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #8 0x5a11d6 in S_run_body /root/perl/perl.c:2524:2\n    #9 0x5a11d6 in perl_run /root/perl/perl.c:2447\n    #10 0x4de85d in main /root/perl/perlmain.c:123:9\n    #11 0x7ff026dedb44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #12 0x4de4cc in _start (/root/perl/perl+0x4de4cc)\n\n0x60200000e1ba is located 0 bytes to the right of 10-byte region [0x60200000e1b0,0x60200000e1ba)\nallocated by thread T0 here:\n    #0 0x4c0e4b in malloc (/root/perl/perl+0x4c0e4b)\n    #1 0x7f5bd7 in Perl_safesysmalloc /root/perl/util.c:153:21\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReason for the bug:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThe UTF-8 string path of bit-and in do_vop() doesn\u0026#39;t NUL terminate the resulting string. The bit-or op then attempts to or the result of that and a number, so attempts to convert that result into a number and strlen() attempts to access the undefined bytes following the result of the bit-and. \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FAttachment%2F1418970%2F767269%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFirst mention of it being a security issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - 19 August 2016\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FAttachment%2F1418980%2F767280%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e... proper to treat this as a security issue.\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - 23 August 2016\u003c/p\u003e\n\n\u003cp\u003eIt was eventually decided that this didn\u0026#39;t warrant a release or CVE assignment and that the fix would just be \u003ca href=\"/redirect?url=https%3A%2F%2Fperl5.git.perl.org%2Fperl.git%2Fcommit%2Fb43665fffa48dd179eba1b5616d4ca35b4def876\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecommitted\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and a perldelta entry created. \u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-25T22:47:42.405Z","allow_singular_disclosure_after":-110787481.53662957,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","geeknik","sumit7","spetr0x","mrr3boot"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1703829,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T16:32:04.872Z","updated_at":"2017-05-26T16:32:04.872Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":45156,"new_severity_id":45237},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1703830,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T16:32:10.893Z","updated_at":"2017-05-26T16:32:10.893Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1703831,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T16:32:16.997Z","updated_at":"2017-05-26T16:32:16.997Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-perl","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1703832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What an epic saga for this bug!","markdown_message":"\u003cp\u003eWhat an epic saga for this bug!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-26T16:32:40.098Z","updated_at":"2017-05-26T16:32:40.098Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704514,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T22:47:42.389Z","updated_at":"2017-05-26T22:47:42.389Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1706386,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-28T19:23:48.898Z","updated_at":"2017-05-28T19:23:48.898Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1706387,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-28T19:23:48.966Z","updated_at":"2017-05-28T19:23:48.966Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}