{"id":79185,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTE4NQ==","url":"https://hackerone.com/reports/79185","title":"Content spoofing through Referel header","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-28T07:45:34.191Z","submitted_at":"2015-07-28T07:45:34.191Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pradeepch99","url":"/pradeepch99","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/143/8767dbcf03d42c1a2ddd4c58c6adea18bdc8c6a8_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2738,"url":"https://hackerone.com/flox","handle":"flox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flox","twitter_handle":"","website":"https://example.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-29T03:15:17.821Z","bug_reporter_agreed_on_going_public_at":"2015-07-30T03:15:04.479Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found content spoofing/ text injection through referel header\r\n\r\nSteps to reproduce:\r\nwhenever you came to this page \r\nhttps://flox.io/404/\r\nYou'll see an error message like\r\n\r\n404: Baaah!\r\nNothing existed there, so now you’re here.\r\nYou appear to be a traveller from a distant land.\r\n\r\nFrom googling I found a link leads to https://flox.io/404/ \r\nand the link is http://files.flox.io/avrisk/about\r\n\r\nTo exploit this I create a html file \r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform method=\"GET\" action=\"http://files.flox.io/avrisk/about\"\u003e\r\n\t\u003cinput type=\"submit\" name=\"submit\" value=\"submit\"\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\nNote: use IE to work with this.\r\n\r\nI hosted this locally at http://localhost/a.php \r\nBut I've added some text as referer header like below\r\n\r\nhttp://localhost/a.php?You're browsing privatelyFirefox won't remember any history for this window.That includes browsing history, search history, download history, web form history, cookies, and temporary internet files. However, files you download and bookmarks you make will be kept.While this computer won't have a record of your browsing history, your employer or internet service provider can still track the pages you visit.Learn More.\r\n\r\nNow the page https://flox.io/404/ shows\r\n\r\n404: Baaah!\r\nNothing existed there, so now you’re here.\r\nWe think you may have came from: http://localhost/a.php?You'rebrowsingprivatelyFirefoxwon'trememberanyhistoryforthiswindow.Thatincludesbrowsinghistory,searchhistory,downloadhistory,webformhistory,cookies,andtemporaryinternetfiles.However,filesyoudownloadandbookmarksyoumakewillbekept.Whilethiscomputerwon'thavearecordofyourbrowsinghistory,youremployerorinternetserviceprovidercanstilltrackthepagesyouvisit.LearnMore.\r\n\r\nHere the problem is the referer header is stored on the server side.\r\nWhoever came to this https://flox.io/404/ page will get the same result.\r\nAnd it stays only for few minutes.\r\nEven though the attacker can make use of this and can insert some fake content to lead users to his site.\r\n\r\nsuppose he can put his public url in the error and can also put some message to go to that site\r\n","vulnerability_information_html":"\u003cp\u003eI found content spoofing/ text injection through referel header\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003cbr\u003e\nwhenever you came to this page \u003cbr\u003e\n\u003ca title=\"https://flox.io/404/\" href=\"/redirect?url=https%3A%2F%2Fflox.io%2F404%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://flox.io/404/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nYou\u0026#39;ll see an error message like\u003c/p\u003e\n\n\u003cp\u003e404: Baaah!\u003cbr\u003e\nNothing existed there, so now you’re here.\u003cbr\u003e\nYou appear to be a traveller from a distant land.\u003c/p\u003e\n\n\u003cp\u003eFrom googling I found a link leads to \u003ca title=\"https://flox.io/404/\" href=\"/redirect?url=https%3A%2F%2Fflox.io%2F404%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://flox.io/404/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nand the link is \u003ca title=\"http://files.flox.io/avrisk/about\" href=\"/redirect?url=http%3A%2F%2Ffiles.flox.io%2Favrisk%2Fabout\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://files.flox.io/avrisk/about\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTo exploit this I create a html file \u003cbr\u003e\n\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form method=\u0026quot;GET\u0026quot; action=\u0026quot;http://files.flox.io/avrisk/about\u0026quot;\u0026gt;\u003cbr\u003e\n    \u0026lt;input type=\u0026quot;submit\u0026quot; name=\u0026quot;submit\u0026quot; value=\u0026quot;submit\u0026quot;\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003cbr\u003e\nNote: use IE to work with this.\u003c/p\u003e\n\n\u003cp\u003eI hosted this locally at \u003ca title=\"http://localhost/a.php\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fa.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/a.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nBut I\u0026#39;ve added some text as referer header like below\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://localhost/a.php?You\u0026#39;re\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fa.php%3FYou%27re\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/a.php?You\u0026#39;re\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e browsing privatelyFirefox won\u0026#39;t remember any history for this window.That includes browsing history, search history, download history, web form history, cookies, and temporary internet files. However, files you download and bookmarks you make will be kept.While this computer won\u0026#39;t have a record of your browsing history, your employer or internet service provider can still track the pages you visit.Learn More.\u003c/p\u003e\n\n\u003cp\u003eNow the page \u003ca title=\"https://flox.io/404/\" href=\"/redirect?url=https%3A%2F%2Fflox.io%2F404%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://flox.io/404/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e shows\u003c/p\u003e\n\n\u003cp\u003e404: Baaah!\u003cbr\u003e\nNothing existed there, so now you’re here.\u003cbr\u003e\nWe think you may have came from: \u003ca title=\"http://localhost/a.php?You\u0026#39;rebrowsingprivatelyFirefoxwon\u0026#39;trememberanyhistoryforthiswindow.Thatincludesbrowsinghistory,searchhistory,downloadhistory,webformhistory,cookies,andtemporaryinternetfiles.However,filesyoudownloadandbookmarksyoumakewillbekept.Whilethiscomputerwon\u0026#39;thavearecordofyourbrowsinghistory,youremployerorinternetserviceprovidercanstilltrackthepagesyouvisit.LearnMore\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fa.php%3FYou%27rebrowsingprivatelyFirefoxwon%27trememberanyhistoryforthiswindow.Thatincludesbrowsinghistory%2Csearchhistory%2Cdownloadhistory%2Cwebformhistory%2Ccookies%2Candtemporaryinternetfiles.However%2Cfilesyoudownloadandbookmarksyoumakewillbekept.Whilethiscomputerwon%27thavearecordofyourbrowsinghistory%2Cyouremployerorinternetserviceprovidercanstilltrackthepagesyouvisit.LearnMore\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/a.php?You\u0026#39;rebrowsingprivatelyFirefoxwon\u0026#39;trememberanyhistoryforthiswindow.Thatincludesbrowsinghistory,searchhistory,downloadhistory,webformhistory,cookies,andtemporaryinternetfiles.However,filesyoudownloadandbookmarksyoumakewillbekept.Whilethiscomputerwon\u0026#39;thavearecordofyourbrowsinghistory,youremployerorinternetserviceprovidercanstilltrackthepagesyouvisit.LearnMore\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eHere the problem is the referer header is stored on the server side.\u003cbr\u003e\nWhoever came to this \u003ca title=\"https://flox.io/404/\" href=\"/redirect?url=https%3A%2F%2Fflox.io%2F404%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://flox.io/404/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e page will get the same result.\u003cbr\u003e\nAnd it stays only for few minutes.\u003cbr\u003e\nEven though the attacker can make use of this and can insert some fake content to lead users to his site.\u003c/p\u003e\n\n\u003cp\u003esuppose he can put his public url in the error and can also put some message to go to that site\u003c/p\u003e\n","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":47502,"file_name":"flox.io.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/047/502/e1603f6d80ddc4a2ca7151f2ebc8adf5524328c2/flox.io.JPG?response-content-disposition=attachment%3B%20filename%3D%22flox.io.JPG%22%3B%20filename%2A%3DUTF-8%27%27flox.io.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065352Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=f248403a1a214a4320b3c1e456d6a4230f329d242a3c7a3532b15bdedd996d06","file_size":79321,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2015-08-29T03:15:04.570Z","allow_singular_disclosure_after":-168406727.9463626,"singular_disclosure_allowed":true,"vote_count":1,"voters":["muhaddix"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":530718,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good catch. Thanks.","markdown_message":"\u003cp\u003eGood catch. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-30T03:04:43.813Z","updated_at":"2015-07-30T03:04:43.813Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pradeepch99","url":"/pradeepch99"},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":530719,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-30T03:04:49.455Z","updated_at":"2015-07-30T03:04:49.455Z","actor":{"url":"/flox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flox"}},"bounty_amount":"25.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"flox","collaborator":{"username":"pradeepch99","url":"/pradeepch99"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":530725,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-30T03:15:04.505Z","updated_at":"2015-07-30T03:15:04.505Z","first_to_agree":true,"actor":{"username":"pradeepch99","cleared":true,"url":"/pradeepch99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/143/8767dbcf03d42c1a2ddd4c58c6adea18bdc8c6a8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":567641,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-29T03:15:17.982Z","updated_at":"2015-08-29T03:15:17.982Z","actor":{"url":"/flox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flox"}},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}