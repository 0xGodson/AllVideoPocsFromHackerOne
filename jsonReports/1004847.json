{"id":1004847,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA0ODQ3","url":"https://hackerone.com/reports/1004847","title":"SSRF Possible through /wordpress/xmlrpc.php","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2020-10-10T21:40:46.199Z","submitted_at":"2020-10-10T21:40:46.247Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"azzassin","url":"/azzassin","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":162,"url":"https://hackerone.com/iandunn-projects","handle":"iandunn-projects","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ian Dunn","twitter_handle":"","website":"","about":"I'm a WordPress developer who maintains several small open source projects."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-12T15:24:54.410Z","bug_reporter_agreed_on_going_public_at":"2020-10-11T09:09:53.978Z","team_member_agreed_on_going_public_at":"2020-10-12T15:24:54.290Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, \n\nI have found a SSRF in iandunn.name through the xmlrpc.php API.\n\nI understood you've said about this endpoint in the past making up junk reports, but this is on a function which isn't disabled by disabling the endpoint, as I can prove with a Proof-Of-Concept.\n\nThere is a function using pingbacks which can be used when someone has linked your blog post, this makes a request to the website and scans for your post URL and adds it to a database on the site.\n\nIt is possible to [disable pingbacks](https://www.wpbeginner.com/wp-tutorials/how-to-disable-trackbacks-and-pings-on-existing-wordpress-posts/) and there is articles on [why you should.](https://www.securityweek.com/pingback-function-wordpress-vulnerable-malicious-use-serves-attack-tool)\n\nI have been using a [grabify link](https://grabify.link) to debug how this works, the Proof-Of-Concept calls for a link to be used where you can review the IPs which have interacted with it, although you could probably use a link on your own domain if you can access the logs, if you are going to use grabify then you will have to set up a redirect URL, I used `http://youtube.com`. You will be given a link like grabify.link/XXXXXX, this is required for the Proof-Of-Concept to function correctly, just click the copy button and move on to the next step.\n\nExecute the Proof-Of-Concept and input the URL you copied, you will then be asked for an amount of seconds to wait between each request, I personally would choose 5, since it's only proving it (There will be more time between each request because the server has to send the request, process and send it back before the code will continue).\n\nThe Proof-Of-Concept will print out any error codes the system sends back, there should be none. If there is a message, stop the code and make sure you have copied the URL and pasted it correctly, including the protocol and no slash at the end of the URL. (When the code says `Fault string returned: ` followed by a blank string, it means there is no error)\n\nAfter it has printed a few links, go the grabify tracking page in your browser, scroll down and see the logged IPs, you may need to refresh your browser and ensure you didn't enable the toggle to stop bots showing up.\n\nI have attacked a Proof-Of-Concept on how this can be abused and screenshots.\n\n## Impact\n\nAn attacker can use this to get some idea of the internal network infrastructure or use it in co-ordination with other WordPress web sites to conduct a DDoS on a target","vulnerability_information_html":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003eI have found a SSRF in iandunn.name through the xmlrpc.php API.\u003c/p\u003e\n\n\u003cp\u003eI understood you\u0026#39;ve said about this endpoint in the past making up junk reports, but this is on a function which isn\u0026#39;t disabled by disabling the endpoint, as I can prove with a Proof-Of-Concept.\u003c/p\u003e\n\n\u003cp\u003eThere is a function using pingbacks which can be used when someone has linked your blog post, this makes a request to the website and scans for your post URL and adds it to a database on the site.\u003c/p\u003e\n\n\u003cp\u003eIt is possible to \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.wpbeginner.com%2Fwp-tutorials%2Fhow-to-disable-trackbacks-and-pings-on-existing-wordpress-posts%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edisable pingbacks\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and there is articles on \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.securityweek.com%2Fpingback-function-wordpress-vulnerable-malicious-use-serves-attack-tool\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewhy you should.\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI have been using a \u003ca href=\"/redirect?url=https%3A%2F%2Fgrabify.link\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egrabify link\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to debug how this works, the Proof-Of-Concept calls for a link to be used where you can review the IPs which have interacted with it, although you could probably use a link on your own domain if you can access the logs, if you are going to use grabify then you will have to set up a redirect URL, I used \u003ccode\u003ehttp://youtube.com\u003c/code\u003e. You will be given a link like grabify.link/XXXXXX, this is required for the Proof-Of-Concept to function correctly, just click the copy button and move on to the next step.\u003c/p\u003e\n\n\u003cp\u003eExecute the Proof-Of-Concept and input the URL you copied, you will then be asked for an amount of seconds to wait between each request, I personally would choose 5, since it\u0026#39;s only proving it (There will be more time between each request because the server has to send the request, process and send it back before the code will continue).\u003c/p\u003e\n\n\u003cp\u003eThe Proof-Of-Concept will print out any error codes the system sends back, there should be none. If there is a message, stop the code and make sure you have copied the URL and pasted it correctly, including the protocol and no slash at the end of the URL. (When the code says \u003ccode\u003eFault string returned:\u003c/code\u003e followed by a blank string, it means there is no error)\u003c/p\u003e\n\n\u003cp\u003eAfter it has printed a few links, go the grabify tracking page in your browser, scroll down and see the logged IPs, you may need to refresh your browser and ensure you didn\u0026#39;t enable the toggle to stop bots showing up.\u003c/p\u003e\n\n\u003cp\u003eI have attacked a Proof-Of-Concept on how this can be abused and screenshots.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can use this to get some idea of the internal network infrastructure or use it in co-ordination with other WordPress web sites to conduct a DDoS on a target\u003c/p\u003e\n","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1030809,"file_name":"iandunn.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/DpuAwysPx1fH7xHkcJ72Nn3d?response-content-disposition=attachment%3B%20filename%3D%22iandunn.py%22%3B%20filename%2A%3DUTF-8%27%27iandunn.py\u0026response-content-type=text%2Fx-python3\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=d779f10f245ed6a86d6d3b35b74056e129b0a6e316dcb4d4311d4f8a4020a442","file_size":1299,"type":"text/x-python3"},{"id":1030810,"file_name":"Grabify_Proof_Of_Concept.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Q6qfB9YXiq6SMDAoV9YhEmZ8?response-content-disposition=attachment%3B%20filename%3D%22Grabify_Proof_Of_Concept.PNG%22%3B%20filename%2A%3DUTF-8%27%27Grabify_Proof_Of_Concept.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=7d4b922ad90bce55e4298143cd3d190607e89ca84fc866eb6b3c402026497523","file_size":132380,"type":"image/png"},{"id":1030811,"file_name":"Python_Proof_Of_Concept.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vtesgTkZkQobB2G1f41Q2PCy?response-content-disposition=attachment%3B%20filename%3D%22Python_Proof_Of_Concept.PNG%22%3B%20filename%2A%3DUTF-8%27%27Python_Proof_Of_Concept.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=fd521cd5c672266330dc62669e9da6c6f12990a00f8767169540f772aefa1d64","file_size":21982,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["exception"],"severity":{"rating":"none","score":0.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":2394,"asset_type":"URL","asset_identifier":"iandunn.name","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9484538,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"My Apologies, just read the other report stating this wasn't valid, closing now thank you for your time.","markdown_message":"\u003cp\u003eMy Apologies, just read the other report stating this wasn\u0026#39;t valid, closing now thank you for your time.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-11T09:07:13.424Z","updated_at":"2020-10-11T09:07:13.424Z","actor":{"username":"azzassin","cleared":false,"url":"/azzassin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9484545,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I have talked to friends about this and they are interested in seeing the Proof-Of-Concept and other features, may we disclose to help them and others?","markdown_message":"\u003cp\u003eI have talked to friends about this and they are interested in seeing the Proof-Of-Concept and other features, may we disclose to help them and others?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-11T09:09:53.997Z","updated_at":"2020-10-11T09:09:53.997Z","first_to_agree":true,"actor":{"username":"azzassin","cleared":false,"url":"/azzassin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9496078,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-12T15:24:54.324Z","updated_at":"2020-10-12T15:24:54.324Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9496079,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-12T15:24:54.438Z","updated_at":"2020-10-12T15:24:54.438Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}