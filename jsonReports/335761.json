{"id":335761,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzU3NjE=","url":"https://hackerone.com/reports/335761","title":"RCE By import channel field","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-11T09:30:54.580Z","submitted_at":"2018-04-11T09:30:54.580Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khaledibnalwalid","url":"/khaledibnalwalid","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/141/176/a2721de11b39898a87ac2566933292dcee91fd3f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":265,"url":"https://hackerone.com/expressionengine","handle":"expressionengine","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ExpressionEngine","twitter_handle":"eecms","website":"https://expressionengine.com/","about":"ExpressionEngine is a robust and flexible open-source Content Management System."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-20T15:17:39.270Z","bug_reporter_agreed_on_going_public_at":"2018-04-17T00:53:06.581Z","team_member_agreed_on_going_public_at":"2018-04-20T15:17:39.194Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":20,"voters":["bl4de","generaleg","co0nan","eveeez","apapedulimu","lordjerry0x01","fadel","zigoo0","exception","flex0geek","and 10 more..."],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2590611,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T14:52:54.864Z","updated_at":"2018-04-11T14:52:54.864Z","additional_data":{},"actor":{"username":"djones","cleared":false,"url":"/djones","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2592526,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T20:42:25.617Z","updated_at":"2018-04-11T20:42:25.617Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2592534,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T20:45:45.970Z","updated_at":"2018-04-11T20:45:45.970Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2592583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T21:07:55.152Z","updated_at":"2018-04-11T21:07:55.152Z","actor":{"username":"khaledibnalwalid","cleared":true,"url":"/khaledibnalwalid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/176/a2721de11b39898a87ac2566933292dcee91fd3f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2592639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T21:26:50.240Z","updated_at":"2018-04-11T21:26:50.240Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2592683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-11T21:38:26.645Z","updated_at":"2018-04-11T21:38:26.645Z","actor":{"username":"khaledibnalwalid","cleared":true,"url":"/khaledibnalwalid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/176/a2721de11b39898a87ac2566933292dcee91fd3f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2620464,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-16T19:16:45.068Z","updated_at":"2018-04-16T19:16:45.068Z","actor":{"username":"djones","cleared":false,"url":"/djones","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"khaledibnalwalid","url":"/khaledibnalwalid"},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2621465,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-17T00:53:06.612Z","updated_at":"2018-04-17T00:53:06.612Z","first_to_agree":true,"actor":{"username":"khaledibnalwalid","cleared":true,"url":"/khaledibnalwalid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/176/a2721de11b39898a87ac2566933292dcee91fd3f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2647292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T15:17:39.221Z","updated_at":"2018-04-20T15:17:39.221Z","actor":{"username":"djones","cleared":false,"url":"/djones","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2647293,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T15:17:39.294Z","updated_at":"2018-04-20T15:17:39.294Z","actor":{"username":"djones","cleared":false,"url":"/djones","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2650739,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-21T22:56:59.256Z","updated_at":"2018-04-21T22:56:59.256Z","actor":{"username":"khaledibnalwalid","cleared":true,"url":"/khaledibnalwalid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/176/a2721de11b39898a87ac2566933292dcee91fd3f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2682374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-30T20:20:06.936Z","updated_at":"2018-04-30T20:20:06.936Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7175,"category":"team","content":"The reporter determined that a malicious Channel Set could be used to allow an administrator to upload a PHP file that they might otherwise not have permission to upload. Combined with the temporary folder name algorithm being available in the source code, the malicious administrator could potentially guess its location, and if the site were running with a web-accessible system folder, could allow them to run arbitrary code.\n\nThe issue was resolved to prevent potential discovery of the temporary folder, and decreased the TTL of that folder to further prevent from any brute-force guessing of the folder name.\n\nIt should be noted that post-installation best-practices is to [move the system folder above web-root](https://docs.expressionengine.com/latest/installation/best_practices.html), which by itself would make such an attack impossible even for a CMS administrator.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe reporter determined that a malicious Channel Set could be used to allow an administrator to upload a PHP file that they might otherwise not have permission to upload. Combined with the temporary folder name algorithm being available in the source code, the malicious administrator could potentially guess its location, and if the site were running with a web-accessible system folder, could allow them to run arbitrary code.\u003c/p\u003e\n\n\u003cp\u003eThe issue was resolved to prevent potential discovery of the temporary folder, and decreased the TTL of that folder to further prevent from any brute-force guessing of the folder name.\u003c/p\u003e\n\n\u003cp\u003eIt should be noted that post-installation best-practices is to \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.expressionengine.com%2Flatest%2Finstallation%2Fbest_practices.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emove the system folder above web-root\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which by itself would make such an attack impossible even for a CMS administrator.\u003c/p\u003e\n"},{"id":7133,"category":"researcher","content":"i found RCE Because they just blocked .php at upload function so i bypassed it ^_^","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ei found RCE Because they just blocked .php at upload function so i bypassed it ^_^\u003c/p\u003e\n"}]}