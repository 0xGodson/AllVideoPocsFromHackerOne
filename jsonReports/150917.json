{"id":150917,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTA5MTc=","url":"https://hackerone.com/reports/150917","title":"prevent null bytes in email field","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2016-07-12T14:15:47.713Z","submitted_at":"2016-07-12T14:15:47.713Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thezawad","url":"/thezawad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-13T03:00:25.610Z","bug_reporter_agreed_on_going_public_at":"2016-07-13T03:00:25.518Z","team_member_agreed_on_going_public_at":"2016-07-12T15:24:38.576Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nZawad here.\n\n**Description**\nI recently visited gratipay.com and logged in.\nI found that invalid characters ( *eg. null bytes* ) were accepted in email field, which is obviously not an expected behavior.\n\n**Steps to Reproduce**\n1. Go to https://gratipay.com/~username/emails/\n2. Enter `yourname@domain.com\\0` or `you@abc.com%00` or `you@xyz.com$`\n3. Now ***Inspect Element*** the field and change field type to **`text`** from **`email`**\n4. Click on **Add email address**.\nYou'll see an error message ***Looks like you've found a bug! Sorry for the inconvenience, we'll get it fixed ASAP!***\nNow reload the page and you'll see the email listed.\n\nIt means server side validation of email is not okay.\nValidation should be improved.\n\nFor your reference, #3227 and #3991 are same kind of bug which were resolved.\n\n----------------\nZawad","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nZawad here.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003cbr\u003e\nI recently visited gratipay.com and logged in.\u003cbr\u003e\nI found that invalid characters ( \u003cem\u003eeg. null bytes\u003c/em\u003e ) were accepted in email field, which is obviously not an expected behavior.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to Reproduce\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://gratipay.com/~username/emails/\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2F~username%2Femails%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/~username/emails/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter \u003ccode\u003eyourname@domain.com\\0\u003c/code\u003e or \u003ccode\u003eyou@abc.com%00\u003c/code\u003e or \u003ccode\u003eyou@xyz.com$\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNow \u003cstrong\u003e\u003cem\u003eInspect Element\u003c/em\u003e\u003c/strong\u003e the field and change field type to \u003cstrong\u003e\u003ccode\u003etext\u003c/code\u003e\u003c/strong\u003e from \u003cstrong\u003e\u003ccode\u003eemail\u003c/code\u003e\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on \u003cstrong\u003eAdd email address\u003c/strong\u003e.\nYou\u0026#39;ll see an error message \u003cstrong\u003e\u003cem\u003eLooks like you\u0026#39;ve found a bug! Sorry for the inconvenience, we\u0026#39;ll get it fixed ASAP!\u003c/em\u003e\u003c/strong\u003e\nNow reload the page and you\u0026#39;ll see the email listed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIt means server side validation of email is not okay.\u003cbr\u003e\nValidation should be improved.\u003c/p\u003e\n\n\u003cp\u003eFor your reference, \u003ca href=\"/reports/3227\"\u003e#3227\u003c/a\u003e and \u003ca href=\"/reports/3991\"\u003e#3991\u003c/a\u003e are same kind of bug which were resolved.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eZawad\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["thezawad","0xelement","policy_versions","dyabla"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1065194,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-12T14:46:32.337Z","updated_at":"2016-07-12T14:46:32.337Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice!\nFast action\n\n------\nZawad","markdown_message":"\u003cp\u003eNice!\u003cbr\u003e\nFast action\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eZawad\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T14:56:45.275Z","updated_at":"2016-07-12T14:56:45.275Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065245,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"By design, we perform very minimal pre-validation of email addresses, because of the risk of false positives. We rely on actually sending email in order to fully validate an address. Here's where we discuss this in the code:\n\nhttps://github.com/gratipay/gratipay.com/blob/1973/www/~/%25username/emails/modify.json.spt#L21\n\nClosing as informative, pending a PoC demonstrating a real exploit.","markdown_message":"\u003cp\u003eBy design, we perform very minimal pre-validation of email addresses, because of the risk of false positives. We rely on actually sending email in order to fully validate an address. Here\u0026#39;s where we discuss this in the code:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/gratipay/gratipay.com/blob/1973/www/~/%25username/emails/modify.json.spt#L21\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fblob%2F1973%2Fwww%2F~%2F%2525username%2Femails%2Fmodify.json.spt%23L21\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/gratipay/gratipay.com/blob/1973/www/~/%25username/emails/modify.json.spt#L21\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eClosing as informative, pending a PoC demonstrating a real exploit.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T15:24:22.962Z","updated_at":"2016-07-12T15:24:22.962Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-12T15:24:38.606Z","updated_at":"2016-07-12T15:24:38.606Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065247,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-12T15:24:53.587Z","updated_at":"2016-07-12T15:24:53.587Z","additional_data":{"old_title":"Accepting Invalid characters in email field (eg. null bytes)","new_title":"prevent null bytes in email field"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have read some of your disclosed reports which shows you have fixed issues which has no impact.\nThat's why I thought this worth reporting the issue (also added reference to show this was a valid issue since others fixed it)\nMoreover it increases bounces of your email when wrong address is entered.\nHope you reconsider. ","markdown_message":"\u003cp\u003eI have read some of your disclosed reports which shows you have fixed issues which has no impact.\u003cbr\u003e\nThat\u0026#39;s why I thought this worth reporting the issue (also added reference to show this was a valid issue since others fixed it)\u003cbr\u003e\nMoreover it increases bounces of your email when wrong address is entered.\u003cbr\u003e\nHope you reconsider. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T15:32:42.683Z","updated_at":"2016-07-12T15:32:42.683Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065268,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our intention is to fix security issues with at least a theoretical impact. I don't see even a theoretical impact here.","markdown_message":"\u003cp\u003eOur intention is to fix security issues with at least a theoretical impact. I don\u0026#39;t see even a theoretical impact here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T15:34:35.476Z","updated_at":"2016-07-12T15:34:35.476Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have categorized it as Design Issue.\nMoreover it is of course theoritically proving that server side validation for email is not correct!\nI guess you haven't looked at #3991\nAnd when it comes to theory,  what was the theory for #81701? :D\n\nwhatever its all upon you to fix the bug.\n","markdown_message":"\u003cp\u003eI have categorized it as Design Issue.\u003cbr\u003e\nMoreover it is of course theoritically proving that server side validation for email is not correct!\u003cbr\u003e\nI guess you haven\u0026#39;t looked at \u003ca href=\"/reports/3991\"\u003e#3991\u003c/a\u003e\u003cbr\u003e\nAnd when it comes to theory,  what was the theory for \u003ca href=\"/reports/81701\"\u003e#81701\u003c/a\u003e? :D\u003c/p\u003e\n\n\u003cp\u003ewhatever its all upon you to fix the bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T15:42:35.554Z","updated_at":"2016-07-12T15:42:35.554Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"3991 says, \"We don't see any considerable security risks in this.\"\n\nThe theory on #81701 is that \"not quoting values before sending them over oauth does seem to be a bad idea,\" because of the risk of injection into the OAuth flow. I don't see the same risk of injection into email. If email servers haven't evolved to handle null bytes in email addresses by now, then that's not Gratipay's problem.","markdown_message":"\u003cp\u003e3991 says, \u0026quot;We don\u0026#39;t see any considerable security risks in this.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eThe theory on \u003ca href=\"/reports/81701\"\u003e#81701\u003c/a\u003e is that \u0026quot;not quoting values before sending them over oauth does seem to be a bad idea,\u0026quot; because of the risk of injection into the OAuth flow. I don\u0026#39;t see the same risk of injection into email. If email servers haven\u0026#39;t evolved to handle null bytes in email addresses by now, then that\u0026#39;s not Gratipay\u0026#39;s problem.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T15:59:06.512Z","updated_at":"2016-07-12T15:59:06.512Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well,\nIt seems like you're also not validating email for RFC Compliance.\n***Email address more than 256 characters are accepted in the email field.***\nAt least you should fix it.\n","markdown_message":"\u003cp\u003eWell,\u003cbr\u003e\nIt seems like you\u0026#39;re also not validating email for RFC Compliance.\u003cbr\u003e\n\u003cstrong\u003e\u003cem\u003eEmail address more than 256 characters are accepted in the email field.\u003c/em\u003e\u003c/strong\u003e\u003cbr\u003e\nAt least you should fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T16:16:36.984Z","updated_at":"2016-07-12T16:16:36.984Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e It seems like you're also not validating email for RFC Compliance.\n\nCorrect. We are not. As discussed, by design we are lax on validation before actually sending an email, since *actually sending an email* is really what we care about here.\n\nLimiting to 256 characters is already filed. File separately if you want to be added as a duplicate.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eIt seems like you\u0026#39;re also not validating email for RFC Compliance.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCorrect. We are not. As discussed, by design we are lax on validation before actually sending an email, since \u003cem\u003eactually sending an email\u003c/em\u003e is really what we care about here.\u003c/p\u003e\n\n\u003cp\u003eLimiting to 256 characters is already filed. File separately if you want to be added as a duplicate.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T16:26:07.385Z","updated_at":"2016-07-12T16:26:07.385Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1066218,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"it was a nice discussion however. ","markdown_message":"\u003cp\u003eit was a nice discussion however. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-13T03:00:25.548Z","updated_at":"2016-07-13T03:00:25.548Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1066219,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-13T03:00:25.641Z","updated_at":"2016-07-13T03:00:25.641Z","actor":{"username":"thezawad","cleared":false,"url":"/thezawad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/964/51075911afe8fc1bb954de1b8a93c8c8c8c97377_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340073,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-04T18:33:59.205Z","updated_at":"2016-12-04T18:33:59.205Z","additional_data":{"old_severity":null,"new_severity":"None","old_severity_id":null,"new_severity_id":11534},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}