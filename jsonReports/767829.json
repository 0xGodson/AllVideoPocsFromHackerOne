{"id":767829,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Njc4Mjk=","url":"https://hackerone.com/reports/767829","title":"Account take over of 'light' starbuckscardb2b users","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-01-03T19:32:55.361Z","submitted_at":"2020-01-03T19:32:55.361Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zude","url":"/zude","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-29T17:38:31.113Z","bug_reporter_agreed_on_going_public_at":"2020-01-19T04:42:39.310Z","team_member_agreed_on_going_public_at":"2020-01-29T17:38:31.037Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This issue was found on https://www.starbuckscardb2b.com, this website belongs to starbucks and its is a critical vulnerability so I am reporting this.\n\n```Issue:``` An attacker can takeover the account of the victim by creating a new account by using victim's (who is already registered) email address. \n\nSteps to reproduce are as follows:\n1. Open https://www.starbuckscardb2b.com and go to create account.\n2. for example user successfully created the account with ```abc@xyz.com``` and password ```12345678```\n3. Now attacker will create the account with the email used in step 2  ```abc@xyz.com``` with different password.\n4. After completion of step 3 the password for the  ```abc@xyz.com``` user will be set to the password used by attacker.\n5. This will result in the account take over by attacker.\n\n## Impact\n\nAn attacker can take over the control of any/all registered users.","vulnerability_information_html":"\u003cp\u003eThis issue was found on \u003ca title=\"https://www.starbuckscardb2b.com\" href=\"/redirect?url=https%3A%2F%2Fwww.starbuckscardb2b.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbuckscardb2b.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, this website belongs to starbucks and its is a critical vulnerability so I am reporting this.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eIssue:\u003c/code\u003e An attacker can takeover the account of the victim by creating a new account by using victim\u0026#39;s (who is already registered) email address. \u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce are as follows:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen \u003ca title=\"https://www.starbuckscardb2b.com\" href=\"/redirect?url=https%3A%2F%2Fwww.starbuckscardb2b.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbuckscardb2b.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and go to create account.\u003c/li\u003e\n\u003cli\u003efor example user successfully created the account with \u003ccode\u003eabc@xyz.com\u003c/code\u003e and password \u003ccode\u003e12345678\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNow attacker will create the account with the email used in step 2  \u003ccode\u003eabc@xyz.com\u003c/code\u003e with different password.\u003c/li\u003e\n\u003cli\u003eAfter completion of step 3 the password for the  \u003ccode\u003eabc@xyz.com\u003c/code\u003e user will be set to the password used by attacker.\u003c/li\u003e\n\u003cli\u003eThis will result in the account take over by attacker.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can take over the control of any/all registered users.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-18T04:42:39.348Z","allow_singular_disclosure_after":-27223569.727611497,"singular_disclosure_allowed":true,"vote_count":23,"voters":["sultancad","elmahdi","duckoverflow","sudi","mr_n30","detroitsmash","exception","zimmer75","okido1","zude","and 13 more..."],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":12995,"asset_type":"OTHER","asset_identifier":"Other assets","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6684710,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-04T00:08:46.346Z","updated_at":"2020-01-04T00:08:46.346Z","additional_data":{"old_severity":"Critical","new_severity":"Critical (9.8)","old_severity_id":599997,"new_severity_id":600083},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6684712,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-04T00:08:56.522Z","updated_at":"2020-01-04T00:08:56.522Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6684721,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi there, @zude - as you've probably noticed, this is outside of our scope for a monetary reward, but we accept the vulnerability exists on one of our services, and that it looks like you can change a user's password by simply going through the Create Account functionality. Thank you very much for reporting this to us - I will ensure that it is addressed by the team responsible for this component.","markdown_message":"\u003cp\u003eHi there, \u003ca href=\"/zude\"\u003e@zude\u003c/a\u003e - as you\u0026#39;ve probably noticed, this is outside of our scope for a monetary reward, but we accept the vulnerability exists on one of our services, and that it looks like you can change a user\u0026#39;s password by simply going through the Create Account functionality. Thank you very much for reporting this to us - I will ensure that it is addressed by the team responsible for this component.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-04T00:13:56.376Z","updated_at":"2020-01-04T00:13:56.376Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6733093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tealeaf any update on this?","markdown_message":"\u003cp\u003e\u003ca href=\"/tealeaf\"\u003e@tealeaf\u003c/a\u003e any update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-10T08:07:28.036Z","updated_at":"2020-01-10T08:07:28.036Z","actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6761452,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-13T23:55:41.553Z","updated_at":"2020-01-13T23:55:41.553Z","additional_data":{"old_severity":"Critical (9.8)","new_severity":"High (7.5)","old_severity_id":600083,"new_severity_id":607200},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6761457,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, @zude - updated information we have as of now is:\n* The development team is aware of this issue, and is working on possible fixes\n* The account takeover potential of this vulnerability is limited to \"light\" accounts - those that have not yet registered a credit card or ordered any rewards cards. Since the main point of the web site is to facilitate the ordering of rewards cards, any damage is limited to these few light accounts, only a few of which have address or phone number data.\n* Several of these accounts appear to be from people pen-testing the system, either through specific pen-tests, or the HackerOne program.\nI'm downgrading this to a High because of the small number of affected accounts, and the limited nature of their capabilities. The CVSS scoring doesn't seem to apply as \"High\" loss of Confidentiality or Integrity.","markdown_message":"\u003cp\u003eHi there, \u003ca href=\"/zude\"\u003e@zude\u003c/a\u003e - updated information we have as of now is:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe development team is aware of this issue, and is working on possible fixes\u003c/li\u003e\n\u003cli\u003eThe account takeover potential of this vulnerability is limited to \u0026quot;light\u0026quot; accounts - those that have not yet registered a credit card or ordered any rewards cards. Since the main point of the web site is to facilitate the ordering of rewards cards, any damage is limited to these few light accounts, only a few of which have address or phone number data.\u003c/li\u003e\n\u003cli\u003eSeveral of these accounts appear to be from people pen-testing the system, either through specific pen-tests, or the HackerOne program.\nI\u0026#39;m downgrading this to a High because of the small number of affected accounts, and the limited nature of their capabilities. The CVSS scoring doesn\u0026#39;t seem to apply as \u0026quot;High\u0026quot; loss of Confidentiality or Integrity.\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-01-13T23:56:44.615Z","updated_at":"2020-01-13T23:56:44.615Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6796036,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi again, @zude - the development team has addressed this issue by removing the ability to create \"light\" accounts entirely, which will prevent the ability to take over these accounts. Please feel free to retest this and make sure we haven't missed an ability to exercise this flaw. I'm closing this issue as resolved, but you should please reopen it if you find the fix is incomplete.\nWe look forward to receiving further issues from you as and when you find them in Starbucks web sites and applications.","markdown_message":"\u003cp\u003eHi again, \u003ca href=\"/zude\"\u003e@zude\u003c/a\u003e - the development team has addressed this issue by removing the ability to create \u0026quot;light\u0026quot; accounts entirely, which will prevent the ability to take over these accounts. Please feel free to retest this and make sure we haven\u0026#39;t missed an ability to exercise this flaw. I\u0026#39;m closing this issue as resolved, but you should please reopen it if you find the fix is incomplete.\u003cbr\u003e\nWe look forward to receiving further issues from you as and when you find them in Starbucks web sites and applications.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-17T02:10:31.403Z","updated_at":"2020-01-17T02:10:31.403Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zude","url":"/zude"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6809140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tealeaf this issue can be marked as fixed. ","markdown_message":"\u003cp\u003e\u003ca href=\"/tealeaf\"\u003e@tealeaf\u003c/a\u003e this issue can be marked as fixed. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-19T04:42:35.592Z","updated_at":"2020-01-19T04:42:35.592Z","actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6809141,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-19T04:42:39.326Z","updated_at":"2020-01-19T04:42:39.326Z","first_to_agree":true,"actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6811422,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-19T17:35:22.082Z","updated_at":"2020-01-19T17:35:22.082Z","additional_data":{"old_title":"Account take over of any user","new_title":"Account take over of any starbuckscardb2b user"},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6811423,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-19T17:35:39.209Z","updated_at":"2020-01-19T17:35:39.209Z","additional_data":{"old_title":"Account take over of any starbuckscardb2b user","new_title":"Account take over of 'light' starbuckscardb2b users"},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6901115,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-29T17:38:31.054Z","updated_at":"2020-01-29T17:38:31.054Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6901116,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-29T17:38:31.129Z","updated_at":"2020-01-29T17:38:31.129Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":19986,"category":"team","content":"zude discovered that 'light' accounts on https://www.starbuckscardb2b.com could be taken over by registering a new account with the same email address. 'Light' accounts were defined as those that had been created but not used to add a payment method or complete a checkout.\n\n@zude — thank you for reporting this vulnerability and confirming the resolution.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ezude discovered that \u0026#39;light\u0026#39; accounts on \u003ca title=\"https://www.starbuckscardb2b.com\" href=\"/redirect?url=https%3A%2F%2Fwww.starbuckscardb2b.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbuckscardb2b.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e could be taken over by registering a new account with the same email address. \u0026#39;Light\u0026#39; accounts were defined as those that had been created but not used to add a payment method or complete a checkout.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/zude\"\u003e@zude\u003c/a\u003e — thank you for reporting this vulnerability and confirming the resolution.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}