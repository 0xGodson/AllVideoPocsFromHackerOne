{"id":658089,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NTgwODk=","url":"https://hackerone.com/reports/658089","title":"Rate Limit too lenient for endpoint sending emails","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2019-07-24T13:40:32.847Z","submitted_at":"2019-07-24T13:40:32.847Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"harshita174","url":"/harshita174","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/taAXA1pvvWf9X51wZnPjuyDi/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-19T15:11:55.662Z","bug_reporter_agreed_on_going_public_at":"2020-08-19T14:25:58.691Z","team_member_agreed_on_going_public_at":"2020-08-19T15:11:55.550Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Rate-limiting is a process that is used to define the rate at which consumers can access APIs. Also, it determines the speed at which a consumer can access APIs. Rate limit is calculated in real time.\n\nHow to reproduce?\n\n1. Sign-up for the account for WakaTime.  Domain - www.wakatime.com\n2. After signing up login to the caviar account with login credentials\n3. Then,press forgot password and enter your email or temporary email address i.e https://temp-mail.org 4. Open burpsuite and intercept the request from browser ,if you get the intercepted request.\n5. Send the intercepted request to the intruder, In target section check the Host and Port section . In Positions section, clear all $signs and add $ sign to the anyone parameter In Payload section, add payload type to Numbers and set Numbers range.\n6. After all settings done press start attack, and the attack started till it reaches the Number range that we will set in the Payload sections.\n8. And you will get the mail regarding to the  password reset links to your mail box.\n\nHTTP Request-\n\nPOST /api/v1/users/reset_password HTTP/1.1\nHost: wakatime.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://wakatime.com/\nContent-Type: application/json\nX-CSRFToken: ad5d275dc3197936cc18040ae1882e89b04b6cf5b6d891d0dc337b38792f61b4\nX-Requested-With: XMLHttpRequest\nContent-Length: 34\nConnection: close\n\n## Impact\n\nThe user will get continuous email ragarding to password reset links till the attack stop.","vulnerability_information_html":"\u003cp\u003eRate-limiting is a process that is used to define the rate at which consumers can access APIs. Also, it determines the speed at which a consumer can access APIs. Rate limit is calculated in real time.\u003c/p\u003e\n\n\u003cp\u003eHow to reproduce?\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSign-up for the account for WakaTime.  Domain - \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.wakatime.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.wakatime.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAfter signing up login to the caviar account with login credentials\u003c/li\u003e\n\u003cli\u003eThen,press forgot password and enter your email or temporary email address i.e \u003ca title=\"https://temp-mail.org\" href=\"/redirect?url=https%3A%2F%2Ftemp-mail.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://temp-mail.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e 4. Open burpsuite and intercept the request from browser ,if you get the intercepted request.\u003c/li\u003e\n\u003cli\u003eSend the intercepted request to the intruder, In target section check the Host and Port section . In Positions section, clear all $signs and add $ sign to the anyone parameter In Payload section, add payload type to Numbers and set Numbers range.\u003c/li\u003e\n\u003cli\u003eAfter all settings done press start attack, and the attack started till it reaches the Number range that we will set in the Payload sections.\u003c/li\u003e\n\u003cli\u003eAnd you will get the mail regarding to the  password reset links to your mail box.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHTTP Request-\u003c/p\u003e\n\n\u003cp\u003ePOST /api/v1/users/reset_password HTTP/1.1\u003cbr\u003e\nHost: wakatime.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://wakatime.com/\" href=\"/redirect?url=https%3A%2F%2Fwakatime.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wakatime.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/json\u003cbr\u003e\nX-CSRFToken: ad5d275dc3197936cc18040ae1882e89b04b6cf5b6d891d0dc337b38792f61b4\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Length: 34\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe user will get continuous email ragarding to password reset links till the attack stop.\u003c/p\u003e\n","weakness":{"id":92,"name":"Weak Password Recovery Mechanism for Forgotten Password"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":537959,"file_name":"Screenshot_(173).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/537/959/eb172fa680d2ad7c952b894cf739e0d22270356f/Screenshot_%28173%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_%2528173%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_%2528173%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063419Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=d2154aa4e0d65f5b841173b0e63978726c085e0322fa0b7666857a132512f03f","file_size":304242,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-18T14:25:58.747Z","allow_singular_disclosure_after":-8784500.912259867,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sa1tama0","a13h1","harshita174"],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5418936,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We're already rate limiting that url, but we decreased the limit to once every 5 minutes now. Thanks for helping improve the security of WakaTime!","markdown_message":"\u003cp\u003eWe\u0026#39;re already rate limiting that url, but we decreased the limit to once every 5 minutes now. Thanks for helping improve the security of WakaTime!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-24T15:54:04.695Z","updated_at":"2019-07-24T15:54:04.695Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"harshita174","url":"/harshita174"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5418944,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-24T15:55:19.500Z","updated_at":"2019-07-24T15:55:19.500Z","additional_data":{"old_severity":"Medium","new_severity":"None (0.0)","old_severity_id":475055,"new_severity_id":475282},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8977763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will you please disclosed my report with valid submission","markdown_message":"\u003cp\u003eWill you please disclosed my report with valid submission\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-19T13:17:22.708Z","updated_at":"2020-08-19T13:17:22.708Z","actor":{"username":"harshita174","cleared":false,"url":"/harshita174","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/taAXA1pvvWf9X51wZnPjuyDi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8978600,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T14:25:58.716Z","updated_at":"2020-08-19T14:25:58.716Z","first_to_agree":true,"actor":{"username":"harshita174","cleared":false,"url":"/harshita174","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/taAXA1pvvWf9X51wZnPjuyDi/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8979177,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T15:11:47.834Z","updated_at":"2020-08-19T15:11:47.834Z","additional_data":{"old_title":"Rate Limit Vulnerability","new_title":"Rate Limit too lenient for endpoint sending emails"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8979180,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T15:11:55.570Z","updated_at":"2020-08-19T15:11:55.570Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8979181,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-19T15:11:55.684Z","updated_at":"2020-08-19T15:11:55.684Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}