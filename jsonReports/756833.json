{"id":756833,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTY4MzM=","url":"https://hackerone.com/reports/756833","title":"Public available Sensitive Information about drivers","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2019-12-12T09:36:06.215Z","submitted_at":"2019-12-12T09:36:06.215Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"krupnikas","url":"/krupnikas","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/BS4JWe517cCjDVNMiyKhcKKy/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-18T18:12:37.001Z","bug_reporter_agreed_on_going_public_at":"2019-12-18T18:12:36.946Z","team_member_agreed_on_going_public_at":"2019-12-18T17:58:40.191Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nAPI for client app Citimobil\nhttps://c-api.city-mobil.ru/\nVersion 4.33.0 (and others)\n\nTesting environment\n--\nDevice on any OS with internet connection\nAny software to send https requests\n\nSteps to reproduce\n--\nSend POST request to url \"https://c-api.city-mobil.ru/getdrivers\" with data:\n{\n        \"latitude\": LAT,\n        \"longitude\": LON,\n        \"limit\": 10,\n        \"method\": \"getdrivers\",\n        \"radius\": 5,\n        \"tariff_group\":  [ 4 ],\n        \"ver\": \"4.33.0\"\n}\n\nActual results\n--\nResponse will contain GEO and BUSINESS data about 10 drivers nearest to the requested point - their positions, color codes, directions and car types.  Iterating over different city locations you can get the whole information about company fleet.\n\nThe response will proceed without any authentication. So the sensitive real-time information about company fleet is public available. \n\nExpected results, security impact description and recommendations\n--\nThe authentication procedure for this data should be required \n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n**Request:**\n```\ncurl -X POST --data '{ \"latitude\": 55.7, \"limit\": 10, \"longitude\": 37.6, \"method\": \"getdrivers\", \"radius\": 5, \"tariff_group\": [4], \"ver\": \"4.33.0\" }' https://c-api.city-mobil.ru/getdrivers\n```\n**Response:**\n~~~\n{\"drivers\":[{\"id\":\"1c1f6779f893af6fe5bf4509af7366cd\",\"lt\":\"55.7025061\",\"ln\":\"37.5954334\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort_plus\"},{\"id\":\"1a13d0daad9b6a3fa2b3d04a5b6f8c2a\",\"lt\":\"55.7019682\",\"ln\":\"37.6054896\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"},{\"id\":\"c7c1634fae41a68924083af1d496d0a7\",\"lt\":\"55.7014223\",\"ln\":\"37.6067352\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort_plus\"},{\"id\":\"f15ce054ccdaa268b16a0904b9eecdae\",\"lt\":\"55.6956527\",\"ln\":\"37.5972063\",\"direction\":\"4\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"94ebc0fcc644bb1da4b57e7d23942e6d\",\"lt\":\"55.694786\",\"ln\":\"37.5982642\",\"direction\":\"4\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"7251c45ee945c9cb839d69d5902b9f17\",\"lt\":\"55.7009351\",\"ln\":\"37.6094206\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"},{\"id\":\"cb9dab2ba7379c3db817dd76ec68e6c5\",\"lt\":\"55.6950137\",\"ln\":\"37.6041883\",\"direction\":\"8\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"761891d9c1129b1678c3eba616249e2b\",\"lt\":\"55.6944542\",\"ln\":\"37.5951122\",\"direction\":\"2\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"4f0e835751cadaa5d5386f0e1374f315\",\"lt\":\"55.7066516\",\"ln\":\"37.6011767\",\"direction\":\"7\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"2eb330cad5e5d9c87e6d0600a9ff10e8\",\"lt\":\"55.7066801\",\"ln\":\"37.6009127\",\"direction\":\"8\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"}],\"nearest\":{\"duration\":420},\"service_status\":1}\n~~~\n\n## Impact\n\nGet sensitive real-time information about company fleet.","vulnerability_information_html":"\u003ch2 id=\"domain-site-application\"\u003eDomain, site, application\u003c/h2\u003e\n\n\u003cp\u003eAPI for client app Citimobil\u003cbr\u003e\n\u003ca title=\"https://c-api.city-mobil.ru/\" href=\"/redirect?url=https%3A%2F%2Fc-api.city-mobil.ru%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://c-api.city-mobil.ru/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVersion 4.33.0 (and others)\u003c/p\u003e\n\n\u003ch2 id=\"testing-environment\"\u003eTesting environment\u003c/h2\u003e\n\n\u003cp\u003eDevice on any OS with internet connection\u003cbr\u003e\nAny software to send https requests\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cp\u003eSend POST request to url \u0026quot;\u003ca title=\"https://c-api.city-mobil.ru/getdrivers\" href=\"/redirect?url=https%3A%2F%2Fc-api.city-mobil.ru%2Fgetdrivers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://c-api.city-mobil.ru/getdrivers\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; with data:\u003cbr\u003e\n{\u003cbr\u003e\n        \u0026quot;latitude\u0026quot;: LAT,\u003cbr\u003e\n        \u0026quot;longitude\u0026quot;: LON,\u003cbr\u003e\n        \u0026quot;limit\u0026quot;: 10,\u003cbr\u003e\n        \u0026quot;method\u0026quot;: \u0026quot;getdrivers\u0026quot;,\u003cbr\u003e\n        \u0026quot;radius\u0026quot;: 5,\u003cbr\u003e\n        \u0026quot;tariff_group\u0026quot;:  [ 4 ],\u003cbr\u003e\n        \u0026quot;ver\u0026quot;: \u0026quot;4.33.0\u0026quot;\u003cbr\u003e\n}\u003c/p\u003e\n\n\u003ch2 id=\"actual-results\"\u003eActual results\u003c/h2\u003e\n\n\u003cp\u003eResponse will contain GEO and BUSINESS data about 10 drivers nearest to the requested point - their positions, color codes, directions and car types.  Iterating over different city locations you can get the whole information about company fleet.\u003c/p\u003e\n\n\u003cp\u003eThe response will proceed without any authentication. So the sensitive real-time information about company fleet is public available. \u003c/p\u003e\n\n\u003ch2 id=\"expected-results-security-impact-description-and-recommendations\"\u003eExpected results, security impact description and recommendations\u003c/h2\u003e\n\n\u003cp\u003eThe authentication procedure for this data should be required \u003c/p\u003e\n\n\u003ch2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\"\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -X POST --data \u0026#39;{ \u0026quot;latitude\u0026quot;: 55.7, \u0026quot;limit\u0026quot;: 10, \u0026quot;longitude\u0026quot;: 37.6, \u0026quot;method\u0026quot;: \u0026quot;getdrivers\u0026quot;, \u0026quot;radius\u0026quot;: 5, \u0026quot;tariff_group\u0026quot;: [4], \u0026quot;ver\u0026quot;: \u0026quot;4.33.0\u0026quot; }\u0026#39; https://c-api.city-mobil.ru/getdrivers\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponse:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;drivers\u0026quot;:[{\u0026quot;id\u0026quot;:\u0026quot;1c1f6779f893af6fe5bf4509af7366cd\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7025061\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.5954334\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;comfort_plus\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;1a13d0daad9b6a3fa2b3d04a5b6f8c2a\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7019682\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6054896\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;comfort\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;c7c1634fae41a68924083af1d496d0a7\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7014223\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6067352\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;comfort_plus\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;f15ce054ccdaa268b16a0904b9eecdae\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.6956527\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.5972063\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;4\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;sedan\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;94ebc0fcc644bb1da4b57e7d23942e6d\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.694786\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.5982642\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;4\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;sedan\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;7251c45ee945c9cb839d69d5902b9f17\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7009351\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6094206\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;comfort\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;cb9dab2ba7379c3db817dd76ec68e6c5\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.6950137\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6041883\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;8\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;sedan\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;761891d9c1129b1678c3eba616249e2b\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.6944542\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.5951122\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;sedan\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;4f0e835751cadaa5d5386f0e1374f315\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7066516\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6011767\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;7\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;sedan\u0026quot;},{\u0026quot;id\u0026quot;:\u0026quot;2eb330cad5e5d9c87e6d0600a9ff10e8\u0026quot;,\u0026quot;lt\u0026quot;:\u0026quot;55.7066801\u0026quot;,\u0026quot;ln\u0026quot;:\u0026quot;37.6009127\u0026quot;,\u0026quot;direction\u0026quot;:\u0026quot;8\u0026quot;,\u0026quot;CarColorCode\u0026quot;:\u0026quot;000000\u0026quot;,\u0026quot;car_type\u0026quot;:\u0026quot;comfort\u0026quot;}],\u0026quot;nearest\u0026quot;:{\u0026quot;duration\u0026quot;:420},\u0026quot;service_status\u0026quot;:1}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eGet sensitive real-time information about company fleet.\u003c/p\u003e\n","weakness":{"id":101,"name":"Insecure Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["artebels","snork","0x08","infinity19","2701896"],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":40415,"asset_type":"OTHER","asset_identifier":"Citymobil","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6530490,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-12T09:51:43.651Z","updated_at":"2019-12-12T09:51:43.651Z","additional_data":{"old_severity":"Critical (9.3)","new_severity":"None (0.0)","old_severity_id":587235,"new_severity_id":587243},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6530511,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Thank you for your report to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\n\n(Un)fortunately, we can't confirm your report as a real security threat, this response does not contain any sensitive data. Displaying information about cars close to user is an application's feature and should not require any special permissions.","markdown_message":"\u003cp\u003eThank you for your report to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003c/p\u003e\n\n\u003cp\u003e(Un)fortunately, we can\u0026#39;t confirm your report as a real security threat, this response does not contain any sensitive data. Displaying information about cars close to user is an application\u0026#39;s feature and should not require any special permissions.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-12T09:54:57.653Z","updated_at":"2019-12-12T09:54:57.653Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6581587,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T17:58:40.214Z","updated_at":"2019-12-18T17:58:40.214Z","first_to_agree":true,"actor":{"username":"sergeybelove","cleared":false,"url":"/sergeybelove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6581719,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T18:12:36.970Z","updated_at":"2019-12-18T18:12:36.970Z","actor":{"username":"krupnikas","cleared":false,"url":"/krupnikas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BS4JWe517cCjDVNMiyKhcKKy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6581720,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T18:12:37.025Z","updated_at":"2019-12-18T18:12:37.025Z","actor":{"username":"krupnikas","cleared":false,"url":"/krupnikas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BS4JWe517cCjDVNMiyKhcKKy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}