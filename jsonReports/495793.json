{"id":495793,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTU3OTM=","url":"https://hackerone.com/reports/495793","title":"Malformed .MDL triggers an Access Violation on GoldSRC (hl.exe)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-02-14T01:34:41.616Z","submitted_at":"2019-02-14T01:34:41.616Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chippy","url":"/chippy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-09T00:01:06.274Z","bug_reporter_agreed_on_going_public_at":"2019-10-08T21:21:37.321Z","team_member_agreed_on_going_public_at":"2019-10-09T00:01:06.173Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A malformed player .MDL triggers an exploitable Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\n\n###Crash Information\nFAILURE_ID_HASH_STRING:  um:invalid_pointer_write_exploitable_c0000005_hw.dll!createinterface\nEvent Type: Exception\nException Faulting Address: 0x4c01000\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\nException Sub-Type: Write Access Violation\n\nFOLLOWUP_IP: \nhw!CreateInterface+282aa\n03a554ea d95efc          fstp    dword ptr [esi-4]\n\nPROBLEM_CLASSES: \n\n    ID:     [0n309]\n    Type:   [@ACCESS_VIOLATION]\n    Class:  Addendum\n    Scope:  BUCKET_ID\n    Name:   Omit\n    Data:   Omit\n    PID:    [Unspecified]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n282]\n    Type:   [INVALID_POINTER_WRITE]\n    Class:  Primary\n    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n            BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [Unspecified]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n156]\n    Type:   [ZEROED_STACK]\n    Class:  Addendum\n    Scope:  BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [0x300]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n115]\n    Type:   [EXPLOITABLE]\n    Class:  Addendum\n    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n            BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [0x300]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\nBUGCHECK_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE_ZEROED_STACK_EXPLOITABLE\n\n###Steps for Reproducing the Crash\nPlace the attached .MDL in the games \"Gman\" multiplayer model folder (Steam\\steamapps\\common\\Half-Life\\valve\\models\\player\\gman) Load the attached .MDL by setting the player character to \"Gman\" from the games multiplayer menu. Then, start a local game by typing \"map crossfire\" in console. Finally, execute the command \"thirdperson\" in console. The game will crash.\n\n## Impact\n\nAn attacker hosting a malicious server could compromise a remote client by having them download a custom model, triggering remote code execution on the victim's computer.","vulnerability_information_html":"\u003cp\u003eA malformed player .MDL triggers an exploitable Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\u003c/p\u003e\n\n\u003ch3 id=\"crash-information\"\u003eCrash Information\u003c/h3\u003e\n\n\u003cp\u003eFAILURE_ID_HASH_STRING:  um:invalid_pointer_write_exploitable_c0000005_hw.dll!createinterface\u003cbr\u003e\nEvent Type: Exception\u003cbr\u003e\nException Faulting Address: 0x4c01000\u003cbr\u003e\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\u003cbr\u003e\nException Sub-Type: Write Access Violation\u003c/p\u003e\n\n\u003cp\u003eFOLLOWUP_IP: \u003cbr\u003e\nhw!CreateInterface+282aa\u003cbr\u003e\n03a554ea d95efc          fstp    dword ptr [esi-4]\u003c/p\u003e\n\n\u003cp\u003ePROBLEM_CLASSES: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eID:     [0n309]\nType:   [@ACCESS_VIOLATION]\nClass:  Addendum\nScope:  BUCKET_ID\nName:   Omit\nData:   Omit\nPID:    [Unspecified]\nTID:    [0x6e30]\nFrame:  [0] : hw!CreateInterface\n\nID:     [0n282]\nType:   [INVALID_POINTER_WRITE]\nClass:  Primary\nScope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n        BUCKET_ID\nName:   Add\nData:   Omit\nPID:    [Unspecified]\nTID:    [0x6e30]\nFrame:  [0] : hw!CreateInterface\n\nID:     [0n156]\nType:   [ZEROED_STACK]\nClass:  Addendum\nScope:  BUCKET_ID\nName:   Add\nData:   Omit\nPID:    [0x300]\nTID:    [0x6e30]\nFrame:  [0] : hw!CreateInterface\n\nID:     [0n115]\nType:   [EXPLOITABLE]\nClass:  Addendum\nScope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n        BUCKET_ID\nName:   Add\nData:   Omit\nPID:    [0x300]\nTID:    [0x6e30]\nFrame:  [0] : hw!CreateInterface\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBUGCHECK_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE_ZEROED_STACK_EXPLOITABLE\u003c/p\u003e\n\n\u003ch3 id=\"steps-for-reproducing-the-crash\"\u003eSteps for Reproducing the Crash\u003c/h3\u003e\n\n\u003cp\u003ePlace the attached .MDL in the games \u0026quot;Gman\u0026quot; multiplayer model folder (Steam\\steamapps\\common\\Half-Life\\valve\\models\\player\\gman) Load the attached .MDL by setting the player character to \u0026quot;Gman\u0026quot; from the games multiplayer menu. Then, start a local game by typing \u0026quot;map crossfire\u0026quot; in console. Finally, execute the command \u0026quot;thirdperson\u0026quot; in console. The game will crash.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker hosting a malicious server could compromise a remote client by having them download a custom model, triggering remote code execution on the victim\u0026#39;s computer.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":423561,"file_name":"gman.mdl","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/423/561/1a6bc2d187c4cf8011c26108a201017d743b3f67/gman.mdl?response-content-disposition=attachment%3B%20filename%3D%22gman.mdl%22%3B%20filename%2A%3DUTF-8%27%27gman.mdl\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQS4MXLS4F%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060810Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCdPyDr833HeXJwYpWjpt%2BE8j%2FssC2h5%2FlaE7mZngOMiQIhAIhVLq5AR6H%2BIAtKS0YClrr2gxSJzGl8%2FZmOeT68dbjNKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyLw4q7eiVATMCuJ5oqkQNRnoM2%2F7QfXwU%2Fz3OKzDhPBavarq1CsKnppYIDxpxowNYh40iJGbW36kruwk7Up1vRvNyltjF5q8qwhzaGeQZ%2BiAxZXfxuO%2B2Kcrl44J%2BblDlgfJxT%2FhANHqEJ52YkeCqL%2F8Jog8rViNOOl6oETOov%2FmlWe%2BSn52SY6oPYBRdYu%2BBKeiMV8Z7HXhpAE7juI1J25wS6dso8QH7RSAhNGIs8Y8svP20AF0GCUvT57CvEpTEKNmlMu6qBfLwB6pdnFPVBhYyN%2FfIE4%2FQa2wOG4EtJYFQfTQjLwttTt9CYHJbPWKgJsiqZWwvzgG5RucysYaY1Dvc5h%2B9x16jomi9UPmmxblIqy%2BUz9R8kd2FgetX%2B5J5YRu%2FIt1eM4Pmo0vWG1EERVUZkvMX57A4jS5kp%2F0ojOEF2BB5VpPswd3ts8BMSrW%2BwRyh9hJwmvOT24d%2FVDV1XlH12OfiqXYDHqfINlxhQS6ahBnjyeup6YaEdMK6oUB8ZRQCgIyT6ugHXy7R98squWf9jBVCuea8OVuecORCfgjCE76r%2FBTrqAVa%2BDcEKB0%2FoTap54OIKsextuoDcyV%2B5vaIZrhq52EXThW%2BXIbAp6mSkhzoWUgjsywl0H1o%2FDaG%2BNn3BBVN%2BRn45Quca4CUlobnDZ4s%2FQCgf9Z7bonFsVRNiD0YQAXIATjx%2FHm9NSP5TZgVxAil%2FiJbzMr5CzCPucZqQZHGinQXPFIlAHaN7P8LEs1k%2BYLHWhoCxufAjr4F07sxUlcZob%2BG%2FmA%2B1KCCNdIEo%2B%2BJY954m5YuWhqgrGS3SilW7Zv%2FcvslV9aFtJ6DgZI3AgcMDa3advxrZKKcSBi8tFdkDhjvGZZWiwX118rNoAQ%3D%3D\u0026X-Amz-Signature=f71f3cac24c87bd671b1456f03522a1261ea5f40da001ddca964d1d2e5292a54","file_size":1383184,"type":"application/octet-stream"}],"allow_singular_disclosure_at":null,"vote_count":88,"voters":["njbooher","byq","mvc","mashoud1122","chippy","sameerphad72","ahiezer","fe7ch","spraynozzle","brodie_codie","and 78 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":1289,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"hl.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4146668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chippy - Thanks for the report. This report is currently being reviewed and you will be updated when there is additional information to share. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chippy\"\u003e@chippy\u003c/a\u003e - Thanks for the report. This report is currently being reviewed and you will be updated when there is additional information to share. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T04:59:02.881Z","updated_at":"2019-02-14T04:59:02.881Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4510086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey everyone, just a little bump on this to see where things are. Hope all is well as always","markdown_message":"\u003cp\u003eHey everyone, just a little bump on this to see where things are. Hope all is well as always\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T18:22:27.998Z","updated_at":"2019-04-08T18:22:27.998Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5404282,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-23T21:06:55.789Z","updated_at":"2019-07-23T21:06:55.789Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":297085,"new_severity_id":472217},"actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5404296,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @chippy, sorry about the delay in getting to this issue. I've just validated that it is definitely a memory corruption that is occurring but I'm not convinced that it can be trivially turned into an RCE. Due to that and the fact that this requires some user involvement either to acquire or switch to the model, I think this would be better labeled as high severity. I should have a fix for it in the next beta update, I'll let you know when a build has it.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chippy\"\u003e@chippy\u003c/a\u003e, sorry about the delay in getting to this issue. I\u0026#39;ve just validated that it is definitely a memory corruption that is occurring but I\u0026#39;m not convinced that it can be trivially turned into an RCE. Due to that and the fact that this requires some user involvement either to acquire or switch to the model, I think this would be better labeled as high severity. I should have a fix for it in the next beta update, I\u0026#39;ll let you know when a build has it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-23T21:12:31.800Z","updated_at":"2019-07-23T21:12:31.800Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5407976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem at all! Glad to hear. Let me know if there's anything I can do to help. Have some interesting server-side reports coming up as well.","markdown_message":"\u003cp\u003eNo problem at all! Glad to hear. Let me know if there\u0026#39;s anything I can do to help. Have some interesting server-side reports coming up as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-24T00:37:33.763Z","updated_at":"2019-07-24T00:37:33.763Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5422791,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Chippy,\n\nThanks for this report. I'm assessing the bounty now based on the bounty schedule that was active when you submitted it.","markdown_message":"\u003cp\u003eHi Chippy,\u003c/p\u003e\n\n\u003cp\u003eThanks for this report. I\u0026#39;m assessing the bounty now based on the bounty schedule that was active when you submitted it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-25T01:47:57.421Z","updated_at":"2019-07-25T01:47:57.421Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Valve"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"chippy","url":"/chippy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5422849,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Much appreciated @valve . Would love to have this one publicly disclosed once the patch is live.","markdown_message":"\u003cp\u003eMuch appreciated \u003ca href=\"/valve\"\u003e@valve\u003c/a\u003e . Would love to have this one publicly disclosed once the patch is live.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-25T02:08:52.098Z","updated_at":"2019-07-25T02:08:52.098Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989302,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is now fixed in the public release. Thanks again @chippy!","markdown_message":"\u003cp\u003eThis is now fixed in the public release. Thanks again \u003ca href=\"/chippy\"\u003e@chippy\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-08T19:54:05.741Z","updated_at":"2019-10-08T19:54:05.741Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"chippy","url":"/chippy"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989926,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you @mikela , it was a lot of fun working together on the GoldSRC bounties. I'd like to publicly disclose this since there probably won't be too many more on the older titles.","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/mikela\"\u003e@mikela\u003c/a\u003e , it was a lot of fun working together on the GoldSRC bounties. I\u0026#39;d like to publicly disclose this since there probably won\u0026#39;t be too many more on the older titles.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-08T21:21:37.342Z","updated_at":"2019-10-08T21:21:37.342Z","first_to_agree":true,"actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5990599,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-09T00:01:06.202Z","updated_at":"2019-10-09T00:01:06.202Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5990600,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-09T00:01:06.303Z","updated_at":"2019-10-09T00:01:06.303Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}