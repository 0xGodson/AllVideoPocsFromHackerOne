{"id":135217,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzUyMTc=","url":"https://hackerone.com/reports/135217","title":"Reflected cross-site scripting (XSS) on api.tiles.mapbox.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-28T16:02:16.168Z","submitted_at":"2016-04-28T16:02:16.168Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dawgyg","url":"/dawgyg","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-01T22:41:25.261Z","bug_reporter_agreed_on_going_public_at":"2016-05-03T19:12:38.532Z","team_member_agreed_on_going_public_at":"2016-06-01T22:41:25.103Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is a reflective XSS vulnerability in the access_token param found in the page.html at api.tiles.mapbox.com\n\nA proof of concept link:\nhttp://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27%3E%3Cscript%3Ealert%28document.domain%29%3C/script%3E#11/39.9168/-75.1595","vulnerability_information_html":"\u003cp\u003eThere is a reflective XSS vulnerability in the access_token param found in the page.html at api.tiles.mapbox.com\u003c/p\u003e\n\n\u003cp\u003eA proof of concept link:\u003cbr\u003e\n\u003ca title=\"http://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27%3E%3Cscript%3Ealert%28document.domain%29%3C/script%3E#11/39.9168/-75.1595\" href=\"/redirect?url=http%3A%2F%2Fapi.tiles.mapbox.com%2Fv4%2Fctswebrequest.m4ga59jd%2Fpage.html%3Faccess_token%3Dpk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%2527%253E%253Cscript%253Ealert%2528document.domain%2529%253C%2Fscript%253E%2311%2F39.9168%2F-75.1595\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27%3E%3Cscript%3Ealert%28document.domain%29%3C/script%3E#11/39.9168/-75.1595\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":90073,"file_name":"mapbox.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/090/073/501da5486781163f45938730a507d06a96e6a823/mapbox.jpg?response-content-disposition=attachment%3B%20filename%3D%22mapbox.jpg%22%3B%20filename%2A%3DUTF-8%27%27mapbox.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042559Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=4fd5c7309c983c524c90f46b7d5a7e99067f41cdfe4a2644a39944371b51cf7c","file_size":97370,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-06-02T19:12:38.584Z","allow_singular_disclosure_after":-144321200.46331444,"singular_disclosure_allowed":true,"vote_count":22,"voters":["michiel","mashoud1122","spam404","youngsheldon","geeknik","apapedulimu","naategh","jens","fantam1","at3nder","and 12 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":932146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also this was tested on Fedora Core 20 Linux running Firefox 38.0.5","markdown_message":"\u003cp\u003eAlso this was tested on Fedora Core 20 Linux running Firefox 38.0.5\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T16:07:51.834Z","updated_at":"2016-04-28T16:07:51.834Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":932521,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@dawgyg - this is an awesome find! I can confirm this is an issue in Firefox only (Firefox 46.0 on Max OS X). I also tested on Internet Explorer, Chrome, Opera, and Safari and they are not affected by this issue.\n\nI have fixed the issue locally and am working on getting this patch deployed to our production servers as soon as possible.","markdown_message":"\u003cp\u003e\u003ca href=\"/dawgyg\"\u003e@dawgyg\u003c/a\u003e - this is an awesome find! I can confirm this is an issue in Firefox only (Firefox 46.0 on Max OS X). I also tested on Internet Explorer, Chrome, Opera, and Safari and they are not affected by this issue.\u003c/p\u003e\n\n\u003cp\u003eI have fixed the issue locally and am working on getting this patch deployed to our production servers as soon as possible.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T19:52:54.790Z","updated_at":"2016-04-28T19:52:54.790Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":932524,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-28T19:55:25.413Z","updated_at":"2016-04-28T19:55:25.413Z","additional_data":{"old_title":"Reflective XSS Vuln on api.tiles.mapbox.com","new_title":"Reflected cross-site scripting (XSS) on api.tiles.mapbox.com"},"actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":932781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good. If you need any additional information I am available. Thanks for the quick response time!","markdown_message":"\u003cp\u003eSounds good. If you need any additional information I am available. Thanks for the quick response time!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T23:22:20.834Z","updated_at":"2016-04-28T23:22:20.834Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":932790,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"http://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27\u003e\u003cimg%20src=a:alert(document.domain)%20onerror=eval(src)\u003e#11/39.9519/-75.0949\n\nThis link appears to work on chrome on the galaxy s7 ","markdown_message":"\u003cp\u003e\u003ca title=\"http://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27%3E\" href=\"/redirect?url=http%3A%2F%2Fapi.tiles.mapbox.com%2Fv4%2Fctswebrequest.m4ga59jd%2Fpage.html%3Faccess_token%3Dpk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%2527%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://api.tiles.mapbox.com/v4/ctswebrequest.m4ga59jd/page.html?access_token=pk.eyJ1IjoiY3Rzd2VicmVxdWVzdCIsImEiOiJTb19VUHM0In0.muGg6tMDG4NOGrV4qQQ8yw.htaccess.aspx%27%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;img%20src=a:alert(document.domain)%20onerror=eval(src)\u0026gt;#11/39.9519/-75.0949\u003c/p\u003e\n\n\u003cp\u003eThis link appears to work on chrome on the galaxy s7 \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-28T23:36:46.505Z","updated_at":"2016-04-28T23:36:46.505Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":934283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dawgyg - we just deployed a fix to our servers. Can you verify the issue has been resolved?","markdown_message":"\u003cp\u003e\u003ca href=\"/dawgyg\"\u003e@dawgyg\u003c/a\u003e - we just deployed a fix to our servers. Can you verify the issue has been resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-29T21:40:07.959Z","updated_at":"2016-04-29T21:40:07.959Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":934624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes this now appears fixed. I can no longer reproduce the issue.","markdown_message":"\u003cp\u003eYes this now appears fixed. I can no longer reproduce the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-30T09:03:01.159Z","updated_at":"2016-04-30T09:03:01.159Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":935680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this publically now that the problem has been fixed?","markdown_message":"\u003cp\u003eCan we disclose this publically now that the problem has been fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T01:31:42.714Z","updated_at":"2016-05-02T01:31:42.714Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":936661,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-02T15:39:04.040Z","updated_at":"2016-05-02T15:39:04.040Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dawgyg","url":"/dawgyg"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":936669,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will this be eligible for a bounty?\n","markdown_message":"\u003cp\u003eWill this be eligible for a bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T15:43:35.405Z","updated_at":"2016-05-02T15:43:35.405Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":936716,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-02T16:03:18.966Z","updated_at":"2016-05-02T16:03:18.966Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mapbox"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"dawgyg","url":"/dawgyg"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":936738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T16:11:49.422Z","updated_at":"2016-05-02T16:11:49.422Z","actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":939004,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-03T19:12:38.550Z","updated_at":"2016-05-03T19:12:38.550Z","first_to_agree":true,"actor":{"username":"dawgyg","cleared":true,"url":"/dawgyg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fgKmNbShhf2dnUaProYWtamt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995828,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T22:41:25.188Z","updated_at":"2016-06-01T22:41:25.188Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":995829,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-01T22:41:25.300Z","updated_at":"2016-06-01T22:41:25.300Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2019,"category":"team","content":"On April 28th, 2016 @dawgyg reported a reflected cross-site scripting issue in the map embed page of our v4 map API that affected Firefox users only. An attacker could manipulate the `access_token` query string parameter on `api.mapbox.com` or `api.tiles.mapbox.com` to inject arbitrary JavaScript that would then execute in the context of the page. \n\nThe attack exploited an interpolated [underscore template](http://underscorejs.org/#template) (`\u003c%=`) that did not HTML-escape the value. In addition, Firefox does not `encodeURIComponent()` the single quote character (`%27` or `'`) in the address bar. Both of these factors allowed an attacker to add a single quote character to break out of several `meta` HTML elements on our map embed page and add arbitrary `script` elements for Firefox users.\n\nTo resolve this issue we switched to HTML-escaped underscore templates (`\u003c%-`). We deployed the fix to our servers and resolved the issue on April 29th, 2016.\n\nThis report only affected infrastructure running on `api.mapbox.com` and `api.tiles.mapbox.com` - it did not affect any of Mapbox's open source libraries such as mapbox.js or Mapbox GL JS. In addition, this issue also only affected Firefox users - Chrome, Safari, and Internet Explorer users were not affected.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eOn April 28th, 2016 \u003ca href=\"/dawgyg\"\u003e@dawgyg\u003c/a\u003e reported a reflected cross-site scripting issue in the map embed page of our v4 map API that affected Firefox users only. An attacker could manipulate the \u003ccode\u003eaccess_token\u003c/code\u003e query string parameter on \u003ccode\u003eapi.mapbox.com\u003c/code\u003e or \u003ccode\u003eapi.tiles.mapbox.com\u003c/code\u003e to inject arbitrary JavaScript that would then execute in the context of the page. \u003c/p\u003e\n\n\u003cp\u003eThe attack exploited an interpolated \u003ca href=\"/redirect?url=http%3A%2F%2Funderscorejs.org%2F%23template\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eunderscore template\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (\u003ccode\u003e\u0026lt;%=\u003c/code\u003e) that did not HTML-escape the value. In addition, Firefox does not \u003ccode\u003eencodeURIComponent()\u003c/code\u003e the single quote character (\u003ccode\u003e%27\u003c/code\u003e or \u003ccode\u003e\u0026#39;\u003c/code\u003e) in the address bar. Both of these factors allowed an attacker to add a single quote character to break out of several \u003ccode\u003emeta\u003c/code\u003e HTML elements on our map embed page and add arbitrary \u003ccode\u003escript\u003c/code\u003e elements for Firefox users.\u003c/p\u003e\n\n\u003cp\u003eTo resolve this issue we switched to HTML-escaped underscore templates (\u003ccode\u003e\u0026lt;%-\u003c/code\u003e). We deployed the fix to our servers and resolved the issue on April 29th, 2016.\u003c/p\u003e\n\n\u003cp\u003eThis report only affected infrastructure running on \u003ccode\u003eapi.mapbox.com\u003c/code\u003e and \u003ccode\u003eapi.tiles.mapbox.com\u003c/code\u003e - it did not affect any of Mapbox\u0026#39;s open source libraries such as mapbox.js or Mapbox GL JS. In addition, this issue also only affected Firefox users - Chrome, Safari, and Internet Explorer users were not affected.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}