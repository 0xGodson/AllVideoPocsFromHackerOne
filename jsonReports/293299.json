{"id":293299,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTMyOTk=","url":"https://hackerone.com/reports/293299","title":"Validation message in Bounty award endpoint can be used to determine program balances","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-11-27T19:12:24.566Z","submitted_at":"2017-11-27T19:12:24.566Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cyriac","url":"/cyriac","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-29T16:46:28.636Z","bug_reporter_agreed_on_going_public_at":"2017-11-29T16:46:28.487Z","team_member_agreed_on_going_public_at":"2017-11-29T16:16:02.667Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHi team,\nFound a idor in Checking if a Team has sufficient fund to award\n\n### Steps To Reproduce\n\n1. Start a new program and login to the account\n2. A demo Report will be there\n3. Then Set award \u003e Amount \u003e $100 \n4. Set award and intercept the request \n5. change the report_ids to #262262\n\n #262262 - mixmax published report id\n\nmixmax offers $100 minimum bounty\n\n6. And Request\n\nwe will get ***Validation failed: insufficient funds to award this bounty.****\n\nagain use this #208237 report id - LocalTapiola \n\nwe will get ***You have successfully awarded a bounty.***\n\nUsing the report ids we get find that if funds have been added to teams or not\n\n## Impact\n\nJust a information disclosure where we can check if team has added funds to the account","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nHi team,\u003cbr\u003e\nFound a idor in Checking if a Team has sufficient fund to award\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eStart a new program and login to the account\u003c/li\u003e\n\u003cli\u003eA demo Report will be there\u003c/li\u003e\n\u003cli\u003eThen Set award \u0026gt; Amount \u0026gt; $100 \u003c/li\u003e\n\u003cli\u003eSet award and intercept the request \u003c/li\u003e\n\u003cli\u003echange the report_ids to \u003ca href=\"/reports/262262\"\u003e#262262\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"/reports/262262\"\u003e#262262\u003c/a\u003e - mixmax published report id\u003c/p\u003e\n\n\u003cp\u003emixmax offers $100 minimum bounty\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAnd Request\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ewe will get \u003cstrong\u003e\u003cem\u003eValidation failed: insufficient funds to award this bounty.\u003c/em\u003e\u003c/strong\u003e*\u003c/p\u003e\n\n\u003cp\u003eagain use this \u003ca href=\"/reports/208237\"\u003e#208237\u003c/a\u003e report id - LocalTapiola \u003c/p\u003e\n\n\u003cp\u003ewe will get \u003cstrong\u003e\u003cem\u003eYou have successfully awarded a bounty.\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eUsing the report ids we get find that if funds have been added to teams or not\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eJust a information disclosure where we can check if team has added funds to the account\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":242594,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/594/fff071d8b31c65599d6cabdf04267b5b4a844bf5/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052606Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=a49e15e7865c5dfcc404f03b73c81f284e2c17bdbbd28f21e840770f00d62b26","file_size":154381,"type":"image/png"},{"id":242595,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/595/f1b7513df2e115f9d6010456cac2cd1b8bffc939/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052606Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=59c475273d778d3e52ef553e95b5fbb93a5969a5360f4f97a3132eab4a972b85","file_size":152136,"type":"image/png"}],"allow_singular_disclosure_at":"2017-12-29T16:16:02.958Z","allow_singular_disclosure_after":-94655403.4144765,"singular_disclosure_allowed":true,"vote_count":65,"voters":["jokebookservice1","jensec","jr0ch17","kapytein","tk0","bogdantcaciuc","spam404","sameerphad72","nahamsec","flashdisk","and 55 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2187689,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting @cyriac. We've escalated this to the development team to see if this is something they would like to fix, and will get back to you as soon as we have any updates.\n\nKind regards,\n@coffeecup","markdown_message":"\u003cp\u003eThanks for reporting \u003ca href=\"/cyriac\"\u003e@cyriac\u003c/a\u003e. We\u0026#39;ve escalated this to the development team to see if this is something they would like to fix, and will get back to you as soon as we have any updates.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T22:24:05.711Z","updated_at":"2017-11-28T22:24:05.711Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187723,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-28T22:40:26.756Z","updated_at":"2017-11-28T22:40:26.756Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.0)","old_severity_id":97728,"new_severity_id":98045},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2187724,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-28T22:40:57.379Z","updated_at":"2017-11-28T22:40:57.379Z","additional_data":{"old_title":"IDOR in Checking if a Team has sufficient fund to award","new_title":"Validation message in Bounty award endpoint can be used to determine program balances"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2187734,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @cyriac - \n\nThis is great find. We've decided to award $1,500 for this since it exposes some sensitive information about programs and their bounty amounts. We appreciate your help in identifying this issue. Thanks for thinking of HackerOne security and hacking with us!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cyriac\"\u003e@cyriac\u003c/a\u003e - \u003c/p\u003e\n\n\u003cp\u003eThis is great find. We\u0026#39;ve decided to award $1,500 for this since it exposes some sensitive information about programs and their bounty amounts. We appreciate your help in identifying this issue. Thanks for thinking of HackerOne security and hacking with us!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T22:46:25.759Z","updated_at":"2017-11-28T22:46:25.759Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"cyriac","url":"/cyriac"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187770,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-28T23:17:15.519Z","updated_at":"2017-11-28T23:17:15.519Z","actor":{"username":"cjlegacion","cleared":false,"url":"/cjlegacion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@cyriac - We believe this issue has been resolved now. Could you please verify on your end? Thanks! ","markdown_message":"\u003cp\u003e\u003ca href=\"/cyriac\"\u003e@cyriac\u003c/a\u003e - We believe this issue has been resolved now. Could you please verify on your end? Thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T23:23:24.459Z","updated_at":"2017-11-28T23:23:24.459Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187818,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cyriac - I wanted to take this opportunity to elaborate a little bit what went wrong here and the learning we took from this. At HackerOne, we use a library that consolidates authorization, input validation, and business logic into a single layer that lies directly under our controllers. This allows us to route API calls, GraphQL queries / mutations, and normal endpoints to that layer and know for sure that the authorization is always checked. However, it turns out that the input validation was sometimes bloated with business logic. Because the input validation is executed **before** the authorization logic, it would return error messages that revealed information about the report. Here's a code example:\n\n**Wrong**\n```ruby\nclass AwardBountyClass\n  def initialize(report_id)\n    # store the report_id in the class instance\n  end\n\n  def authorized?\n    # make sure user can award a bounty\n  end\n\n  def validate\n    # make sure report_id is an integer\n    # return an error when the balance is too low\n  end\n\n  def execute\n    # award the bounty\n  end\nend\n```\n\n**Good**\n```ruby\nclass AwardBountyClass\n  def initialize(report_id)\n    # store the report_id in the class instance\n  end\n\n  def authorized?\n    # make sure user can award a bounty\n  end\n\n  def validate\n    # make sure report_id is an integer\n  end\n\n  def execute\n    # return an error when the balance is too low\n    # award the bounty\n  end\nend\n```\n\nThe difference between the two is that the error **should** be returned in the `execute` method, not the `validate` method. We've identified multiple code structures in our code base where this could've happened and addressed those. We took the learnings from your report and will see if we can automate the detection of these incorrect code structures. Thanks again!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cyriac\"\u003e@cyriac\u003c/a\u003e - I wanted to take this opportunity to elaborate a little bit what went wrong here and the learning we took from this. At HackerOne, we use a library that consolidates authorization, input validation, and business logic into a single layer that lies directly under our controllers. This allows us to route API calls, GraphQL queries / mutations, and normal endpoints to that layer and know for sure that the authorization is always checked. However, it turns out that the input validation was sometimes bloated with business logic. Because the input validation is executed \u003cstrong\u003ebefore\u003c/strong\u003e the authorization logic, it would return error messages that revealed information about the report. Here\u0026#39;s a code example:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWrong\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAwardBountyClass\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereport_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# store the report_id in the class instance\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eauthorized?\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# make sure user can award a bounty\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003evalidate\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# make sure report_id is an integer\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# return an error when the balance is too low\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# award the bounty\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eGood\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAwardBountyClass\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereport_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# store the report_id in the class instance\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eauthorized?\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# make sure user can award a bounty\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003evalidate\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# make sure report_id is an integer\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# return an error when the balance is too low\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# award the bounty\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe difference between the two is that the error \u003cstrong\u003eshould\u003c/strong\u003e be returned in the \u003ccode\u003eexecute\u003c/code\u003e method, not the \u003ccode\u003evalidate\u003c/code\u003e method. We\u0026#39;ve identified multiple code structures in our code base where this could\u0026#39;ve happened and addressed those. We took the learnings from your report and will see if we can automate the detection of these incorrect code structures. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T23:58:46.778Z","updated_at":"2017-11-28T23:58:46.778Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2188092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have retested :D Fast Fix :) Thanks @coffeecup and @jobert for the  details :D , Hackerone again excited me with  Bounty ,i was expecting a swag :) Thanks Team ","markdown_message":"\u003cp\u003eI have retested :D Fast Fix :) Thanks \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e and \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e for the  details :D , Hackerone again excited me with  Bounty ,i was expecting a swag :) Thanks Team \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T05:49:23.691Z","updated_at":"2017-11-29T05:49:23.691Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2189037,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for confirming, appreciate it!","markdown_message":"\u003cp\u003eThanks for confirming, appreciate it!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T16:09:36.265Z","updated_at":"2017-11-29T16:09:36.265Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"cyriac","url":"/cyriac"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2189047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-29T16:16:02.711Z","updated_at":"2017-11-29T16:16:02.711Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2189120,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-29T16:46:28.534Z","updated_at":"2017-11-29T16:46:28.534Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2189121,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-29T16:46:28.674Z","updated_at":"2017-11-29T16:46:28.674Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2196518,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2017-12-03T07:50:02.316Z","updated_at":"2017-12-03T07:50:02.316Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"cy**************om","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2196526,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-03T07:58:20.967Z","updated_at":"2017-12-03T07:58:20.967Z","actor":{"username":"hacker__","cleared":false,"url":"/hacker__","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/892/98bedc6d4c0dca9c5433c3646642efdba09b1e1b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8252532,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-06-10T10:12:45.721Z","updated_at":"2020-06-10T10:12:45.721Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"048vg","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8252537,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-06-10T10:14:13.168Z","updated_at":"2020-06-10T10:14:13.168Z","actor":{"username":"cyriac","cleared":false,"url":"/cyriac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g77H2KN9mbPb3Bt5GVbL5AMn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"email":"048vg","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5982,"category":"team","content":"The finder found a vulnerability that allowed them to determine the available bounty balance of some programs. The endpoint that awards a bounty did a balance check before the authorization check and returned an error when the program had insufficient funds. Someone could iterate over all report IDs and try to award a number of bounties to narrow down the balance. The program names were only accessible for public programs. This vulnerability only affected a limited set of our customers.\n\nWe'd like to thank @cyriac and @cjlegacion for bringing this vulnerability to our attention!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe finder found a vulnerability that allowed them to determine the available bounty balance of some programs. The endpoint that awards a bounty did a balance check before the authorization check and returned an error when the program had insufficient funds. Someone could iterate over all report IDs and try to award a number of bounties to narrow down the balance. The program names were only accessible for public programs. This vulnerability only affected a limited set of our customers.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to thank \u003ca href=\"/cyriac\"\u003e@cyriac\u003c/a\u003e and \u003ca href=\"/cjlegacion\"\u003e@cjlegacion\u003c/a\u003e for bringing this vulnerability to our attention!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}