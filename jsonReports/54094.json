{"id":54094,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDA5NA==","url":"https://hackerone.com/reports/54094","title":"HTTP MitM on Flash Player settings manager allows attacker to set sandbox settings","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-31T20:55:29.703Z","submitted_at":"2015-03-31T20:55:29.703Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kinine","url":"/kinine","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/901/9e0d9a0c6c69070fea0d3ca6c92b2471197412f0_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-12-23T21:09:32.056Z","bug_reporter_agreed_on_going_public_at":"2018-11-23T21:09:27.492Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This vulnerability is present in both Google Chrome's PepperFlash aswell as browsers\r\nwith the NPAPI Flash Player versions.\r\n\r\nIt works by MITM'ing the Flashplayer settings manager.\r\nAlthough this settings manager is served over HTTPS, it is still\r\npossible to place or edit the local settings cookie by serving it over\r\nHTTP over the corresponding path. \r\n\r\nThis leads to the attacker being able to edit several sandbox settings, for example, the attacker can:\r\n  -Give the domain/payload permanent access to webcam/microphone,\r\n  -Permanently exempt the domain/payload from any CORS Policy restrictions\r\n  -Effectively disable auto updates (NPAPI versions) by setting the auto-update interval to ~9999 days\r\n\r\nFor this, an attacker would only need access to the HTTP communication\r\nof the victims network. Either embedding the remote SWF in the attackers own site, or injecting the embed code in other HTTP traffic from the victim.\r\n\r\nThe POC was peformed against Google Chrome 41.0.2272.101 (PPAPI 17.0.0.134) on Windows 8.1\r\nMITMProxy (https://mitmproxy.org/) was used to serve the altered SWF (Without using HTTPS/Certificate modes).\r\n\r\nThis attack is demonstrated in this video: https://www.youtube.com/watch?v=2Q52q_kZtTc (unlisted)\r\n\r\nThis issue is reported to Adobe, I am currently awaiting a response from their PSIRT.","vulnerability_information_html":"\u003cp\u003eThis vulnerability is present in both Google Chrome\u0026#39;s PepperFlash aswell as browsers\u003cbr\u003e\nwith the NPAPI Flash Player versions.\u003c/p\u003e\n\n\u003cp\u003eIt works by MITM\u0026#39;ing the Flashplayer settings manager.\u003cbr\u003e\nAlthough this settings manager is served over HTTPS, it is still\u003cbr\u003e\npossible to place or edit the local settings cookie by serving it over\u003cbr\u003e\nHTTP over the corresponding path. \u003c/p\u003e\n\n\u003cp\u003eThis leads to the attacker being able to edit several sandbox settings, for example, the attacker can:\u003cbr\u003e\n  -Give the domain/payload permanent access to webcam/microphone,\u003cbr\u003e\n  -Permanently exempt the domain/payload from any CORS Policy restrictions\u003cbr\u003e\n  -Effectively disable auto updates (NPAPI versions) by setting the auto-update interval to ~9999 days\u003c/p\u003e\n\n\u003cp\u003eFor this, an attacker would only need access to the HTTP communication\u003cbr\u003e\nof the victims network. Either embedding the remote SWF in the attackers own site, or injecting the embed code in other HTTP traffic from the victim.\u003c/p\u003e\n\n\u003cp\u003eThe POC was peformed against Google Chrome 41.0.2272.101 (PPAPI 17.0.0.134) on Windows 8.1\u003cbr\u003e\nMITMProxy (\u003ca title=\"https://mitmproxy.org/\" href=\"/redirect?url=https%3A%2F%2Fmitmproxy.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mitmproxy.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) was used to serve the altered SWF (Without using HTTPS/Certificate modes).\u003c/p\u003e\n\n\u003cp\u003eThis attack is demonstrated in this video: \u003ca title=\"https://www.youtube.com/watch?v=2Q52q_kZtTc\" href=\"/redirect?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D2Q52q_kZtTc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.youtube.com/watch?v=2Q52q_kZtTc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (unlisted)\u003c/p\u003e\n\n\u003cp\u003eThis issue is reported to Adobe, I am currently awaiting a response from their PSIRT.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":33302,"file_name":"poc.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/302/7ae94a2b1a1e35663434d426d22e6d4ace6f695a/poc.zip?response-content-disposition=attachment%3B%20filename%3D%22poc.zip%22%3B%20filename%2A%3DUTF-8%27%27poc.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061633Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026X-Amz-Signature=da6fe3ec92ceeba04793cf3b58f5235fc05750e4942a1369a9364bc00011219d","file_size":628670,"type":"application/zip"}],"allow_singular_disclosure_at":"2018-12-23T21:09:27.542Z","allow_singular_disclosure_after":-63623225.72822474,"singular_disclosure_allowed":true,"vote_count":10,"voters":["an0nym0us","t-4-y-m","cryptographer","spetr0x","arifkhan","b3f53dc9b2061f7df0c2ffd","reppie","hackertwo3","reddmist","user6"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":500245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue was assigned CVE-2015-3044 and CVE-2015-3079.","markdown_message":"\u003cp\u003eThis issue was assigned CVE-2015-3044 and CVE-2015-3079.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T07:55:16.698Z","updated_at":"2015-07-06T07:55:16.698Z","actor":{"username":"kinine","cleared":false,"url":"/kinine","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/901/9e0d9a0c6c69070fea0d3ca6c92b2471197412f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":500247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://helpx.adobe.com/security/products/flash-player/apsb15-09.html","markdown_message":"\u003cp\u003e\u003ca title=\"https://helpx.adobe.com/security/products/flash-player/apsb15-09.html\" href=\"/redirect?url=https%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb15-09.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://helpx.adobe.com/security/products/flash-player/apsb15-09.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T07:56:07.111Z","updated_at":"2015-07-06T07:56:07.111Z","actor":{"username":"kinine","cleared":false,"url":"/kinine","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/901/9e0d9a0c6c69070fea0d3ca6c92b2471197412f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":695882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on whether these 2 vulnerabilities are eligible for reward?","markdown_message":"\u003cp\u003eAny update on whether these 2 vulnerabilities are eligible for reward?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-23T19:41:30.464Z","updated_at":"2015-11-23T19:41:30.464Z","actor":{"username":"kinine","cleared":false,"url":"/kinine","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/901/9e0d9a0c6c69070fea0d3ca6c92b2471197412f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":751324,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-10T06:38:52.875Z","updated_at":"2016-01-10T06:38:52.875Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"kinine","url":"/kinine"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":751327,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-10T06:38:58.183Z","updated_at":"2016-01-10T06:38:58.183Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"2000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"kinine","url":"/kinine"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3702000,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-23T21:09:27.510Z","updated_at":"2018-11-23T21:09:27.510Z","first_to_agree":true,"actor":{"username":"kinine","cleared":false,"url":"/kinine","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/901/9e0d9a0c6c69070fea0d3ca6c92b2471197412f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3884713,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-23T21:09:32.087Z","updated_at":"2018-12-23T21:09:32.087Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}