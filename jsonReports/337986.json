{"id":337986,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzc5ODY=","url":"https://hackerone.com/reports/337986","title":"CVE-2018-6797:  A crafted regular expression can cause a heap buffer write overflow in Perl 5 giving a remote attacker control over bytes written","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-14T17:22:34.735Z","submitted_at":"2018-04-14T17:22:34.735Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30,"url":"https://hackerone.com/ibb-perl","handle":"ibb-perl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Perl (IBB)","twitter_handle":"","website":"http://www.perl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-19T19:00:32.204Z","bug_reporter_agreed_on_going_public_at":"2018-04-19T19:00:25.730Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker supplies a regular expression containing one or more `\\xDF` characters after an escape putting the regexp into unicode matching mode, such as a `\\N{}` escape.  Each `\\xDF` character adds one byte of overflow, and any other text in the regular expression is written in order, providing the attacker control over the bytes written to the overflowed region.\n\n* Reported to the [Perl security mailing list](https://rt.perl.org/Ticket/Display.html?id=132227) on 6 Oct 2017.\n* Confirmed as a security flaw by TonyC on 31 Jan 2018\n* CVE-2018-6797 assigned to this flaw on 6 Feb 2018\n* Patch released to the security mailing list for Perl 5.24 and Perl 5.26 on 09 Feb 2018\n* Patch released to the security mailing list for Perl blead on 22 Feb 2018\n* [Public security advisory](https://github.com/Perl/perl5/blob/blead/pod/perl5262delta.pod) released on 14 April 2018\n\nOn 31 Jan 2018 Perl dev TonyC says in an email to the Perl security mailing list that `depending on the heap implementation it may be possible to perform a nastier exploit - an attacker has almost complete control over the bytes written.`\n\n```\n==28186==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60700000ac58 at pc 0x000000846c2d bp 0x7ffe716bc7f0 sp 0x7ffe716bc7e0\nWRITE of size 1 at 0x60700000ac58 thread T0\n    #0 0x846c2c in S_regatom /root/perl/regcomp.c:13652\n    #1 0x8587f6 in S_regpiece /root/perl/regcomp.c:11708\n    #2 0x8587f6 in S_regbranch /root/perl/regcomp.c:11633\n    #3 0x88830a in S_reg /root/perl/regcomp.c:11371\n    #4 0x8c90dc in Perl_re_op_compile /root/perl/regcomp.c:7363\n    #5 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #6 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #7 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #8 0x593622 in perl_parse /root/perl/perl.c:1753\n    #9 0x42eb7d in main /root/perl/perlmain.c:121\n    #10 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #11 0x42fe18 in _start (/root/perl/perl+0x42fe18)\n\n0x60700000ac58 is located 0 bytes to the right of 72-byte region [0x60700000ac10,0x60700000ac58)\nallocated by thread T0 here:\n    #0 0x7fba4dc62602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\n    #1 0x92dfd4 in Perl_safesysmalloc /root/perl/util.c:153\n    #2 0x8c6cbe in Perl_re_op_compile /root/perl/regcomp.c:7209\n    #3 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #4 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #5 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #6 0x593622 in perl_parse /root/perl/perl.c:1753\n    #7 0x42eb7d in main /root/perl/perlmain.c:121\n    #8 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/perl/regcomp.c:13652 S_regatom\n```\n\n## Impact\n\nDepending on the heap implementation a remote attacker could have complete control over the bytes written to memory.","vulnerability_information_html":"\u003cp\u003eAn attacker supplies a regular expression containing one or more \u003ccode\u003e\\xDF\u003c/code\u003e characters after an escape putting the regexp into unicode matching mode, such as a \u003ccode\u003e\\N{}\u003c/code\u003e escape.  Each \u003ccode\u003e\\xDF\u003c/code\u003e character adds one byte of overflow, and any other text in the regular expression is written in order, providing the attacker control over the bytes written to the overflowed region.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eReported to the \u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FDisplay.html%3Fid%3D132227\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePerl security mailing list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on 6 Oct 2017.\u003c/li\u003e\n\u003cli\u003eConfirmed as a security flaw by TonyC on 31 Jan 2018\u003c/li\u003e\n\u003cli\u003eCVE-2018-6797 assigned to this flaw on 6 Feb 2018\u003c/li\u003e\n\u003cli\u003ePatch released to the security mailing list for Perl 5.24 and Perl 5.26 on 09 Feb 2018\u003c/li\u003e\n\u003cli\u003ePatch released to the security mailing list for Perl blead on 22 Feb 2018\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPerl%2Fperl5%2Fblob%2Fblead%2Fpod%2Fperl5262delta.pod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePublic security advisory\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e released on 14 April 2018\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOn 31 Jan 2018 Perl dev TonyC says in an email to the Perl security mailing list that \u003ccode\u003edepending on the heap implementation it may be possible to perform a nastier exploit - an attacker has almost complete control over the bytes written.\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e==28186==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60700000ac58 at pc 0x000000846c2d bp 0x7ffe716bc7f0 sp 0x7ffe716bc7e0\nWRITE of size 1 at 0x60700000ac58 thread T0\n    #0 0x846c2c in S_regatom /root/perl/regcomp.c:13652\n    #1 0x8587f6 in S_regpiece /root/perl/regcomp.c:11708\n    #2 0x8587f6 in S_regbranch /root/perl/regcomp.c:11633\n    #3 0x88830a in S_reg /root/perl/regcomp.c:11371\n    #4 0x8c90dc in Perl_re_op_compile /root/perl/regcomp.c:7363\n    #5 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #6 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #7 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #8 0x593622 in perl_parse /root/perl/perl.c:1753\n    #9 0x42eb7d in main /root/perl/perlmain.c:121\n    #10 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #11 0x42fe18 in _start (/root/perl/perl+0x42fe18)\n\n0x60700000ac58 is located 0 bytes to the right of 72-byte region [0x60700000ac10,0x60700000ac58)\nallocated by thread T0 here:\n    #0 0x7fba4dc62602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\n    #1 0x92dfd4 in Perl_safesysmalloc /root/perl/util.c:153\n    #2 0x8c6cbe in Perl_re_op_compile /root/perl/regcomp.c:7209\n    #3 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #4 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #5 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #6 0x593622 in perl_parse /root/perl/perl.c:1753\n    #7 0x42eb7d in main /root/perl/perlmain.c:121\n    #8 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/perl/regcomp.c:13652 S_regatom\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDepending on the heap implementation a remote attacker could have complete control over the bytes written to memory.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-19T19:00:25.830Z","allow_singular_disclosure_after":-82463886.16894817,"singular_disclosure_allowed":true,"vote_count":23,"voters":["rc0r","jokebookservice1","kapytein","muon4","bl4de","spam404","mak","eveeez","geeknik","r3y","and 13 more..."],"severity":{"rating":"high","score":7.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2638551,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-19T18:11:29.951Z","updated_at":"2018-04-19T18:11:29.951Z","additional_data":{"old_severity":"Critical","new_severity":"High (7.0)","old_severity_id":140179,"new_severity_id":142840},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2638552,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-19T18:11:53.760Z","updated_at":"2018-04-19T18:11:53.760Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-perl","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2638553,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-19T18:12:02.047Z","updated_at":"2018-04-19T18:12:02.047Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2638707,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-19T19:00:25.767Z","updated_at":"2018-04-19T19:00:25.767Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2766695,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-19T19:00:32.227Z","updated_at":"2018-05-19T19:00:32.227Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}