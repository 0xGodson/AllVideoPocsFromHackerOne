{"id":209449,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDk0NDk=","url":"https://hackerone.com/reports/209449","title":"Heap buffer overflow with long array assignment","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-02-28T01:06:43.084Z","submitted_at":"2017-02-28T01:06:43.084Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"titanous","url":"/titanous","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/226/4a5ed7749ff0c45f6b1d4a15971edf4a1a2e5cf7_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-14T21:10:25.132Z","bug_reporter_agreed_on_going_public_at":"2017-03-14T21:10:25.085Z","team_member_agreed_on_going_public_at":"2017-03-14T21:09:28.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The following program triggers a heap buffer overflow:\n\n```text\n[][]=%\n\n[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]-=0\n```\n\nASAN Report:\n\n```text\n=================================================================\n==7193==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61d00001e888 at pc 0x00000062a87f bp 0x7ffed3653990 sp 0x7ffed3653988\nWRITE of size 4 at 0x61d00001e888 thread T0\n    #0 0x62a87e in mrb_vm_exec /vagrant/src/vm.c:1164:9\n    #1 0x622c5b in mrb_vm_run /vagrant/src/vm.c:815:10\n    #2 0x650048 in mrb_top_run /vagrant/src/vm.c:2573:12\n    #3 0x679f89 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #4 0x67ac25 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #5 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #6 0x7f11f1720f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n    #7 0x41a505 in _start (/vagrant/bin/mruby+0x41a505)\n\n0x61d00001e888 is located 8 bytes to the right of 2048-byte region [0x61d00001e080,0x61d00001e880)\nallocated by thread T0 here:\n    #0 0x4c4c0d in realloc (/vagrant/bin/mruby+0x4c4c0d)\n    #1 0x5c2cc5 in mrb_default_allocf /vagrant/src/state.c:60:12\n    #2 0x5503e6 in mrb_realloc_simple /vagrant/src/gc.c:201:8\n    #3 0x550a34 in mrb_realloc /vagrant/src/gc.c:215:8\n    #4 0x551373 in mrb_malloc /vagrant/src/gc.c:236:10\n    #5 0x55140d in mrb_calloc /vagrant/src/gc.c:254:9\n    #6 0x61add9 in stack_init /vagrant/src/vm.c:97:28\n    #7 0x618208 in mrb_funcall_with_block /vagrant/src/vm.c:376:7\n    #8 0x617c22 in mrb_funcall_with_block /vagrant/src/vm.c:354:13\n    #9 0x61748c in mrb_funcall_argv /vagrant/src/vm.c:461:10\n    #10 0x524b21 in mrb_obj_new /vagrant/src/class.c:1425:5\n    #11 0x53e89e in mrb_exc_new_str /vagrant/src/error.c:32:10\n    #12 0x548218 in mrb_init_exception /vagrant/src/error.c:549:20\n    #13 0x6a8590 in mrb_init_core /vagrant/src/init.c:41:3\n    #14 0x5c2c65 in mrb_open_core /vagrant/src/state.c:47:3\n    #15 0x5c2e0c in mrb_open_allocf /vagrant/src/state.c:107:20\n    #16 0x5c2dda in mrb_open /vagrant/src/state.c:99:20\n    #17 0x4f29d3 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:172:20\n    #18 0x7f11f1720f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /vagrant/src/vm.c:1164:9 in mrb_vm_exec\nShadow bytes around the buggy address:\n  0x0c3a7fffbcc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbcd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbce0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbcf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbd00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u003e0x0c3a7fffbd10: fa[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd50: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c3a7fffbd60: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==7193==ABORTING\n```","vulnerability_information_html":"\u003cp\u003eThe following program triggers a heap buffer overflow:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[][]=%\n\n[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]-=0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eASAN Report:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e=================================================================\n==7193==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61d00001e888 at pc 0x00000062a87f bp 0x7ffed3653990 sp 0x7ffed3653988\nWRITE of size 4 at 0x61d00001e888 thread T0\n    #0 0x62a87e in mrb_vm_exec /vagrant/src/vm.c:1164:9\n    #1 0x622c5b in mrb_vm_run /vagrant/src/vm.c:815:10\n    #2 0x650048 in mrb_top_run /vagrant/src/vm.c:2573:12\n    #3 0x679f89 in mrb_load_exec /vagrant/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #4 0x67ac25 in mrb_load_file_cxt /vagrant/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #5 0x4f3af5 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #6 0x7f11f1720f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n    #7 0x41a505 in _start (/vagrant/bin/mruby+0x41a505)\n\n0x61d00001e888 is located 8 bytes to the right of 2048-byte region [0x61d00001e080,0x61d00001e880)\nallocated by thread T0 here:\n    #0 0x4c4c0d in realloc (/vagrant/bin/mruby+0x4c4c0d)\n    #1 0x5c2cc5 in mrb_default_allocf /vagrant/src/state.c:60:12\n    #2 0x5503e6 in mrb_realloc_simple /vagrant/src/gc.c:201:8\n    #3 0x550a34 in mrb_realloc /vagrant/src/gc.c:215:8\n    #4 0x551373 in mrb_malloc /vagrant/src/gc.c:236:10\n    #5 0x55140d in mrb_calloc /vagrant/src/gc.c:254:9\n    #6 0x61add9 in stack_init /vagrant/src/vm.c:97:28\n    #7 0x618208 in mrb_funcall_with_block /vagrant/src/vm.c:376:7\n    #8 0x617c22 in mrb_funcall_with_block /vagrant/src/vm.c:354:13\n    #9 0x61748c in mrb_funcall_argv /vagrant/src/vm.c:461:10\n    #10 0x524b21 in mrb_obj_new /vagrant/src/class.c:1425:5\n    #11 0x53e89e in mrb_exc_new_str /vagrant/src/error.c:32:10\n    #12 0x548218 in mrb_init_exception /vagrant/src/error.c:549:20\n    #13 0x6a8590 in mrb_init_core /vagrant/src/init.c:41:3\n    #14 0x5c2c65 in mrb_open_core /vagrant/src/state.c:47:3\n    #15 0x5c2e0c in mrb_open_allocf /vagrant/src/state.c:107:20\n    #16 0x5c2dda in mrb_open /vagrant/src/state.c:99:20\n    #17 0x4f29d3 in main /vagrant/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:172:20\n    #18 0x7f11f1720f44 in __libc_start_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /vagrant/src/vm.c:1164:9 in mrb_vm_exec\nShadow bytes around the buggy address:\n  0x0c3a7fffbcc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbcd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbce0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbcf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c3a7fffbd00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u0026gt;0x0c3a7fffbd10: fa[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c3a7fffbd50: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c3a7fffbd60: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==7193==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-13T21:09:28.441Z","allow_singular_disclosure_after":-117100006.6941596,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1509866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-02-28T01:06:43.277Z","updated_at":"2017-02-28T01:06:43.277Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1514519,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue and opened an issue upstream: https://github.com/mruby/mruby/issues/3479","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3479\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3479\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3479\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-01T22:34:37.712Z","updated_at":"2017-03-01T22:34:37.712Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1524566,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue was resolved upstream in https://github.com/mruby/mruby/commit/1ab7e7e4dce9f53b3d2ed576a6d69d8dbb013166.\n\nOur next round of bounty decisions will take place within a two weeks, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue was resolved upstream in \u003ca title=\"https://github.com/mruby/mruby/commit/1ab7e7e4dce9f53b3d2ed576a6d69d8dbb013166\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2F1ab7e7e4dce9f53b3d2ed576a6d69d8dbb013166\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/1ab7e7e4dce9f53b3d2ed576a6d69d8dbb013166\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within a two weeks, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-07T16:20:44.460Z","updated_at":"2017-03-07T16:20:44.460Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"titanous","url":"/titanous"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1541572,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the MRuby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify and the MRuby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-14T21:09:22.066Z","updated_at":"2017-03-14T21:09:22.066Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"titanous","url":"/titanous"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1541573,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-14T21:09:28.424Z","updated_at":"2017-03-14T21:09:28.424Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1541582,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-14T21:10:25.107Z","updated_at":"2017-03-14T21:10:25.107Z","actor":{"username":"titanous","cleared":false,"url":"/titanous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/226/4a5ed7749ff0c45f6b1d4a15971edf4a1a2e5cf7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1541583,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-14T21:10:25.151Z","updated_at":"2017-03-14T21:10:25.151Z","actor":{"username":"titanous","cleared":false,"url":"/titanous","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/226/4a5ed7749ff0c45f6b1d4a15971edf4a1a2e5cf7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}