{"id":477073,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzcwNzM=","url":"https://hackerone.com/reports/477073","title":"ZeroMQ libzmq remote code execution","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-09T12:16:04.570Z","submitted_at":"2019-01-09T12:16:04.570Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"guido","url":"/guido","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-6250"],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-12T20:44:49.134Z","bug_reporter_agreed_on_going_public_at":"2019-09-12T20:44:49.029Z","team_member_agreed_on_going_public_at":"2019-09-05T05:59:30.590Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Bug report and exploit: https://github.com/zeromq/libzmq/issues/3351\nFix by me: https://github.com/zeromq/libzmq/pull/3353\n\nMy motive for full disclosure is as follows:\n\n```\nIs it true that it is not safe to use ZeroMQ over the internet because it will crash?\n\nEarlier versions of the ZeroMQ library (before 2.1) were not very resilient against \"fuzzing\" attacks. A malformed packet or garbage data could cause an old version of the library to assert and exit. Since the release of 2.1, all reported cases of assertions caused by bad data have been fixed. If your testing uncovers a problem in this area, please file a bug report.\n```\nSource: http://zeromq.org/area:faq\n\nThe issue reporting page (http://zeromq.org/docs:issue-tracking) instructs to open a Github issue, with no special procedure for security issues, so I went ahead and did just that.\n\nlibzmq appears to be widely used and has wrapper implementations for Go, Python, Java, Node.js, etc.\n\n## Impact\n\nRunning arbitrary code on the victim's system.","vulnerability_information_html":"\u003cp\u003eBug report and exploit: \u003ca title=\"https://github.com/zeromq/libzmq/issues/3351\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Fissues%2F3351\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/issues/3351\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nFix by me: \u003ca title=\"https://github.com/zeromq/libzmq/pull/3353\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeromq%2Flibzmq%2Fpull%2F3353\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeromq/libzmq/pull/3353\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMy motive for full disclosure is as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eIs it true that it is not safe to use ZeroMQ over the internet because it will crash?\n\nEarlier versions of the ZeroMQ library (before 2.1) were not very resilient against \u0026quot;fuzzing\u0026quot; attacks. A malformed packet or garbage data could cause an old version of the library to assert and exit. Since the release of 2.1, all reported cases of assertions caused by bad data have been fixed. If your testing uncovers a problem in this area, please file a bug report.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSource: \u003ca title=\"http://zeromq.org/area:faq\" href=\"/redirect?url=http%3A%2F%2Fzeromq.org%2Farea%3Afaq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://zeromq.org/area:faq\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe issue reporting page (\u003ca title=\"http://zeromq.org/docs:issue-tracking\" href=\"/redirect?url=http%3A%2F%2Fzeromq.org%2Fdocs%3Aissue-tracking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://zeromq.org/docs:issue-tracking\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) instructs to open a Github issue, with no special procedure for security issues, so I went ahead and did just that.\u003c/p\u003e\n\n\u003cp\u003elibzmq appears to be widely used and has wrapper implementations for Go, Python, Java, Node.js, etc.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eRunning arbitrary code on the victim\u0026#39;s system.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-05T05:59:30.701Z","allow_singular_disclosure_after":-38966685.7058291,"singular_disclosure_allowed":true,"vote_count":29,"voters":["d0nut","secator","bl4de","spam404","barracud4_","sameerphad72","mygf","yassineaboukir","bugdiscloseguys","0-1","and 19 more..."],"severity":{"rating":"high","score":8.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3978679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE-2019-6250 has been assigned.","markdown_message":"\u003cp\u003eCVE-2019-6250 has been assigned.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-15T12:14:04.079Z","updated_at":"2019-01-15T12:14:04.079Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4002567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @guido - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-18T21:05:35.057Z","updated_at":"2019-01-18T21:05:35.057Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4128505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, can you kindly process this report? Thank you.","markdown_message":"\u003cp\u003eHi, can you kindly process this report? Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-11T14:27:27.301Z","updated_at":"2019-02-11T14:27:27.301Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4532177,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-10T18:24:34.487Z","updated_at":"2019-04-10T18:24:34.487Z","cve_ids":["CVE-2019-6250"],"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4532179,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-10T18:25:34.984Z","updated_at":"2019-04-10T18:25:34.984Z","additional_data":{"old_severity":"Critical","new_severity":"High (8.8)","old_severity_id":276965,"new_severity_id":342992},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4567357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @guido - Thank you for the report and sorry for the delayed response. Unfortunately, this submission doesn't meet the following criteria:\n\n\u003e - Have critical impact: vulnerability has extreme negative consequences for the general public.\n\u003e - Be novel: vulnerability is new or unusual in an interesting way.\n\nFor further ideas of what type of vulnerabilities are accepted, check out ImageTragick and ShellShock.\n\nThanks,\n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e - Thank you for the report and sorry for the delayed response. Unfortunately, this submission doesn\u0026#39;t meet the following criteria:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eHave critical impact: vulnerability has extreme negative consequences for the general public.\u003c/li\u003e\n\u003cli\u003eBe novel: vulnerability is new or unusual in an interesting way.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eFor further ideas of what type of vulnerabilities are accepted, check out ImageTragick and ShellShock.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-15T20:58:44.428Z","updated_at":"2019-04-15T20:58:44.428Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4567430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ZeroMQ is in widespread use and my finding has critical impact. I don't just present a fuzzer finding but an actual remote code execution exploit.\n\nEven Heartbleed would be disqualified by your second criterium because buffer overreads are far from novel and have in fact existed since Richard Stallman was still buffer overflowing his diapers.\n\nBut whatever.","markdown_message":"\u003cp\u003eZeroMQ is in widespread use and my finding has critical impact. I don\u0026#39;t just present a fuzzer finding but an actual remote code execution exploit.\u003c/p\u003e\n\n\u003cp\u003eEven Heartbleed would be disqualified by your second criterium because buffer overreads are far from novel and have in fact existed since Richard Stallman was still buffer overflowing his diapers.\u003c/p\u003e\n\n\u003cp\u003eBut whatever.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-15T21:11:11.876Z","updated_at":"2019-04-15T21:11:11.876Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4567431,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-15T21:11:18.466Z","updated_at":"2019-04-15T21:11:18.466Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4567439,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-15T21:13:44.610Z","updated_at":"2019-04-15T21:13:44.610Z","first_to_agree":true,"actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4694036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Come on man, disclose it.","markdown_message":"\u003cp\u003eCome on man, disclose it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T20:27:02.911Z","updated_at":"2019-04-30T20:27:02.911Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5678757,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hey @guido, let me talk to the panel about this one.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e, let me talk to the panel about this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-27T21:17:08.027Z","updated_at":"2019-08-27T21:17:08.027Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5678810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much @reed","markdown_message":"\u003cp\u003eThank you very much \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-27T21:26:37.974Z","updated_at":"2019-08-27T21:26:37.974Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5734729,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-05T05:58:58.759Z","updated_at":"2019-09-05T05:58:58.759Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"guido","url":"/guido"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5734730,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThanks for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-05T05:59:21.122Z","updated_at":"2019-09-05T05:59:21.122Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"guido","url":"/guido"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5734731,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-05T05:59:30.609Z","updated_at":"2019-09-05T05:59:30.609Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5794869,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-12T20:44:49.052Z","updated_at":"2019-09-12T20:44:49.052Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5794870,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-12T20:44:49.162Z","updated_at":"2019-09-12T20:44:49.162Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}