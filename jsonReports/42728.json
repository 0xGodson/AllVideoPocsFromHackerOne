{"id":42728,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjcyOA==","url":"https://hackerone.com/reports/42728","title":"Data-Tags and the New HTML Sanitizer Subverts CSRF protection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-07T00:38:28.544Z","submitted_at":"2015-01-07T00:38:28.544Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"benmmurphy","url":"/benmmurphy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-13T18:22:03.201Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-12T18:21:45.148Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-13T18:21:46.217Z","allow_singular_disclosure_after":-151328097.68424046,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","cr4xerbik4sh","japz","cryptographer","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":305441,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-07T22:31:13.080Z","updated_at":"2015-01-07T22:31:13.080Z","actor":{"username":"nzkoz","cleared":false,"url":"/nzkoz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/317/11e8edc22329e340906e362e4f8d431cd6797787_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":305764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-08T09:30:03.711Z","updated_at":"2015-01-08T09:30:03.711Z","actor":{"username":"benmmurphy","cleared":false,"url":"/benmmurphy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474100,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-16T13:19:52.694Z","updated_at":"2015-06-16T13:19:52.694Z","actor":{"username":"benmmurphy","cleared":false,"url":"/benmmurphy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637058,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-29T16:17:08.753Z","updated_at":"2015-10-29T16:17:08.753Z","additional_data":{"duplicate_report_id":96466},"actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-29T16:56:12.201Z","updated_at":"2015-10-29T16:56:12.201Z","actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-29T18:57:12.769Z","updated_at":"2015-10-29T18:57:12.769Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":655028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-12T08:57:01.128Z","updated_at":"2015-11-12T08:57:01.128Z","actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":693046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-20T15:41:17.597Z","updated_at":"2015-11-20T15:41:17.597Z","actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":699276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-25T19:23:41.226Z","updated_at":"2015-11-25T19:23:41.226Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":702271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-30T08:01:10.689Z","updated_at":"2015-11-30T08:01:10.689Z","actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":704631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-01T18:11:55.109Z","updated_at":"2015-12-01T18:11:55.109Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":766428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-21T08:39:40.962Z","updated_at":"2016-01-21T08:39:40.962Z","actor":{"username":"b4008d9d7b75231e9d05da2","cleared":false,"url":"/b4008d9d7b75231e9d05da2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771201,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-25T18:16:45.256Z","updated_at":"2016-01-25T18:16:45.256Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":771820,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-26T01:54:10.656Z","updated_at":"2016-01-26T01:54:10.656Z","actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"benmmurphy","url":"/benmmurphy"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":796075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-12T18:21:45.182Z","updated_at":"2016-02-12T18:21:45.182Z","first_to_agree":true,"actor":{"username":"rafaelfranca","cleared":false,"url":"/rafaelfranca","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":837641,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-13T18:22:03.232Z","updated_at":"2016-03-13T18:22:03.232Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2359941,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-07T18:28:36.528Z","updated_at":"2018-02-07T18:28:36.528Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"benmmurphy","url":"/benmmurphy"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1250,"category":"team","content":"Possible XSS vulnerability in rails-html-sanitizer\n\nThere is a possible XSS vulnerability in rails-html-sanitizer. This\nvulnerability has been assigned the CVE identifier CVE-2015-7578.\n\nVersions Affected:  All.\nNot affected:       None.\nFixed Versions:     1.0.3\n\nImpact\n------\nThere is a possible XSS vulnerability in rails-html-sanitizer.  Certain\nattributes are not removed from tags when they are sanitized, and these\nattributes can lead to an XSS attack on target applications.\n\nAll users running an affected release should either upgrade or use one of the\nworkarounds immediately.\n\nReleases\n--------\nThe FIXED releases are available at the normal locations.\n\nWorkarounds\n-----------\nThere are no feasible workarounds for this issue.\n\nPatches\n-------\nTo aid users who aren't able to upgrade immediately we have provided patches for\nthe two supported release series. They are in git-am format and consist of a\nsingle changeset.\n\n* 1-0-sanitize_data_attributes.patch - Patch for 1.0 series\n\nCredits\n-------\nThanks to Ben Murphy and Marien for reporting this","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ePossible XSS vulnerability in rails-html-sanitizer\u003c/p\u003e\n\n\u003cp\u003eThere is a possible XSS vulnerability in rails-html-sanitizer. This\u003cbr\u003e\nvulnerability has been assigned the CVE identifier CVE-2015-7578.\u003c/p\u003e\n\n\u003cp\u003eVersions Affected:  All.\u003cbr\u003e\nNot affected:       None.\u003cbr\u003e\nFixed Versions:     1.0.3\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThere is a possible XSS vulnerability in rails-html-sanitizer.  Certain\u003cbr\u003e\nattributes are not removed from tags when they are sanitized, and these\u003cbr\u003e\nattributes can lead to an XSS attack on target applications.\u003c/p\u003e\n\n\u003cp\u003eAll users running an affected release should either upgrade or use one of the\u003cbr\u003e\nworkarounds immediately.\u003c/p\u003e\n\n\u003ch2 id=\"releases\"\u003eReleases\u003c/h2\u003e\n\n\u003cp\u003eThe FIXED releases are available at the normal locations.\u003c/p\u003e\n\n\u003ch2 id=\"workarounds\"\u003eWorkarounds\u003c/h2\u003e\n\n\u003cp\u003eThere are no feasible workarounds for this issue.\u003c/p\u003e\n\n\u003ch2 id=\"patches\"\u003ePatches\u003c/h2\u003e\n\n\u003cp\u003eTo aid users who aren\u0026#39;t able to upgrade immediately we have provided patches for\u003cbr\u003e\nthe two supported release series. They are in git-am format and consist of a\u003cbr\u003e\nsingle changeset.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e1-0-sanitize_data_attributes.patch - Patch for 1.0 series\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"credits\"\u003eCredits\u003c/h2\u003e\n\n\u003cp\u003eThanks to Ben Murphy and Marien for reporting this\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}