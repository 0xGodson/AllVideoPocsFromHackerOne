{"id":74147,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDE0Nw==","url":"https://hackerone.com/reports/74147","title":"Potential for financial loss, negative Values for \"Buy fee\" and \"Sell Fee\"","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-06T16:12:45.378Z","submitted_at":"2015-07-06T16:12:45.378Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"crab","url":"/crab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-26T20:49:47.993Z","bug_reporter_agreed_on_going_public_at":"2015-10-27T20:49:40.743Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Issue**\r\nIt is possible to set negative values for the Buy Fee and Sell Fee, which will cause unexpected transfers etc. \r\nas these settings override the settings at the location.\r\n\r\n**PoC**\r\n1. Go to the Operator Wallet's Settings.\r\n2. Click on the users tab.\r\n3. Select any user. \r\n4. Go to settings tab of that user.\r\n5. Select any kiosk.\r\n6. Click on Save .Capture the request and set negative values for Sell Fee and Buy Fee.\r\n\r\nTo verify, next time when you try to view these settings, the server responds with the set negative values.\r\n\r\nThanks\r\ncrab","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eIssue\u003c/strong\u003e\u003cbr\u003e\nIt is possible to set negative values for the Buy Fee and Sell Fee, which will cause unexpected transfers etc. \u003cbr\u003e\nas these settings override the settings at the location.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to the Operator Wallet\u0026#39;s Settings.\u003c/li\u003e\n\u003cli\u003eClick on the users tab.\u003c/li\u003e\n\u003cli\u003eSelect any user. \u003c/li\u003e\n\u003cli\u003eGo to settings tab of that user.\u003c/li\u003e\n\u003cli\u003eSelect any kiosk.\u003c/li\u003e\n\u003cli\u003eClick on Save .Capture the request and set negative values for Sell Fee and Buy Fee.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eTo verify, next time when you try to view these settings, the server responds with the set negative values.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\ncrab\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":44083,"file_name":"negative_response.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/044/083/48613d0142a338bd4fb004c86cd99001f75aee56/negative_response.png?response-content-disposition=attachment%3B%20filename%3D%22negative_response.png%22%3B%20filename%2A%3DUTF-8%27%27negative_response.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZJO3526D%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064504Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCIvMo8EBz315uHyZU%2FDG0Huf%2BYKjgYY96exJvyGCLJ6QIgTS1mW%2Fy84%2BDNAkhNbJC8Lysp3409zBR1BXDeS%2BTYRyoqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDEH1nkH4bxOL%2FzZVaiqRAz36Ga68aNU0H93UvEuRIu3bWdCaX174NDGE9HjZ6%2FIGHIDSo8%2BrgJclDinDvb%2Bz5hmDmKwxsZWntb8C077ZNi40vSm3S2BX7TIgKs7OdhHPP26QN5RZDLBCOd0pFTN5ykSL4WFPtakUEHIG05D09oYImqFNistW6N3pBf2hsoRXecWNFI7qMU5wkBMwH2QMBKxqwWAWEAbH6%2Bm%2FxceXV1a8FnL9d8Uhq%2F2Q494%2BZl8MTPuGY7b8f24oQWse7cwMUzvDfqk5TkNfLVSGvrldYvDZ5%2BxCgwagxuwM5onXgbXJ4rRlwsCuZjULhImoKeNv96uim58dbOdKVASQ6GndH5Nrd3tU1KMMgE8wulU71dP4zkXeWt6gi59gtfTvslGO582avOHZUkGIulK7r7JD3t1kTj7U8QaLGPznBskRPSjpug5C4fTdunIrlWgxxYPRSkn61QPQIYfO5cT0HvlOlcuNwaVarnH6q4OXAnE%2BiCH6ODeGHFc%2FbpDT1S1H%2FhTwMOseCmH6rpa9zpdueGS1v945MK%2F9qv8FOusBHn%2BLyL3HJMADkT5J%2FQsL%2Bm415pbG%2FB7sn6BT00QcjPotU4hSnic44MJSPfUmiSKj6d9gLy1f6TEKMFDfJSsENQ%2FaA%2FcWdZKIurcEqINLaFCH7pBgplCMxWUAgnjBUSd4R3H7RrO8ZQbJ3mfz5fAyaFiog5eNoktqTPC5U6knr6J5p0BqQz3pjKkZdFIlUKqlFwECcnX15GzWTOONLY2H8vGW7f3Jzu30NgpDT7w1IP4BRoOJg0NZFk0VVeK%2BYFVc3To9CA8AHQuJZBmtD%2B3SdCh%2FxMl87xH6SWR8e4W2edgavCy2dBUw0YFKbw%3D%3D\u0026X-Amz-Signature=ccb3bd2c5422a9428f6ee2a3b41dd5be1491180f3c62cbaf075e987f16d3c350","file_size":100459,"type":"image/png"}],"allow_singular_disclosure_at":"2015-11-26T20:49:40.854Z","allow_singular_disclosure_after":-160653323.993691,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":500768,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-06T18:03:02.266Z","updated_at":"2015-07-06T18:03:02.266Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":500879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think we've fixed this. Can you retest?","markdown_message":"\u003cp\u003eI think we\u0026#39;ve fixed this. Can you retest?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T18:56:00.468Z","updated_at":"2015-07-06T18:56:00.468Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":500889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its ok (500 internal server error) when any one is negative, but it still works when both are negative.","markdown_message":"\u003cp\u003eIts ok (500 internal server error) when any one is negative, but it still works when both are negative.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:04:56.624Z","updated_at":"2015-07-06T19:04:56.624Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":500901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So you're saying that if one or the other is negative, you get an error. But when both are negative, you don't get the error? Could you maybe send me a cURL request I can use to test with. I'm not seeing that behavior. ","markdown_message":"\u003cp\u003eSo you\u0026#39;re saying that if one or the other is negative, you get an error. But when both are negative, you don\u0026#39;t get the error? Could you maybe send me a cURL request I can use to test with. I\u0026#39;m not seeing that behavior. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:13:24.918Z","updated_at":"2015-07-06T19:13:24.918Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":500912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am using repeater in burp to repeat the request, Sometimes I am getting a 302(that is negative value is being set) and sometimes a 500, in any case, they are alternating I think.","markdown_message":"\u003cp\u003eI am using repeater in burp to repeat the request, Sometimes I am getting a 302(that is negative value is being set) and sometimes a 500, in any case, they are alternating I think.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:23:40.357Z","updated_at":"2015-07-06T19:23:40.357Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":500914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POST /operator/e06904c8-b6f8-4a00-a790-627a6fd02348/user/ba323612-d793-480f-a60e-7f058bbe7f3e HTTP/1.1\nHost: wallet.romit.io\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:37.0) Gecko/20100101 Firefox/37.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://wallet.romit.io/operator/e06904c8-b6f8-4a00-a790-627a6fd02348/user/ba323612-d793-480f-a60e-7f058bbe7f3e\nCookie: _ga=GA1.2.2032096689.1436110907; SESSION=e266a624-37a4-4e21-96c9-a62e5c5144ed; _gat=1\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 248\n\nbankUserId=ba323612-d793-480f-a60e-7f058bbe7f3e\u0026bankAccountId=e06904c8-b6f8-4a00-a790-627a6fd02348\u0026kioskId=068f8be6-f216-4108-91d9-7a59ccabff4d\u0026volumeLimit=4\u0026buyLimit=2\u0026sellLimit=3\u0026buyFee=-0.1\u0026sellFee=0.27\u0026_csrf=a4283e00-edd0-4d71-9e33-1c661d411de2","markdown_message":"\u003cp\u003ePOST /operator/e06904c8-b6f8-4a00-a790-627a6fd02348/user/ba323612-d793-480f-a60e-7f058bbe7f3e HTTP/1.1\u003cbr\u003e\nHost: wallet.romit.io\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:37.0) Gecko/20100101 Firefox/37.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://wallet.romit.io/operator/e06904c8-b6f8-4a00-a790-627a6fd02348/user/ba323612-d793-480f-a60e-7f058bbe7f3e\" href=\"/redirect?url=https%3A%2F%2Fwallet.romit.io%2Foperator%2Fe06904c8-b6f8-4a00-a790-627a6fd02348%2Fuser%2Fba323612-d793-480f-a60e-7f058bbe7f3e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.romit.io/operator/e06904c8-b6f8-4a00-a790-627a6fd02348/user/ba323612-d793-480f-a60e-7f058bbe7f3e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: _ga=GA1.2.2032096689.1436110907; SESSION=e266a624-37a4-4e21-96c9-a62e5c5144ed; _gat=1\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 248\u003c/p\u003e\n\n\u003cp\u003ebankUserId=ba323612-d793-480f-a60e-7f058bbe7f3e\u0026amp;bankAccountId=e06904c8-b6f8-4a00-a790-627a6fd02348\u0026amp;kioskId=068f8be6-f216-4108-91d9-7a59ccabff4d\u0026amp;volumeLimit=4\u0026amp;buyLimit=2\u0026amp;sellLimit=3\u0026amp;buyFee=-0.1\u0026amp;sellFee=0.27\u0026amp;_csrf=a4283e00-edd0-4d71-9e33-1c661d411de2\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:24:07.983Z","updated_at":"2015-07-06T19:24:07.983Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":500918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My bad, I dont know what was happening then, it seems to be fixed now.","markdown_message":"\u003cp\u003eMy bad, I dont know what was happening then, it seems to be fixed now.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:27:32.612Z","updated_at":"2015-07-06T19:27:32.612Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":500920,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-06T19:29:38.439Z","updated_at":"2015-07-06T19:29:38.439Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"crab","url":"/crab"},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":500921,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-06T19:29:52.081Z","updated_at":"2015-07-06T19:29:52.081Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"enter","collaborator":{"username":"crab","url":"/crab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":500948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty","markdown_message":"\u003cp\u003eThanks for the bounty\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-06T19:39:03.171Z","updated_at":"2015-07-06T19:39:03.171Z","actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":634609,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-27T20:49:40.774Z","updated_at":"2015-10-27T20:49:40.774Z","first_to_agree":true,"actor":{"username":"crab","cleared":false,"url":"/crab","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/333/05e3a85c640b2618b06ab1aaff8a51c405717c2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":700330,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-26T20:49:48.027Z","updated_at":"2015-11-26T20:49:48.027Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}