{"id":90690,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDY5MA==","url":"https://hackerone.com/reports/90690","title":"change Login Services settings without owner access","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-27T20:38:00.359Z","submitted_at":"2015-09-27T20:38:00.359Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"supernatural","url":"/supernatural","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-10-14T19:54:09.411Z","bug_reporter_agreed_on_going_public_at":"2015-10-14T19:54:09.189Z","team_member_agreed_on_going_public_at":"2015-10-01T21:06:25.720Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\n\nin settings -\u003e account owner can set login service for staff members!\nthis is only available for owners, and full access admins can't see or change this values!\n\nadmin with setting access can send a \"POST\" request to shop.json and change this settings!\n\n\nsteps:\n\n- get access token for one full access admin (you can send request to xauth or sniff it from mobile device)\n- send request with POST method to \"https://~ShopName~.myshopify.com/admin/shop.json\"\n\ndata:\n\n{\"shop\":{\"google_apps_domain\":\"anydomain\",\"google_apps_login_enabled\":true}}\n\ngoogle_apps_login_enabled\ngoogle_apps_domain\n\n\nso any admin just with setting access can modify this option,this must limited to owner!\n\n","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003ein settings -\u0026gt; account owner can set login service for staff members!\u003cbr\u003e\nthis is only available for owners, and full access admins can\u0026#39;t see or change this values!\u003c/p\u003e\n\n\u003cp\u003eadmin with setting access can send a \u0026quot;POST\u0026quot; request to shop.json and change this settings!\u003c/p\u003e\n\n\u003cp\u003esteps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eget access token for one full access admin (you can send request to xauth or sniff it from mobile device)\u003c/li\u003e\n\u003cli\u003esend request with POST method to \u0026quot;https://~ShopName~.myshopify.com/admin/shop.json\u0026quot;\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003edata:\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;shop\u0026quot;:{\u0026quot;google_apps_domain\u0026quot;:\u0026quot;anydomain\u0026quot;,\u0026quot;google_apps_login_enabled\u0026quot;:true}}\u003c/p\u003e\n\n\u003cp\u003egoogle_apps_login_enabled\u003cbr\u003e\ngoogle_apps_domain\u003c/p\u003e\n\n\u003cp\u003eso any admin just with setting access can modify this option,this must limited to owner!\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-31T21:06:25.912Z","allow_singular_disclosure_after":-162900194.59910542,"singular_disclosure_allowed":true,"vote_count":1,"voters":["spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":599764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us **up to 3 weeks or more** to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us \u003cstrong\u003eup to 3 weeks or more\u003c/strong\u003e to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-09-27T20:38:03.056Z","updated_at":"2015-09-27T20:38:03.056Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":601268,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"web URL is : \n/admin/login_services/google_apps/update\nmethod: PATCH\n\nadmins can't change this value from web, the URL just works for owner\nbut API call will bypass this :)","markdown_message":"\u003cp\u003eweb URL is : \u003cbr\u003e\n/admin/login_services/google_apps/update\u003cbr\u003e\nmethod: PATCH\u003c/p\u003e\n\n\u003cp\u003eadmins can\u0026#39;t change this value from web, the URL just works for owner\u003cbr\u003e\nbut API call will bypass this :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-29T06:58:00.812Z","updated_at":"2015-09-29T06:58:00.812Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":605600,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @pouya, looks like we fixed this vulnerability 2 days ago while fixing a completely separate bug. This was after you reported this vulnerability though, so I will still mark it as Resolved for you. I'll check with my colleagues if this will be eligible for a bounty under these circumstances.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pouya\"\u003e@pouya\u003c/a\u003e, looks like we fixed this vulnerability 2 days ago while fixing a completely separate bug. This was after you reported this vulnerability though, so I will still mark it as Resolved for you. I\u0026#39;ll check with my colleagues if this will be eligible for a bounty under these circumstances.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T19:55:52.265Z","updated_at":"2015-10-01T19:55:52.265Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"supernatural","url":"/supernatural"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":605601,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm that the issue is resolved for you? Only the account owner should be able to POST to shops.json now.","markdown_message":"\u003cp\u003eCan you confirm that the issue is resolved for you? Only the account owner should be able to POST to shops.json now.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T19:56:31.707Z","updated_at":"2015-10-01T19:56:31.707Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":605614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\n\nyeah, issue fixed, and as you mentioned admins can only use GET method! :)\n\nRegards","markdown_message":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003eyeah, issue fixed, and as you mentioned admins can only use GET method! :)\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T20:05:54.146Z","updated_at":"2015-10-01T20:05:54.146Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":605703,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for reporting this vulnerability! As François noted, this vulnerability is resolved.","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability! As François noted, this vulnerability is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T21:06:16.787Z","updated_at":"2015-10-01T21:06:16.787Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"supernatural","url":"/supernatural"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":605704,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-01T21:06:25.743Z","updated_at":"2015-10-01T21:06:25.743Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":605709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty :)","markdown_message":"\u003cp\u003eThanks for the bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-01T21:09:03.248Z","updated_at":"2015-10-01T21:09:03.248Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":620956,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-14T19:54:09.225Z","updated_at":"2015-10-14T19:54:09.225Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":620957,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-14T19:54:09.436Z","updated_at":"2015-10-14T19:54:09.436Z","actor":{"username":"supernatural","cleared":false,"url":"/supernatural","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/099/f48bd7dc0789aca59880c61febe8333d0150bc2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":870,"category":"team","content":"A user of the POS app or any other Shopify mobile application could use their api access token to make requests to a specific API endpoint, which would have allowed them to change the \"shop\" object in a way that bypasses Shopify's permission model. We fixed the issue by adding restrictions to this endpoint, ensuring that only the application owner can make requests, even through the API.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA user of the POS app or any other Shopify mobile application could use their api access token to make requests to a specific API endpoint, which would have allowed them to change the \u0026quot;shop\u0026quot; object in a way that bypasses Shopify\u0026#39;s permission model. We fixed the issue by adding restrictions to this endpoint, ensuring that only the application owner can make requests, even through the API.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}