{"id":264177,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjQxNzc=","url":"https://hackerone.com/reports/264177","title":"XSS when replying / forwarding to a malicious email on iOS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-29T04:14:14.746Z","submitted_at":"2017-08-29T04:14:14.746Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pwnsdx","url":"/pwnsdx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-28T15:04:02.595Z","bug_reporter_agreed_on_going_public_at":"2017-12-28T15:04:02.516Z","team_member_agreed_on_going_public_at":"2017-12-28T14:55:00.137Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nMail.ru for iOS\n\nTesting environment\n--\niOS 10\n\nSteps to reproduce\n--\n1) Send you a mail with something like this in the From field: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw\n\nNote: This is a base64 string of \"\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\"\n\n2) Try to forward or reply to that email.\n\nNote: If you kill the app from the iOS multitask and run it again, the reply / forward will show again, executing one more time the JS code.\n\nActual results\n--\nJS alert with current cookies is shown\n\nExpected results, security impact description and recommendations\n--\nNothing happens\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n\nPayload is: `From: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw`\n\nVideo has been attached.","vulnerability_information_html":"\u003ch2 id=\"domain-site-application\"\u003eDomain, site, application\u003c/h2\u003e\n\n\u003cp\u003eMail.ru for iOS\u003c/p\u003e\n\n\u003ch2 id=\"testing-environment\"\u003eTesting environment\u003c/h2\u003e\n\n\u003cp\u003eiOS 10\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cp\u003e1) Send you a mail with something like this in the From field: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw\u003c/p\u003e\n\n\u003cp\u003eNote: This is a base64 string of \u0026quot;\u0026lt;script\u0026gt;alert(document.cookie)\u0026lt;/script\u0026gt;\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e2) Try to forward or reply to that email.\u003c/p\u003e\n\n\u003cp\u003eNote: If you kill the app from the iOS multitask and run it again, the reply / forward will show again, executing one more time the JS code.\u003c/p\u003e\n\n\u003ch2 id=\"actual-results\"\u003eActual results\u003c/h2\u003e\n\n\u003cp\u003eJS alert with current cookies is shown\u003c/p\u003e\n\n\u003ch2 id=\"expected-results-security-impact-description-and-recommendations\"\u003eExpected results, security impact description and recommendations\u003c/h2\u003e\n\n\u003cp\u003eNothing happens\u003c/p\u003e\n\n\u003ch2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\"\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/h2\u003e\n\n\u003cp\u003ePayload is: \u003ccode\u003eFrom: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eVideo has been attached.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":216633,"file_name":"video-export.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/216/633/fb8f39f96675ffec4c0e4f9de6fb654a7dff24c8/video-export.mov?response-content-disposition=attachment%3B%20filename%3D%22video-export.mov%22%3B%20filename%2A%3DUTF-8%27%27video-export.mov\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPEA4QHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051636Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGXO5frUwVLGFxDWBVmHmNT%2B6JlROQ%2Fh2Ys%2Flt0prcUdAiEArvZZU6vxK8OPvx82Pcq8o33YhSQ8Sp596o4I%2B71KXboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFQ%2Btleyar2CCMIQ%2FiqRA0oRJaH4MzQaTEXIvcYpkTRptMnZ49JBLdqQm33GGvhffjnOoBNIPiTSi6pdezRRKGgr1r4B1IAGIEGp9Era8%2FVjLY%2F84nxA3XI4F09nEgobPjCz6yKQh3VdoZ1avIgB18X6MWbibE7XQhQRHNf12J4W05BmzThHdywp5K3hTdg4KpP7gfvCo%2F4Ktt%2BaXFH811I8QeWjv5pthBCzZLk1JVibgJtAmfExNo%2FtxD14kJX5VoKxRaaBIvOPag6Dr88HIlbNhmmeq6P6UFDhMg9j%2BZBNBeotHBDUM26EuglJC3Do5CNYJ80SHnZOD9OcD4YbxIEIacpSbw2zg1v%2F05gXvDdJmBfg2CZ6M3Oe9RFIGOz7K78vcnthqjsbMkTQtnYm3oSlLsPXOQzsk689VyQIvD%2FvISy3mc%2BR8fkse0nfZ6oo5yVZ1HDkUwyVBrEhVRwgA40ECaneL73yKaXHsGZZNplJZJjpVg7LmiK5cHcw%2BazOBUYiFhWrnigrx9zn8ACMeIxnoLYYF%2FbtR5yKptoMokcKMJrlqv8FOusBX%2FkI%2Bxq9aH44%2FxV%2FlmQ8l6YTA1mqoIeT5eUoTCncJ05WnGa6jf%2FtNIbVh9Bx6I91Z7cvfP3JjmvlVXGM09Nq4G51yOTYLbDJoC0v2WVQiP4QLA0yKhxXdlHnVerT6B%2BXgGwNCiB4w%2Ffx7IW3WkvZS7FvSLvhKxN%2B9Yzbcsj0UDJ9rocF7CIpeIiVb9ydgCK8v%2F9BCTjB%2F%2BHuRrXJoVvGbT4DVZuH1ZXzKIkP77S8Hw4QXRGhfqaoNmjdAKhfZNzKbjD5vOLqlD%2BBKIMWfferNFi8FhO7cNacpti15lmAJ1SKZ1SQQImXMFuysA%3D%3D\u0026X-Amz-Signature=2657c13e5ee10c6c962f077ee167ec4f3654d6c4c5c694b553d01d811d387484","file_size":609455,"type":"video/mp4"}],"allow_singular_disclosure_at":"2018-01-27T14:55:00.240Z","allow_singular_disclosure_after":-92154095.84302789,"singular_disclosure_allowed":true,"vote_count":8,"voters":["pwnsdx","eveeez","luigigubello","khizer47","cr4xerbik4sh","japz","3apa3a","extr4b4n4n4"],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":238,"asset_type":"APPLE_STORE_APP_ID","asset_identifier":"ru.mail.mail","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1961959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Testing environment\n\nOnly iOS 11* sorry, I can try on older versions but should be the same on all versions supported by the app.","markdown_message":"\u003ch2 id=\"testing-environment\"\u003eTesting environment\u003c/h2\u003e\n\n\u003cp\u003eOnly iOS 11* sorry, I can try on older versions but should be the same on all versions supported by the app.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-29T04:15:29.857Z","updated_at":"2017-08-29T04:15:29.857Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1962355,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.\n","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-29T09:07:34.899Z","updated_at":"2017-08-29T09:07:34.899Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1994077,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nCan you demonstrate access to 'Mpop' cookie ?\n\nP.S. we are still working to resolve this problem","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eCan you demonstrate access to \u0026#39;Mpop\u0026#39; cookie ?\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-13T13:17:05.174Z","updated_at":"2017-09-13T13:17:05.174Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"pwnsdx","url":"/pwnsdx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083982,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","markdown_message":"\u003cp\u003eThis bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-19T12:47:47.848Z","updated_at":"2017-10-19T12:47:47.848Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pwnsdx","url":"/pwnsdx"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248629,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-27T16:22:26.261Z","updated_at":"2017-12-27T16:22:26.261Z","additional_data":{"old_severity":"High (8.8)","new_severity":"Medium (5.0)","old_severity_id":71561,"new_severity_id":104191},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2250014,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-28T14:55:00.177Z","updated_at":"2017-12-28T14:55:00.177Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2250026,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello,\n\nSorry for taking so long to answer this repor, I completely missed it. Indeed, I was unable to access the session as it had HttpOnly flag.\n\nRegards,\nSabri","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eSorry for taking so long to answer this repor, I completely missed it. Indeed, I was unable to access the session as it had HttpOnly flag.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nSabri\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-28T15:04:02.545Z","updated_at":"2017-12-28T15:04:02.545Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2250027,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-28T15:04:02.625Z","updated_at":"2017-12-28T15:04:02.625Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6178,"category":"team","content":"It was possible to trigger XSS vulnerability within webview of iOS Mail.Ru Mail application via crafted e-mail address.\nVulnerability doesn't provide direct access to user session or critical data, and considered medium severity due to possible phishing scenarios.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIt was possible to trigger XSS vulnerability within webview of iOS Mail.Ru Mail application via crafted e-mail address.\u003cbr\u003e\nVulnerability doesn\u0026#39;t provide direct access to user session or critical data, and considered medium severity due to possible phishing scenarios.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}