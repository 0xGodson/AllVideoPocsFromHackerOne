{"id":243156,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDMxNTY=","url":"https://hackerone.com/reports/243156","title":"Installing a crafted gem package may create or overwrite files","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-06-26T09:14:48.920Z","submitted_at":"2017-06-26T09:14:48.920Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mame","url":"/mame","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby communityâ€™s gem hosting service."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-0901"],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-31T23:18:39.368Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-08-28T16:42:06.012Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is no check for `name` field in `metadata.gz`.  By assigning a maliciously crafted string like `../../../../../any/where` to the field, an attacker can create an arbitrary file out of the directory of the gem, or even replace an existing file with a malicious file.\n\n## Proof of Concept 1: Create a file anywhere\n\nThis PoC attempts to create a file `/tmp/malicious-0/BOOOOM`.\n\n1) Download the attached file `malicious.gem`.\n2) Run `gem install malicious.gem --no-doc`.\n3) `/tmp/malicious-0/BOOOOM` should be created.\n\n`malicious.gem` assigns `../../../../../../../../../../tmp/malicious` as `name` field.  This attack is relatively weak since the path must include a directory named `\u003cname\u003e-\u003cversion\u003e`, such as `malicious-0`.  Still, there are many chances that cause a catastrophe.  For example, think of replacing a file in `/etc/dbus-1/`.\n\n## Proof of Concept 2: Replace `rackup` command\n\nThis PoC attempts to replace `gems/rack-2.0.3/bin/rackup` with a malicious file.\n\n1) Download the attached file `replace-rackup.gem`.\n2) Run `gem install rack -v 2.0.3`.\n3) Run `gem install replace-rackup.gem --no-doc`.\n4) Run `rackup`.  It will emit just `BOOOOM!`.\n\n`replace-rackup.gem` assigns `../gems/rack` as `name` field, and contains a malicious file `bin/rackup`.  This is really exploitable for attackers.\n\n## Note\n\nFor how to create the malicious gems, see the attached file `src.tar.gz`.\n\nIn my opinion, **this attack is much more dangerous** than the issues I reported recently.  I hope you could fix this issue ASAP.","vulnerability_information_html":"\u003cp\u003eThere is no check for \u003ccode\u003ename\u003c/code\u003e field in \u003ccode\u003emetadata.gz\u003c/code\u003e.  By assigning a maliciously crafted string like \u003ccode\u003e../../../../../any/where\u003c/code\u003e to the field, an attacker can create an arbitrary file out of the directory of the gem, or even replace an existing file with a malicious file.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept-1-create-a-file-anywhere\"\u003eProof of Concept 1: Create a file anywhere\u003c/h2\u003e\n\n\u003cp\u003eThis PoC attempts to create a file \u003ccode\u003e/tmp/malicious-0/BOOOOM\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e1) Download the attached file \u003ccode\u003emalicious.gem\u003c/code\u003e.\u003cbr\u003e\n2) Run \u003ccode\u003egem install malicious.gem --no-doc\u003c/code\u003e.\u003cbr\u003e\n3) \u003ccode\u003e/tmp/malicious-0/BOOOOM\u003c/code\u003e should be created.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emalicious.gem\u003c/code\u003e assigns \u003ccode\u003e../../../../../../../../../../tmp/malicious\u003c/code\u003e as \u003ccode\u003ename\u003c/code\u003e field.  This attack is relatively weak since the path must include a directory named \u003ccode\u003e\u0026lt;name\u0026gt;-\u0026lt;version\u0026gt;\u003c/code\u003e, such as \u003ccode\u003emalicious-0\u003c/code\u003e.  Still, there are many chances that cause a catastrophe.  For example, think of replacing a file in \u003ccode\u003e/etc/dbus-1/\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept-2-replace-rackup-command\"\u003eProof of Concept 2: Replace \u003ccode\u003erackup\u003c/code\u003e command\u003c/h2\u003e\n\n\u003cp\u003eThis PoC attempts to replace \u003ccode\u003egems/rack-2.0.3/bin/rackup\u003c/code\u003e with a malicious file.\u003c/p\u003e\n\n\u003cp\u003e1) Download the attached file \u003ccode\u003ereplace-rackup.gem\u003c/code\u003e.\u003cbr\u003e\n2) Run \u003ccode\u003egem install rack -v 2.0.3\u003c/code\u003e.\u003cbr\u003e\n3) Run \u003ccode\u003egem install replace-rackup.gem --no-doc\u003c/code\u003e.\u003cbr\u003e\n4) Run \u003ccode\u003erackup\u003c/code\u003e.  It will emit just \u003ccode\u003eBOOOOM!\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ereplace-rackup.gem\u003c/code\u003e assigns \u003ccode\u003e../gems/rack\u003c/code\u003e as \u003ccode\u003ename\u003c/code\u003e field, and contains a malicious file \u003ccode\u003ebin/rackup\u003c/code\u003e.  This is really exploitable for attackers.\u003c/p\u003e\n\n\u003ch2 id=\"note\"\u003eNote\u003c/h2\u003e\n\n\u003cp\u003eFor how to create the malicious gems, see the attached file \u003ccode\u003esrc.tar.gz\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIn my opinion, \u003cstrong\u003ethis attack is much more dangerous\u003c/strong\u003e than the issues I reported recently.  I hope you could fix this issue ASAP.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":197576,"file_name":"src.tar.gz","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/197/576/f644ee200cb7c42b92d5167f60cdaafff78895dc/src.tar.gz?response-content-disposition=attachment%3B%20filename%3D%22src.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27src.tar.gz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050857Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=ddca254e013611bc5bc382af50062311625017fa7a027009242dadcef8f84bde","file_size":1330,"type":"application/gzip"},{"id":197577,"file_name":"create-file.gem","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/197/577/ed0a95dae139d74ceb75725ea0c65945a535e719/create-file.gem?response-content-disposition=attachment%3B%20filename%3D%22create-file.gem%22%3B%20filename%2A%3DUTF-8%27%27create-file.gem\u0026response-content-type=application%2Fx-tar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050857Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=5c9159b1b8d7d68438ca7c9bd2543862e7ad18583acefe3ce8f0102dd0ea3395","file_size":10240,"type":"application/x-tar"},{"id":197578,"file_name":"replace-rackup.gem","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/197/578/36ab22bc7882a9d315d2944830191bf7c6ade6b0/replace-rackup.gem?response-content-disposition=attachment%3B%20filename%3D%22replace-rackup.gem%22%3B%20filename%2A%3DUTF-8%27%27replace-rackup.gem\u0026response-content-type=application%2Fx-tar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050857Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=0516d3b4f4e554d09473bd27993a66e65d0e24111c98f41d38bfe28d345ad19b","file_size":10240,"type":"application/x-tar"}],"allow_singular_disclosure_at":"2017-09-27T16:42:06.080Z","allow_singular_disclosure_after":-102688011.6575169,"singular_disclosure_allowed":true,"vote_count":11,"voters":["bl4de","ysx","fa1rlight","bugdiscloseguys","eveeez","c1231665","ykw1337","arifmkhls","martijn","deije","and 1 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1780200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-06-26T09:14:49.166Z","updated_at":"2017-06-26T09:14:49.166Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1797653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To make sure: `gem install replace-rackup.gem` does not simply install a new `rackup` command, but actually overwrites the existing `rackup` command **without prompt**.  I'd like you to check this issue ASAP.","markdown_message":"\u003cp\u003eTo make sure: \u003ccode\u003egem install replace-rackup.gem\u003c/code\u003e does not simply install a new \u003ccode\u003erackup\u003c/code\u003e command, but actually overwrites the existing \u003ccode\u003erackup\u003c/code\u003e command \u003cstrong\u003ewithout prompt\u003c/strong\u003e.  I\u0026#39;d like you to check this issue ASAP.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-02T13:18:55.983Z","updated_at":"2017-07-02T13:18:55.983Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe this should fix both issues, though it requires test coverage:\n\n```diff\ndiff --git a/lib/rubygems/installer.rb b/lib/rubygems/installer.rb\nindex 913db819..de169240 100644\n--- a/lib/rubygems/installer.rb\n+++ b/lib/rubygems/installer.rb\n@@ -700,6 +700,12 @@ class Gem::Installer\n       unpack or File.writable?(gem_home)\n   end\n \n+  def verify_spec_name\n+    illegal_characters = spec.name.scan(Regexp.union(File::SEPARATOR)).uniq\n+    return if illegal_characters.empty?\n+    raise Gem::InstallError, \"#{spec} contains illegal characters in its name #{illegal_characters.inspect}\"\n+  end\n+\n   ##\n   # Return the text for an application file.\n \n@@ -826,6 +832,8 @@ TEXT\n \n     ensure_loadable_spec\n \n+    verify_spec_name\n+\n     if options[:install_as_default]\n       Gem.ensure_default_gem_subdirectories gem_home\n     else\n```","markdown_message":"\u003cp\u003eI believe this should fix both issues, though it requires test coverage:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/rubygems/installer.rb b/lib/rubygems/installer.rb\nindex 913db819..de169240 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/installer.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/installer.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -700,6 +700,12 @@\u003c/span\u003e class Gem::Installer\n       unpack or File.writable?(gem_home)\n   end\n\n+  def verify_spec_name\n\u003cspan class=\"gi\"\u003e+    illegal_characters = spec.name.scan(Regexp.union(File::SEPARATOR)).uniq\n+    return if illegal_characters.empty?\n+    raise Gem::InstallError, \u0026quot;#{spec} contains illegal characters in its name #{illegal_characters.inspect}\u0026quot;\n+  end\n+\n\u003c/span\u003e   ##\n   # Return the text for an application file.\n\n@@ -826,6 +832,8 @@ TEXT\n\n     ensure_loadable_spec\n\n+    verify_spec_name\n\u003cspan class=\"gi\"\u003e+\n\u003c/span\u003e     if options[:install_as_default]\n       Gem.ensure_default_gem_subdirectories gem_home\n     else\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-07-03T12:22:21.562Z","updated_at":"2017-07-03T12:23:07.719Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1799252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Below, I have a patch with test coverage for validating the package when installing, as well as validating the name in the gemspec which should make unintentional errors more discoverable:\n\n```diff\ndiff --git a/lib/rubygems/installer.rb b/lib/rubygems/installer.rb\nindex 913db819..a04fc354 100644\n--- a/lib/rubygems/installer.rb\n+++ b/lib/rubygems/installer.rb\n@@ -700,6 +700,11 @@ class Gem::Installer\n       unpack or File.writable?(gem_home)\n   end\n \n+  def verify_spec_name\n+    return if spec.name =~ Gem::Specification::VALID_NAME_PATTERN\n+    raise Gem::InstallError, \"#{spec} has an invalid name\"\n+  end\n+\n   ##\n   # Return the text for an application file.\n \n@@ -826,6 +831,8 @@ TEXT\n \n     ensure_loadable_spec\n \n+    verify_spec_name\n+\n     if options[:install_as_default]\n       Gem.ensure_default_gem_subdirectories gem_home\n     else\ndiff --git a/lib/rubygems/specification.rb b/lib/rubygems/specification.rb\nindex 2b3eb3e3..13039566 100644\n--- a/lib/rubygems/specification.rb\n+++ b/lib/rubygems/specification.rb\n@@ -108,6 +108,8 @@ class Gem::Specification \u003c Gem::BasicSpecification\n \n   private_constant :LOAD_CACHE if defined? private_constant\n \n+  VALID_NAME_PATTERN = /\\A[a-zA-Z0-9\\.\\-\\_]+\\z/ # :nodoc:\n+\n   # :startdoc:\n \n   ##\n@@ -2698,9 +2700,15 @@ class Gem::Specification \u003c Gem::BasicSpecification\n       end\n     end\n \n-    unless String === name then\n+    if !name.is_a?(String) then\n+      raise Gem::InvalidSpecificationException,\n+            \"invalid value for attribute name: \\\"#{name.inspect}\\\" must be a string\"\n+    elsif name !~ /[a-zA-Z]/ then\n+      raise Gem::InvalidSpecificationException,\n+            \"invalid value for attribute name: #{name.dump} must include at least one letter\"\n+    elsif name !~ VALID_NAME_PATTERN then\n       raise Gem::InvalidSpecificationException,\n-            \"invalid value for attribute name: \\\"#{name.inspect}\\\"\"\n+            \"invalid value for attribute name: #{name.dump} can only include letters, numbers, dashes, and underscores\"\n     end\n \n     if raw_require_paths.empty? then\ndiff --git a/test/rubygems/test_gem_installer.rb b/test/rubygems/test_gem_installer.rb\nindex f941c240..39095c7d 100644\n--- a/test/rubygems/test_gem_installer.rb\n+++ b/test/rubygems/test_gem_installer.rb\n@@ -1450,6 +1450,26 @@ gem 'other', version\n     end\n   end\n \n+  def test_pre_install_checks_malicious_name\n+    spec = util_spec '../malicious', '1'\n+    def spec.full_name # so the spec is buildable\n+      \"malicious-1\"\n+    end\n+    def spec.validate; end\n+\n+    util_build_gem spec\n+\n+    gem = File.join(@gemhome, 'cache', spec.file_name)\n+\n+    use_ui @ui do\n+      @installer = Gem::Installer.at gem\n+      e = assert_raises Gem::InstallError do\n+        @installer.pre_install_checks\n+      end\n+      assert_equal '#\u003cGem::Specification name=../malicious version=1\u003e has an invalid name', e.message\n+    end\n+  end\n+\n   def test_shebang\n     util_make_exec @spec, \"#!/usr/bin/ruby\"\n \ndiff --git a/test/rubygems/test_gem_specification.rb b/test/rubygems/test_gem_specification.rb\nindex ae39a6d0..bb6acbc7 100644\n--- a/test/rubygems/test_gem_specification.rb\n+++ b/test/rubygems/test_gem_specification.rb\n@@ -3014,7 +3014,37 @@ Did you mean 'Ruby'?\n       @a1.validate\n     end\n \n-    assert_equal 'invalid value for attribute name: \":json\"', e.message\n+    assert_equal 'invalid value for attribute name: \":json\" must be a string', e.message\n+\n+    @a1.name = []\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \"invalid value for attribute name: \\\"[]\\\" must be a string\", e.message\n+\n+    @a1.name = \"\"\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \"invalid value for attribute name: \\\"\\\" must include at least one letter\", e.message\n+\n+    @a1.name = \"12345\"\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \"invalid value for attribute name: \\\"12345\\\" must include at least one letter\", e.message\n+\n+    @a1.name = \"../malicious\"\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \"invalid value for attribute name: \\\"../malicious\\\" can only include letters, numbers, dashes, and underscores\", e.message\n+\n+    @a1.name = \"\\ba\\t\"\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \"invalid value for attribute name: \\\"\\\\ba\\\\t\\\" can only include letters, numbers, dashes, and underscores\", e.message\n   end\n \n   def test_validate_non_nil\n\n```","markdown_message":"\u003cp\u003eBelow, I have a patch with test coverage for validating the package when installing, as well as validating the name in the gemspec which should make unintentional errors more discoverable:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/rubygems/installer.rb b/lib/rubygems/installer.rb\nindex 913db819..a04fc354 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/installer.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/installer.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -700,6 +700,11 @@\u003c/span\u003e class Gem::Installer\n       unpack or File.writable?(gem_home)\n   end\n\n+  def verify_spec_name\n\u003cspan class=\"gi\"\u003e+    return if spec.name =~ Gem::Specification::VALID_NAME_PATTERN\n+    raise Gem::InstallError, \u0026quot;#{spec} has an invalid name\u0026quot;\n+  end\n+\n\u003c/span\u003e   ##\n   # Return the text for an application file.\n\n@@ -826,6 +831,8 @@ TEXT\n\n     ensure_loadable_spec\n\n+    verify_spec_name\n\u003cspan class=\"gi\"\u003e+\n\u003c/span\u003e     if options[:install_as_default]\n       Gem.ensure_default_gem_subdirectories gem_home\n     else\n\u003cspan class=\"gh\"\u003ediff --git a/lib/rubygems/specification.rb b/lib/rubygems/specification.rb\nindex 2b3eb3e3..13039566 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/specification.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/specification.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -108,6 +108,8 @@\u003c/span\u003e class Gem::Specification \u0026lt; Gem::BasicSpecification\n\n   private_constant :LOAD_CACHE if defined? private_constant\n\n+  VALID_NAME_PATTERN = /\\A[a-zA-Z0-9\\.\\-\\_]+\\z/ # :nodoc:\n\u003cspan class=\"gi\"\u003e+\n\u003c/span\u003e   # :startdoc:\n\n   ##\n\u003cspan class=\"p\"\u003e@@ -2698,9 +2700,15 @@\u003c/span\u003e class Gem::Specification \u0026lt; Gem::BasicSpecification\n       end\n     end\n\n-    unless String === name then\n\u003cspan class=\"gi\"\u003e+    if !name.is_a?(String) then\n+      raise Gem::InvalidSpecificationException,\n+            \u0026quot;invalid value for attribute name: \\\u0026quot;#{name.inspect}\\\u0026quot; must be a string\u0026quot;\n+    elsif name !~ /[a-zA-Z]/ then\n+      raise Gem::InvalidSpecificationException,\n+            \u0026quot;invalid value for attribute name: #{name.dump} must include at least one letter\u0026quot;\n+    elsif name !~ VALID_NAME_PATTERN then\n\u003c/span\u003e       raise Gem::InvalidSpecificationException,\n\u003cspan class=\"gd\"\u003e-            \u0026quot;invalid value for attribute name: \\\u0026quot;#{name.inspect}\\\u0026quot;\u0026quot;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+            \u0026quot;invalid value for attribute name: #{name.dump} can only include letters, numbers, dashes, and underscores\u0026quot;\n\u003c/span\u003e     end\n\n     if raw_require_paths.empty? then\n\u003cspan class=\"gh\"\u003ediff --git a/test/rubygems/test_gem_installer.rb b/test/rubygems/test_gem_installer.rb\nindex f941c240..39095c7d 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_installer.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_installer.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -1450,6 +1450,26 @@\u003c/span\u003e gem \u0026#39;other\u0026#39;, version\n     end\n   end\n\n+  def test_pre_install_checks_malicious_name\n\u003cspan class=\"gi\"\u003e+    spec = util_spec \u0026#39;../malicious\u0026#39;, \u0026#39;1\u0026#39;\n+    def spec.full_name # so the spec is buildable\n+      \u0026quot;malicious-1\u0026quot;\n+    end\n+    def spec.validate; end\n+\n+    util_build_gem spec\n+\n+    gem = File.join(@gemhome, \u0026#39;cache\u0026#39;, spec.file_name)\n+\n+    use_ui @ui do\n+      @installer = Gem::Installer.at gem\n+      e = assert_raises Gem::InstallError do\n+        @installer.pre_install_checks\n+      end\n+      assert_equal \u0026#39;#\u0026lt;Gem::Specification name=../malicious version=1\u0026gt; has an invalid name\u0026#39;, e.message\n+    end\n+  end\n+\n\u003c/span\u003e   def test_shebang\n     util_make_exec @spec, \u0026quot;#!/usr/bin/ruby\u0026quot;\n\ndiff --git a/test/rubygems/test_gem_specification.rb b/test/rubygems/test_gem_specification.rb\n\u003cspan class=\"gh\"\u003eindex ae39a6d0..bb6acbc7 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/test/rubygems/test_gem_specification.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/test/rubygems/test_gem_specification.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -3014,7 +3014,37 @@\u003c/span\u003e Did you mean \u0026#39;Ruby\u0026#39;?\n       @a1.validate\n     end\n\n-    assert_equal \u0026#39;invalid value for attribute name: \u0026quot;:json\u0026quot;\u0026#39;, e.message\n\u003cspan class=\"gi\"\u003e+    assert_equal \u0026#39;invalid value for attribute name: \u0026quot;:json\u0026quot; must be a string\u0026#39;, e.message\n+\n+    @a1.name = []\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \u0026quot;invalid value for attribute name: \\\u0026quot;[]\\\u0026quot; must be a string\u0026quot;, e.message\n+\n+    @a1.name = \u0026quot;\u0026quot;\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \u0026quot;invalid value for attribute name: \\\u0026quot;\\\u0026quot; must include at least one letter\u0026quot;, e.message\n+\n+    @a1.name = \u0026quot;12345\u0026quot;\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \u0026quot;invalid value for attribute name: \\\u0026quot;12345\\\u0026quot; must include at least one letter\u0026quot;, e.message\n+\n+    @a1.name = \u0026quot;../malicious\u0026quot;\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \u0026quot;invalid value for attribute name: \\\u0026quot;../malicious\\\u0026quot; can only include letters, numbers, dashes, and underscores\u0026quot;, e.message\n+\n+    @a1.name = \u0026quot;\\ba\\t\u0026quot;\n+    e = assert_raises Gem::InvalidSpecificationException do\n+      @a1.validate\n+    end\n+    assert_equal \u0026quot;invalid value for attribute name: \\\u0026quot;\\\\ba\\\\t\\\u0026quot; can only include letters, numbers, dashes, and underscores\u0026quot;, e.message\n\u003c/span\u003e   end\n\n   def test_validate_non_nil\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-07-03T13:12:24.134Z","updated_at":"2017-07-03T13:12:24.134Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1802713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mame can you confirm if this patch fixes the issue?","markdown_message":"\u003cp\u003e\u003ca href=\"/mame\"\u003e@mame\u003c/a\u003e can you confirm if this patch fixes the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-04T21:51:29.715Z","updated_at":"2017-07-04T21:51:29.715Z","actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1956254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I confirmed that it fixes the issue.  Also, I confirmed that it allows some of my gems whose name is strange, such as [`_`](http://rubygems.org/gems/_) and [`1234567890_`](https://rubygems.org/gems/1234567890_).\n\n Thank you and sorry for the late reply!","markdown_message":"\u003cp\u003eI confirmed that it fixes the issue.  Also, I confirmed that it allows some of my gems whose name is strange, such as \u003ca href=\"/redirect?url=http%3A%2F%2Frubygems.org%2Fgems%2F_\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003e_\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Frubygems.org%2Fgems%2F1234567890_\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003e1234567890_\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThank you and sorry for the late reply!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-26T00:47:27.131Z","updated_at":"2017-08-26T00:47:27.131Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1958769,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fix released in http://blog.rubygems.org/2017/08/27/2.6.13-released.html","markdown_message":"\u003cp\u003eFix released in \u003ca title=\"http://blog.rubygems.org/2017/08/27/2.6.13-released.html\" href=\"/redirect?url=http%3A%2F%2Fblog.rubygems.org%2F2017%2F08%2F27%2F2.6.13-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.rubygems.org/2017/08/27/2.6.13-released.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-28T02:09:12.250Z","updated_at":"2017-08-28T02:09:12.250Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mame","url":"/mame"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1960608,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T16:42:06.040Z","updated_at":"2017-08-28T16:42:06.040Z","first_to_agree":true,"actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967699,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T23:25:29.723Z","updated_at":"2017-08-30T23:25:29.723Z","cve_ids":["CVE-2017-0901"],"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967701,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your report! Based on the [guidelines posted on the RubyGems HackerOne project](https://hackerone.com/rubygems), this report is considered medium impact: allows likely remote code execution, but does not guarantee it. ","markdown_message":"\u003cp\u003eThank you for your report! Based on the \u003ca href=\"https://hackerone.com/rubygems\"\u003eguidelines posted on the RubyGems HackerOne project\u003c/a\u003e, this report is considered medium impact: allows likely remote code execution, but does not guarantee it. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-30T23:29:44.061Z","updated_at":"2017-08-30T23:36:09.277Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rubygems","collaborator":{"username":"mame","url":"/mame"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967707,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T23:33:42.489Z","updated_at":"2017-08-30T23:33:42.489Z","additional_data":{"old_severity":"Critical (9.0)","new_severity":"Medium","old_severity_id":53674,"new_severity_id":72217},"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967708,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T23:34:45.563Z","updated_at":"2017-08-30T23:34:45.563Z","additional_data":{"old_severity":"Medium","new_severity":"High","old_severity_id":72217,"new_severity_id":72218},"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1969957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree to disclose this ticket.  Thank you very much!","markdown_message":"\u003cp\u003eI agree to disclose this ticket.  Thank you very much!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-31T23:17:55.581Z","updated_at":"2017-08-31T23:17:55.581Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969960,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-31T23:18:39.341Z","updated_at":"2017-08-31T23:18:39.341Z","actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}