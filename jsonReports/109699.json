{"id":109699,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk2OTk=","url":"https://hackerone.com/reports/109699","title":"Subdomain Takeover in http://assets.goubiquiti.com/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-10T10:10:43.037Z","submitted_at":"2016-01-10T10:10:43.037Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"c1231665","url":"/c1231665","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/043/851/ca6404ac117ffd9ea12252cf87a0103ce8d16b87_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-14T23:30:37.820Z","bug_reporter_agreed_on_going_public_at":"2016-01-15T23:30:35.868Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\n\nIts urgent issue about your subdomain http://assets.goubiquiti.com pointing to AWS S3 but no such website configuration is made. This unused subdomain can claim by anyone and fully take over it.\n\nAn attacker can fully takeover this subdomain and do whatever he wants. this can cause huge damage to the website's main domain as well as to the company.\n\nI Recommend to remove the Cname and Dns connecting to it. \nPoC is attached to this report.\n\nYou can read about this sort of attacks here : http://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\n\nPlease Consider my report to Support my study\n\ncheers,\n\nKarl\n","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eIts urgent issue about your subdomain \u003ca title=\"http://assets.goubiquiti.com\" href=\"/redirect?url=http%3A%2F%2Fassets.goubiquiti.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://assets.goubiquiti.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e pointing to AWS S3 but no such website configuration is made. This unused subdomain can claim by anyone and fully take over it.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can fully takeover this subdomain and do whatever he wants. this can cause huge damage to the website\u0026#39;s main domain as well as to the company.\u003c/p\u003e\n\n\u003cp\u003eI Recommend to remove the Cname and Dns connecting to it. \u003cbr\u003e\nPoC is attached to this report.\u003c/p\u003e\n\n\u003cp\u003eYou can read about this sort of attacks here : \u003ca title=\"http://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\" href=\"/redirect?url=http%3A%2F%2Flabs.detectify.com%2Fpost%2F109964122636%2Fhostile-subdomain-takeover-using\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease Consider my report to Support my study\u003c/p\u003e\n\n\u003cp\u003echeers,\u003c/p\u003e\n\n\u003cp\u003eKarl\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":68682,"file_name":"CName.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/068/682/9b5fb5aaf37175d3cef233d9fc612930ea9fc5b1/CName.png?response-content-disposition=attachment%3B%20filename%3D%22CName.png%22%3B%20filename%2A%3DUTF-8%27%27CName.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZT5T356C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041557Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBcsqzm4YMyykC8pKAfuq22D6bSOUdyHaa8fIa4mUQhAAiEAiwPORMjouAw3a3uzUTZC%2BINQcpZp97MOQsVELFW4zLYqtAMIUBABGgwwMTM2MTkyNzQ4NDkiDKDiVMmiMU9V%2FMrmWyqRA4sIGIrOpHyvVZfmW2jMtAM8T%2B3ge7R5BW4DZ%2F780qW3KhtUb%2BlN4eJRg5WRaAT1yVb84a%2FkYNxsJD%2FuSvAe1wqOnVhU6s2QkIgwao%2BmXWZI5Gv75IeDf5AKwwqIEXhO%2BTfJ7qch1s5pk6yRn5dlzyaRdvpwfit2B%2BnXtVL4Ks0Z%2BsF2L1Sb9lQIKC%2FyiIIKOMM1XnEe09NuSw7Xf8Y6UOJpBJj7jLlVUmTMlaXhg0X5owu1jllReuJ1Ofketv8kjZlScgELVQhqeic8VvMdQFPk7uIxbwdUxI2D8U0mLOURF82HqwOSOvz3AjdFiUL5rInys31EjL5eLGhJJbviiWW1U6yAdtVgX5Dl9fG5sndUapgZ6tOzi5c%2FKiIqcs6TFB7V%2Ba94pbfE0ADF3Y25zJTundlOhWYZvSXJ2UVXh75JBOJYxsTgwZ5UgbsU6QjjUdK4ipM4ELoinryh%2FjoKyVb8ZjECBbMYtE22GC3vCLw7DmthiFcvoOPlRvKlah04sJNQ7b9KklIYWOG8BUX0xWhiMIC6qf8FOusB8i%2B4NEipXflNQqWCERI653SNHefieJr6qXk8vUjlyfvLnR2tXIQ%2FWyHufZZf0Rg4hKv79dttIkGWWsjFWimwSTHN9mTNskp6X9ZC4gvqOEnXuOZx%2Bxs2%2BUbYrNxuALH8x%2F%2FpM%2Fh0c4yBQF6OpSWOrWsdl5H%2BUIYyT8bSyRmCqToj58jXSS6GdhErBYuWCR9lbvOawRSwbxWyEGwvrNZPVRFC6gFj0nD1QwcZcdcCocD0zhQwtFu6F4LHGlpDLS8voy4%2BpFMo9RuKO1foe47wef9OHTulwBbLQCigHgaQeH2Lh7CupMWFI4rneA%3D%3D\u0026X-Amz-Signature=773034dab16b387003c80056f9c5c7ed720f26b9053def5b3db357097c03ad4b","file_size":3487,"type":"image/png"},{"id":68683,"file_name":"goubiquiti.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/068/683/1134f0cd6eace5775c4dee414a046108fde2e816/goubiquiti.png?response-content-disposition=attachment%3B%20filename%3D%22goubiquiti.png%22%3B%20filename%2A%3DUTF-8%27%27goubiquiti.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZT5T356C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041557Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBcsqzm4YMyykC8pKAfuq22D6bSOUdyHaa8fIa4mUQhAAiEAiwPORMjouAw3a3uzUTZC%2BINQcpZp97MOQsVELFW4zLYqtAMIUBABGgwwMTM2MTkyNzQ4NDkiDKDiVMmiMU9V%2FMrmWyqRA4sIGIrOpHyvVZfmW2jMtAM8T%2B3ge7R5BW4DZ%2F780qW3KhtUb%2BlN4eJRg5WRaAT1yVb84a%2FkYNxsJD%2FuSvAe1wqOnVhU6s2QkIgwao%2BmXWZI5Gv75IeDf5AKwwqIEXhO%2BTfJ7qch1s5pk6yRn5dlzyaRdvpwfit2B%2BnXtVL4Ks0Z%2BsF2L1Sb9lQIKC%2FyiIIKOMM1XnEe09NuSw7Xf8Y6UOJpBJj7jLlVUmTMlaXhg0X5owu1jllReuJ1Ofketv8kjZlScgELVQhqeic8VvMdQFPk7uIxbwdUxI2D8U0mLOURF82HqwOSOvz3AjdFiUL5rInys31EjL5eLGhJJbviiWW1U6yAdtVgX5Dl9fG5sndUapgZ6tOzi5c%2FKiIqcs6TFB7V%2Ba94pbfE0ADF3Y25zJTundlOhWYZvSXJ2UVXh75JBOJYxsTgwZ5UgbsU6QjjUdK4ipM4ELoinryh%2FjoKyVb8ZjECBbMYtE22GC3vCLw7DmthiFcvoOPlRvKlah04sJNQ7b9KklIYWOG8BUX0xWhiMIC6qf8FOusB8i%2B4NEipXflNQqWCERI653SNHefieJr6qXk8vUjlyfvLnR2tXIQ%2FWyHufZZf0Rg4hKv79dttIkGWWsjFWimwSTHN9mTNskp6X9ZC4gvqOEnXuOZx%2Bxs2%2BUbYrNxuALH8x%2F%2FpM%2Fh0c4yBQF6OpSWOrWsdl5H%2BUIYyT8bSyRmCqToj58jXSS6GdhErBYuWCR9lbvOawRSwbxWyEGwvrNZPVRFC6gFj0nD1QwcZcdcCocD0zhQwtFu6F4LHGlpDLS8voy4%2BpFMo9RuKO1foe47wef9OHTulwBbLQCigHgaQeH2Lh7CupMWFI4rneA%3D%3D\u0026X-Amz-Signature=45f3e6ca834e33968a45a0e5d0db929f56dae6bfb11a89555c65eff34261058b","file_size":79346,"type":"image/png"}],"allow_singular_disclosure_at":"2016-02-14T23:30:35.981Z","allow_singular_disclosure_after":-153722721.40568748,"singular_disclosure_allowed":true,"vote_count":14,"voters":["mygf","cuso4","madrobot","harry_mg","c1231665","japz","cccaaasser","spetr0x","filepicker","hackworld","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":754794,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report.\n\nGetting an error when navigating to a subdomain does not necessarily mean that the subdomain is vulnerable to a takeover. Can you show that assets.goubiquiti.com is actually vulnerable to domain takeover?\n\nThank and good luck in your future bug hunting. \n","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eGetting an error when navigating to a subdomain does not necessarily mean that the subdomain is vulnerable to a takeover. Can you show that assets.goubiquiti.com is actually vulnerable to domain takeover?\u003c/p\u003e\n\n\u003cp\u003eThank and good luck in your future bug hunting. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-12T15:18:27.564Z","updated_at":"2016-01-12T15:18:27.564Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":755688,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Thank you for the response.\n\nActually, in this situation the reason of the error is due to CNAME of the assets.goubiquiti.com-DNS-Entry.\n\n In connection to it these are the rules for how CNAMEs to S3 are working currently:\n\n\n    Customizing Amazon S3 URLs with CNAMEs\n\n    Depending on your needs, you might not want \"s3.amazonaws.com\" to appear on your website or service. For example, if you host your website images on Amazon S3, you might prefer http://images.johnsmith.net/ instead of http://johnsmith-images.s3.amazonaws.com/.\n\n    The bucket name must be the same as the CNAME. So http://images.johnsmith.net/filename would be the same as http://images.johnsmith.net.s3.amazonaws.com/filename if a CNAME were created to map images.johnsmith.net to images.johnsmith.net.s3.amazonaws.com.\n\nSo what happens here is actually that, since assets.goubiquiti.com is pointing to S3, S3 is actually checking if there's a bucket or webpage configuration with that name. Which in this case the webpage configuration is absent. \n\nYou should immediately remove the DNS-entry for assets.goubiquiti.com pointing to AWS S3.\n\nYou can read about this sort of attacks here : http://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\n\nHope this will help you understand my report\n\nPlease consider this report to support my Study\n\nThank you,\n\nKarl","markdown_message":"\u003cp\u003eThank you for the response.\u003c/p\u003e\n\n\u003cp\u003eActually, in this situation the reason of the error is due to CNAME of the assets.goubiquiti.com-DNS-Entry.\u003c/p\u003e\n\n\u003cp\u003eIn connection to it these are the rules for how CNAMEs to S3 are working currently:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCustomizing Amazon S3 URLs with CNAMEs\n\nDepending on your needs, you might not want \u0026quot;s3.amazonaws.com\u0026quot; to appear on your website or service. For example, if you host your website images on Amazon S3, you might prefer http://images.johnsmith.net/ instead of http://johnsmith-images.s3.amazonaws.com/.\n\nThe bucket name must be the same as the CNAME. So http://images.johnsmith.net/filename would be the same as http://images.johnsmith.net.s3.amazonaws.com/filename if a CNAME were created to map images.johnsmith.net to images.johnsmith.net.s3.amazonaws.com.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo what happens here is actually that, since assets.goubiquiti.com is pointing to S3, S3 is actually checking if there\u0026#39;s a bucket or webpage configuration with that name. Which in this case the webpage configuration is absent. \u003c/p\u003e\n\n\u003cp\u003eYou should immediately remove the DNS-entry for assets.goubiquiti.com pointing to AWS S3.\u003c/p\u003e\n\n\u003cp\u003eYou can read about this sort of attacks here : \u003ca title=\"http://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\" href=\"/redirect?url=http%3A%2F%2Flabs.detectify.com%2Fpost%2F109964122636%2Fhostile-subdomain-takeover-using\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHope this will help you understand my report\u003c/p\u003e\n\n\u003cp\u003ePlease consider this report to support my Study\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003c/p\u003e\n\n\u003cp\u003eKarl\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-13T02:31:56.422Z","updated_at":"2016-01-13T02:31:56.422Z","actor":{"username":"c1231665","cleared":true,"url":"/c1231665","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/851/ca6404ac117ffd9ea12252cf87a0103ce8d16b87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":758131,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for the additional information. \n\nWhen reviewing the results of MXToolbox, [here](http://mxtoolbox.com/SuperTool.aspx?action=cname%3aassets.goubiquiti.com\u0026run=toolpage), we see that the CNAME of assets.goubiquiti.com is uwn-images.s3-website-us-west-1.amazonaws.com, and it appears to be resolving correctly. If you're able to demonstrate a sub-domian take over, based on the Amazon S3 configuration that you've described, please let us know. Otherwise, I'm afraid this issue doesn't qualify for a reward under this program. \n\nThanks and good luck in your future bug hunting. ","markdown_message":"\u003cp\u003eThank you for the additional information. \u003c/p\u003e\n\n\u003cp\u003eWhen reviewing the results of MXToolbox, \u003ca href=\"/redirect?url=http%3A%2F%2Fmxtoolbox.com%2FSuperTool.aspx%3Faction%3Dcname%253aassets.goubiquiti.com%26run%3Dtoolpage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, we see that the CNAME of assets.goubiquiti.com is uwn-images.s3-website-us-west-1.amazonaws.com, and it appears to be resolving correctly. If you\u0026#39;re able to demonstrate a sub-domian take over, based on the Amazon S3 configuration that you\u0026#39;ve described, please let us know. Otherwise, I\u0026#39;m afraid this issue doesn\u0026#39;t qualify for a reward under this program. \u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-14T19:18:12.969Z","updated_at":"2016-01-14T19:18:12.969Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":759715,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the submission... I have fixed this. Let me know if you still see it!","markdown_message":"\u003cp\u003eThanks for the submission... I have fixed this. Let me know if you still see it!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-15T18:28:21.417Z","updated_at":"2016-01-15T18:28:21.417Z","actor":{"username":"ubnt-matt","cleared":false,"url":"/ubnt-matt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"c1231665","url":"/c1231665"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":759716,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-15T18:28:29.463Z","updated_at":"2016-01-15T18:28:29.463Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"c1231665","url":"/c1231665"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":760151,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I can confirm it's already fixed !\nThanks for the Bounty !","markdown_message":"\u003cp\u003eI can confirm it\u0026#39;s already fixed !\u003cbr\u003e\nThanks for the Bounty !\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-15T23:30:35.888Z","updated_at":"2016-01-15T23:31:49.350Z","first_to_agree":true,"actor":{"username":"c1231665","cleared":true,"url":"/c1231665","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/851/ca6404ac117ffd9ea12252cf87a0103ce8d16b87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":797799,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-14T23:30:37.842Z","updated_at":"2016-02-14T23:30:37.842Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}