{"id":510043,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTAwNDM=","url":"https://hackerone.com/reports/510043","title":"[serve] Path Traversal","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-15T09:29:19.523Z","submitted_at":"2019-03-15T09:29:19.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"johnssimon007","url":"/johnssimon007","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39174,"url":"https://hackerone.com/vercel","handle":"vercel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vercel","twitter_handle":"vercel","website":"https://vercel.com","about":"Creators of Next.js - Vercel is the platform for developing, previewing, and shipping Jamstack sites."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-03T16:55:25.281Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-03T16:55:23.973Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report path traversal vulnerability in serve module\nIt allows an attacker to read system files via path traversal vulnerability\n\n# Module\n\n**module name:** serve\n**version:** 10.1.2\n**npm page:** `https://www.npmjs.com/package/serve`\n\n## Module Description\nAssuming you would like to serve a static site, single page application or just a static file (no matter if on your device or on the local network), this package is just the right choice for you.\n\nIt behaves exactly like static deployments on Now, so it's perfect for developing your static project. Then, when it's time to push it into production, you deploy it.\n\nFurthermore, it provides a neat interface for listing the directory's contents:\n\n\n# Vulnerability\n\n## Vulnerability Description\n\nwith a symlink file on the working dir ,it was possible to fetch files outside of the web root dir\n\n## Steps To Reproduce:\n1.make a directory\n$mkdir test\n\n2.got test dir\n$cd test\n\n3.create a symlink file\n$ln -s ../../ symdir\n\n4.now install serve module:\n$yarn global add serve\n\n5.run serve module\n$serve\n\n## Patch\n\n\u003e If you're able to provide a patch with the fix please post it in this section\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- [OPERATING SYSTEM VERSION] kali linux\n- [NODEJS VERSION] 11.8.0\n- [NPM VERSION] 6.5.0\n\n# Wrap up\n\n\u003e Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\u003e Hunter's comments and funny memes goes here\n\n## Impact\n\nThis could have enabled an attacker to view system files and leverage attacks like remote code execution and so on","vulnerability_information_html":"\u003cp\u003eI would like to report path traversal vulnerability in serve module\u003cbr\u003e\nIt allows an attacker to read system files via path traversal vulnerability\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e serve\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 10.1.2\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/serve\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eAssuming you would like to serve a static site, single page application or just a static file (no matter if on your device or on the local network), this package is just the right choice for you.\u003c/p\u003e\n\n\u003cp\u003eIt behaves exactly like static deployments on Now, so it\u0026#39;s perfect for developing your static project. Then, when it\u0026#39;s time to push it into production, you deploy it.\u003c/p\u003e\n\n\u003cp\u003eFurthermore, it provides a neat interface for listing the directory\u0026#39;s contents:\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003ewith a symlink file on the working dir ,it was possible to fetch files outside of the web root dir\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e1.make a directory\u003cbr\u003e\n$mkdir test\u003c/p\u003e\n\n\u003cp\u003e2.got test dir\u003cbr\u003e\n$cd test\u003c/p\u003e\n\n\u003cp\u003e3.create a symlink file\u003cbr\u003e\n$ln -s ../../ symdir\u003c/p\u003e\n\n\u003cp\u003e4.now install serve module:\u003cbr\u003e\n$yarn global add serve\u003c/p\u003e\n\n\u003cp\u003e5.run serve module\u003cbr\u003e\n$serve\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf you\u0026#39;re able to provide a patch with the fix please post it in this section\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003e[OPERATING SYSTEM VERSION] kali linux\u003c/li\u003e\n\u003cli\u003e[NODEJS VERSION] 11.8.0\u003c/li\u003e\n\u003cli\u003e[NPM VERSION] 6.5.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSelect Y or N for the following statements:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eHunter\u0026#39;s comments and funny memes goes here\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis could have enabled an attacker to view system files and leverage attacks like remote code execution and so on\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":441823,"file_name":"Screenshot_from_2019-03-15_15-02-00.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/441/823/0bd7336ac8376065e970b92c90eb9725145bafdf/Screenshot_from_2019-03-15_15-02-00.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-03-15_15-02-00.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-03-15_15-02-00.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061232Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=cb671e196621583bb5bb25c31db3f4d2f18ed5067e34a29b1bf07fe72c8483e1","file_size":158483,"type":"image/png"}],"allow_singular_disclosure_at":"2019-05-03T16:55:24.072Z","allow_singular_disclosure_after":-52319828.79825475,"singular_disclosure_allowed":true,"vote_count":5,"voters":["bb00x","cryptographer","casualkeystroker","cyberonin","pr49"],"severity":{"rating":"critical","score":9.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4328968,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-03-15T09:29:25.731Z","updated_at":"2019-03-15T09:29:25.731Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4426764,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\n\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-31T02:04:37.533Z","updated_at":"2019-03-31T02:04:37.533Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4433301,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-01T13:30:56.568Z","updated_at":"2019-04-01T13:30:56.568Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4456558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nThank you for reporting this issue.\n\nSymlinks are now disabled by default as of version `11.0.0` of `serve`. They can be enabled using the newly added `--symlinks` flag.","markdown_message":"\u003cp\u003eHey!\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eSymlinks are now disabled by default as of version \u003ccode\u003e11.0.0\u003c/code\u003e of \u003ccode\u003eserve\u003c/code\u003e. They can be enabled using the newly added \u003ccode\u003e--symlinks\u003c/code\u003e flag.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T10:15:38.125Z","updated_at":"2019-04-03T10:15:38.125Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4458149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we move this report to https://hackerone.com/zeit?","markdown_message":"\u003cp\u003eCan we move this report to \u003ca title=\"https://hackerone.com/zeit\" href=\"https://hackerone.com/zeit\"\u003ehttps://hackerone.com/zeit\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T12:48:15.425Z","updated_at":"2019-04-03T12:48:15.425Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@notquiteleo I'm not able to access anything at that link, is that private bug bounty group?","markdown_message":"\u003cp\u003e\u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e I\u0026#39;m not able to access anything at that link, is that private bug bounty group?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T16:47:03.274Z","updated_at":"2019-04-03T16:47:03.274Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459427,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-03T16:55:14.764Z","updated_at":"2019-04-03T16:55:14.764Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"johnssimon007","url":"/johnssimon007"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459430,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-03T16:55:23.994Z","updated_at":"2019-04-03T16:55:23.994Z","first_to_agree":true,"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4460305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We can disclose this report","markdown_message":"\u003cp\u003eWe can disclose this report\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T18:36:12.015Z","updated_at":"2019-04-03T18:36:12.015Z","actor":{"username":"johnssimon007","cleared":false,"url":"/johnssimon007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4732872,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-03T16:55:25.323Z","updated_at":"2019-05-03T16:55:25.323Z","actor":{"url":"/vercel","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vercel"}},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}