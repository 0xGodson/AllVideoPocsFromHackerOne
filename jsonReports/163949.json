{"id":163949,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM5NDk=","url":"https://hackerone.com/reports/163949","title":"Username Restriction is not applied for reserved folders","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-08-28T07:50:17.569Z","submitted_at":"2016-08-28T07:50:17.569Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akash_9021","url":"/akash_9021","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-30T07:46:36.420Z","bug_reporter_agreed_on_going_public_at":"2016-12-30T07:46:36.369Z","team_member_agreed_on_going_public_at":"2016-08-31T20:46:09.790Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis issue is same as #128121 reported by a5tronaut.\nHe reported some of the usernames for restriction and you applied check only for those usernames. \nI think username restriction should applied for all the usersnames, those are used for a directory or a link in gratipay.\n\na5tronaut mentioned the sign-out.html. You restricted it but sign-out still is an available username. \n\nLike gratipay have the directory listing for following:\nProfile, Giving , History, Emails, Routes, Settings.\n\nBut none of the above is restricted for use as an username.\n\nI created my account of three of above username for POC purpose. When User of gratipay will click on the following link, he would expect the history, sign-out, settings page of gratipay. But he will end up visiting my gratipay account. \n\n**POC:**\nhttps://gratipay.com/sign-out/\nhttps://gratipay.com/History/\nhttps://gratipay.com/settings/\n\n**Fix:** \nYou can fix most of this username restriction issues by not allowing . (dot) in username as i suggested in my previous report and other usernames without \".\" dot can be restricted explicitly.\n\nThanks,\nAkash Saxena","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis issue is same as \u003ca href=\"/reports/128121\"\u003e#128121\u003c/a\u003e reported by a5tronaut.\u003cbr\u003e\nHe reported some of the usernames for restriction and you applied check only for those usernames. \u003cbr\u003e\nI think username restriction should applied for all the usersnames, those are used for a directory or a link in gratipay.\u003c/p\u003e\n\n\u003cp\u003ea5tronaut mentioned the sign-out.html. You restricted it but sign-out still is an available username. \u003c/p\u003e\n\n\u003cp\u003eLike gratipay have the directory listing for following:\u003cbr\u003e\nProfile, Giving , History, Emails, Routes, Settings.\u003c/p\u003e\n\n\u003cp\u003eBut none of the above is restricted for use as an username.\u003c/p\u003e\n\n\u003cp\u003eI created my account of three of above username for POC purpose. When User of gratipay will click on the following link, he would expect the history, sign-out, settings page of gratipay. But he will end up visiting my gratipay account. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://gratipay.com/sign-out/\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2Fsign-out%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/sign-out/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://gratipay.com/History/\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2FHistory%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/History/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://gratipay.com/settings/\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2Fsettings%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/settings/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix:\u003c/strong\u003e \u003cbr\u003e\nYou can fix most of this username restriction issues by not allowing . (dot) in username as i suggested in my previous report and other usernames without \u0026quot;.\u0026quot; dot can be restricted explicitly.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAkash Saxena\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["spetr0x","akash_9021","ariyansarma"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1164060,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Gratipay team,\nAnyone would give this report a look please??","markdown_message":"\u003cp\u003eHi Gratipay team,\u003cbr\u003e\nAnyone would give this report a look please??\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T07:02:24.274Z","updated_at":"2016-08-31T07:02:24.274Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @password_change,\n\nThanks for this report and sorry for the delay, I was less active the last days.\n\nWe handled #128121 because it was somehow easy to trick an user: accessing `/sign-out.html` was different of `/sign-out.html/`, since the second one was redirecting to the page of an user. The layout of this page was different and you were very limited while displaying a phishing attempt, but we still categorized it as theoretical and issued a fix.\n\nHowever, we can't afford to blacklist all the \"technical\" words (`settings`, `sign-out`…) just because somebody may use it: the list would be enormous and it's not a plausible security risk. It was fixed for the pages of top-level (`sign-out.html`...) but your report mentions pages of a sub-folder (in the case of `settings`, the profile of the user). `sign-out.html` was a real page, `sign-out` is not.\n\nI think the risk is too low to spend time on it: it's not only about forbidding dots, but all the existing pages, things looking like the brand name, \"win-a-lot-of-money\" and other similar words/sentences. That's why I'm categorizing this report as Infomative.\n\nThanks for making Gratipay a safer place!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/password_change\"\u003e@password_change\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for this report and sorry for the delay, I was less active the last days.\u003c/p\u003e\n\n\u003cp\u003eWe handled \u003ca href=\"/reports/128121\"\u003e#128121\u003c/a\u003e because it was somehow easy to trick an user: accessing \u003ccode\u003e/sign-out.html\u003c/code\u003e was different of \u003ccode\u003e/sign-out.html/\u003c/code\u003e, since the second one was redirecting to the page of an user. The layout of this page was different and you were very limited while displaying a phishing attempt, but we still categorized it as theoretical and issued a fix.\u003c/p\u003e\n\n\u003cp\u003eHowever, we can\u0026#39;t afford to blacklist all the \u0026quot;technical\u0026quot; words (\u003ccode\u003esettings\u003c/code\u003e, \u003ccode\u003esign-out\u003c/code\u003e…) just because somebody may use it: the list would be enormous and it\u0026#39;s not a plausible security risk. It was fixed for the pages of top-level (\u003ccode\u003esign-out.html\u003c/code\u003e...) but your report mentions pages of a sub-folder (in the case of \u003ccode\u003esettings\u003c/code\u003e, the profile of the user). \u003ccode\u003esign-out.html\u003c/code\u003e was a real page, \u003ccode\u003esign-out\u003c/code\u003e is not.\u003c/p\u003e\n\n\u003cp\u003eI think the risk is too low to spend time on it: it\u0026#39;s not only about forbidding dots, but all the existing pages, things looking like the brand name, \u0026quot;win-a-lot-of-money\u0026quot; and other similar words/sentences. That\u0026#39;s why I\u0026#39;m categorizing this report as Infomative.\u003c/p\u003e\n\n\u003cp\u003eThanks for making Gratipay a safer place!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T20:44:54.962Z","updated_at":"2016-08-31T20:44:54.962Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166200,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"The report does not present a risk reasonable enough to be considered a security risk.","markdown_message":"\u003cp\u003eThe report does not present a risk reasonable enough to be considered a security risk.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T20:46:02.434Z","updated_at":"2016-08-31T20:46:02.434Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T20:46:09.830Z","updated_at":"2016-08-31T20:46:09.830Z","first_to_agree":true,"actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1169980,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-02T15:49:11.277Z","updated_at":"2016-09-02T15:49:11.277Z","additional_data":{"duplicate_report_id":164955},"actor":{"username":"0xni8walk3r","cleared":false,"url":"/0xni8walk3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/tgGtf7CNUhH8FYDp2puozvxd/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1391896,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-30T07:46:36.393Z","updated_at":"2016-12-30T07:46:36.393Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1391897,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-30T07:46:36.441Z","updated_at":"2016-12-30T07:46:36.441Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}