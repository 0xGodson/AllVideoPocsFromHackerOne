{"id":222096,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjIwOTY=","url":"https://hackerone.com/reports/222096","title":"[bot.brew.sh] Full Path Disclosure","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-04-19T09:48:08.614Z","submitted_at":"2017-04-19T09:48:08.614Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zephrfish","url":"/zephrfish","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19399,"url":"https://hackerone.com/homebrew","handle":"homebrew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/399/2f26b1d3c096d89ed989900225c128f670ab0ef0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/399/2f26b1d3c096d89ed989900225c128f670ab0ef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Homebrew","twitter_handle":"MacHomebrew","website":"https://brew.sh","about":"The missing package manager for macOS (and Linux)"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-26T11:06:27.957Z","bug_reporter_agreed_on_going_public_at":"2017-04-25T17:17:26.636Z","team_member_agreed_on_going_public_at":"2017-04-26T11:06:27.922Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Full Path Disclosure (FPD) vulnerabilities enable the attacker to see the path to the webroot/file. e.g.: /home/omg/htdocs/file/. Certain vulnerabilities, such as using the load_file() (within a SQL Injection) query to view the page source, require the attacker to have the full path to the file they wish to view.\n\nThe affected domain has a logging instance that discloses the full operating system path on certain pages. \n\nAffected URLs:\n - https://bot.brew.sh/job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveText?start=0\n - https://bot.brew.sh/job/Homebrew%20Bottles/*\n\n\nIt was possible to discover the path where the brew distrobution server is installed as can be seen in the output below:\n\n```\nThe request GET /job/Homebrew%20Bottles/lastSuccessfulBuild/logText/progressiveText?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n\n\nThe request GET /job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveText?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n\n\nThe request GET /job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveHtml?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n```\n\n# Recommendation\nImplement basic authentication to protect the root folder, alternatively remove the offending files causing the stack trace errors.","vulnerability_information_html":"\u003cp\u003eFull Path Disclosure (FPD) vulnerabilities enable the attacker to see the path to the webroot/file. e.g.: /home/omg/htdocs/file/. Certain vulnerabilities, such as using the load_file() (within a SQL Injection) query to view the page source, require the attacker to have the full path to the file they wish to view.\u003c/p\u003e\n\n\u003cp\u003eThe affected domain has a logging instance that discloses the full operating system path on certain pages. \u003c/p\u003e\n\n\u003cp\u003eAffected URLs:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://bot.brew.sh/job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveText?start=0\" href=\"/redirect?url=https%3A%2F%2Fbot.brew.sh%2Fjob%2FHomebrew%2520Bottles%2FlastFailedBuild%2FlogText%2FprogressiveText%3Fstart%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bot.brew.sh/job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveText?start=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://bot.brew.sh/job/Homebrew%20Bottles/*\" href=\"/redirect?url=https%3A%2F%2Fbot.brew.sh%2Fjob%2FHomebrew%2520Bottles%2F%2A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bot.brew.sh/job/Homebrew%20Bottles/*\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIt was possible to discover the path where the brew distrobution server is installed as can be seen in the output below:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eThe request GET /job/Homebrew%20Bottles/lastSuccessfulBuild/logText/progressiveText?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n\n\nThe request GET /job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveText?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n\n\nThe request GET /job/Homebrew%20Bottles/lastFailedBuild/logText/progressiveHtml?start=0 HTTP/1.1\nHost: bot.brew.sh\nAccept-Charset: iso-8859-1,utf-8;q=0.9,*;q=0.1\nAccept-Language: en\nConnection: Close\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\nPragma: no-cache\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\n\n\n\nproduces the following path information :\n[EnvInject] - Injecting as environment variables the properties content\nHOMEBREW_UPDATE_TO_TAG=1\nPATH=bin:/usr/bin:/bin:/usr/sbin:/sbin\nHOMEBREW_DEVELOPER=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"recommendation\"\u003eRecommendation\u003c/h1\u003e\n\n\u003cp\u003eImplement basic authentication to protect the root folder, alternatively remove the offending files causing the stack trace errors.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-25T17:17:26.676Z","allow_singular_disclosure_after":-113485416.10326822,"singular_disclosure_allowed":true,"vote_count":8,"voters":["theappsec","eveeez","zephrfish","grampae","japz","rbcafe","spetr0x","mrr3boot"],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1620506,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Another great report. We've removed our webapps from any more disclosures as we're being inundated with crappy ones for them and mostly joined this program for Homebrew's Ruby code. As you likely discovered this before this addition I'll give you kudos anyway.","markdown_message":"\u003cp\u003eAnother great report. We\u0026#39;ve removed our webapps from any more disclosures as we\u0026#39;re being inundated with crappy ones for them and mostly joined this program for Homebrew\u0026#39;s Ruby code. As you likely discovered this before this addition I\u0026#39;ll give you kudos anyway.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T09:55:34.677Z","updated_at":"2017-04-19T09:55:34.677Z","actor":{"username":"mikemcquaid","cleared":false,"url":"/mikemcquaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/152/571/7d94225e54e75375692ed2bec7f21a63b1615ee4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zephrfish","url":"/zephrfish"},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620525,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem, I'll have a look at the application code next. I can imagine the motherload of crap reports being dropped :-( ","markdown_message":"\u003cp\u003eNo problem, I\u0026#39;ll have a look at the application code next. I can imagine the motherload of crap reports being dropped :-( \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:03:03.928Z","updated_at":"2017-04-19T10:03:03.928Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620531,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You have no idea :D","markdown_message":"\u003cp\u003eYou have no idea :D\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:05:19.715Z","updated_at":"2017-04-19T10:05:19.715Z","actor":{"username":"mikemcquaid","cleared":false,"url":"/mikemcquaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/152/571/7d94225e54e75375692ed2bec7f21a63b1615ee4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620544,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"eek :O, ack well thanks for the kudos anyways! I take it the HSTS report I filed yesterday will take slightly longer to fix as it's a case of logging in serverside?","markdown_message":"\u003cp\u003eeek :O, ack well thanks for the kudos anyways! I take it the HSTS report I filed yesterday will take slightly longer to fix as it\u0026#39;s a case of logging in serverside?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:08:43.680Z","updated_at":"2017-04-19T10:08:43.680Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeh, I hope to get to it in the next week or so. It's on my TODO list. Thanks!","markdown_message":"\u003cp\u003eYeh, I hope to get to it in the next week or so. It\u0026#39;s on my TODO list. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:10:51.284Z","updated_at":"2017-04-19T10:10:51.284Z","actor":{"username":"mikemcquaid","cleared":false,"url":"/mikemcquaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/152/571/7d94225e54e75375692ed2bec7f21a63b1615ee4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good stuff, I've downloaded the application code for brew now anyways and am going to code review it :-)","markdown_message":"\u003cp\u003eGood stuff, I\u0026#39;ve downloaded the application code for brew now anyways and am going to code review it :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:11:48.786Z","updated_at":"2017-04-19T10:11:48.786Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1635445,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"as this is now fixed, is it possible to disclose please?","markdown_message":"\u003cp\u003eas this is now fixed, is it possible to disclose please?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-25T17:17:26.653Z","updated_at":"2017-04-25T17:17:26.653Z","first_to_agree":true,"actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1637160,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-26T11:06:27.938Z","updated_at":"2017-04-26T11:06:27.938Z","actor":{"username":"mikemcquaid","cleared":false,"url":"/mikemcquaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/152/571/7d94225e54e75375692ed2bec7f21a63b1615ee4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1637161,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-26T11:06:27.971Z","updated_at":"2017-04-26T11:06:27.971Z","actor":{"username":"mikemcquaid","cleared":false,"url":"/mikemcquaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/152/571/7d94225e54e75375692ed2bec7f21a63b1615ee4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"homebrew","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}