{"id":31408,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTQwOA==","url":"https://hackerone.com/reports/31408","title":"Adobe Flash Player Out-of-Bound Read/Write Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-15T07:18:36.549Z","submitted_at":"2014-10-15T07:18:36.549Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hhj4ck","url":"/hhj4ck","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-11T04:19:46.285Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-02-09T04:19:45.691Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Summary\r\nAdobe Flash Player is prone to a vulnerability which leads to Out-of-Bound access of memory. During the compilation of a malformed regular expression, relevant operations would cause Out-of-Bound Read/Write of stack and heap memory. Successful exploits may allow an attacker to gain access to sensitive memory addresses information in the context of the user running the affected application, which could be used to bypass ASLR protection. Advanced Heap Fengshui techniques may even allow an attacker to rewrite stack or heap variable, resulting in arbitrary code execution in the context of the user running the affected application.\r\n------------------------------------------------------------------\r\nII. Description\r\nBuilding RegExp Object via a malformed regular expression, such as: \r\n\r\nvar exp:RegExp=new RegExp(\"(?:(VenusTech)(?2){0,1020}(b))?)\"); \r\n\r\nwill normally cause memory crash because of Out-of-Bound read of stack memory.\r\nRegExp object used a fixed size stack variable cworkspace during the compilation. Since cworkspace can get filled up by repetitions of forward references, expanding cworkspace mechanism is introduced. After a potential stack overflow is detected, the original cworkspace will be replaced by a block of newly created heap block that is large enough to hold everything. Pointers related to cworkspace will also be updated to newly created heap memory block. \r\n\r\nThe problem is, the updating of cworkspace pointers happens inside a recursively called function. A local variable of cworkspace pointer is not synchronizing upon different calls. \r\n\r\nFurther operations try to copy the content of the original cworkspace, beginning with the out-of-date local pointer of cworkspace and ending up with a pointer of newly created heap block. Since the local variable of cworkspace is still a stack pointer, it is normally in lower address than the newly created heap memory. The copying operations will read values out of bound of the stack. \r\n\r\nWith advanced technique (such as Heap Fengshui), stack can adjacent to another block of heap memory controlled by the attacker. Copying operations may allow the modification to the length field of Vector.\u003cint\u003e, gaining attacker the ability to read and write arbitrary memory address. Or else, one could simply use Out-of-Bound read to gain the address of ActionScript objects or OS structs.\r\n------------------------------------------------------------------\r\nIII. Impact\r\nOut-of-Bound Read/Write\r\n------------------------------------------------------------------\r\nIV. Affected\r\nAdobe Flash Player under Windows XP and Windows 7.\r\nOther versions may also be affected.\r\n------------------------------------------------------------------\r\nV. Reference\r\nIt has got assigned as CVE-2014-0564.\r\nhttp://helpx.adobe.com/security/products/flash-player/apsb14-22.html\r\n------------------------------------------------------------------\r\nVI. Credit\r\nWen Guanxing from Venustech ADLAB is credited for this vulnerability.","vulnerability_information_html":"\u003cp\u003eI. Summary\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-is-prone-to-a-vulnerability-which-leads-to-out-of-bound-access-of-memory-during-the-compilation-of-a-malformed-regular-expression-relevant-operations-would-cause-out-of-bound-read-write-of-stack-and-heap-memory-successful-exploits-may-allow-an-attacker-to-gain-access-to-sensitive-memory-addresses-information-in-the-context-of-the-user-running-the-affected-application-which-could-be-used-to-bypass-aslr-protection-advanced-heap-fengshui-techniques-may-even-allow-an-attacker-to-rewrite-stack-or-heap-variable-resulting-in-arbitrary-code-execution-in-the-context-of-the-user-running-the-affected-application\"\u003eAdobe Flash Player is prone to a vulnerability which leads to Out-of-Bound access of memory. During the compilation of a malformed regular expression, relevant operations would cause Out-of-Bound Read/Write of stack and heap memory. Successful exploits may allow an attacker to gain access to sensitive memory addresses information in the context of the user running the affected application, which could be used to bypass ASLR protection. Advanced Heap Fengshui techniques may even allow an attacker to rewrite stack or heap variable, resulting in arbitrary code execution in the context of the user running the affected application.\u003c/h2\u003e\n\n\u003cp\u003eII. Description\u003cbr\u003e\nBuilding RegExp Object via a malformed regular expression, such as: \u003c/p\u003e\n\n\u003cp\u003evar exp:RegExp=new RegExp(\u0026quot;(?:(VenusTech)(?2){0,1020}(b))?)\u0026quot;); \u003c/p\u003e\n\n\u003cp\u003ewill normally cause memory crash because of Out-of-Bound read of stack memory.\u003cbr\u003e\nRegExp object used a fixed size stack variable cworkspace during the compilation. Since cworkspace can get filled up by repetitions of forward references, expanding cworkspace mechanism is introduced. After a potential stack overflow is detected, the original cworkspace will be replaced by a block of newly created heap block that is large enough to hold everything. Pointers related to cworkspace will also be updated to newly created heap memory block. \u003c/p\u003e\n\n\u003cp\u003eThe problem is, the updating of cworkspace pointers happens inside a recursively called function. A local variable of cworkspace pointer is not synchronizing upon different calls. \u003c/p\u003e\n\n\u003cp\u003eFurther operations try to copy the content of the original cworkspace, beginning with the out-of-date local pointer of cworkspace and ending up with a pointer of newly created heap block. Since the local variable of cworkspace is still a stack pointer, it is normally in lower address than the newly created heap memory. The copying operations will read values out of bound of the stack. \u003c/p\u003e\n\n\u003ch2 id=\"with-advanced-technique-such-as-heap-fengshui-stack-can-adjacent-to-another-block-of-heap-memory-controlled-by-the-attacker-copying-operations-may-allow-the-modification-to-the-length-field-of-vector-int-gaining-attacker-the-ability-to-read-and-write-arbitrary-memory-address-or-else-one-could-simply-use-out-of-bound-read-to-gain-the-address-of-actionscript-objects-or-os-structs\"\u003eWith advanced technique (such as Heap Fengshui), stack can adjacent to another block of heap memory controlled by the attacker. Copying operations may allow the modification to the length field of Vector.\u0026lt;int\u0026gt;, gaining attacker the ability to read and write arbitrary memory address. Or else, one could simply use Out-of-Bound read to gain the address of ActionScript objects or OS structs.\u003c/h2\u003e\n\n\u003cp\u003eIII. Impact\u003c/p\u003e\n\n\u003ch2 id=\"out-of-bound-read-write\"\u003eOut-of-Bound Read/Write\u003c/h2\u003e\n\n\u003cp\u003eIV. Affected\u003cbr\u003e\nAdobe Flash Player under Windows XP and Windows 7.\u003c/p\u003e\n\n\u003ch2 id=\"other-versions-may-also-be-affected\"\u003eOther versions may also be affected.\u003c/h2\u003e\n\n\u003cp\u003eV. Reference\u003cbr\u003e\nIt has got assigned as CVE-2014-0564.\u003c/p\u003e\n\n\u003ch2 id=\"http-helpx-adobe-com-security-products-flash-player-apsb14-22-html\"\u003e\u003ca title=\"http://helpx.adobe.com/security/products/flash-player/apsb14-22.html\" href=\"/redirect?url=http%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb14-22.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://helpx.adobe.com/security/products/flash-player/apsb14-22.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/h2\u003e\n\n\u003cp\u003eVI. Credit\u003cbr\u003e\nWen Guanxing from Venustech ADLAB is credited for this vulnerability.\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":18815,"file_name":"OBRW.rar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/018/815/a8267d30ee655bbb2e935af38ac17a8dea48f326/OBRW.rar?response-content-disposition=attachment%3B%20filename%3D%22OBRW.rar%22%3B%20filename%2A%3DUTF-8%27%27OBRW.rar\u0026response-content-type=application%2Fx-rar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053248Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=e4fd8fa0f9087fa7cddfda6de2ed436fd531884b4f5f7bdb3527b7ea5ceca3c8","file_size":506464,"type":"application/x-rar"}],"allow_singular_disclosure_at":"2015-03-11T04:19:45.948Z","allow_singular_disclosure_after":-183172382.36271375,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":328035,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:32.060Z","updated_at":"2015-02-09T04:19:32.060Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hhj4ck","url":"/hhj4ck"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328036,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:40.533Z","updated_at":"2015-02-09T04:19:40.533Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"5000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"hhj4ck","url":"/hhj4ck"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328037,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:45.735Z","updated_at":"2015-02-09T04:19:45.735Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350732,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T04:19:46.498Z","updated_at":"2015-03-11T04:19:46.498Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}