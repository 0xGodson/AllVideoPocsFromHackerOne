{"id":152584,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI1ODQ=","url":"https://hackerone.com/reports/152584","title":"S3 bucket takeover due to proxy.harvestfiles.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-20T15:58:50.077Z","submitted_at":"2016-07-20T15:58:50.077Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-10T22:00:01.258Z","bug_reporter_agreed_on_going_public_at":"2016-08-11T22:00:00.816Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary\n---------\n\nI can takeover your `███` S3 bucket. You are using https://proxy.harvestfiles.com to proxy requests to this bucket. The proxy automatically signs the requests and adds the required authorization headers for your S3 user.\n\nHowever, an attacker can then simply impersonate the user and create arbitrary requests which will be signed and forwarded to the S3 bucket. \n\nProof of Concept\n-----------\n\nAs a proof of concept I have created a file on the bucket: █████████\n\nThis was done by issuing the following request:\n\n```\nPUT ███████ HTTP/1.1\nHost: proxy.harvestfiles.com\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\narbitrary-write\n```\n\nImpact\n--------\n\nOf course, instead of just writing one file, I can change the access control policy and add my own account as the owner. If you check the acl: ████ \nyou will see the user ██████████ has full control over the bucket and with your proxy he basically acts on our behalf.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eI can takeover your \u003ccode\u003e███\u003c/code\u003e S3 bucket. You are using \u003ca title=\"https://proxy.harvestfiles.com\" href=\"/redirect?url=https%3A%2F%2Fproxy.harvestfiles.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://proxy.harvestfiles.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to proxy requests to this bucket. The proxy automatically signs the requests and adds the required authorization headers for your S3 user.\u003c/p\u003e\n\n\u003cp\u003eHowever, an attacker can then simply impersonate the user and create arbitrary requests which will be signed and forwarded to the S3 bucket. \u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\n\u003cp\u003eAs a proof of concept I have created a file on the bucket: █████████\u003c/p\u003e\n\n\u003cp\u003eThis was done by issuing the following request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT ███████ HTTP/1.1\nHost: proxy.harvestfiles.com\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\narbitrary-write\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eOf course, instead of just writing one file, I can change the access control policy and add my own account as the owner. If you check the acl: ████ \u003cbr\u003e\nyou will see the user ██████████ has full control over the bucket and with your proxy he basically acts on our behalf.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-10T22:00:00.901Z","allow_singular_disclosure_after":-135671635.04550996,"singular_disclosure_allowed":true,"vote_count":36,"voters":["iamnoooob","michiel","bogdantcaciuc","yaworsk","dmatrix","geekboy","ysx","zee_shan","yassineaboukir","gamliel","and 26 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1078301,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Edgar,\n\nThanks a lot for reporting this amazing finding! We're going to investigate it right away. \nWe will get back to you as soon as we have a fix.\n\nNicely done!\n\n","markdown_message":"\u003cp\u003eHi Edgar,\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for reporting this amazing finding! We\u0026#39;re going to investigate it right away. \u003cbr\u003e\nWe will get back to you as soon as we have a fix.\u003c/p\u003e\n\n\u003cp\u003eNicely done!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-20T16:14:12.251Z","updated_at":"2016-07-20T16:14:12.251Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Edgar,\n\nWe've just fixed this issue. Could you check if you are able to reproduce or find any other related issue? We'll be awarding a bounty, but it might take us a few days to go through the process.\n\nThanks again!\nJorge\n","markdown_message":"\u003cp\u003eHi Edgar,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve just fixed this issue. Could you check if you are able to reproduce or find any other related issue? We\u0026#39;ll be awarding a bounty, but it might take us a few days to go through the process.\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T10:23:01.496Z","updated_at":"2016-07-25T10:23:01.496Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085472,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Jorge,\n\nI have tried to reproduce it and failed, looks fixed to me :)\nIf I come across a related issue I will let you know.\n\nThank you!","markdown_message":"\u003cp\u003eHey Jorge,\u003c/p\u003e\n\n\u003cp\u003eI have tried to reproduce it and failed, looks fixed to me :)\u003cbr\u003e\nIf I come across a related issue I will let you know.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T11:07:11.390Z","updated_at":"2016-07-25T11:07:11.390Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119568,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:33:05.138Z","updated_at":"2016-08-11T15:33:05.138Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1120528,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"That's awesome! Thank you very much! \nMind disclosing it?","markdown_message":"\u003cp\u003eThat\u0026#39;s awesome! Thank you very much! \u003cbr\u003e\nMind disclosing it?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T22:00:00.859Z","updated_at":"2016-08-11T22:00:00.859Z","first_to_agree":true,"actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1186768,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-10T22:00:01.343Z","updated_at":"2016-09-10T22:00:01.343Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}