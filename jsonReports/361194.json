{"id":361194,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjExOTQ=","url":"https://hackerone.com/reports/361194","title":"Liberapay Non Verified Account Takeover with signup feature","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2018-06-02T21:35:04.040Z","submitted_at":"2018-06-02T21:35:04.040Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khizer47","url":"/khizer47","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-03T10:20:31.937Z","bug_reporter_agreed_on_going_public_at":"2018-06-03T10:19:49.323Z","team_member_agreed_on_going_public_at":"2018-06-03T10:20:31.839Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nSo i saw a strange behaviour of your web on signup feature when that can be escalated to Account Takeover but for limited timeline, \n\n#Issue:\nWhen a New user signup for an account on https://en.liberapay.com/ he have to enter his email address only and it doesn't say anything about sending a confirmation/verification email to the user. and thus user gets login to his account, and also as there is an option for user to chose not to use a password for his account user account can be compromised \n\n#POC:\n1) Go to https://en.liberapay.com/sign-in?back_to=/\n2) in \"Create Your account\" Field add your email address \n3) You will be logged into your account\n4) You will also receive a Verification email ( But no need to open it or use that link ) \n5) Now if you go again to https://en.liberapay.com/sign-in?back_to=/ and in login field enter your email ( No password needed as your account don't have a Password yet ) \n6) after you press login you will see a message saying \n`We've sent you a single-use login link. Check your inbox, open the provided link in a new tab, then come back to this page and click on the button below to carry on with what you wanted to do.`\n7) Now this means that you will have to get the URL send to the email but this can be bypassed\n8) go to https://en.liberapay.com/sign-up and enter the email Address of that account \n9) You will see that you will be in that account \n\n#Fix Maybe: \nThis can be fixed by not letting user login without Verification \nand also make sure again the same email can't be used \n\n#NOTE:\nthis will not work with verified accounts \nalso if someone signup for your email after you did for 1st time he will get access to your account but if he tried 2nd time he will get an error saying `A verification email has already been sent to test@gmail.com recently.` But this can be bypassed by waiting for like 2-3 hours i have tried  like 3 times and if a user is verified the error will be like `test1@gmail.com is already connected to a different Liberapay account.`\n\n#Video POC:\n\nhttps://www.youtube.com/watch?v=P-76XHx-GkE\u0026feature=youtu.be\n\n## Impact\n\nunauthorized person can get access to user account by knowing their email if user account is not verified and have no password set by using signup feature","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eSo i saw a strange behaviour of your web on signup feature when that can be escalated to Account Takeover but for limited timeline, \u003c/p\u003e\n\n\u003ch1 id=\"issue\"\u003eIssue:\u003c/h1\u003e\n\n\u003cp\u003eWhen a New user signup for an account on \u003ca title=\"https://en.liberapay.com/\" href=\"/redirect?url=https%3A%2F%2Fen.liberapay.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.liberapay.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e he have to enter his email address only and it doesn\u0026#39;t say anything about sending a confirmation/verification email to the user. and thus user gets login to his account, and also as there is an option for user to chose not to use a password for his account user account can be compromised \u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC:\u003c/h1\u003e\n\n\u003cp\u003e1) Go to \u003ca title=\"https://en.liberapay.com/sign-in?back_to=/\" href=\"/redirect?url=https%3A%2F%2Fen.liberapay.com%2Fsign-in%3Fback_to%3D%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.liberapay.com/sign-in?back_to=/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) in \u0026quot;Create Your account\u0026quot; Field add your email address \u003cbr\u003e\n3) You will be logged into your account\u003cbr\u003e\n4) You will also receive a Verification email ( But no need to open it or use that link ) \u003cbr\u003e\n5) Now if you go again to \u003ca title=\"https://en.liberapay.com/sign-in?back_to=/\" href=\"/redirect?url=https%3A%2F%2Fen.liberapay.com%2Fsign-in%3Fback_to%3D%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.liberapay.com/sign-in?back_to=/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and in login field enter your email ( No password needed as your account don\u0026#39;t have a Password yet ) \u003cbr\u003e\n6) after you press login you will see a message saying \u003cbr\u003e\n\u003ccode\u003eWe\u0026#39;ve sent you a single-use login link. Check your inbox, open the provided link in a new tab, then come back to this page and click on the button below to carry on with what you wanted to do.\u003c/code\u003e\u003cbr\u003e\n7) Now this means that you will have to get the URL send to the email but this can be bypassed\u003cbr\u003e\n8) go to \u003ca title=\"https://en.liberapay.com/sign-up\" href=\"/redirect?url=https%3A%2F%2Fen.liberapay.com%2Fsign-up\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.liberapay.com/sign-up\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and enter the email Address of that account \u003cbr\u003e\n9) You will see that you will be in that account \u003c/p\u003e\n\n\u003ch1 id=\"fix-maybe\"\u003eFix Maybe:\u003c/h1\u003e\n\n\u003cp\u003eThis can be fixed by not letting user login without Verification \u003cbr\u003e\nand also make sure again the same email can\u0026#39;t be used \u003c/p\u003e\n\n\u003ch1 id=\"note\"\u003eNOTE:\u003c/h1\u003e\n\n\u003cp\u003ethis will not work with verified accounts \u003cbr\u003e\nalso if someone signup for your email after you did for 1st time he will get access to your account but if he tried 2nd time he will get an error saying \u003ccode\u003eA verification email has already been sent to test@gmail.com recently.\u003c/code\u003e But this can be bypassed by waiting for like 2-3 hours i have tried  like 3 times and if a user is verified the error will be like \u003ccode\u003etest1@gmail.com is already connected to a different Liberapay account.\u003c/code\u003e\u003c/p\u003e\n\n\u003ch1 id=\"video-poc\"\u003eVideo POC:\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.youtube.com/watch?v=P-76XHx-GkE\u0026amp;feature=youtu.be\" href=\"/redirect?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DP-76XHx-GkE%26feature%3Dyoutu.be\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.youtube.com/watch?v=P-76XHx-GkE\u0026amp;feature=youtu.be\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eunauthorized person can get access to user account by knowing their email if user account is not verified and have no password set by using signup feature\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["an0nym0us","khizer47","bountypls","silv3rpoision","0x08","bibekand"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2835174,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! I am currently reviewing your report.","markdown_message":"\u003cp\u003eThank you for your submission! I am currently reviewing your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T09:00:56.994Z","updated_at":"2018-06-03T09:00:56.994Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835233,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Thanks @edoverflow I would like to make a note to it like i mentioned if attacker tried once and geta n error `A verification email has already been sent to test@gmail.com recently.`  Then just wait for like 30 minutes to 2 hours and try again and you'll get access to the account then","markdown_message":"\u003cp\u003eHey Thanks \u003ca href=\"/edoverflow\"\u003e@edoverflow\u003c/a\u003e I would like to make a note to it like i mentioned if attacker tried once and geta n error \u003ccode\u003eA verification email has already been sent to test@gmail.com recently.\u003c/code\u003e  Then just wait for like 30 minutes to 2 hours and try again and you\u0026#39;ll get access to the account then\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T09:34:41.429Z","updated_at":"2018-06-03T09:34:41.429Z","actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2835290,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"So what you are seeing here is not an account takeover, but I can see how it might be confusing. When you sign up using the same email address the second time, you will see the same avatar, because avatars are a hash generated from the user's email address/username. If you take a closer look the second time though, you will see that the two accounts have different user IDs and therefore you just created a new account. This is done by design to reduce spam accounts. I hope that clears things up.\n\nI will close this report as informative so as not to affect your reputation on HackerOne. Keep up the good work, @babayaga_!","markdown_message":"\u003cp\u003eSo what you are seeing here is not an account takeover, but I can see how it might be confusing. When you sign up using the same email address the second time, you will see the same avatar, because avatars are a hash generated from the user\u0026#39;s email address/username. If you take a closer look the second time though, you will see that the two accounts have different user IDs and therefore you just created a new account. This is done by design to reduce spam accounts. I hope that clears things up.\u003c/p\u003e\n\n\u003cp\u003eI will close this report as informative so as not to affect your reputation on HackerOne. Keep up the good work, \u003ca href=\"/babayaga_\"\u003e@babayaga_\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T10:18:00.223Z","updated_at":"2018-06-03T10:18:00.223Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835291,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T10:18:08.260Z","updated_at":"2018-06-03T10:18:08.260Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":163034,"new_severity_id":163111},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835293,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Oh! My bad Thanks Ed! This was indeed a Feature can we disclose this report? ","markdown_message":"\u003cp\u003eOh! My bad Thanks Ed! This was indeed a Feature can we disclose this report? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T10:19:49.366Z","updated_at":"2018-06-03T10:19:49.366Z","first_to_agree":true,"actor":{"username":"khizer47","cleared":true,"url":"/khizer47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/byUhjYNq5jRMc4PQirYUkKD2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2835295,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Of course! :)","markdown_message":"\u003cp\u003eOf course! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-03T10:20:31.888Z","updated_at":"2018-06-03T10:20:31.888Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2835296,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-03T10:20:31.964Z","updated_at":"2018-06-03T10:20:31.964Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}