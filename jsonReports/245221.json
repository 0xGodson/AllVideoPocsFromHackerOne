{"id":245221,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDUyMjE=","url":"https://hackerone.com/reports/245221","title":"null pointer dereference and segfault in tile-count-merge","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-07-02T00:41:36.403Z","submitted_at":"2017-07-02T00:41:36.403Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-11T15:36:07.317Z","bug_reporter_agreed_on_going_public_at":"2017-07-07T20:13:45.831Z","team_member_agreed_on_going_public_at":"2017-07-11T15:36:07.284Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This crash was triggered with `642f773 ` while fuzzing `tile-count-merge` with AFL on Debian 8 x64.\n\n`./tile-count-merge -o /dev/null test000`\n\n```\nASAN:SIGSEGV\n=================================================================\n==10201==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000048d0af bp 0x7ffd8644b6a0 sp 0x7ffd8644ae30 T0)\n    #0 0x48d0ae in __interceptor_memcmp (/root/tile-count/tile-count-merge+0x48d0ae)\n    #1 0x4dc6c9 in finder::operator\u003c(finder const\u0026) const /root/tile-count/merge.cpp:115:10\n    #2 0x4dc6c9 in bool __gnu_cxx::__ops::_Iter_less_val::operator()\u003cfinder*, finder const\u003e(finder*, finder const\u0026) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/predefined_ops.h:54\n    #3 0x4dc6c9 in finder* std::__lower_bound\u003cfinder*, finder, __gnu_cxx::__ops::_Iter_less_val\u003e(finder*, finder*, finder const\u0026, __gnu_cxx::__ops::_Iter_less_val) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/stl_algobase.h:965\n    #4 0x4ca6e0 in finder* std::lower_bound\u003cfinder*, finder\u003e(finder*, finder*, finder const\u0026) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/stl_algobase.h:999:14\n    #5 0x4ca6e0 in do_merge(merge*, unsigned long, int, int, long long, int, bool, unsigned long) /root/tile-count/merge.cpp:213\n    #6 0x4c38e4 in main /root/tile-count/mergetool.cpp:105:2\n    #7 0x7fba250bcb44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #8 0x4c248c in _start (/root/tile-count/tile-count-merge+0x4c248c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ??:0 __interceptor_memcmp\n==10201==ABORTING\n```","vulnerability_information_html":"\u003cp\u003eThis crash was triggered with \u003ccode\u003e642f773\u003c/code\u003e while fuzzing \u003ccode\u003etile-count-merge\u003c/code\u003e with AFL on Debian 8 x64.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e./tile-count-merge -o /dev/null test000\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eASAN:SIGSEGV\n=================================================================\n==10201==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000048d0af bp 0x7ffd8644b6a0 sp 0x7ffd8644ae30 T0)\n    #0 0x48d0ae in __interceptor_memcmp (/root/tile-count/tile-count-merge+0x48d0ae)\n    #1 0x4dc6c9 in finder::operator\u0026lt;(finder const\u0026amp;) const /root/tile-count/merge.cpp:115:10\n    #2 0x4dc6c9 in bool __gnu_cxx::__ops::_Iter_less_val::operator()\u0026lt;finder*, finder const\u0026gt;(finder*, finder const\u0026amp;) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/predefined_ops.h:54\n    #3 0x4dc6c9 in finder* std::__lower_bound\u0026lt;finder*, finder, __gnu_cxx::__ops::_Iter_less_val\u0026gt;(finder*, finder*, finder const\u0026amp;, __gnu_cxx::__ops::_Iter_less_val) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/stl_algobase.h:965\n    #4 0x4ca6e0 in finder* std::lower_bound\u0026lt;finder*, finder\u0026gt;(finder*, finder*, finder const\u0026amp;) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/bits/stl_algobase.h:999:14\n    #5 0x4ca6e0 in do_merge(merge*, unsigned long, int, int, long long, int, bool, unsigned long) /root/tile-count/merge.cpp:213\n    #6 0x4c38e4 in main /root/tile-count/mergetool.cpp:105:2\n    #7 0x7fba250bcb44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #8 0x4c248c in _start (/root/tile-count/tile-count-merge+0x4c248c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ??:0 __interceptor_memcmp\n==10201==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","weakness":{"id":51,"name":"NULL Pointer Dereference"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":199396,"file_name":"test000.gz","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/199/396/b8d11a8dbf39d16bb10abcb3fb9503181e6318d2/test000.gz?response-content-disposition=attachment%3B%20filename%3D%22test000.gz%22%3B%20filename%2A%3DUTF-8%27%27test000.gz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4HB4ZZGG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050957Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFBKbMTaGKwVCK0x7JNAOijlMVw%2BhW%2FIG%2FoSYnjiHiHKAiALX1HXrCEc%2FI%2FnVrq803X%2FALiQpBxAlCHE%2Bh8zwqcfmSq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM1pLsQIVwlUu9%2FWdzKpEDno5dfN3IVf%2B7OsdAYS9SWEsPaEcB2YetTOtoMoT8QkXafStRJxQSEckvansRxadLw3NEtOPJvUCKQ1FSfSh7PFvC6uVfFJETqBnLL3fMQIGcAQZlOES1A7KCuxJT2s%2FayJYm9KXYzydI49kvJbjn3MhPgu4OzSnr601lrMTBegiJpfNO%2B%2FeSktzRhCINpAxF%2F2a4j2lstKLfaje8wR6hRJqdSRWJF9M8hMiccij8fb6xzNCHJahS%2BfaEo7RLAy5%2FPpBxYVi3ogO%2Bi%2F4BRT3eb1Z9RpGG9qNkGuyY7ce3DvMgdTkSjHBcsYXBywd8fd%2BaBZwWJd5uw351hwVm22gEjaBsMXjDBuKYWVQcA%2BrEoUuOGGuH6bDr%2B2WdDMHHXX7MgZgH7ziMbq2HG%2FZKMv1Xym51QlR6qp3%2BP6Xz3oMScAiG6Dqm%2FjDmNx9bwBHdu7tvsWABnhe6esdM9Fno0WZ3lIkHOq4HRIf10Qe%2BDDAUhhVc45YNdWlThBy0I6Le7VinfP6o%2F%2BKPpdhWEDht%2BPKwSuwwvNGq%2FwU67AHczVFtKf2TPLO9ophgOhkJ%2BZe077T3hvPbRZ7D4GzMnizYODRG9nQWzx68CzHlMuom3RU16aBeESIBNhc9NjST%2Bt3Bw%2FkvdjiPIAwfnnl0ATW5KpAuIAujTjCnWWC5x9o79v0x9%2Bnkl%2BlSYo41rg7HDE%2BhHWG7fKOUzGpWpyUJFwUo4XO2BBz%2F9JPwjpoD5vZa6vKnLi1NmWkYRn1R6E4QMqIGHABVzTr2BlnRNMM7IY6DbFqrNpuXMJjVs26ZuTl70H1lwMzeG43ORGVGlYhsYokTZrRPzq8ZdhxoEwkFN0OgfU2QSH1HVj5iow%3D%3D\u0026X-Amz-Signature=35bc5e621f6bcad181c03f4311c18babe2586c8aba38f1e769691a796b95eed3","file_size":253,"type":"application/gzip"}],"allow_singular_disclosure_at":"2017-08-06T20:13:45.907Z","allow_singular_disclosure_after":-107168171.25080733,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","geeknik","apapedulimu","japz"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1797132,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@geeknik \n\nThank you for the report, can you please detail how and where this can be exploited? \n\nThank you,\nZack","markdown_message":"\u003cp\u003e\u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for the report, can you please detail how and where this can be exploited? \u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\nZack\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-02T01:08:19.584Z","updated_at":"2017-07-02T01:08:19.584Z","actor":{"username":"zmully","cleared":false,"url":"/zmully","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1797233,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I don't believe it to be exploitable for anything beyond crashing when a user feeds it malformed data (denial of service), it's just a bug that should be fixed and I was hoping to earn a few reputation points along the way. If you'd prefer a GHI, I can self close this and open an issue there.","markdown_message":"\u003cp\u003eI don\u0026#39;t believe it to be exploitable for anything beyond crashing when a user feeds it malformed data (denial of service), it\u0026#39;s just a bug that should be fixed and I was hoping to earn a few reputation points along the way. If you\u0026#39;d prefer a GHI, I can self close this and open an issue there.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-02T03:49:37.051Z","updated_at":"2017-07-02T03:49:37.051Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1807694,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geeknik \n\nThanks for your patience, the majority of our engineering teams are just returning from the 4th of July holiday  and once they've had a chance to look at this report, we'll get you an update. Until then, let's keep this report in HackerOne.\n\nThanks,\nZack","markdown_message":"\u003cp\u003e\u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your patience, the majority of our engineering teams are just returning from the 4th of July holiday  and once they\u0026#39;ve had a chance to look at this report, we\u0026#39;ll get you an update. Until then, let\u0026#39;s keep this report in HackerOne.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nZack\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-05T15:46:32.640Z","updated_at":"2017-07-05T15:46:32.640Z","actor":{"username":"zmully","cleared":false,"url":"/zmully","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815534,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@geeknik\n\nOur engineering team reviewed this report today and while there are no security implications for Mapbox's usage of it, they appreciate the bug report and have issued a fix for it (https://github.com/mapbox/tile-count/pull/41). We're going to close this as \"resolved\" since it was a valid bug report, but will not be awarding a bounty. \n\nThank you again for your report and your patience during this holiday week. \n\nBest,\nZack","markdown_message":"\u003cp\u003e\u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eOur engineering team reviewed this report today and while there are no security implications for Mapbox\u0026#39;s usage of it, they appreciate the bug report and have issued a fix for it (\u003ca title=\"https://github.com/mapbox/tile-count/pull/41\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmapbox%2Ftile-count%2Fpull%2F41\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mapbox/tile-count/pull/41\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). We\u0026#39;re going to close this as \u0026quot;resolved\u0026quot; since it was a valid bug report, but will not be awarding a bounty. \u003c/p\u003e\n\n\u003cp\u003eThank you again for your report and your patience during this holiday week. \u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nZack\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-07T20:11:58.858Z","updated_at":"2017-07-07T20:11:58.858Z","actor":{"username":"zmully","cleared":false,"url":"/zmully","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815544,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-07T20:13:45.863Z","updated_at":"2017-07-07T20:13:45.863Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1825061,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T15:36:07.300Z","updated_at":"2017-07-11T15:36:07.300Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1825062,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-11T15:36:07.331Z","updated_at":"2017-07-11T15:36:07.331Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1835774,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-14T14:36:56.817Z","updated_at":"2017-07-14T14:36:56.817Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mapbox"}},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}