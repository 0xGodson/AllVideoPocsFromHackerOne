{"id":47779,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Nzc3OQ==","url":"https://hackerone.com/reports/47779","title":"Heap overflow in H. Spencerâ€™s regex library on 32 bit systems ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-15T03:28:07.748Z","submitted_at":"2015-02-15T03:28:07.748Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"guido","url":"/guido","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-06T02:42:11.446Z","bug_reporter_agreed_on_going_public_at":"2015-04-06T02:42:10.825Z","team_member_agreed_on_going_public_at":"2015-04-06T02:40:53.527Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The IBB's programs provide a great incentive for me to find vulnerabilities in open source software. With this one I set out to find a vulnerability in PHP and discovered that the vulnerability that I found exists in a wider constellation of applications, including BSD libc's. IBB's Alex Rice's advice to contact CERT was very helpful. Judging by the amount of visitors of my blog article on the vulnerability, contacting CERT helped greatly in disseminating awareness and prompting maintainers to implement remedies, so thank you for that.\r\n\r\nMy original write-up: https://guidovranken.wordpress.com/2015/02/04/full-disclosure-heap-overflow-in-h-spencers-regex-library-on-32-bit-systems/\r\ncert.org: http://www.kb.cert.org/vuls/id/695940\r\nNetBSD: http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/regex/regcomp.c\r\nFreeBSD: https://github.com/freebsd/freebsd/commit/70c79b42a2551445f9a05cb0a6573d813587302a\r\nDragonfly BSD: http://gitweb.dragonflybsd.org/dragonfly.git/commit/2841837793bd095a82f477e9c370cfe6cfb3862c\r\nLLVM: http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20150202/257966.html\r\nRedhat: https://bugzilla.redhat.com/show_bug.cgi?id=1191049\r\nDebian: https://bugs.debian.org/cgi-bin/pkgreport.cgi?correspondent=luciano%40debian.org;include=subject%3Aregex;dist=unstable\r\n\r\nPHP is vulnerable, albeit in a deprecated set of functions, and the vulnerability can be exposed to the internet with a single line of PHP code. I have both filed a format bug report on their bug tracker and enquired about the status of said report at their security mail address, and as of present I have not received a response yet. The vulnerable code is statically included with PHP (ie. the presence of the vulnerability in PHP does not depend on the underlying libc).\r\n\r\nAndroid's Bionic libc may also be vulnerable since it includes the vulnerable code in its upsteam-netbsd directory ( https://github.com/android/platform_bionic/blob/7dd126a38ca501818b07927f310dcc0f531c0f1f/libc/upstream-netbsd/lib/libc/regex/regcomp.c#L270 ). I'm not sure if it's directly vulnerable but if you wish so I can try my best to check if it is.\r\n\r\nThanks,\r\n\r\nGuido","vulnerability_information_html":"\u003cp\u003eThe IBB\u0026#39;s programs provide a great incentive for me to find vulnerabilities in open source software. With this one I set out to find a vulnerability in PHP and discovered that the vulnerability that I found exists in a wider constellation of applications, including BSD libc\u0026#39;s. IBB\u0026#39;s Alex Rice\u0026#39;s advice to contact CERT was very helpful. Judging by the amount of visitors of my blog article on the vulnerability, contacting CERT helped greatly in disseminating awareness and prompting maintainers to implement remedies, so thank you for that.\u003c/p\u003e\n\n\u003cp\u003eMy original write-up: \u003ca title=\"https://guidovranken.wordpress.com/2015/02/04/full-disclosure-heap-overflow-in-h-spencers-regex-library-on-32-bit-systems/\" href=\"/redirect?url=https%3A%2F%2Fguidovranken.wordpress.com%2F2015%2F02%2F04%2Ffull-disclosure-heap-overflow-in-h-spencers-regex-library-on-32-bit-systems%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://guidovranken.wordpress.com/2015/02/04/full-disclosure-heap-overflow-in-h-spencers-regex-library-on-32-bit-systems/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\ncert.org: \u003ca title=\"http://www.kb.cert.org/vuls/id/695940\" href=\"/redirect?url=http%3A%2F%2Fwww.kb.cert.org%2Fvuls%2Fid%2F695940\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.kb.cert.org/vuls/id/695940\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nNetBSD: \u003ca title=\"http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/regex/regcomp.c\" href=\"/redirect?url=http%3A%2F%2Fcvsweb.netbsd.org%2Fbsdweb.cgi%2Fsrc%2Flib%2Flibc%2Fregex%2Fregcomp.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/regex/regcomp.c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nFreeBSD: \u003ca title=\"https://github.com/freebsd/freebsd/commit/70c79b42a2551445f9a05cb0a6573d813587302a\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffreebsd%2Ffreebsd%2Fcommit%2F70c79b42a2551445f9a05cb0a6573d813587302a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/freebsd/freebsd/commit/70c79b42a2551445f9a05cb0a6573d813587302a\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nDragonfly BSD: \u003ca title=\"http://gitweb.dragonflybsd.org/dragonfly.git/commit/2841837793bd095a82f477e9c370cfe6cfb3862c\" href=\"/redirect?url=http%3A%2F%2Fgitweb.dragonflybsd.org%2Fdragonfly.git%2Fcommit%2F2841837793bd095a82f477e9c370cfe6cfb3862c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitweb.dragonflybsd.org/dragonfly.git/commit/2841837793bd095a82f477e9c370cfe6cfb3862c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nLLVM: \u003ca title=\"http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20150202/257966.html\" href=\"/redirect?url=http%3A%2F%2Flists.cs.uiuc.edu%2Fpipermail%2Fllvm-commits%2FWeek-of-Mon-20150202%2F257966.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20150202/257966.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nRedhat: \u003ca title=\"https://bugzilla.redhat.com/show_bug.cgi?id=1191049\" href=\"/redirect?url=https%3A%2F%2Fbugzilla.redhat.com%2Fshow_bug.cgi%3Fid%3D1191049\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugzilla.redhat.com/show_bug.cgi?id=1191049\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nDebian: \u003ca title=\"https://bugs.debian.org/cgi-bin/pkgreport.cgi?correspondent=luciano%40debian.org%3Binclude=subject%3Aregex%3Bdist=unstable\" href=\"/redirect?url=https%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fpkgreport.cgi%3Fcorrespondent%3Dluciano%2540debian.org%253Binclude%3Dsubject%253Aregex%253Bdist%3Dunstable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.debian.org/cgi-bin/pkgreport.cgi?correspondent=luciano%40debian.org%3Binclude=subject%3Aregex%3Bdist=unstable\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePHP is vulnerable, albeit in a deprecated set of functions, and the vulnerability can be exposed to the internet with a single line of PHP code. I have both filed a format bug report on their bug tracker and enquired about the status of said report at their security mail address, and as of present I have not received a response yet. The vulnerable code is statically included with PHP (ie. the presence of the vulnerability in PHP does not depend on the underlying libc).\u003c/p\u003e\n\n\u003cp\u003eAndroid\u0026#39;s Bionic libc may also be vulnerable since it includes the vulnerable code in its upsteam-netbsd directory ( \u003ca title=\"https://github.com/android/platform_bionic/blob/7dd126a38ca501818b07927f310dcc0f531c0f1f/libc/upstream-netbsd/lib/libc/regex/regcomp.c#L270\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fandroid%2Fplatform_bionic%2Fblob%2F7dd126a38ca501818b07927f310dcc0f531c0f1f%2Flibc%2Fupstream-netbsd%2Flib%2Flibc%2Fregex%2Fregcomp.c%23L270\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/android/platform_bionic/blob/7dd126a38ca501818b07927f310dcc0f531c0f1f/libc/upstream-netbsd/lib/libc/regex/regcomp.c#L270\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ). I\u0026#39;m not sure if it\u0026#39;s directly vulnerable but if you wish so I can try my best to check if it is.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n\n\u003cp\u003eGuido\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-06T02:41:06.564Z","allow_singular_disclosure_after":-178341797.99459493,"singular_disclosure_allowed":true,"vote_count":1,"voters":["bluesheadone"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":341883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am wondering if the panel has reached a conclusion yet? Thanks.","markdown_message":"\u003cp\u003eI am wondering if the panel has reached a conclusion yet? Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-27T12:35:46.099Z","updated_at":"2015-02-27T12:35:46.099Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":347629,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For a comprehensive, more readable list of packages determined to be vulnerable in Debian, see: https://security-tracker.debian.org/tracker/TEMP-0778389-A8C6F9","markdown_message":"\u003cp\u003eFor a comprehensive, more readable list of packages determined to be vulnerable in Debian, see: \u003ca title=\"https://security-tracker.debian.org/tracker/TEMP-0778389-A8C6F9\" href=\"/redirect?url=https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FTEMP-0778389-A8C6F9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security-tracker.debian.org/tracker/TEMP-0778389-A8C6F9\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-06T15:01:28.706Z","updated_at":"2015-03-06T15:01:28.706Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":349744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's been over three weeks since I submitted this report, and over a month since I notified you of the public disclosure of the vulnerability via e-mail. I would appreciate it if you could give me some indication of the status of considerating my eligibility and when I can expect a more definitive conclusion, thanks.","markdown_message":"\u003cp\u003eIt\u0026#39;s been over three weeks since I submitted this report, and over a month since I notified you of the public disclosure of the vulnerability via e-mail. I would appreciate it if you could give me some indication of the status of considerating my eligibility and when I can expect a more definitive conclusion, thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-09T22:48:51.187Z","updated_at":"2015-03-09T22:48:51.187Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE-2015-2305 has been assigned: http://seclists.org/oss-sec/2015/q1/857\n\nPHP has now responded to my notification and has fixed the issue: https://bugs.php.net/bug.php?id=69248","markdown_message":"\u003cp\u003eCVE-2015-2305 has been assigned: \u003ca title=\"http://seclists.org/oss-sec/2015/q1/857\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Foss-sec%2F2015%2Fq1%2F857\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/oss-sec/2015/q1/857\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePHP has now responded to my notification and has fixed the issue: \u003ca title=\"https://bugs.php.net/bug.php?id=69248\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D69248\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=69248\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-18T00:25:39.428Z","updated_at":"2015-03-18T00:25:39.428Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372806,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T02:37:25.061Z","updated_at":"2015-04-06T02:37:25.061Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"guido","url":"/guido"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372807,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Solid find @guido and thanks for doing the extra effort to draw attention to this.","markdown_message":"\u003cp\u003eSolid find \u003ca href=\"/guido\"\u003e@guido\u003c/a\u003e and thanks for doing the extra effort to draw attention to this.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-06T02:40:06.209Z","updated_at":"2015-04-06T02:40:06.209Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"guido","url":"/guido"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372809,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T02:41:05.502Z","updated_at":"2015-04-06T02:41:05.502Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372811,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-06T02:42:11.136Z","updated_at":"2015-04-06T02:42:11.136Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372812,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T02:42:11.493Z","updated_at":"2015-04-06T02:42:11.493Z","actor":{"username":"guido","cleared":false,"url":"/guido","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/983/e55b0b2324777fb7efc2de4212fd8d337ca816bd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}