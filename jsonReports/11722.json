{"id":11722,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTcyMg==","url":"https://hackerone.com/reports/11722","title":"Simultaneous Session Logon : Improper Session Management","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-05-10T21:23:50.011Z","submitted_at":"2014-05-10T21:23:50.011Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0ctac0der","url":"/0ctac0der","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-08-26T06:09:59.286Z","bug_reporter_agreed_on_going_public_at":"2014-07-27T06:09:46.040Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nI would like to report this bug related to improper simultaneous logon. \r\n\r\nIssue: \r\n1) When a user is logged in to the application (already authenticated), visits the login page https://coinbase.com/signin he/she should directly get redirected to their home page as there is already a session running for the same user, but this is not happening in coinbase website. \r\n\r\n2) If one already logged in user visits the login page and enter the credentials to login as a different user, he gets logged in (provided the credentials are correct), but the session of the older user account is still alive this might cause session hijacking.\r\n\r\n3) As already logged in users can also visit the login page again and re-authenticate themselves, the activities page shows one more session running for the same account whereas the session identifier is same for all the sessions. \r\n\r\nI have tried showing all the three issues in the POC, please let me know if you need the POC video as i can't upload it here because of some issues. \r\n\r\nRoot Cause: I guess for simultaneous session logon you guys are not using the device id parameter, hence same user can reauth himself again and again from the same device. Secondly,. the login page is not checking whether the user already have an active session or not and hence redirecting. \r\n","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nI would like to report this bug related to improper simultaneous logon. \u003c/p\u003e\n\n\u003cp\u003eIssue: \u003cbr\u003e\n1) When a user is logged in to the application (already authenticated), visits the login page \u003ca title=\"https://coinbase.com/signin\" href=\"/redirect?url=https%3A%2F%2Fcoinbase.com%2Fsignin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://coinbase.com/signin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e he/she should directly get redirected to their home page as there is already a session running for the same user, but this is not happening in coinbase website. \u003c/p\u003e\n\n\u003cp\u003e2) If one already logged in user visits the login page and enter the credentials to login as a different user, he gets logged in (provided the credentials are correct), but the session of the older user account is still alive this might cause session hijacking.\u003c/p\u003e\n\n\u003cp\u003e3) As already logged in users can also visit the login page again and re-authenticate themselves, the activities page shows one more session running for the same account whereas the session identifier is same for all the sessions. \u003c/p\u003e\n\n\u003cp\u003eI have tried showing all the three issues in the POC, please let me know if you need the POC video as i can\u0026#39;t upload it here because of some issues. \u003c/p\u003e\n\n\u003cp\u003eRoot Cause: I guess for simultaneous session logon you guys are not using the device id parameter, hence same user can reauth himself again and again from the same device. Secondly,. the login page is not checking whether the user already have an active session or not and hence redirecting. \u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-26T06:09:46.307Z","allow_singular_disclosure_after":-200182160.27794024,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":54512,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nAny update on this?? ","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eAny update on this?? \u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-21T03:25:54.675Z","updated_at":"2014-05-21T03:25:54.675Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":63934,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"What is the attack scenario you see here exactly? How is this a security issue?","markdown_message":"\u003cp\u003eWhat is the attack scenario you see here exactly? How is this a security issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-02T22:13:08.712Z","updated_at":"2014-06-02T22:13:08.712Z","actor":{"username":"mandatory","cleared":false,"url":"/mandatory","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":64877,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"There can be multiple possibilities:\n\n1) Sign In/Login page should always check whether there is a running valid session existing or not. But with coinbase it is not, which is the first flaw as i see. \n\n2) As whenever a new session is made the session identifier is not change, it might lead to session fixation.\n\n3) Lets say i am the attacker, and i know that i can create multiple sessions (as per activities page) i will make a script which will send the same credentials to the server and the new session will be created and will be shown in the activities page. This was i can flood the account to as many sessions as possible without using multiple devices/IP.\n\nI hope above three scenario gives a little picture of \"WHY SIGN IN PAGE SHOULD CHECK FOR A RUNNING SESSION IN THE BROWSER\".\n\nPlease let me know if you need more info from my side. ","markdown_message":"\u003cp\u003eThere can be multiple possibilities:\u003c/p\u003e\n\n\u003cp\u003e1) Sign In/Login page should always check whether there is a running valid session existing or not. But with coinbase it is not, which is the first flaw as i see. \u003c/p\u003e\n\n\u003cp\u003e2) As whenever a new session is made the session identifier is not change, it might lead to session fixation.\u003c/p\u003e\n\n\u003cp\u003e3) Lets say i am the attacker, and i know that i can create multiple sessions (as per activities page) i will make a script which will send the same credentials to the server and the new session will be created and will be shown in the activities page. This was i can flood the account to as many sessions as possible without using multiple devices/IP.\u003c/p\u003e\n\n\u003cp\u003eI hope above three scenario gives a little picture of \u0026quot;WHY SIGN IN PAGE SHOULD CHECK FOR A RUNNING SESSION IN THE BROWSER\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need more info from my side. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T11:39:16.910Z","updated_at":"2014-06-03T11:39:35.535Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":70721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nAny update.","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eAny update.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-10T04:39:44.839Z","updated_at":"2014-06-10T04:39:44.839Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team, \n\nPlease let me know if you need more info from my side. Thanks ","markdown_message":"\u003cp\u003eHi team, \u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need more info from my side. Thanks \u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-19T15:29:23.089Z","updated_at":"2014-06-19T15:29:23.089Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":78687,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.","markdown_message":"\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-24T21:21:30.649Z","updated_at":"2014-06-24T21:21:30.649Z","actor":{"username":"aestheticprincess","cleared":false,"url":"/aestheticprincess","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":96689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Coinbase Team.\n\nIt has been 3 months since i submitted this request, and later after review you guys closed this as won't fix. I tried explaining the attack scenario to you, but @mandatory and @aestheticprincess were not convinced. \n\nI checked the coinbase website today and i found that the same modifications have been done which i suggested in this report.\n\nI am not able to understand that if it wasn't enough for you guys to consider it a valid report then why you made a configuration change in the website. \n\nBugbounty programs always works on the trust relation between bughunter and the application owner/response team, if you guys will not provide proper closure and justifications to the reports, it will be very demoralizing for guys like me who take out time from our schedule and try to find bugs. \n\nI have always appreciated the work of Coinbase team, but this time i guess i am disappointed. \nI will really appreciate if you can let me know that why you closed this report as \"won't fix\". Below are few things, which i suggested in my report and got fixed:\n\n1) The Signin page is now redirecting already loggedin users to their account page. \n2) Multiple sessions are not getting created from same device and same browser. \n\nPlease respond as soon as possible and reopen this bug if you agree to my points. ","markdown_message":"\u003cp\u003eHi Coinbase Team.\u003c/p\u003e\n\n\u003cp\u003eIt has been 3 months since i submitted this request, and later after review you guys closed this as won\u0026#39;t fix. I tried explaining the attack scenario to you, but \u003ca href=\"/mandatory\"\u003e@mandatory\u003c/a\u003e and \u003ca href=\"/aestheticprincess\"\u003e@aestheticprincess\u003c/a\u003e were not convinced. \u003c/p\u003e\n\n\u003cp\u003eI checked the coinbase website today and i found that the same modifications have been done which i suggested in this report.\u003c/p\u003e\n\n\u003cp\u003eI am not able to understand that if it wasn\u0026#39;t enough for you guys to consider it a valid report then why you made a configuration change in the website. \u003c/p\u003e\n\n\u003cp\u003eBugbounty programs always works on the trust relation between bughunter and the application owner/response team, if you guys will not provide proper closure and justifications to the reports, it will be very demoralizing for guys like me who take out time from our schedule and try to find bugs. \u003c/p\u003e\n\n\u003cp\u003eI have always appreciated the work of Coinbase team, but this time i guess i am disappointed. \u003cbr\u003e\nI will really appreciate if you can let me know that why you closed this report as \u0026quot;won\u0026#39;t fix\u0026quot;. Below are few things, which i suggested in my report and got fixed:\u003c/p\u003e\n\n\u003cp\u003e1) The Signin page is now redirecting already loggedin users to their account page. \u003cbr\u003e\n2) Multiple sessions are not getting created from same device and same browser. \u003c/p\u003e\n\n\u003cp\u003ePlease respond as soon as possible and reopen this bug if you agree to my points. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-27T05:52:00.133Z","updated_at":"2014-07-27T05:52:00.133Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":96692,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-27T06:09:46.056Z","updated_at":"2014-07-27T06:09:46.056Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":98104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Team, \n\nAny update? ","markdown_message":"\u003cp\u003eHi Team, \u003c/p\u003e\n\n\u003cp\u003eAny update? \u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-30T08:15:07.097Z","updated_at":"2014-07-30T08:15:07.097Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":100945,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HI team, can you please look into it.","markdown_message":"\u003cp\u003eHI team, can you please look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-06T14:04:26.413Z","updated_at":"2014-08-06T14:04:26.413Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":115497,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-26T06:09:59.320Z","updated_at":"2014-08-26T06:09:59.320Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":596602,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-23T19:29:37.285Z","updated_at":"2015-09-23T19:29:37.285Z","additional_data":{"duplicate_report_id":90225},"actor":{"username":"souicat007","cleared":false,"url":"/souicat007","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}