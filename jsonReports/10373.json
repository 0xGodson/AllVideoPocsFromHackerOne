{"id":10373,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDM3Mw==","url":"https://hackerone.com/reports/10373","title":"Bypassing Same Origin Policy With JSONP APIs and Flash","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-29T23:54:14.670Z","submitted_at":"2014-04-29T23:54:14.670Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"molnarg","url":"/molnarg","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-19T17:32:22.258Z","bug_reporter_agreed_on_going_public_at":"2014-07-19T13:03:05.495Z","team_member_agreed_on_going_public_at":"2014-07-19T17:32:21.959Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Overview\n========\n\nThis is a new type of web vulnerability that is made possible by two seemingly unrelated things:\n\n- the way JSONP APIs work\n- the way Flash handles malformed SWF files\n\nand has an effect and limitations similar to XSS flaws:\n\n- the user has to visit a website set up by the attacker in order to trigger the vulnerability\n- as a result, the attacker can make arbitrary HTTP request to the vulnerable domain (with the user's cookies sent along with the request) and read the responses\n\nDescription\n===========\n\n[JSONP] APIs return JSON data wrapped by an invocation of a callback function specified by the caller.  The caller first defines a JavaScript function and then injects a script tag with the JSON API URL as if it were a JavaScript file to load. JSONP APIs became popular because making JSONP requests are is not forbidden by the Same Origin Policy.\n\nFrom the point of view of this discussion, the important part is that **the first bytes of the response can be controlled by a GET parameter** (typically named callback).\n\nIf an attacker can create a Flash file, that can be passed as callback parameter to a JSONP API, and passes the filters applied to the callback name, then she is able to load this Flash file in the security context of the JSONP API's domain (the target domain). After the Flash file is loaded, she can make HTTP requests through it to the target domain in the name of the user.\n\nExample:\n\n    \u003cobject type=\"application/x-shockwave-flash\"\n            data=\"http://example.com/jsonp-api?callback=__URL_ENCODED_SWF__\"\u003e\n      \u003cparam name=\"AllowScriptAccess\" value=\"always\"\u003e\n    \u003c/object\u003e\n\nThe response to the HTTP request:\n\n    __SWF_FILE__({\"actual\": \"API\", \"response\": 15})\n\nThere is two significant problems that have to be solved by an attacker:\n\n 1. the end of the response is the actual JSON API response, and that makes the response as a whole an invalid SWF file.\n 2. callback names are almost always filtered, forcing the callback parameter into the [A-Za-z0-9] range\n\nThe first problem is in fact solved by the way **Flash** handles invalid SWF files: it **ignores additional bytes at the end of an otherwise valid Flash file**.\n\nThe second problem turns out to be solvable too. The SWF file format specifies a way to compress the whole file (except an 8 byte header) as a DEFLATE stream. **It is possible to create a DEFLATE stream in the [A-Za-z0-9] character range for arbitrary binary data.** (As proven by my [ascii-zip] project)\n\nAs a demonstration, I've created a Flash file in the given character range that can load an arbitrary SWF file given by the embedder site (the attacker website) into it's security context (the target domain's security context):\n\n    CWSA7000hCD0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtWGDtGDGwwwDDGDG0Gt0GDGwtGDG0sDttwwwDG33w0sDDt03G33333sDfBDIHTOHHoKHBhHZLxHHHrlbhHHtHRHXXHHHdHDuYAENjmENDaqfvjmENyDjmENJYYfmLzMENYQfaFQENYnfVNx1D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwwEDG3w0sG0stDDGtw0GDDwwwt3wt333333w03333gFPaEIQSNvTnmAqICTcsacSCtiUAcYVsSyUcliUAcYVIkSICMAULiUAcYVq9D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwuG333swG033GDtpDtDtDGDD33333s03333sdFPOwWgotOOOOOOOwodFhfhFtFLFlHLTXXTXxT8D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7kiudIbEAt33swwEGDDtDG0GGDDwwwDt0wDGwwGG0sDDt033333GDt333swwv3sFPDtdtthLtDdthTthxthXXHHHHhHHHHHHhHXhHHHHXhXhXHXhHhiOUOsxCxHwWhsXKTgtSXhsDCDHshghSLhmHHhDXHhEOUoZQHHshghoeXehMdXwSlhsXkhehMdhwSXhXmHH5D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUUwGNqdIbe133333333333333333sUUef03gfzA8880HUAH\n\nThe embedder site can specify the SWF to load through the \"name\" property of the object tag. The specified SWF file could be a [cross domain proxy] that can make HTTP requests for the embedder site.\n\nRelated work\n============\n\nThis attack is inspired by Alok Menghrajani's [related work], where he showed that it is possible to assemble a Flash file in the [\\x01-\\0x7F] byte range to prove that certain JSONP endpoints are not secure.\n\nThe real contribution of my work is the demonstration of the fact that this attack is also feasible in the [A-Za-z0-9] character range. This is critical because overwhelming majority of the JSONP endpoints only accept this character range in the callback name.\n\nMitigation\n==========\n\nLimiting the callback name length is not a good solution, as there is no strong guarantee that it is not possible to come up with an SWF file that conforms to this tightened filter.\n\nThe API maintainer can mitigate this type of attack by **putting an empty JavaScript callback in front of the callback name in the repsonse**. This makes it impossible to control the first bytes of the response.\n\nAn other protection would be **hosting JSONP APIs on a sandbox domain**. The latter solution is only effective if there's no crossdomain.xml rule that would allow requests from the sandbox domain to the main domain.\n\nA proper solution would be **changing the way Flash handles malformed SWF files so that it won't files with additional data at the end of the SWF file**.\n\nAlthough one of the mitigations is fixing Flash, I don't consider this a Flash vulnerability, as an affected site does not even have to use the Flash technology in order to be vulnerable.\n\nAffected sites\n==============\n\nI've tested the 35 top websites on Wikipedia's (somewhat out of date) copy of the Alexa [toplist](http://en.wikipedia.org/wiki/List_of_most_popular_websites) (after unifying www.google.* domains into a single entry), and 16 (~45%) of them proved to be vulnerable.\n\nThe unaffected sites fall into the following categories:\n- Sites that simply don't have any JSONP API.\n- Google and Facebook: JSONP answers from these sites begin with empty JavaScript comments (probably because they are being extremely cautious and implemented this protection after the publication of Alok Menghrajani's [related work]).\n- Sites that host all JSONP APIs on a different domain (this is considered as a best practice) and don't have crossdomain.xml rule on the main site that enables cross domain requests from the API domain.\n- A single site limits the callback name length to 50 characters.\n\n[DEMO](https://gabor.molnar.es/bb/9bfb0835d1e72705bb374132c4d2cb3e9a4417e91b9be31a074fb7d644b34988/octameter.html)\n=======\n\nJSONP: http://json-p.org/\nascii-zip: https://github.com/molnarg/ascii-zip\ncross domain proxy: https://github.com/borisreitman/CrossXHR\nrelated work: http://quaxio.com/jsonp_handcrafted_flash_files/\ntoplist: http://en.wikipedia.org/wiki/List_of_most_popular_websites\n","vulnerability_information_html":"\u003ch1 id=\"overview\"\u003eOverview\u003c/h1\u003e\n\n\u003cp\u003eThis is a new type of web vulnerability that is made possible by two seemingly unrelated things:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ethe way JSONP APIs work\u003c/li\u003e\n\u003cli\u003ethe way Flash handles malformed SWF files\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eand has an effect and limitations similar to XSS flaws:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ethe user has to visit a website set up by the attacker in order to trigger the vulnerability\u003c/li\u003e\n\u003cli\u003eas a result, the attacker can make arbitrary HTTP request to the vulnerable domain (with the user\u0026#39;s cookies sent along with the request) and read the responses\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003e[JSONP] APIs return JSON data wrapped by an invocation of a callback function specified by the caller.  The caller first defines a JavaScript function and then injects a script tag with the JSON API URL as if it were a JavaScript file to load. JSONP APIs became popular because making JSONP requests are is not forbidden by the Same Origin Policy.\u003c/p\u003e\n\n\u003cp\u003eFrom the point of view of this discussion, the important part is that \u003cstrong\u003ethe first bytes of the response can be controlled by a GET parameter\u003c/strong\u003e (typically named callback).\u003c/p\u003e\n\n\u003cp\u003eIf an attacker can create a Flash file, that can be passed as callback parameter to a JSONP API, and passes the filters applied to the callback name, then she is able to load this Flash file in the security context of the JSONP API\u0026#39;s domain (the target domain). After the Flash file is loaded, she can make HTTP requests through it to the target domain in the name of the user.\u003c/p\u003e\n\n\u003cp\u003eExample:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;object type=\u0026quot;application/x-shockwave-flash\u0026quot;\n        data=\u0026quot;http://example.com/jsonp-api?callback=__URL_ENCODED_SWF__\u0026quot;\u0026gt;\n  \u0026lt;param name=\u0026quot;AllowScriptAccess\u0026quot; value=\u0026quot;always\u0026quot;\u0026gt;\n\u0026lt;/object\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe response to the HTTP request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e__SWF_FILE__({\u0026quot;actual\u0026quot;: \u0026quot;API\u0026quot;, \u0026quot;response\u0026quot;: 15})\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThere is two significant problems that have to be solved by an attacker:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ethe end of the response is the actual JSON API response, and that makes the response as a whole an invalid SWF file.\u003c/li\u003e\n\u003cli\u003ecallback names are almost always filtered, forcing the callback parameter into the [A-Za-z0-9] range\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe first problem is in fact solved by the way \u003cstrong\u003eFlash\u003c/strong\u003e handles invalid SWF files: it \u003cstrong\u003eignores additional bytes at the end of an otherwise valid Flash file\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe second problem turns out to be solvable too. The SWF file format specifies a way to compress the whole file (except an 8 byte header) as a DEFLATE stream. \u003cstrong\u003eIt is possible to create a DEFLATE stream in the [A-Za-z0-9] character range for arbitrary binary data.\u003c/strong\u003e (As proven by my [ascii-zip] project)\u003c/p\u003e\n\n\u003cp\u003eAs a demonstration, I\u0026#39;ve created a Flash file in the given character range that can load an arbitrary SWF file given by the embedder site (the attacker website) into it\u0026#39;s security context (the target domain\u0026#39;s security context):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCWSA7000hCD0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtWGDtGDGwwwDDGDG0Gt0GDGwtGDG0sDttwwwDG33w0sDDt03G33333sDfBDIHTOHHoKHBhHZLxHHHrlbhHHtHRHXXHHHdHDuYAENjmENDaqfvjmENyDjmENJYYfmLzMENYQfaFQENYnfVNx1D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwwEDG3w0sG0stDDGtw0GDDwwwt3wt333333w03333gFPaEIQSNvTnmAqICTcsacSCtiUAcYVsSyUcliUAcYVIkSICMAULiUAcYVq9D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7CiudIbEAtwwuG333swG033GDtpDtDtDGDD33333s03333sdFPOwWgotOOOOOOOwodFhfhFtFLFlHLTXXTXxT8D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUU7kiudIbEAt33swwEGDDtDG0GGDDwwwDt0wDGwwGG0sDDt033333GDt333swwv3sFPDtdtthLtDdthTthxthXXHHHHhHHHHHHhHXhHHHHXhXhXHXhHhiOUOsxCxHwWhsXKTgtSXhsDCDHshghSLhmHHhDXHhEOUoZQHHshghoeXehMdXwSlhsXkhehMdhwSXhXmHH5D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SUUnUUUwGNqdIbe133333333333333333sUUef03gfzA8880HUAH\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe embedder site can specify the SWF to load through the \u0026quot;name\u0026quot; property of the object tag. The specified SWF file could be a [cross domain proxy] that can make HTTP requests for the embedder site.\u003c/p\u003e\n\n\u003ch1 id=\"related-work\"\u003eRelated work\u003c/h1\u003e\n\n\u003cp\u003eThis attack is inspired by Alok Menghrajani\u0026#39;s [related work], where he showed that it is possible to assemble a Flash file in the [\\x01-\\0x7F] byte range to prove that certain JSONP endpoints are not secure.\u003c/p\u003e\n\n\u003cp\u003eThe real contribution of my work is the demonstration of the fact that this attack is also feasible in the [A-Za-z0-9] character range. This is critical because overwhelming majority of the JSONP endpoints only accept this character range in the callback name.\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cp\u003eLimiting the callback name length is not a good solution, as there is no strong guarantee that it is not possible to come up with an SWF file that conforms to this tightened filter.\u003c/p\u003e\n\n\u003cp\u003eThe API maintainer can mitigate this type of attack by \u003cstrong\u003eputting an empty JavaScript callback in front of the callback name in the repsonse\u003c/strong\u003e. This makes it impossible to control the first bytes of the response.\u003c/p\u003e\n\n\u003cp\u003eAn other protection would be \u003cstrong\u003ehosting JSONP APIs on a sandbox domain\u003c/strong\u003e. The latter solution is only effective if there\u0026#39;s no crossdomain.xml rule that would allow requests from the sandbox domain to the main domain.\u003c/p\u003e\n\n\u003cp\u003eA proper solution would be \u003cstrong\u003echanging the way Flash handles malformed SWF files so that it won\u0026#39;t files with additional data at the end of the SWF file\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eAlthough one of the mitigations is fixing Flash, I don\u0026#39;t consider this a Flash vulnerability, as an affected site does not even have to use the Flash technology in order to be vulnerable.\u003c/p\u003e\n\n\u003ch1 id=\"affected-sites\"\u003eAffected sites\u003c/h1\u003e\n\n\u003cp\u003eI\u0026#39;ve tested the 35 top websites on Wikipedia\u0026#39;s (somewhat out of date) copy of the Alexa \u003ca href=\"/redirect?url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FList_of_most_popular_websites\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etoplist\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (after unifying \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.google.%2A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.google.*\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e domains into a single entry), and 16 (~45%) of them proved to be vulnerable.\u003c/p\u003e\n\n\u003cp\u003eThe unaffected sites fall into the following categories:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSites that simply don\u0026#39;t have any JSONP API.\u003c/li\u003e\n\u003cli\u003eGoogle and Facebook: JSONP answers from these sites begin with empty JavaScript comments (probably because they are being extremely cautious and implemented this protection after the publication of Alok Menghrajani\u0026#39;s [related work]).\u003c/li\u003e\n\u003cli\u003eSites that host all JSONP APIs on a different domain (this is considered as a best practice) and don\u0026#39;t have crossdomain.xml rule on the main site that enables cross domain requests from the API domain.\u003c/li\u003e\n\u003cli\u003eA single site limits the callback name length to 50 characters.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"demo\"\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgabor.molnar.es%2Fbb%2F9bfb0835d1e72705bb374132c4d2cb3e9a4417e91b9be31a074fb7d644b34988%2Foctameter.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eDEMO\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/h1\u003e\n\n\u003cp\u003eJSONP: \u003ca title=\"http://json-p.org/\" href=\"/redirect?url=http%3A%2F%2Fjson-p.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://json-p.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nascii-zip: \u003ca title=\"https://github.com/molnarg/ascii-zip\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmolnarg%2Fascii-zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/molnarg/ascii-zip\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\ncross domain proxy: \u003ca title=\"https://github.com/borisreitman/CrossXHR\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fborisreitman%2FCrossXHR\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/borisreitman/CrossXHR\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nrelated work: \u003ca title=\"http://quaxio.com/jsonp_handcrafted_flash_files/\" href=\"/redirect?url=http%3A%2F%2Fquaxio.com%2Fjsonp_handcrafted_flash_files%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://quaxio.com/jsonp_handcrafted_flash_files/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\ntoplist: \u003ca title=\"http://en.wikipedia.org/wiki/List_of_most_popular_websites\" href=\"/redirect?url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FList_of_most_popular_websites\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://en.wikipedia.org/wiki/List_of_most_popular_websites\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-18T13:03:05.798Z","allow_singular_disclosure_after":-200848195.20161018,"singular_disclosure_allowed":true,"vote_count":4,"voters":["tarwadahorse","zeroknife","find0xt","flexorium"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":41994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems like newlines are significant in HackerOne's Markdown formatter,  and that messed up formatting. Sorry for that, but I see no way to edit the original description :/ ","markdown_message":"\u003cp\u003eIt seems like newlines are significant in HackerOne\u0026#39;s Markdown formatter,  and that messed up formatting. Sorry for that, but I see no way to edit the original description :/ \u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-30T07:51:32.086Z","updated_at":"2014-04-30T07:51:32.086Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":43782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"An update regarding Alok Menghrajani's related work after exchanging a few emails with him: it is not clear from the notes on the website, but in the end, he didn't manage to escalate access into making HTTP request on behalf of the affected domains (where the callback filter was [\\x01-\\0x7F]).","markdown_message":"\u003cp\u003eAn update regarding Alok Menghrajani\u0026#39;s related work after exchanging a few emails with him: it is not clear from the notes on the website, but in the end, he didn\u0026#39;t manage to escalate access into making HTTP request on behalf of the affected domains (where the callback filter was [\\x01-\\0x7F]).\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-03T13:59:34.403Z","updated_at":"2014-05-03T13:59:34.403Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":44714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if it would make more sense to resubmit this as a joint work of Alok and me, as our work is complementary: he discovered a novel theoretical attack, and I presented an extended version that is not only practical, but also affects large number of sites.","markdown_message":"\u003cp\u003ePlease let me know if it would make more sense to resubmit this as a joint work of Alok and me, as our work is complementary: he discovered a novel theoretical attack, and I presented an extended version that is not only practical, but also affects large number of sites.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-06T07:53:24.757Z","updated_at":"2014-05-06T07:53:24.757Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":50929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@molnarg - Please accept my apologies for the inexcusable delay here. This looks like something the IBB panel would consider for a reward, given the novelty along with the significant number of vulnerable web properties you've identified. Have you already begun notifying the affected sites? If not, do you have a timeline for doing so? We should try to coordinate any reward here with most of those sites having sufficient time to patch.","markdown_message":"\u003cp\u003e\u003ca href=\"/molnarg\"\u003e@molnarg\u003c/a\u003e - Please accept my apologies for the inexcusable delay here. This looks like something the IBB panel would consider for a reward, given the novelty along with the significant number of vulnerable web properties you\u0026#39;ve identified. Have you already begun notifying the affected sites? If not, do you have a timeline for doing so? We should try to coordinate any reward here with most of those sites having sufficient time to patch.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-14T18:36:11.257Z","updated_at":"2014-05-14T18:36:11.257Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":51021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for moving this issue forward!\n\nAt first, I did not realise how widespread this issue was, and I've notified two sites: Shopify and PayPal. Shopify patched this quickly, but PayPal did not yet respond to my report. I guess I should contact them again and ask to not publish any info about this until at least most of the high profile sites are fixed.\n\nAre you sure the best approach would be notifying sites and fixing these holes one by one? The other way would be **notifying Adobe and ask for a fix in Flash**. Or, as Alok suggested to me, **browsers could refuse loading the JSONP response as Flash when the Content-Type header explicitly states that this is not Flash content** at all. Unfortunately, the current behaviour is [standardised in HTML5](http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element) and I doubt this issue would be enough to change the standard.\n\nI have no timeline in mind yet, and no serious experience in coordinating this kind of stuff. Could you recommend a reasonable timeline?\n\n","markdown_message":"\u003cp\u003eThanks for moving this issue forward!\u003c/p\u003e\n\n\u003cp\u003eAt first, I did not realise how widespread this issue was, and I\u0026#39;ve notified two sites: Shopify and PayPal. Shopify patched this quickly, but PayPal did not yet respond to my report. I guess I should contact them again and ask to not publish any info about this until at least most of the high profile sites are fixed.\u003c/p\u003e\n\n\u003cp\u003eAre you sure the best approach would be notifying sites and fixing these holes one by one? The other way would be \u003cstrong\u003enotifying Adobe and ask for a fix in Flash\u003c/strong\u003e. Or, as Alok suggested to me, \u003cstrong\u003ebrowsers could refuse loading the JSONP response as Flash when the Content-Type header explicitly states that this is not Flash content\u003c/strong\u003e at all. Unfortunately, the current behaviour is \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.w3.org%2FTR%2Fhtml5%2Fembedded-content-0.html%23the-object-element\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003estandardised in HTML5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and I doubt this issue would be enough to change the standard.\u003c/p\u003e\n\n\u003cp\u003eI have no timeline in mind yet, and no serious experience in coordinating this kind of stuff. Could you recommend a reasonable timeline?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-14T19:54:56.091Z","updated_at":"2014-05-14T19:54:56.091Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":66210,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would be happy to contact Adobe as a first step, but I guess you have a better contact with them through HackerOne. What do you think?\n\nAlso, if they don't want to break backwards compatibility because of this, how about contacting top sites and giving a final disclosure date around 4 months from now? That should be enough for everybody to fix this.","markdown_message":"\u003cp\u003eI would be happy to contact Adobe as a first step, but I guess you have a better contact with them through HackerOne. What do you think?\u003c/p\u003e\n\n\u003cp\u003eAlso, if they don\u0026#39;t want to break backwards compatibility because of this, how about contacting top sites and giving a final disclosure date around 4 months from now? That should be enough for everybody to fix this.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-04T09:43:35.734Z","updated_at":"2014-06-04T09:43:35.734Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":84697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There's a conference CFP deadline on 13th July (Hacktivity, a hungarian conference) and I'd like to apply with a talk about JSONP security, and with this specific issue. The conference itself is on 10th and 11th of October.\n\nBefore I apply, I'd like to hear wether you guys think the final disclosure date of 10th of October would be reasonable for this issue.","markdown_message":"\u003cp\u003eThere\u0026#39;s a conference CFP deadline on 13th July (Hacktivity, a hungarian conference) and I\u0026#39;d like to apply with a talk about JSONP security, and with this specific issue. The conference itself is on 10th and 11th of October.\u003c/p\u003e\n\n\u003cp\u003eBefore I apply, I\u0026#39;d like to hear wether you guys think the final disclosure date of 10th of October would be reasonable for this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-05T10:46:02.266Z","updated_at":"2014-07-05T10:46:02.266Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/","markdown_message":"\u003cp\u003e\u003ca title=\"http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\" href=\"/redirect?url=http%3A%2F%2Fmiki.it%2Fblog%2F2014%2F7%2F8%2Fabusing-jsonp-with-rosetta-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-08T18:06:38.586Z","updated_at":"2014-07-08T18:06:38.586Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It looks like Adobe has a partial mitigation landing in APSB14-17, potentially from a parallel discovery. Did you end up contacting Adobe PSIRT directly? Either way, the details and mitigation are public now and I'll put this up to the panel for a bounty vote.","markdown_message":"\u003cp\u003eIt looks like Adobe has a partial mitigation landing in APSB14-17, potentially from a parallel discovery. Did you end up contacting Adobe PSIRT directly? Either way, the details and mitigation are public now and I\u0026#39;ll put this up to the panel for a bounty vote.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-08T19:03:10.690Z","updated_at":"2014-07-08T19:03:10.690Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"They were contacted by Michele Spagnuolo from Google who discovered this in parallel. See his blog post here: http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/","markdown_message":"\u003cp\u003eThey were contacted by Michele Spagnuolo from Google who discovered this in parallel. See his blog post here: \u003ca title=\"http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\" href=\"/redirect?url=http%3A%2F%2Fmiki.it%2Fblog%2F2014%2F7%2F8%2Fabusing-jsonp-with-rosetta-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-08T19:20:57.714Z","updated_at":"2014-07-08T19:21:37.865Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for putting it up for a vote.","markdown_message":"\u003cp\u003eThanks for putting it up for a vote.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-08T19:21:59.031Z","updated_at":"2014-07-08T19:21:59.031Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It turns out after looking at Michele's code that he used my algorithms and exact Huffman tables from https://github.com/molnarg/ascii-zip . He even acknowledged it in the CREDITS file: https://github.com/mikispag/rosettaflash/blob/master/CREDITS","markdown_message":"\u003cp\u003eIt turns out after looking at Michele\u0026#39;s code that he used my algorithms and exact Huffman tables from \u003ca title=\"https://github.com/molnarg/ascii-zip\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmolnarg%2Fascii-zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/molnarg/ascii-zip\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e . He even acknowledged it in the CREDITS file: \u003ca title=\"https://github.com/mikispag/rosettaflash/blob/master/CREDITS\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmikispag%2Frosettaflash%2Fblob%2Fmaster%2FCREDITS\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mikispag/rosettaflash/blob/master/CREDITS\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-08T20:36:24.664Z","updated_at":"2014-07-08T20:36:24.664Z","actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":91777,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-18T23:44:44.626Z","updated_at":"2014-07-18T23:44:44.626Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"molnarg","url":"/molnarg"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":91778,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-18T23:45:03.061Z","updated_at":"2014-07-18T23:45:03.061Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"molnarg","url":"/molnarg"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":91965,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-19T13:03:05.516Z","updated_at":"2014-07-19T13:03:05.516Z","first_to_agree":true,"actor":{"username":"molnarg","cleared":false,"url":"/molnarg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":92015,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-19T17:32:21.977Z","updated_at":"2014-07-19T17:32:21.977Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":92016,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-19T17:32:22.275Z","updated_at":"2014-07-19T17:32:22.275Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}