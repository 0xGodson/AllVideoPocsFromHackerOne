{"id":331428,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzE0Mjg=","url":"https://hackerone.com/reports/331428","title":"Cross domain tracking even with 3rd party cookies disabled.","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-03-30T19:15:36.506Z","submitted_at":"2018-03-30T19:15:36.506Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kmodi","url":"/kmodi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/164/034/95df7d59a39c078497891cefff825eaf86197a04_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-08-07T22:46:40.235Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-04-02T21:46:22.905Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Cross domain tracking\nDefault settings from Brave browser has 3rd party cookies disabled. Which I am assuming also disables 3rd part storage like IndexedDB etc. Because of this protection it is not possible for a 3rd party to track users across multiple domains.\n\nBut, Even though third-party cookies is disabled by default using Shared workers, a third-party is able to track the user across domains and websites.\n\nREPRODUCTION STEPS\nIf you visit the these three pages in three tabs, you will notice that as a third-party it can learn the movement of a user across domains, even though the user has disabled 3rd party cookies.\n\nhttps://cdn.cliqz.com/browser-f/fun-demo/some-random-page.html\nhttps://cdn2.ghostery.com/browser-f/fun-demo/some-random-page.html\n\nThe third party script is being loaded from https://konarkmodi.github.io/\n\n## Impact\n\nBecause of this protection it is not possible for a 3rd party to track users across multiple domains. The demo is not very clever, but a 3rd party with a large footprint on the web can use this to track substantial web browsing behaviour of the user.","vulnerability_information_html":"\u003cp\u003eCross domain tracking\u003cbr\u003e\nDefault settings from Brave browser has 3rd party cookies disabled. Which I am assuming also disables 3rd part storage like IndexedDB etc. Because of this protection it is not possible for a 3rd party to track users across multiple domains.\u003c/p\u003e\n\n\u003cp\u003eBut, Even though third-party cookies is disabled by default using Shared workers, a third-party is able to track the user across domains and websites.\u003c/p\u003e\n\n\u003cp\u003eREPRODUCTION STEPS\u003cbr\u003e\nIf you visit the these three pages in three tabs, you will notice that as a third-party it can learn the movement of a user across domains, even though the user has disabled 3rd party cookies.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://cdn.cliqz.com/browser-f/fun-demo/some-random-page.html\" href=\"/redirect?url=https%3A%2F%2Fcdn.cliqz.com%2Fbrowser-f%2Ffun-demo%2Fsome-random-page.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.cliqz.com/browser-f/fun-demo/some-random-page.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://cdn2.ghostery.com/browser-f/fun-demo/some-random-page.html\" href=\"/redirect?url=https%3A%2F%2Fcdn2.ghostery.com%2Fbrowser-f%2Ffun-demo%2Fsome-random-page.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn2.ghostery.com/browser-f/fun-demo/some-random-page.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe third party script is being loaded from \u003ca title=\"https://konarkmodi.github.io/\" href=\"/redirect?url=https%3A%2F%2Fkonarkmodi.github.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://konarkmodi.github.io/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBecause of this protection it is not possible for a 3rd party to track users across multiple domains. The demo is not very clever, but a 3rd party with a large footprint on the web can use this to track substantial web browsing behaviour of the user.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["sameerphad72","cryptographer"],"structured_scope":{"databaseId":7936,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"https://laptop-updates.brave.com/latest/osx","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2548273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, this exploit can also be used to track user cross domain in private tabs. (Not across private tab and normal tab).","markdown_message":"\u003cp\u003eAlso, this exploit can also be used to track user cross domain in private tabs. (Not across private tab and normal tab).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-30T19:32:51.640Z","updated_at":"2018-03-30T19:32:51.640Z","actor":{"username":"kmodi","cleared":false,"url":"/kmodi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/034/95df7d59a39c078497891cefff825eaf86197a04_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2552886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kmodi,\n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nRegards,\n@chocolatechipmuffin","markdown_message":"\u003cp\u003eHi \u003ca href=\"/kmodi\"\u003e@kmodi\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/chocolatechipmuffin\"\u003e@chocolatechipmuffin\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-02T04:20:13.052Z","updated_at":"2018-04-02T04:20:13.052Z","actor":{"username":"chocolatechipmuffin","cleared":false,"url":"/chocolatechipmuffin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/222/995/e06f83c3c2c49aec68debce80fce012d52d56729_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2555462,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. We're aware of various vectors which can allow for cross-site third-party tracking, and we track some of them at https://github.com/brave/browser-laptop/labels/feature%2Fcontent-blocking. In particular, we're aware of the challenge faced by workers: https://github.com/brave/browser-laptop/issues/2418.\n\nIn general, fingerprinting or third-party tracking vectors aren't in scope for bounties in our program. It's not that these issues aren't a problem for privacy on the Web, it's just that there's a fine line between disabling tracking vectors and keeping websites working. Because of the large potential for disappointment with otherwise-valid reports (like this one) we think that balancing those details is better suited for our product team than in bug reports.","markdown_message":"\u003cp\u003eThanks for the report. We\u0026#39;re aware of various vectors which can allow for cross-site third-party tracking, and we track some of them at \u003ca title=\"https://github.com/brave/browser-laptop/labels/feature%2Fcontent-blocking\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Flabels%2Ffeature%252Fcontent-blocking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/labels/feature%2Fcontent-blocking\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. In particular, we\u0026#39;re aware of the challenge faced by workers: \u003ca title=\"https://github.com/brave/browser-laptop/issues/2418\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F2418\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/2418\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eIn general, fingerprinting or third-party tracking vectors aren\u0026#39;t in scope for bounties in our program. It\u0026#39;s not that these issues aren\u0026#39;t a problem for privacy on the Web, it\u0026#39;s just that there\u0026#39;s a fine line between disabling tracking vectors and keeping websites working. Because of the large potential for disappointment with otherwise-valid reports (like this one) we think that balancing those details is better suited for our product team than in bug reports.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-02T19:27:52.880Z","updated_at":"2018-04-02T19:27:52.880Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2556432,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @toml :\n\nThank for responding. I respect what ever is the bounty policy.\n\nBut I do not agree with the reasoning behind \"disabling tracking vectors and keeping websites working\". \nFor the following reasons:\n\n1.  This issue was not about \"Service workers\" but instead about \"Shared workers\" : https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\n\n2. Can you site some example where disabling \"Shared workers\" includes site breakage. In my experience, it should not break much, specially as compared to breakage one might observe with 3rd parties disabled. Shared workers can still function but double-keyed with origin.\n\n3. I reported the same issue with Chromium, which was fixed (My naive understanding is that Brave picks some portion from Chromium) so I guess this port is missing.  Issue: https://bugs.chromium.org/p/chromium/issues/detail?id=786187#c6\n\n4. I tested the same on other popular browsers:\n   a. Firefox\n   b. Chrome / Chromium\n   c. Opera\n   All with third party cookies disabled, the worker functionality works, but tracking is not possible.\nSo I think, Brave putting privacy first, should be able to do it as well.\n\nIn any case, request you to make this report public, and since it does not need to be a private issue, we can open a ticket on https://github.com/brave/browser-laptop/issues/","markdown_message":"\u003cp\u003eHi \u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e :\u003c/p\u003e\n\n\u003cp\u003eThank for responding. I respect what ever is the bounty policy.\u003c/p\u003e\n\n\u003cp\u003eBut I do not agree with the reasoning behind \u0026quot;disabling tracking vectors and keeping websites working\u0026quot;. \u003cbr\u003e\nFor the following reasons:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eThis issue was not about \u0026quot;Service workers\u0026quot; but instead about \u0026quot;Shared workers\u0026quot; : \u003ca title=\"https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FSharedWorker\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.mozilla.org/en-US/docs/Web/API/SharedWorker\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCan you site some example where disabling \u0026quot;Shared workers\u0026quot; includes site breakage. In my experience, it should not break much, specially as compared to breakage one might observe with 3rd parties disabled. Shared workers can still function but double-keyed with origin.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eI reported the same issue with Chromium, which was fixed (My naive understanding is that Brave picks some portion from Chromium) so I guess this port is missing.  Issue: \u003ca title=\"https://bugs.chromium.org/p/chromium/issues/detail?id=786187#c6\" href=\"/redirect?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fchromium%2Fissues%2Fdetail%3Fid%3D786187%23c6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.chromium.org/p/chromium/issues/detail?id=786187#c6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eI tested the same on other popular browsers:\u003cbr\u003e\na. Firefox\u003cbr\u003e\nb. Chrome / Chromium\u003cbr\u003e\nc. Opera\u003cbr\u003e\nAll with third party cookies disabled, the worker functionality works, but tracking is not possible.\u003cbr\u003e\nSo I think, Brave putting privacy first, should be able to do it as well.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn any case, request you to make this report public, and since it does not need to be a private issue, we can open a ticket on \u003ca title=\"https://github.com/brave/browser-laptop/issues/\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-02T21:15:56.030Z","updated_at":"2018-04-02T21:15:56.030Z","actor":{"username":"kmodi","cleared":false,"url":"/kmodi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/034/95df7d59a39c078497891cefff825eaf86197a04_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2556549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'm happy to make this public, and happy to work on this issue in public on our GitHub. Working in public is always preferable, where possible. I certainly agree that this is an issue we should work to fix. And indeed, double-keying cookies accessed by workers may well be the right fix. We do use a lot of code from Chromium, and are in the process of a big rewrite to use even more of Chromium rather than Muon, our security-focused Electron fork. If this is already fully resolved in Chromium then we probably just get that fix automatically. You can check our newer more-Chromium-based work at https://github.com/brave/brave-browser. It's still pretty rough around the edges and certainly not ready for primetime. If this is already fixed there then problem solved, right?","markdown_message":"\u003cp\u003eI\u0026#39;m happy to make this public, and happy to work on this issue in public on our GitHub. Working in public is always preferable, where possible. I certainly agree that this is an issue we should work to fix. And indeed, double-keying cookies accessed by workers may well be the right fix. We do use a lot of code from Chromium, and are in the process of a big rewrite to use even more of Chromium rather than Muon, our security-focused Electron fork. If this is already fully resolved in Chromium then we probably just get that fix automatically. You can check our newer more-Chromium-based work at \u003ca title=\"https://github.com/brave/brave-browser\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrave-browser\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/brave-browser\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. It\u0026#39;s still pretty rough around the edges and certainly not ready for primetime. If this is already fixed there then problem solved, right?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-02T21:46:22.941Z","updated_at":"2018-04-02T21:46:22.941Z","first_to_agree":true,"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3158325,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-07T22:46:40.111Z","updated_at":"2018-08-07T22:46:40.111Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}