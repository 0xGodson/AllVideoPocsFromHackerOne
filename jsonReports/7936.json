{"id":7936,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTM2","url":"https://hackerone.com/reports/7936","title":"Login CSRF in Secret.ly","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-17T22:39:04.632Z","submitted_at":"2014-04-17T22:39:04.632Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"siddiki","url":"/siddiki","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":45,"url":"https://hackerone.com/secret","handle":"secret","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/ad4355302915965eb9c07cc5a2d42d8bb7d630fd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/ad4355302915965eb9c07cc5a2d42d8bb7d630fd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Secret","twitter_handle":null,"website":"http://secret.ly","about":"Share anonymously with your friends. Speak freely."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-06-09T01:35:00.433Z","bug_reporter_agreed_on_going_public_at":"2014-06-04T19:43:43.063Z","team_member_agreed_on_going_public_at":"2014-06-09T01:35:00.256Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"https://www.secret.ly/_/login\r\n\r\nPOST /_/login HTTP/1.1\r\nHost: www.secret.ly\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:28.0) Gecko/20100101 Firefox/28.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/json; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 55\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n{\"Login\":\"user@vendor.tld\",\"Password\":\"user_password_here\"}\r\n\r\nAs you can see that this form does not contain any CSRF token,So it is vulnerable to Login CSRF attack.And also note that the login request is prone to bruteforce attack.You might want to impose some extra layer of security to prevent bruteforce attacks on **SECRET.LY**\r\n\r\nRead [this](http://stackoverflow.com/questions/6412813/do-login-forms-need-tokens-against-csrf-attacks) for more information about the requirement of CSRF tokens on login forms.","vulnerability_information_html":"\u003cp\u003e\u003ca title=\"https://www.secret.ly/_/login\" href=\"/redirect?url=https%3A%2F%2Fwww.secret.ly%2F_%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.secret.ly/_/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePOST /_/login HTTP/1.1\u003cbr\u003e\nHost: \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.secret.ly\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.secret.ly\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:28.0) Gecko/20100101 Firefox/28.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nContent-Type: application/json; charset=UTF-8\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Length: 55\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nPragma: no-cache\u003cbr\u003e\nCache-Control: no-cache\u003cbr\u003e\n{\u0026quot;Login\u0026quot;:\u0026quot;\u003ca title=\"user@vendor.tld\" href=\"mailto:user@vendor.tld\" rel=\"nofollow noopener noreferrer\"\u003euser@vendor.tld\u003c/a\u003e\u0026quot;,\u0026quot;Password\u0026quot;:\u0026quot;user_password_here\u0026quot;}\u003c/p\u003e\n\n\u003cp\u003eAs you can see that this form does not contain any CSRF token,So it is vulnerable to Login CSRF attack.And also note that the login request is prone to bruteforce attack.You might want to impose some extra layer of security to prevent bruteforce attacks on \u003cstrong\u003eSECRET.LY\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eRead \u003ca href=\"/redirect?url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2F6412813%2Fdo-login-forms-need-tokens-against-csrf-attacks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for more information about the requirement of CSRF tokens on login forms.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-04T18:54:15.857Z","allow_singular_disclosure_after":-204724797.52419007,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","r3y"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":59163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update for this issue?","markdown_message":"\u003cp\u003eAny update for this issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T01:18:32.697Z","updated_at":"2014-05-28T01:22:35.314Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":59180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you--yes we have some measures in place for bruteforce password guessing, but we will apply a CSRF token too.","markdown_message":"\u003cp\u003eThank you--yes we have some measures in place for bruteforce password guessing, but we will apply a CSRF token too.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-28T01:39:30.795Z","updated_at":"2014-05-28T01:39:30.795Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59181,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-28T01:39:38.216Z","updated_at":"2014-05-28T01:39:38.216Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":64882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you have any update?\nIs there any chance that u are going to solve that soon?","markdown_message":"\u003cp\u003eDo you have any update?\u003cbr\u003e\nIs there any chance that u are going to solve that soon?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T11:44:01.337Z","updated_at":"2014-06-03T11:44:01.337Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":65261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, yes! We want to do this for sure. We have implemented a brute forcing ban--so you cannot attempt too many failed logins. We will also add a CSRF token as you suggest. Thank you for your report and help! Really appreciate it. =)","markdown_message":"\u003cp\u003eHi, yes! We want to do this for sure. We have implemented a brute forcing ban--so you cannot attempt too many failed logins. We will also add a CSRF token as you suggest. Thank you for your report and help! Really appreciate it. =)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T17:38:29.405Z","updated_at":"2014-06-03T17:38:29.405Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":65263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"please email bounty@secret.ly to collect your bounty =)","markdown_message":"\u003cp\u003eplease email \u003ca title=\"bounty@secret.ly\" href=\"mailto:bounty@secret.ly\" rel=\"nofollow noopener noreferrer\"\u003ebounty@secret.ly\u003c/a\u003e to collect your bounty =)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T17:39:02.059Z","updated_at":"2014-06-03T17:39:02.059Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":65270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can u please change the status to resolve,if it is resolved.","markdown_message":"\u003cp\u003ecan u please change the status to resolve,if it is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T17:44:30.460Z","updated_at":"2014-06-03T17:44:30.460Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":65788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I am just waiting for a prod push for the CSRF token, then will close it. thanks.","markdown_message":"\u003cp\u003eYes, I am just waiting for a prod push for the CSRF token, then will close it. thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-03T22:51:22.700Z","updated_at":"2014-06-03T22:51:22.700Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":66605,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T18:54:15.887Z","updated_at":"2014-06-04T18:54:15.887Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"siddiki","url":"/siddiki"},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":66660,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-04T19:43:43.080Z","updated_at":"2014-06-04T19:43:43.080Z","first_to_agree":true,"actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":69713,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-09T01:35:00.273Z","updated_at":"2014-06-09T01:35:00.273Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":69714,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-09T01:35:00.447Z","updated_at":"2014-06-09T01:35:00.447Z","actor":{"username":"dhanji","cleared":false,"url":"/dhanji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":166486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Received the gift a few days ago.Thanks a lot for this.This is the cutest gift anyone ever gave me.Loved that stuffed fox.","markdown_message":"\u003cp\u003eReceived the gift a few days ago.Thanks a lot for this.This is the cutest gift anyone ever gave me.Loved that stuffed fox.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-22T18:20:40.443Z","updated_at":"2014-11-22T18:20:40.443Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"secret","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}