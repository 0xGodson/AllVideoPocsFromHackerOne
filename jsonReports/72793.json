{"id":72793,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjc5Mw==","url":"https://hackerone.com/reports/72793","title":"Prevent Shop Admin From Seeing his Installed Apps / Install Persistent Unremovable App","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-26T21:06:02.130Z","submitted_at":"2015-06-26T21:06:02.130Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"prakharprasad","url":"/prakharprasad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-09-29T01:27:12.441Z","bug_reporter_agreed_on_going_public_at":"2015-09-29T01:27:12.239Z","team_member_agreed_on_going_public_at":"2015-09-28T21:07:06.998Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nThis is an interesting vulnerability, when a Shopify app whose `redirect_uri` points to a malformed URI handler like **shit:google.com** gets installed to a Shop then, it will effectively prevent the admins to see and remove installed apps to his/her shop. \r\n\r\n**Reproduction**\r\n\r\n1. Create a Shopify App at https://app.shopify.com/services/partners/api_clients/new\r\n2. Enter any for the App and set its **Application Callback URL** to **shit:google.com**\r\n3. Save the App.\r\n4. Create an OAuth URL for the App, Like - https://vulnstore.myshopify.com/admin/oauth/authorize?scope=read_customers\u0026client_id=cad94488c733b0f377a9a1d7952db802\r\n5. Now try to install the app by clicking \"Install \u003cAppName\u003e\" in the OAuth permission dialogue. It won't redirect after clicking.\r\n6. Go and visit https://vulnstore.myshopify.com/admin/apps The page will throw internal server 500 and usual error message.\r\n\r\nThis will not let admin remove any of his app till the *malicious app* is deleted by the app developer.\r\n\r\nPOC App: https://[store].myshopify.com/admin/oauth/authorize?scope=read_customers\u0026client_id=cad94488c733b0f377a9a1d7952db802 \r\n\r\nIf you have any doubt in reproduction, you can watch the following short screencast as well - https://www.dropbox.com/s/1h8gjg07r5h9gkj/Shopify%20DoS.mov?dl=0\r\n\r\nRegards,\r\nPrakhar Prasad","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis is an interesting vulnerability, when a Shopify app whose \u003ccode\u003eredirect_uri\u003c/code\u003e points to a malformed URI handler like \u003cstrong\u003eshit:google.com\u003c/strong\u003e gets installed to a Shop then, it will effectively prevent the admins to see and remove installed apps to his/her shop. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a Shopify App at \u003ca title=\"https://app.shopify.com/services/partners/api_clients/new\" href=\"/redirect?url=https%3A%2F%2Fapp.shopify.com%2Fservices%2Fpartners%2Fapi_clients%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.shopify.com/services/partners/api_clients/new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eEnter any for the App and set its \u003cstrong\u003eApplication Callback URL\u003c/strong\u003e to \u003cstrong\u003eshit:google.com\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eSave the App.\u003c/li\u003e\n\u003cli\u003eCreate an OAuth URL for the App, Like - \u003ca title=\"https://vulnstore.myshopify.com/admin/oauth/authorize?scope=read_customers\u0026amp;client_id=cad94488c733b0f377a9a1d7952db802\" href=\"/redirect?url=https%3A%2F%2Fvulnstore.myshopify.com%2Fadmin%2Foauth%2Fauthorize%3Fscope%3Dread_customers%26client_id%3Dcad94488c733b0f377a9a1d7952db802\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vulnstore.myshopify.com/admin/oauth/authorize?scope=read_customers\u0026amp;client_id=cad94488c733b0f377a9a1d7952db802\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eNow try to install the app by clicking \u0026quot;Install \u0026lt;AppName\u0026gt;\u0026quot; in the OAuth permission dialogue. It won\u0026#39;t redirect after clicking.\u003c/li\u003e\n\u003cli\u003eGo and visit \u003ca title=\"https://vulnstore.myshopify.com/admin/apps\" href=\"/redirect?url=https%3A%2F%2Fvulnstore.myshopify.com%2Fadmin%2Fapps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vulnstore.myshopify.com/admin/apps\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e The page will throw internal server 500 and usual error message.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis will not let admin remove any of his app till the \u003cem\u003emalicious app\u003c/em\u003e is deleted by the app developer.\u003c/p\u003e\n\n\u003cp\u003ePOC App: https://[store].myshopify.com/admin/oauth/authorize?scope=read_customers\u0026amp;client_id=cad94488c733b0f377a9a1d7952db802 \u003c/p\u003e\n\n\u003cp\u003eIf you have any doubt in reproduction, you can watch the following short screencast as well - \u003ca title=\"https://www.dropbox.com/s/1h8gjg07r5h9gkj/Shopify%20DoS.mov?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2F1h8gjg07r5h9gkj%2FShopify%2520DoS.mov%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/1h8gjg07r5h9gkj/Shopify%20DoS.mov?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nPrakhar Prasad\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-28T21:07:07.147Z","allow_singular_disclosure_after":-163157732.4224244,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":509986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey! any updates here ? ","markdown_message":"\u003cp\u003eHey! any updates here ? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T10:22:00.377Z","updated_at":"2015-07-15T10:22:00.377Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":517814,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-20T19:53:45.219Z","updated_at":"2015-07-20T19:53:45.219Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":529419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Clayton, do  you have any update ? ","markdown_message":"\u003cp\u003eHey Clayton, do  you have any update ? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-29T01:43:16.528Z","updated_at":"2015-07-29T01:43:16.528Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":543045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just checked and the vulnerability seems fixed. ","markdown_message":"\u003cp\u003eI just checked and the vulnerability seems fixed. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-10T16:36:13.882Z","updated_at":"2015-08-10T16:36:13.882Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":571925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @clayton, any updates here ?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/clayton\"\u003e@clayton\u003c/a\u003e, any updates here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-01T15:43:37.009Z","updated_at":"2015-09-01T15:43:37.009Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":572208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, no update yet. I'll let you know as soon as I have more information.","markdown_message":"\u003cp\u003eSorry, no update yet. I\u0026#39;ll let you know as soon as I have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-01T16:39:51.665Z","updated_at":"2015-09-01T16:39:51.665Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":572211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not fixed at all. Rest assured that we will keep you updated with any information as it is available, and there is no need to ask for updates.","markdown_message":"\u003cp\u003eThis is not fixed at all. Rest assured that we will keep you updated with any information as it is available, and there is no need to ask for updates.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-01T16:40:43.510Z","updated_at":"2015-09-01T16:40:43.510Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600873,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @prakharprasad,\n\nThe fix for this issue was deployed on Friday, so I'll mark this as resolved now. Since this issue is a denial of service issue, with no danger to user's data, the issue is not eligible for a bounty. (Denial of service issues are not eligible for rewards in our bug bounty program).\n\nThank you again for submitting the issue.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/prakharprasad\"\u003e@prakharprasad\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe fix for this issue was deployed on Friday, so I\u0026#39;ll mark this as resolved now. Since this issue is a denial of service issue, with no danger to user\u0026#39;s data, the issue is not eligible for a bounty. (Denial of service issues are not eligible for rewards in our bug bounty program).\u003c/p\u003e\n\n\u003cp\u003eThank you again for submitting the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-28T21:06:42.583Z","updated_at":"2015-09-28T21:06:42.583Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"prakharprasad","url":"/prakharprasad"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600874,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-28T21:06:50.440Z","updated_at":"2015-09-28T21:06:50.440Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-28T21:07:07.023Z","updated_at":"2015-09-28T21:07:07.023Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":601095,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-29T01:27:12.292Z","updated_at":"2015-09-29T01:27:12.292Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":601096,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-29T01:27:12.463Z","updated_at":"2015-09-29T01:27:12.463Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}