{"id":226334,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjYzMzQ=","url":"https://hackerone.com/reports/226334","title":"Improper validation of Email ","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2017-05-05T13:32:49.376Z","submitted_at":"2017-05-05T13:32:49.376Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"test_this","url":"/test_this","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-07T06:08:41.464Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-05-05T20:53:58.715Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1.goto https://bridge.cspr.ng/my/account\nhere no rate limit present for email and display name,real name\ni just entered 1000 character length email in email field and it accepted\n\nalso for the display name ,real name\n\nanother \nthere is no regular expression to check valid email \nif u give email as \"aaaaaa\", \"a++++++++\", \"vdadva*$'/@4%$123\", \"sdfsjghg@something\" all will be accepted as valid email\nAlso 500+ character email also valid according to your code\nhere is the specification for email address\nhttps://en.wikipedia.org/wiki/Email_address\nand email id must be \u003c254 character \n\nas email id strored in mysql as VARCHAR(128), \nso all the trailing character in mysql db will be truncted\nif your email like abc@gmail.com and you entered as abc+aaaaaaaaaaaaaaaaaa......@gmail.com,then still you receave email in abc@gmail.com\nMITIGATION:\n you must use filter_var($email, FILTER_VALIDATE_EMAIL) to validate email\nor use Regex like /^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,3})$/","vulnerability_information_html":"\u003cp\u003e1.goto \u003ca title=\"https://bridge.cspr.ng/my/account\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2Fmy%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/my/account\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nhere no rate limit present for email and display name,real name\u003cbr\u003e\ni just entered 1000 character length email in email field and it accepted\u003c/p\u003e\n\n\u003cp\u003ealso for the display name ,real name\u003c/p\u003e\n\n\u003cp\u003eanother \u003cbr\u003e\nthere is no regular expression to check valid email \u003cbr\u003e\nif u give email as \u0026quot;aaaaaa\u0026quot;, \u0026quot;a++++++++\u0026quot;, \u0026quot;vdadva*$\u0026#39;/@4%$123\u0026quot;, \u0026quot;sdfsjghg@something\u0026quot; all will be accepted as valid email\u003cbr\u003e\nAlso 500+ character email also valid according to your code\u003cbr\u003e\nhere is the specification for email address\u003cbr\u003e\n\u003ca title=\"https://en.wikipedia.org/wiki/Email_address\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEmail_address\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Email_address\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand email id must be \u0026lt;254 character \u003c/p\u003e\n\n\u003cp\u003eas email id strored in mysql as VARCHAR(128), \u003cbr\u003e\nso all the trailing character in mysql db will be truncted\u003cbr\u003e\nif your email like \u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e and you entered as \u003ca title=\"abc+aaaaaaaaaaaaaaaaaa......@gmail.com\" href=\"mailto:abc+aaaaaaaaaaaaaaaaaa......@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc+aaaaaaaaaaaaaaaaaa......@gmail.com\u003c/a\u003e,then still you receave email in \u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e\u003cbr\u003e\nMITIGATION:\u003cbr\u003e\n you must use filter_var($email, FILTER_VALIDATE_EMAIL) to validate email\u003cbr\u003e\nor use Regex like /^[_a-z0-9-]+(.[_a-z0-9-]+)\u003cem\u003e@[a-z0-9-]+(.[a-z0-9-]+)\u003c/em\u003e(.[a-z]{2,3})$/\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":182089,"file_name":"Screenshot_-_May_5__2017_7.09_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/182/089/e681522dbf54b12da600abfbb08cb4d26c0c7135/Screenshot_-_May_5__2017_7.09_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_-_May_5__2017_7.09_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_-_May_5__2017_7.09_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050258Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=9cc3d5261464f0bb8ce428df5eb7eee6d50bf5f0af66ccfa303e35826602964d","file_size":57894,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["spetr0x","mutali"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1656453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e here no rate limit present for email and display name,real name\n\nThere's no internal, social aspect to Airship. Your display name is never seen to another user.\n\n\u003e i just entered 1000 character length email in email field and it accepted\n\n\u003e there is no regular expression to check valid email \n\nEmail addresses aren't compulsory. You can actually create an account without supplying one. We did this to facilitate Tor Hidden Service users who don't want to provide an email address, which could be used as a selector in the databases used by nation states (NSA, KGB) if the webserver were ever compromised.\n\n\u003e Also 500+ character email also valid according to your code\n\u003e here is the specification for email address\n\u003e https://en.wikipedia.org/wiki/Email_address\n\u003e and email id must be \u003c254 character\n\nThat's an interesting point. I'll add conditional logic (e.g. \"if an address is provided, check it with filter_var\").\n\n\u003e as email id strored in mysql as VARCHAR(128), \n\u003e so all the trailing character in mysql db will be truncted\n\nWe use PostgreSQL, by the way.\n\nhttps://github.com/paragonie/airship/blob/c40065c6f66d5ecb988313316095576555f3d29b/src/Installer/sql/pgsql/10-users.sql#L10\n\nBy the way, for things that aren't vulnerabilities, could you report them on Github instead of HackerOne? https://github.com/paragonie/airship/issues","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003ehere no rate limit present for email and display name,real name\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThere\u0026#39;s no internal, social aspect to Airship. Your display name is never seen to another user.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ei just entered 1000 character length email in email field and it accepted\u003c/p\u003e\n\n\u003cp\u003ethere is no regular expression to check valid email \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eEmail addresses aren\u0026#39;t compulsory. You can actually create an account without supplying one. We did this to facilitate Tor Hidden Service users who don\u0026#39;t want to provide an email address, which could be used as a selector in the databases used by nation states (NSA, KGB) if the webserver were ever compromised.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAlso 500+ character email also valid according to your code\u003cbr\u003e\nhere is the specification for email address\u003cbr\u003e\n\u003ca title=\"https://en.wikipedia.org/wiki/Email_address\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEmail_address\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Email_address\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand email id must be \u0026lt;254 character\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat\u0026#39;s an interesting point. I\u0026#39;ll add conditional logic (e.g. \u0026quot;if an address is provided, check it with filter_var\u0026quot;).\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eas email id strored in mysql as VARCHAR(128), \u003cbr\u003e\nso all the trailing character in mysql db will be truncted\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe use PostgreSQL, by the way.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/paragonie/airship/blob/c40065c6f66d5ecb988313316095576555f3d29b/src/Installer/sql/pgsql/10-users.sql#L10\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2Fc40065c6f66d5ecb988313316095576555f3d29b%2Fsrc%2FInstaller%2Fsql%2Fpgsql%2F10-users.sql%23L10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/c40065c6f66d5ecb988313316095576555f3d29b/src/Installer/sql/pgsql/10-users.sql#L10\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBy the way, for things that aren\u0026#39;t vulnerabilities, could you report them on Github instead of HackerOne? \u003ca title=\"https://github.com/paragonie/airship/issues\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fissues\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/issues\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T13:39:54.447Z","updated_at":"2017-05-05T13:39:54.447Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1656461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"see if u provide a user to enter their email then you must validate the email format\nusing REGEX or filter_var\notherwise there is no meaning to use EMAIL field","markdown_message":"\u003cp\u003esee if u provide a user to enter their email then you must validate the email format\u003cbr\u003e\nusing REGEX or filter_var\u003cbr\u003e\notherwise there is no meaning to use EMAIL field\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T13:46:06.545Z","updated_at":"2017-05-05T13:46:06.545Z","actor":{"username":"test_this","cleared":false,"url":"/test_this","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1656463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. If the user is very invested in their own privacy, then the email field is meaningless. However, if the user is not, then it should be validated.\n\nThis would make a great Github issue, but it doesn't cause our security model to break down. It's a totally valid software bug, but not a vulnerability.","markdown_message":"\u003cp\u003eSure. If the user is very invested in their own privacy, then the email field is meaningless. However, if the user is not, then it should be validated.\u003c/p\u003e\n\n\u003cp\u003eThis would make a great Github issue, but it doesn\u0026#39;t cause our security model to break down. It\u0026#39;s a totally valid software bug, but not a vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T13:49:06.587Z","updated_at":"2017-05-05T13:49:06.587Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1657356,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"https://github.com/paragonie/airship/issues/187","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/paragonie/airship/issues/187\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fissues%2F187\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/issues/187\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T20:53:52.644Z","updated_at":"2017-05-05T20:53:52.644Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1657358,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-05T20:53:58.742Z","updated_at":"2017-05-05T20:53:58.742Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1658729,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-07T06:08:41.423Z","updated_at":"2017-05-07T06:08:41.423Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}