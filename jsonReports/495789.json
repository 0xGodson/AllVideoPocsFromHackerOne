{"id":495789,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTU3ODk=","url":"https://hackerone.com/reports/495789","title":"Malformed .WAV triggers an Access Violation on GoldSRC (hl.exe)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-02-14T01:23:07.581Z","submitted_at":"2019-02-14T01:23:07.581Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chippy","url":"/chippy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-27T18:25:28.343Z","bug_reporter_agreed_on_going_public_at":"2019-04-23T22:12:03.717Z","team_member_agreed_on_going_public_at":"2020-02-27T18:25:28.194Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["njbooher","mvc","a_d_a_m","securitychops","chippy","romesful","cryptographer","mindflower","shadow87ls","bo0m","and 4 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":1289,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"hl.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4146547,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-14T03:46:28.702Z","updated_at":"2019-02-14T03:46:28.702Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4146611,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-14T04:27:44.864Z","updated_at":"2019-02-14T04:27:44.864Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4333997,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T20:18:22.078Z","updated_at":"2019-03-15T20:18:22.078Z","additional_data":{},"actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4333998,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-15T20:18:23.536Z","updated_at":"2019-03-15T20:18:23.536Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4334830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-16T00:40:10.475Z","updated_at":"2019-03-16T00:40:10.475Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4629958,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-23T21:46:28.004Z","updated_at":"2019-04-23T21:46:28.004Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Valve"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"chippy","url":"/chippy"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4629960,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-23T21:46:41.852Z","updated_at":"2019-04-23T21:46:41.852Z","actor":{"username":"percybysshe","cleared":false,"url":"/percybysshe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vuZfWG7XewsudrWa6NCkyxkZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"chippy","url":"/chippy"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4630096,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-23T22:12:03.735Z","updated_at":"2019-04-23T22:12:03.735Z","first_to_agree":true,"actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6982235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T21:46:19.822Z","updated_at":"2020-02-06T21:46:19.822Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7168124,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T18:25:28.217Z","updated_at":"2020-02-27T18:25:28.217Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7168125,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T18:25:28.381Z","updated_at":"2020-02-27T18:25:28.381Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7168126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-27T18:26:05.145Z","updated_at":"2020-02-27T18:26:05.145Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20448,"category":"team","content":"A malformed .WAV triggers an Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\n\nCrash Information\n------------------\nEvent Type: Exception\nException Faulting Address: 0x2469a000\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\nException Sub-Type: Read Access Violation\n\nFaulting Instruction:0950bd62 mov dl,byte ptr [eax+ecx]\n\nBasic Block:\n0950bd62 mov dl,byte ptr [eax+ecx]\nTainted Input Operands: eax, ecx\n0950bd65 add dl,80h\nTainted Input Operands: dl\n0950bd68 mov byte ptr [esi+eax+14h],dl\nTainted Input Operands: dl, eax\n0950bd6c inc eax\nTainted Input Operands: eax\n0950bd6d cmp eax,edi\nTainted Input Operands: eax\n0950bd6f jl hw!createinterface+0x2eb22 (0950bd62)\nTainted Input Operands: SignFlag, OverflowFlag\n\nStack Trace:\nhw!CreateInterface+0x2eb22\nhw!CreateInterface+0x2ef27\nhw!CreateInterface+0x31d2c\nhw!CreateInterface+0x2db58\nhw!CreateInterface+0x2e97b\nhw+0x27df6\nhw+0x26f94\nhw+0x56308\nhw+0x564b3\nhw!F+0x164e\nhw!F+0xa70\nhw!F+0xbea\nhl!CreateInterface+0x66b\nhl!CreateInterface+0x3fc2\nKERNEL32!BaseThreadInitThunk+0x24\nntdll_77960000!__RtlUserThreadStart+0x2f\nntdll_77960000!_RtlUserThreadStart+0x1b\nInstruction Address: 0x000000000950bd62\n\nSteps for Reproducing the Crash\n--------------------------------\nPlace the attached .WAV in the games audio folder (Steam\\steamapps\\common\\Half-Life\\valve\\sound\\misc) Load the attached .WAV by invoking \"spk misc/x.wav\" from the console. The game will crash with an access violation while parsing the .WAV\n\nImpact\n-------\nAn attacker hosting a malicious server could compromise a remote client by having them download a custom map, triggering remote code execution on the victim's computer.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA malformed .WAV triggers an Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\u003c/p\u003e\n\n\u003ch2 id=\"crash-information\"\u003eCrash Information\u003c/h2\u003e\n\n\u003cp\u003eEvent Type: Exception\u003cbr\u003e\nException Faulting Address: 0x2469a000\u003cbr\u003e\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\u003cbr\u003e\nException Sub-Type: Read Access Violation\u003c/p\u003e\n\n\u003cp\u003eFaulting Instruction:0950bd62 mov dl,byte ptr [eax+ecx]\u003c/p\u003e\n\n\u003cp\u003eBasic Block:\u003cbr\u003e\n0950bd62 mov dl,byte ptr [eax+ecx]\u003cbr\u003e\nTainted Input Operands: eax, ecx\u003cbr\u003e\n0950bd65 add dl,80h\u003cbr\u003e\nTainted Input Operands: dl\u003cbr\u003e\n0950bd68 mov byte ptr [esi+eax+14h],dl\u003cbr\u003e\nTainted Input Operands: dl, eax\u003cbr\u003e\n0950bd6c inc eax\u003cbr\u003e\nTainted Input Operands: eax\u003cbr\u003e\n0950bd6d cmp eax,edi\u003cbr\u003e\nTainted Input Operands: eax\u003cbr\u003e\n0950bd6f jl hw!createinterface+0x2eb22 (0950bd62)\u003cbr\u003e\nTainted Input Operands: SignFlag, OverflowFlag\u003c/p\u003e\n\n\u003cp\u003eStack Trace:\u003cbr\u003e\nhw!CreateInterface+0x2eb22\u003cbr\u003e\nhw!CreateInterface+0x2ef27\u003cbr\u003e\nhw!CreateInterface+0x31d2c\u003cbr\u003e\nhw!CreateInterface+0x2db58\u003cbr\u003e\nhw!CreateInterface+0x2e97b\u003cbr\u003e\nhw+0x27df6\u003cbr\u003e\nhw+0x26f94\u003cbr\u003e\nhw+0x56308\u003cbr\u003e\nhw+0x564b3\u003cbr\u003e\nhw!F+0x164e\u003cbr\u003e\nhw!F+0xa70\u003cbr\u003e\nhw!F+0xbea\u003cbr\u003e\nhl!CreateInterface+0x66b\u003cbr\u003e\nhl!CreateInterface+0x3fc2\u003cbr\u003e\nKERNEL32!BaseThreadInitThunk+0x24\u003cbr\u003e\nntdll_77960000!__RtlUserThreadStart+0x2f\u003cbr\u003e\nntdll_77960000!_RtlUserThreadStart+0x1b\u003cbr\u003e\nInstruction Address: 0x000000000950bd62\u003c/p\u003e\n\n\u003ch2 id=\"steps-for-reproducing-the-crash\"\u003eSteps for Reproducing the Crash\u003c/h2\u003e\n\n\u003cp\u003ePlace the attached .WAV in the games audio folder (Steam\\steamapps\\common\\Half-Life\\valve\\sound\\misc) Load the attached .WAV by invoking \u0026quot;spk misc/x.wav\u0026quot; from the console. The game will crash with an access violation while parsing the .WAV\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker hosting a malicious server could compromise a remote client by having them download a custom map, triggering remote code execution on the victim\u0026#39;s computer.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}